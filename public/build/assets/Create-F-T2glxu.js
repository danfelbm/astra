import{d as L,C as M,r as R,b as V,e as m,w as o,f as s,g as r,u as e,p as h,P as S,h as l,l as j,i as _,F as k,k as F,t as f}from"./app-Dc8N1qFm.js";import{T as z,_ as B}from"./AdminLayout.vue_vue_type_script_setup_true_lang-38n1nD2K.js";import{_ as u}from"./createLucideIcon-9I0y_pFv.js";import{_ as g,a as c,b as v,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-BVHCZdWh.js";import{_ as x}from"./CardDescription.vue_vue_type_script_setup_true_lang-B_OYAphd.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-CsYUOobY.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-QeZnzUlD.js";import{_ as P}from"./Textarea.vue_vue_type_script_setup_true_lang-CiZ7h4Bl.js";import{_ as G,a as E,b as O,c as Q,d as H}from"./SelectValue.vue_vue_type_script_setup_true_lang-DfxqgBZD.js";import{_ as I}from"./Switch.vue_vue_type_script_setup_true_lang-hUGwaOjg.js";import{_ as J}from"./Checkbox.vue_vue_type_script_setup_true_lang-DweqzArk.js";import{_ as K}from"./index-Cp4pVn4k.js";import{_ as W,a as X,b,c as $}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-C_05jw8c.js";import{_ as Y}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-KJkXXCiP.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang-DVr0d0fW.js";import{A as Z}from"./arrow-left-D8WG2x54.js";import{F as ee}from"./filter-D6bLByv0.js";import{S as te}from"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-CTYUerkF.js";import{U as se}from"./users-D7Tuokb6.js";import{S as oe}from"./save-CRTAHZ7l.js";import"./index-eC3UseKr.js";import"./floating-ui.vue-Dh3PtXWr.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-B9BjjAzV.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Yx0KRnIq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Bzd4v709.js";import"./chevrons-up-down-BJboRNQX.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CaQD4ow2.js";import"./shield-CuTki8bK.js";import"./vote-g0ALr4J6.js";import"./file-text-CtxvRxgI.js";import"./calendar-D8h2TRFa.js";import"./briefcase-DFGtQ0ih.js";import"./megaphone-BrLqk9RS.js";import"./user-check-Cw_Hk92u.js";import"./external-link-y4Y8-_If.js";import"./panel-left-CaJdFmoV.js";import"./check-DZ7iUqqW.js";import"./index-ChyT-eIJ.js";import"./index-sQW8ojil.js";import"./index-gwBf39mY.js";import"./VisuallyHidden-DSiDYQnX.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHiddenInput-Ck_lXZrK.js";import"./RovingFocusItem-nUmuoxyz.js";import"./utils-BJip8Ajr.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-NRD0LGOK.js";import"./x-DLhFz7rA.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-1K07RW3-.js";import"./chevron-left-D5VSZxmu.js";import"./es-BRx6Co7f.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-DZkizbyH.js";import"./loader-circle-0q5bS16N.js";import"./trash-2-CQ9LI6mZ.js";import"./plus-CiipFUkx.js";import"./search-C0G2nk2T.js";import"./history-DD6jJYrT.js";import"./circle-alert-DGE6tPNi.js";import"./index-DLkrNsae.js";import"./user-Dv4pr1wi.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Bd1jd4w6.js";import"./map-pin-kY8zZrAY.js";const le={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ie={class:"flex items-center justify-between"},re={class:"space-y-2"},ae={class:"space-y-2"},ne={class:"space-y-2"},de={class:"flex items-center justify-between"},me={class:"space-y-0.5"},ue={class:"flex items-center space-x-2"},fe={class:"space-y-2"},pe={class:"grid grid-cols-2 gap-2"},_e={class:"flex items-center px-3 py-2 bg-muted rounded-md"},ge={class:"text-sm text-muted-foreground"},ce={class:"grid grid-cols-2 gap-2 mt-2"},ve={key:0,class:"space-y-3"},ye={class:"flex-1"},xe={class:"text-xs text-muted-foreground mt-1"},be={key:1,class:"text-center py-8 text-muted-foreground"},$e={class:"flex justify-end gap-4"},At=L({__name:"Create",props:{roles:{},filterFieldsConfig:{},modelTypes:{}},setup(Ce){const U=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Segmentos",href:"/admin/segments"},{title:"Crear Segmento",href:"#"}],i=M({name:"",description:"",model_type:"App\\Models\\User",filters:{},is_dynamic:!0,cache_duration:300,role_ids:[]}),D=R(null),N=n=>{const t=i.role_ids.indexOf(n);t>-1?i.role_ids.splice(t,1):i.role_ids.push(n)},A=n=>{i.filters=n},T=()=>{i.post("/admin/segments",{preserveScroll:!0,onSuccess:()=>{}})},q=n=>n<60?`${n} segundos`:n<3600?`${Math.floor(n/60)} minutos`:`${Math.floor(n/3600)} horas`;return(n,t)=>(m(),V(B,{breadcrumbs:U},{default:o(()=>[s(e(h),{title:"Crear Segmento"}),r("div",le,[r("div",ie,[t[10]||(t[10]=r("div",null,[r("h2",{class:"text-2xl font-bold tracking-tight"},"Crear Nuevo Segmento"),r("p",{class:"text-muted-foreground"}," Define un segmento de usuarios basado en filtros dinámicos ")],-1)),s(e(S),{href:n.route("admin.segments.index")},{default:o(()=>[s(e(u),{variant:"outline"},{default:o(()=>[s(e(Z),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=l(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),r("form",{onSubmit:j(T,["prevent"]),class:"space-y-6"},[s(e(W),{defaultValue:"general",class:"space-y-4"},{default:o(()=>[s(e(X),{class:"grid w-full grid-cols-4"},{default:o(()=>[s(e(b),{value:"general"},{default:o(()=>[s(e(z),{class:"mr-2 h-4 w-4"}),t[11]||(t[11]=l(" General ",-1))]),_:1}),s(e(b),{value:"filters"},{default:o(()=>[s(e(ee),{class:"mr-2 h-4 w-4"}),t[12]||(t[12]=l(" Filtros ",-1))]),_:1}),s(e(b),{value:"settings"},{default:o(()=>[s(e(te),{class:"mr-2 h-4 w-4"}),t[13]||(t[13]=l(" Configuración ",-1))]),_:1}),s(e(b),{value:"roles"},{default:o(()=>[s(e(se),{class:"mr-2 h-4 w-4"}),t[14]||(t[14]=l(" Roles ",-1))]),_:1})]),_:1}),s(e($),{value:"general"},{default:o(()=>[s(e(g),null,{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[...t[15]||(t[15]=[l("Información General",-1)])]),_:1}),s(e(x),null,{default:o(()=>[...t[16]||(t[16]=[l(" Define el nombre y descripción del segmento ",-1)])]),_:1})]),_:1}),s(e(y),{class:"space-y-4"},{default:o(()=>[r("div",re,[s(e(d),{htmlFor:"name"},{default:o(()=>[...t[17]||(t[17]=[l("Nombre del Segmento",-1)])]),_:1}),s(e(w),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(i).name=a),placeholder:"Usuarios por Región Norte"},null,8,["modelValue"]),s(p,{message:e(i).errors.name},null,8,["message"])]),r("div",ae,[s(e(d),{htmlFor:"description"},{default:o(()=>[...t[18]||(t[18]=[l("Descripción",-1)])]),_:1}),s(e(P),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":t[1]||(t[1]=a=>e(i).description=a),placeholder:"Describe el propósito y criterios de este segmento...",rows:"4"},null,8,["modelValue"]),s(p,{message:e(i).errors.description},null,8,["message"])]),r("div",ne,[s(e(d),{htmlFor:"model_type"},{default:o(()=>[...t[19]||(t[19]=[l("Tipo de Modelo",-1)])]),_:1}),s(e(G),{modelValue:e(i).model_type,"onUpdate:modelValue":t[2]||(t[2]=a=>e(i).model_type=a)},{default:o(()=>[s(e(E),null,{default:o(()=>[s(e(O),{placeholder:"Selecciona el tipo de modelo"})]),_:1}),s(e(Q),null,{default:o(()=>[(m(!0),_(k,null,F(n.modelTypes,(a,C)=>(m(),V(e(H),{key:C,value:C},{default:o(()=>[l(f(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),t[20]||(t[20]=r("p",{class:"text-xs text-muted-foreground"}," Selecciona el modelo de datos sobre el que aplicar el segmento ",-1)),s(p,{message:e(i).errors.model_type},null,8,["message"])])]),_:1})]),_:1})]),_:1}),s(e($),{value:"filters"},{default:o(()=>[s(e(g),null,{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[...t[21]||(t[21]=[l("Criterios de Filtrado",-1)])]),_:1}),s(e(x),null,{default:o(()=>[...t[22]||(t[22]=[l(" Define los filtros que determinarán qué usuarios pertenecen a este segmento ",-1)])]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[s(Y,{ref_key:"advancedFiltersRef",ref:D,config:{fields:n.filterFieldsConfig,showQuickSearch:!1},route:"",onApply:A},null,8,["config"]),s(p,{message:e(i).errors.filters},null,8,["message"]),t[23]||(t[23]=r("div",{class:"mt-4 p-4 bg-muted/50 rounded-lg"},[r("p",{class:"text-sm text-muted-foreground"},[r("strong",null,"Nota:"),l(" Los filtros definidos aquí serán aplicados dinámicamente para determinar qué usuarios pertenecen a este segmento. Los segmentos dinámicos se recalculan automáticamente según los criterios establecidos. ")])],-1))]),_:1})]),_:1})]),_:1}),s(e($),{value:"settings"},{default:o(()=>[s(e(g),null,{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[...t[24]||(t[24]=[l("Configuración del Segmento",-1)])]),_:1}),s(e(x),null,{default:o(()=>[...t[25]||(t[25]=[l(" Ajusta el comportamiento y cache del segmento ",-1)])]),_:1})]),_:1}),s(e(y),{class:"space-y-6"},{default:o(()=>[r("div",de,[r("div",me,[s(e(d),null,{default:o(()=>[...t[26]||(t[26]=[l("Tipo de Segmento",-1)])]),_:1}),t[27]||(t[27]=r("p",{class:"text-sm text-muted-foreground"}," Los segmentos dinámicos se recalculan en tiempo real ",-1))]),r("div",ue,[s(e(d),{htmlFor:"is_dynamic",class:"text-sm"},{default:o(()=>[...t[28]||(t[28]=[l("Dinámico",-1)])]),_:1}),s(e(I),{id:"is_dynamic",modelValue:e(i).is_dynamic,"onUpdate:modelValue":t[3]||(t[3]=a=>e(i).is_dynamic=a)},null,8,["modelValue"])])]),r("div",fe,[s(e(d),{htmlFor:"cache_duration"},{default:o(()=>[...t[29]||(t[29]=[l("Duración del Cache (segundos)",-1)])]),_:1}),r("div",pe,[s(e(w),{id:"cache_duration",modelValue:e(i).cache_duration,"onUpdate:modelValue":t[4]||(t[4]=a=>e(i).cache_duration=a),modelModifiers:{number:!0},type:"number",min:"0",max:"86400"},null,8,["modelValue"]),r("div",_e,[r("span",ge,f(q(e(i).cache_duration)),1)])]),t[30]||(t[30]=r("p",{class:"text-xs text-muted-foreground"}," Tiempo que se mantendrán en cache los resultados del segmento (0 = sin cache) ",-1)),s(p,{message:e(i).errors.cache_duration},null,8,["message"])]),r("div",null,[s(e(d),{class:"text-sm font-medium"},{default:o(()=>[...t[31]||(t[31]=[l("Valores Predefinidos",-1)])]),_:1}),r("div",ce,[s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[5]||(t[5]=a=>e(i).cache_duration=60)},{default:o(()=>[...t[32]||(t[32]=[l(" 1 minuto ",-1)])]),_:1}),s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[6]||(t[6]=a=>e(i).cache_duration=300)},{default:o(()=>[...t[33]||(t[33]=[l(" 5 minutos ",-1)])]),_:1}),s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[7]||(t[7]=a=>e(i).cache_duration=1800)},{default:o(()=>[...t[34]||(t[34]=[l(" 30 minutos ",-1)])]),_:1}),s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[8]||(t[8]=a=>e(i).cache_duration=3600)},{default:o(()=>[...t[35]||(t[35]=[l(" 1 hora ",-1)])]),_:1})])])]),_:1})]),_:1})]),_:1}),s(e($),{value:"roles"},{default:o(()=>[s(e(g),null,{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[...t[36]||(t[36]=[l("Roles Asociados",-1)])]),_:1}),s(e(x),null,{default:o(()=>[...t[37]||(t[37]=[l(" Vincula este segmento con roles específicos para delimitar el alcance de datos ",-1)])]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[n.roles.length>0?(m(),_("div",ve,[(m(!0),_(k,null,F(n.roles,a=>(m(),_("div",{key:a.id,class:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-muted/50"},[s(e(J),{checked:e(i).role_ids.includes(a.id),"onUpdate:checked":C=>N(a.id),class:"mt-1"},null,8,["checked","onUpdate:checked"]),r("div",ye,[s(e(d),{class:"text-sm font-medium cursor-pointer"},{default:o(()=>[l(f(a.display_name),1)]),_:2},1024),r("p",xe,f(a.description||"Sin descripción"),1),s(e(K),{variant:"outline",class:"mt-2"},{default:o(()=>[l(f(a.name),1)]),_:2},1024)])]))),128))])):(m(),_("div",be," No hay roles disponibles ")),s(p,{message:e(i).errors.role_ids},null,8,["message"])]),_:1})]),_:1})]),_:1})]),_:1}),r("div",$e,[s(e(S),{href:n.route("admin.segments.index")},{default:o(()=>[s(e(u),{type:"button",variant:"outline"},{default:o(()=>[...t[38]||(t[38]=[l(" Cancelar ",-1)])]),_:1})]),_:1},8,["href"]),s(e(u),{type:"submit",disabled:e(i).processing},{default:o(()=>[s(e(oe),{class:"mr-2 h-4 w-4"}),l(" "+f(e(i).processing?"Creando...":"Crear Segmento"),1)]),_:1},8,["disabled"])])],32)])]),_:1}))}});export{At as default};
