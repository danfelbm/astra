import{_ as M}from"./index-CsjRfzmR.js";import{_ as p}from"./createLucideIcon-BYllV5HV.js";import{_,c as g,a as G,b as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-DYJiR0p0.js";import{a as W}from"./Label.vue_vue_type_script_setup_true_lang-CgIva2F9.js";import{_ as O,a as X,b as q,c as J,d as K}from"./SelectValue.vue_vue_type_script_setup_true_lang-r7XLmnfE.js";import{_ as Q,a as Y,b as P,c as u,d as Z,e as f}from"./TableHeader.vue_vue_type_script_setup_true_lang-CxbArdE-.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-DoxXDT1a.js";import{d as se,k as S,a as c,o as d,b as s,u as e,m as te,e as t,f as r,t as i,j as m,i as x,g as n,F as h,r as $,n as le,l as ae,v as oe,W as b}from"./app-CvmEvLYR.js";import{P as re}from"./plus-e8N9cuUE.js";import{A as B}from"./arrow-left-BGXglPm8.js";import{F as T}from"./index-DInCOE0r.js";import{C as A}from"./circle-check-big-ZL9lZIrE.js";import{C as w}from"./clock-EqkxgZ8m.js";import{C as E}from"./circle-x-DBzayn8K.js";import{S as ne}from"./search-B4jdmojU.js";import{E as ie}from"./eye-VdhGunbM.js";import"./VisuallyHidden-NjImnF9U.js";import"./check-dzKj6L88.js";import"./index-gc5pLPKR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Dm0IxuZI.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-5vU3YFIn.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-YDjYOfNF.js";const de={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ue={class:"flex items-center justify-between"},fe={class:"text-3xl font-bold"},ce={class:"text-muted-foreground"},me={class:"flex gap-2"},pe={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},_e={class:"flex items-center space-x-2"},ge={class:"text-2xl font-bold"},ve={class:"flex items-center space-x-2"},be={class:"text-2xl font-bold text-green-600"},xe={class:"flex items-center space-x-2"},he={class:"text-2xl font-bold text-blue-600"},ye={class:"flex items-center space-x-2"},$e={class:"text-2xl font-bold text-red-600"},we={class:"flex gap-4"},Ce={class:"flex-1"},ke={class:"relative"},Ve={class:"w-48"},Ie={key:0,class:"text-center py-8 text-muted-foreground"},Ge={key:0},Fe={key:1},Pe={class:"flex items-center gap-2"},Se={class:"w-20 bg-gray-200 rounded-full h-2"},Be={class:"text-xs text-muted-foreground"},Te={class:"text-sm"},Ae={key:2,class:"mt-4 flex justify-center"},Ee={class:"flex gap-2"},os=se({__name:"Index",props:{votacion:{},imports:{},isGeneral:{type:Boolean}},setup(N){const v=N,C=S(""),k=S("all"),U=v.isGeneral?[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Importaciones",href:"#"}]:[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:v.votacion.titulo,href:`/admin/votaciones/${v.votacion.id}/edit`},{title:"Historial de Importaciones",href:"#"}],j=[{value:"all",label:"Todos"},{value:"pending",label:"Pendientes"},{value:"processing",label:"Procesando"},{value:"completed",label:"Completadas"},{value:"failed",label:"Fallidas"}],y=a=>{switch(a){case"pending":return{icon:w,label:"Pendiente",class:"bg-yellow-100 text-yellow-800 border-yellow-300"};case"processing":return{icon:w,label:"Procesando",class:"bg-blue-100 text-blue-800 border-blue-300"};case"completed":return{icon:A,label:"Completada",class:"bg-green-100 text-green-800 border-green-300"};case"failed":return{icon:E,label:"Fallida",class:"bg-red-100 text-red-800 border-red-300"}}},V=()=>{v.votacion&&b.get(`/admin/votaciones/${v.votacion.id}/edit`)},z=()=>{b.get("/admin/usuarios")},I=()=>{b.get("/admin/imports/create")},D=a=>{b.get(`/admin/imports/${a}`)},H=a=>new Date(a).toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=a=>{if(a.status==="pending")return"En cola";if(a.status==="processing")return`${a.processed_rows}/${a.total_rows} procesados`;if(a.status==="failed")return"Falló durante procesamiento";const l=[];return a.successful_rows>0&&l.push(`${a.successful_rows} exitosos`),a.failed_rows>0&&l.push(`${a.failed_rows} errores`),l.join(", ")||"Sin datos"};return(a,l)=>(d(),c(h,null,[s(e(te),{title:a.isGeneral?"Importaciones de Usuarios":"Historial de Importaciones"},null,8,["title"]),s(ee,{breadcrumbs:e(U)},{default:t(()=>[r("div",de,[r("div",ue,[r("div",null,[r("h1",fe,i(a.isGeneral?"Importaciones de Usuarios":"Historial de Importaciones"),1),r("p",ce,i(a.isGeneral?"Gestiona las importaciones CSV de usuarios":`Votación: ${a.votacion.titulo}`),1)]),r("div",me,[a.isGeneral?(d(),m(e(p),{key:0,onClick:I},{default:t(()=>[s(e(re),{class:"mr-2 h-4 w-4"}),l[3]||(l[3]=n(" Nueva Importación "))]),_:1})):x("",!0),a.isGeneral?(d(),m(e(p),{key:1,variant:"outline",onClick:z},{default:t(()=>[s(e(B),{class:"mr-2 h-4 w-4"}),l[4]||(l[4]=n(" Volver a Usuarios "))]),_:1})):x("",!0),a.isGeneral?x("",!0):(d(),m(e(p),{key:2,variant:"outline",onClick:V},{default:t(()=>[s(e(B),{class:"mr-2 h-4 w-4"}),l[5]||(l[5]=n(" Volver a Votación "))]),_:1}))])]),r("div",pe,[s(e(_),null,{default:t(()=>[s(e(g),{class:"pt-6"},{default:t(()=>[r("div",_e,[s(e(T),{class:"h-5 w-5 text-muted-foreground"}),r("div",null,[r("p",ge,i(a.imports.total),1),l[6]||(l[6]=r("p",{class:"text-xs text-muted-foreground"},"Total Importaciones",-1))])])]),_:1})]),_:1}),s(e(_),null,{default:t(()=>[s(e(g),{class:"pt-6"},{default:t(()=>[r("div",ve,[s(e(A),{class:"h-5 w-5 text-green-600"}),r("div",null,[r("p",be,i(a.imports.data.filter(o=>o.status==="completed").length),1),l[7]||(l[7]=r("p",{class:"text-xs text-muted-foreground"},"Completadas",-1))])])]),_:1})]),_:1}),s(e(_),null,{default:t(()=>[s(e(g),{class:"pt-6"},{default:t(()=>[r("div",xe,[s(e(w),{class:"h-5 w-5 text-blue-600"}),r("div",null,[r("p",he,i(a.imports.data.filter(o=>["pending","processing"].includes(o.status)).length),1),l[8]||(l[8]=r("p",{class:"text-xs text-muted-foreground"},"Activas",-1))])])]),_:1})]),_:1}),s(e(_),null,{default:t(()=>[s(e(g),{class:"pt-6"},{default:t(()=>[r("div",ye,[s(e(E),{class:"h-5 w-5 text-red-600"}),r("div",null,[r("p",$e,i(a.imports.data.filter(o=>o.status==="failed").length),1),l[9]||(l[9]=r("p",{class:"text-xs text-muted-foreground"},"Fallidas",-1))])])]),_:1})]),_:1})]),s(e(_),null,{default:t(()=>[s(e(G),null,{default:t(()=>[s(e(F),null,{default:t(()=>l[10]||(l[10]=[n("Filtros")])),_:1})]),_:1}),s(e(g),null,{default:t(()=>[r("div",we,[r("div",Ce,[r("div",ke,[s(e(ne),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s(e(W),{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=o=>C.value=o),placeholder:"Buscar por nombre de archivo...",class:"pl-9"},null,8,["modelValue"])])]),r("div",Ve,[s(e(O),{modelValue:k.value,"onUpdate:modelValue":l[1]||(l[1]=o=>k.value=o)},{default:t(()=>[s(e(X),null,{default:t(()=>[s(e(q),{placeholder:"Estado"})]),_:1}),s(e(J),null,{default:t(()=>[(d(),c(h,null,$(j,o=>s(e(K),{key:o.value,value:o.value},{default:t(()=>[n(i(o.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1}),s(e(_),null,{default:t(()=>[s(e(G),null,{default:t(()=>[s(e(F),null,{default:t(()=>[n("Importaciones ("+i(a.imports.total)+")",1)]),_:1})]),_:1}),s(e(g),null,{default:t(()=>[a.imports.data.length===0?(d(),c("div",Ie,[s(e(T),{class:"mx-auto h-12 w-12 mb-4"}),a.isGeneral?(d(),c("p",Ge,"No hay importaciones de usuarios registradas")):(d(),c("p",Fe,"No hay importaciones registradas para esta votación")),s(e(p),{variant:"outline",class:"mt-4",onClick:l[2]||(l[2]=o=>a.isGeneral?I():V())},{default:t(()=>[n(i(a.isGeneral?"Crear Primera Importación":"Realizar Primera Importación"),1)]),_:1})])):(d(),m(e(Q),{key:1},{default:t(()=>[s(e(Y),null,{default:t(()=>[s(e(P),null,{default:t(()=>[s(e(u),null,{default:t(()=>l[11]||(l[11]=[n("Archivo")])),_:1}),s(e(u),null,{default:t(()=>l[12]||(l[12]=[n("Estado")])),_:1}),s(e(u),null,{default:t(()=>l[13]||(l[13]=[n("Progreso")])),_:1}),s(e(u),null,{default:t(()=>l[14]||(l[14]=[n("Resultados")])),_:1}),s(e(u),null,{default:t(()=>l[15]||(l[15]=[n("Creado por")])),_:1}),s(e(u),null,{default:t(()=>l[16]||(l[16]=[n("Fecha")])),_:1}),s(e(u),null,{default:t(()=>l[17]||(l[17]=[n("Duración")])),_:1}),s(e(u),{class:"text-right"},{default:t(()=>l[18]||(l[18]=[n("Acciones")])),_:1})]),_:1})]),_:1}),s(e(Z),null,{default:t(()=>[(d(!0),c(h,null,$(a.imports.data,o=>(d(),m(e(P),{key:o.id},{default:t(()=>[s(e(f),{class:"font-medium"},{default:t(()=>[n(i(o.original_filename),1)]),_:2},1024),s(e(f),null,{default:t(()=>[s(e(M),{class:le(y(o.status).class)},{default:t(()=>[(d(),m(ae(y(o.status).icon),{class:"mr-1 h-3 w-3"})),n(" "+i(y(o.status).label),1)]),_:2},1032,["class"])]),_:2},1024),s(e(f),null,{default:t(()=>[r("div",Pe,[r("div",Se,[r("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:oe({width:`${o.progress_percentage}%`})},null,4)]),r("span",Be,i(o.progress_percentage)+"% ",1)])]),_:2},1024),s(e(f),null,{default:t(()=>[r("div",Te,i(L(o)),1)]),_:2},1024),s(e(f),null,{default:t(()=>[n(i(o.created_by.name),1)]),_:2},1024),s(e(f),null,{default:t(()=>[n(i(H(o.created_at)),1)]),_:2},1024),s(e(f),null,{default:t(()=>[n(i(o.duration||"-"),1)]),_:2},1024),s(e(f),{class:"text-right"},{default:t(()=>[s(e(p),{variant:"ghost",size:"sm",onClick:R=>D(o.id)},{default:t(()=>[s(e(ie),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})),a.imports.last_page>1?(d(),c("div",Ae,[r("div",Ee,[(d(!0),c(h,null,$(a.imports.links,o=>(d(),m(e(p),{key:o.label,variant:o.active?"default":"outline",size:"sm",disabled:!o.url,onClick:R=>o.url&&e(b).get(o.url),innerHTML:o.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):x("",!0)]),_:1})]),_:1})])]),_:1},8,["breadcrumbs"])],64))}});export{os as default};
