import{a as F,b as M,_ as P}from"./index-DFMQtHIN.js";import{_ as $}from"./createLucideIcon-Dk3zluZI.js";import{_ as G}from"./Label.vue_vue_type_script_setup_true_lang-4iKq4xxO.js";import{t as g}from"./index-EWMIzLdg.js";import{U as L}from"./user-CUHyzddX.js";import{L as R}from"./loader-circle-Be3HcCHC.js";import{U as T}from"./upload-BXwsV6Tt.js";import{X as I}from"./x-B8GY1MI9.js";import{d as W,r as y,m as J,i as d,e as s,j as m,g as r,b as c,u as o,w as h,h as b,t as p,f as k,n as q}from"./app-DiTimFRW.js";const O={class:"space-y-2"},X={key:0},H={key:1,class:"text-sm text-muted-foreground"},K={class:"flex items-start space-x-4"},Q={key:1,class:"text-2xl font-semibold"},Y={class:"flex-1 space-y-2"},Z=["accept","disabled"],ee={class:"space-y-2"},ae={class:"flex justify-center"},se={class:"text-sm"},te={key:0,class:"text-muted-foreground"},re={key:1,class:"text-muted-foreground"},oe={class:"text-xs text-muted-foreground"},ve=W({__name:"AvatarUpload",props:{modelValue:{},label:{default:"Foto de perfil"},description:{default:"JPG, PNG o WEBP. Máximo 5MB."},maxSize:{default:5},accept:{default:".jpg,.jpeg,.png,.webp"},userName:{default:"Usuario"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","upload","delete","error"],setup(D,{emit:U}){const _=D,u=U,f=y(!1),i=y(!1),v=y(),n=y(null);J(()=>_.modelValue,e=>{n.value=e},{immediate:!0});const B=e=>e.split(" ").map(a=>a[0]).join("").toUpperCase().substring(0,2),C=["image/jpeg","image/jpg","image/png","image/webp"],N=e=>{if(!C.includes(e.type))return"Tipo de archivo no válido. Solo se permiten JPG, PNG y WEBP.";const a=_.maxSize*1024*1024;return e.size>a?`El archivo excede el tamaño máximo de ${_.maxSize}MB.`:null},x=async e=>{const a=N(e);if(a){g.error(a),u("error",a);return}try{i.value=!0;const t=new FileReader;t.onload=l=>{var w;n.value=(w=l.target)==null?void 0:w.result},t.readAsDataURL(e),u("upload",e),g.success("Avatar cargado correctamente")}catch{const l="Error al cargar el archivo";g.error(l),u("error",l)}finally{i.value=!1}},z=e=>{var l;const t=(l=e.target.files)==null?void 0:l[0];t&&x(t)},S=e=>{e.preventDefault(),f.value=!0},V=e=>{e.preventDefault(),f.value=!1},j=e=>{var t;e.preventDefault(),f.value=!1;const a=(t=e.dataTransfer)==null?void 0:t.files[0];a&&a.type.startsWith("image/")&&x(a)},A=()=>{var e;(e=v.value)==null||e.click()},E=()=>{n.value=null,u("update:modelValue",null),u("delete"),g.success("Avatar eliminado correctamente"),v.value&&(v.value.value="")};return(e,a)=>(s(),d("div",O,[e.label||e.description?(s(),d("div",X,[e.label?(s(),c(o(G),{key:0,class:"text-sm font-medium"},{default:h(()=>[b(p(e.label),1)]),_:1})):m("",!0),e.description?(s(),d("p",H,p(e.description),1)):m("",!0)])):m("",!0),r("div",K,[k(o(P),{class:"h-24 w-24"},{default:h(()=>[n.value?(s(),c(o(F),{key:0,src:n.value,alt:e.userName},null,8,["src","alt"])):m("",!0),k(o(M),{class:"bg-muted"},{default:h(()=>[!e.userName||e.userName==="Usuario"?(s(),c(o(L),{key:0,class:"h-12 w-12 text-muted-foreground"})):(s(),d("span",Q,p(B(e.userName)),1))]),_:1})]),_:1}),r("div",Y,[r("div",{onDragover:S,onDragleave:V,onDrop:j,class:q(["border-2 border-dashed rounded-lg p-4 text-center cursor-pointer transition-colors",f.value?"border-primary bg-primary/5":"border-border hover:border-primary/50",e.disabled?"opacity-50 cursor-not-allowed":""]),onClick:A},[r("input",{ref_key:"fileInputRef",ref:v,type:"file",accept:e.accept,onChange:z,disabled:e.disabled||i.value,class:"hidden"},null,40,Z),r("div",ee,[r("div",ae,[i.value?(s(),c(o(R),{key:0,class:"h-8 w-8 animate-spin text-primary"})):(s(),c(o(T),{key:1,class:"h-8 w-8 text-muted-foreground"}))]),r("div",se,[i.value?(s(),d("span",te,"Cargando...")):(s(),d("span",re,[...a[0]||(a[0]=[b(" Arrastra una imagen aquí o ",-1),r("span",{class:"text-primary font-medium"},"selecciona un archivo",-1)])]))]),r("p",oe,p(e.accept.replace(/\./g,"").toUpperCase().replace(/,/g,", "))+" • Max "+p(e.maxSize)+"MB ",1)])],34),n.value?(s(),c(o($),{key:0,onClick:E,variant:"outline",size:"sm",disabled:e.disabled||i.value,class:"w-full"},{default:h(()=>[k(o(I),{class:"h-4 w-4 mr-2"}),a[1]||(a[1]=b(" Eliminar avatar ",-1))]),_:1},8,["disabled"])):m("",!0)])])]))}});export{ve as _};
