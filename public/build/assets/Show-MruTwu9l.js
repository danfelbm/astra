import{_ as ro}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DH_sKY2C.js";import{_ as N}from"./index-Djr-AE8L.js";import{_ as C}from"./createLucideIcon-DHV2dMd2.js";import{_ as g,a as k,b as w,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-B83fxqkD.js";import{_ as S}from"./CardDescription.vue_vue_type_script_setup_true_lang-DsA6hK1m.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-BzEX51rz.js";import{_ as uo,a as mo,b as T,c as W}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-ByrEHfPa.js";import{_ as co}from"./Textarea.vue_vue_type_script_setup_true_lang-BiO7vH4G.js";import{d as po,C as fo,k as X,c as x,a as u,o as d,b as e,u as a,m as _o,e as t,f as s,j as b,i as f,W as vo,g as i,t as r,n as h,l as G,F as V,r as j}from"./app-o0VcnfvT.js";import{A as bo}from"./arrow-left-DdTyrpmI.js";import{U as P}from"./user-CwkVrL5s.js";import{F as R}from"./file-text-B3ELD67O.js";import{S as M}from"./send-VVo6ximE.js";import{C as U}from"./clock-C1fP0aO7.js";import{C as q}from"./circle-check-big-CLyvYKRs.js";import{C as I}from"./circle-x-CIX4bS05.js";import{S as D}from"./square-pen-BQX7CWXF.js";import{C as go}from"./circle-alert-E7ND0NcF.js";import{M as yo}from"./message-square-v6j-l3S7.js";import{H as xo}from"./history-Acl6VWXg.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BQLGFJn7.js";import"./index-CQK0tQuB.js";import"./floating-ui.vue-B7OURiaf.js";import"./x-Bk6mROj6.js";import"./Input.vue_vue_type_script_setup_true_lang-WPXtkr_n.js";import"./index-DzXh5xdq.js";import"./shield-B8n_8DBi.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Bx2c5sC2.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DdTTQIRe.js";import"./VisuallyHidden-CvCQINmH.js";import"./PopperContent-CuoIICBD.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-BKOHoo5T.js";import"./check-K7jA5jiq.js";import"./nullish-CHIgUVhi.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-C-jvWsF7.js";import"./index-B9BCn2_n.js";import"./map-pin-D0bJVCbX.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-wJtPPtPO.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-C4Px9OO6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-BjWNjkHI.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-dEcN0GvJ.js";import"./users-C6pYsYmu.js";import"./vote-TfssO0t8.js";import"./calendar-DcMtuu5p.js";import"./briefcase-_GQULPTE.js";import"./megaphone-Dj1OROVd.js";import"./user-check-BUfceOdp.js";import"./external-link-CWutwPXI.js";import"./panel-left-DwF_86xt.js";import"./index-K2vy_Ox9.js";import"./RovingFocusItem-CT7DNy83.js";import"./utils-BAKO7Pan.js";const Co={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ko={class:"space-y-6"},wo={class:"flex items-center justify-between"},$o={class:"space-y-1"},ho={class:"flex items-center gap-2"},Ao={class:"text-3xl font-bold tracking-tight"},Eo={class:"text-muted-foreground"},Ro={class:"grid gap-6 md:grid-cols-2"},zo={class:"font-medium"},Fo={class:"font-medium"},Bo={class:"font-medium"},No={class:"font-medium"},So={class:"font-medium"},Vo={class:"font-medium"},jo={class:"font-medium"},Po={class:"font-medium"},Mo={key:0,class:"text-center py-8 text-muted-foreground"},Uo={key:1,class:"space-y-4"},qo={key:0,class:"font-medium mt-1"},Io={key:1,class:"font-medium mt-1"},Do={key:1,class:"space-y-4"},Ho={class:"grid grid-cols-2 gap-4"},Lo={class:"font-medium"},Oo={class:"font-medium"},To={class:"font-medium"},Wo={class:"font-medium"},Xo={class:"space-y-4"},Go={class:"font-medium mt-1"},Jo={key:0,class:"flex flex-wrap gap-2"},Ko={key:1,class:"space-y-4"},Qo={class:"flex items-center gap-2 p-3 bg-muted rounded-lg"},Yo={class:"text-sm"},Zo={key:0,class:"text-sm text-red-600 mt-1"},oa={class:"flex gap-2"},aa={key:0},ea={class:"font-medium"},ta={class:"text-sm text-muted-foreground"},sa={key:1},la={class:"font-medium"},ia={class:"space-y-4"},na={key:0,class:"absolute left-6 top-12 w-px h-full bg-border"},ra={class:"flex-1 min-w-0"},da={class:"flex items-center gap-2 mb-1"},ua={class:"flex items-center justify-between mb-2"},ma={class:"text-sm font-medium"},ca={class:"text-xs text-muted-foreground"},pa={class:"space-y-2"},fa={class:"flex items-center gap-2 text-sm"},_a={class:"font-medium"},va={class:"text-muted-foreground"},ba={key:0,class:"text-sm"},ga={class:"mt-1 p-2 bg-muted rounded text-sm"},ge=po({__name:"Show",props:{postulacion:{},canRevisar:{type:Boolean},canAprobar:{type:Boolean},canRechazar:{type:Boolean}},setup(J){const c=J,K=[{title:"Admin",href:"/admin/dashboard"},{title:"Postulaciones",href:"/admin/postulaciones"},{title:`${c.postulacion.usuario.name}`,href:`/admin/postulaciones/${c.postulacion.id}`}],_=fo({estado:"",comentarios:""}),z=X(!1),F=X(""),Q=l=>{switch(l){case"borrador":return D;case"enviada":return M;case"en_revision":return U;case"aceptada":return q;case"rechazada":return I;default:return R}},H=x(()=>{const l={};for(const[o,n]of Object.entries(c.postulacion.formulario_data)){const p=c.postulacion.convocatoria.formulario_postulacion.find(v=>v.id===o);p&&(l[p.title]=Array.isArray(n)?n.join(", "):n)}return l}),$=x(()=>{var o,n,p,v,E,B,O;if(!c.postulacion.candidatura_snapshot)return null;const l=c.postulacion.candidatura_snapshot;return{usuario:((o=l.usuario)==null?void 0:o.name)||"N/A",version:((n=l.candidatura)==null?void 0:n.version_original)||"N/A",fecha_aprobacion:((p=l.candidatura)==null?void 0:p.fecha_aprobacion)||"N/A",aprobado_por:((E=(v=l.candidatura)==null?void 0:v.aprobado_por)==null?void 0:E.name)||"N/A",formulario_data:((B=l.candidatura)==null?void 0:B.formulario_data)||{},configuracion_campos:((O=l.configuracion_en_momento)==null?void 0:O.campos)||[]}}),Y=x(()=>{if(!$.value)return{};const l={},{formulario_data:o,configuracion_campos:n}=$.value;for(const[p,v]of Object.entries(o)){const E=n.find(B=>B.id===p);E&&(l[E.title]=Array.isArray(v)?v.join(", "):v)}return l}),A=l=>{F.value=l,_.estado=l,_.comentarios="",z.value=!0},Z=()=>{_.post(`/admin/postulaciones/${c.postulacion.id}/cambiar-estado`,{onSuccess:()=>{z.value=!1}})},oo=()=>{z.value=!1,F.value="",_.reset()},ao=x(()=>c.canRevisar&&["borrador","enviada","rechazada"].includes(c.postulacion.estado)),eo=x(()=>c.canAprobar&&["enviada","en_revision"].includes(c.postulacion.estado)),to=x(()=>c.canRechazar&&["enviada","en_revision"].includes(c.postulacion.estado)),so=x(()=>c.canRevisar&&["enviada","en_revision","aceptada","rechazada"].includes(c.postulacion.estado)),lo=x(()=>c.canRevisar&&c.postulacion.estado==="borrador"),io=l=>({enviada:"Enviada",en_revision:"En Revisión",aceptada:"Aceptada",rechazada:"Rechazada",borrador:"Borrador"})[l]||l,L=x(()=>["rechazada"].includes(F.value)),no=l=>({CheckCircle:q,XCircle:I,Clock:U,Send:M,Edit:D,FileText:R})[l]||R;return(l,o)=>(d(),u(V,null,[e(a(_o),{title:`Postulación de ${l.postulacion.usuario.name}`},null,8,["title"]),e(ro,{breadcrumbs:K},{default:t(()=>[s("div",Co,[s("div",ko,[s("div",wo,[s("div",$o,[s("div",ho,[e(a(C),{variant:"ghost",size:"sm",onClick:o[0]||(o[0]=n=>a(vo).get("/admin/postulaciones"))},{default:t(()=>[e(a(bo),{class:"h-4 w-4 mr-2"}),o[7]||(o[7]=i(" Volver ",-1))]),_:1})]),s("h1",Ao," Postulación de "+r(l.postulacion.usuario.name),1),s("p",Eo,r(l.postulacion.convocatoria.nombre),1)]),e(a(N),{class:h([l.postulacion.estado_color,"text-base px-3 py-1"])},{default:t(()=>[(d(),b(G(Q(l.postulacion.estado)),{class:"mr-2 h-4 w-4"})),i(" "+r(l.postulacion.estado_label),1)]),_:1},8,["class"])]),s("div",Ro,[e(a(g),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),{class:"flex items-center gap-2"},{default:t(()=>[e(a(P),{class:"h-5 w-5"}),o[8]||(o[8]=i(" Información del Usuario ",-1))]),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:t(()=>[s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[9]||(o[9]=[i("Nombre:",-1)])]),_:1}),s("p",zo,r(l.postulacion.usuario.name),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[10]||(o[10]=[i("Email:",-1)])]),_:1}),s("p",Fo,r(l.postulacion.usuario.email),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[11]||(o[11]=[i("Fecha postulación:",-1)])]),_:1}),s("p",Bo,r(l.postulacion.fecha_postulacion||"Borrador"),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[12]||(o[12]=[i("Fecha creación:",-1)])]),_:1}),s("p",No,r(l.postulacion.created_at),1)])]),_:1})]),_:1}),e(a(g),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),{class:"flex items-center gap-2"},{default:t(()=>[e(a(R),{class:"h-5 w-5"}),o[13]||(o[13]=i(" Convocatoria ",-1))]),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:t(()=>[s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[14]||(o[14]=[i("Nombre:",-1)])]),_:1}),s("p",So,r(l.postulacion.convocatoria.nombre),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[15]||(o[15]=[i("Cargo:",-1)])]),_:1}),s("p",Vo,r(l.postulacion.convocatoria.cargo),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[16]||(o[16]=[i("Periodo:",-1)])]),_:1}),s("p",jo,r(l.postulacion.convocatoria.periodo),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[17]||(o[17]=[i("Ubicación:",-1)])]),_:1}),s("p",Po,r(l.postulacion.convocatoria.ubicacion),1)])]),_:1})]),_:1})]),e(a(uo),{"default-value":"formulario",class:"space-y-4"},{default:t(()=>[e(a(mo),{class:"grid w-full grid-cols-2"},{default:t(()=>[e(a(T),{value:"formulario"},{default:t(()=>[...o[18]||(o[18]=[i(" Respuestas del Formulario ",-1)])]),_:1}),e(a(T),{value:"candidatura",disabled:!l.postulacion.tiene_candidatura_vinculada},{default:t(()=>[o[20]||(o[20]=i(" Perfil de Candidatura ",-1)),l.postulacion.tiene_candidatura_vinculada?(d(),b(a(N),{key:0,variant:"secondary",class:"ml-2"},{default:t(()=>[...o[19]||(o[19]=[i(" Vinculado ",-1)])]),_:1})):f("",!0)]),_:1},8,["disabled"])]),_:1}),e(a(W),{value:"formulario",class:"space-y-4"},{default:t(()=>[e(a(g),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),null,{default:t(()=>[...o[21]||(o[21]=[i("Respuestas del Formulario de Postulación",-1)])]),_:1}),e(a(S),null,{default:t(()=>[...o[22]||(o[22]=[i(" Respuestas proporcionadas por el usuario en el formulario de postulación. ",-1)])]),_:1})]),_:1}),e(a(y),null,{default:t(()=>[Object.keys(H.value).length===0?(d(),u("div",Mo,[e(a(R),{class:"mx-auto h-12 w-12 mb-2"}),o[23]||(o[23]=s("p",null,"No hay respuestas del formulario disponibles.",-1))])):(d(),u("div",Uo,[(d(!0),u(V,null,j(H.value,(n,p)=>(d(),u("div",{key:p,class:"border rounded-lg p-4"},[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[i(r(p)+":",1)]),_:2},1024),typeof n=="string"&&n.length>100?(d(),u("p",qo,r(n),1)):(d(),u("p",Io,r(n||"Sin respuesta"),1))]))),128))]))]),_:1})]),_:1})]),_:1}),e(a(W),{value:"candidatura",class:"space-y-4"},{default:t(()=>[l.postulacion.tiene_candidatura_vinculada?(d(),u("div",Do,[e(a(g),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),null,{default:t(()=>[...o[25]||(o[25]=[i("Información del Perfil de Candidatura",-1)])]),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:t(()=>[s("div",Ho,[s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[26]||(o[26]=[i("Usuario:",-1)])]),_:1}),s("p",Lo,r($.value.usuario),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[27]||(o[27]=[i("Versión:",-1)])]),_:1}),s("p",Oo,"v"+r($.value.version),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[28]||(o[28]=[i("Fecha aprobación:",-1)])]),_:1}),s("p",To,r($.value.fecha_aprobacion),1)]),s("div",null,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[29]||(o[29]=[i("Aprobado por:",-1)])]),_:1}),s("p",Wo,r($.value.aprobado_por),1)])])]),_:1})]),_:1}),e(a(g),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),null,{default:t(()=>[...o[30]||(o[30]=[i("Datos del Perfil de Candidatura",-1)])]),_:1}),e(a(S),null,{default:t(()=>[...o[31]||(o[31]=[i(" Información capturada del perfil de candidatura en el momento de la postulación. ",-1)])]),_:1})]),_:1}),e(a(y),null,{default:t(()=>[s("div",Xo,[(d(!0),u(V,null,j(Y.value,(n,p)=>(d(),u("div",{key:p,class:"border rounded-lg p-4"},[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[i(r(p)+":",1)]),_:2},1024),s("p",Go,r(n||"Sin información"),1)]))),128))])]),_:1})]),_:1})])):(d(),b(a(g),{key:0},{default:t(()=>[e(a(y),{class:"text-center py-8"},{default:t(()=>[e(a(P),{class:"mx-auto h-12 w-12 text-muted-foreground mb-2"}),o[24]||(o[24]=s("p",{class:"text-muted-foreground"},"No hay perfil de candidatura vinculado a esta postulación.",-1))]),_:1})]),_:1}))]),_:1})]),_:1}),e(a(g),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),null,{default:t(()=>[...o[32]||(o[32]=[i("Gestión de Estado",-1)])]),_:1}),e(a(S),null,{default:t(()=>[...o[33]||(o[33]=[i(" Cambia el estado de la postulación según el flujo de revisión. ",-1)])]),_:1})]),_:1}),e(a(y),null,{default:t(()=>[z.value?(d(),u("div",Ko,[s("div",Qo,[e(a(go),{class:"h-5 w-5 text-amber-600"}),s("p",Yo,[o[39]||(o[39]=i(" ¿Estás seguro de que quieres cambiar el estado a ",-1)),s("strong",null,r(io(F.value)),1),o[40]||(o[40]=i("? ",-1))])]),s("div",null,[e(a(m),{for:"comentarios"},{default:t(()=>[i(" Comentarios "+r(L.value?"(requerido)":"(opcional)"),1)]),_:1}),e(a(co),{id:"comentarios",modelValue:a(_).comentarios,"onUpdate:modelValue":o[6]||(o[6]=n=>a(_).comentarios=n),placeholder:L.value?"Explica el motivo del rechazo...":"Comentarios adicionales...",rows:"3",class:h([a(_).errors.comentarios?"border-red-300":""])},null,8,["modelValue","placeholder","class"]),a(_).errors.comentarios?(d(),u("p",Zo,r(a(_).errors.comentarios),1)):f("",!0)]),s("div",oa,[e(a(C),{onClick:Z,disabled:a(_).processing},{default:t(()=>[...o[41]||(o[41]=[i(" Confirmar Cambio ",-1)])]),_:1},8,["disabled"]),e(a(C),{variant:"outline",onClick:oo,disabled:a(_).processing},{default:t(()=>[...o[42]||(o[42]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"])])])):(d(),u("div",Jo,[lo.value?(d(),b(a(C),{key:0,variant:"outline",onClick:o[1]||(o[1]=n=>A("enviada"))},{default:t(()=>[e(a(M),{class:"mr-2 h-4 w-4"}),o[34]||(o[34]=i(" Marcar como Enviada ",-1))]),_:1})):f("",!0),ao.value?(d(),b(a(C),{key:1,variant:"outline",onClick:o[2]||(o[2]=n=>A("en_revision"))},{default:t(()=>[e(a(U),{class:"mr-2 h-4 w-4"}),o[35]||(o[35]=i(" Marcar en Revisión ",-1))]),_:1})):f("",!0),eo.value?(d(),b(a(C),{key:2,onClick:o[3]||(o[3]=n=>A("aceptada"))},{default:t(()=>[e(a(q),{class:"mr-2 h-4 w-4"}),o[36]||(o[36]=i(" Aceptar ",-1))]),_:1})):f("",!0),to.value?(d(),b(a(C),{key:3,variant:"destructive",onClick:o[4]||(o[4]=n=>A("rechazada"))},{default:t(()=>[e(a(I),{class:"mr-2 h-4 w-4"}),o[37]||(o[37]=i(" Rechazar ",-1))]),_:1})):f("",!0),so.value?(d(),b(a(C),{key:4,variant:"outline",onClick:o[5]||(o[5]=n=>A("borrador"))},{default:t(()=>[e(a(D),{class:"mr-2 h-4 w-4"}),o[38]||(o[38]=i(" Volver a Borrador ",-1))]),_:1})):f("",!0)]))]),_:1})]),_:1}),l.postulacion.revisado_por||l.postulacion.comentarios_admin?(d(),b(a(g),{key:0},{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),{class:"flex items-center gap-2"},{default:t(()=>[e(a(yo),{class:"h-5 w-5"}),o[43]||(o[43]=i(" Información de Revisión ",-1))]),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:t(()=>[l.postulacion.revisado_por?(d(),u("div",aa,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[44]||(o[44]=[i("Revisado por:",-1)])]),_:1}),s("p",ea,r(l.postulacion.revisado_por.name),1),s("p",ta,r(l.postulacion.fecha_revision),1)])):f("",!0),l.postulacion.comentarios_admin?(d(),u("div",sa,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[45]||(o[45]=[i("Comentarios:",-1)])]),_:1}),s("p",la,r(l.postulacion.comentarios_admin),1)])):f("",!0)]),_:1})]),_:1})):f("",!0),l.postulacion.historial&&l.postulacion.historial.length>0?(d(),b(a(g),{key:1},{default:t(()=>[e(a(k),null,{default:t(()=>[e(a(w),{class:"flex items-center gap-2"},{default:t(()=>[e(a(xo),{class:"h-5 w-5"}),o[46]||(o[46]=i(" Historial de Cambios ",-1))]),_:1}),e(a(S),null,{default:t(()=>[...o[47]||(o[47]=[i(" Cronología completa de todos los cambios de estado de esta postulación. ",-1)])]),_:1})]),_:1}),e(a(y),null,{default:t(()=>[s("div",ia,[(d(!0),u(V,null,j(l.postulacion.historial,(n,p)=>{var v;return d(),u("div",{key:n.id,class:h(["relative flex items-start gap-4 pb-4",{"border-b border-border":p<l.postulacion.historial.length-1}])},[p<l.postulacion.historial.length-1?(d(),u("div",na)):f("",!0),s("div",{class:h(["flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",[n.tipo_cambio==="positivo"?"bg-green-100 text-green-600":n.tipo_cambio==="negativo"?"bg-red-100 text-red-600":n.tipo_cambio==="progreso"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"]])},[(d(),b(G(no(n.tipo_cambio_icon)),{class:"w-5 h-5"}))],2),s("div",ra,[s("div",da,[e(a(N),{class:h([n.estado_anterior_color,"text-xs"])},{default:t(()=>[i(r(n.estado_anterior_label),1)]),_:2},1032,["class"]),o[48]||(o[48]=s("span",{class:"text-muted-foreground text-sm"},"→",-1)),e(a(N),{class:h([n.estado_nuevo_color,"text-xs"])},{default:t(()=>[i(r(n.estado_nuevo_label),1)]),_:2},1032,["class"])]),s("div",ua,[s("h4",ma,r(n.motivo_cambio||"Cambio de estado"),1),s("span",ca,r(n.tiempo_pasado),1)]),s("div",pa,[s("div",fa,[e(a(P),{class:"w-4 h-4 text-muted-foreground"}),o[49]||(o[49]=s("span",{class:"text-muted-foreground"},"Por:",-1)),s("span",_a,r(((v=n.cambiado_por)==null?void 0:v.name)||"Usuario eliminado"),1),s("span",va," • "+r(n.fecha_cambio),1)]),n.comentarios?(d(),u("div",ba,[e(a(m),{class:"text-muted-foreground"},{default:t(()=>[...o[50]||(o[50]=[i("Comentarios:",-1)])]),_:1}),s("p",ga,r(n.comentarios),1)])):f("",!0)])])],2)}),128))])]),_:1})]),_:1})):f("",!0)])])]),_:1})],64))}});export{ge as default};
