import{d as Z,m as Je,z as Ke,i as p,e as n,j as _,g as r,u as e,f as a,n as O,w as t,c as M,t as c,F as W,k as X,b as x,h as d,q as ie,r as j,T as Xe,J as Ze,K as Qe,C as te,p as Ye,W as fe,s as ea,L as oe,a as ge}from"./app-CNsNbJaU.js";import{_ as P}from"./index-C9GdhwZn.js";import{c as Q,_ as w}from"./createLucideIcon-BG919Rtc.js";import{c as N,_ as R,a as U,b as H}from"./CardTitle.vue_vue_type_script_setup_true_lang-BZnDIsbq.js";import{_ as V}from"./Label.vue_vue_type_script_setup_true_lang-Vr_4JsSA.js";import{_ as aa}from"./Checkbox.vue_vue_type_script_setup_true_lang-CSV_CCrZ.js";import{_ as ve,a as be}from"./index-BIWxKYvV.js";import{u as ta,i as oa,L as ra,E as sa}from"./index-B7HB6itf.js";import{B as na,I as la}from"./italic-7Gz7sU3U.js";import{L as ia}from"./list-BchUdMPt.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as da}from"./HistorialCandidatura.vue_vue_type_script_setup_true_lang-CV8ZGSQ9.js";import{_ as _e}from"./Textarea.vue_vue_type_script_setup_true_lang-h_TvfU7W.js";import{F as Le}from"./file-text-ChTe-w0O.js";import{E as ua}from"./eye-Dp-DTTpt.js";import{D as ca}from"./download-CGgKc1ha.js";import{E as ma}from"./external-link-DsmjA91c.js";import{U as pa}from"./users-DVfvVv5k.js";import{U as le}from"./user-1QV52cLG.js";import{P as fa}from"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DQMYh5Gv.js";import{M as Ve}from"./mail-LPaIvF_v.js";import{C as de}from"./calendar-A9Ja9lbB.js";import{H as ga}from"./hash-DB1kA5-0.js";import{B as va}from"./briefcase-DRGEhwkF.js";import{e as ye,_ as he,a as ke,b as xe,c as we,d as Ce}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CJLkPl9b.js";import{C as Ee}from"./clock-BgJsSDJK.js";import{C as G}from"./circle-check-big-Co5bwIN2.js";import{C as J}from"./circle-x-CcIIXr3e.js";import{M as K}from"./message-square-CNHF0QTF.js";import{P as Te}from"./plus-DV1H89bY.js";import{_ as ba}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B5AmSGvv.js";import{A as _a}from"./arrow-left-CB_1v_Qf.js";import{L as $e}from"./loader-circle-e3mVLjL2.js";import{T as ya,a as ha}from"./toggle-right-BDvE9xHF.js";import{T as Ae}from"./triangle-alert-B20Y7k_S.js";import{S as ka}from"./square-check-big-DHgrQgHs.js";import{C as xa}from"./circle-check-Dr7A9FI-.js";import{H as ze}from"./history-BYwQLNz-.js";import"./index-DokoqITK.js";import"./Input.vue_vue_type_script_setup_true_lang-CIE9aHh6.js";import"./index-D5O-6KMg.js";import"./floating-ui.vue-ClLQHvu2.js";import"./check-CFzf2JYc.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-C5NUUFrZ.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-PEBE5d0i.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-KCVEry-H.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-DNb18nEz.js";import"./VisuallyHidden-L6ik1lx4.js";import"./nullish-CHIgUVhi.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DxRb9IyH.js";import"./x-CH24zYz2.js";import"./index-BQvcUEPK.js";import"./shield-D-rurmJa.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BlN2t4SW.js";import"./index-DDFssNIK.js";import"./circle-alert-DyX8jyra.js";import"./map-pin-BYO7IqQm.js";import"./chevrons-up-down-BCkt__jB.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-jb7cBVQn.js";import"./vote-D2Rn5EGX.js";import"./send-DmP45aay.js";import"./megaphone--fqq65Q3.js";import"./user-check-AWjRCIrv.js";import"./panel-left-C4whrYPC.js";import"./index-B3OyOhdr.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Q("MessageCircleIcon",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=Q("MessageSquareOffIcon",[["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M3.6 3.6c-.4.3-.6.8-.6 1.4v16l4-4h10",key:"pwpm4a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Q("RotateCcwIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=Q("StickyNoteIcon",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=Q("Undo2Icon",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=Q("WrenchIcon",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Sa={class:"w-full"},ja={key:0,class:"flex items-center gap-1 border border-b-0 rounded-t-md bg-muted/30 p-2"},La={class:"border rounded-b-md bg-background"},Va=Z({__name:"RichTextEditor",props:{modelValue:{default:""},placeholder:{default:""},rows:{default:4}},emits:["update:modelValue"],setup(B,{emit:v}){const b=B,z=v,k=ta({content:b.modelValue,extensions:[oa.configure({blockquote:!1,codeBlock:!1,code:!1,dropcursor:!1,gapcursor:!1,heading:!1,horizontalRule:!1,strike:!1})],editorProps:{attributes:{class:"editor-content","data-placeholder":b.placeholder}},onUpdate:({editor:C})=>{z("update:modelValue",C.getHTML())}});return Je(()=>b.modelValue,C=>{k.value&&k.value.getHTML()!==C&&k.value.commands.setContent(C,!1)}),Ke(()=>{var C;(C=k.value)==null||C.destroy()}),(C,y)=>(n(),p("div",Sa,[e(k)?(n(),p("div",ja,[a(e(w),{type:"button",variant:"ghost",size:"sm",onClick:y[0]||(y[0]=u=>e(k).chain().focus().toggleBold().run()),class:O([{"bg-muted":e(k).isActive("bold")},"h-8 w-8 p-0"]),title:"Negrita"},{default:t(()=>[a(e(na),{class:"h-4 w-4"})]),_:1},8,["class"]),a(e(w),{type:"button",variant:"ghost",size:"sm",onClick:y[1]||(y[1]=u=>e(k).chain().focus().toggleItalic().run()),class:O([{"bg-muted":e(k).isActive("italic")},"h-8 w-8 p-0"]),title:"Cursiva"},{default:t(()=>[a(e(la),{class:"h-4 w-4"})]),_:1},8,["class"]),y[4]||(y[4]=r("div",{class:"mx-1 h-6 w-px bg-border"},null,-1)),a(e(w),{type:"button",variant:"ghost",size:"sm",onClick:y[2]||(y[2]=u=>e(k).chain().focus().toggleBulletList().run()),class:O([{"bg-muted":e(k).isActive("bulletList")},"h-8 w-8 p-0"]),title:"Lista con viñetas"},{default:t(()=>[a(e(ia),{class:"h-4 w-4"})]),_:1},8,["class"]),a(e(w),{type:"button",variant:"ghost",size:"sm",onClick:y[3]||(y[3]=u=>e(k).chain().focus().toggleOrderedList().run()),class:O([{"bg-muted":e(k).isActive("orderedList")},"h-8 w-8 p-0"]),title:"Lista numerada"},{default:t(()=>[a(e(ra),{class:"h-4 w-4"})]),_:1},8,["class"])])):_("",!0),r("div",La,[a(e(sa),{editor:e(k),placeholder:C.placeholder,class:"rich-text-editor"},null,8,["editor","placeholder"])])]))}}),re=je(Va,[["__scopeId","data-v-71e35443"]]),Ea={class:"space-y-2"},Ta={key:0},Fa={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Na={key:1,class:"text-sm text-muted-foreground italic"},Ra={key:2,class:"space-y-2"},Ma={class:"flex items-center justify-between"},Ba={class:"flex items-center space-x-3 flex-1 min-w-0"},Da={class:"flex-shrink-0"},Ia={class:"flex-1 min-w-0"},Oa={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},Ua={class:"flex items-center space-x-1 flex-shrink-0"},se=Z({__name:"FileFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1}},setup(B){const v=B,b=M(()=>{if(!v.value)return[];if(Array.isArray(v.value))return v.value.map((s,f)=>{const h=z(s);return{id:`file_${f}`,name:h,path:s,url:s.startsWith("http")?s:`/storage/${s}`,extension:k(h)}});if(typeof v.value=="string"){const s=z(v.value);return[{id:"file_0",name:s,path:v.value,url:v.value.startsWith("http")?v.value:`/storage/${v.value}`,extension:k(s)}]}return[]}),z=s=>{if(!s)return"archivo";const f=s.split("/");return f[f.length-1]||"archivo"},k=s=>{const f=s.split(".");return f.length>1?f[f.length-1].toLowerCase():""},C=s=>{switch(s){case"pdf":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"doc":case"docx":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"xls":case"xlsx":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"jpg":case"jpeg":case"png":case"gif":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},y=s=>{window.open(s,"_blank")},u=(s,f)=>{const h=document.createElement("a");h.href=s+"?download=true",h.download=f,h.target="_blank",document.body.appendChild(h),h.click(),document.body.removeChild(h)};return(s,f)=>(n(),p("div",Ea,[s.showLabel&&s.label?(n(),p("div",Ta,[r("label",Fa,c(s.label),1)])):_("",!0),b.value.length===0?(n(),p("div",Na," No hay archivos adjuntos ")):(n(),p("div",Ra,[(n(!0),p(W,null,X(b.value,h=>(n(),x(e(R),{key:h.id,class:"hover:shadow-md transition-shadow duration-200"},{default:t(()=>[a(e(N),{class:"p-3"},{default:t(()=>[r("div",Ma,[r("div",Ba,[r("div",Da,[a(e(Le),{class:"h-8 w-8 text-red-500"})]),r("div",Ia,[r("p",Oa,c(h.name),1),a(e(P),{class:O([C(h.extension),"mt-1"])},{default:t(()=>[d(c(h.extension.toUpperCase()),1)]),_:2},1032,["class"])])]),r("div",Ua,[a(e(w),{variant:"ghost",size:"sm",onClick:F=>y(h.url),class:"hover:bg-blue-50 dark:hover:bg-blue-900",title:"Ver archivo"},{default:t(()=>[a(e(ua),{class:"h-4 w-4"}),f[0]||(f[0]=r("span",{class:"ml-1 hidden sm:inline"},"Ver",-1))]),_:2},1032,["onClick"]),a(e(w),{variant:"ghost",size:"sm",onClick:F=>u(h.url,h.name),class:"hover:bg-green-50 dark:hover:bg-green-900",title:"Descargar archivo"},{default:t(()=>[a(e(ca),{class:"h-4 w-4"}),f[1]||(f[1]=r("span",{class:"ml-1 hidden sm:inline"},"Descargar",-1))]),_:2},1032,["onClick"]),a(e(w),{variant:"ghost",size:"sm",onClick:F=>y(h.url),class:"hover:bg-purple-50 dark:hover:bg-purple-900",title:"Abrir en nueva pestaña"},{default:t(()=>[a(e(ma),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))]))]))}}),qa={class:"space-y-2"},Ha={key:0,class:"flex items-center gap-2"},Pa={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Wa={key:1,class:"text-sm text-muted-foreground italic"},Ga={key:2,class:"space-y-3"},Ja={class:"flex items-center justify-between"},Ka={class:"flex items-center gap-2"},Xa={class:"flex items-center gap-2 min-w-[140px]"},Za={class:"flex-1"},Qa={key:0,class:"text-sm text-muted-foreground italic"},ne=Z({__name:"RepeaterFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1},fields:{},itemName:{default:"Elemento"}},setup(B){const v=B,b=M(()=>v.value?Array.isArray(v.value)?v.value.map((u,s)=>u.id&&u.data?u:{id:`item_${s}`,data:u}):[]:[]),z=(u,s)=>{if(u==null||u==="")return"No especificado";if(Array.isArray(u))return u.join(", ");if(s&&(s.includes("fecha")||s.includes("date")))try{return new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return u.toString()}return typeof u=="boolean"?u?"Sí":"No":u.toString()},k=u=>{if(v.fields&&v.fields.length>0){const s=v.fields.find(f=>f.id===u);if(s)return s.title}return u.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()).replace(/Id$/i,"").replace(/Contacto$/i,"").trim()},C=u=>{const s=u.toLowerCase();return s.includes("nombre")||s.includes("name")?le:s.includes("telefono")||s.includes("phone")||s.includes("celular")?fa:s.includes("email")||s.includes("correo")?Ve:s.includes("fecha")||s.includes("date")?de:s.includes("numero")||s.includes("cantidad")?ga:s.includes("documento")||s.includes("cedula")?Le:s.includes("cargo")||s.includes("empresa")||s.includes("trabajo")?va:null},y=u=>["nombre","name","titulo","title","cargo","empresa"].some(f=>u.toLowerCase().includes(f));return(u,s)=>(n(),p("div",qa,[u.showLabel&&u.label?(n(),p("div",Ha,[a(e(pa),{class:"h-4 w-4 text-muted-foreground"}),r("label",Pa,c(u.label),1),a(e(P),{variant:"secondary",class:"ml-2"},{default:t(()=>[d(c(b.value.length)+" "+c(b.value.length===1?u.itemName:`${u.itemName}s`),1)]),_:1})])):_("",!0),b.value.length===0?(n(),p("div",Wa," No hay "+c(u.itemName.toLowerCase())+"s registrados ",1)):(n(),p("div",Ga,[(n(!0),p(W,null,X(b.value,(f,h)=>(n(),x(e(R),{key:f.id,class:"hover:shadow-md transition-all duration-200"},{default:t(()=>[a(e(U),{class:"pb-3"},{default:t(()=>[r("div",Ja,[r("div",Ka,[a(e(P),{variant:"outline",class:"font-normal"},{default:t(()=>[d(c(u.itemName)+" "+c(h+1),1)]),_:2},1024)])])]),_:2},1024),a(e(N),{class:"space-y-3"},{default:t(()=>[(n(!0),p(W,null,X(f.data,(F,E)=>(n(),p("div",{key:E,class:"flex flex-col sm:flex-row sm:items-start gap-2"},[r("div",Xa,[C(String(E))?(n(),x(ie(C(String(E))),{key:0,class:"h-4 w-4 text-muted-foreground flex-shrink-0"})):_("",!0),a(e(V),{class:O(["text-sm",y(String(E))?"font-semibold":"font-medium text-muted-foreground"])},{default:t(()=>[d(c(k(String(E)))+": ",1)]),_:2},1032,["class"])]),r("div",Za,[r("p",{class:O(["text-sm",y(String(E))?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"])},c(z(F,String(E))),3)])]))),128)),Object.keys(f.data).length===0?(n(),p("div",Qa," Sin información disponible ")):_("",!0)]),_:2},1024)]),_:2},1024))),128))]))]))}}),Ya={class:"border rounded-lg p-4 space-y-3"},et={class:"flex items-start justify-between"},at={class:"flex-1"},tt={class:"font-medium text-sm"},ot={key:0,class:"mt-2"},rt={key:1,class:"mt-2"},st={key:2,class:"text-sm text-muted-foreground mt-1"},nt={class:"flex items-center gap-2"},lt={key:0,class:"pt-2 border-t"},it={class:"flex items-start gap-2 text-xs text-muted-foreground"},dt={class:"flex-1"},ut={class:"font-medium"},ct={key:0,class:"flex items-center gap-1 mt-0.5"},mt={key:0,class:"mt-2 p-2 bg-muted rounded text-xs"},pt={class:"flex items-start gap-1"},ft={class:"flex-1"},gt={key:1,class:"flex gap-2 pt-2"},vt={class:"space-y-4 py-4"},bt={key:0,class:"mt-2 p-2 bg-muted rounded"},_t={key:1,class:"mt-2 p-2 bg-muted rounded"},yt={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},ht={class:"space-y-4 py-4"},kt={key:0,class:"mt-2 p-2 bg-muted rounded"},xt={key:1,class:"mt-2 p-2 bg-muted rounded"},wt={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},Ct=Z({__name:"AprobacionCampo",props:{candidaturaId:{},campoId:{},campoTitle:{},valor:{},aprobacion:{},puedeAprobar:{type:Boolean},readonly:{type:Boolean}},emits:["campo-actualizado"],setup(B,{emit:v}){const b=B,z=v,k=j(!1),C=j(!1),y=j(""),u=j(!1),s=M(()=>b.aprobacion?b.aprobacion.aprobado?"aprobado":"rechazado":"pendiente"),f=M(()=>b.aprobacion?b.aprobacion.aprobado?"bg-green-100 text-green-800":"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),h=M(()=>b.aprobacion?b.aprobacion.aprobado?"Aprobado":"Rechazado":"Pendiente"),F=M(()=>b.aprobacion?b.aprobacion.aprobado?G:J:Ee),E=async()=>{var i;u.value=!0;try{const m=await fetch(`/admin/candidaturas/${b.candidaturaId}/campos/${b.campoId}/aprobar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({comentario:y.value||null})}),A=await m.json();m.ok&&A.success?(z("campo-actualizado",A.aprobacion),k.value=!1,y.value=""):console.error("Error al aprobar campo:",A)}catch(m){console.error("Error al aprobar campo:",m)}finally{u.value=!1}},D=async()=>{var i;if(y.value.trim()){u.value=!0;try{const m=await fetch(`/admin/candidaturas/${b.candidaturaId}/campos/${b.campoId}/rechazar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({comentario:y.value})}),A=await m.json();m.ok&&A.success?(z("campo-actualizado",A.aprobacion),C.value=!1,y.value=""):console.error("Error al rechazar campo:",A)}catch(m){console.error("Error al rechazar campo:",m)}finally{u.value=!1}}},L=M(()=>{if(Array.isArray(b.valor)&&b.valor.length>0){const i=b.valor[0];if(typeof i=="string"&&(i.includes("uploads/")||i.includes(".pdf")||i.includes(".doc")||i.includes(".jpg")||i.includes(".png")))return!0}return!1}),$=M(()=>{if(Array.isArray(b.valor)&&b.valor.length>0){const i=b.valor[0];if(typeof i=="object"&&i!==null)return i.hasOwnProperty("id")&&i.hasOwnProperty("data")||typeof i=="object"&&!Array.isArray(i)}return!1}),T=M(()=>typeof b.valor=="object"&&b.valor!==null&&!Array.isArray(b.valor)?b.valor.hasOwnProperty("accepted")&&b.valor.hasOwnProperty("timestamp"):!1),q=i=>{if(L.value||$.value)return"";if(T.value&&typeof i=="object"&&i!==null)if(i.accepted===!0)try{return`✅ Aceptado el ${new Date(i.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return Array.isArray(i)?i.join(", "):typeof i=="object"&&i!==null?JSON.stringify(i):(i==null?void 0:i.toString())||"Sin valor"};return(i,m)=>{var A;return n(),p(W,null,[r("div",Ya,[r("div",et,[r("div",at,[r("h4",tt,c(i.campoTitle),1),L.value?(n(),p("div",ot,[a(se,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):$.value?(n(),p("div",rt,[a(ne,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):(n(),p("p",st,c(q(i.valor)),1))]),r("div",nt,[a(e(P),{class:O([f.value,"flex items-center gap-1"])},{default:t(()=>[(n(),x(ie(F.value),{class:"h-3 w-3"})),d(" "+c(h.value),1)]),_:1},8,["class"])])]),(A=i.aprobacion)!=null&&A.aprobado_por?(n(),p("div",lt,[r("div",it,[a(e(le),{class:"h-3 w-3 mt-0.5"}),r("div",dt,[r("p",null,[d(c(i.aprobacion.aprobado?"Aprobado":"Rechazado")+" por ",1),r("span",ut,c(i.aprobacion.aprobado_por.name),1)]),i.aprobacion.fecha_aprobacion?(n(),p("p",ct,[a(e(de),{class:"h-3 w-3"}),d(" "+c(i.aprobacion.fecha_aprobacion),1)])):_("",!0)])]),i.aprobacion.comentario?(n(),p("div",mt,[r("div",pt,[a(e(K),{class:"h-3 w-3 mt-0.5 text-muted-foreground"}),r("p",ft,c(i.aprobacion.comentario),1)])])):_("",!0)])):_("",!0),i.puedeAprobar&&!i.readonly?(n(),p("div",gt,[s.value!=="aprobado"?(n(),x(e(w),{key:0,size:"sm",variant:"outline",class:"text-green-700 border-green-300 hover:bg-green-50",onClick:m[0]||(m[0]=S=>k.value=!0)},{default:t(()=>[a(e(G),{class:"h-3 w-3 mr-1"}),m[8]||(m[8]=d(" Aprobar ",-1))]),_:1})):_("",!0),s.value!=="rechazado"?(n(),x(e(w),{key:1,size:"sm",variant:"outline",class:"text-red-700 border-red-300 hover:bg-red-50",onClick:m[1]||(m[1]=S=>C.value=!0)},{default:t(()=>[a(e(J),{class:"h-3 w-3 mr-1"}),m[9]||(m[9]=d(" Rechazar ",-1))]),_:1})):_("",!0)])):_("",!0)]),a(e(ye),{open:k.value,"onUpdate:open":m[4]||(m[4]=S=>k.value=S)},{default:t(()=>[a(e(he),null,{default:t(()=>[a(e(ke),null,{default:t(()=>[a(e(xe),null,{default:t(()=>[...m[10]||(m[10]=[d("Aprobar Campo",-1)])]),_:1}),a(e(we),null,{default:t(()=>[d(' Estás aprobando el campo "'+c(i.campoTitle)+'". Puedes agregar un comentario opcional. ',1)]),_:1})]),_:1}),r("div",vt,[r("div",null,[a(e(V),null,{default:t(()=>[...m[11]||(m[11]=[d("Valor actual del campo",-1)])]),_:1}),L.value?(n(),p("div",bt,[a(se,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):$.value?(n(),p("div",_t,[a(ne,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):(n(),p("p",yt,c(q(i.valor)),1))]),r("div",null,[a(e(V),{for:"comentario-aprobacion"},{default:t(()=>[...m[12]||(m[12]=[d(" Comentario (opcional) ",-1)])]),_:1}),a(e(_e),{id:"comentario-aprobacion",modelValue:y.value,"onUpdate:modelValue":m[2]||(m[2]=S=>y.value=S),placeholder:"Agregar comentario...",rows:"3"},null,8,["modelValue"])])]),a(e(Ce),null,{default:t(()=>[a(e(w),{variant:"outline",onClick:m[3]||(m[3]=S=>k.value=!1),disabled:u.value},{default:t(()=>[...m[13]||(m[13]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(w),{onClick:E,disabled:u.value,class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[a(e(G),{class:"h-4 w-4 mr-2"}),d(" "+c(u.value?"Aprobando...":"Aprobar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),a(e(ye),{open:C.value,"onUpdate:open":m[7]||(m[7]=S=>C.value=S)},{default:t(()=>[a(e(he),null,{default:t(()=>[a(e(ke),null,{default:t(()=>[a(e(xe),null,{default:t(()=>[...m[14]||(m[14]=[d("Rechazar Campo",-1)])]),_:1}),a(e(we),null,{default:t(()=>[d(' Estás rechazando el campo "'+c(i.campoTitle)+'". Por favor, indica el motivo del rechazo. ',1)]),_:1})]),_:1}),r("div",ht,[r("div",null,[a(e(V),null,{default:t(()=>[...m[15]||(m[15]=[d("Valor actual del campo",-1)])]),_:1}),L.value?(n(),p("div",kt,[a(se,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):$.value?(n(),p("div",xt,[a(ne,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):(n(),p("p",wt,c(q(i.valor)),1))]),r("div",null,[a(e(V),{for:"comentario-rechazo"},{default:t(()=>[...m[16]||(m[16]=[d(" Motivo del rechazo * ",-1)])]),_:1}),a(e(_e),{id:"comentario-rechazo",modelValue:y.value,"onUpdate:modelValue":m[5]||(m[5]=S=>y.value=S),placeholder:"Explica qué debe corregir el usuario...",rows:"4",required:""},null,8,["modelValue"])])]),a(e(Ce),null,{default:t(()=>[a(e(w),{variant:"outline",onClick:m[6]||(m[6]=S=>C.value=!1),disabled:u.value},{default:t(()=>[...m[17]||(m[17]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(w),{variant:"destructive",onClick:D,disabled:!y.value.trim()||u.value},{default:t(()=>[a(e(J),{class:"h-4 w-4 mr-2"}),d(" "+c(u.value?"Rechazando...":"Rechazar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),$t={class:"space-y-4"},At={class:"flex items-center justify-between mb-4"},zt={class:"text-lg font-medium text-gray-900 dark:text-gray-100 flex items-center gap-2"},St={key:0,class:"space-y-3"},jt={key:0,class:"absolute left-5 top-10 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700"},Lt={class:"flex gap-3"},Vt={class:"relative z-10 flex-shrink-0"},Et={class:"flex-1 pb-4"},Tt={class:"flex items-start justify-between mb-3"},Ft={class:"flex items-center gap-2 mb-1"},Nt={class:"font-medium text-sm"},Rt={class:"flex items-center gap-2 text-xs text-muted-foreground"},Mt={key:0,class:"flex items-center gap-1"},Bt=["innerHTML"],Dt={key:1,class:"text-center py-8"},It=Z({__name:"ComentariosHistorial",props:{comentarios:{},puedeAgregar:{type:Boolean,default:!1}},emits:["agregar-comentario"],setup(B){const v=B,b=M(()=>v.comentarios),z=u=>({"message-circle":wa,"check-circle":G,"x-circle":J,"rotate-ccw":$a,"sticky-note":Aa,"message-square":K})[u]||K,k=u=>{const s={general:"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",aprobacion:"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400",rechazo:"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400",borrador:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400",nota_admin:"bg-gray-100 text-gray-600 dark:bg-gray-900/30 dark:text-gray-400"};return s[u]||s.general},C=u=>({general:"default",aprobacion:"default",rechazo:"destructive",borrador:"secondary",nota_admin:"outline"})[u]||"default",y=u=>{const s=new Date(u);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(s)};return(u,s)=>(n(),p("div",$t,[r("div",At,[r("h3",zt,[a(e(K),{class:"h-5 w-5"}),s[1]||(s[1]=d(" Historial de Comentarios ",-1)),a(e(P),{variant:"secondary"},{default:t(()=>[d(c(u.comentarios.length),1)]),_:1})]),u.puedeAgregar?(n(),x(e(w),{key:0,onClick:s[0]||(s[0]=f=>u.$emit("agregar-comentario")),size:"sm",variant:"outline"},{default:t(()=>[a(e(Te),{class:"h-4 w-4 mr-2"}),s[2]||(s[2]=d(" Agregar comentario ",-1))]),_:1})):_("",!0)]),u.comentarios.length>0?(n(),p("div",St,[a(Xe,{name:"fade"},{default:t(()=>[(n(!0),p(W,null,X(b.value,f=>(n(),p("div",{key:f.id,class:"relative"},[b.value.indexOf(f)<b.value.length-1?(n(),p("div",jt)):_("",!0),r("div",Lt,[r("div",Vt,[r("div",{class:O(["w-10 h-10 rounded-full flex items-center justify-center",k(f.tipo)])},[(n(),x(ie(z(f.tipo_icon)),{class:"h-5 w-5"}))],2)]),r("div",Et,[a(e(R),null,{default:t(()=>[a(e(N),{class:"pt-4"},{default:t(()=>{var h;return[r("div",Tt,[r("div",null,[r("div",Ft,[r("span",Nt,c(((h=f.created_by)==null?void 0:h.name)||"Sistema"),1),a(e(P),{variant:C(f.tipo)},{default:t(()=>[d(c(f.tipo_label),1)]),_:2},1032,["variant"]),f.version_candidatura?(n(),x(e(P),{key:0,variant:"outline"},{default:t(()=>[d(" v"+c(f.version_candidatura),1)]),_:2},1024)):_("",!0)]),r("div",Rt,[a(e(de),{class:"h-3 w-3"}),r("span",null,c(y(f.fecha)),1),s[5]||(s[5]=r("span",null,"•",-1)),r("span",null,c(f.fecha_relativa),1),f.enviado_por_email?(n(),p("span",Mt,[s[3]||(s[3]=r("span",null,"•",-1)),a(e(Ve),{class:"h-3 w-3"}),s[4]||(s[4]=r("span",null,"Notificado",-1))])):_("",!0)])])]),r("div",{class:"prose prose-sm max-w-none dark:prose-invert",innerHTML:f.comentario},null,8,Bt)]}),_:2},1024)]),_:2},1024)])])]))),128))]),_:1})])):(n(),p("div",Dt,[a(e(Ca),{class:"h-12 w-12 text-gray-400 mx-auto mb-3"}),s[6]||(s[6]=r("p",{class:"text-sm text-muted-foreground"}," No hay comentarios históricos ",-1))]))]))}}),Ot=je(It,[["__scopeId","data-v-e630c3bf"]]),Ut={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},qt={class:"flex items-center justify-between"},Ht={class:"text-3xl font-bold"},Pt={class:"text-muted-foreground"},Wt={class:"flex items-center justify-between"},Gt={class:"flex items-center gap-4"},Jt={class:"flex items-center gap-2"},Kt={class:"text-sm text-muted-foreground"},Xt={key:0,class:"flex items-center gap-2 text-sm"},Zt={class:"text-muted-foreground"},Qt={key:0,class:"flex gap-2"},Yt={class:"flex justify-end gap-2"},eo={key:0,class:"text-sm text-destructive mt-1"},ao={class:"flex justify-end gap-2"},to={class:"p-4 bg-orange-100 dark:bg-orange-900/30 rounded-lg"},oo={class:"flex items-start gap-3"},ro={key:0,class:"text-sm text-destructive mt-1"},so={class:"flex justify-end gap-2"},no={class:"grid gap-4 md:grid-cols-2"},lo={class:"text-muted-foreground"},io={class:"text-muted-foreground"},uo={class:"text-muted-foreground"},co={class:"text-muted-foreground"},mo={class:"flex items-center gap-2"},po={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},fo={class:"text-center"},go={class:"text-2xl font-bold"},vo={class:"text-center"},bo={class:"text-2xl font-bold text-green-600"},_o={class:"text-center"},yo={class:"text-2xl font-bold text-red-600"},ho={class:"text-center"},ko={class:"text-2xl font-bold text-yellow-600"},xo={class:"mt-4"},wo={class:"flex justify-between text-sm mb-1"},Co={class:"w-full bg-gray-200 rounded-full h-2"},$o=["innerHTML"],Ao={key:0,class:"mt-4 pt-4 border-t border-blue-200 dark:border-blue-700"},zo={class:"flex items-center space-x-3"},So={class:"flex justify-end gap-2"},jo={key:0,class:"text-center py-8"},Lo={key:1,class:"space-y-6"},Vo={key:0},Eo={key:0,class:"text-red-500"},To={key:0,class:"text-xs text-muted-foreground mb-2"},Fo={class:"mt-2"},No={key:2,class:"text-muted-foreground"},Ro={key:1,class:"space-y-4"},Jr=Z({__name:"Show",props:{candidatura:{},configuracion_campos:{},campo_aprobaciones:{},resumen_aprobaciones:{},puede_aprobar_campos:{type:Boolean},puede_comentar:{type:Boolean},comentarios:{}},setup(B){var pe;const v=B,z=((pe=Ze().props.auth)==null?void 0:pe.user)||null,k=Qe(v.campo_aprobaciones||{}),C=l=>{k[l.campo_id]=l,fe.reload({only:["resumen_aprobaciones"]})},y=j(!1),u=[{title:"Admin",href:"/admin/dashboard"},{title:"Candidaturas",href:"/admin/candidaturas"},{title:v.candidatura.usuario.name,href:"#"}],s=j(!1),f=j(!1),h=j(!1),F=j(v.candidatura.subsanar),E=j(!1),D=j(""),L=te({comentarios:""}),$=te({comentarios:""}),T=te({motivo:""}),q=j(!1),i=j(v.comentarios||[]),m=j(!1),A=j(!1),S=j(""),I=te({comentario:"",tipo:"general",enviar_email:!1}),Fe=M(()=>v.candidatura.estado==="pendiente"&&!ue(v.candidatura.formulario_data)),Ne=M(()=>v.candidatura.estado==="pendiente"),Re=M(()=>v.candidatura.estado==="aprobado"||v.candidatura.estado==="rechazado"||v.candidatura.estado==="pendiente"),ue=l=>!l||Object.keys(l).length===0,Me=()=>{L.post(`/admin/candidaturas/${v.candidatura.id}/aprobar`,{onSuccess:()=>{if(s.value=!1,L.comentarios){const l=Y(L.comentarios,"aprobacion");i.value.unshift(l),v.candidatura.comentarios_admin=L.comentarios,m.value=!0}}})},Be=()=>{$.comentarios.trim()&&$.post(`/admin/candidaturas/${v.candidatura.id}/rechazar`,{onSuccess:()=>{f.value=!1;const l=Y($.comentarios,"rechazo");i.value.unshift(l),v.candidatura.comentarios_admin=$.comentarios,m.value=!0}})},De=()=>{L.reset(),s.value=!1},Ie=()=>{$.reset(),f.value=!1},Oe=()=>{T.post(`/admin/candidaturas/${v.candidatura.id}/volver-borrador`,{onSuccess:()=>{if(h.value=!1,F.value=!0,T.motivo){const l=Y(T.motivo,"borrador");i.value.unshift(l),v.candidatura.comentarios_admin=T.motivo,m.value=!0}D.value="Candidatura devuelta a borrador con subsanación habilitada",setTimeout(()=>{D.value=""},3e3)}})},Ue=()=>{T.reset(),h.value=!1},Y=(l,o)=>{const g=new Date,ee={general:"Comentario General",aprobacion:"Aprobación",rechazo:"Rechazo",borrador:"Vuelta a Borrador",nota_admin:"Nota Administrativa"},ae={general:"bg-blue-100 text-blue-800",aprobacion:"bg-green-100 text-green-800",rechazo:"bg-red-100 text-red-800",borrador:"bg-yellow-100 text-yellow-800",nota_admin:"bg-gray-100 text-gray-800"},Ge={general:"message-circle",aprobacion:"check-circle",rechazo:"x-circle",borrador:"rotate-ccw",nota_admin:"sticky-note"};return{id:Date.now(),comentario:l,tipo:o,tipo_label:ee[o]||"Desconocido",tipo_color:ae[o]||"bg-gray-100 text-gray-800",tipo_icon:Ge[o]||"message-square",version_candidatura:v.candidatura.version,enviado_por_email:!0,created_by:z?{id:z.id,name:z.name,email:z.email}:void 0,fecha:g.toISOString(),fecha_formateada:g.toLocaleDateString("es-ES")+" "+g.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),fecha_relativa:"hace unos segundos"}},qe=async()=>{if(I.comentario.trim()){A.value=!0;try{const l=await ge.post(`/admin/candidaturas/${v.candidatura.id}/comentarios`,{comentario:I.comentario,tipo:I.tipo,enviar_email:I.enviar_email});l.data.success&&(i.value.unshift(l.data.comentario),v.candidatura.comentarios_admin=l.data.comentario.comentario,I.reset(),q.value=!1,m.value=!0,S.value=l.data.message||"Comentario agregado exitosamente",setTimeout(()=>{S.value=""},5e3),setTimeout(()=>{const o=document.querySelector("#historial-comentarios");o&&o.scrollIntoView({behavior:"smooth",block:"nearest"})},100))}catch(l){console.error("Error al agregar comentario:",l)}finally{A.value=!1}}},He=()=>{I.reset(),q.value=!1},Pe=async()=>{E.value=!0,D.value="";try{const l=await ge.post(`/admin/candidaturas/${v.candidatura.id}/toggle-subsanar`);if(l.data.success){F.value=l.data.subsanar,D.value=l.data.message;const o=l.data.subsanar?"Se habilitó la subsanación para esta candidatura":"Se deshabilitó la subsanación para esta candidatura",g=Y(o,"nota_admin");i.value.unshift(g),setTimeout(()=>{D.value=""},3e3)}}catch(l){console.error("Error al cambiar estado de subsanación:",l),D.value="Error al cambiar el estado de subsanación",setTimeout(()=>{D.value=""},3e3)}finally{E.value=!1}},ce=()=>{q.value=!0,setTimeout(()=>{const l=document.querySelector("#formulario-comentario");l&&l.scrollIntoView({behavior:"smooth",block:"center"})},100)},We=(l,o)=>{if(!o)return"No especificado";switch(l.type){case"checkbox":return Array.isArray(o)?o.join(", "):o;case"date":case"datepicker":try{return new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return o}case"disclaimer":if(typeof o=="object"&&o!==null)if(o.accepted===!0)try{return`✅ Aceptado el ${new Date(o.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return o;case"file":return null;case"repeater":return null;case"textarea":return o;default:return o}},me=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(l,o)=>(n(),p(W,null,[a(e(Ye),{title:`Candidatura - ${l.candidatura.usuario.name}`},null,8,["title"]),a(ba,{breadcrumbs:u},{default:t(()=>[r("div",Ut,[r("div",qt,[r("div",null,[r("h1",Ht,c(l.candidatura.usuario.name),1),r("p",Pt," Candidatura "+c(l.candidatura.estado_label)+" - Versión "+c(l.candidatura.version),1)]),a(e(w),{variant:"outline",onClick:o[0]||(o[0]=g=>e(fe).visit("/admin/candidaturas"))},{default:t(()=>[a(e(_a),{class:"mr-2 h-4 w-4"}),o[11]||(o[11]=d(" Volver a Lista ",-1))]),_:1})]),a(e(R),null,{default:t(()=>[a(e(N),{class:"p-6"},{default:t(()=>[r("div",Wt,[r("div",Gt,[r("div",Jt,[a(e(P),{class:O([l.candidatura.estado_color,"text-sm"])},{default:t(()=>[d(c(l.candidatura.estado_label),1)]),_:1},8,["class"]),r("span",Kt," Versión "+c(l.candidatura.version),1)]),l.candidatura.aprobado_por?(n(),p("div",Xt,[a(e(le),{class:"h-4 w-4"}),r("span",null,c(l.candidatura.aprobado_por.name),1),r("span",Zt,"- "+c(l.candidatura.fecha_aprobacion),1)])):_("",!0)]),!s.value&&!f.value&&!h.value&&!q.value?(n(),p("div",Qt,[Fe.value?(n(),x(e(w),{key:0,onClick:o[1]||(o[1]=g=>s.value=!0),class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[a(e(G),{class:"mr-2 h-4 w-4"}),o[12]||(o[12]=d(" Aprobar ",-1))]),_:1})):_("",!0),Ne.value?(n(),x(e(w),{key:1,variant:"destructive",onClick:o[2]||(o[2]=g=>f.value=!0)},{default:t(()=>[a(e(J),{class:"mr-2 h-4 w-4"}),o[13]||(o[13]=d(" Rechazar ",-1))]),_:1})):_("",!0),Re.value?(n(),x(e(w),{key:2,variant:"outline",onClick:o[3]||(o[3]=g=>h.value=!0),class:"border-orange-300 text-orange-700 hover:bg-orange-50"},{default:t(()=>[a(e(Se),{class:"mr-2 h-4 w-4"}),o[14]||(o[14]=d(" Volver a Borrador ",-1))]),_:1})):_("",!0),l.candidatura.estado==="borrador"?(n(),x(e(w),{key:3,onClick:Pe,disabled:E.value,variant:F.value?"default":"outline",class:O(F.value?"bg-blue-600 hover:bg-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50")},{default:t(()=>[E.value?(n(),x(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(n(),x(ie(F.value?e(ya):e(ha)),{key:1,class:"mr-2 h-4 w-4"})),d(" "+c(F.value?"Subsanación Habilitada":"Habilitar Subsanación"),1)]),_:1},8,["disabled","variant","class"])):_("",!0),l.puede_comentar?(n(),x(e(w),{key:4,variant:"outline",onClick:ce,class:"border-indigo-300 text-indigo-600 hover:bg-indigo-50"},{default:t(()=>[a(e(K),{class:"mr-2 h-4 w-4"}),o[15]||(o[15]=d(" Agregar Comentario ",-1))]),_:1})):_("",!0)])):_("",!0)])]),_:1})]),_:1}),s.value?(n(),x(e(R),{key:0,class:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20"},{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"text-green-800 dark:text-green-200 flex items-center gap-2"},{default:t(()=>[a(e(G),{class:"h-5 w-5"}),o[16]||(o[16]=d(" Aprobar Candidatura ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[r("div",null,[a(e(V),{for:"approval_comments"},{default:t(()=>[...o[17]||(o[17]=[d("Comentarios (opcional)",-1)])]),_:1}),a(re,{modelValue:e(L).comentarios,"onUpdate:modelValue":o[4]||(o[4]=g=>e(L).comentarios=g),placeholder:"Comentarios adicionales para el usuario...",rows:3},null,8,["modelValue"])]),r("div",Yt,[a(e(w),{variant:"outline",onClick:De,disabled:e(L).processing},{default:t(()=>[...o[18]||(o[18]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(w),{onClick:Me,disabled:e(L).processing,class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[d(c(e(L).processing?"Aprobando...":"Confirmar Aprobación"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):_("",!0),f.value?(n(),x(e(R),{key:1,class:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/20"},{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"text-red-800 dark:text-red-200 flex items-center gap-2"},{default:t(()=>[a(e(J),{class:"h-5 w-5"}),o[19]||(o[19]=d(" Rechazar Candidatura ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[r("div",null,[a(e(V),{for:"rejection_comments"},{default:t(()=>[...o[20]||(o[20]=[d("Motivo del rechazo *",-1)])]),_:1}),a(re,{modelValue:e($).comentarios,"onUpdate:modelValue":o[5]||(o[5]=g=>e($).comentarios=g),placeholder:"Explica al usuario qué debe corregir...",rows:4},null,8,["modelValue"]),e($).errors.comentarios?(n(),p("p",eo,c(e($).errors.comentarios),1)):_("",!0)]),r("div",ao,[a(e(w),{variant:"outline",onClick:Ie,disabled:e($).processing},{default:t(()=>[...o[21]||(o[21]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(w),{variant:"destructive",onClick:Be,disabled:!e($).comentarios.trim()||e($).processing},{default:t(()=>[d(c(e($).processing?"Rechazando...":"Confirmar Rechazo"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):_("",!0),h.value?(n(),x(e(R),{key:2,class:"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-950/20"},{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"text-orange-800 dark:text-orange-200 flex items-center gap-2"},{default:t(()=>[a(e(Se),{class:"h-5 w-5"}),o[22]||(o[22]=d(" Volver Candidatura a Borrador ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[r("div",to,[r("div",oo,[a(e(Ae),{class:"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5"}),o[23]||(o[23]=r("div",{class:"text-sm text-orange-800 dark:text-orange-200"},[r("p",{class:"font-medium"},'Esta acción volverá la candidatura al estado "Borrador"'),r("p",{class:"mt-1"},"El usuario podrá editar su candidatura nuevamente y deberá ser revisada otra vez.")],-1))])]),r("div",null,[a(e(V),{for:"revert_reason"},{default:t(()=>[...o[24]||(o[24]=[d("Motivo (opcional)",-1)])]),_:1}),a(re,{modelValue:e(T).motivo,"onUpdate:modelValue":o[6]||(o[6]=g=>e(T).motivo=g),placeholder:"Explica al usuario por qué su candidatura volvió a borrador...",rows:3},null,8,["modelValue"]),e(T).errors.motivo?(n(),p("p",ro,c(e(T).errors.motivo),1)):_("",!0)]),r("div",so,[a(e(w),{variant:"outline",onClick:Ue,disabled:e(T).processing},{default:t(()=>[...o[25]||(o[25]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(w),{onClick:Oe,disabled:e(T).processing,class:"bg-orange-600 hover:bg-orange-700"},{default:t(()=>[d(c(e(T).processing?"Procesando...":"Confirmar"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):_("",!0),a(e(R),null,{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"flex items-center gap-2"},{default:t(()=>[a(e(le),{class:"h-5 w-5"}),o[26]||(o[26]=d(" Información del Usuario ",-1))]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[r("div",no,[r("div",null,[a(e(V),{class:"text-sm font-medium"},{default:t(()=>[...o[27]||(o[27]=[d("Nombre",-1)])]),_:1}),r("p",lo,c(l.candidatura.usuario.name),1)]),r("div",null,[a(e(V),{class:"text-sm font-medium"},{default:t(()=>[...o[28]||(o[28]=[d("Email",-1)])]),_:1}),r("p",io,c(l.candidatura.usuario.email),1)]),r("div",null,[a(e(V),{class:"text-sm font-medium"},{default:t(()=>[...o[29]||(o[29]=[d("Fecha de creación",-1)])]),_:1}),r("p",uo,c(me(l.candidatura.created_at)),1)]),r("div",null,[a(e(V),{class:"text-sm font-medium"},{default:t(()=>[...o[30]||(o[30]=[d("Última actualización",-1)])]),_:1}),r("p",co,c(me(l.candidatura.updated_at)),1)])])]),_:1})]),_:1}),l.resumen_aprobaciones&&l.puede_aprobar_campos?(n(),x(e(R),{key:3,class:"border-indigo-200 dark:border-indigo-800"},{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"flex items-center justify-between"},{default:t(()=>[r("span",mo,[a(e(ka),{class:"h-5 w-5"}),o[31]||(o[31]=d(" Aprobación de Campos ",-1))]),a(e(w),{variant:"outline",size:"sm",onClick:o[7]||(o[7]=g=>y.value=!y.value)},{default:t(()=>[d(c(y.value?"Ocultar Aprobaciones":"Mostrar Aprobaciones"),1)]),_:1})]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[r("div",po,[r("div",fo,[r("p",go,c(l.resumen_aprobaciones.total),1),o[32]||(o[32]=r("p",{class:"text-xs text-muted-foreground"},"Total Campos",-1))]),r("div",vo,[r("p",bo,c(l.resumen_aprobaciones.aprobados),1),o[33]||(o[33]=r("p",{class:"text-xs text-muted-foreground"},"Aprobados",-1))]),r("div",_o,[r("p",yo,c(l.resumen_aprobaciones.rechazados),1),o[34]||(o[34]=r("p",{class:"text-xs text-muted-foreground"},"Rechazados",-1))]),r("div",ho,[r("p",ko,c(l.resumen_aprobaciones.pendientes),1),o[35]||(o[35]=r("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))])]),r("div",xo,[r("div",wo,[o[36]||(o[36]=r("span",null,"Progreso de Aprobación",-1)),r("span",null,c(l.resumen_aprobaciones.porcentaje_aprobado)+"%",1)]),r("div",Co,[r("div",{class:"bg-green-600 h-2 rounded-full transition-all",style:ea({width:`${l.resumen_aprobaciones.porcentaje_aprobado}%`})},null,4)])])]),_:1})]),_:1})):_("",!0),a(oe,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:t(()=>[S.value?(n(),x(e(ve),{key:0,class:"border-green-200 bg-green-50 dark:bg-green-950/20"},{default:t(()=>[a(e(xa),{class:"h-4 w-4 text-green-600"}),a(e(be),{class:"text-green-800 dark:text-green-200"},{default:t(()=>[d(c(S.value),1)]),_:1})]),_:1})):_("",!0)]),_:1}),a(oe,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:t(()=>[D.value?(n(),x(e(ve),{key:0,class:"border-blue-200 bg-blue-50 dark:bg-blue-950/20"},{default:t(()=>[a(e(za),{class:"h-4 w-4 text-blue-600"}),a(e(be),{class:"text-blue-800 dark:text-blue-200"},{default:t(()=>[d(c(D.value),1)]),_:1})]),_:1})):_("",!0)]),_:1}),l.candidatura.comentarios_admin?(n(),x(e(R),{key:4,class:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20"},{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"text-blue-800 dark:text-blue-200 flex items-center gap-2"},{default:t(()=>[a(e(K),{class:"h-5 w-5"}),o[37]||(o[37]=d(" Comentarios de la comisión (actual) ",-1)),a(oe,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"transform opacity-0 scale-75","enter-to-class":"transform opacity-100 scale-100"},{default:t(()=>[i.value.length>1?(n(),x(e(P),{variant:"secondary",key:i.value.length},{default:t(()=>[d(" +"+c(i.value.length-1)+" históricos ",1)]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[r("div",{class:"text-blue-700 dark:text-blue-300 prose prose-sm max-w-none",innerHTML:l.candidatura.comentarios_admin},null,8,$o),i.value.length>0?(n(),p("div",Ao,[a(e(w),{onClick:o[8]||(o[8]=g=>m.value=!m.value),variant:"ghost",size:"sm",class:"text-blue-600 hover:text-blue-700"},{default:t(()=>[a(e(ze),{class:"h-4 w-4 mr-2"}),d(" "+c(m.value?"Ocultar":"Ver")+" historial de comentarios ",1)]),_:1})])):_("",!0)]),_:1})]),_:1})):_("",!0),q.value&&l.puede_comentar?(n(),x(e(R),{key:5,id:"formulario-comentario",class:"border-indigo-200 dark:border-indigo-800 bg-indigo-50 dark:bg-indigo-950/20"},{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"text-indigo-800 dark:text-indigo-200 flex items-center gap-2"},{default:t(()=>[a(e(Te),{class:"h-5 w-5"}),o[38]||(o[38]=d(" Agregar Comentario ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[r("div",null,[a(e(V),{for:"nuevo_comentario"},{default:t(()=>[...o[39]||(o[39]=[d("Comentario *",-1)])]),_:1}),a(re,{modelValue:e(I).comentario,"onUpdate:modelValue":o[9]||(o[9]=g=>e(I).comentario=g),placeholder:"Escribe tu comentario aquí...",rows:4},null,8,["modelValue"])]),r("div",zo,[a(e(aa),{id:"enviar-email",checked:e(I).enviar_email,"onUpdate:checked":o[10]||(o[10]=g=>e(I).enviar_email=g)},null,8,["checked"]),a(e(V),{for:"enviar-email",class:"cursor-pointer"},{default:t(()=>[...o[40]||(o[40]=[d(" Notificar al usuario por correo electrónico ",-1)])]),_:1})]),r("div",So,[a(e(w),{variant:"outline",onClick:He,disabled:A.value},{default:t(()=>[...o[41]||(o[41]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(w),{onClick:qe,disabled:!e(I).comentario.trim()||A.value,class:"bg-indigo-600 hover:bg-indigo-700"},{default:t(()=>[A.value?(n(),x(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):_("",!0),d(" "+c(A.value?"Guardando...":"Guardar comentario"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):_("",!0),a(oe,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 translate-y-4","enter-to-class":"transform opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 translate-y-0","leave-to-class":"transform opacity-0 translate-y-4"},{default:t(()=>[m.value&&i.value.length>0?(n(),x(e(R),{key:0,id:"historial-comentarios"},{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"flex items-center gap-2"},{default:t(()=>[a(e(ze),{class:"h-5 w-5"}),o[42]||(o[42]=d(" Historial de Comentarios ",-1))]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[a(Ot,{comentarios:i.value,"puede-agregar":!0,onAgregarComentario:ce},null,8,["comentarios"])]),_:1})]),_:1})):_("",!0)]),_:1}),a(e(R),null,{default:t(()=>[a(e(U),null,{default:t(()=>[a(e(H),{class:"flex items-center gap-2"},{default:t(()=>[a(e(Ee),{class:"h-5 w-5"}),o[43]||(o[43]=d(" Datos de la Candidatura ",-1))]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[ue(l.candidatura.formulario_data)?(n(),p("div",jo,[a(e(Ae),{class:"mx-auto h-12 w-12 text-yellow-500"}),o[44]||(o[44]=r("h3",{class:"mt-4 text-lg font-medium"},"Candidatura vacía",-1)),o[45]||(o[45]=r("p",{class:"text-muted-foreground"},"El usuario aún no ha completado su perfil de candidatura.",-1))])):(n(),p("div",Lo,[y.value?(n(),p("div",Ro,[(n(!0),p(W,null,X(l.configuracion_campos,g=>(n(),x(Ct,{key:g.id,"candidatura-id":l.candidatura.id,"campo-id":g.id,"campo-title":g.title,valor:l.candidatura.formulario_data[g.id],aprobacion:k[g.id],"puede-aprobar":l.puede_aprobar_campos,readonly:l.candidatura.estado==="aprobado",onCampoActualizado:C},null,8,["candidatura-id","campo-id","campo-title","valor","aprobacion","puede-aprobar","readonly"]))),128))])):(n(),p("div",Vo,[(n(!0),p(W,null,X(l.configuracion_campos,g=>{var ee,ae;return n(),p("div",{key:g.id,class:"border-b pb-4 last:border-b-0"},[a(e(V),{class:"text-sm font-medium flex items-center gap-1"},{default:t(()=>[d(c(g.title)+" ",1),g.required?(n(),p("span",Eo,"*")):_("",!0)]),_:2},1024),g.description?(n(),p("p",To,c(g.description),1)):_("",!0),r("div",Fo,[g.type==="file"?(n(),x(se,{key:0,value:l.candidatura.formulario_data[g.id],label:g.title},null,8,["value","label"])):g.type==="repeater"?(n(),x(ne,{key:1,value:l.candidatura.formulario_data[g.id],label:g.title,fields:(ee=g.repeaterConfig)==null?void 0:ee.fields,"item-name":((ae=g.repeaterConfig)==null?void 0:ae.itemName)||"Elemento"},null,8,["value","label","fields","item-name"])):(n(),p("p",No,c(We(g,l.candidatura.formulario_data[g.id])),1))])])}),128))]))]))]),_:1})]),_:1}),a(da,{"candidatura-id":l.candidatura.id,"version-actual":l.candidatura.version,"is-admin":!0},null,8,["candidatura-id","version-actual"])])]),_:1})],64))}});export{Jr as default};
