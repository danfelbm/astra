import{r as G,p as we,c as q,d as Me,i as D,g,j as w,F as K,k as ce,e as l,f as o,w as r,h as _,b as O,m as u,x as et,t as E,n as J,l as St,ai as ot,o as Ya,B as Dn,W as ka,a1 as kn,a as Ga,v as zt,y as Wa,s as Sa}from"./app-B8akDo5X.js";import{g as Sn}from"./Input.vue_vue_type_script_setup_true_lang-BT--LyGg.js";import{_ as pe,c as ve,a as Se,b as $e}from"./CardTitle.vue_vue_type_script_setup_true_lang-VAG0deZE.js";import{c as qa,_ as W}from"./createLucideIcon-CRQ99TGv.js";import{_ as ae}from"./index--CWYxasj.js";import{_ as Vt}from"./Progress.vue_vue_type_script_setup_true_lang-DVLxzFAk.js";import{_ as ht}from"./ScrollArea.vue_vue_type_script_setup_true_lang-B7LeRSxC.js";import{_ as $n}from"./Separator.vue_vue_type_script_setup_true_lang-y7C9Q15j.js";import{C as In,_ as Zt,a as ea,b as ta,c as aa,d as lt}from"./SelectValue.vue_vue_type_script_setup_true_lang-ygs_JmN5.js";import{_ as Tn,a as Pn,b as An,c as On,d as Mn,e as Nn,f as Rn,g as Fn}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BlRPJKj0.js";import{f as Xe,e as Ye}from"./es-BDPlFIsO.js";import{b as zn,_ as Vn,a as Bn}from"./EntregablesFilters.vue_vue_type_script_setup_true_lang-uywNrT3M.js";import{_ as Hn}from"./Switch.vue_vue_type_script_setup_true_lang-bHri6yQj.js";import{_ as Un}from"./Label.vue_vue_type_script_setup_true_lang-Cl05gzIl.js";import{L as jn}from"./list-EsqyouL5.js";import{L as Ln}from"./useFlashMessages-Br_6a2wW.js";import{C as tt}from"./circle-alert-CTs4Wwq6.js";import{C as Kt}from"./circle-x-CX79hJDm.js";import{C as Pe}from"./clock-DZGwd0ij.js";import{C as at}from"./circle-check-big-oRecuZys.js";import{C as Ka}from"./chevron-right-D4nKoAMA.js";import{F as Qa}from"./flag-Ty-_EcxD.js";import{C as Ge}from"./calendar-B0PAIiz9.js";import{U as Je}from"./user-BADaMnv3.js";import{E as $a}from"./eye-CIjoxe5T.js";import{S as bt}from"./square-pen-DKhMDSNk.js";import{M as yt}from"./message-square-BEkHJV0a.js";import{A as xt,_ as Xn,a as Yn}from"./EvidenciasTable.vue_vue_type_script_setup_true_lang-BHK0Jk95.js";import{U as Ja}from"./users-BR6J8NIl.js";import{T as Za}from"./trash-2-Cmq-C3uy.js";import{F as Bt}from"./file-text-ZwoXWfv1.js";import{_ as ba,a as ya,b as Ie,c as Te}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-C4vCaUdB.js";import{e as en,_ as tn,a as an,b as Ht,c as Ut,d as nn}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BpTrTnbW.js";import{_ as Be}from"./Skeleton.vue_vue_type_script_setup_true_lang-DVHFajMS.js";import{_ as on,a as ln}from"./ActivityLog.vue_vue_type_script_setup_true_lang-DFDBp8ix.js";import{_ as sn}from"./CamposPersonalizadosDisplay.vue_vue_type_script_setup_true_lang-DBxAY9Qk.js";import{_ as rn}from"./ComentariosPanel.vue_vue_type_script_setup_true_lang-mTq_wc5z.js";import{T as fa,a as dn}from"./target-FURL_xmb.js";import{R as un}from"./refresh-cw-D5y4wKxB.js";import{E as jt}from"./external-link-Dl806rea.js";import{p as Lt}from"./parseISO-DFjB8F03.js";import{_ as Gn}from"./CardDescription.vue_vue_type_script_setup_true_lang-BOSUkiNt.js";import{_ as Ia,a as Ta,b as Pa}from"./index-CfRa1x7f.js";import{_ as Wn,a as qn}from"./index-CP2JwLSi.js";import{I as Aa}from"./image-DLVnda-a.js";import{d as Kn}from"./differenceInDays-CDkc-BiT.js";import{F as Qn}from"./folder-open-CcJP8wow.js";import{P as Oa}from"./plus-BzI5DvM-.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=qa("Columns3Icon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=qa("ListTodoIcon",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),st={VIEW_MODE:"entregables-view-mode",CONFIRM_ON_DRAG:"entregables-confirm-drag"},ct={pendiente:{label:"Pendiente",color:"text-gray-800",bgColor:"bg-gray-100",dotColor:"bg-gray-400"},en_progreso:{label:"En Progreso",color:"text-blue-800",bgColor:"bg-blue-100",dotColor:"bg-blue-500"},completado:{label:"Completado",color:"text-green-800",bgColor:"bg-green-100",dotColor:"bg-green-500"},cancelado:{label:"Cancelado",color:"text-red-800",bgColor:"bg-red-100",dotColor:"bg-red-500"}},At={baja:{label:"Baja",color:"text-gray-600",bgColor:"bg-gray-100"},media:{label:"Media",color:"text-yellow-800",bgColor:"bg-yellow-100"},alta:{label:"Alta",color:"text-red-800",bgColor:"bg-red-100"}},ma=["pendiente","en_progreso","completado","cancelado"];function _t(e,t={}){const{defaultViewMode:n="list",defaultConfirmOnDrag:a=!0}=t,i=G(localStorage.getItem(st.VIEW_MODE)||n),s=G(localStorage.getItem(st.CONFIRM_ON_DRAG)!==null?localStorage.getItem(st.CONFIRM_ON_DRAG)==="true":a);we(i,h=>{localStorage.setItem(st.VIEW_MODE,h)}),we(s,h=>{localStorage.setItem(st.CONFIRM_ON_DRAG,String(h))});const d=q(()=>({pendientes:e.value.filter(h=>h.estado==="pendiente"),en_progreso:e.value.filter(h=>h.estado==="en_progreso"),completados:e.value.filter(h=>h.estado==="completado"),cancelados:e.value.filter(h=>h.estado==="cancelado")}));return{viewMode:i,confirmOnDrag:s,entregablesAgrupados:d,getEstadoConfig:h=>ct[h]||ct.pendiente,getPrioridadConfig:h=>At[h]||At.baja,getEstadoColor:h=>{const T=ct[h];return T?`${T.bgColor} ${T.color}`:"bg-gray-100 text-gray-800"},getPrioridadColor:h=>{const T=At[h];return T?`${T.bgColor} ${T.color}`:"bg-gray-100 text-gray-600"},formatDate:h=>h?Xe(new Date(h),"dd MMM yyyy",{locale:Ye}):"Sin fecha",formatDateTime:h=>h?Xe(new Date(h),"dd MMM yyyy 'a las' HH:mm",{locale:Ye}):"-",getDiasRestantes:h=>{if(!h)return null;const T=Math.ceil((new Date(h).getTime()-new Date().getTime())/(1e3*60*60*24));return T<0?`Vencido hace ${Math.abs(T)} días`:T===0?"Vence hoy":T===1?"Vence mañana":`${T} días`},isVencido:(h,T)=>!h||T==="completado"||T==="cancelado"?!1:new Date(h)<new Date}}const Zn={class:"flex items-center justify-between gap-4 flex-wrap"},eo={class:"flex gap-1 bg-muted p-1 rounded-lg"},to={class:"ml-1.5 hidden sm:inline text-xs"},ao={key:0,class:"flex items-center gap-2"},no=Me({__name:"HitosViewModeToggle",props:{modelValue:{},confirmOnDrag:{type:Boolean}},emits:["update:modelValue","update:confirmOnDrag"],setup(e,{emit:t}){const n=t,a=[{value:"list",icon:jn,label:"Lista"},{value:"tabs",icon:Ln,label:"Tabs"},{value:"kanban",icon:Jn,label:"Kanban"}];return(i,s)=>(u(),D("div",Zn,[g("div",eo,[(u(),D(K,null,ce(a,d=>l(o(W),{key:d.value,variant:e.modelValue===d.value?"default":"ghost",size:"sm",class:"h-8 px-3",title:d.label,onClick:p=>n("update:modelValue",d.value)},{default:r(()=>[(u(),O(et(d.icon),{class:"h-4 w-4"})),g("span",to,E(d.label),1)]),_:2},1032,["variant","title","onClick"])),64))]),e.modelValue==="kanban"?(u(),D("div",ao,[l(o(Hn),{id:"confirm-drag","model-value":e.confirmOnDrag,"onUpdate:modelValue":s[0]||(s[0]=d=>n("update:confirmOnDrag",d))},null,8,["model-value"]),l(o(Un),{for:"confirm-drag",class:"text-sm text-muted-foreground cursor-pointer"},{default:r(()=>[...s[1]||(s[1]=[_(" Confirmar al arrastrar ",-1)])]),_:1})])):w("",!0)]))}}),oo={class:"flex items-start gap-2"},lo={class:"flex-1 min-w-0"},so={class:"flex items-center gap-2 flex-wrap"},io={key:0,class:"mt-1.5 flex items-center gap-2 text-xs text-muted-foreground"},ro={key:1,class:"flex items-center gap-1 truncate"},uo={key:0,class:"flex gap-1 mt-2 pt-2 border-t"},co={key:0,class:"ml-1"},fo={key:1,class:"ml-8 mt-3 space-y-3"},mo={key:0,class:"text-sm text-muted-foreground"},go={class:"flex flex-wrap gap-4 text-sm"},po={class:"flex items-center gap-1 text-muted-foreground"},vo={key:0,class:"flex items-center gap-1 text-muted-foreground"},ho={key:1,class:"flex items-center gap-2"},bo={class:"flex gap-1 flex-wrap"},yo={key:2,class:"text-sm text-muted-foreground space-y-1"},xo={key:0,class:"flex items-center gap-1"},_o={key:1,class:"flex items-center gap-1"},wo={key:2,class:"italic mt-2"},Eo={key:2,class:"flex items-center gap-1 mt-3 pt-3 border-t"},xa=Me({__name:"HitosEntregableCard",props:{entregable:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},expanded:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},variant:{default:"default"}},emits:["toggle-expand","view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=G([]),{getEstadoColor:s,getPrioridadColor:d,formatDate:p,formatDateTime:v,getDiasRestantes:f,isVencido:b}=_t(i),m=q(()=>ct[n.entregable.estado]),C=q(()=>At[n.entregable.prioridad]),c=q(()=>f(n.entregable.fecha_fin)),S=q(()=>b(n.entregable.fecha_fin,n.entregable.estado)),h=q(()=>n.entregable.estado==="completado"),T=q(()=>n.entregable.estado==="cancelado"),j=q(()=>{switch(n.entregable.estado){case"completado":return at;case"en_progreso":return Pe;case"cancelado":return Kt;default:return tt}}),H=q(()=>{const Q="transition-all duration-150",P={en_progreso:"border-l-4 border-l-blue-500",completado:"border-l-4 border-l-green-500 bg-green-50/30",cancelado:"border-l-4 border-l-red-500 bg-red-50/30"},U=[Q];return P[n.entregable.estado]&&U.push(P[n.entregable.estado]),n.draggable&&U.push("cursor-grab active:cursor-grabbing hover:shadow-md"),U.join(" ")});return(Q,P)=>(u(),O(o(pe),{class:J(H.value),"data-id":e.entregable.id,"data-estado":e.entregable.estado},{default:r(()=>[l(o(ve),{class:J(e.variant==="kanban"?"p-3":"p-4")},{default:r(()=>[g("div",oo,[e.variant!=="kanban"?(u(),O(o(W),{key:0,variant:"ghost",size:"sm",class:"h-6 w-6 p-0 flex-shrink-0",onClick:P[0]||(P[0]=U=>a("toggle-expand"))},{default:r(()=>[e.expanded?(u(),O(o(In),{key:1,class:"h-4 w-4"})):(u(),O(o(Ka),{key:0,class:"h-4 w-4"}))]),_:1})):w("",!0),e.variant==="kanban"?(u(),O(et(j.value),{key:1,class:J(["h-4 w-4 flex-shrink-0 mt-0.5",m.value.color])},null,8,["class"])):w("",!0),g("div",lo,[g("div",so,[g("h4",{class:J(["font-medium truncate",{"line-through text-muted-foreground":h.value,"text-sm":e.variant==="kanban"}])},E(e.entregable.nombre),3),e.variant!=="kanban"?(u(),D(K,{key:0},[l(o(ae),{class:J([o(d)(e.entregable.prioridad),"text-[10px] px-1.5"]),variant:"outline"},{default:r(()=>[_(E(C.value.label),1)]),_:1},8,["class"]),l(o(ae),{class:J([o(s)(e.entregable.estado),"text-[10px] px-1.5"])},{default:r(()=>[_(E(m.value.label),1)]),_:1},8,["class"])],64)):w("",!0),e.variant==="kanban"&&e.entregable.prioridad==="alta"?(u(),O(o(ae),{key:1,class:"bg-red-100 text-red-800 text-[10px] px-1"},{default:r(()=>[l(o(Qa),{class:"h-3 w-3"})]),_:1})):w("",!0)]),e.variant==="kanban"?(u(),D("div",io,[e.entregable.fecha_fin?(u(),D("span",{key:0,class:J(["flex items-center gap-1",{"text-red-600":S.value}])},[l(o(Ge),{class:"h-3 w-3"}),_(" "+E(o(p)(e.entregable.fecha_fin)),1)],2)):w("",!0),e.entregable.responsable?(u(),D("span",ro,[l(o(Je),{class:"h-3 w-3"}),_(" "+E(e.entregable.responsable.name),1)])):w("",!0)])):w("",!0)])]),e.variant==="kanban"?(u(),D("div",uo,[l(o(W),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:P[1]||(P[1]=St(U=>a("view"),["stop"]))},{default:r(()=>[l(o($a),{class:"h-3 w-3 mr-1"}),P[13]||(P[13]=_(" Ver ",-1))]),_:1}),l(o(W),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:P[2]||(P[2]=St(U=>a("edit"),["stop"]))},{default:r(()=>[l(o(bt),{class:"h-3 w-3 mr-1"}),P[14]||(P[14]=_(" Editar ",-1))]),_:1}),l(o(W),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:P[3]||(P[3]=St(U=>a("show-comentarios"),["stop"])),title:"Comentarios"},{default:r(()=>[l(o(yt),{class:"h-3 w-3"}),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(u(),D("span",co,E(e.entregable.comentarios_count),1)):w("",!0)]),_:1}),l(o(W),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:P[4]||(P[4]=St(U=>a("show-actividad"),["stop"])),title:"Actividad"},{default:r(()=>[l(o(xt),{class:"h-3 w-3"})]),_:1})])):w("",!0),e.expanded&&e.variant!=="kanban"?(u(),D("div",fo,[e.entregable.descripcion?(u(),D("p",mo,E(e.entregable.descripcion),1)):w("",!0),g("div",go,[g("div",po,[l(o(Ge),{class:"h-4 w-4"}),g("span",null,E(o(p)(e.entregable.fecha_inicio))+" - "+E(o(p)(e.entregable.fecha_fin)),1)]),e.entregable.responsable?(u(),D("div",vo,[l(o(Je),{class:"h-4 w-4"}),g("span",null,E(e.entregable.responsable.name),1)])):w("",!0),c.value?(u(),D("div",{key:1,class:J(["flex items-center gap-1",{"text-red-600":S.value}])},[l(o(Pe),{class:"h-4 w-4"}),g("span",null,E(c.value),1)],2)):w("",!0)]),e.entregable.usuarios&&e.entregable.usuarios.length>0?(u(),D("div",ho,[l(o(Ja),{class:"h-4 w-4 text-muted-foreground"}),g("div",bo,[(u(!0),D(K,null,ce(e.entregable.usuarios,U=>(u(),O(o(ae),{key:U.id,variant:"secondary",class:"text-xs"},{default:r(()=>[_(E(U.name),1)]),_:2},1024))),128))])])):w("",!0),h.value?(u(),D("div",yo,[e.entregable.completado_at?(u(),D("div",xo,[l(o(Pe),{class:"h-3 w-3"}),g("span",null,"Completado: "+E(o(v)(e.entregable.completado_at)),1)])):w("",!0),e.entregable.completado_por_usuario?(u(),D("div",_o,[l(o(Je),{class:"h-3 w-3"}),g("span",null,"Por: "+E(e.entregable.completado_por_usuario.name),1)])):w("",!0),e.entregable.observaciones_estado?(u(),D("p",wo,' "'+E(e.entregable.observaciones_estado)+'" ',1)):w("",!0)])):w("",!0)])):w("",!0),e.variant==="default"&&(e.canEdit||e.canDelete||e.canComplete)?(u(),D("div",Eo,[l(o(W),{variant:"outline",size:"sm",class:"h-7 text-xs",onClick:P[5]||(P[5]=U=>a("view"))},{default:r(()=>[l(o($a),{class:"h-3 w-3 mr-1"}),P[15]||(P[15]=_(" Ver detalles ",-1))]),_:1}),!h.value&&!T.value?(u(),D(K,{key:0},[e.canComplete?(u(),O(o(W),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:P[6]||(P[6]=U=>a("complete"))},{default:r(()=>[l(o(at),{class:"h-3 w-3 mr-1"}),P[16]||(P[16]=_(" Completar ",-1))]),_:1})):w("",!0),e.canEdit&&e.entregable.estado==="pendiente"?(u(),O(o(W),{key:1,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:P[7]||(P[7]=U=>a("change-status","en_progreso"))},{default:r(()=>[l(o(Pe),{class:"h-3 w-3 mr-1"}),P[17]||(P[17]=_(" En progreso ",-1))]),_:1})):w("",!0)],64)):h.value?(u(),D(K,{key:1},[e.canEdit?(u(),O(o(W),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:P[8]||(P[8]=U=>a("change-status","pendiente"))},{default:r(()=>[l(o(tt),{class:"h-3 w-3 mr-1"}),P[18]||(P[18]=_(" Reabrir ",-1))]),_:1})):w("",!0)],64)):w("",!0),e.canEdit?(u(),O(o(W),{key:2,variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:P[9]||(P[9]=U=>a("edit"))},{default:r(()=>[l(o(bt),{class:"h-3 w-3 mr-1"}),P[19]||(P[19]=_(" Editar ",-1))]),_:1})):w("",!0),l(o(W),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:P[10]||(P[10]=U=>a("show-comentarios"))},{default:r(()=>[l(o(yt),{class:"h-3 w-3 mr-1"}),P[20]||(P[20]=_(" Comentarios ",-1)),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(u(),O(o(ae),{key:0,variant:"secondary",class:"ml-1 text-xs"},{default:r(()=>[_(E(e.entregable.comentarios_count),1)]),_:1})):w("",!0)]),_:1}),l(o(W),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:P[11]||(P[11]=U=>a("show-actividad"))},{default:r(()=>[l(o(xt),{class:"h-3 w-3 mr-1"}),P[21]||(P[21]=_(" Actividad ",-1))]),_:1}),e.canDelete?(u(),O(o(W),{key:3,variant:"ghost",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50",onClick:P[12]||(P[12]=U=>a("delete"))},{default:r(()=>[l(o(Za),{class:"h-3 w-3 mr-1"}),P[22]||(P[22]=_(" Eliminar ",-1))]),_:1})):w("",!0)])):w("",!0)]),_:1},8,["class"])]),_:1},8,["class","data-id","data-estado"]))}}),Co={class:"space-y-6"},Do={key:0},ko={class:"font-semibold mb-3 flex items-center gap-2"},So={class:"space-y-2"},$o={key:0,class:"text-center py-8"},Io=Me({__name:"HitosEntregablesList",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=ot(n,"entregables"),{entregablesAgrupados:s}=_t(i),d=G(new Set),p=C=>{d.value.has(C)?d.value.delete(C):d.value.add(C)},v=C=>d.value.has(C),f=C=>{a("complete",C)},b=(C,c)=>{a("change-status",C,c)},m=[{key:"pendientes",icon:tt,iconClass:"text-yellow-600",label:"Pendientes"},{key:"en_progreso",icon:Pe,iconClass:"text-blue-600",label:"En Progreso"},{key:"completados",icon:at,iconClass:"text-green-600",label:"Completados"},{key:"cancelados",icon:Kt,iconClass:"text-red-600",label:"Cancelados"}];return(C,c)=>(u(),D("div",Co,[(u(),D(K,null,ce(m,S=>(u(),D(K,{key:S.key},[o(s)[S.key].length>0?(u(),D("div",Do,[g("h3",ko,[(u(),O(et(S.icon),{class:J(["h-5 w-5",S.iconClass])},null,8,["class"])),_(" "+E(S.label)+" ("+E(o(s)[S.key].length)+") ",1)]),g("div",So,[(u(!0),D(K,null,ce(o(s)[S.key],h=>(u(),O(xa,{key:h.id,entregable:h,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:v(h.id),variant:"default",onToggleExpand:T=>p(h.id),onEdit:T=>a("edit",h),onDelete:T=>a("delete",h),onComplete:T=>f(h),onChangeStatus:T=>b(h,T),onShowComentarios:T=>a("show-comentarios",h),onShowActividad:T=>a("show-actividad",h)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])])):w("",!0)],64))),64)),e.entregables.length===0?(u(),D("div",$o,[l(o(Bt),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),c[0]||(c[0]=g("p",{class:"text-muted-foreground"},"No hay entregables asignados",-1))])):w("",!0)]))}}),To={class:"hidden sm:inline text-xs"},Po={key:0,class:"space-y-2"},Ao={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},Oo={class:"text-muted-foreground text-sm"},Mo=Me({__name:"HitosEntregablesTabs",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=ot(n,"entregables"),{entregablesAgrupados:s}=_t(i),d=G(new Set),p=G("pendiente"),v=S=>{d.value.has(S)?d.value.delete(S):d.value.add(S)},f=S=>d.value.has(S),b={pendiente:{icon:tt,iconClass:"text-yellow-600",label:"Pendientes",key:"pendientes"},en_progreso:{icon:Pe,iconClass:"text-blue-600",label:"En Progreso",key:"en_progreso"},completado:{icon:at,iconClass:"text-green-600",label:"Completados",key:"completados"},cancelado:{icon:Kt,iconClass:"text-red-600",label:"Cancelados",key:"cancelados"}},m=S=>{a("complete",S)},C=(S,h)=>{a("change-status",S,h)},c=S=>{const h=b[S];return s.value[h.key]};return(S,h)=>(u(),O(o(ba),{modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=T=>p.value=T),class:"w-full"},{default:r(()=>[l(o(ya),{class:"w-full grid grid-cols-4 h-auto"},{default:r(()=>[(u(!0),D(K,null,ce(o(ma),T=>(u(),O(o(Ie),{key:T,value:T,class:"gap-1.5 py-2 px-2 data-[state=active]:bg-background"},{default:r(()=>[(u(),O(et(b[T].icon),{class:J(["h-4 w-4 flex-shrink-0",b[T].iconClass])},null,8,["class"])),g("span",To,E(b[T].label),1),l(o(ae),{variant:"secondary",class:"ml-1 text-xs px-1.5 py-0"},{default:r(()=>[_(E(c(T).length),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),(u(!0),D(K,null,ce(o(ma),T=>(u(),O(o(Te),{key:T,value:T,class:"mt-4"},{default:r(()=>[c(T).length>0?(u(),D("div",Po,[(u(!0),D(K,null,ce(c(T),j=>(u(),O(xa,{key:j.id,entregable:j,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:f(j.id),variant:"default",onToggleExpand:H=>v(j.id),onEdit:H=>a("edit",j),onDelete:H=>a("delete",j),onComplete:H=>m(j),onChangeStatus:H=>C(j,H),onShowComentarios:H=>a("show-comentarios",j),onShowActividad:H=>a("show-actividad",j)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])):(u(),D("div",Ao,[(u(),O(et(b[T].icon),{class:J(["h-10 w-10 mx-auto mb-3",b[T].iconClass+"/50"])},null,8,["class"])),g("p",Oo," No hay entregables "+E(b[T].label.toLowerCase()),1)]))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))}});/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ma(Object(n),!0).forEach(function(a){No(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ma(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Ot(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ot=function(t){return typeof t}:Ot=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(e)}function No(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Re(){return Re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Re.apply(this,arguments)}function Ro(e,t){if(e==null)return{};var n={},a=Object.keys(e),i,s;for(s=0;s<a.length;s++)i=a[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Fo(e,t){if(e==null)return{};var n=Ro(e,t),a,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var zo="1.15.6";function Ne(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Fe=Ne(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),wt=Ne(/Edge/i),Na=Ne(/firefox/i),ft=Ne(/safari/i)&&!Ne(/chrome/i)&&!Ne(/android/i),_a=Ne(/iP(ad|od|hone)/i),cn=Ne(/chrome/i)&&Ne(/android/i),fn={capture:!1,passive:!1};function X(e,t,n){e.addEventListener(t,n,!Fe&&fn)}function L(e,t,n){e.removeEventListener(t,n,!Fe&&fn)}function Xt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function mn(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Ce(e,t,n,a){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&Xt(e,t):Xt(e,t))||a&&e===n)return e;if(e===n)break}while(e=mn(e))}return null}var Ra=/\s+/g;function ye(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(Ra," ").replace(" "+t+" "," ");e.className=(a+(n?" "+t:"")).replace(Ra," ")}}function F(e,t,n){var a=e&&e.style;if(a){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in a)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),a[t]=n+(typeof n=="string"?"":"px")}}function Ze(e,t){var n="";if(typeof e=="string")n=e;else do{var a=F(e,"transform");a&&a!=="none"&&(n=a+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function gn(e,t,n){if(e){var a=e.getElementsByTagName(t),i=0,s=a.length;if(n)for(;i<s;i++)n(a[i],i);return a}return[]}function Ae(){var e=document.scrollingElement;return e||document.documentElement}function le(e,t,n,a,i){if(!(!e.getBoundingClientRect&&e!==window)){var s,d,p,v,f,b,m;if(e!==window&&e.parentNode&&e!==Ae()?(s=e.getBoundingClientRect(),d=s.top,p=s.left,v=s.bottom,f=s.right,b=s.height,m=s.width):(d=0,p=0,v=window.innerHeight,f=window.innerWidth,b=window.innerHeight,m=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!Fe))do if(i&&i.getBoundingClientRect&&(F(i,"transform")!=="none"||n&&F(i,"position")!=="static")){var C=i.getBoundingClientRect();d-=C.top+parseInt(F(i,"border-top-width")),p-=C.left+parseInt(F(i,"border-left-width")),v=d+s.height,f=p+s.width;break}while(i=i.parentNode);if(a&&e!==window){var c=Ze(i||e),S=c&&c.a,h=c&&c.d;c&&(d/=h,p/=S,m/=S,b/=h,v=d+b,f=p+m)}return{top:d,left:p,bottom:v,right:f,width:m,height:b}}}function Fa(e,t,n){for(var a=He(e,!0),i=le(e)[t];a;){var s=le(a)[n],d=void 0;if(d=i>=s,!d)return a;if(a===Ae())break;a=He(a,!1)}return!1}function nt(e,t,n,a){for(var i=0,s=0,d=e.children;s<d.length;){if(d[s].style.display!=="none"&&d[s]!==z.ghost&&(a||d[s]!==z.dragged)&&Ce(d[s],n.draggable,e,!1)){if(i===t)return d[s];i++}s++}return null}function wa(e,t){for(var n=e.lastElementChild;n&&(n===z.ghost||F(n,"display")==="none"||t&&!Xt(n,t));)n=n.previousElementSibling;return n||null}function _e(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==z.clone&&(!t||Xt(e,t))&&n++;return n}function za(e){var t=0,n=0,a=Ae();if(e)do{var i=Ze(e),s=i.a,d=i.d;t+=e.scrollLeft*s,n+=e.scrollTop*d}while(e!==a&&(e=e.parentNode));return[t,n]}function Vo(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var a in t)if(t.hasOwnProperty(a)&&t[a]===e[n][a])return Number(n)}return-1}function He(e,t){if(!e||!e.getBoundingClientRect)return Ae();var n=e,a=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=F(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Ae();if(a||t)return n;a=!0}}while(n=n.parentNode);return Ae()}function Bo(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function na(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var mt;function pn(e,t){return function(){if(!mt){var n=arguments,a=this;n.length===1?e.call(a,n[0]):e.apply(a,n),mt=setTimeout(function(){mt=void 0},t)}}}function Ho(){clearTimeout(mt),mt=void 0}function vn(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function hn(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function bn(e,t,n){var a={};return Array.from(e.children).forEach(function(i){var s,d,p,v;if(!(!Ce(i,t.draggable,e,!1)||i.animated||i===n)){var f=le(i);a.left=Math.min((s=a.left)!==null&&s!==void 0?s:1/0,f.left),a.top=Math.min((d=a.top)!==null&&d!==void 0?d:1/0,f.top),a.right=Math.max((p=a.right)!==null&&p!==void 0?p:-1/0,f.right),a.bottom=Math.max((v=a.bottom)!==null&&v!==void 0?v:-1/0,f.bottom)}}),a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}var he="Sortable"+new Date().getTime();function Uo(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(i){if(!(F(i,"display")==="none"||i===z.ghost)){e.push({target:i,rect:le(i)});var s=Oe({},e[e.length-1].rect);if(i.thisAnimationDuration){var d=Ze(i,!0);d&&(s.top-=d.f,s.left-=d.e)}i.fromRect=s}})}},addAnimationState:function(a){e.push(a)},removeAnimationState:function(a){e.splice(Vo(e,{target:a}),1)},animateAll:function(a){var i=this;if(!this.options.animation){clearTimeout(t),typeof a=="function"&&a();return}var s=!1,d=0;e.forEach(function(p){var v=0,f=p.target,b=f.fromRect,m=le(f),C=f.prevFromRect,c=f.prevToRect,S=p.rect,h=Ze(f,!0);h&&(m.top-=h.f,m.left-=h.e),f.toRect=m,f.thisAnimationDuration&&na(C,m)&&!na(b,m)&&(S.top-m.top)/(S.left-m.left)===(b.top-m.top)/(b.left-m.left)&&(v=Lo(S,C,c,i.options)),na(m,b)||(f.prevFromRect=b,f.prevToRect=m,v||(v=i.options.animation),i.animate(f,S,m,v)),v&&(s=!0,d=Math.max(d,v),clearTimeout(f.animationResetTimer),f.animationResetTimer=setTimeout(function(){f.animationTime=0,f.prevFromRect=null,f.fromRect=null,f.prevToRect=null,f.thisAnimationDuration=null},v),f.thisAnimationDuration=v)}),clearTimeout(t),s?t=setTimeout(function(){typeof a=="function"&&a()},d):typeof a=="function"&&a(),e=[]},animate:function(a,i,s,d){if(d){F(a,"transition",""),F(a,"transform","");var p=Ze(this.el),v=p&&p.a,f=p&&p.d,b=(i.left-s.left)/(v||1),m=(i.top-s.top)/(f||1);a.animatingX=!!b,a.animatingY=!!m,F(a,"transform","translate3d("+b+"px,"+m+"px,0)"),this.forRepaintDummy=jo(a),F(a,"transition","transform "+d+"ms"+(this.options.easing?" "+this.options.easing:"")),F(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){F(a,"transition",""),F(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},d)}}}}function jo(e){return e.offsetWidth}function Lo(e,t,n,a){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*a.animation}var We=[],oa={initializeByDefault:!0},Et={mount:function(t){for(var n in oa)oa.hasOwnProperty(n)&&!(n in t)&&(t[n]=oa[n]);We.forEach(function(a){if(a.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),We.push(t)},pluginEvent:function(t,n,a){var i=this;this.eventCanceled=!1,a.cancel=function(){i.eventCanceled=!0};var s=t+"Global";We.forEach(function(d){n[d.pluginName]&&(n[d.pluginName][s]&&n[d.pluginName][s](Oe({sortable:n},a)),n.options[d.pluginName]&&n[d.pluginName][t]&&n[d.pluginName][t](Oe({sortable:n},a)))})},initializePlugins:function(t,n,a,i){We.forEach(function(p){var v=p.pluginName;if(!(!t.options[v]&&!p.initializeByDefault)){var f=new p(t,n,t.options);f.sortable=t,f.options=t.options,t[v]=f,Re(a,f.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var d=this.modifyOption(t,s,t.options[s]);typeof d<"u"&&(t.options[s]=d)}},getEventProperties:function(t,n){var a={};return We.forEach(function(i){typeof i.eventProperties=="function"&&Re(a,i.eventProperties.call(n[i.pluginName],t))}),a},modifyOption:function(t,n,a){var i;return We.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[n]=="function"&&(i=s.optionListeners[n].call(t[s.pluginName],a))}),i}};function Xo(e){var t=e.sortable,n=e.rootEl,a=e.name,i=e.targetEl,s=e.cloneEl,d=e.toEl,p=e.fromEl,v=e.oldIndex,f=e.newIndex,b=e.oldDraggableIndex,m=e.newDraggableIndex,C=e.originalEvent,c=e.putSortable,S=e.extraEventProperties;if(t=t||n&&n[he],!!t){var h,T=t.options,j="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Fe&&!wt?h=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(h=document.createEvent("Event"),h.initEvent(a,!0,!0)),h.to=d||n,h.from=p||n,h.item=i||n,h.clone=s,h.oldIndex=v,h.newIndex=f,h.oldDraggableIndex=b,h.newDraggableIndex=m,h.originalEvent=C,h.pullMode=c?c.lastPutMode:void 0;var H=Oe(Oe({},S),Et.getEventProperties(a,t));for(var Q in H)h[Q]=H[Q];n&&n.dispatchEvent(h),T[j]&&T[j].call(t,h)}}var Yo=["evt"],ge=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=a.evt,s=Fo(a,Yo);Et.pluginEvent.bind(z)(t,n,Oe({dragEl:$,parentEl:te,ghostEl:B,rootEl:Z,nextEl:Le,lastDownEl:Mt,cloneEl:ee,cloneHidden:Ve,dragStarted:it,putSortable:de,activeSortable:z.active,originalEvent:i,oldIndex:Qe,oldDraggableIndex:gt,newIndex:xe,newDraggableIndex:ze,hideGhostForTarget:wn,unhideGhostForTarget:En,cloneNowHidden:function(){Ve=!0},cloneNowShown:function(){Ve=!1},dispatchSortableEvent:function(p){me({sortable:n,name:p,originalEvent:i})}},s))};function me(e){Xo(Oe({putSortable:de,cloneEl:ee,targetEl:$,rootEl:Z,oldIndex:Qe,oldDraggableIndex:gt,newIndex:xe,newDraggableIndex:ze},e))}var $,te,B,Z,Le,Mt,ee,Ve,Qe,xe,gt,ze,$t,de,Ke=!1,Yt=!1,Gt=[],Ue,Ee,la,sa,Va,Ba,it,qe,pt,vt=!1,It=!1,Nt,ue,ia=[],ga=!1,Wt=[],Qt=typeof document<"u",Tt=_a,Ha=wt||Fe?"cssFloat":"float",Go=Qt&&!cn&&!_a&&"draggable"in document.createElement("div"),yn=(function(){if(Qt){if(Fe)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),xn=function(t,n){var a=F(t),i=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),s=nt(t,0,n),d=nt(t,1,n),p=s&&F(s),v=d&&F(d),f=p&&parseInt(p.marginLeft)+parseInt(p.marginRight)+le(s).width,b=v&&parseInt(v.marginLeft)+parseInt(v.marginRight)+le(d).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&p.float&&p.float!=="none"){var m=p.float==="left"?"left":"right";return d&&(v.clear==="both"||v.clear===m)?"vertical":"horizontal"}return s&&(p.display==="block"||p.display==="flex"||p.display==="table"||p.display==="grid"||f>=i&&a[Ha]==="none"||d&&a[Ha]==="none"&&f+b>i)?"vertical":"horizontal"},Wo=function(t,n,a){var i=a?t.left:t.top,s=a?t.right:t.bottom,d=a?t.width:t.height,p=a?n.left:n.top,v=a?n.right:n.bottom,f=a?n.width:n.height;return i===p||s===v||i+d/2===p+f/2},qo=function(t,n){var a;return Gt.some(function(i){var s=i[he].options.emptyInsertThreshold;if(!(!s||wa(i))){var d=le(i),p=t>=d.left-s&&t<=d.right+s,v=n>=d.top-s&&n<=d.bottom+s;if(p&&v)return a=i}}),a},_n=function(t){function n(s,d){return function(p,v,f,b){var m=p.options.group.name&&v.options.group.name&&p.options.group.name===v.options.group.name;if(s==null&&(d||m))return!0;if(s==null||s===!1)return!1;if(d&&s==="clone")return s;if(typeof s=="function")return n(s(p,v,f,b),d)(p,v,f,b);var C=(d?p:v).options.group.name;return s===!0||typeof s=="string"&&s===C||s.join&&s.indexOf(C)>-1}}var a={},i=t.group;(!i||Ot(i)!="object")&&(i={name:i}),a.name=i.name,a.checkPull=n(i.pull,!0),a.checkPut=n(i.put),a.revertClone=i.revertClone,t.group=a},wn=function(){!yn&&B&&F(B,"display","none")},En=function(){!yn&&B&&F(B,"display","")};Qt&&!cn&&document.addEventListener("click",function(e){if(Yt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Yt=!1,!1},!0);var je=function(t){if($){t=t.touches?t.touches[0]:t;var n=qo(t.clientX,t.clientY);if(n){var a={};for(var i in t)t.hasOwnProperty(i)&&(a[i]=t[i]);a.target=a.rootEl=n,a.preventDefault=void 0,a.stopPropagation=void 0,n[he]._onDragOver(a)}}},Ko=function(t){$&&$.parentNode[he]._isOutsideThisEl(t.target)};function z(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Re({},t),e[he]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return xn(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(d,p){d.setData("Text",p.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:z.supportPointer!==!1&&"PointerEvent"in window&&(!ft||_a),emptyInsertThreshold:5};Et.initializePlugins(this,e,n);for(var a in n)!(a in t)&&(t[a]=n[a]);_n(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:Go,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?X(e,"pointerdown",this._onTapStart):(X(e,"mousedown",this._onTapStart),X(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(X(e,"dragover",this),X(e,"dragenter",this)),Gt.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Re(this,Uo())}z.prototype={constructor:z,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(qe=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,$):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,a=this.el,i=this.options,s=i.preventOnFilter,d=t.type,p=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,v=(p||t).target,f=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||v,b=i.filter;if(ol(a),!$&&!(/mousedown|pointerdown/.test(d)&&t.button!==0||i.disabled)&&!f.isContentEditable&&!(!this.nativeDraggable&&ft&&v&&v.tagName.toUpperCase()==="SELECT")&&(v=Ce(v,i.draggable,a,!1),!(v&&v.animated)&&Mt!==v)){if(Qe=_e(v),gt=_e(v,i.draggable),typeof b=="function"){if(b.call(this,t,v,this)){me({sortable:n,rootEl:f,name:"filter",targetEl:v,toEl:a,fromEl:a}),ge("filter",n,{evt:t}),s&&t.preventDefault();return}}else if(b&&(b=b.split(",").some(function(m){if(m=Ce(f,m.trim(),a,!1),m)return me({sortable:n,rootEl:m,name:"filter",targetEl:v,fromEl:a,toEl:a}),ge("filter",n,{evt:t}),!0}),b)){s&&t.preventDefault();return}i.handle&&!Ce(f,i.handle,a,!1)||this._prepareDragStart(t,p,v)}}},_prepareDragStart:function(t,n,a){var i=this,s=i.el,d=i.options,p=s.ownerDocument,v;if(a&&!$&&a.parentNode===s){var f=le(a);if(Z=s,$=a,te=$.parentNode,Le=$.nextSibling,Mt=a,$t=d.group,z.dragged=$,Ue={target:$,clientX:(n||t).clientX,clientY:(n||t).clientY},Va=Ue.clientX-f.left,Ba=Ue.clientY-f.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,$.style["will-change"]="all",v=function(){if(ge("delayEnded",i,{evt:t}),z.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Na&&i.nativeDraggable&&($.draggable=!0),i._triggerDragStart(t,n),me({sortable:i,name:"choose",originalEvent:t}),ye($,d.chosenClass,!0)},d.ignore.split(",").forEach(function(b){gn($,b.trim(),ra)}),X(p,"dragover",je),X(p,"mousemove",je),X(p,"touchmove",je),d.supportPointer?(X(p,"pointerup",i._onDrop),!this.nativeDraggable&&X(p,"pointercancel",i._onDrop)):(X(p,"mouseup",i._onDrop),X(p,"touchend",i._onDrop),X(p,"touchcancel",i._onDrop)),Na&&this.nativeDraggable&&(this.options.touchStartThreshold=4,$.draggable=!0),ge("delayStart",this,{evt:t}),d.delay&&(!d.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(wt||Fe))){if(z.eventCanceled){this._onDrop();return}d.supportPointer?(X(p,"pointerup",i._disableDelayedDrag),X(p,"pointercancel",i._disableDelayedDrag)):(X(p,"mouseup",i._disableDelayedDrag),X(p,"touchend",i._disableDelayedDrag),X(p,"touchcancel",i._disableDelayedDrag)),X(p,"mousemove",i._delayedDragTouchMoveHandler),X(p,"touchmove",i._delayedDragTouchMoveHandler),d.supportPointer&&X(p,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(v,d.delay)}else v()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){$&&ra($),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._disableDelayedDrag),L(t,"touchend",this._disableDelayedDrag),L(t,"touchcancel",this._disableDelayedDrag),L(t,"pointerup",this._disableDelayedDrag),L(t,"pointercancel",this._disableDelayedDrag),L(t,"mousemove",this._delayedDragTouchMoveHandler),L(t,"touchmove",this._delayedDragTouchMoveHandler),L(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?X(document,"pointermove",this._onTouchMove):n?X(document,"touchmove",this._onTouchMove):X(document,"mousemove",this._onTouchMove):(X($,"dragend",this),X(Z,"dragstart",this._onDragStart));try{document.selection?Rt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(Ke=!1,Z&&$){ge("dragStarted",this,{evt:n}),this.nativeDraggable&&X(document,"dragover",Ko);var a=this.options;!t&&ye($,a.dragClass,!1),ye($,a.ghostClass,!0),z.active=this,t&&this._appendGhost(),me({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Ee){this._lastX=Ee.clientX,this._lastY=Ee.clientY,wn();for(var t=document.elementFromPoint(Ee.clientX,Ee.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(Ee.clientX,Ee.clientY),t!==n);)n=t;if($.parentNode[he]._isOutsideThisEl(t),n)do{if(n[he]){var a=void 0;if(a=n[he]._onDragOver({clientX:Ee.clientX,clientY:Ee.clientY,target:t,rootEl:n}),a&&!this.options.dragoverBubble)break}t=n}while(n=mn(n));En()}},_onTouchMove:function(t){if(Ue){var n=this.options,a=n.fallbackTolerance,i=n.fallbackOffset,s=t.touches?t.touches[0]:t,d=B&&Ze(B,!0),p=B&&d&&d.a,v=B&&d&&d.d,f=Tt&&ue&&za(ue),b=(s.clientX-Ue.clientX+i.x)/(p||1)+(f?f[0]-ia[0]:0)/(p||1),m=(s.clientY-Ue.clientY+i.y)/(v||1)+(f?f[1]-ia[1]:0)/(v||1);if(!z.active&&!Ke){if(a&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<a)return;this._onDragStart(t,!0)}if(B){d?(d.e+=b-(la||0),d.f+=m-(sa||0)):d={a:1,b:0,c:0,d:1,e:b,f:m};var C="matrix(".concat(d.a,",").concat(d.b,",").concat(d.c,",").concat(d.d,",").concat(d.e,",").concat(d.f,")");F(B,"webkitTransform",C),F(B,"mozTransform",C),F(B,"msTransform",C),F(B,"transform",C),la=b,sa=m,Ee=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!B){var t=this.options.fallbackOnBody?document.body:Z,n=le($,!0,Tt,!0,t),a=this.options;if(Tt){for(ue=t;F(ue,"position")==="static"&&F(ue,"transform")==="none"&&ue!==document;)ue=ue.parentNode;ue!==document.body&&ue!==document.documentElement?(ue===document&&(ue=Ae()),n.top+=ue.scrollTop,n.left+=ue.scrollLeft):ue=Ae(),ia=za(ue)}B=$.cloneNode(!0),ye(B,a.ghostClass,!1),ye(B,a.fallbackClass,!0),ye(B,a.dragClass,!0),F(B,"transition",""),F(B,"transform",""),F(B,"box-sizing","border-box"),F(B,"margin",0),F(B,"top",n.top),F(B,"left",n.left),F(B,"width",n.width),F(B,"height",n.height),F(B,"opacity","0.8"),F(B,"position",Tt?"absolute":"fixed"),F(B,"zIndex","100000"),F(B,"pointerEvents","none"),z.ghost=B,t.appendChild(B),F(B,"transform-origin",Va/parseInt(B.style.width)*100+"% "+Ba/parseInt(B.style.height)*100+"%")}},_onDragStart:function(t,n){var a=this,i=t.dataTransfer,s=a.options;if(ge("dragStart",this,{evt:t}),z.eventCanceled){this._onDrop();return}ge("setupClone",this),z.eventCanceled||(ee=hn($),ee.removeAttribute("id"),ee.draggable=!1,ee.style["will-change"]="",this._hideClone(),ye(ee,this.options.chosenClass,!1),z.clone=ee),a.cloneId=Rt(function(){ge("clone",a),!z.eventCanceled&&(a.options.removeCloneOnHide||Z.insertBefore(ee,$),a._hideClone(),me({sortable:a,name:"clone"}))}),!n&&ye($,s.dragClass,!0),n?(Yt=!0,a._loopId=setInterval(a._emulateDragOver,50)):(L(document,"mouseup",a._onDrop),L(document,"touchend",a._onDrop),L(document,"touchcancel",a._onDrop),i&&(i.effectAllowed="move",s.setData&&s.setData.call(a,i,$)),X(document,"drop",a),F($,"transform","translateZ(0)")),Ke=!0,a._dragStartId=Rt(a._dragStarted.bind(a,n,t)),X(document,"selectstart",a),it=!0,window.getSelection().removeAllRanges(),ft&&F(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,a=t.target,i,s,d,p=this.options,v=p.group,f=z.active,b=$t===v,m=p.sort,C=de||f,c,S=this,h=!1;if(ga)return;function T(ke,Jt){ge(ke,S,Oe({evt:t,isOwner:b,axis:c?"vertical":"horizontal",revert:d,dragRect:i,targetRect:s,canSort:m,fromSortable:C,target:a,completed:H,onMove:function(Ct,Dt){return Pt(Z,n,$,i,Ct,le(Ct),t,Dt)},changed:Q},Jt))}function j(){T("dragOverAnimationCapture"),S.captureAnimationState(),S!==C&&C.captureAnimationState()}function H(ke){return T("dragOverCompleted",{insertion:ke}),ke&&(b?f._hideClone():f._showClone(S),S!==C&&(ye($,de?de.options.ghostClass:f.options.ghostClass,!1),ye($,p.ghostClass,!0)),de!==S&&S!==z.active?de=S:S===z.active&&de&&(de=null),C===S&&(S._ignoreWhileAnimating=a),S.animateAll(function(){T("dragOverAnimationComplete"),S._ignoreWhileAnimating=null}),S!==C&&(C.animateAll(),C._ignoreWhileAnimating=null)),(a===$&&!$.animated||a===n&&!a.animated)&&(qe=null),!p.dragoverBubble&&!t.rootEl&&a!==document&&($.parentNode[he]._isOutsideThisEl(t.target),!ke&&je(t)),!p.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),h=!0}function Q(){xe=_e($),ze=_e($,p.draggable),me({sortable:S,name:"change",toEl:n,newIndex:xe,newDraggableIndex:ze,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),a=Ce(a,p.draggable,n,!0),T("dragOver"),z.eventCanceled)return h;if($.contains(t.target)||a.animated&&a.animatingX&&a.animatingY||S._ignoreWhileAnimating===a)return H(!1);if(Yt=!1,f&&!p.disabled&&(b?m||(d=te!==Z):de===this||(this.lastPutMode=$t.checkPull(this,f,$,t))&&v.checkPut(this,f,$,t))){if(c=this._getDirection(t,a)==="vertical",i=le($),T("dragOverValid"),z.eventCanceled)return h;if(d)return te=Z,j(),this._hideClone(),T("revert"),z.eventCanceled||(Le?Z.insertBefore($,Le):Z.appendChild($)),H(!0);var P=wa(n,p.draggable);if(!P||el(t,c,this)&&!P.animated){if(P===$)return H(!1);if(P&&n===t.target&&(a=P),a&&(s=le(a)),Pt(Z,n,$,i,a,s,t,!!a)!==!1)return j(),P&&P.nextSibling?n.insertBefore($,P.nextSibling):n.appendChild($),te=n,Q(),H(!0)}else if(P&&Zo(t,c,this)){var U=nt(n,0,p,!0);if(U===$)return H(!1);if(a=U,s=le(a),Pt(Z,n,$,i,a,s,t,!1)!==!1)return j(),n.insertBefore($,U),te=n,Q(),H(!0)}else if(a.parentNode===n){s=le(a);var ne=0,se,fe=$.parentNode!==n,k=!Wo($.animated&&$.toRect||i,a.animated&&a.toRect||s,c),y=c?"top":"left",N=Fa(a,"top","top")||Fa($,"top","top"),A=N?N.scrollTop:void 0;qe!==a&&(se=s[y],vt=!1,It=!k&&p.invertSwap||fe),ne=tl(t,a,s,c,k?1:p.swapThreshold,p.invertedSwapThreshold==null?p.swapThreshold:p.invertedSwapThreshold,It,qe===a);var x;if(ne!==0){var M=_e($);do M-=ne,x=te.children[M];while(x&&(F(x,"display")==="none"||x===B))}if(ne===0||x===a)return H(!1);qe=a,pt=ne;var Y=a.nextElementSibling,re=!1;re=ne===1;var De=Pt(Z,n,$,i,a,s,t,re);if(De!==!1)return(De===1||De===-1)&&(re=De===1),ga=!0,setTimeout(Jo,30),j(),re&&!Y?n.appendChild($):a.parentNode.insertBefore($,re?Y:a),N&&vn(N,0,A-N.scrollTop),te=$.parentNode,se!==void 0&&!It&&(Nt=Math.abs(se-le(a)[y])),Q(),H(!0)}if(n.contains($))return H(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){L(document,"mousemove",this._onTouchMove),L(document,"touchmove",this._onTouchMove),L(document,"pointermove",this._onTouchMove),L(document,"dragover",je),L(document,"mousemove",je),L(document,"touchmove",je)},_offUpEvents:function(){var t=this.el.ownerDocument;L(t,"mouseup",this._onDrop),L(t,"touchend",this._onDrop),L(t,"pointerup",this._onDrop),L(t,"pointercancel",this._onDrop),L(t,"touchcancel",this._onDrop),L(document,"selectstart",this)},_onDrop:function(t){var n=this.el,a=this.options;if(xe=_e($),ze=_e($,a.draggable),ge("drop",this,{evt:t}),te=$&&$.parentNode,xe=_e($),ze=_e($,a.draggable),z.eventCanceled){this._nulling();return}Ke=!1,It=!1,vt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),pa(this.cloneId),pa(this._dragStartId),this.nativeDraggable&&(L(document,"drop",this),L(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),ft&&F(document.body,"user-select",""),F($,"transform",""),t&&(it&&(t.cancelable&&t.preventDefault(),!a.dropBubble&&t.stopPropagation()),B&&B.parentNode&&B.parentNode.removeChild(B),(Z===te||de&&de.lastPutMode!=="clone")&&ee&&ee.parentNode&&ee.parentNode.removeChild(ee),$&&(this.nativeDraggable&&L($,"dragend",this),ra($),$.style["will-change"]="",it&&!Ke&&ye($,de?de.options.ghostClass:this.options.ghostClass,!1),ye($,this.options.chosenClass,!1),me({sortable:this,name:"unchoose",toEl:te,newIndex:null,newDraggableIndex:null,originalEvent:t}),Z!==te?(xe>=0&&(me({rootEl:te,name:"add",toEl:te,fromEl:Z,originalEvent:t}),me({sortable:this,name:"remove",toEl:te,originalEvent:t}),me({rootEl:te,name:"sort",toEl:te,fromEl:Z,originalEvent:t}),me({sortable:this,name:"sort",toEl:te,originalEvent:t})),de&&de.save()):xe!==Qe&&xe>=0&&(me({sortable:this,name:"update",toEl:te,originalEvent:t}),me({sortable:this,name:"sort",toEl:te,originalEvent:t})),z.active&&((xe==null||xe===-1)&&(xe=Qe,ze=gt),me({sortable:this,name:"end",toEl:te,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){ge("nulling",this),Z=$=te=B=Le=ee=Mt=Ve=Ue=Ee=it=xe=ze=Qe=gt=qe=pt=de=$t=z.dragged=z.ghost=z.clone=z.active=null,Wt.forEach(function(t){t.checked=!0}),Wt.length=la=sa=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":$&&(this._onDragOver(t),Qo(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,a=this.el.children,i=0,s=a.length,d=this.options;i<s;i++)n=a[i],Ce(n,d.draggable,this.el,!1)&&t.push(n.getAttribute(d.dataIdAttr)||nl(n));return t},sort:function(t,n){var a={},i=this.el;this.toArray().forEach(function(s,d){var p=i.children[d];Ce(p,this.options.draggable,i,!1)&&(a[s]=p)},this),n&&this.captureAnimationState(),t.forEach(function(s){a[s]&&(i.removeChild(a[s]),i.appendChild(a[s]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Ce(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var a=this.options;if(n===void 0)return a[t];var i=Et.modifyOption(this,t,n);typeof i<"u"?a[t]=i:a[t]=n,t==="group"&&_n(a)},destroy:function(){ge("destroy",this);var t=this.el;t[he]=null,L(t,"mousedown",this._onTapStart),L(t,"touchstart",this._onTapStart),L(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(L(t,"dragover",this),L(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Gt.splice(Gt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!Ve){if(ge("hideClone",this),z.eventCanceled)return;F(ee,"display","none"),this.options.removeCloneOnHide&&ee.parentNode&&ee.parentNode.removeChild(ee),Ve=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(Ve){if(ge("showClone",this),z.eventCanceled)return;$.parentNode==Z&&!this.options.group.revertClone?Z.insertBefore(ee,$):Le?Z.insertBefore(ee,Le):Z.appendChild(ee),this.options.group.revertClone&&this.animate($,ee),F(ee,"display",""),Ve=!1}}};function Qo(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Pt(e,t,n,a,i,s,d,p){var v,f=e[he],b=f.options.onMove,m;return window.CustomEvent&&!Fe&&!wt?v=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent("move",!0,!0)),v.to=t,v.from=e,v.dragged=n,v.draggedRect=a,v.related=i||t,v.relatedRect=s||le(t),v.willInsertAfter=p,v.originalEvent=d,e.dispatchEvent(v),b&&(m=b.call(f,v,d)),m}function ra(e){e.draggable=!1}function Jo(){ga=!1}function Zo(e,t,n){var a=le(nt(n.el,0,n.options,!0)),i=bn(n.el,n.options,B),s=10;return t?e.clientX<i.left-s||e.clientY<a.top&&e.clientX<a.right:e.clientY<i.top-s||e.clientY<a.bottom&&e.clientX<a.left}function el(e,t,n){var a=le(wa(n.el,n.options.draggable)),i=bn(n.el,n.options,B),s=10;return t?e.clientX>i.right+s||e.clientY>a.bottom&&e.clientX>a.left:e.clientY>i.bottom+s||e.clientX>a.right&&e.clientY>a.top}function tl(e,t,n,a,i,s,d,p){var v=a?e.clientY:e.clientX,f=a?n.height:n.width,b=a?n.top:n.left,m=a?n.bottom:n.right,C=!1;if(!d){if(p&&Nt<f*i){if(!vt&&(pt===1?v>b+f*s/2:v<m-f*s/2)&&(vt=!0),vt)C=!0;else if(pt===1?v<b+Nt:v>m-Nt)return-pt}else if(v>b+f*(1-i)/2&&v<m-f*(1-i)/2)return al(t)}return C=C||d,C&&(v<b+f*s/2||v>m-f*s/2)?v>b+f/2?1:-1:0}function al(e){return _e($)<_e(e)?1:-1}function nl(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,a=0;n--;)a+=t.charCodeAt(n);return a.toString(36)}function ol(e){Wt.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var a=t[n];a.checked&&Wt.push(a)}}function Rt(e){return setTimeout(e,0)}function pa(e){return clearTimeout(e)}Qt&&X(document,"touchmove",function(e){(z.active||Ke)&&e.cancelable&&e.preventDefault()});z.utils={on:X,off:L,css:F,find:gn,is:function(t,n){return!!Ce(t,n,t,!1)},extend:Bo,throttle:pn,closest:Ce,toggleClass:ye,clone:hn,index:_e,nextTick:Rt,cancelNextTick:pa,detectDirection:xn,getChild:nt,expando:he};z.get=function(e){return e[he]};z.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(z.utils=Oe(Oe({},z.utils),a.utils)),Et.mount(a)})};z.create=function(e,t){return new z(e,t)};z.version=zo;var oe=[],rt,va,ha=!1,da,ua,qt,dt;function ll(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var a=n.originalEvent;this.sortable.nativeDraggable?X(document,"dragover",this._handleAutoScroll):this.options.supportPointer?X(document,"pointermove",this._handleFallbackAutoScroll):a.touches?X(document,"touchmove",this._handleFallbackAutoScroll):X(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var a=n.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?L(document,"dragover",this._handleAutoScroll):(L(document,"pointermove",this._handleFallbackAutoScroll),L(document,"touchmove",this._handleFallbackAutoScroll),L(document,"mousemove",this._handleFallbackAutoScroll)),Ua(),Ft(),Ho()},nulling:function(){qt=va=rt=ha=dt=da=ua=null,oe.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,a){var i=this,s=(n.touches?n.touches[0]:n).clientX,d=(n.touches?n.touches[0]:n).clientY,p=document.elementFromPoint(s,d);if(qt=n,a||this.options.forceAutoScrollFallback||wt||Fe||ft){ca(n,this.options,p,a);var v=He(p,!0);ha&&(!dt||s!==da||d!==ua)&&(dt&&Ua(),dt=setInterval(function(){var f=He(document.elementFromPoint(s,d),!0);f!==v&&(v=f,Ft()),ca(n,i.options,f,a)},10),da=s,ua=d)}else{if(!this.options.bubbleScroll||He(p,!0)===Ae()){Ft();return}ca(n,this.options,He(p,!1),!1)}}},Re(e,{pluginName:"scroll",initializeByDefault:!0})}function Ft(){oe.forEach(function(e){clearInterval(e.pid)}),oe=[]}function Ua(){clearInterval(dt)}var ca=pn(function(e,t,n,a){if(t.scroll){var i=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,d=t.scrollSensitivity,p=t.scrollSpeed,v=Ae(),f=!1,b;va!==n&&(va=n,Ft(),rt=t.scroll,b=t.scrollFn,rt===!0&&(rt=He(n,!0)));var m=0,C=rt;do{var c=C,S=le(c),h=S.top,T=S.bottom,j=S.left,H=S.right,Q=S.width,P=S.height,U=void 0,ne=void 0,se=c.scrollWidth,fe=c.scrollHeight,k=F(c),y=c.scrollLeft,N=c.scrollTop;c===v?(U=Q<se&&(k.overflowX==="auto"||k.overflowX==="scroll"||k.overflowX==="visible"),ne=P<fe&&(k.overflowY==="auto"||k.overflowY==="scroll"||k.overflowY==="visible")):(U=Q<se&&(k.overflowX==="auto"||k.overflowX==="scroll"),ne=P<fe&&(k.overflowY==="auto"||k.overflowY==="scroll"));var A=U&&(Math.abs(H-i)<=d&&y+Q<se)-(Math.abs(j-i)<=d&&!!y),x=ne&&(Math.abs(T-s)<=d&&N+P<fe)-(Math.abs(h-s)<=d&&!!N);if(!oe[m])for(var M=0;M<=m;M++)oe[M]||(oe[M]={});(oe[m].vx!=A||oe[m].vy!=x||oe[m].el!==c)&&(oe[m].el=c,oe[m].vx=A,oe[m].vy=x,clearInterval(oe[m].pid),(A!=0||x!=0)&&(f=!0,oe[m].pid=setInterval((function(){a&&this.layer===0&&z.active._onTouchMove(qt);var Y=oe[this.layer].vy?oe[this.layer].vy*p:0,re=oe[this.layer].vx?oe[this.layer].vx*p:0;typeof b=="function"&&b.call(z.dragged.parentNode[he],re,Y,e,qt,oe[this.layer].el)!=="continue"||vn(oe[this.layer].el,re,Y)}).bind({layer:m}),24))),m++}while(t.bubbleScroll&&C!==v&&(C=He(C,!1)));ha=f}},30),Cn=function(t){var n=t.originalEvent,a=t.putSortable,i=t.dragEl,s=t.activeSortable,d=t.dispatchSortableEvent,p=t.hideGhostForTarget,v=t.unhideGhostForTarget;if(n){var f=a||s;p();var b=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,m=document.elementFromPoint(b.clientX,b.clientY);v(),f&&!f.el.contains(m)&&(d("spill"),this.onSpill({dragEl:i,putSortable:a}))}};function Ea(){}Ea.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,a=t.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var i=nt(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),a&&a.animateAll()},drop:Cn};Re(Ea,{pluginName:"revertOnSpill"});function Ca(){}Ca.prototype={onSpill:function(t){var n=t.dragEl,a=t.putSortable,i=a||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:Cn};Re(Ca,{pluginName:"removeOnSpill"});z.mount(new ll);z.mount(Ca,Ea);const sl=["data-estado"],il={class:"p-3 border-b bg-background/50 rounded-t-lg"},rl={class:"flex items-center gap-2"},dl={class:"font-medium text-sm"},ul=["data-estado"],cl={key:0,class:"h-20 border-2 border-dashed border-muted-foreground/20 rounded-lg flex items-center justify-center text-sm text-muted-foreground"},fl=Me({__name:"HitosKanbanColumn",props:{estado:{},entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},isDragOver:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=q(()=>ct[n.estado]),s=q(()=>{switch(n.estado){case"completado":return at;case"en_progreso":return Pe;case"cancelado":return Kt;default:return tt}}),d=q(()=>{const p="flex flex-col rounded-lg border bg-muted/30 min-h-[300px] transition-colors duration-150",v=n.isDragOver?"border-primary border-dashed bg-primary/5":"border-border";return`${p} ${v}`});return(p,v)=>(u(),D("div",{class:J(d.value),"data-estado":e.estado},[g("div",il,[g("div",rl,[(u(),O(et(s.value),{class:J(["h-4 w-4 flex-shrink-0",i.value.color])},null,8,["class"])),g("span",dl,E(i.value.label),1),l(o(ae),{variant:"secondary",class:"ml-auto text-xs"},{default:r(()=>[_(E(e.entregables.length),1)]),_:1})])]),l(o(ht),{class:"flex-1 p-2"},{default:r(()=>[g("div",{class:"kanban-column-cards space-y-2 min-h-[200px]","data-estado":e.estado},[(u(!0),D(K,null,ce(e.entregables,f=>(u(),O(xa,{key:f.id,entregable:f,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,draggable:e.canDrag,variant:"kanban",onView:b=>a("view",f),onEdit:b=>a("edit",f),onDelete:b=>a("delete",f),onComplete:b=>a("complete",f),onChangeStatus:b=>a("change-status",f,b),onShowComentarios:b=>a("show-comentarios",f),onShowActividad:b=>a("show-actividad",f)},null,8,["entregable","can-edit","can-delete","can-complete","draggable","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128)),e.entregables.length===0?(u(),D("div",cl," Sin entregables ")):w("",!0)],8,ul)]),_:1})],10,sl))}}),ml={class:"kanban-container flex gap-4 overflow-x-auto snap-x snap-mandatory pb-4 px-1 min-w-0"},gl=Me({__name:"HitosEntregablesKanban",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},confirmOnDrag:{type:Boolean,default:!0}},emits:["view","edit","delete","complete","change-status","drag-change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=ot(n,"entregables"),{entregablesAgrupados:s}=_t(i),d=G(null),p=G([]),v={pendiente:"pendientes",en_progreso:"en_progreso",completado:"completados",cancelado:"cancelados"},f=C=>s.value[v[C]],b=()=>{m(),n.canDrag&&ka(()=>{document.querySelectorAll(".kanban-column-cards").forEach(c=>{const S=z.create(c,{group:"entregables-kanban",animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",delay:100,delayOnTouchOnly:!0,touchStartThreshold:3,onStart:()=>{},onEnd:h=>{const T=parseInt(h.item.dataset.id||"0"),j=h.to.dataset.estado,H=h.from.dataset.estado;if(d.value=null,j===H)return;const Q=n.entregables.find(P=>P.id===T);Q&&a("drag-change-status",Q,j)},onChange:h=>{const T=h.to.dataset.estado;T&&(d.value=T)}});p.value.push(S)})})},m=()=>{p.value.forEach(C=>{C.destroy()}),p.value=[]};return Ya(()=>{b()}),Dn(()=>{m()}),we(()=>n.entregables,()=>{ka(()=>{b()})},{deep:!0}),(C,c)=>(u(),D("div",ml,[(u(!0),D(K,null,ce(o(ma),S=>(u(),D("div",{key:S,class:"kanban-column flex-shrink-0 w-72 snap-center"},[l(fl,{estado:S,entregables:f(S),"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canDrag,"is-drag-over":d.value===S,onView:c[0]||(c[0]=h=>a("view",h)),onEdit:c[1]||(c[1]=h=>a("edit",h)),onDelete:c[2]||(c[2]=h=>a("delete",h)),onComplete:c[3]||(c[3]=h=>a("complete",h)),onChangeStatus:c[4]||(c[4]=(h,T)=>a("change-status",h,T)),onShowComentarios:c[5]||(c[5]=h=>a("show-comentarios",h)),onShowActividad:c[6]||(c[6]=h=>a("show-actividad",h))},null,8,["estado","entregables","can-edit","can-delete","can-complete","can-drag","is-drag-over"])]))),128))]))}}),pl={class:"space-y-4 min-w-0"},ja="entregables-confirm-drag",vl=Me({__name:"HitosEntregablesPanel",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},initialModalEntregableId:{},initialModalTab:{}},emits:["view","edit","delete","complete","update-status","open-modal","modal-tab-change"],setup(e,{emit:t}){const n=e,a=t,i=ot(n,"entregables"),{viewMode:s}=_t(i),p=G((()=>{const k=localStorage.getItem(ja);return k===null?!0:k==="true"})()),v=k=>{p.value=k,localStorage.setItem(ja,String(k))},f=G(!1),b=G(null),m=G("pendiente"),C=G(!1),c=G(!1),S=G(null),h=k=>{a("open-modal",k,"comentarios")},T=k=>{a("open-modal",k,"actividad")};Ya(()=>{if(n.initialModalEntregableId){const k=n.entregables.find(y=>y.id===n.initialModalEntregableId);k&&a("open-modal",k,n.initialModalTab||"detalles")}});const j=k=>{a("open-modal",k,"detalles")},H=k=>{a("edit",k)},Q=k=>{S.value=k,c.value=!0},P=()=>{S.value&&a("delete",S.value),c.value=!1,S.value=null},U=k=>{b.value=k,m.value="completado",f.value=!0},ne=(k,y)=>{b.value=k,m.value=y,f.value=!0},se=(k,y)=>{p.value?(b.value=k,m.value=y,f.value=!0):a("update-status",k,y,"",[])},fe=(k,y)=>{b.value&&(m.value==="completado"?a("complete",b.value,k,y):a("update-status",b.value,m.value,k,y),f.value=!1,b.value=null)};return(k,y)=>{var N,A;return u(),D("div",pl,[l(no,{modelValue:o(s),"onUpdate:modelValue":y[0]||(y[0]=x=>kn(s)?s.value=x:null),"confirm-on-drag":p.value,"onUpdate:confirmOnDrag":v},null,8,["modelValue","confirm-on-drag"]),o(s)==="list"?(u(),O(Io,{key:0,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onEdit:H,onDelete:Q,onComplete:U,onChangeStatus:ne,onShowComentarios:h,onShowActividad:T},null,8,["entregables","can-edit","can-delete","can-complete"])):o(s)==="tabs"?(u(),O(Mo,{key:1,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onEdit:H,onDelete:Q,onComplete:U,onChangeStatus:ne,onShowComentarios:h,onShowActividad:T},null,8,["entregables","can-edit","can-delete","can-complete"])):o(s)==="kanban"?(u(),O(gl,{key:2,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canComplete,"confirm-on-drag":p.value,onView:j,onEdit:H,onDelete:Q,onComplete:U,onChangeStatus:ne,onDragChangeStatus:se,onShowComentarios:h,onShowActividad:T},null,8,["entregables","can-edit","can-delete","can-complete","can-drag","confirm-on-drag"])):w("",!0),l(zn,{open:f.value,"onUpdate:open":y[1]||(y[1]=x=>f.value=x),"entregable-nombre":(N=b.value)==null?void 0:N.nombre,"estado-actual":(A=b.value)==null?void 0:A.estado,"nuevo-estado":m.value,loading:C.value,onConfirm:fe},null,8,["open","entregable-nombre","estado-actual","nuevo-estado","loading"]),l(o(Tn),{open:c.value,"onUpdate:open":y[2]||(y[2]=x=>c.value=x)},{default:r(()=>[l(o(Pn),null,{default:r(()=>[l(o(An),null,{default:r(()=>[l(o(On),null,{default:r(()=>[...y[3]||(y[3]=[_("¿Estás seguro?",-1)])]),_:1}),l(o(Mn),null,{default:r(()=>{var x;return[_(' Esta acción no se puede deshacer. Se eliminará permanentemente el entregable "'+E((x=S.value)==null?void 0:x.nombre)+'". ',1)]}),_:1})]),_:1}),l(o(Nn),null,{default:r(()=>[l(o(Rn),null,{default:r(()=>[...y[4]||(y[4]=[_("Cancelar",-1)])]),_:1}),l(o(Fn),{class:"bg-red-600 hover:bg-red-700",onClick:P},{default:r(()=>[...y[5]||(y[5]=[_(" Eliminar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])}}}),La={hito:null,estadisticas:null,actividades:[],usuariosActividades:[],usuariosEntregables:[],camposPersonalizados:[],valoresCamposPersonalizados:{},canEdit:!1,canDelete:!1,canManageEntregables:!1,canComplete:!1};function hl(e){const t=G({...La}),n=G(!1),a=G(null),i=async()=>{var d,p;if(!e.value){s();return}n.value=!0,a.value=null;try{const v=`/api/proyectos/hitos/${e.value}/detalles`,f=await Ga.get(v);t.value={hito:f.data.hito||null,estadisticas:f.data.estadisticas||null,actividades:f.data.actividades||[],usuariosActividades:f.data.usuariosActividades||[],usuariosEntregables:f.data.usuariosEntregables||[],camposPersonalizados:f.data.camposPersonalizados||[],valoresCamposPersonalizados:f.data.valoresCamposPersonalizados||{},canEdit:f.data.canEdit||!1,canDelete:f.data.canDelete||!1,canManageEntregables:f.data.canManageEntregables||!1,canComplete:f.data.canComplete||!1}}catch(v){console.error("Error al cargar detalles del hito:",v),a.value=((p=(d=v.response)==null?void 0:d.data)==null?void 0:p.message)||"Error al cargar detalles del hito",s()}finally{n.value=!1}},s=()=>{t.value={...La}};return{data:t,loading:n,error:a,cargar:i,reset:s}}const bl={class:"flex items-start justify-between gap-4"},yl={class:"flex-1 min-w-0"},xl={class:"flex items-center gap-2 flex-shrink-0"},_l={class:"flex flex-wrap gap-4 mt-3 text-sm text-muted-foreground"},wl={class:"flex items-center gap-1.5"},El={key:0,class:"flex items-center gap-1"},Cl={key:1,class:"flex items-center gap-1"},Dl={class:"flex-1 overflow-hidden min-h-0"},kl={key:0,class:"space-y-4"},Sl={key:0},$l={class:"text-sm whitespace-pre-wrap"},Il={class:"grid gap-4 md:grid-cols-2"},Tl={class:"flex items-center gap-1.5 text-sm"},Pl={key:1},Al={class:"grid grid-cols-2 sm:grid-cols-4 gap-2"},Ol={class:"bg-gray-50 rounded-lg p-2 text-center"},Ml={class:"text-lg font-semibold"},Nl={class:"bg-blue-50 rounded-lg p-2 text-center"},Rl={class:"text-lg font-semibold text-blue-700"},Fl={class:"bg-green-50 rounded-lg p-2 text-center"},zl={class:"text-lg font-semibold text-green-700"},Vl={class:"bg-red-50 rounded-lg p-2 text-center"},Bl={class:"text-lg font-semibold text-red-700"},Hl={class:"flex items-center gap-2"},Ul={class:"flex flex-wrap gap-2"},jl={key:0,class:"text-sm"},Ll={key:1,class:"mt-2"},Xl={class:"grid gap-3 md:grid-cols-2 text-sm"},Yl={class:"flex items-center justify-between w-full gap-2"},Gl={class:"flex gap-2"},Wl=Me({__name:"HitoDetallesModal",props:{open:{type:Boolean},hitoId:{},proyectoId:{},initialTab:{default:"detalles"},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageEntregables:{type:Boolean,default:!1}},emits:["update:open","update:tab","edit-hito","view-entregable","edit-entregable","add-entregable","refresh"],setup(e,{emit:t}){const n=e,a=t,i=ot(n,"hitoId"),{data:s,loading:d,error:p,cargar:v}=hl(i),f=["detalles","entregables","comentarios","actividad"],b=G(f.includes(n.initialTab)?n.initialTab:"detalles"),m=G({search:null,estado:null,prioridad:null,responsable_id:null,fecha_inicio:null,fecha_fin:null}),C=G({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null});we(()=>n.open,async k=>{k&&n.hitoId&&(await v(),b.value=f.includes(n.initialTab)?n.initialTab:"detalles")},{immediate:!0}),we(()=>n.initialTab,k=>{n.open&&k&&f.includes(k)&&(b.value=k)}),we(b,k=>{a("update:tab",k)});const c=q(()=>s.value.hito),S=q(()=>s.value.estadisticas),h=q(()=>{var y;let k=((y=c.value)==null?void 0:y.entregables)||[];if(m.value.search){const N=m.value.search.toLowerCase();k=k.filter(A=>A.nombre.toLowerCase().includes(N)||A.descripcion&&A.descripcion.toLowerCase().includes(N))}return m.value.estado&&(k=k.filter(N=>N.estado===m.value.estado)),m.value.prioridad&&(k=k.filter(N=>N.prioridad===m.value.prioridad)),m.value.responsable_id&&(k=k.filter(N=>{var A;return((A=N.responsable)==null?void 0:A.id)===m.value.responsable_id})),k}),T=q(()=>{let k=s.value.actividades||[];return C.value.usuario_id&&(k=k.filter(y=>{var N;return((N=y.causer)==null?void 0:N.id)===C.value.usuario_id})),C.value.tipo_entidad&&(k=k.filter(y=>y.subject_type===C.value.tipo_entidad)),C.value.tipo_accion&&(k=k.filter(y=>y.event===C.value.tipo_accion)),(C.value.fecha_inicio||C.value.fecha_fin)&&(k=k.filter(y=>{const N=new Date(y.created_at);if(C.value.fecha_inicio){const A=new Date(C.value.fecha_inicio);if(N<A)return!1}if(C.value.fecha_fin){const A=new Date(C.value.fecha_fin);if(A.setHours(23,59,59,999),N>A)return!1}return!0})),k}),j=k=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[k]||"bg-gray-100 text-gray-800",H=k=>k?Xe(Lt(k),"dd MMM yyyy",{locale:Ye}):"No definida",Q=k=>k?Xe(Lt(k),"dd MMM yyyy 'a las' HH:mm",{locale:Ye}):"No definida",P=q(()=>!n.proyectoId||!n.hitoId?null:`/admin/proyectos/${n.proyectoId}/hitos/${n.hitoId}`),U=()=>{a("update:open",!1)},ne=async()=>{await v(),a("refresh")},se=k=>{a("view-entregable",k)},fe=k=>{a("edit-entregable",k)};return(k,y)=>(u(),O(o(en),{open:e.open,"onUpdate:open":y[5]||(y[5]=N=>a("update:open",N))},{default:r(()=>[l(o(tn),{class:"max-w-4xl max-h-[85vh] flex flex-col p-0 gap-0"},{default:r(()=>[l(o(an),{class:"flex-shrink-0 px-6 pt-6 pb-4 border-b"},{default:r(()=>{var N;return[o(d)&&!c.value?(u(),D(K,{key:0},[l(o(Be),{class:"h-7 w-3/4 mb-2"}),l(o(Be),{class:"h-4 w-1/2"})],64)):o(p)?(u(),D(K,{key:1},[l(o(Ht),{class:"text-destructive"},{default:r(()=>[...y[6]||(y[6]=[_("Error al cargar",-1)])]),_:1}),l(o(Ut),null,{default:r(()=>[_(E(o(p)),1)]),_:1})],64)):c.value?(u(),D(K,{key:2},[g("div",bl,[g("div",yl,[l(o(Ht),{class:"text-xl truncate flex items-center gap-2"},{default:r(()=>[l(o(fa),{class:"h-5 w-5 flex-shrink-0"}),_(" "+E(c.value.nombre),1)]),_:1}),l(o(Ut),{class:"mt-1"},{default:r(()=>{var A;return[_(" Proyecto: "+E((A=c.value.proyecto)==null?void 0:A.nombre),1)]}),_:1})]),g("div",xl,[l(o(ae),{class:J(j(c.value.estado))},{default:r(()=>[_(E(c.value.estado_label||c.value.estado),1)]),_:1},8,["class"]),l(o(W),{variant:"ghost",size:"sm",onClick:ne,disabled:o(d),title:"Actualizar"},{default:r(()=>[l(o(un),{class:J(["h-4 w-4",{"animate-spin":o(d)}])},null,8,["class"])]),_:1},8,["disabled"])])]),g("div",_l,[g("div",wl,[l(o(Vt),{"model-value":c.value.porcentaje_completado,class:"w-20 h-2"},null,8,["model-value"]),g("span",null,E(c.value.porcentaje_completado)+"%",1)]),c.value.fecha_fin?(u(),D("div",El,[l(o(Pe),{class:"h-4 w-4"}),g("span",{class:J({"text-red-600":(N=S.value)==null?void 0:N.esta_vencido})},E(H(c.value.fecha_fin)),3)])):w("",!0),c.value.responsable?(u(),D("div",Cl,[l(o(Je),{class:"h-4 w-4"}),g("span",null,E(c.value.responsable.name),1)])):w("",!0)])],64)):w("",!0)]}),_:1}),g("div",Dl,[l(o(ba),{modelValue:b.value,"onUpdate:modelValue":y[3]||(y[3]=N=>b.value=N),class:"h-full flex flex-col"},{default:r(()=>[l(o(ya),{class:"flex-shrink-0 mx-6 mt-4 justify-start"},{default:r(()=>[l(o(Ie),{value:"detalles"},{default:r(()=>[l(o(Bt),{class:"h-4 w-4 mr-1.5"}),y[7]||(y[7]=_(" Detalles ",-1))]),_:1}),l(o(Ie),{value:"entregables"},{default:r(()=>{var N;return[l(o(ut),{class:"h-4 w-4 mr-1.5"}),y[8]||(y[8]=_(" Entregables ",-1)),(N=S.value)!=null&&N.total_entregables?(u(),O(o(ae),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(E(S.value.total_entregables),1)]),_:1})):w("",!0)]}),_:1}),l(o(Ie),{value:"comentarios"},{default:r(()=>{var N;return[l(o(yt),{class:"h-4 w-4 mr-1.5"}),y[9]||(y[9]=_(" Comentarios ",-1)),(N=c.value)!=null&&N.total_comentarios?(u(),O(o(ae),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(E(c.value.total_comentarios),1)]),_:1})):w("",!0)]}),_:1}),l(o(Ie),{value:"actividad"},{default:r(()=>[l(o(xt),{class:"h-4 w-4 mr-1.5"}),y[10]||(y[10]=_(" Actividad ",-1))]),_:1})]),_:1}),l(o(ht),{class:"flex-1 px-6 py-4"},{default:r(()=>[o(d)&&!c.value?(u(),D("div",kl,[l(o(Be),{class:"h-32 w-full"}),l(o(Be),{class:"h-32 w-full"})])):w("",!0),l(o(Te),{value:"detalles",class:"mt-0 space-y-4"},{default:r(()=>[c.value?(u(),D(K,{key:0},[l(o(pe),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...y[11]||(y[11]=[_("Información General",-1)])]),_:1})]),_:1}),l(o(ve),{class:"space-y-4"},{default:r(()=>{var N;return[c.value.descripcion?(u(),D("div",Sl,[y[12]||(y[12]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Descripción",-1)),g("p",$l,E(c.value.descripcion),1)])):w("",!0),g("div",Il,[g("div",null,[y[13]||(y[13]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Inicio",-1)),g("div",Tl,[l(o(Ge),{class:"h-4 w-4"}),_(" "+E(H(c.value.fecha_inicio)),1)])]),g("div",null,[y[14]||(y[14]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Fin",-1)),g("div",{class:J(["flex items-center gap-1.5 text-sm",{"text-red-600":(N=S.value)==null?void 0:N.esta_vencido}])},[l(o(Ge),{class:"h-4 w-4"}),_(" "+E(H(c.value.fecha_fin)),1)],2)])]),S.value?(u(),D("div",Pl,[y[19]||(y[19]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-2"},"Resumen de Entregables",-1)),g("div",Al,[g("div",Ol,[g("div",Ml,E(S.value.entregables_pendientes),1),y[15]||(y[15]=g("div",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),g("div",Nl,[g("div",Rl,E(S.value.entregables_en_progreso),1),y[16]||(y[16]=g("div",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),g("div",Fl,[g("div",zl,E(S.value.entregables_completados),1),y[17]||(y[17]=g("div",{class:"text-xs text-muted-foreground"},"Completados",-1))]),g("div",Vl,[g("div",Bl,E(S.value.entregables_cancelados),1),y[18]||(y[18]=g("div",{class:"text-xs text-muted-foreground"},"Cancelados",-1))])])])):w("",!0)]}),_:1})]),_:1}),c.value.etiquetas&&c.value.etiquetas.length>0?(u(),O(o(pe),{key:0},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[g("div",Hl,[l(o(dn),{class:"h-4 w-4"}),l(o($e),{class:"text-base"},{default:r(()=>[...y[20]||(y[20]=[_("Etiquetas",-1)])]),_:1})])]),_:1}),l(o(ve),null,{default:r(()=>[g("div",Ul,[(u(!0),D(K,null,ce(c.value.etiquetas,N=>(u(),O(o(ae),{key:N.id,variant:"outline",class:"px-2.5 py-1",style:Wa({borderColor:N.color||"#94a3b8",color:N.color||"#64748b",backgroundColor:`${N.color}15`||"#f1f5f9"})},{default:r(()=>[_(E(N.nombre),1)]),_:2},1032,["style"]))),128))])]),_:1})]),_:1})):w("",!0),o(s).camposPersonalizados&&o(s).camposPersonalizados.length>0?(u(),O(sn,{key:1,campos:o(s).camposPersonalizados,"valores-campos":o(s).valoresCamposPersonalizados,descripcion:"Información adicional del hito",columns:2},null,8,["campos","valores-campos"])):w("",!0),c.value.parent||c.value.ruta_completa?(u(),O(o(pe),{key:2},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...y[21]||(y[21]=[_("Jerarquía",-1)])]),_:1})]),_:1}),l(o(ve),null,{default:r(()=>[c.value.ruta_completa?(u(),D("div",jl,[y[22]||(y[22]=g("span",{class:"text-muted-foreground"},"Ruta: ",-1)),_(" "+E(c.value.ruta_completa),1)])):w("",!0),c.value.nivel!==void 0?(u(),D("div",Ll,[l(o(ae),{variant:"outline"},{default:r(()=>[_("Nivel "+E(c.value.nivel),1)]),_:1})])):w("",!0)]),_:1})]),_:1})):w("",!0),l(o(pe),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...y[23]||(y[23]=[_("Información del Sistema",-1)])]),_:1})]),_:1}),l(o(ve),null,{default:r(()=>[g("div",Xl,[g("div",null,[y[24]||(y[24]=g("span",{class:"text-muted-foreground"},"Creado: ",-1)),_(" "+E(Q(c.value.created_at)),1)]),g("div",null,[y[25]||(y[25]=g("span",{class:"text-muted-foreground"},"Actualizado: ",-1)),_(" "+E(Q(c.value.updated_at)),1)])])]),_:1})]),_:1})],64)):w("",!0)]),_:1}),l(o(Te),{value:"entregables",class:"mt-0 space-y-4"},{default:r(()=>[c.value?(u(),D(K,{key:0},[c.value.entregables&&c.value.entregables.length>0?(u(),O(Vn,{key:0,modelValue:m.value,"onUpdate:modelValue":y[0]||(y[0]=N=>m.value=N),usuarios:o(s).usuariosEntregables},null,8,["modelValue","usuarios"])):w("",!0),c.value.entregables&&c.value.entregables.length>0?(u(),O(o(pe),{key:1},{default:r(()=>[l(o(ve),{class:"p-0"},{default:r(()=>[l(Bn,{entregables:h.value,"proyecto-id":e.proyectoId,"hito-id":e.hitoId,"can-edit":e.canManageEntregables||o(s).canManageEntregables,"can-delete":e.canManageEntregables||o(s).canManageEntregables,"can-complete":o(s).canComplete,"show-checkbox":!1,onView:se,onEdit:fe},null,8,["entregables","proyecto-id","hito-id","can-edit","can-delete","can-complete"])]),_:1})]),_:1})):(u(),O(o(pe),{key:2},{default:r(()=>[l(o(ve),{class:"text-center py-8"},{default:r(()=>[l(o(ut),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),y[27]||(y[27]=g("p",{class:"text-muted-foreground mb-4"},"No hay entregables en este hito",-1)),e.canManageEntregables||o(s).canManageEntregables?(u(),O(o(W),{key:0,variant:"outline",onClick:y[1]||(y[1]=N=>a("add-entregable"))},{default:r(()=>[...y[26]||(y[26]=[_(" Crear Entregable ",-1)])]),_:1})):w("",!0)]),_:1})]),_:1}))],64)):w("",!0)]),_:1}),l(o(Te),{value:"comentarios",class:"mt-0"},{default:r(()=>[e.hitoId?(u(),O(rn,{key:0,"commentable-type":"hitos","commentable-id":e.hitoId,"can-create":e.canEdit||o(s).canEdit,embedded:""},null,8,["commentable-id","can-create"])):w("",!0)]),_:1}),l(o(Te),{value:"actividad",class:"mt-0 space-y-4"},{default:r(()=>[o(s).actividades&&o(s).actividades.length>0?(u(),O(on,{key:0,modelValue:C.value,"onUpdate:modelValue":y[2]||(y[2]=N=>C.value=N),usuarios:o(s).usuariosActividades,"context-level":"hito"},null,8,["modelValue","usuarios"])):w("",!0),l(ln,{activities:T.value,title:"Historial de Actividad",description:"Registro de cambios del hito y sus entregables","empty-message":"No hay actividad registrada","show-card":!1},null,8,["activities"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l(o(nn),{class:"flex-shrink-0 px-6 py-4 border-t bg-muted/30"},{default:r(()=>[g("div",Yl,[g("div",Gl,[P.value?(u(),O(o(zt),{key:0,href:P.value},{default:r(()=>[l(o(W),{variant:"outline",size:"sm"},{default:r(()=>[l(o(jt),{class:"h-4 w-4 mr-1.5"}),y[28]||(y[28]=_(" Abrir página completa ",-1))]),_:1})]),_:1},8,["href"])):w("",!0),(e.canEdit||o(s).canEdit)&&c.value?(u(),O(o(W),{key:1,variant:"outline",size:"sm",onClick:y[4]||(y[4]=N=>a("edit-hito"))},{default:r(()=>[l(o(bt),{class:"h-4 w-4 mr-1.5"}),y[29]||(y[29]=_(" Editar ",-1))]),_:1})):w("",!0)]),l(o(W),{variant:"ghost",size:"sm",onClick:U},{default:r(()=>[...y[30]||(y[30]=[_(" Cerrar ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["open"]))}}),Xa={entregable:null,proyecto:null,hito:null,usuariosAsignados:[],actividades:[],usuariosActividades:[],camposPersonalizados:[],valoresCamposPersonalizados:{},contratosRelacionados:[],canEdit:!1,canDelete:!1,canComplete:!1};function ql(e){const t=G({...Xa}),n=G(!1),a=G(null),i=async()=>{var d,p;if(!e.value){s();return}n.value=!0,a.value=null;try{const v=`/api/proyectos/entregables/${e.value}/detalles`,f=await Ga.get(v);t.value={entregable:f.data.entregable||null,proyecto:f.data.proyecto||null,hito:f.data.hito||null,usuariosAsignados:f.data.usuariosAsignados||[],actividades:f.data.actividades||[],usuariosActividades:f.data.usuariosActividades||[],camposPersonalizados:f.data.camposPersonalizados||[],valoresCamposPersonalizados:f.data.valoresCamposPersonalizados||{},contratosRelacionados:f.data.contratosRelacionados||[],canEdit:f.data.canEdit||!1,canDelete:f.data.canDelete||!1,canComplete:f.data.canComplete||!1}}catch(v){console.error("Error al cargar detalles del entregable:",v),a.value=((p=(d=v.response)==null?void 0:d.data)==null?void 0:p.message)||"Error al cargar detalles del entregable",s()}finally{n.value=!1}},s=()=>{t.value={...Xa}};return{data:t,loading:n,error:a,cargar:i,reset:s}}const Kl={class:"flex items-start justify-between gap-4"},Ql={class:"flex-1 min-w-0"},Jl={class:"flex items-center gap-2 flex-shrink-0"},Zl={class:"flex flex-wrap gap-4 mt-3 text-sm text-muted-foreground"},es={class:"flex items-center gap-1.5"},ts={class:"capitalize"},as={class:"flex items-center gap-1.5"},ns={key:1,class:"flex items-center gap-1"},os={class:"flex-1 overflow-hidden min-h-0"},ls={key:0,class:"space-y-4"},ss={key:0},is={class:"text-sm whitespace-pre-wrap"},rs={class:"grid gap-4 md:grid-cols-2"},ds={class:"flex items-center gap-1.5 text-sm"},us={key:1},cs={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-3"},fs={class:"flex items-center gap-2 text-green-700 mb-2"},ms={class:"text-sm text-green-600 space-y-1"},gs={key:0},ps={key:1},vs={key:2,class:"italic mt-2"},hs={class:"flex items-center gap-2"},bs={class:"flex flex-wrap gap-2"},ys={class:"grid gap-3 md:grid-cols-2 text-sm"},xs={key:0,class:"flex items-center gap-3"},_s={class:"font-medium"},ws={class:"text-sm text-muted-foreground"},Es={key:1,class:"text-muted-foreground"},Cs={key:0,class:"space-y-2"},Ds={class:"flex items-center gap-3"},ks={class:"font-medium text-sm"},Ss={class:"text-xs text-muted-foreground"},$s={key:1,class:"text-muted-foreground"},Is={class:"flex items-center justify-between w-full gap-2"},Ts={class:"flex gap-2"},Ps=Me({__name:"EntregableDetallesModal",props:{open:{type:Boolean},entregableId:{},proyectoId:{},hitoId:{},initialTab:{default:"detalles"},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1}},emits:["update:open","update:tab","edit-entregable","refresh"],setup(e,{emit:t}){const n=e,a=t,i=ot(n,"entregableId"),{data:s,loading:d,error:p,cargar:v}=ql(i),f=["detalles","equipo","evidencias","comentarios","actividad"],b=G(f.includes(n.initialTab)?n.initialTab:"detalles"),m=G({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null}),C=G({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null});we(()=>n.open,async A=>{A&&n.entregableId&&(await v(),b.value=f.includes(n.initialTab)?n.initialTab:"detalles")},{immediate:!0}),we(()=>n.initialTab,A=>{n.open&&A&&f.includes(A)&&(b.value=A)}),we(b,A=>{a("update:tab",A)});const c=q(()=>s.value.entregable),S=q(()=>s.value.proyecto),h=q(()=>s.value.hito),T=q(()=>{var A;return(A=c.value)!=null&&A.fecha_fin?Kn(new Date(c.value.fecha_fin),new Date):null}),j=q(()=>!c.value||c.value.estado==="completado"||c.value.estado==="cancelado"?!1:T.value!==null&&T.value<0),H=q(()=>{var x;let A=((x=c.value)==null?void 0:x.evidencias)||[];return m.value.contrato_id&&(A=A.filter(M=>{var Y;return((Y=M.obligacion)==null?void 0:Y.contrato_id)===m.value.contrato_id})),m.value.tipo&&(A=A.filter(M=>M.tipo_evidencia===m.value.tipo)),m.value.estado&&(A=A.filter(M=>M.estado===m.value.estado)),m.value.usuario_id&&(A=A.filter(M=>{var Y;return((Y=M.usuario)==null?void 0:Y.id)===m.value.usuario_id})),A}),Q=q(()=>{const A={};return H.value.forEach(x=>{var M;if((M=x.obligacion)!=null&&M.contrato){const Y=x.obligacion.contrato.id;A[Y]||(A[Y]={contrato:x.obligacion.contrato,evidencias:[]}),A[Y].evidencias.push({...x,obligacion_titulo:x.obligacion.titulo})}}),Object.values(A)}),P=q(()=>{let A=s.value.actividades||[];return C.value.usuario_id&&(A=A.filter(x=>{var M;return((M=x.causer)==null?void 0:M.id)===C.value.usuario_id})),C.value.tipo_accion&&(A=A.filter(x=>x.event===C.value.tipo_accion)),(C.value.fecha_inicio||C.value.fecha_fin)&&(A=A.filter(x=>{const M=new Date(x.created_at);if(C.value.fecha_inicio){const Y=new Date(C.value.fecha_inicio);if(M<Y)return!1}if(C.value.fecha_fin){const Y=new Date(C.value.fecha_fin);if(Y.setHours(23,59,59,999),M>Y)return!1}return!0})),A}),U=A=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[A]||"bg-gray-100 text-gray-800",ne=A=>({baja:"text-gray-500",media:"text-yellow-500",alta:"text-red-500"})[A]||"",se=A=>A?Xe(Lt(A),"dd MMM yyyy",{locale:Ye}):"No definida",fe=A=>A?Xe(Lt(A),"dd MMM yyyy 'a las' HH:mm",{locale:Ye}):"No definida",k=q(()=>{var M,Y;const A=n.proyectoId||((M=S.value)==null?void 0:M.id),x=n.hitoId||((Y=h.value)==null?void 0:Y.id);return!A||!x||!n.entregableId?null:`/admin/proyectos/${A}/hitos/${x}/entregables/${n.entregableId}`}),y=()=>{a("update:open",!1)},N=async()=>{await v(),a("refresh")};return(A,x)=>(u(),O(o(en),{open:e.open,"onUpdate:open":x[4]||(x[4]=M=>a("update:open",M))},{default:r(()=>[l(o(tn),{class:"max-w-4xl max-h-[85vh] flex flex-col p-0 gap-0"},{default:r(()=>[l(o(an),{class:"flex-shrink-0 px-6 pt-6 pb-4 border-b"},{default:r(()=>[o(d)&&!c.value?(u(),D(K,{key:0},[l(o(Be),{class:"h-7 w-3/4 mb-2"}),l(o(Be),{class:"h-4 w-1/2"})],64)):o(p)?(u(),D(K,{key:1},[l(o(Ht),{class:"text-destructive"},{default:r(()=>[...x[5]||(x[5]=[_("Error al cargar",-1)])]),_:1}),l(o(Ut),null,{default:r(()=>[_(E(o(p)),1)]),_:1})],64)):c.value?(u(),D(K,{key:2},[g("div",Kl,[g("div",Ql,[l(o(Ht),{class:"text-xl truncate flex items-center gap-2"},{default:r(()=>[l(o(Bt),{class:"h-5 w-5 flex-shrink-0"}),_(" "+E(c.value.nombre),1)]),_:1}),l(o(Ut),{class:"mt-1"},{default:r(()=>{var M,Y;return[_(" Hito: "+E((M=h.value)==null?void 0:M.nombre)+" · Proyecto: "+E((Y=S.value)==null?void 0:Y.nombre),1)]}),_:1})]),g("div",Jl,[l(o(ae),{class:J(U(c.value.estado))},{default:r(()=>[_(E(c.value.estado_label||c.value.estado),1)]),_:1},8,["class"]),l(o(W),{variant:"ghost",size:"sm",onClick:N,disabled:o(d),title:"Actualizar"},{default:r(()=>[l(o(un),{class:J(["h-4 w-4",{"animate-spin":o(d)}])},null,8,["class"])]),_:1},8,["disabled"])])]),g("div",Zl,[g("div",es,[l(o(Qa),{class:J(["h-4 w-4",ne(c.value.prioridad)])},null,8,["class"]),g("span",ts,E(c.value.prioridad),1)]),g("div",as,[l(o(Vt),{"model-value":c.value.porcentaje_completado||0,class:"w-16 h-2"},null,8,["model-value"]),g("span",null,E(c.value.porcentaje_completado||0)+"%",1)]),T.value!==null?(u(),D("div",{key:0,class:J(["flex items-center gap-1",{"text-red-600":j.value}])},[l(o(Pe),{class:"h-4 w-4"}),g("span",null,E(j.value?`Vencido hace ${Math.abs(T.value)} días`:T.value===0?"Vence hoy":`${T.value} días`),1)],2)):w("",!0),c.value.responsable?(u(),D("div",ns,[l(o(Je),{class:"h-4 w-4"}),g("span",null,E(c.value.responsable.name),1)])):w("",!0)])],64)):w("",!0)]),_:1}),g("div",os,[l(o(ba),{modelValue:b.value,"onUpdate:modelValue":x[2]||(x[2]=M=>b.value=M),class:"h-full flex flex-col"},{default:r(()=>[l(o(ya),{class:"flex-shrink-0 mx-6 mt-4 justify-start flex-wrap"},{default:r(()=>[l(o(Ie),{value:"detalles"},{default:r(()=>[l(o(Bt),{class:"h-4 w-4 mr-1.5"}),x[6]||(x[6]=_(" Detalles ",-1))]),_:1}),l(o(Ie),{value:"equipo"},{default:r(()=>[l(o(Ja),{class:"h-4 w-4 mr-1.5"}),x[7]||(x[7]=_(" Equipo ",-1))]),_:1}),l(o(Ie),{value:"evidencias"},{default:r(()=>{var M,Y;return[l(o(Aa),{class:"h-4 w-4 mr-1.5"}),x[8]||(x[8]=_(" Evidencias ",-1)),(Y=(M=c.value)==null?void 0:M.evidencias)!=null&&Y.length?(u(),O(o(ae),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(E(c.value.evidencias.length),1)]),_:1})):w("",!0)]}),_:1}),l(o(Ie),{value:"comentarios"},{default:r(()=>{var M;return[l(o(yt),{class:"h-4 w-4 mr-1.5"}),x[9]||(x[9]=_(" Comentarios ",-1)),(M=c.value)!=null&&M.total_comentarios?(u(),O(o(ae),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(E(c.value.total_comentarios),1)]),_:1})):w("",!0)]}),_:1}),l(o(Ie),{value:"actividad"},{default:r(()=>[l(o(xt),{class:"h-4 w-4 mr-1.5"}),x[10]||(x[10]=_(" Actividad ",-1))]),_:1})]),_:1}),l(o(ht),{class:"flex-1 px-6 py-4"},{default:r(()=>[o(d)&&!c.value?(u(),D("div",ls,[l(o(Be),{class:"h-32 w-full"}),l(o(Be),{class:"h-32 w-full"})])):w("",!0),l(o(Te),{value:"detalles",class:"mt-0 space-y-4"},{default:r(()=>[c.value?(u(),D(K,{key:0},[l(o(pe),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...x[11]||(x[11]=[_("Información General",-1)])]),_:1})]),_:1}),l(o(ve),{class:"space-y-4"},{default:r(()=>[c.value.descripcion?(u(),D("div",ss,[x[12]||(x[12]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Descripción",-1)),g("p",is,E(c.value.descripcion),1)])):w("",!0),g("div",rs,[g("div",null,[x[13]||(x[13]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Inicio",-1)),g("div",ds,[l(o(Ge),{class:"h-4 w-4"}),_(" "+E(se(c.value.fecha_inicio)),1)])]),g("div",null,[x[14]||(x[14]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Fin",-1)),g("div",{class:J(["flex items-center gap-1.5 text-sm",{"text-red-600":j.value}])},[l(o(Ge),{class:"h-4 w-4"}),_(" "+E(se(c.value.fecha_fin)),1)],2)])]),c.value.notas?(u(),D("div",us,[x[15]||(x[15]=g("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Notas",-1)),l(o(Wn),null,{default:r(()=>[l(o(tt),{class:"h-4 w-4"}),l(o(qn),null,{default:r(()=>[_(E(c.value.notas),1)]),_:1})]),_:1})])):w("",!0),c.value.estado==="completado"?(u(),D("div",cs,[g("div",fs,[l(o(at),{class:"h-5 w-5"}),x[16]||(x[16]=g("span",{class:"font-medium"},"Completado",-1))]),g("div",ms,[c.value.completado_at?(u(),D("div",gs," Fecha: "+E(fe(c.value.completado_at)),1)):w("",!0),c.value.completado_por_usuario?(u(),D("div",ps," Por: "+E(c.value.completado_por_usuario.name),1)):w("",!0),c.value.observaciones_estado?(u(),D("div",vs,' "'+E(c.value.observaciones_estado)+'" ',1)):w("",!0)])])):w("",!0)]),_:1})]),_:1}),c.value.etiquetas&&c.value.etiquetas.length>0?(u(),O(o(pe),{key:0},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[g("div",hs,[l(o(dn),{class:"h-4 w-4"}),l(o($e),{class:"text-base"},{default:r(()=>[...x[17]||(x[17]=[_("Etiquetas",-1)])]),_:1})])]),_:1}),l(o(ve),null,{default:r(()=>[g("div",bs,[(u(!0),D(K,null,ce(c.value.etiquetas,M=>(u(),O(o(ae),{key:M.id,variant:"outline",class:"px-2.5 py-1",style:Wa({borderColor:M.color||"#94a3b8",color:M.color||"#64748b",backgroundColor:`${M.color}15`||"#f1f5f9"})},{default:r(()=>[_(E(M.nombre),1)]),_:2},1032,["style"]))),128))])]),_:1})]),_:1})):w("",!0),o(s).camposPersonalizados&&o(s).camposPersonalizados.length>0?(u(),O(sn,{key:1,campos:o(s).camposPersonalizados,"valores-campos":o(s).valoresCamposPersonalizados,descripcion:"Información adicional del entregable",columns:2},null,8,["campos","valores-campos"])):w("",!0),l(o(pe),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...x[18]||(x[18]=[_("Información del Sistema",-1)])]),_:1})]),_:1}),l(o(ve),null,{default:r(()=>[g("div",ys,[g("div",null,[x[19]||(x[19]=g("span",{class:"text-muted-foreground"},"Creado: ",-1)),_(" "+E(fe(c.value.created_at)),1)]),g("div",null,[x[20]||(x[20]=g("span",{class:"text-muted-foreground"},"Actualizado: ",-1)),_(" "+E(fe(c.value.updated_at)),1)]),g("div",null,[x[21]||(x[21]=g("span",{class:"text-muted-foreground"},"Orden: ",-1)),_(" "+E(c.value.orden),1)])])]),_:1})]),_:1})],64)):w("",!0)]),_:1}),l(o(Te),{value:"equipo",class:"mt-0 space-y-4"},{default:r(()=>[c.value?(u(),D(K,{key:0},[l(o(pe),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...x[22]||(x[22]=[_("Responsable Principal",-1)])]),_:1})]),_:1}),l(o(ve),null,{default:r(()=>[c.value.responsable?(u(),D("div",xs,[l(o(Ia),{class:"h-10 w-10"},{default:r(()=>[c.value.responsable.avatar?(u(),O(o(Ta),{key:0,src:c.value.responsable.avatar},null,8,["src"])):w("",!0),l(o(Pa),null,{default:r(()=>[_(E(c.value.responsable.name.substring(0,2).toUpperCase()),1)]),_:1})]),_:1}),g("div",null,[g("p",_s,E(c.value.responsable.name),1),g("p",ws,E(c.value.responsable.email),1)])])):(u(),D("p",Es,"No hay responsable asignado"))]),_:1})]),_:1}),l(o(pe),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...x[23]||(x[23]=[_("Colaboradores",-1)])]),_:1}),l(o(Gn),null,{default:r(()=>{var M;return[_(E(((M=o(s).usuariosAsignados)==null?void 0:M.length)||0)+" usuarios asignados",1)]}),_:1})]),_:1}),l(o(ve),null,{default:r(()=>[o(s).usuariosAsignados&&o(s).usuariosAsignados.length>0?(u(),D("div",Cs,[(u(!0),D(K,null,ce(o(s).usuariosAsignados,M=>(u(),D("div",{key:M.user_id,class:"flex items-center justify-between p-3 bg-muted rounded-lg"},[g("div",Ds,[l(o(Ia),{class:"h-8 w-8"},{default:r(()=>[M.user.avatar?(u(),O(o(Ta),{key:0,src:M.user.avatar},null,8,["src"])):w("",!0),l(o(Pa),null,{default:r(()=>[_(E(M.user.name.substring(0,2).toUpperCase()),1)]),_:2},1024)]),_:2},1024),g("div",null,[g("p",ks,E(M.user.name),1),g("p",Ss,E(M.user.email),1)])]),l(o(ae),{variant:"outline",class:"capitalize"},{default:r(()=>[_(E(M.rol),1)]),_:2},1024)]))),128))])):(u(),D("p",$s,"No hay colaboradores asignados"))]),_:1})]),_:1})],64)):w("",!0)]),_:1}),l(o(Te),{value:"evidencias",class:"mt-0 space-y-4"},{default:r(()=>[c.value?(u(),D(K,{key:0},[c.value.evidencias&&c.value.evidencias.length>0?(u(),O(Xn,{key:0,modelValue:m.value,"onUpdate:modelValue":x[0]||(x[0]=M=>m.value=M),contratos:o(s).contratosRelacionados,evidencias:c.value.evidencias},null,8,["modelValue","contratos","evidencias"])):w("",!0),c.value.evidencias&&c.value.evidencias.length>0?(u(),O(Yn,{key:1,mode:"grouped","evidencias-agrupadas":Q.value,"format-date":se},null,8,["evidencias-agrupadas"])):(u(),O(o(pe),{key:2},{default:r(()=>[l(o(ve),{class:"text-center py-8"},{default:r(()=>[l(o(Aa),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),x[24]||(x[24]=g("p",{class:"text-muted-foreground"},"No hay evidencias asociadas a este entregable",-1))]),_:1})]),_:1}))],64)):w("",!0)]),_:1}),l(o(Te),{value:"comentarios",class:"mt-0"},{default:r(()=>[e.entregableId?(u(),O(rn,{key:0,"commentable-type":"entregables","commentable-id":e.entregableId,"can-create":e.canEdit||o(s).canEdit,embedded:""},null,8,["commentable-id","can-create"])):w("",!0)]),_:1}),l(o(Te),{value:"actividad",class:"mt-0 space-y-4"},{default:r(()=>[o(s).actividades&&o(s).actividades.length>0?(u(),O(on,{key:0,modelValue:C.value,"onUpdate:modelValue":x[1]||(x[1]=M=>C.value=M),usuarios:o(s).usuariosActividades,"context-level":"entregable"},null,8,["modelValue","usuarios"])):w("",!0),l(ln,{activities:P.value,title:"Historial de Actividad",description:"Registro de cambios del entregable","empty-message":"No hay actividad registrada","show-card":!1},null,8,["activities"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l(o(nn),{class:"flex-shrink-0 px-6 py-4 border-t bg-muted/30"},{default:r(()=>[g("div",Is,[g("div",Ts,[k.value?(u(),O(o(zt),{key:0,href:k.value},{default:r(()=>[l(o(W),{variant:"outline",size:"sm"},{default:r(()=>[l(o(jt),{class:"h-4 w-4 mr-1.5"}),x[25]||(x[25]=_(" Abrir página completa ",-1))]),_:1})]),_:1},8,["href"])):w("",!0),(e.canEdit||o(s).canEdit)&&c.value?(u(),O(o(W),{key:1,variant:"outline",size:"sm",onClick:x[3]||(x[3]=M=>a("edit-entregable"))},{default:r(()=>[l(o(bt),{class:"h-4 w-4 mr-1.5"}),x[26]||(x[26]=_(" Editar ",-1))]),_:1})):w("",!0)]),l(o(W),{variant:"ghost",size:"sm",onClick:y},{default:r(()=>[...x[27]||(x[27]=[_(" Cerrar ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["open"]))}}),As={class:"flex flex-col md:flex-row h-full min-h-[500px] border rounded-lg overflow-hidden bg-background"},Os={class:"hidden md:flex md:w-72 lg:w-80 flex-col border-r bg-muted/30"},Ms={class:"p-4 border-b bg-background"},Ns={class:"flex items-center justify-between"},Rs={class:"font-semibold text-sm text-muted-foreground uppercase tracking-wide flex items-center gap-2"},Fs={key:0,class:"mt-3"},zs={class:"p-2 space-y-1"},Vs={key:0,class:"p-4 text-center text-muted-foreground text-sm"},Bs=["data-active","onClick"],Hs={class:"flex items-center gap-2"},Us={class:"font-medium truncate flex-1"},js={key:0,class:"mt-1 ml-4 text-xs text-muted-foreground truncate"},Ls={class:"flex items-center gap-2 mt-2 ml-4 text-xs text-muted-foreground"},Xs={class:"mt-2 ml-4"},Ys={class:"flex-1 flex flex-col min-h-0 min-w-0"},Gs={class:"md:hidden p-4 border-b bg-background sticky top-0 z-10 space-y-3"},Ws={class:"flex items-center gap-2"},qs={class:"flex flex-col"},Ks={key:0,class:"text-xs text-muted-foreground"},Qs={class:"text-muted-foreground"},Js={key:0,class:"flex items-center justify-center h-full min-h-[400px]"},Zs={class:"text-center space-y-3 max-w-sm p-6"},ei={key:1,class:"p-4 md:p-6 space-y-6 overflow-x-hidden"},ti={class:"flex items-start justify-between gap-4"},ai={class:"flex-1 min-w-0"},ni={class:"flex items-center gap-2 mb-1"},oi={key:0,class:"flex items-center gap-1.5 text-sm text-muted-foreground mt-1"},li={key:1,class:"text-sm text-muted-foreground mt-2"},si={class:"space-y-2"},ii={class:"flex justify-between items-center text-sm"},ri={class:"font-medium"},di={class:"flex flex-wrap gap-4 text-sm"},ui={key:0,class:"flex items-center gap-1.5 text-muted-foreground"},ci={key:1,class:"flex items-center gap-1.5 text-muted-foreground"},fi={key:2,class:"flex items-center gap-1.5 text-muted-foreground"},mi={class:"flex flex-wrap gap-2"},gi={class:"space-y-4 min-w-0"},pi={class:"flex items-center justify-between"},vi={class:"font-semibold flex items-center gap-2"},hi={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},fr=Me({__name:"HitosDashboard",props:{hitos:{},proyectoId:{},proyectos:{},selectedProyectoId:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},showViewDetail:{type:Boolean,default:!0},showProyectoInHito:{type:Boolean,default:!1},baseUrl:{default:"/admin/proyectos"}},emits:["select-hito","edit-hito","delete-hito","view-hito","add-entregable","view-entregable","complete-entregable","update-entregable-status","edit-entregable","delete-entregable","filter-proyecto"],setup(e,{emit:t}){var Dt;const n=e,a=t,i=G(((Dt=n.selectedProyectoId)==null?void 0:Dt.toString())||"_all"),s=q(()=>{if(i.value==="_all")return n.hitos;const V=parseInt(i.value,10);return n.hitos.filter(I=>I.proyecto_id===V)}),d=V=>{i.value=V,f.value=null;const I=V!=="_all"?parseInt(V,10):null;a("filter-proyecto",I)};Sn("(max-width: 768px)");const p=()=>{const I=new URLSearchParams(window.location.search).get("hito");return I?parseInt(I,10):null},v=()=>{const V=new URLSearchParams(window.location.search),I=V.get("modal"),ie=V.get("modal_tab")||"detalles";return I==="hito"?{type:"hito",tab:ie}:I!=null&&I.startsWith("entregable_")?{type:"entregable",entregableId:parseInt(I.replace("entregable_",""),10),tab:ie}:{type:null,tab:"detalles"}},f=G(p()),b=v(),m=q(()=>s.value.find(V=>V.id===f.value)??null),C=q(()=>n.proyectoId?n.proyectoId:m.value?m.value.proyecto_id:null),c=q(()=>C.value?`${n.baseUrl}/${C.value}/hitos`:null),S=q(()=>!m.value||!C.value?null:`${n.baseUrl}/${C.value}/hitos/${m.value.id}/entregables`);we(f,V=>{if(V){const I=window.location.pathname,ie=new URLSearchParams(window.location.search);ie.set("hito",String(V));const be=`${I}?${ie.toString()}`;Sa.get(be,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]}),a("select-hito",V)}});const h=V=>{f.value=V},T=V=>{const I=parseInt(V,10);isNaN(I)||h(I)},j=V=>V?Xe(new Date(V),"dd MMM yyyy",{locale:Ye}):"Sin fecha",H=V=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[V]||"bg-gray-100 text-gray-800",Q=V=>({pendiente:"bg-gray-400",en_progreso:"bg-blue-500 animate-pulse",completado:"bg-green-500",cancelado:"bg-red-500"})[V]||"bg-gray-400",P=V=>{m.value&&a("view-entregable",V,m.value)},U=(V,I,ie)=>{a("complete-entregable",V,I,ie)},ne=(V,I,ie,be)=>{a("update-entregable-status",V,I,ie,be)},se=V=>{m.value&&a("edit-entregable",V,m.value)},fe=V=>{m.value&&a("delete-entregable",V,m.value)},k=()=>{m.value&&a("edit-hito",m.value)},y=()=>{m.value&&a("delete-hito",m.value)},N=()=>{m.value&&a("add-entregable",m.value)},A=()=>{m.value&&(M.value="detalles",x.value=!0)},x=G(b.type==="hito"),M=G(b.type==="hito"?b.tab:"detalles"),Y=G(b.type==="entregable"),re=G(b.entregableId||null),De=G(b.type==="entregable"?b.tab:"detalles"),ke=(V,I,ie)=>{const be=window.location.pathname,R=new URLSearchParams(window.location.search);V==="hito"?(R.set("modal","hito"),ie&&R.set("modal_tab",ie)):V==="entregable"&&I?(R.set("modal",`entregable_${I}`),ie&&R.set("modal_tab",ie)):(R.delete("modal"),R.delete("modal_tab"),R.delete("pagina"));const kt=`${be}?${R.toString()}`;Sa.get(kt,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]})};we([x,M],([V,I])=>{V?ke("hito",void 0,I):new URLSearchParams(window.location.search).get("modal")==="hito"&&ke(null)}),we([Y,De],([V,I])=>{if(V&&re.value)ke("entregable",re.value,I);else{const be=new URLSearchParams(window.location.search).get("modal");be!=null&&be.startsWith("entregable_")&&ke(null)}});const Jt=(V,I="detalles")=>{re.value=V.id,De.value=I,Y.value=!0},Da=()=>{M.value="comentarios",x.value=!0},Ct=()=>{M.value="actividad",x.value=!0};return(V,I)=>{var ie,be;return u(),D("div",As,[g("aside",Os,[g("div",Ms,[g("div",Ns,[g("h2",Rs,[l(o(fa),{class:"h-4 w-4"}),_(" Hitos ("+E(s.value.length)+") ",1)]),e.showViewDetail&&c.value?(u(),O(o(zt),{key:0,href:c.value},{default:r(()=>[l(o(W),{variant:"outline",size:"sm"},{default:r(()=>[l(o(jt),{class:"h-3.5 w-3.5 mr-1"}),I[7]||(I[7]=_(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):w("",!0)]),e.proyectos&&e.proyectos.length>0?(u(),D("div",Fs,[l(o(Zt),{"model-value":i.value,"onUpdate:modelValue":d},{default:r(()=>[l(o(ea),{class:"w-full h-9 text-sm"},{default:r(()=>[l(o(ta),{placeholder:"Todos los proyectos"})]),_:1}),l(o(aa),null,{default:r(()=>[l(o(lt),{value:"_all"},{default:r(()=>[...I[8]||(I[8]=[_("Todos los proyectos",-1)])]),_:1}),(u(!0),D(K,null,ce(e.proyectos,R=>(u(),O(o(lt),{key:R.id,value:R.id.toString()},{default:r(()=>[_(E(R.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])])):w("",!0)]),l(o(ht),{class:"flex-1"},{default:r(()=>[g("div",zs,[s.value.length===0?(u(),D("div",Vs," No hay hitos definidos ")):w("",!0),(u(!0),D(K,null,ce(s.value,R=>(u(),D("button",{key:R.id,"data-active":f.value===R.id,class:"w-full text-left p-3 rounded-lg transition-colors duration-150 hover:bg-accent hover:text-accent-foreground data-[active=true]:bg-primary/10 data-[active=true]:text-primary data-[active=true]:border-l-2 data-[active=true]:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",onClick:kt=>h(R.id)},[g("div",Hs,[g("div",{class:J([Q(R.estado),"w-2 h-2 rounded-full flex-shrink-0"])},null,2),g("span",Us,E(R.nombre),1),f.value===R.id?(u(),O(o(Ka),{key:0,class:"h-4 w-4 flex-shrink-0 text-primary"})):w("",!0)]),e.showProyectoInHito&&R.proyecto?(u(),D("div",js,E(R.proyecto.nombre),1)):w("",!0),g("div",Ls,[l(o(ae),{class:J([H(R.estado),"text-[10px] px-1.5 py-0"])},{default:r(()=>[_(E(R.estado_label||R.estado),1)]),_:2},1032,["class"]),g("span",null,E(R.porcentaje_completado)+"%",1)]),g("div",Xs,[l(o(Vt),{"model-value":R.porcentaje_completado,class:"h-1"},null,8,["model-value"])])],8,Bs))),128))])]),_:1})]),g("main",Ys,[g("div",Gs,[e.proyectos&&e.proyectos.length>0?(u(),O(o(Zt),{key:0,"model-value":i.value,"onUpdate:modelValue":d},{default:r(()=>[l(o(ea),{class:"w-full h-9 text-sm"},{default:r(()=>[l(o(ta),{placeholder:"Todos los proyectos"})]),_:1}),l(o(aa),null,{default:r(()=>[l(o(lt),{value:"_all"},{default:r(()=>[...I[9]||(I[9]=[_("Todos los proyectos",-1)])]),_:1}),(u(!0),D(K,null,ce(e.proyectos,R=>(u(),O(o(lt),{key:R.id,value:R.id.toString()},{default:r(()=>[_(E(R.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])):w("",!0),l(o(Zt),{"model-value":((ie=f.value)==null?void 0:ie.toString())||"","onUpdate:modelValue":T},{default:r(()=>[l(o(ea),{class:"w-full"},{default:r(()=>[l(o(ta),{placeholder:"Selecciona un hito"})]),_:1}),l(o(aa),null,{default:r(()=>[(u(!0),D(K,null,ce(s.value,R=>(u(),O(o(lt),{key:R.id,value:R.id.toString()},{default:r(()=>[g("div",Ws,[g("div",{class:J([Q(R.estado),"w-2 h-2 rounded-full"])},null,2),g("div",qs,[g("span",null,E(R.nombre),1),e.showProyectoInHito&&R.proyecto?(u(),D("span",Ks,E(R.proyecto.nombre),1)):w("",!0)]),g("span",Qs,"("+E(R.porcentaje_completado)+"%)",1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),l(o(ht),{class:"flex-1"},{default:r(()=>[m.value?(u(),D("div",ei,[l(o(pe),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[g("div",ti,[g("div",ai,[g("div",ni,[g("div",{class:J([Q(m.value.estado),"w-2.5 h-2.5 rounded-full"])},null,2),l(o($e),{class:"text-xl truncate"},{default:r(()=>[_(E(m.value.nombre),1)]),_:1})]),e.showProyectoInHito&&m.value.proyecto?(u(),D("div",oi,[l(o(Qn),{class:"h-4 w-4"}),g("span",null,E(m.value.proyecto.nombre),1)])):w("",!0),m.value.descripcion?(u(),D("p",li,E(m.value.descripcion),1)):w("",!0)]),l(o(ae),{class:J(H(m.value.estado))},{default:r(()=>[_(E(m.value.estado_label||m.value.estado),1)]),_:1},8,["class"])])]),_:1}),l(o(ve),{class:"space-y-4"},{default:r(()=>[g("div",si,[g("div",ii,[I[12]||(I[12]=g("span",{class:"text-muted-foreground"},"Progreso",-1)),g("span",ri,E(m.value.porcentaje_completado)+"%",1)]),l(o(Vt),{"model-value":m.value.porcentaje_completado,class:"h-2"},null,8,["model-value"])]),g("div",di,[m.value.fecha_inicio?(u(),D("div",ui,[l(o(Ge),{class:"h-4 w-4"}),g("span",null,"Inicio: "+E(j(m.value.fecha_inicio)),1)])):w("",!0),m.value.fecha_fin?(u(),D("div",ci,[l(o(Pe),{class:"h-4 w-4"}),g("span",null,"Fin: "+E(j(m.value.fecha_fin)),1)])):w("",!0),m.value.responsable?(u(),D("div",fi,[l(o(Je),{class:"h-4 w-4"}),g("span",null,E(m.value.responsable.name),1)])):w("",!0)]),l(o($n)),g("div",mi,[e.canEdit?(u(),O(o(W),{key:0,variant:"outline",size:"sm",onClick:k},{default:r(()=>[l(o(bt),{class:"h-4 w-4 mr-1.5"}),I[13]||(I[13]=_(" Editar Hito ",-1))]),_:1})):w("",!0),e.canManageDeliverables?(u(),O(o(W),{key:1,variant:"outline",size:"sm",onClick:N},{default:r(()=>[l(o(Oa),{class:"h-4 w-4 mr-1.5"}),I[14]||(I[14]=_(" Añadir Entregable ",-1))]),_:1})):w("",!0),e.showViewDetail?(u(),O(o(W),{key:2,variant:"ghost",size:"sm",onClick:A},{default:r(()=>[l(o(ut),{class:"h-4 w-4 mr-1.5"}),I[15]||(I[15]=_(" Ver detalles ",-1))]),_:1})):w("",!0),l(o(W),{variant:"ghost",size:"sm",onClick:Da},{default:r(()=>[l(o(yt),{class:"h-4 w-4 mr-1.5"}),I[16]||(I[16]=_(" Comentarios ",-1)),m.value.comentarios_count&&m.value.comentarios_count>0?(u(),O(o(ae),{key:0,variant:"secondary",class:"ml-1.5 text-xs"},{default:r(()=>[_(E(m.value.comentarios_count),1)]),_:1})):w("",!0)]),_:1}),l(o(W),{variant:"ghost",size:"sm",onClick:Ct},{default:r(()=>[l(o(xt),{class:"h-4 w-4 mr-1.5"}),I[17]||(I[17]=_(" Actividad ",-1))]),_:1}),e.canDelete?(u(),O(o(W),{key:3,variant:"ghost",size:"sm",class:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:y},{default:r(()=>[l(o(Za),{class:"h-4 w-4 mr-1.5"}),I[18]||(I[18]=_(" Eliminar ",-1))]),_:1})):w("",!0)])]),_:1})]),_:1}),g("div",gi,[g("div",pi,[g("h3",vi,[l(o(ut),{class:"h-5 w-5"}),I[19]||(I[19]=_(" Entregables ",-1)),l(o(ae),{variant:"secondary",class:"ml-1"},{default:r(()=>{var R;return[_(E(((R=m.value.entregables)==null?void 0:R.length)||0),1)]}),_:1})]),e.showViewDetail&&S.value?(u(),O(o(zt),{key:0,href:S.value},{default:r(()=>[l(o(W),{variant:"outline",size:"sm"},{default:r(()=>[l(o(jt),{class:"h-3.5 w-3.5 mr-1"}),I[20]||(I[20]=_(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):w("",!0)]),m.value.entregables&&m.value.entregables.length>0?(u(),O(o(vl),{key:0,entregables:m.value.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"initial-modal-entregable-id":o(b).type==="entregable"?o(b).entregableId:void 0,"initial-modal-tab":o(b).type==="entregable"?o(b).tab:void 0,onView:P,onComplete:U,onUpdateStatus:ne,onEdit:se,onDelete:fe,onOpenModal:Jt,onModalTabChange:I[0]||(I[0]=(R,kt)=>{re.value=R,De.value=kt})},null,8,["entregables","can-edit","can-delete","can-complete","initial-modal-entregable-id","initial-modal-tab"])):(u(),D("div",hi,[l(o(ut),{class:"h-10 w-10 mx-auto text-muted-foreground/50 mb-3"}),I[22]||(I[22]=g("p",{class:"text-muted-foreground text-sm"},"No hay entregables en este hito",-1)),e.canManageDeliverables?(u(),O(o(W),{key:0,variant:"outline",size:"sm",class:"mt-4",onClick:N},{default:r(()=>[l(o(Oa),{class:"h-4 w-4 mr-1.5"}),I[21]||(I[21]=_(" Crear primer entregable ",-1))]),_:1})):w("",!0)]))])])):(u(),D("div",Js,[g("div",Zs,[l(o(fa),{class:"h-16 w-16 mx-auto text-muted-foreground/50"}),I[10]||(I[10]=g("h3",{class:"font-medium text-lg"},"Selecciona un hito",-1)),I[11]||(I[11]=g("p",{class:"text-sm text-muted-foreground"}," Elige un hito de la lista para ver sus detalles y entregables ",-1))])]))]),_:1})]),m.value?(u(),O(Wl,{key:0,open:x.value,"onUpdate:open":I[1]||(I[1]=R=>x.value=R),"hito-id":m.value.id,"proyecto-id":C.value||0,"initial-tab":M.value,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-manage-entregables":e.canManageDeliverables,"onUpdate:tab":I[2]||(I[2]=R=>M.value=R),onEditHito:k,onViewEntregable:P,onEditEntregable:se,onAddEntregable:N},null,8,["open","hito-id","proyecto-id","initial-tab","can-edit","can-delete","can-manage-entregables"])):w("",!0),re.value?(u(),O(Ps,{key:1,open:Y.value,"onUpdate:open":[I[3]||(I[3]=R=>Y.value=R),I[6]||(I[6]=R=>{R||(re.value=null)})],"entregable-id":re.value,"proyecto-id":C.value,"hito-id":(be=m.value)==null?void 0:be.id,"initial-tab":De.value,"can-edit":e.canEdit,"can-delete":e.canDelete,"onUpdate:tab":I[4]||(I[4]=R=>De.value=R),onEditEntregable:I[5]||(I[5]=()=>m.value&&se({id:re.value}))},null,8,["open","entregable-id","proyecto-id","hito-id","initial-tab","can-edit","can-delete"])):w("",!0)])}}});export{fr as _};
