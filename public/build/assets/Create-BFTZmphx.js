import{d as E,r as h,C as N,i as m,e as d,f as t,u as e,p as B,w as r,g as a,b as g,j as u,P as k,h as n,l as F,t as p,F as x,k as S}from"./app-Dt2sukkq.js";import{_ as q}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BAX2dDyG.js";import{_ as A,a as M,b as L,c as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-D3D16Ztn.js";import{_ as T}from"./CardDescription.vue_vue_type_script_setup_true_lang-CpG721w4.js";import{_ as b}from"./createLucideIcon-ADYiFz1p.js";import{_ as V}from"./Input.vue_vue_type_script_setup_true_lang-B3JXaiF3.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-DCZhrf2e.js";import{_ as X}from"./Textarea.vue_vue_type_script_setup_true_lang-CU9dUjfW.js";import{_ as w,a as C,b as z,c as U,d as $}from"./SelectValue.vue_vue_type_script_setup_true_lang-XTf0O-lR.js";import{_ as G}from"./CamposPersonalizadosForm.vue_vue_type_script_setup_true_lang-C9-k9UL2.js";import{_ as J}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-BDUwohjA.js";import{t as H}from"./index-CTkeagVR.js";import{A as K}from"./arrow-left-CcnTTf_x.js";import{X as Q}from"./x-BpcUsJXn.js";import{U as W}from"./user-plus-Cvkmfd0W.js";import{S as Y}from"./save-CPLxPeAL.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-Dk5ovgNn.js";import"./index-DYtBqwXi.js";import"./floating-ui.vue-DhUnkJfc.js";import"./index-C_zthh-d.js";import"./shield-Cyievtug.js";import"./user-Ca0ja34E.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Ch_KWbnG.js";import"./chevron-right-CkT1ue1I.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-V01rVzxA.js";import"./VisuallyHidden-H3fpmsLx.js";import"./index-YHYyGAco.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CwNj20AO.js";import"./circle-alert-Bny28mZr.js";import"./map-pin-D1rtVCPc.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-TmplCPgM.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BlnKZeFr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-CLsbi7q1.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BcP5joWp.js";import"./tag-euMStffd.js";import"./users-ARKz5o5z.js";import"./target-BlHWusLl.js";import"./vote-D-ho2Upj.js";import"./folder-open-BwpEZUDw.js";import"./send-D6GePUDU.js";import"./file-text-CrhgvIVS.js";import"./briefcase-CdnBkwVO.js";import"./calendar-CJYt0g6k.js";import"./megaphone-BWKT3hAA.js";import"./user-check-Cjdi1Rn1.js";import"./clipboard-list-DeVxPgd5.js";import"./mail-Cjqn3QRK.js";import"./message-square-CtTij58U.js";import"./external-link-GRGCmSzE.js";import"./panel-left-CvMlf3oX.js";import"./index-DZUQ23bj.js";import"./check-DzU-qwfx.js";import"./index-C5GM-A1h.js";import"./nullish-CHIgUVhi.js";import"./CampoPersonalizadoInput.vue_vue_type_script_setup_true_lang-BiPVkN8R.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-C9CiF85Y.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-BTeYrLXJ.js";import"./RovingFocusItem-BUHtT0jY.js";import"./utils-CveDOlSQ.js";import"./VisuallyHiddenInput-CTh2PJwg.js";import"./circle-C6O6G82s.js";import"./search-BkHaPo1l.js";import"./loader-circle-A6_XgNGB.js";import"./chevron-left-DryFAzkJ.js";const Z={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ee={class:"flex items-center justify-between"},oe={class:"space-y-2"},se={key:0,class:"text-sm text-red-500"},te={class:"space-y-2"},re={key:0,class:"text-sm text-red-500"},ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={class:"space-y-2"},le={key:0,class:"text-sm text-red-500"},ne={class:"space-y-2"},de={key:0,class:"text-sm text-red-500"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},me={class:"space-y-2"},ue={key:0,class:"text-sm text-red-500"},fe={class:"space-y-2"},ce={class:"space-y-2"},_e={key:0,class:"p-3 bg-muted rounded-lg flex items-center justify-between"},be={class:"font-medium"},ve={class:"text-sm text-muted-foreground"},ye={key:0,class:"text-sm text-red-500"},he={key:0,class:"space-y-2"},ge={key:0,class:"text-sm text-red-500"},xe={class:"flex justify-end gap-2 pt-4"},Io=E({__name:"Create",props:{proyecto:{},responsables:{},hitosDisponibles:{},camposPersonalizados:{},estados:{},siguienteOrden:{}},setup(P){const _=P,D=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:_.proyecto.nombre,href:`/admin/proyectos/${_.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${_.proyecto.id}/hitos`},{title:"Crear Hito",href:"#"}],y=h(!1),{route:j}=window,f=h(null),v=h(new Map);_.responsables.forEach(l=>v.value.set(l.id,l));const s=N({nombre:"",descripcion:"",fecha_inicio:"",fecha_fin:"",estado:"pendiente",responsable_id:null,parent_id:null,campos_personalizados:{},orden:_.siguienteOrden,crear_entregables_predefinidos:!1}),I=l=>{if(l.userIds.length>0){const o=l.userIds[0];s.responsable_id=o,v.value.has(o)?f.value=v.value.get(o)||null:(f.value={id:o,name:`Usuario seleccionado (ID: ${o})`,email:"Se actualizará al guardar"},v.value.set(o,f.value))}},R=()=>{s.post(`/admin/proyectos/${_.proyecto.id}/hitos`,{onSuccess:()=>{H.success("Hito creado exitosamente")},onError:()=>{H.error("Error al crear el hito")}})};return(l,o)=>(d(),m(x,null,[t(e(B),{title:`Crear Hito - ${l.proyecto.nombre}`},null,8,["title"]),t(q,{breadcrumbs:D},{default:r(()=>[a("div",Z,[a("div",ee,[o[11]||(o[11]=a("h1",{class:"text-2xl font-bold"},"Crear Nuevo Hito",-1)),t(e(k),{href:`/admin/proyectos/${l.proyecto.id}/hitos`},{default:r(()=>[t(e(b),{variant:"outline",size:"sm"},{default:r(()=>[t(e(K),{class:"h-4 w-4 mr-2"}),o[10]||(o[10]=n(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),t(e(A),null,{default:r(()=>[t(e(M),null,{default:r(()=>[t(e(L),null,{default:r(()=>[...o[12]||(o[12]=[n("Información del Hito",-1)])]),_:1}),t(e(T),null,{default:r(()=>[...o[13]||(o[13]=[n(" Define los detalles del nuevo hito para el proyecto ",-1)])]),_:1})]),_:1}),t(e(O),null,{default:r(()=>[a("form",{onSubmit:F(R,["prevent"]),class:"space-y-6"},[a("div",oe,[t(e(c),{for:"nombre",required:""},{default:r(()=>[...o[14]||(o[14]=[n("Nombre del Hito",-1)])]),_:1}),t(e(V),{id:"nombre",modelValue:e(s).nombre,"onUpdate:modelValue":o[0]||(o[0]=i=>e(s).nombre=i),type:"text",placeholder:"Ej: Pre-producción",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.nombre?(d(),m("span",se,p(e(s).errors.nombre),1)):u("",!0)]),a("div",te,[t(e(c),{for:"descripcion"},{default:r(()=>[...o[15]||(o[15]=[n("Descripción",-1)])]),_:1}),t(e(X),{id:"descripcion",modelValue:e(s).descripcion,"onUpdate:modelValue":o[1]||(o[1]=i=>e(s).descripcion=i),placeholder:"Describe el objetivo y alcance del hito...",disabled:e(s).processing,rows:"3"},null,8,["modelValue","disabled"]),e(s).errors.descripcion?(d(),m("span",re,p(e(s).errors.descripcion),1)):u("",!0)]),a("div",ie,[a("div",ae,[t(e(c),{for:"fecha_inicio"},{default:r(()=>[...o[16]||(o[16]=[n("Fecha de Inicio",-1)])]),_:1}),t(e(V),{id:"fecha_inicio",modelValue:e(s).fecha_inicio,"onUpdate:modelValue":o[2]||(o[2]=i=>e(s).fecha_inicio=i),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_inicio?(d(),m("span",le,p(e(s).errors.fecha_inicio),1)):u("",!0)]),a("div",ne,[t(e(c),{for:"fecha_fin"},{default:r(()=>[...o[17]||(o[17]=[n("Fecha de Fin",-1)])]),_:1}),t(e(V),{id:"fecha_fin",modelValue:e(s).fecha_fin,"onUpdate:modelValue":o[3]||(o[3]=i=>e(s).fecha_fin=i),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_fin?(d(),m("span",de,p(e(s).errors.fecha_fin),1)):u("",!0)])]),a("div",pe,[a("div",me,[t(e(c),{for:"estado"},{default:r(()=>[...o[18]||(o[18]=[n("Estado Inicial",-1)])]),_:1}),t(e(w),{modelValue:e(s).estado,"onUpdate:modelValue":o[4]||(o[4]=i=>e(s).estado=i)},{default:r(()=>[t(e(C),null,{default:r(()=>[t(e(z),{placeholder:"Seleccionar estado"})]),_:1}),t(e(U),null,{default:r(()=>[(d(!0),m(x,null,S(l.estados,i=>(d(),g(e($),{key:i.value,value:i.value},{default:r(()=>[n(p(i.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(s).errors.estado?(d(),m("span",ue,p(e(s).errors.estado),1)):u("",!0)]),a("div",fe,[t(e(c),{for:"responsable_id"},{default:r(()=>[...o[19]||(o[19]=[n("Responsable",-1)])]),_:1}),a("div",ce,[f.value?(d(),m("div",_e,[a("div",null,[a("p",be,p(f.value.name),1),a("p",ve,p(f.value.email),1)]),t(e(b),{type:"button",variant:"ghost",size:"sm",onClick:o[5]||(o[5]=i=>{e(s).responsable_id=null,f.value=null})},{default:r(()=>[t(e(Q),{class:"h-4 w-4"})]),_:1})])):u("",!0),t(e(b),{type:"button",variant:"outline",onClick:o[6]||(o[6]=i=>y.value=!0),class:"w-full"},{default:r(()=>[t(e(W),{class:"h-4 w-4 mr-2"}),n(" "+p(f.value?"Cambiar Responsable":"Seleccionar Responsable"),1)]),_:1})]),e(s).errors.responsable_id?(d(),m("span",ye,p(e(s).errors.responsable_id),1)):u("",!0)])]),l.hitosDisponibles&&l.hitosDisponibles.length>0?(d(),m("div",he,[t(e(c),{for:"parent_id"},{default:r(()=>[...o[20]||(o[20]=[n("Hito Padre (opcional)",-1)])]),_:1}),t(e(w),{modelValue:e(s).parent_id,"onUpdate:modelValue":o[7]||(o[7]=i=>e(s).parent_id=i)},{default:r(()=>[t(e(C),null,{default:r(()=>[t(e(z),{placeholder:"Sin padre (raíz)"})]),_:1}),t(e(U),null,{default:r(()=>[t(e($),{value:null},{default:r(()=>[...o[21]||(o[21]=[n("Sin padre (raíz)",-1)])]),_:1}),(d(!0),m(x,null,S(l.hitosDisponibles,i=>(d(),g(e($),{key:i.id,value:i.id},{default:r(()=>[n(p("—".repeat(i.nivel))+" "+p(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),o[22]||(o[22]=a("p",{class:"text-sm text-muted-foreground"},"Selecciona un hito padre para crear una jerarquía",-1)),e(s).errors.parent_id?(d(),m("span",ge,p(e(s).errors.parent_id),1)):u("",!0)])):u("",!0),a("div",xe,[t(e(k),{href:`/admin/proyectos/${l.proyecto.id}/hitos`},{default:r(()=>[t(e(b),{type:"button",variant:"outline"},{default:r(()=>[...o[23]||(o[23]=[n("Cancelar",-1)])]),_:1})]),_:1},8,["href"]),t(e(b),{type:"submit",disabled:e(s).processing},{default:r(()=>[t(e(Y),{class:"h-4 w-4 mr-2"}),o[24]||(o[24]=n(" Crear Hito ",-1))]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),l.camposPersonalizados&&l.camposPersonalizados.length>0?(d(),g(G,{key:0,campos:l.camposPersonalizados,valores:e(s).campos_personalizados,errors:e(s).errors,onUpdate:o[8]||(o[8]=i=>e(s).campos_personalizados=i)},null,8,["campos","valores","errors"])):u("",!0)]),t(J,{modelValue:y.value,"onUpdate:modelValue":o[9]||(o[9]=i=>y.value=i),title:"Seleccionar Responsable del Hito",description:"Selecciona el usuario que será responsable de este hito","search-endpoint":e(j)("admin.proyectos.search-users"),"excluded-ids":e(s).responsable_id?[e(s).responsable_id]:[],"max-selection":1,"submit-button-text":"Seleccionar Responsable","search-placeholder":"Buscar por nombre, email, documento o teléfono...",onSubmit:I},null,8,["modelValue","search-endpoint","excluded-ids"])]),_:1})],64))}});export{Io as default};
