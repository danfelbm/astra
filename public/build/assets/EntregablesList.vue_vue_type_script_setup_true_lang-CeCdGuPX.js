import{c as ie,_ as h}from"./createLucideIcon-B8d5bW74.js";import{c as U,_ as N}from"./CardTitle.vue_vue_type_script_setup_true_lang-CHzHcBJD.js";import{_ as k}from"./index-BEwAULqp.js";import{_ as de,a as re,b as ce,c as ue,d as me,e as fe,f as pe,g as he}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CZdoME-F.js";import{_ as ve}from"./StatusChangeModal.vue_vue_type_script_setup_true_lang-CZ2X4Z-Q.js";import{C as K}from"./circle-alert-C9j6pIWM.js";import{C as $}from"./clock-_CclVdPa.js";import{C as B}from"./circle-check-big-Bp-GPbzd.js";import{F as _e}from"./file-text-D373kHVE.js";import{C as Q}from"./chevron-right-CCRsFGH5.js";import{C as W}from"./SelectValue.vue_vue_type_script_setup_true_lang-BXZrnX9E.js";import{C as X}from"./calendar-CD2D2UbU.js";import{U as F}from"./user-BCblXEQx.js";import{U as xe}from"./users-lrz85sQ8.js";import{S as Y}from"./square-pen-BlJ2VD3E.js";import{T as R}from"./trash-2-U0flC5IV.js";import{d as ye,r as x,c as ge,i as r,j as d,e as a,g as n,h as u,f as t,t as c,F as L,k as P,w as i,b as f,m as o,n as b}from"./app-DOAvpdpy.js";import{f as Z,e as ee}from"./es-BDPlFIsO.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=ie("ListTodoIcon",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),ke={class:"space-y-6"},Ce={key:0,class:"space-y-6"},we={key:0},Ee={class:"font-semibold mb-3 flex items-center gap-2"},$e={class:"space-y-2"},be={class:"flex items-start justify-between"},De={class:"flex-1"},Me={class:"flex items-center gap-2 mb-2"},ze={class:"font-medium"},Te={key:0,class:"ml-8 space-y-3"},Ve={key:0,class:"text-sm text-muted-foreground"},Be={class:"flex flex-wrap gap-4 text-sm"},Le={class:"flex items-center gap-1 text-muted-foreground"},Pe={key:0,class:"flex items-center gap-1 text-muted-foreground"},Se={key:1,class:"flex items-center gap-2"},je={class:"flex gap-1"},Ue={key:0,class:"flex items-center gap-1 mt-3 pt-3 border-t"},Ne={key:1},Fe={class:"font-semibold mb-3 flex items-center gap-2"},Re={class:"space-y-2"},qe={class:"flex items-start justify-between"},Ae={class:"flex-1"},He={class:"flex items-center gap-2 mb-2"},Oe={class:"font-medium"},Ie={key:0,class:"ml-8 space-y-3"},Ge={key:0,class:"text-sm text-muted-foreground"},Je={class:"flex flex-wrap gap-4 text-sm"},Ke={class:"flex items-center gap-1 text-muted-foreground"},Qe={key:0,class:"flex items-center gap-1 text-muted-foreground"},We={key:0,class:"flex items-center gap-1 mt-3 pt-3 border-t"},Xe={key:2},Ye={class:"font-semibold mb-3 flex items-center gap-2"},Ze={class:"space-y-2"},et={class:"flex items-start justify-between"},tt={class:"flex-1"},st={class:"flex items-center gap-2 mb-2"},at={class:"font-medium line-through text-muted-foreground"},ot={class:"ml-7 space-y-1 text-sm text-muted-foreground"},lt={key:0,class:"flex items-center gap-1"},nt={key:1,class:"flex items-center gap-1"},it={key:2,class:"italic mt-2"},dt={key:0,class:"flex items-center gap-1 mt-3 pt-3 border-t"},rt={key:3,class:"text-center py-8"},zt=ye({__name:"EntregablesList",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},viewMode:{default:"list"}},emits:["edit","delete","complete","update-status"],setup(m,{emit:te}){const D=m,M=te;x([]);const z=x([]),T=x(!1),C=x(null),w=x(!1),_=x(null),E=x("pendiente"),se=x(!1),v=ge(()=>({pendientes:D.entregables.filter(l=>l.estado==="pendiente"),en_progreso:D.entregables.filter(l=>l.estado==="en_progreso"),completados:D.entregables.filter(l=>l.estado==="completado"),cancelados:D.entregables.filter(l=>l.estado==="cancelado")})),ae=l=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[l]||"bg-gray-100 text-gray-800",q=l=>({baja:"bg-gray-100 text-gray-600",media:"bg-yellow-100 text-yellow-800",alta:"bg-red-100 text-red-800"})[l]||"bg-gray-100 text-gray-600",S=l=>l?Z(new Date(l),"dd MMM yyyy",{locale:ee}):"Sin fecha",oe=l=>l?Z(new Date(l),"dd MMM yyyy 'a las' HH:mm",{locale:ee}):"-",g=l=>{if(!l)return null;const s=Math.ceil((new Date(l).getTime()-new Date().getTime())/(1e3*60*60*24));return s<0?`Vencido hace ${Math.abs(s)} días`:s===0?"Vence hoy":s===1?"Vence mañana":`${s} días`},A=l=>{const s=z.value.indexOf(l);s===-1?z.value.push(l):z.value.splice(s,1)},V=l=>z.value.includes(l),H=l=>{M("edit",l)},j=l=>{C.value=l,T.value=!0},le=()=>{C.value&&M("delete",C.value),T.value=!1,C.value=null},O=l=>{_.value=l,E.value="completado",w.value=!0},I=(l,s)=>{_.value=l,E.value=s,w.value=!0},ne=(l,s)=>{_.value&&(E.value==="completado"?M("complete",_.value,l,s):M("update-status",_.value,E.value,l,s),w.value=!1,_.value=null)};return(l,s)=>{var G,J;return o(),r("div",ke,[m.viewMode==="list"?(o(),r("div",Ce,[v.value.pendientes.length>0?(o(),r("div",we,[n("h3",Ee,[a(t(K),{class:"h-5 w-5 text-yellow-600"}),u(" Pendientes ("+c(v.value.pendientes.length)+") ",1)]),n("div",$e,[(o(!0),r(L,null,P(v.value.pendientes,e=>(o(),f(t(N),{key:e.id},{default:i(()=>[a(t(U),{class:"p-4"},{default:i(()=>{var y;return[n("div",be,[n("div",De,[n("div",Me,[a(t(h),{onClick:p=>A(e.id),variant:"ghost",size:"sm",class:"h-6 w-6 p-0"},{default:i(()=>[V(e.id)?(o(),f(t(W),{key:1,class:"h-4 w-4"})):(o(),f(t(Q),{key:0,class:"h-4 w-4"}))]),_:2},1032,["onClick"]),n("h4",ze,c(e.nombre),1),a(t(k),{class:b(q(e.prioridad)),variant:"outline"},{default:i(()=>[u(c(e.prioridad),1)]),_:2},1032,["class"]),a(t(k),{class:b(ae(e.estado))},{default:i(()=>[u(c(e.estado),1)]),_:2},1032,["class"])]),V(e.id)?(o(),r("div",Te,[e.descripcion?(o(),r("p",Ve,c(e.descripcion),1)):d("",!0),n("div",Be,[n("div",Le,[a(t(X),{class:"h-4 w-4"}),n("span",null,c(S(e.fecha_inicio))+" - "+c(S(e.fecha_fin)),1)]),e.responsable?(o(),r("div",Pe,[a(t(F),{class:"h-4 w-4"}),n("span",null,c(e.responsable.name),1)])):d("",!0),g(e.fecha_fin)?(o(),r("div",{key:1,class:b(["flex items-center gap-1",{"text-red-600":(y=g(e.fecha_fin))==null?void 0:y.includes("Vencido")}])},[a(t($),{class:"h-4 w-4"}),n("span",null,c(g(e.fecha_fin)),1)],2)):d("",!0)]),e.usuarios&&e.usuarios.length>0?(o(),r("div",Se,[a(t(xe),{class:"h-4 w-4 text-muted-foreground"}),n("div",je,[(o(!0),r(L,null,P(e.usuarios,p=>(o(),f(t(k),{key:p.id,variant:"secondary"},{default:i(()=>[u(c(p.name),1)]),_:2},1024))),128))])])):d("",!0)])):d("",!0)])]),m.canEdit||m.canDelete||m.canComplete?(o(),r("div",Ue,[m.canComplete?(o(),f(t(h),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:p=>O(e)},{default:i(()=>[a(t(B),{class:"h-3 w-3 mr-1"}),s[2]||(s[2]=u(" Completar ",-1))]),_:1},8,["onClick"])):d("",!0),m.canEdit?(o(),f(t(h),{key:1,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:p=>I(e,"en_progreso")},{default:i(()=>[a(t($),{class:"h-3 w-3 mr-1"}),s[3]||(s[3]=u(" En progreso ",-1))]),_:1},8,["onClick"])):d("",!0),m.canEdit?(o(),f(t(h),{key:2,variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:p=>H(e)},{default:i(()=>[a(t(Y),{class:"h-3 w-3 mr-1"}),s[4]||(s[4]=u(" Editar ",-1))]),_:1},8,["onClick"])):d("",!0),m.canDelete?(o(),f(t(h),{key:3,variant:"ghost",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50",onClick:p=>j(e)},{default:i(()=>[a(t(R),{class:"h-3 w-3 mr-1"}),s[5]||(s[5]=u(" Eliminar ",-1))]),_:1},8,["onClick"])):d("",!0)])):d("",!0)]}),_:2},1024)]),_:2},1024))),128))])])):d("",!0),v.value.en_progreso.length>0?(o(),r("div",Ne,[n("h3",Fe,[a(t($),{class:"h-5 w-5 text-blue-600"}),u(" En Progreso ("+c(v.value.en_progreso.length)+") ",1)]),n("div",Re,[(o(!0),r(L,null,P(v.value.en_progreso,e=>(o(),f(t(N),{key:e.id,class:"border-l-4 border-l-blue-500"},{default:i(()=>[a(t(U),{class:"p-4"},{default:i(()=>{var y;return[n("div",qe,[n("div",Ae,[n("div",He,[a(t(h),{onClick:p=>A(e.id),variant:"ghost",size:"sm",class:"h-6 w-6 p-0"},{default:i(()=>[V(e.id)?(o(),f(t(W),{key:1,class:"h-4 w-4"})):(o(),f(t(Q),{key:0,class:"h-4 w-4"}))]),_:2},1032,["onClick"]),n("h4",Oe,c(e.nombre),1),a(t(k),{class:b(q(e.prioridad)),variant:"outline"},{default:i(()=>[u(c(e.prioridad),1)]),_:2},1032,["class"]),a(t(k),{class:"bg-blue-100 text-blue-800"},{default:i(()=>[...s[6]||(s[6]=[u(" En Progreso ",-1)])]),_:1})]),V(e.id)?(o(),r("div",Ie,[e.descripcion?(o(),r("p",Ge,c(e.descripcion),1)):d("",!0),n("div",Je,[n("div",Ke,[a(t(X),{class:"h-4 w-4"}),n("span",null,"Fecha límite: "+c(S(e.fecha_fin)),1)]),e.responsable?(o(),r("div",Qe,[a(t(F),{class:"h-4 w-4"}),n("span",null,c(e.responsable.name),1)])):d("",!0),g(e.fecha_fin)?(o(),r("div",{key:1,class:b(["flex items-center gap-1",{"text-red-600":(y=g(e.fecha_fin))==null?void 0:y.includes("Vencido")}])},[a(t($),{class:"h-4 w-4"}),n("span",null,c(g(e.fecha_fin)),1)],2)):d("",!0)])])):d("",!0)])]),m.canEdit||m.canDelete||m.canComplete?(o(),r("div",We,[m.canComplete?(o(),f(t(h),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:p=>O(e)},{default:i(()=>[a(t(B),{class:"h-3 w-3 mr-1"}),s[7]||(s[7]=u(" Completar ",-1))]),_:1},8,["onClick"])):d("",!0),m.canEdit?(o(),f(t(h),{key:1,variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:p=>H(e)},{default:i(()=>[a(t(Y),{class:"h-3 w-3 mr-1"}),s[8]||(s[8]=u(" Editar ",-1))]),_:1},8,["onClick"])):d("",!0),m.canDelete?(o(),f(t(h),{key:2,variant:"ghost",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50",onClick:p=>j(e)},{default:i(()=>[a(t(R),{class:"h-3 w-3 mr-1"}),s[9]||(s[9]=u(" Eliminar ",-1))]),_:1},8,["onClick"])):d("",!0)])):d("",!0)]}),_:2},1024)]),_:2},1024))),128))])])):d("",!0),v.value.completados.length>0?(o(),r("div",Xe,[n("h3",Ye,[a(t(B),{class:"h-5 w-5 text-green-600"}),u(" Completados ("+c(v.value.completados.length)+") ",1)]),n("div",Ze,[(o(!0),r(L,null,P(v.value.completados,e=>(o(),f(t(N),{key:e.id,class:"border-l-4 border-l-green-500 bg-green-50/30"},{default:i(()=>[a(t(U),{class:"p-4"},{default:i(()=>[n("div",et,[n("div",tt,[n("div",st,[a(t(B),{class:"h-5 w-5 text-green-600"}),n("h4",at,c(e.nombre),1),a(t(k),{class:"bg-green-100 text-green-800"},{default:i(()=>[...s[10]||(s[10]=[u(" Completado ",-1)])]),_:1})]),n("div",ot,[e.completado_at?(o(),r("div",lt,[a(t($),{class:"h-3 w-3"}),n("span",null,"Completado: "+c(oe(e.completado_at)),1)])):d("",!0),e.completado_por_usuario?(o(),r("div",nt,[a(t(F),{class:"h-3 w-3"}),n("span",null,"Por: "+c(e.completado_por_usuario.name),1)])):d("",!0),e.observaciones_estado?(o(),r("p",it,' "'+c(e.observaciones_estado)+'" ',1)):d("",!0)])])]),m.canEdit||m.canDelete?(o(),r("div",dt,[m.canEdit?(o(),f(t(h),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:y=>I(e,"pendiente")},{default:i(()=>[a(t(K),{class:"h-3 w-3 mr-1"}),s[11]||(s[11]=u(" Reabrir ",-1))]),_:1},8,["onClick"])):d("",!0),m.canDelete?(o(),f(t(h),{key:1,variant:"ghost",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50",onClick:y=>j(e)},{default:i(()=>[a(t(R),{class:"h-3 w-3 mr-1"}),s[12]||(s[12]=u(" Eliminar ",-1))]),_:1},8,["onClick"])):d("",!0)])):d("",!0)]),_:2},1024)]),_:2},1024))),128))])])):d("",!0),m.entregables.length===0?(o(),r("div",rt,[a(t(_e),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s[13]||(s[13]=n("p",{class:"text-muted-foreground"},"No hay entregables asignados",-1))])):d("",!0)])):d("",!0),a(t(de),{open:T.value,"onUpdate:open":s[0]||(s[0]=e=>T.value=e)},{default:i(()=>[a(t(re),null,{default:i(()=>[a(t(ce),null,{default:i(()=>[a(t(ue),null,{default:i(()=>[...s[14]||(s[14]=[u("¿Estás seguro?",-1)])]),_:1}),a(t(me),null,{default:i(()=>{var e;return[u(' Esta acción no se puede deshacer. Se eliminará permanentemente el entregable "'+c((e=C.value)==null?void 0:e.nombre)+'". ',1)]}),_:1})]),_:1}),a(t(fe),null,{default:i(()=>[a(t(pe),null,{default:i(()=>[...s[15]||(s[15]=[u("Cancelar",-1)])]),_:1}),a(t(he),{onClick:le},{default:i(()=>[...s[16]||(s[16]=[u(" Eliminar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(ve,{open:w.value,"onUpdate:open":s[1]||(s[1]=e=>w.value=e),"entregable-nombre":(G=_.value)==null?void 0:G.nombre,"estado-actual":(J=_.value)==null?void 0:J.estado,"nuevo-estado":E.value,loading:se.value,onConfirm:ne},null,8,["open","entregable-nombre","estado-actual","nuevo-estado","loading"])])}}});export{Mt as L,zt as _};
