import{d as J,r as K,W as y,m as Q,i as f,e as n,f as s,u as t,p as Y,w as o,g as r,h as i,t as d,j as _,F as j,k as Z,b as k}from"./app-MhRkZYda.js";import{_ as q}from"./AdminLayout.vue_vue_type_script_setup_true_lang-s8UCj-v6.js";import{_ as x,c as g}from"./CardTitle.vue_vue_type_script_setup_true_lang-l03Rvke8.js";import{c as ee,_ as b}from"./createLucideIcon-CtoO_Kiv.js";import{_ as C}from"./Input.vue_vue_type_script_setup_true_lang-BIqg1Ebh.js";import{_ as E}from"./index-D9cSDYZw.js";import{_ as te,a as se,b as A,c as p,d as oe,e as c}from"./TableHeader.vue_vue_type_script_setup_true_lang-RJeosXWc.js";import{_ as F,a as R,b as U,c as B,d as v}from"./SelectValue.vue_vue_type_script_setup_true_lang-Cw5PJOxU.js";import{_ as ae,a as le,b as re,c as S}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-ZgmtTIfd.js";import{t as h}from"./index-C4AhATEj.js";import{l as ie}from"./lodash-DUgV3XJl.js";import{D as de}from"./download-DnBlKbp0.js";import{U as ne}from"./users-jwOqaBj3.js";import{C as ue}from"./clock-BnwLa_QT.js";import{C as me}from"./circle-check-big-Cw5ApxxX.js";import{X as D}from"./x-DDu6o8kn.js";import{S as fe}from"./search-CWj5t0jZ.js";import{F as pe}from"./file-text-CSf3KGSt.js";import{E as ce}from"./eye-CSWGUBTC.js";import{C as _e}from"./check-DIKoOxln.js";import{C as ve}from"./chevron-left-DjWDS8D5.js";import{C as xe}from"./chevron-right-CLygI0q1.js";import{f as ge,e as we}from"./es-nEe0wmoQ.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-D128fxVw.js";import"./index-CKzDzxRj.js";import"./floating-ui.vue-Jtid5Cir.js";import"./index-CGlb_uG-.js";import"./shield-C7We-wCE.js";import"./user-ByVghZe9.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BtbY9BuF.js";import"./VisuallyHidden-ClD0DDsS.js";import"./index-D1N0p-74.js";import"./Label.vue_vue_type_script_setup_true_lang-dAqUlvBp.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-ZdbDwAbT.js";import"./circle-alert-Crskc4s_.js";import"./map-pin-B5DXokRd.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-ZZIvmMj6.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BqmWBxIU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-B_e-HSmn.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DoAxHmi0.js";import"./target-B9U4ycgp.js";import"./vote-BbOfLgcg.js";import"./folder-open-CJtFOPOB.js";import"./send-B-3fqeSw.js";import"./briefcase-BhQcV9fE.js";import"./calendar-G1jntOAT.js";import"./megaphone-l3pQSHwh.js";import"./user-check-TX_Nop_V.js";import"./mail-D2iFew9f.js";import"./message-square-DqgXAPvJ.js";import"./external-link-D5LXOYvq.js";import"./panel-left-Bv2yObtj.js";import"./index-DhGDRjjN.js";import"./nullish-CHIgUVhi.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=ee("EllipsisVerticalIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),be={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ke={class:"flex items-center justify-between"},he={class:"flex gap-2"},Ce={class:"grid gap-4 md:grid-cols-4"},Se={class:"flex flex-row items-center justify-between space-y-0"},$e={class:"text-2xl font-bold"},Ve={class:"flex flex-row items-center justify-between space-y-0"},ze={class:"text-2xl font-bold text-yellow-600"},je={class:"flex flex-row items-center justify-between space-y-0"},Ee={class:"text-2xl font-bold text-green-600"},Ae={class:"flex flex-row items-center justify-between space-y-0"},Fe={class:"text-2xl font-bold text-red-600"},Re={class:"grid gap-4 md:grid-cols-5"},Ue={class:"mt-4"},Be={key:0,class:"text-center py-8"},De={key:1,class:"rounded-md border"},Pe={class:"font-semibold"},Te={class:"text-sm text-muted-foreground"},Le={class:"space-y-1"},Me={key:0,class:"text-sm"},Ne={key:1,class:"text-sm"},Ie={key:2,class:"text-sm"},He={key:3,class:"text-sm text-muted-foreground"},We={key:1,class:"text-sm text-muted-foreground"},Ge={class:"text-sm"},Oe={key:0,class:"text-sm"},Xe={key:1,class:"text-sm text-muted-foreground"},Je={key:2,class:"flex items-center justify-between mt-4"},Ke={class:"text-sm text-muted-foreground"},Qe={class:"flex items-center space-x-2"},Ye={class:"text-sm"},qt=J({__name:"Index",props:{requests:{},stats:{},filters:{}},setup(P){const $=window.route,w=P,T=[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Solicitudes de Actualización",href:"/admin/solicitudes-actualizacion"}],u=K({status:w.filters.status||"all",has_documents:w.filters.has_documents||"all",date_from:w.filters.date_from||"",date_to:w.filters.date_to||"",search:w.filters.search||""}),L=ie.debounce(()=>{const l=Object.entries(u.value).reduce((e,[a,m])=>(m&&m!=="all"&&(e[a]=m),e),{});y.get("/admin/solicitudes-actualizacion",{...l,page:1},{preserveState:!0,preserveScroll:!0})},300);Q(()=>u.value,()=>{L()},{deep:!0});const M=()=>{u.value={status:"all",has_documents:"all",date_from:"",date_to:"",search:""}},V=l=>{y.get("/admin/solicitudes-actualizacion",{...u.value,page:l},{preserveState:!0,preserveScroll:!0})},N=l=>{y.visit(`/admin/solicitudes-actualizacion/${l}`)},I=l=>{confirm("¿Aprobar esta solicitud de actualización?")&&y.post($("admin.update-requests.approve",{updateRequest:l}),{notes:"Aprobado desde lista"},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{h.success("Solicitud aprobada correctamente")},onError:e=>{console.error("Error:",e),h.error("Error al aprobar la solicitud")}})},H=l=>{const e=prompt("Motivo del rechazo:");e&&y.post($("admin.update-requests.reject",{updateRequest:l}),{notes:e},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{h.success("Solicitud rechazada")},onError:a=>{console.error("Error:",a),h.error("Error al rechazar la solicitud")}})},W=()=>{window.location.href="/admin/solicitudes-actualizacion/export/csv?"+new URLSearchParams(u.value).toString()},G=l=>l?ge(new Date(l),"dd MMM yyyy HH:mm",{locale:we}):"-",O=l=>{switch(l){case"pending":return"warning";case"approved":return"success";case"rejected":return"destructive";default:return"secondary"}},X=l=>{switch(l){case"pending":return"Pendiente";case"approved":return"Aprobada";case"rejected":return"Rechazada";default:return l}};return(l,e)=>(n(),f(j,null,[s(t(Y),{title:"Solicitudes de Actualización"}),s(q,{breadcrumbs:T},{default:o(()=>[r("div",be,[r("div",ke,[e[8]||(e[8]=r("div",null,[r("h1",{class:"text-3xl font-bold tracking-tight"},"Solicitudes de Actualización"),r("p",{class:"text-muted-foreground"}," Gestiona las solicitudes de actualización de datos de usuarios ")],-1)),r("div",he,[s(t(b),{onClick:W,variant:"outline"},{default:o(()=>[s(t(de),{class:"mr-2 h-4 w-4"}),e[7]||(e[7]=i(" Exportar CSV ",-1))]),_:1})])]),r("div",Ce,[s(t(x),null,{default:o(()=>[s(t(g),{class:"pt-6"},{default:o(()=>[r("div",Se,[r("div",null,[e[9]||(e[9]=r("p",{class:"text-sm font-medium text-muted-foreground"},"Total Solicitudes",-1)),r("p",$e,d(l.stats.total),1)]),s(t(ne),{class:"h-4 w-4 text-muted-foreground"})])]),_:1})]),_:1}),s(t(x),null,{default:o(()=>[s(t(g),{class:"pt-6"},{default:o(()=>[r("div",Ve,[r("div",null,[e[10]||(e[10]=r("p",{class:"text-sm font-medium text-muted-foreground"},"Pendientes",-1)),r("p",ze,d(l.stats.pending),1)]),s(t(ue),{class:"h-4 w-4 text-yellow-500"})])]),_:1})]),_:1}),s(t(x),null,{default:o(()=>[s(t(g),{class:"pt-6"},{default:o(()=>[r("div",je,[r("div",null,[e[11]||(e[11]=r("p",{class:"text-sm font-medium text-muted-foreground"},"Aprobadas",-1)),r("p",Ee,d(l.stats.approved),1)]),s(t(me),{class:"h-4 w-4 text-green-500"})])]),_:1})]),_:1}),s(t(x),null,{default:o(()=>[s(t(g),{class:"pt-6"},{default:o(()=>[r("div",Ae,[r("div",null,[e[12]||(e[12]=r("p",{class:"text-sm font-medium text-muted-foreground"},"Rechazadas",-1)),r("p",Fe,d(l.stats.rejected),1)]),s(t(D),{class:"h-4 w-4 text-red-500"})])]),_:1})]),_:1})]),s(t(x),null,{default:o(()=>[s(t(g),{class:"pt-6"},{default:o(()=>[r("div",Re,[r("div",null,[s(t(C),{modelValue:u.value.search,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value.search=a),placeholder:"Buscar por nombre/documento...",class:"w-full"},{prefix:o(()=>[s(t(fe),{class:"h-4 w-4 text-muted-foreground"})]),_:1},8,["modelValue"])]),s(t(F),{modelValue:u.value.status,"onUpdate:modelValue":e[1]||(e[1]=a=>u.value.status=a)},{default:o(()=>[s(t(R),null,{default:o(()=>[s(t(U),{placeholder:"Estado"})]),_:1}),s(t(B),null,{default:o(()=>[s(t(v),{value:"all"},{default:o(()=>[...e[13]||(e[13]=[i("Todos",-1)])]),_:1}),s(t(v),{value:"pending"},{default:o(()=>[...e[14]||(e[14]=[i("Pendiente",-1)])]),_:1}),s(t(v),{value:"approved"},{default:o(()=>[...e[15]||(e[15]=[i("Aprobada",-1)])]),_:1}),s(t(v),{value:"rejected"},{default:o(()=>[...e[16]||(e[16]=[i("Rechazada",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(t(F),{modelValue:u.value.has_documents,"onUpdate:modelValue":e[2]||(e[2]=a=>u.value.has_documents=a)},{default:o(()=>[s(t(R),null,{default:o(()=>[s(t(U),{placeholder:"Documentos"})]),_:1}),s(t(B),null,{default:o(()=>[s(t(v),{value:"all"},{default:o(()=>[...e[17]||(e[17]=[i("Todos",-1)])]),_:1}),s(t(v),{value:"true"},{default:o(()=>[...e[18]||(e[18]=[i("Con documentos",-1)])]),_:1}),s(t(v),{value:"false"},{default:o(()=>[...e[19]||(e[19]=[i("Sin documentos",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(t(C),{modelValue:u.value.date_from,"onUpdate:modelValue":e[3]||(e[3]=a=>u.value.date_from=a),type:"date",placeholder:"Fecha desde"},null,8,["modelValue"]),s(t(C),{modelValue:u.value.date_to,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value.date_to=a),type:"date",placeholder:"Fecha hasta"},null,8,["modelValue"])]),r("div",Ue,[s(t(b),{onClick:M,variant:"outline",size:"sm"},{default:o(()=>[...e[20]||(e[20]=[i(" Limpiar filtros ",-1)])]),_:1})])]),_:1})]),_:1}),s(t(x),null,{default:o(()=>[s(t(g),{class:"pt-6"},{default:o(()=>[l.requests.data.length===0?(n(),f("div",Be,[...e[21]||(e[21]=[r("p",{class:"text-muted-foreground"},"No se encontraron solicitudes",-1)])])):(n(),f("div",De,[s(t(te),null,{default:o(()=>[s(t(se),null,{default:o(()=>[s(t(A),null,{default:o(()=>[s(t(p),null,{default:o(()=>[...e[22]||(e[22]=[i("#",-1)])]),_:1}),s(t(p),null,{default:o(()=>[...e[23]||(e[23]=[i("Usuario",-1)])]),_:1}),s(t(p),null,{default:o(()=>[...e[24]||(e[24]=[i("Cambios",-1)])]),_:1}),s(t(p),null,{default:o(()=>[...e[25]||(e[25]=[i("Documentos",-1)])]),_:1}),s(t(p),null,{default:o(()=>[...e[26]||(e[26]=[i("Estado",-1)])]),_:1}),s(t(p),null,{default:o(()=>[...e[27]||(e[27]=[i("Fecha",-1)])]),_:1}),s(t(p),null,{default:o(()=>[...e[28]||(e[28]=[i("Admin",-1)])]),_:1}),s(t(p),{class:"text-right"},{default:o(()=>[...e[29]||(e[29]=[i("Acciones",-1)])]),_:1})]),_:1})]),_:1}),s(t(oe),null,{default:o(()=>[(n(!0),f(j,null,Z(l.requests.data,a=>(n(),k(t(A),{key:a.id},{default:o(()=>[s(t(c),{class:"font-medium"},{default:o(()=>[i(d(a.id),1)]),_:2},1024),s(t(c),null,{default:o(()=>[r("div",null,[r("p",Pe,d(a.user.name),1),r("p",Te,d(a.user.documento_identidad),1)])]),_:2},1024),s(t(c),null,{default:o(()=>{var m,z;return[r("div",Le,[a.new_email?(n(),f("div",Me," 📧 "+d(a.new_email),1)):_("",!0),a.new_telefono?(n(),f("div",Ne," 📱 "+d(a.new_telefono),1)):_("",!0),a.new_municipio?(n(),f("div",Ie," 📍 "+d([(m=a.new_departamento)==null?void 0:m.nombre,(z=a.new_municipio)==null?void 0:z.nombre].filter(Boolean).join(", ")),1)):_("",!0),!a.new_email&&!a.new_telefono&&!a.new_municipio?(n(),f("div",He," Sin cambios ")):_("",!0)])]}),_:2},1024),s(t(c),null,{default:o(()=>{var m;return[((m=a.documentos_soporte)==null?void 0:m.length)>0?(n(),k(t(E),{key:0},{default:o(()=>[s(t(pe),{class:"mr-1 h-3 w-3"}),i(" "+d(a.documentos_soporte.length),1)]),_:2},1024)):(n(),f("span",We,"-"))]}),_:2},1024),s(t(c),null,{default:o(()=>[s(t(E),{variant:O(a.status)},{default:o(()=>[i(d(X(a.status)),1)]),_:2},1032,["variant"])]),_:2},1024),s(t(c),null,{default:o(()=>[r("span",Ge,d(G(a.created_at)),1)]),_:2},1024),s(t(c),null,{default:o(()=>[a.admin?(n(),f("span",Oe,d(a.admin.name),1)):(n(),f("span",Xe,"-"))]),_:2},1024),s(t(c),{class:"text-right"},{default:o(()=>[s(t(ae),null,{default:o(()=>[s(t(le),{"as-child":""},{default:o(()=>[s(t(b),{variant:"ghost",size:"icon"},{default:o(()=>[s(t(ye),{class:"h-4 w-4"})]),_:1})]),_:1}),s(t(re),{align:"end"},{default:o(()=>[s(t(S),{onClick:m=>N(a.id)},{default:o(()=>[s(t(ce),{class:"mr-2 h-4 w-4"}),e[30]||(e[30]=i(" Ver detalle ",-1))]),_:2},1032,["onClick"]),a.status==="pending"?(n(),k(t(S),{key:0,onClick:m=>I(a.id),class:"text-green-600"},{default:o(()=>[s(t(_e),{class:"mr-2 h-4 w-4"}),e[31]||(e[31]=i(" Aprobar ",-1))]),_:2},1032,["onClick"])):_("",!0),a.status==="pending"?(n(),k(t(S),{key:1,onClick:m=>H(a.id),class:"text-red-600"},{default:o(()=>[s(t(D),{class:"mr-2 h-4 w-4"}),e[32]||(e[32]=i(" Rechazar ",-1))]),_:2},1032,["onClick"])):_("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])),l.requests.last_page>1?(n(),f("div",Je,[r("div",Ke," Mostrando "+d(l.requests.from||0)+" a "+d(l.requests.to||0)+" de "+d(l.requests.total)+" resultados ",1),r("div",Qe,[s(t(b),{onClick:e[5]||(e[5]=a=>V(l.requests.current_page-1)),disabled:l.requests.current_page===1,variant:"outline",size:"sm"},{default:o(()=>[s(t(ve),{class:"h-4 w-4"}),e[33]||(e[33]=i(" Anterior ",-1))]),_:1},8,["disabled"]),r("div",Ye," Página "+d(l.requests.current_page)+" de "+d(l.requests.last_page),1),s(t(b),{onClick:e[6]||(e[6]=a=>V(l.requests.current_page+1)),disabled:l.requests.current_page===l.requests.last_page,variant:"outline",size:"sm"},{default:o(()=>[e[34]||(e[34]=i(" Siguiente ",-1)),s(t(xe),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])):_("",!0)]),_:1})]),_:1})])]),_:1})],64))}});export{qt as default};
