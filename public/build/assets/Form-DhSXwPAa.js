import{d as ce,a as c,o as n,b as a,i as p,u as o,e as i,g as d,t as u,F as w,r as S,j as y,c as k,C as he,k as x,w as te,s as Ve,m as ke,f as r,as as we,l as $e,n as se,W as C}from"./app-DUwT5XjW.js";import{a as Ce,_ as Se}from"./AppLayout.vue_vue_type_script_setup_true_lang-C-TXGeAC.js";import{_ as g}from"./AppLogo.vue_vue_type_script_setup_true_lang-TtBKHXHP.js";import{_ as F,a as D}from"./CardContent.vue_vue_type_script_setup_true_lang-5UaTZODP.js";import{_ as N,a as P}from"./CardTitle.vue_vue_type_script_setup_true_lang-DawTe2K_.js";import{_ as Ee}from"./Checkbox.vue_vue_type_script_setup_true_lang-C__YTuiO.js";import{_ as ie}from"./Input.vue_vue_type_script_setup_true_lang-Bavi-x6e.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-BVnk0AbU.js";import{_ as T,a as q,b as L,c as H,d as M}from"./SelectValue.vue_vue_type_script_setup_true_lang-B7z30C33.js";import{_ as Ae,a as je,b as Z,c as X}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-By-tGV9d.js";import{_ as le}from"./Textarea.vue_vue_type_script_setup_true_lang-Dt20lwRw.js";import{_ as J}from"./DateTimePicker.vue_vue_type_script_setup_true_lang-BpsL9h74.js";import{L as ze,a as Fe,_ as De}from"./DynamicFormBuilder.vue_vue_type_script_setup_true_lang-C6BTgYfw.js";import{U as re}from"./upload-BCDFVy9m.js";import{P as ne}from"./plus-C_Zgpucy.js";import{H as de}from"./history-DZb0-jTg.js";import{T as Ue}from"./trash-2-CF8unIwz.js";import{C as Ie}from"./circle-x-c-Py5kuU.js";import{C as Be}from"./circle-check-big-CGUkHjNB.js";import{C as ue}from"./clock-DtY7_Md1.js";import"./index-lXub5hNN.js";import"./index-S1odQ9fv.js";import"./useForwardExpose-DCR6Fykl.js";import"./usePrimitiveElement-DXJMmht_.js";import"./createContext-BqTg7DGM.js";import"./Collection-C7Tlg6fc.js";import"./useNonce-CVR6C3wM.js";import"./chevron-up-mMt2Z1mV.js";import"./handleAndDispatchCustomEvent-CYpUamdb.js";import"./nullish-CHIgUVhi.js";import"./useFormControl-B3_kincx.js";import"./VisuallyHidden-BH4I_bjZ.js";import"./RovingFocusItem-Cmn667_L.js";import"./grip-vertical-BsmuzG_W.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DfN2mHkg.js";import"./circle-alert-BDYdSiMf.js";import"./eye-DOHKdpym.js";import"./git-branch-wkH7bmYS.js";const Ne={key:0,class:"text-red-500"},Pe={key:0,class:"text-sm text-destructive mt-1"},Te={key:1,class:"text-xs text-muted-foreground mt-1"},qe=ce({__name:"TimezoneSelector",props:{modelValue:{},disabled:{type:Boolean,default:!1},label:{default:"Zona Horaria"},placeholder:{default:"Seleccionar zona horaria"},description:{default:"Las fechas de apertura y cierre se aplicarán según esta zona horaria"},required:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(K,{emit:f}){const m=f,G=v=>{m("update:modelValue",v)};return(v,O)=>(n(),c("div",null,[a(o(b),null,{default:i(()=>[d(u(v.label)+" ",1),v.required?(n(),c("span",Ne,"*")):p("",!0)]),_:1}),a(o(T),{"model-value":v.modelValue,"onUpdate:modelValue":G,disabled:v.disabled},{default:i(()=>[a(o(q),null,{default:i(()=>[a(o(L),{placeholder:v.placeholder},null,8,["placeholder"])]),_:1}),a(o(H),null,{default:i(()=>[(n(!0),c(w,null,S(o(ze),t=>(n(),y(o(M),{key:t.value,value:t.value},{default:i(()=>[d(u(t.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),v.error?(n(),c("p",Pe,u(v.error),1)):v.description?(n(),c("p",Te,u(v.description),1)):p("",!0)]))}}),Le={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},He={class:"flex items-center justify-between"},Me={class:"text-3xl font-bold"},Ge={class:"text-muted-foreground"},Oe={class:"relative min-h-[70vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},Re={class:"grid gap-6 md:grid-cols-2"},We={class:"space-y-4"},Ze={key:0,class:"text-sm text-destructive mt-1"},Xe={key:0,class:"text-sm text-destructive mt-1"},Je={key:0,class:"text-sm text-destructive mt-1"},Ke={class:"space-y-4"},Qe={key:0,class:"text-sm text-destructive mt-1"},Ye={key:1,class:"text-sm text-destructive mt-1"},eo={key:0,class:"text-sm text-destructive mt-1"},oo={key:1,class:"text-sm text-destructive mt-1"},ao={class:"flex items-center space-x-2"},to={key:0,class:"space-y-2"},so={class:"flex justify-between"},io={class:"flex gap-2"},lo={class:"flex justify-between"},ro={class:"flex gap-2"},no={class:"space-y-4"},uo={class:"space-y-2"},co={class:"flex gap-4"},fo={class:"flex-1"},mo={class:"flex items-center gap-2"},po={key:0,class:"text-center py-6 text-muted-foreground"},vo={key:1,class:"space-y-3"},_o=["onClick"],go={class:"flex items-center gap-3"},bo={class:"font-medium text-sm"},xo={class:"text-xs text-muted-foreground"},yo={class:"flex items-center gap-2"},ho={key:0,class:"text-xs text-muted-foreground"},Vo={key:0},ko={key:1,class:"text-xs text-muted-foreground"},wo={key:0,class:"text-center py-8 text-muted-foreground"},$o={key:1,class:"space-y-2"},Co={class:"font-medium"},So={class:"text-sm text-muted-foreground"},Eo={class:"flex justify-between"},ma=ce({__name:"Form",props:{categorias:{},votacion:{},cargos:{},periodosElectorales:{},convocatorias:{}},setup(K){var oe;const f=K,m=k(()=>!!f.votacion),G=k(()=>{var l;return m.value&&((l=f.votacion)==null?void 0:l.estado)==="borrador"}),v=[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:m.value?"Editar":"Crear",href:"#"}],O=()=>{if(!f.votacion)return{titulo:"",descripcion:"",categoria_id:"",fecha_inicio:null,fecha_fin:null,estado:"borrador",resultados_publicos:!1,fecha_publicacion_resultados:null,formulario_config:[],timezone:"America/Bogota",territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[]};const l=f.votacion;return{titulo:l.titulo||"",descripcion:l.descripcion||"",categoria_id:l.categoria_id?String(l.categoria_id):"",fecha_inicio:l.fecha_inicio||null,fecha_fin:l.fecha_fin||null,estado:l.estado||"borrador",resultados_publicos:!!l.resultados_publicos,fecha_publicacion_resultados:l.fecha_publicacion_resultados||null,formulario_config:l.formulario_config||[],timezone:l.timezone||"America/Bogota",territorios_ids:l.territorios_ids||[],departamentos_ids:l.departamentos_ids||[],municipios_ids:l.municipios_ids||[],localidades_ids:l.localidades_ids||[]}},t=he(O()),h=x("basicos"),fe=[{value:"borrador",label:"Borrador"},{value:"activa",label:"Activa"},{value:"finalizada",label:"Finalizada"}],Q=k({get:()=>({territorios_ids:t.territorios_ids||[],departamentos_ids:t.departamentos_ids||[],municipios_ids:t.municipios_ids||[],localidades_ids:t.localidades_ids||[]}),set:l=>{t.territorios_ids=l.territorios_ids,t.departamentos_ids=l.departamentos_ids,t.municipios_ids=l.municipios_ids,t.localidades_ids=l.localidades_ids}}),Y=k(()=>t.fecha_inicio&&t.fecha_inicio<new Date?"La fecha de inicio debe ser posterior a la fecha actual":""),ee=k(()=>!t.fecha_fin||!t.fecha_inicio?"":t.fecha_fin<=t.fecha_inicio?"La fecha de fin debe ser posterior a la fecha de inicio":""),R=()=>{if(!E.value){h.value="basicos",alert('Por favor completa todos los campos requeridos en la pestaña "Datos Básicos" antes de crear la votación.');return}if(t.formulario_config.length===0){alert("Por favor agrega al menos un campo al formulario antes de crear la votación.");return}m.value?t.put(`/admin/votaciones/${f.votacion.id}`,{onError:l=>{const e=Object.values(l)[0];e&&alert(`Error: ${Array.isArray(e)?e[0]:e}`)}}):t.post("/admin/votaciones",{onError:l=>{const e=Object.values(l)[0];e&&alert(`Error: ${Array.isArray(e)?e[0]:e}`)}})},E=k(()=>t.titulo&&t.categoria_id&&t.fecha_inicio&&t.fecha_fin&&t.timezone);k(()=>E.value&&t.formulario_config.length>0);const A=x(null),j=x(""),$=x(((oe=f.votacion)==null?void 0:oe.votantes)||[]),W=x([]),V=x("");x("");const U=x([]),me=async()=>{var l;if(!(!m.value||!((l=f.votacion)!=null&&l.id)))try{const e=await fetch(`/admin/votaciones/${f.votacion.id}/imports/recent`);if(e.ok){const s=await e.json();U.value=s}}catch(e){console.error("Error loading recent imports:",e)}},pe=l=>{C.get(`/admin/imports/${l}`)},ve=()=>{var l;(l=f.votacion)!=null&&l.id&&C.get(`/admin/votaciones/${f.votacion.id}/imports`)},I=l=>{switch(l){case"pending":return{icon:ue,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:ue,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:Be,label:"Completada",class:"text-green-600"};case"failed":return{icon:Ie,label:"Fallida",class:"text-red-600"}}},_e=l=>new Date(l).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),B=async()=>{var l;if(!(!m.value||!((l=f.votacion)!=null&&l.id)))try{const s=await(await fetch(`/admin/votaciones/${f.votacion.id}/votantes`)).json();W.value=s.votantes_disponibles||[]}catch(e){console.error("Error loading votantes disponibles:",e)}},ge=()=>{var l;!V.value||!m.value||!((l=f.votacion)!=null&&l.id)||C.post(`/admin/votaciones/${f.votacion.id}/votantes`,{votante_ids:[V.value]},{preserveScroll:!0,onSuccess:()=>{B();const e=W.value.find(s=>s.id.toString()===V.value);e&&$.value.push(e),V.value=""},onError:e=>{console.error("Error adding votante:",e),alert("Error al agregar votante")}})},be=l=>{var e;!m.value||!((e=f.votacion)!=null&&e.id)||C.delete(`/admin/votaciones/${f.votacion.id}/votantes`,{data:{votante_id:l},preserveScroll:!0,onSuccess:()=>{$.value=$.value.filter(s=>s.id!==l),B()},onError:s=>{console.error("Error removing votante:",s),alert("Error al remover votante")}})},xe=l=>{const e=l.target;e.files&&e.files[0]&&(A.value=e.files[0])},z=x(!1),ye=()=>{var e;if(!A.value||!m.value||!((e=f.votacion)!=null&&e.id))return;z.value=!0;const l=new FormData;l.append("csv_file",A.value),l.append("motivo",j.value),C.post(`/admin/votaciones/${f.votacion.id}/importar-votantes`,l,{preserveScroll:!0,onSuccess:s=>{var ae;z.value=!1,A.value=null,j.value="";const _=document.querySelector('input[type="file"]');_&&(_.value=""),B(),(ae=f.votacion)!=null&&ae.id&&C.get(`/admin/votaciones/${f.votacion.id}/edit`,{},{preserveScroll:!0,preserveState:!1,only:["votacion"]})},onError:s=>{z.value=!1,console.error("Error processing CSV:",s);const _=Object.values(s).flat().join(", ");alert(`Error al procesar archivo: ${_}`)}})};return te(()=>f.votacion,l=>{if(l){const e=O();t.titulo=e.titulo,t.descripcion=e.descripcion,t.categoria_id=e.categoria_id,t.fecha_inicio=e.fecha_inicio,t.fecha_fin=e.fecha_fin,t.estado=e.estado,t.resultados_publicos=e.resultados_publicos,t.fecha_publicacion_resultados=e.fecha_publicacion_resultados,t.formulario_config=e.formulario_config,t.timezone=e.timezone,m.value&&(B(),me())}},{immediate:!0,deep:!0}),te(()=>t.resultados_publicos,l=>{console.log("resultados_publicos changed to:",l)},{immediate:!0}),Ve(()=>{}),(l,e)=>(n(),c(w,null,[a(o(ke),{title:m.value?"Editar Votación":"Nueva Votación"},null,8,["title"]),a(Se,{breadcrumbs:v},{default:i(()=>[r("div",Le,[r("div",He,[r("div",null,[r("h1",Me,u(m.value?"Editar Votación":"Nueva Votación"),1),r("p",Ge,u(m.value?"Modifica los datos de la votación":"Crea una nueva votación paso a paso"),1)])]),r("div",Oe,[a(o(F),{class:"border-0 shadow-none h-full"},{default:i(()=>[a(o(D),{class:"p-6"},{default:i(()=>[a(o(Ae),{modelValue:h.value,"onUpdate:modelValue":e[17]||(e[17]=s=>h.value=s),class:"w-full"},{default:i(()=>[a(o(je),{class:"grid w-full grid-cols-3"},{default:i(()=>[a(o(Z),{value:"basicos"},{default:i(()=>e[18]||(e[18]=[r("span",{class:"flex items-center gap-2"},[r("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"1"),d(" Datos Básicos ")],-1)])),_:1}),a(o(Z),{value:"formulario",disabled:!m.value&&!E.value},{default:i(()=>e[19]||(e[19]=[r("span",{class:"flex items-center gap-2"},[r("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"2"),d(" Formulario ")],-1)])),_:1},8,["disabled"]),a(o(Z),{value:"votantes",disabled:!m.value},{default:i(()=>e[20]||(e[20]=[r("span",{class:"flex items-center gap-2"},[r("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"3"),d(" Votantes ")],-1)])),_:1},8,["disabled"])]),_:1}),a(o(X),{value:"basicos",class:"space-y-6"},{default:i(()=>[r("div",Re,[r("div",We,[r("div",null,[a(o(b),{for:"titulo"},{default:i(()=>e[21]||(e[21]=[d("Título *")])),_:1}),a(o(ie),{id:"titulo",modelValue:o(t).titulo,"onUpdate:modelValue":e[0]||(e[0]=s=>o(t).titulo=s),placeholder:"Nombre de la votación",error:o(t).errors.titulo},null,8,["modelValue","error"]),o(t).errors.titulo?(n(),c("p",Ze,u(o(t).errors.titulo),1)):p("",!0)]),r("div",null,[a(o(b),{for:"descripcion"},{default:i(()=>e[22]||(e[22]=[d("Descripción")])),_:1}),a(o(le),{id:"descripcion",modelValue:o(t).descripcion,"onUpdate:modelValue":e[1]||(e[1]=s=>o(t).descripcion=s),placeholder:"Descripción detallada de la votación",rows:"4"},null,8,["modelValue"]),o(t).errors.descripcion?(n(),c("p",Xe,u(o(t).errors.descripcion),1)):p("",!0)]),r("div",null,[a(o(b),{for:"categoria"},{default:i(()=>e[23]||(e[23]=[d("Categoría *")])),_:1}),a(o(T),{modelValue:o(t).categoria_id,"onUpdate:modelValue":e[2]||(e[2]=s=>o(t).categoria_id=s)},{default:i(()=>[a(o(q),null,{default:i(()=>[a(o(L),{placeholder:"Seleccionar categoría"})]),_:1}),a(o(H),null,{default:i(()=>[(n(!0),c(w,null,S(l.categorias,s=>(n(),y(o(M),{key:s.id,value:s.id.toString()},{default:i(()=>[d(u(s.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),o(t).errors.categoria_id?(n(),c("p",Je,u(o(t).errors.categoria_id),1)):p("",!0)]),a(Fe,{modelValue:Q.value,"onUpdate:modelValue":e[3]||(e[3]=s=>Q.value=s)},null,8,["modelValue"])]),r("div",Ke,[r("div",null,[a(o(b),{for:"fecha_inicio"},{default:i(()=>e[24]||(e[24]=[d("Fecha y Hora de Inicio *")])),_:1}),a(o(J),{modelValue:o(t).fecha_inicio,"onUpdate:modelValue":e[4]||(e[4]=s=>o(t).fecha_inicio=s),placeholder:"Seleccionar fecha y hora de inicio"},null,8,["modelValue"]),Y.value?(n(),c("p",Qe,u(Y.value),1)):p("",!0),o(t).errors.fecha_inicio?(n(),c("p",Ye,u(o(t).errors.fecha_inicio),1)):p("",!0)]),r("div",null,[a(o(b),{for:"fecha_fin"},{default:i(()=>e[25]||(e[25]=[d("Fecha y Hora de Fin *")])),_:1}),a(o(J),{modelValue:o(t).fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=s=>o(t).fecha_fin=s),placeholder:"Seleccionar fecha y hora de fin"},null,8,["modelValue"]),ee.value?(n(),c("p",eo,u(ee.value),1)):p("",!0),o(t).errors.fecha_fin?(n(),c("p",oo,u(o(t).errors.fecha_fin),1)):p("",!0)]),r("div",null,[a(o(b),{for:"estado"},{default:i(()=>e[26]||(e[26]=[d("Estado")])),_:1}),a(o(T),{modelValue:o(t).estado,"onUpdate:modelValue":e[6]||(e[6]=s=>o(t).estado=s)},{default:i(()=>[a(o(q),null,{default:i(()=>[a(o(L))]),_:1}),a(o(H),null,{default:i(()=>[(n(),c(w,null,S(fe,s=>a(o(M),{key:s.value,value:s.value},{default:i(()=>[d(u(s.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),a(qe,{modelValue:o(t).timezone,"onUpdate:modelValue":e[7]||(e[7]=s=>o(t).timezone=s),required:"",error:o(t).errors.timezone},null,8,["modelValue","error"]),r("div",ao,[a(o(Ee),{id:"resultados_publicos",checked:o(t).resultados_publicos,"onUpdate:checked":e[8]||(e[8]=s=>o(t).resultados_publicos=s)},null,8,["checked"]),a(o(b),{for:"resultados_publicos"},{default:i(()=>e[27]||(e[27]=[d(" Resultados públicos ")])),_:1})]),a(we,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:i(()=>[o(t).resultados_publicos?(n(),c("div",to,[a(o(b),{for:"fecha_publicacion_resultados"},{default:i(()=>e[28]||(e[28]=[d(" Fecha de publicación de resultados (opcional) ")])),_:1}),a(o(J),{id:"fecha_publicacion_resultados",modelValue:o(t).fecha_publicacion_resultados,"onUpdate:modelValue":e[9]||(e[9]=s=>o(t).fecha_publicacion_resultados=s),placeholder:"Dejar vacío para publicar al finalizar la votación"},null,8,["modelValue"]),e[29]||(e[29]=r("p",{class:"text-xs text-muted-foreground"}," Si se especifica una fecha, los resultados serán visibles desde esa fecha. Si se deja vacío, los resultados solo serán visibles después de que termine la votación. ",-1))])):p("",!0)]),_:1})])]),r("div",so,[e[31]||(e[31]=r("div",null,null,-1)),r("div",io,[m.value?(n(),y(o(g),{key:0,onClick:R,disabled:o(t).processing||!E.value,variant:"default"},{default:i(()=>[d(u(o(t).processing?"Actualizando...":"Actualizar Votación"),1)]),_:1},8,["disabled"])):p("",!0),a(o(g),{onClick:e[10]||(e[10]=s=>h.value="formulario"),disabled:!E.value,variant:"outline"},{default:i(()=>e[30]||(e[30]=[d(" Siguiente: Configurar Formulario ")])),_:1},8,["disabled"])])])]),_:1}),a(o(X),{value:"formulario",class:"space-y-6"},{default:i(()=>{var s;return[a(De,{modelValue:o(t).formulario_config,"onUpdate:modelValue":e[11]||(e[11]=_=>o(t).formulario_config=_),title:"Constructor de Formulario",description:"Agrega los campos que aparecerán en la votación","show-perfil-candidatura-config":!0,"show-convocatoria-config":!0,cargos:((s=f.cargos)==null?void 0:s.filter(_=>_.es_cargo))||[],"periodos-electorales":f.periodosElectorales||[],convocatorias:f.convocatorias||[],context:"votacion"},null,8,["modelValue","cargos","periodos-electorales","convocatorias"]),r("div",lo,[a(o(g),{variant:"outline",onClick:e[12]||(e[12]=_=>h.value="basicos")},{default:i(()=>e[32]||(e[32]=[d(" Anterior ")])),_:1}),r("div",ro,[G.value?(n(),y(o(g),{key:0,variant:"outline",onClick:e[13]||(e[13]=_=>h.value="votantes"),disabled:o(t).formulario_config.length===0},{default:i(()=>e[33]||(e[33]=[d(" Siguiente: Gestionar Votantes ")])),_:1},8,["disabled"])):p("",!0),a(o(g),{onClick:R,disabled:o(t).processing||o(t).formulario_config.length===0},{default:i(()=>[d(u(o(t).processing?"Guardando...":m.value?"Actualizar":"Crear")+" Votación ",1)]),_:1},8,["disabled"])])])]}),_:1}),a(o(X),{value:"votantes",class:"space-y-6"},{default:i(()=>[e[46]||(e[46]=r("div",null,[r("h3",{class:"text-lg font-semibold"},"Gestión de Votantes"),r("p",{class:"text-sm text-muted-foreground"}," Asigna los usuarios que podrán participar en esta votación ")],-1)),a(o(F),null,{default:i(()=>[a(o(N),null,{default:i(()=>[a(o(P),{class:"flex items-center gap-2"},{default:i(()=>[a(o(re),{class:"h-5 w-5"}),e[34]||(e[34]=d(" Importar Votantes "))]),_:1})]),_:1}),a(o(D),null,{default:i(()=>[r("div",no,[e[36]||(e[36]=r("p",{class:"text-sm text-muted-foreground"}," Sube un archivo CSV con los datos de los votantes. El archivo debe contener las columnas: nombre, email, documento_identidad, territorio_id, departamento_id, municipio_id ",-1)),e[37]||(e[37]=r("p",{class:"text-sm text-blue-600"},[r("a",{href:"/ejemplo-votantes.csv",download:"",class:"underline"}," 📥 Descargar ejemplo de formato CSV ")],-1)),r("div",uo,[a(o(b),{for:"motivo-importacion"},{default:i(()=>e[35]||(e[35]=[d("Motivo de la importación")])),_:1}),a(o(le),{id:"motivo-importacion",modelValue:j.value,"onUpdate:modelValue":e[14]||(e[14]=s=>j.value=s),placeholder:"Describe el motivo por el cual se están importando estos votantes...",rows:"3",class:"resize-none"},null,8,["modelValue"])]),a(o(ie),{type:"file",accept:".csv",onChange:xe}),a(o(g),{variant:"outline",disabled:!A.value||!j.value.trim()||z.value,onClick:ye},{default:i(()=>[a(o(re),{class:"mr-2 h-4 w-4"}),d(" "+u(z.value?"Procesando...":"Procesar Archivo"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1}),m.value?(n(),y(o(F),{key:0},{default:i(()=>[a(o(N),null,{default:i(()=>[a(o(P),{class:"flex items-center gap-2"},{default:i(()=>[a(o(ne),{class:"h-5 w-5"}),e[38]||(e[38]=d(" Agregar Votante "))]),_:1})]),_:1}),a(o(D),null,{default:i(()=>[r("div",co,[r("div",fo,[a(o(T),{modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=s=>V.value=s)},{default:i(()=>[a(o(q),null,{default:i(()=>[a(o(L),{placeholder:"Seleccionar usuario..."})]),_:1}),a(o(H),null,{default:i(()=>[(n(!0),c(w,null,S(W.value,s=>(n(),y(o(M),{key:s.id,value:s.id.toString()},{default:i(()=>[d(u(s.name)+" ("+u(s.email)+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),a(o(g),{onClick:ge,disabled:!V.value},{default:i(()=>[a(o(ne),{class:"mr-2 h-4 w-4"}),e[39]||(e[39]=d(" Agregar "))]),_:1},8,["disabled"])])]),_:1})]),_:1})):p("",!0),m.value?(n(),y(o(F),{key:1},{default:i(()=>[a(o(N),null,{default:i(()=>[a(o(P),{class:"flex items-center justify-between"},{default:i(()=>[r("span",mo,[a(o(de),{class:"h-5 w-5"}),e[40]||(e[40]=d(" Historial de Importaciones "))]),U.value.length>0?(n(),y(o(g),{key:0,variant:"outline",size:"sm",onClick:ve},{default:i(()=>e[41]||(e[41]=[d(" Ver Todas ")])),_:1})):p("",!0)]),_:1})]),_:1}),a(o(D),null,{default:i(()=>[U.value.length===0?(n(),c("div",po,[a(o(de),{class:"mx-auto h-8 w-8 mb-2"}),e[42]||(e[42]=r("p",null,"No hay importaciones registradas",-1)),e[43]||(e[43]=r("p",{class:"text-sm"},"Las importaciones aparecerán aquí una vez que subas archivos CSV",-1))])):(n(),c("div",vo,[(n(!0),c(w,null,S(U.value,s=>(n(),c("div",{key:s.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:_=>pe(s.id)},[r("div",go,[(n(),y($e(I(s.status).icon),{class:se(["h-4 w-4",I(s.status).class])},null,8,["class"])),r("div",null,[r("p",bo,u(s.original_filename),1),r("p",xo," Por "+u(s.created_by.name)+" • "+u(_e(s.created_at)),1)])]),r("div",yo,[a(o(Ce),{variant:"outline",class:se(I(s.status).class)},{default:i(()=>[d(u(I(s.status).label),1)]),_:2},1032,["class"]),s.status==="completed"?(n(),c("div",ho,[d(u(s.successful_rows)+" exitosos ",1),s.failed_rows>0?(n(),c("span",Vo,", "+u(s.failed_rows)+" errores",1)):p("",!0)])):s.status==="processing"?(n(),c("div",ko,u(s.progress_percentage)+"% ",1)):p("",!0)])],8,_o))),128))]))]),_:1})]),_:1})):p("",!0),a(o(F),null,{default:i(()=>[a(o(N),null,{default:i(()=>[a(o(P),null,{default:i(()=>[d("Votantes Asignados ("+u($.value.length)+")",1)]),_:1})]),_:1}),a(o(D),null,{default:i(()=>[$.value.length===0?(n(),c("div",wo,e[44]||(e[44]=[r("p",null,"No hay votantes asignados a esta votación",-1),r("p",{class:"text-sm"},"Importa un archivo CSV o agrega votantes manualmente",-1)]))):(n(),c("div",$o,[(n(!0),c(w,null,S($.value,s=>(n(),c("div",{key:s.id,class:"flex items-center justify-between p-3 border rounded-lg"},[r("div",null,[r("p",Co,u(s.name),1),r("p",So,u(s.email),1)]),a(o(g),{variant:"ghost",size:"sm",onClick:_=>be(s.id)},{default:i(()=>[a(o(Ue),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick"])]))),128))]))]),_:1})]),_:1}),r("div",Eo,[a(o(g),{variant:"outline",onClick:e[16]||(e[16]=s=>h.value="formulario")},{default:i(()=>e[45]||(e[45]=[d(" Anterior ")])),_:1}),a(o(g),{onClick:R,disabled:o(t).processing},{default:i(()=>[d(u(o(t).processing?"Guardando...":"Actualizar")+" Votación ",1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])])]),_:1})],64))}});export{ma as default};
