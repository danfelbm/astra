import{d as Ue,C as je,r as _,c as S,m as J,o as Ie,y as Ne,D as Re,b as g,e as l,w as r,f as s,g as i,u as t,p as Te,h as d,t as p,i as u,j as y,l as Oe,F as j,k as I,q as ze,a2 as de,W as K}from"./app-CbA_dzrH.js";import{_ as Ge}from"./UserLayout.vue_vue_type_script_setup_true_lang-C0kuRXSj.js";import{_ as N,a as R,b as T,c as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dpl1EP6e.js";import{_ as Q}from"./CardDescription.vue_vue_type_script_setup_true_lang-FdnBhRW4.js";import{_ as f}from"./createLucideIcon-0y3HvBb2.js";import{_ as z}from"./Label.vue_vue_type_script_setup_true_lang-BHOcaT7W.js";import{_ as Le}from"./Textarea.vue_vue_type_script_setup_true_lang-DNuak2_2.js";import{_ as ce,a as ue,b as ve,c as me,d as pe}from"./SelectValue.vue_vue_type_script_setup_true_lang-C7VbuHoF.js";import{_ as We}from"./Checkbox.vue_vue_type_script_setup_true_lang-mf8fWrST.js";import{u as qe,_ as Pe}from"./FileUploadField.vue_vue_type_script_setup_true_lang-BS4pHahu.js";import{u as He}from"./useAutoSave-BhCs4tUl.js";import{t as h}from"./index-CXCj42Z3.js";import{F as Y}from"./file-text-DINmkRZl.js";import{M as fe}from"./music-B9Y123UW.js";import{V as G}from"./video-DOuG9gQV.js";import{I as Xe}from"./image-DImE3ow8.js";import{A as Je}from"./arrow-left-DWk22nOp.js";import{C as _e}from"./clock-Bx6DQ-_s.js";import{C as ge}from"./circle-check-big-CTzKScww.js";import{C as Ke}from"./circle-alert-CfNQ3Vlu.js";import{X as he}from"./x-CxSWfWOJ.js";import{C as be}from"./camera-COQ6A8Gl.js";import{M as Z}from"./mic-D4RSqVTl.js";import{S as Qe}from"./save-CybCtRtH.js";import{U as Ye}from"./upload-D1gsNalI.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C4x6rJ8B.js";import"./index-D-PGeZ3t.js";import"./floating-ui.vue-D3EH1Xba.js";import"./Input.vue_vue_type_script_setup_true_lang-Dw2oMjuZ.js";import"./index-DzUkqZxm.js";import"./index-BGfSt6nP.js";import"./shield-yBic2gp-.js";import"./user-BnDczykq.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-H44qAxpr.js";import"./chevron-right-pq_ChJ0s.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-H8FdC1v8.js";import"./VisuallyHidden-BOU54Fpc.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-fWHHAQt9.js";import"./map-pin-B0r5dLQM.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BZUuILpY.js";import"./square-check-big-CDgrQbfI.js";import"./users-DLZP89St.js";import"./folder-open-B03CPFE8.js";import"./index-DPtKDKxs.js";import"./check-8t2yOxAa.js";import"./nullish-CHIgUVhi.js";import"./file-Dr1J4OKH.js";import"./eye-CuQC-PD5.js";import"./download-B_RhEBu7.js";import"./debounce-BMmXVQ06.js";const Ze={class:"space-y-6"},et={class:"flex justify-between items-start"},tt={class:"text-muted-foreground"},ot={class:"flex items-center gap-2"},st={key:0,class:"flex items-center text-sm text-muted-foreground"},it={key:1,class:"flex items-center text-sm text-green-600"},at={key:2,class:"flex items-center text-sm text-red-600"},rt={class:"grid gap-6 lg:grid-cols-3"},nt={class:"lg:col-span-2 space-y-6"},lt={class:"space-y-4"},dt={key:0,class:"p-3 bg-muted/30 rounded-lg"},ct={class:"text-sm text-muted-foreground"},ut={key:0,class:"space-y-4"},vt={class:"relative bg-muted/30 rounded-lg p-4"},mt={key:0,class:"text-center"},pt=["src"],ft={key:1,class:"text-center"},_t=["src"],gt={key:2,class:"flex flex-col items-center gap-4"},ht=["src"],bt={key:3,class:"flex items-center justify-center gap-4 py-8"},xt={class:"text-center"},yt={class:"font-medium"},kt={class:"text-sm text-muted-foreground text-center"},wt={key:1,class:"space-y-4"},Ct={class:"grid grid-cols-3 gap-3"},$t={class:"space-y-6"},Et={class:"space-y-3"},St={key:0,class:"text-sm text-muted-foreground"},Vt={key:1},At={class:"flex-1"},Bt={class:"text-xs text-muted-foreground"},Dt={class:"text-sm"},Ft={class:"text-sm"},Mt={class:"text-sm"},Ut={key:0},jt={class:"text-sm font-medium text-muted-foreground"},It={class:"space-y-1"},Nt={key:0,class:"fixed bottom-0 left-0 right-0 bg-background border-t border-border shadow-lg z-50"},Rt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Tt={class:"flex items-center justify-between py-4"},Ot={class:"flex items-center gap-4"},zt={key:0,class:"flex items-center text-sm text-muted-foreground"},Gt={key:1,class:"flex items-center text-sm text-green-600"},Lt={class:"flex items-center gap-3"},Wt={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50"},qt={class:"bg-background rounded-lg p-6 max-w-2xl w-full mx-4"},Pt={class:"flex items-center justify-between mb-4"},Ht={class:"text-lg font-semibold"},Xt={class:"space-y-4"},Jt={key:0,class:"relative"},Kt={key:1,class:"flex items-center justify-center gap-2 text-red-600"},Qt={class:"font-mono"},Yt={class:"flex justify-center gap-3"},Ko=Ue({__name:"Edit",props:{contrato:{},evidencia:{},obligaciones:{},entregables:{},tiposEvidencia:{}},setup(xe){var le;const c=xe,ye=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Contratos",href:"/miembro/mis-contratos"},{title:c.contrato.nombre,href:`/miembro/mis-contratos/${c.contrato.id}`},{title:"Evidencias",href:`/miembro/mis-contratos/${c.contrato.id}/evidencias`},{title:"Editar Evidencia",href:"#"}],{uploadFiles:ke}=qe(),o=je({obligacion_id:c.evidencia.obligacion_id,tipo_evidencia:c.evidencia.tipo_evidencia,archivo_path:c.evidencia.archivo_path,archivo_nombre:c.evidencia.archivo_nombre,archivos_paths:c.evidencia.archivos_paths||(c.evidencia.archivo_path?[c.evidencia.archivo_path]:[]),archivos_nombres:c.evidencia.archivos_nombres||(c.evidencia.archivo_nombre?[c.evidencia.archivo_nombre]:[]),descripcion:c.evidencia.descripcion||"",entregable_ids:((le=c.evidencia.entregables)==null?void 0:le.map(a=>a.id))||[],metadata:c.evidencia.metadata||null}),C=_(c.evidencia.archivos_paths||(c.evidencia.archivo_path?[c.evidencia.archivo_path]:[])),ee=_(!1),k=_("idle"),B=_(!1),D=_(null),$=_(null),L=_(!1),v=_("photo");let w=null,E=null;const W=_([]),b=_(!1),F=_(0);let M=null;const q=S(()=>c.obligaciones.find(a=>a.id===o.obligacion_id)),te=S(()=>c.entregables.filter(a=>a.estado!=="completado")),P=S(()=>c.entregables.filter(a=>o.entregable_ids.includes(a.id))),oe=S(()=>o.obligacion_id&&o.tipo_evidencia&&!o.processing),we=S(()=>({imagen:Xe,video:G,audio:fe,documento:Y})[o.tipo_evidencia||"documento"]||Y),U=S(()=>$.value?URL.createObjectURL($.value):c.evidencia.archivo_url),Ce=S(()=>o.data()),{startAutoSave:$e,stopAutoSave:se}=He(Ce,a=>K.post(route("user.mis-contratos.evidencias.autosave",c.contrato.id),a,{preserveScroll:!0,preserveState:!0,only:[]}));J(()=>o.data(),()=>{B.value=o.isDirty},{deep:!0}),J(()=>o.tipo_evidencia,(a,e)=>{if(e&&a&&a!==e){if((o.archivos_paths.length>0||o.archivo_path||D.value||$.value||C.value.length>0)&&!confirm(`¿Estás seguro de cambiar el tipo de evidencia? Se perderán los archivos seleccionados para "${e}".`)){o.tipo_evidencia=e;return}o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,D.value=null,$.value=null,C.value=[],h.info(`Tipo de evidencia cambiado a "${a}". Archivos limpiados.`)}});const Ee=()=>{ee.value=B.value||o.processing},Se=async a=>{if(a.length>0){const e=o.archivos_paths.length,x=a.length;if(e+x>10){h.error(`No puedes subir más de 10 archivos. Actualmente tienes ${e} archivo(s).`);return}if(!o.tipo_evidencia){const n=a[0];n.type.startsWith("image/")?o.tipo_evidencia="imagen":n.type.startsWith("video/")?o.tipo_evidencia="video":n.type.startsWith("audio/")?o.tipo_evidencia="audio":o.tipo_evidencia="documento"}try{h.info(`Subiendo ${a.length} archivo(s)...`);const n=await ke(a,{module:"evidencias",fieldId:o.tipo_evidencia||"archivo",onProgress:(m,V)=>{}});if(n.length>0){const m=[...o.archivos_paths,...n.map(X=>X.path)],V=[...o.archivos_nombres,...n.map(X=>X.name)];o.archivos_paths=m,o.archivos_nombres=V,!o.archivo_path&&m.length>0&&(o.archivo_path=m[0],o.archivo_nombre=V[0],o.metadata=n[0].metadata),C.value=m,h.success(`${n.length} archivo(s) subido(s) exitosamente. Total: ${m.length}/10`)}}catch(n){console.error("Error al subir archivos:",n),h.error("Error al subir archivos")}}else D.value=null,o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,C.value=[]},Ve=()=>{D.value=null,$.value=null,o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,C.value=[]},H=a=>{v.value=a,L.value=!0,Ae()},Ae=async()=>{try{const a={video:v.value==="photo"||v.value==="video",audio:v.value==="video"||v.value==="audio"};if(E=await navigator.mediaDevices.getUserMedia(a),v.value==="photo"||v.value==="video"){const e=document.getElementById("captureVideo");e&&(e.srcObject=E)}}catch(a){console.error("Error accessing media devices:",a),h.error("No se pudo acceder a la cámara/micrófono"),A()}},Be=()=>{const a=document.getElementById("captureVideo"),e=document.createElement("canvas");e.width=a.videoWidth,e.height=a.videoHeight;const x=e.getContext("2d");x&&(x.drawImage(a,0,0),e.toBlob(n=>{n&&($.value=n,o.archivo_nombre=`foto_${Date.now()}.jpg`,o.tipo_evidencia="imagen",A())},"image/jpeg",.8))},ie=()=>{E&&(W.value=[],w=new MediaRecorder(E),w.ondataavailable=a=>{a.data.size>0&&W.value.push(a.data)},w.onstop=()=>{const a=new Blob(W.value,{type:v.value==="video"?"video/webm":"audio/webm"});$.value=a;const e=(v.value==="video","webm");o.archivo_nombre=`${v.value}_${Date.now()}.${e}`,o.tipo_evidencia=v.value,re(),A()},w.start(),b.value=!0,De())},ae=()=>{w&&b.value&&(w.stop(),b.value=!1)},De=()=>{F.value=0,M=setInterval(()=>{F.value+=1},1e3)},re=()=>{M&&(clearInterval(M),M=null),F.value=0},A=()=>{L.value=!1,E&&(E.getTracks().forEach(a=>a.stop()),E=null),w&&(w=null),re(),b.value=!1},Fe=a=>{const e=Math.floor(a/60),x=a%60;return`${e.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`},ne=async()=>{if(oe.value){if(o.archivos_paths.length===0&&!o.archivo_path){h.error("Por favor seleccione o capture al menos un archivo");return}o.put(route("user.mis-contratos.evidencias.update",[c.contrato.id,c.evidencia.id]),{onSuccess:()=>{h.success(`Evidencia actualizada exitosamente con ${o.archivos_paths.length} archivo(s)`),B.value=!1,se()},onError:a=>{console.error("Errores:",a),h.error("Error al actualizar la evidencia")}})}},Me=()=>{K.post(route("user.mis-contratos.evidencias.autosave",c.contrato.id),o.data(),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{h.success("Borrador guardado"),k.value="saved",setTimeout(()=>{k.value="idle"},2e3)},onError:()=>{h.error("Error al guardar borrador"),k.value="error"}})};return Ie(()=>{J(()=>B.value,Ee,{immediate:!0}),$e()}),Ne(()=>{se(),A()}),(a,e)=>{const x=Re("Link");return l(),g(Ge,{breadcrumbs:ye},{default:r(()=>[s(t(Te),{title:"Editar Evidencia"}),i("div",Ze,[i("div",et,[i("div",null,[s(x,{href:a.route("user.mis-contratos.evidencias.show",[a.contrato.id,a.evidencia.id]),class:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-2"},{default:r(()=>[s(t(Je),{class:"w-4 h-4 mr-2"}),e[8]||(e[8]=d(" Volver a Ver Evidencia ",-1))]),_:1},8,["href"]),e[10]||(e[10]=i("h2",{class:"text-3xl font-bold tracking-tight"},"Editar Evidencia",-1)),i("p",tt,[e[9]||(e[9]=d(" Modificar evidencia para: ",-1)),i("strong",null,p(a.contrato.nombre),1)])]),i("div",ot,[k.value==="saving"?(l(),u("div",st,[s(t(_e),{class:"w-4 h-4 mr-1 animate-spin"}),e[11]||(e[11]=d(" Guardando... ",-1))])):k.value==="saved"?(l(),u("div",it,[s(t(ge),{class:"w-4 h-4 mr-1"}),e[12]||(e[12]=d(" Guardado ",-1))])):k.value==="error"?(l(),u("div",at,[s(t(Ke),{class:"w-4 h-4 mr-1"}),e[13]||(e[13]=d(" Error al guardar ",-1))])):y("",!0)])]),i("form",{onSubmit:Oe(ne,["prevent"]),class:"space-y-6"},[i("div",rt,[i("div",nt,[s(t(N),null,{default:r(()=>[s(t(R),null,{default:r(()=>[s(t(T),null,{default:r(()=>[...e[14]||(e[14]=[d("Obligación Contractual",-1)])]),_:1}),s(t(Q),null,{default:r(()=>[...e[15]||(e[15]=[d(" Selecciona la obligación a la que corresponde esta evidencia ",-1)])]),_:1})]),_:1}),s(t(O),null,{default:r(()=>{var n;return[i("div",lt,[i("div",null,[s(t(z),{for:"obligacion_id"},{default:r(()=>[...e[16]||(e[16]=[d("Obligación *",-1)])]),_:1}),s(t(ce),{modelValue:t(o).obligacion_id,"onUpdate:modelValue":e[0]||(e[0]=m=>t(o).obligacion_id=m),required:""},{default:r(()=>[s(t(ue),null,{default:r(()=>[s(t(ve),{placeholder:"Seleccionar obligación..."})]),_:1}),s(t(me),null,{default:r(()=>[(l(!0),u(j,null,I(a.obligaciones,m=>(l(),g(t(pe),{key:m.id,value:m.id},{default:r(()=>[d(p(m.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),(n=q.value)!=null&&n.descripcion?(l(),u("div",dt,[i("p",ct,p(q.value.descripcion),1)])):y("",!0)])]}),_:1})]),_:1}),s(t(N),null,{default:r(()=>[s(t(R),null,{default:r(()=>[s(t(T),{class:"flex items-center gap-2"},{default:r(()=>[(l(),g(ze(we.value),{class:"w-5 h-5"})),e[17]||(e[17]=d(" Archivo de Evidencia ",-1))]),_:1}),s(t(Q),null,{default:r(()=>[...e[18]||(e[18]=[d(" Sube un archivo o captura directamente desde tu dispositivo ",-1)])]),_:1})]),_:1}),s(t(O),{class:"space-y-6"},{default:r(()=>[i("div",null,[s(t(z),{for:"tipo_evidencia"},{default:r(()=>[...e[19]||(e[19]=[d("Tipo de Evidencia *",-1)])]),_:1}),s(t(ce),{modelValue:t(o).tipo_evidencia,"onUpdate:modelValue":e[1]||(e[1]=n=>t(o).tipo_evidencia=n),required:""},{default:r(()=>[s(t(ue),null,{default:r(()=>[s(t(ve),{placeholder:"Seleccionar tipo..."})]),_:1}),s(t(me),null,{default:r(()=>[(l(!0),u(j,null,I(a.tiposEvidencia,n=>(l(),g(t(pe),{key:n.value,value:n.value},{default:r(()=>[d(p(n.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),U.value?(l(),u("div",ut,[i("div",vt,[t(o).tipo_evidencia==="imagen"?(l(),u("div",mt,[i("img",{src:U.value,alt:"Vista previa",class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"},null,8,pt)])):t(o).tipo_evidencia==="video"?(l(),u("div",ft,[i("video",{src:U.value,controls:"",class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}," Tu navegador no soporta la reproducción de video. ",8,_t)])):t(o).tipo_evidencia==="audio"?(l(),u("div",gt,[s(t(fe),{class:"w-12 h-12 text-muted-foreground"}),i("audio",{src:U.value,controls:"",class:"w-full max-w-md"}," Tu navegador no soporta la reproducción de audio. ",8,ht)])):(l(),u("div",bt,[s(t(Y),{class:"w-12 h-12 text-muted-foreground"}),i("div",xt,[i("p",yt,p(t(o).archivo_nombre),1),e[20]||(e[20]=i("p",{class:"text-sm text-muted-foreground"},"Documento",-1))])])),s(t(f),{type:"button",onClick:Ve,variant:"destructive",size:"sm",class:"absolute top-2 right-2"},{default:r(()=>[s(t(he),{class:"w-4 h-4"})]),_:1})]),i("p",kt,p(t(o).archivo_nombre),1)])):(l(),u("div",wt,[s(Pe,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=n=>C.value=n),onFilesSelected:Se,label:"",description:`Selecciona archivos desde tu dispositivo (${t(o).archivos_paths.length}/10 archivos)`,accept:t(o).tipo_evidencia?`${t(o).tipo_evidencia}/*`:"*/*","max-file-size":50,multiple:!0,"max-files":10,disabled:t(o).processing,module:"evidencias","field-id":t(o).tipo_evidencia||"archivo","auto-upload":!1},null,8,["modelValue","description","accept","disabled","field-id"]),e[24]||(e[24]=i("div",{class:"text-center"},[i("div",{class:"relative"},[i("div",{class:"absolute inset-0 flex items-center"},[i("span",{class:"w-full border-t"})]),i("div",{class:"relative flex justify-center text-xs uppercase"},[i("span",{class:"bg-background px-2 text-muted-foreground"},"O capturar directamente")])])],-1)),i("div",Ct,[s(t(f),{type:"button",onClick:e[3]||(e[3]=n=>H("photo")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:r(()=>[s(t(be),{class:"w-6 h-6"}),e[21]||(e[21]=i("span",{class:"text-xs"},"Foto",-1))]),_:1}),s(t(f),{type:"button",onClick:e[4]||(e[4]=n=>H("video")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:r(()=>[s(t(G),{class:"w-6 h-6"}),e[22]||(e[22]=i("span",{class:"text-xs"},"Video",-1))]),_:1}),s(t(f),{type:"button",onClick:e[5]||(e[5]=n=>H("audio")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:r(()=>[s(t(Z),{class:"w-6 h-6"}),e[23]||(e[23]=i("span",{class:"text-xs"},"Audio",-1))]),_:1})])])),i("div",null,[s(t(z),{for:"descripcion"},{default:r(()=>[...e[25]||(e[25]=[d("Descripción",-1)])]),_:1}),s(t(Le),{modelValue:t(o).descripcion,"onUpdate:modelValue":e[6]||(e[6]=n=>t(o).descripcion=n),placeholder:"Describe brevemente esta evidencia...",rows:"3"},null,8,["modelValue"])])]),_:1})]),_:1})]),i("div",$t,[s(t(N),null,{default:r(()=>[s(t(R),null,{default:r(()=>[s(t(T),null,{default:r(()=>[...e[26]||(e[26]=[d("Entregables Asociados",-1)])]),_:1}),s(t(Q),null,{default:r(()=>[...e[27]||(e[27]=[d(" Opcional: Asocia esta evidencia con entregables específicos ",-1)])]),_:1})]),_:1}),s(t(O),null,{default:r(()=>[i("div",Et,[te.value.length===0?(l(),u("div",St," No hay entregables disponibles en este proyecto ")):(l(),u("div",Vt,[(l(!0),u(j,null,I(te.value,n=>(l(),u("div",{key:n.id,class:"flex items-start space-x-3"},[s(t(We),{id:`entregable-${n.id}`,checked:t(o).entregable_ids.includes(n.id),"onUpdate:checked":m=>{if(m)t(o).entregable_ids.push(n.id);else{const V=t(o).entregable_ids.indexOf(n.id);V>-1&&t(o).entregable_ids.splice(V,1)}}},null,8,["id","checked","onUpdate:checked"]),i("div",At,[s(t(z),{for:`entregable-${n.id}`,class:"text-sm font-medium cursor-pointer"},{default:r(()=>[d(p(n.nombre),1)]),_:2},1032,["for"]),i("p",Bt,p(n.hito),1)])]))),128))]))])]),_:1})]),_:1}),s(t(N),null,{default:r(()=>[s(t(R),null,{default:r(()=>[s(t(T),null,{default:r(()=>[...e[28]||(e[28]=[d("Resumen",-1)])]),_:1})]),_:1}),s(t(O),{class:"space-y-3"},{default:r(()=>{var n;return[i("div",null,[e[29]||(e[29]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Obligación",-1)),i("p",Dt,p(((n=q.value)==null?void 0:n.nombre)||"No seleccionada"),1)]),i("div",null,[e[30]||(e[30]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Tipo",-1)),i("p",Ft,p(t(o).tipo_evidencia||"No seleccionado"),1)]),i("div",null,[e[31]||(e[31]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Archivo",-1)),i("p",Mt,p(t(o).archivo_nombre||"Ninguno"),1)]),P.value.length>0?(l(),u("div",Ut,[i("p",jt,"Entregables ("+p(P.value.length)+")",1),i("div",It,[(l(!0),u(j,null,I(P.value,m=>(l(),u("p",{key:m.id,class:"text-xs text-muted-foreground"},p(m.nombre),1))),128))])])):y("",!0)]}),_:1})]),_:1})])])],32)]),(l(),g(de,{to:"body"},[ee.value?(l(),u("div",Nt,[i("div",Rt,[i("div",Tt,[i("div",Ot,[s(t(f),{type:"button",onClick:Me,variant:"outline",disabled:t(o).processing},{default:r(()=>[s(t(Qe),{class:"w-4 h-4 mr-2"}),e[32]||(e[32]=d(" Guardar Borrador ",-1))]),_:1},8,["disabled"]),k.value==="saving"?(l(),u("div",zt,[s(t(_e),{class:"w-4 h-4 mr-1 animate-spin"}),e[33]||(e[33]=d(" Autoguardando... ",-1))])):k.value==="saved"?(l(),u("div",Gt,[s(t(ge),{class:"w-4 h-4 mr-1"}),e[34]||(e[34]=d(" Autoguardado ",-1))])):y("",!0)]),i("div",Lt,[s(t(f),{type:"button",onClick:e[7]||(e[7]=n=>t(K).visit(a.route("user.mis-contratos.evidencias.show",[a.contrato.id,a.evidencia.id]))),variant:"outline"},{default:r(()=>[...e[35]||(e[35]=[d(" Cancelar ",-1)])]),_:1}),s(t(f),{type:"button",onClick:ne,disabled:!oe.value,loading:t(o).processing},{default:r(()=>[s(t(Ye),{class:"w-4 h-4 mr-2"}),e[36]||(e[36]=d(" Actualizar Evidencia ",-1))]),_:1},8,["disabled","loading"])])])])])):y("",!0)])),(l(),g(de,{to:"body"},[L.value?(l(),u("div",Wt,[i("div",qt,[i("div",Pt,[i("h3",Ht," Capturar "+p(v.value==="photo"?"Foto":v.value==="video"?"Video":"Audio"),1),s(t(f),{onClick:A,variant:"outline",size:"sm"},{default:r(()=>[s(t(he),{class:"w-4 h-4"})]),_:1})]),i("div",Xt,[v.value==="photo"||v.value==="video"?(l(),u("div",Jt,[...e[37]||(e[37]=[i("video",{id:"captureVideo",autoplay:"",muted:"",class:"w-full rounded-lg bg-black"},null,-1)])])):y("",!0),b.value?(l(),u("div",Kt,[e[38]||(e[38]=i("div",{class:"w-3 h-3 bg-red-600 rounded-full animate-pulse"},null,-1)),i("span",Qt,p(Fe(F.value)),1)])):y("",!0),i("div",Yt,[v.value==="photo"?(l(),g(t(f),{key:0,onClick:Be,class:"flex items-center gap-2"},{default:r(()=>[s(t(be),{class:"w-4 h-4"}),e[39]||(e[39]=d(" Tomar Foto ",-1))]),_:1})):v.value==="video"&&!b.value?(l(),g(t(f),{key:1,onClick:ie,class:"flex items-center gap-2"},{default:r(()=>[s(t(G),{class:"w-4 h-4"}),e[40]||(e[40]=d(" Iniciar Grabación ",-1))]),_:1})):v.value==="video"&&b.value?(l(),g(t(f),{key:2,onClick:ae,variant:"destructive",class:"flex items-center gap-2"},{default:r(()=>[s(t(G),{class:"w-4 h-4"}),e[41]||(e[41]=d(" Detener Grabación ",-1))]),_:1})):v.value==="audio"&&!b.value?(l(),g(t(f),{key:3,onClick:ie,class:"flex items-center gap-2"},{default:r(()=>[s(t(Z),{class:"w-4 h-4"}),e[42]||(e[42]=d(" Iniciar Grabación ",-1))]),_:1})):v.value==="audio"&&b.value?(l(),g(t(f),{key:4,onClick:ae,variant:"destructive",class:"flex items-center gap-2"},{default:r(()=>[s(t(Z),{class:"w-4 h-4"}),e[43]||(e[43]=d(" Detener Grabación ",-1))]),_:1})):y("",!0)])])])])):y("",!0)]))]),_:1})}}});export{Ko as default};
