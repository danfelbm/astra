import{_ as me}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Bs84S9Qo.js";import{r as j,s as E,d as ee,c as U,b as y,w as r,j as p,e as o,f as a,g as s,i as b,h as m,t as d,v as B,n as _,F as L,k as K,m as l,p as fe,q as ye,x as pe}from"./app-DNpYmmNV.js";import{a as D,b as T,c as S,_ as H}from"./CardTitle.vue_vue_type_script_setup_true_lang-nACRIi6D.js";import{_ as te}from"./CardDescription.vue_vue_type_script_setup_true_lang-D8RJ-Eqe.js";import{_ as C}from"./createLucideIcon-BvwuntV9.js";import{_ as A}from"./index-Co6smWvJ.js";import{_ as ae}from"./Progress.vue_vue_type_script_setup_true_lang-CF-p6gT1.js";import{_ as ge,a as ve,b as I,c as M}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-BLfaAIcI.js";import{t as P}from"./index-BPGz7Lz0.js";import{E as xe}from"./EtiquetaDisplay-Qa-jzMQo.js";import{E as he}from"./EtiquetaSelector-DBDSvtqH.js";import{_ as be}from"./ContratosList.vue_vue_type_script_setup_true_lang-Bzu3q4PZ.js";import{M as we,_ as Ee,B as $e,C as ke}from"./EvidenciasDisplay.vue_vue_type_script_setup_true_lang-BLYdXdXl.js";import{_ as qe,a as Ce}from"./ActivityLog.vue_vue_type_script_setup_true_lang-Ddw8_v-j.js";import{L as Se,H as He}from"./HitoCard-DsVU4h8h.js";import{T as X}from"./target-D2SwbN_L.js";import{P as R}from"./plus-BdLNQ0o1.js";import{S as Q}from"./square-pen-CXM-0Dug.js";import{T as Pe}from"./trash-2-BtyG2syV.js";import{I as De}from"./info-4F3bI3AM.js";import{F as W}from"./file-text-9Pj7fAnu.js";import{I as Te}from"./image-DumJy2vb.js";import{A as Ve}from"./activity-BOd-f0R5.js";import{F as Be}from"./flag-BjMbAwJq.js";import{C as Y}from"./calendar-Bm1hJyUL.js";import{C as Ae}from"./clock-BaKbkbsl.js";import{U as Z}from"./user-BvIXQW2G.js";import{C as je}from"./circle-check-big-BnNtX6yB.js";import{C as ze}from"./circle-play-hNoJWl0E.js";import{C as Ie}from"./circle-alert-BF_czd70.js";import"./useFlashMessages-BvJgjt1q.js";import"./index-6v1snxGJ.js";import"./floating-ui.vue-C_mINNRP.js";import"./x-DOiB1ufr.js";import"./Input.vue_vue_type_script_setup_true_lang-emIIddtX.js";import"./index-BHvpWQkh.js";import"./index-BQDSCwpy.js";import"./shield-BMmXjZsb.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DYPENjtU.js";import"./chevron-right-DmWh35XU.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CoAIMTuH.js";import"./VisuallyHidden-BYByuCXk.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-BiR2CDbJ.js";import"./check-C7fRtawA.js";import"./Label.vue_vue_type_script_setup_true_lang-BAQXsEet.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-DzB-v3Ss.js";import"./map-pin-BQt7tkEY.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-jJLEEb4v.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CHfwuFNz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-eaF3oKZC.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Bg7CGLTP.js";import"./tag-BSetiVP3.js";import"./users-CRJAINb7.js";import"./vote-Bbpa9Z9p.js";import"./folder-open-CnyhoSzu.js";import"./send-CukQDgCK.js";import"./briefcase-CwplpqIY.js";import"./megaphone-B618hyXc.js";import"./user-check-Csm15tMP.js";import"./clipboard-list-DeXGQRD-.js";import"./mail-CFBftCTw.js";import"./message-square-Dllvz1OT.js";import"./external-link-VsW9ph7I.js";import"./panel-left-C9lSnPJB.js";import"./index-BBECS_gj.js";import"./RovingFocusItem-DnfPmtCj.js";import"./utils-sF9H3_Mc.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-D3GALeL9.js";import"./layers-BbuxQtt2.js";import"./zap-CByj6xFQ.js";import"./trending-up-BLeEd_zK.js";import"./award-C8_H2q-U.js";import"./hash-CpX7CLUB.js";import"./index-DaeWOr9y.js";import"./search-CnLXLTf6.js";import"./useKbd-kRIii9yh.js";import"./VisuallyHiddenInput-DskRZlkV.js";import"./useEtiquetaHierarchy-p6LzAkPw.js";import"./list-CfEkIKpa.js";import"./tree-pine-BpYSrNTD.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-DZA0FfpX.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-CGTRXLDr.js";import"./useToast-DFTd6Bm0.js";import"./dollar-sign-Bev1efuq.js";import"./ellipsis-CXARoB3U.js";import"./eye-AP8nYXmu.js";import"./download-DqeQiwr6.js";import"./copy-Dk6LvpXs.js";import"./AccordionContent.vue_vue_type_script_setup_true_lang-B5N-TmVK.js";import"./useArrowNavigation-B5rxJs06.js";import"./Textarea.vue_vue_type_script_setup_true_lang-CKBk_YM0.js";import"./filter-DRrKJShH.js";import"./es-BDPlFIsO.js";import"./parseISO-DFjB8F03.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-TOADWDYh.js";import"./calendar-days-D_d02K1J.js";import"./pen-KEUyZOEa.js";function Me(){const e=j(!1),n=j(null);async function z(g,u){return e.value=!0,n.value=null,new Promise((x,w)=>{E.post(`/admin/proyectos/${g}/etiquetas`,{etiqueta_id:u},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,x(!0)},onError:h=>{e.value=!1,n.value=Object.values(h).join(", "),w(h)}})})}async function N(g,u){return e.value=!0,n.value=null,new Promise((x,w)=>{E.delete(`/admin/proyectos/${g}/etiquetas/${u}`,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,x(!0)},onError:h=>{e.value=!1,n.value="Error al quitar la etiqueta",w(h)}})})}async function k(g,u){return e.value=!0,n.value=null,new Promise((x,w)=>{E.put(`/admin/proyectos/${g}/etiquetas/sync`,{etiquetas:u},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,x(!0)},onError:h=>{e.value=!1,n.value="Error al sincronizar etiquetas",w(h)}})})}async function v(g){e.value=!0,n.value=null;try{const u=await fetch(`/admin/proyectos/${g}/etiquetas/suggest`);if(!u.ok)throw new Error("Error al obtener sugerencias");const x=await u.json();return e.value=!1,x.etiquetas||[]}catch(u){return e.value=!1,n.value="Error al obtener sugerencias de etiquetas",console.error(u),[]}}async function f(g){var u;e.value=!0,n.value=null;try{const x=await fetch("/admin/etiquetas",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"))||""},body:JSON.stringify(g)});if(!x.ok){const h=await x.json();throw new Error(h.message||"Error al crear etiqueta")}const w=await x.json();return e.value=!1,w.data}catch(x){return e.value=!1,n.value=x.message||"Error al crear etiqueta",console.error(x),null}}async function $(g){if(g.length<2)return[];try{const u=await fetch(`/admin/etiquetas/search?q=${encodeURIComponent(g)}`);if(!u.ok)throw new Error("Error al buscar etiquetas");return(await u.json()).data||[]}catch(u){return console.error("Error buscando etiquetas:",u),[]}}function V(g){const u=new Map;return g.forEach(x=>{var h;const w=((h=x.categoria)==null?void 0:h.nombre)||"Sin categoría";u.has(w)||u.set(w,[]),u.get(w).push(x)}),u}function G(g){var u;return g.color||((u=g.categoria)==null?void 0:u.color)||"gray"}function F(g,u=10){return g<u}async function O(g,u){return e.value=!0,n.value=null,new Promise((x,w)=>{E.post(`/admin/proyectos/${g}/etiquetas/reorder`,{etiquetas:u},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,x(!0)},onError:h=>{e.value=!1,n.value="Error al reordenar etiquetas",w(h)}})})}return{isLoading:e,error:n,addEtiquetaToProyecto:z,removeEtiquetaFromProyecto:N,syncEtiquetasProyecto:k,getSugerenciasEtiquetas:v,reorderEtiquetas:O,createEtiqueta:f,searchEtiquetas:$,groupEtiquetasByCategoria:V,getEtiquetaColor:G,canAddMoreEtiquetas:F}}const Ne={key:0,class:"flex items-center gap-2"},Fe={key:0,class:"mb-6"},_e={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},Le={class:"text-center"},Ue={class:"text-2xl font-bold"},Re={class:"text-center"},Ge={class:"text-2xl font-bold text-blue-500"},Oe={class:"text-center"},Je={class:"text-2xl font-bold text-green-500"},Ke={class:"text-center"},Xe={class:"space-y-2"},Qe={class:"flex justify-between items-center text-sm"},We={class:"font-medium"},Ye={key:1,class:"space-y-3"},Ze={key:2,class:"text-center py-6"},et={class:"text-muted-foreground mb-3"},tt=ee({__name:"HitosGrid",props:{hitos:{},proyectoId:{},proyectoNombre:{},estadisticas:{},showStats:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0},showViewAll:{type:Boolean,default:!0},maxHitos:{default:void 0},canCreate:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},emptyMessage:{default:"No hay hitos definidos para este proyecto"}},emits:["view","edit","delete","duplicate","add-entregable","view-entregables"],setup(e){const n=e,z=U(()=>n.maxHitos&&n.maxHitos>0?n.hitos.slice(0,n.maxHitos):n.hitos),N=U(()=>n.maxHitos&&n.hitos.length>n.maxHitos);return(k,v)=>(l(),y(a(H),null,{default:r(()=>[e.showHeader?(l(),y(a(D),{key:0,class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:r(()=>[s("div",null,[o(a(T),{class:"flex items-center gap-2"},{default:r(()=>[o(a(X),{class:"h-5 w-5"}),v[0]||(v[0]=m(" Hitos y Entregables ",-1))]),_:1}),e.proyectoNombre?(l(),y(a(te),{key:0},{default:r(()=>[m(d(e.proyectoNombre),1)]),_:1})):p("",!0)]),e.showActions?(l(),b("div",Ne,[e.showViewAll&&e.hitos.length>0?(l(),y(a(B),{key:0,href:`/admin/proyectos/${e.proyectoId}/hitos`},{default:r(()=>[o(a(C),{variant:"outline",size:"sm"},{default:r(()=>[o(a(Se),{class:"h-4 w-4 mr-2"}),v[1]||(v[1]=m(" Ver Todos ",-1))]),_:1})]),_:1},8,["href"])):p("",!0),e.canCreate?(l(),y(a(B),{key:1,href:`/admin/proyectos/${e.proyectoId}/hitos/create`},{default:r(()=>[o(a(C),{size:"sm"},{default:r(()=>[o(a(R),{class:"h-4 w-4 mr-2"}),v[2]||(v[2]=m(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])):p("",!0)]),_:1})):p("",!0),o(a(S),null,{default:r(()=>[e.showStats&&e.estadisticas&&e.estadisticas.total>0?(l(),b("div",Fe,[s("div",_e,[s("div",Le,[s("p",Ue,d(e.estadisticas.total),1),v[3]||(v[3]=s("p",{class:"text-xs text-muted-foreground"},"Total Hitos",-1))]),s("div",Re,[s("p",Ge,d(e.estadisticas.en_progreso),1),v[4]||(v[4]=s("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),s("div",Oe,[s("p",Je,d(e.estadisticas.completados),1),v[5]||(v[5]=s("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),s("div",Ke,[s("p",{class:_(["text-2xl font-bold",{"text-red-500":e.estadisticas.vencidos>0}])},d(e.estadisticas.vencidos),3),v[6]||(v[6]=s("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))])]),s("div",Xe,[s("div",Qe,[v[7]||(v[7]=s("span",{class:"text-muted-foreground"},"Progreso General",-1)),s("span",We,d(e.estadisticas.progreso_general)+"%",1)]),o(a(ae),{value:e.estadisticas.progreso_general,class:"h-2"},null,8,["value"])])])):p("",!0),e.hitos.length>0?(l(),b("div",Ye,[(l(!0),b(L,null,K(z.value,f=>(l(),y(He,{key:f.id,hito:f,canEdit:e.canEdit,canDelete:e.canDelete,canManageDeliverables:e.canManageDeliverables,showActions:!0,compact:!0,onView:$=>k.$emit("view",f),onEdit:$=>k.$emit("edit",f),onDelete:$=>k.$emit("delete",f),onDuplicate:$=>k.$emit("duplicate",f),onAddEntregable:$=>k.$emit("add-entregable",f),onViewEntregables:$=>k.$emit("view-entregables",f)},null,8,["hito","canEdit","canDelete","canManageDeliverables","onView","onEdit","onDelete","onDuplicate","onAddEntregable","onViewEntregables"]))),128)),N.value?(l(),y(a(B),{key:0,href:`/admin/proyectos/${e.proyectoId}/hitos`,class:"block text-center mt-4 text-sm text-primary hover:underline"},{default:r(()=>[m(" Ver todos los hitos ("+d(e.hitos.length)+") ",1)]),_:1},8,["href"])):p("",!0)])):(l(),b("div",Ze,[o(a(X),{class:"h-10 w-10 mx-auto text-muted-foreground mb-3"}),s("p",et,d(e.emptyMessage),1),e.canCreate?(l(),y(a(B),{key:0,href:`/admin/proyectos/${e.proyectoId}/hitos/create`},{default:r(()=>[o(a(C),{variant:"outline",size:"sm"},{default:r(()=>[o(a(R),{class:"h-4 w-4 mr-2"}),v[8]||(v[8]=m(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)]))]),_:1})]),_:1}))}}),at={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ot={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},st={class:"text-2xl font-bold text-gray-900 dark:text-white"},rt={key:0,class:"mt-2 text-gray-600 dark:text-gray-400"},it={class:"flex gap-2"},lt={class:"flex items-center justify-between"},nt={class:"flex items-center gap-3"},ct={class:"flex items-center gap-3"},dt={class:"space-y-2"},ut={class:"flex justify-between text-sm"},mt={class:"font-medium"},ft={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2"},yt={class:"flex items-start gap-3"},pt={class:"font-medium"},gt={class:"text-xs text-gray-500"},vt={key:0,class:"flex items-start gap-3"},xt={class:"font-medium"},ht={class:"text-xs text-gray-500"},bt={key:0,class:"flex items-center gap-3 pt-2"},wt={class:"font-medium ml-2"},Et={key:0},$t={key:1,class:"text-sm text-muted-foreground"},kt={key:1,class:"space-y-4"},qt={class:"flex gap-2"},Ct={class:"space-y-4"},St={class:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},Ht={class:"text-gray-900 dark:text-gray-100"},Pt={key:0,class:"flex items-center gap-3"},Dt={class:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Tt={class:"font-medium"},Vt={class:"text-sm text-gray-500"},Bt={key:1,class:"text-gray-500"},At={class:"font-mono"},jt={class:"font-medium"},zt={class:"text-sm"},It={class:"text-sm"},Mt={class:"space-y-3"},Nt={class:"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Ft={class:"flex-1"},_t={class:"text-sm"},Lt={class:"font-medium"},Ut={class:"text-xs text-gray-500 mt-1"},Rt={key:0,class:"flex justify-end"},Gt={class:"space-y-4"},Ot={class:"text-center"},Mo=ee({__name:"Show",props:{proyecto:{},categorias:{},activities:{},usuariosActividades:{},authPermissions:{},totales:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageTags:{type:Boolean},canViewContracts:{type:Boolean},canCreateContracts:{type:Boolean},canViewHitos:{type:Boolean},canCreateHitos:{type:Boolean},canEditHitos:{type:Boolean},canDeleteHitos:{type:Boolean},canManageEntregables:{type:Boolean},estadisticasHitos:{}},setup(e){const n=e,z=["general","contratos","hitos","evidencias","actividad"],k=j((()=>{const t=new URLSearchParams(window.location.search).get("tab");return t&&z.includes(t)?t:"general"})());fe(k,i=>{const t=`/admin/proyectos/${n.proyecto.id}?tab=${i}`;E.get(t,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]})});const v=U(()=>{var i,t;return((i=n.authPermissions)==null?void 0:i.includes("evidencias.aprobar"))||((t=n.authPermissions)==null?void 0:t.includes("evidencias.rechazar"))||!1}),f=j({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null}),$=j(!1),V=j([]),{syncEtiquetasProyecto:G,isLoading:F}=Me();n.proyecto.etiquetas&&(V.value=n.proyecto.etiquetas.map(i=>i.id));const O=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:n.proyecto.nombre,href:`/admin/proyectos/${n.proyecto.id}`}],g=()=>{confirm(`¿Estás seguro de eliminar el proyecto "${n.proyecto.nombre}"?`)&&E.delete(`/admin/proyectos/${n.proyecto.id}`,{onSuccess:()=>{P.success("Proyecto eliminado exitosamente")},onError:()=>{P.error("Error al eliminar el proyecto")}})},u=i=>({planificacion:X,en_progreso:ze,pausado:ke,completado:je,cancelado:$e})[i]||Ie,x=i=>({planificacion:"bg-blue-100 text-blue-800",en_progreso:"bg-yellow-100 text-yellow-800",pausado:"bg-orange-100 text-orange-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[i]||"bg-gray-100 text-gray-800",w=i=>({baja:"bg-gray-100 text-gray-800",media:"bg-blue-100 text-blue-800",alta:"bg-orange-100 text-orange-800",critica:"bg-red-100 text-red-800"})[i]||"bg-gray-100 text-gray-800",h=i=>new Date(i).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),J=i=>{const t=Math.floor((new Date(i).getTime()-new Date().getTime())/864e5);return t===0?"Hoy":t===1?"Mañana":t===-1?"Ayer":t>0?`En ${t} días`:`Hace ${Math.abs(t)} días`},oe=async()=>{try{await G(n.proyecto.id,V.value),$.value=!1,P.success("Etiquetas actualizadas exitosamente"),E.reload({only:["proyecto"]})}catch{P.error("Error al actualizar las etiquetas")}},se=()=>{var i;V.value=((i=n.proyecto.etiquetas)==null?void 0:i.map(t=>t.id))||[],$.value=!1},re=i=>{E.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}`)},ie=i=>{E.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}/edit`)},le=i=>{confirm(`¿Estás seguro de eliminar el hito "${i.nombre}"? Se eliminarán también todos sus entregables.`)&&E.delete(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}`,{onSuccess:()=>{P.success("Hito eliminado exitosamente"),E.reload({only:["proyecto"]})},onError:()=>{P.error("Error al eliminar el hito")}})},ne=i=>{E.post(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}/duplicar`,{},{onSuccess:()=>{P.success("Hito duplicado exitosamente"),E.reload({only:["proyecto"]})},onError:()=>{P.error("Error al duplicar el hito")}})},ce=i=>{E.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}/entregables/create`)},de=i=>{E.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}/entregables`)},ue=U(()=>{let i=n.activities||[];return f.value.usuario_id&&(i=i.filter(t=>{var c;return((c=t.causer)==null?void 0:c.id)===f.value.usuario_id})),f.value.tipo_entidad&&(i=i.filter(t=>t.subject_type===f.value.tipo_entidad)),f.value.tipo_accion&&(i=i.filter(t=>t.event===f.value.tipo_accion)),(f.value.fecha_inicio||f.value.fecha_fin)&&(i=i.filter(t=>{const c=new Date(t.created_at);if(f.value.fecha_inicio){const q=new Date(f.value.fecha_inicio);if(c<q)return!1}if(f.value.fecha_fin){const q=new Date(f.value.fecha_fin);if(q.setHours(23,59,59,999),c>q)return!1}return!0})),i});return(i,t)=>(l(),b(L,null,[o(a(ye),{title:`Proyecto: ${e.proyecto.nombre}`},null,8,["title"]),o(me,{breadcrumbs:O},{default:r(()=>[s("div",at,[s("div",ot,[s("div",null,[s("h1",st,d(e.proyecto.nombre),1),e.proyecto.descripcion?(l(),b("p",rt,d(e.proyecto.descripcion),1)):p("",!0)]),s("div",it,[e.canEdit?(l(),y(a(B),{key:0,href:`/admin/proyectos/${e.proyecto.id}/edit`},{default:r(()=>[o(a(C),null,{default:r(()=>[o(a(Q),{class:"mr-2 h-4 w-4"}),t[4]||(t[4]=m(" Editar ",-1))]),_:1})]),_:1},8,["href"])):p("",!0),e.canDelete?(l(),y(a(C),{key:1,variant:"destructive",onClick:g},{default:r(()=>[o(a(Pe),{class:"mr-2 h-4 w-4"}),t[5]||(t[5]=m(" Eliminar ",-1))]),_:1})):p("",!0)])]),o(a(ge),{modelValue:k.value,"onUpdate:modelValue":t[3]||(t[3]=c=>k.value=c),class:"w-full"},{default:r(()=>[o(a(ve),{class:"grid w-full grid-cols-5"},{default:r(()=>[o(a(I),{value:"general"},{default:r(()=>[o(a(De),{class:"mr-2 h-4 w-4"}),t[6]||(t[6]=m(" General ",-1))]),_:1}),o(a(I),{value:"contratos"},{default:r(()=>{var c;return[o(a(W),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=m(" Contratos ",-1)),(c=e.totales)!=null&&c.contratos?(l(),y(a(A),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:r(()=>[m(d(e.totales.contratos),1)]),_:1})):p("",!0)]}),_:1}),o(a(I),{value:"hitos"},{default:r(()=>{var c;return[o(a(we),{class:"mr-2 h-4 w-4"}),t[8]||(t[8]=m(" Hitos y Entregables ",-1)),(c=e.totales)!=null&&c.hitos?(l(),y(a(A),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:r(()=>[m(d(e.totales.hitos),1)]),_:1})):p("",!0)]}),_:1}),o(a(I),{value:"evidencias"},{default:r(()=>{var c;return[o(a(Te),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=m(" Evidencias ",-1)),(c=e.totales)!=null&&c.evidencias?(l(),y(a(A),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:r(()=>[m(d(e.totales.evidencias),1)]),_:1})):p("",!0)]}),_:1}),o(a(I),{value:"actividad"},{default:r(()=>[o(a(Ve),{class:"mr-2 h-4 w-4"}),t[10]||(t[10]=m(" Actividad ",-1))]),_:1})]),_:1}),o(a(M),{value:"general",class:"space-y-4 mt-6"},{default:r(()=>[o(a(H),null,{default:r(()=>[o(a(D),null,{default:r(()=>[o(a(T),null,{default:r(()=>[...t[11]||(t[11]=[m("Estado del Proyecto",-1)])]),_:1})]),_:1}),o(a(S),{class:"space-y-4"},{default:r(()=>[s("div",lt,[s("div",nt,[(l(),y(pe(u(e.proyecto.estado)),{class:"h-5 w-5 text-gray-500"})),t[12]||(t[12]=s("span",{class:"font-medium"},"Estado:",-1)),o(a(A),{class:_(x(e.proyecto.estado))},{default:r(()=>[m(d(e.proyecto.estado_label),1)]),_:1},8,["class"])]),s("div",ct,[o(a(Be),{class:"h-5 w-5 text-gray-500"}),t[13]||(t[13]=s("span",{class:"font-medium"},"Prioridad:",-1)),o(a(A),{class:_(w(e.proyecto.prioridad))},{default:r(()=>[m(d(e.proyecto.prioridad_label),1)]),_:1},8,["class"])])]),s("div",dt,[s("div",ut,[t[14]||(t[14]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Progreso",-1)),s("span",mt,d(e.proyecto.porcentaje_completado)+"%",1)]),o(a(ae),{"model-value":e.proyecto.porcentaje_completado,class:"h-2"},null,8,["model-value"])]),s("div",ft,[s("div",yt,[o(a(Y),{class:"h-5 w-5 text-gray-500 mt-0.5"}),s("div",null,[t[15]||(t[15]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de inicio",-1)),s("p",pt,d(h(e.proyecto.fecha_inicio)),1),s("p",gt,d(J(e.proyecto.fecha_inicio)),1)])]),e.proyecto.fecha_fin?(l(),b("div",vt,[o(a(Y),{class:"h-5 w-5 text-gray-500 mt-0.5"}),s("div",null,[t[16]||(t[16]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de fin",-1)),s("p",xt,d(h(e.proyecto.fecha_fin)),1),s("p",ht,d(J(e.proyecto.fecha_fin)),1)])])):p("",!0)]),e.proyecto.duracion_dias?(l(),b("div",bt,[o(a(Ae),{class:"h-5 w-5 text-gray-500"}),s("div",null,[t[17]||(t[17]=s("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Duración total:",-1)),s("span",wt,d(e.proyecto.duracion_dias)+" días",1)])])):p("",!0)]),_:1})]),_:1}),o(a(H),null,{default:r(()=>[o(a(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:r(()=>[o(a(T),null,{default:r(()=>[...t[18]||(t[18]=[m(" Etiquetas ",-1)])]),_:1}),e.canManageTags&&!$.value?(l(),y(a(C),{key:0,variant:"ghost",size:"sm",onClick:t[0]||(t[0]=c=>$.value=!0)},{default:r(()=>[o(a(Q),{class:"h-4 w-4"})]),_:1})):p("",!0)]),_:1}),o(a(S),null,{default:r(()=>[$.value?(l(),b("div",kt,[e.categorias?(l(),y(he,{key:0,modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=c=>V.value=c),categorias:e.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas...",description:"Selecciona hasta 10 etiquetas para este proyecto"},null,8,["modelValue","categorias"])):p("",!0),s("div",qt,[o(a(C),{size:"sm",onClick:oe,disabled:a(F)},{default:r(()=>[...t[19]||(t[19]=[m(" Guardar ",-1)])]),_:1},8,["disabled"]),o(a(C),{size:"sm",variant:"outline",onClick:se,disabled:a(F)},{default:r(()=>[...t[20]||(t[20]=[m(" Cancelar ",-1)])]),_:1},8,["disabled"])])])):(l(),b("div",Et,[e.proyecto.etiquetas&&e.proyecto.etiquetas.length>0?(l(),y(xe,{key:0,etiquetas:e.proyecto.etiquetas,"show-categoria":!0,interactive:!0,size:"md"},null,8,["etiquetas"])):(l(),b("p",$t," No hay etiquetas asignadas "))]))]),_:1})]),_:1}),e.proyecto.campos_personalizados&&e.proyecto.campos_personalizados.length>0?(l(),y(a(H),{key:0},{default:r(()=>[o(a(D),null,{default:r(()=>[o(a(T),null,{default:r(()=>[...t[21]||(t[21]=[m("Campos Personalizados",-1)])]),_:1})]),_:1}),o(a(S),null,{default:r(()=>[s("div",Ct,[(l(!0),b(L,null,K(e.proyecto.campos_personalizados,c=>{var q;return l(),b("div",{key:c.id,class:"py-2 border-b last:border-b-0"},[s("p",St,d((q=c.campo_personalizado)==null?void 0:q.nombre),1),s("p",Ht,d(c.valor_formateado||c.valor||"-"),1)])}),128))])]),_:1})]),_:1})):p("",!0),o(a(H),null,{default:r(()=>[o(a(D),null,{default:r(()=>[o(a(T),null,{default:r(()=>[...t[22]||(t[22]=[m("Responsable",-1)])]),_:1})]),_:1}),o(a(S),null,{default:r(()=>[e.proyecto.responsable?(l(),b("div",Pt,[s("div",Dt,[o(a(Z),{class:"h-5 w-5 text-gray-500"})]),s("div",null,[s("p",Tt,d(e.proyecto.responsable.name),1),s("p",Vt,d(e.proyecto.responsable.email),1)])])):(l(),b("p",Bt,"Sin asignar"))]),_:1})]),_:1}),o(a(H),null,{default:r(()=>[o(a(D),null,{default:r(()=>[o(a(T),null,{default:r(()=>[...t[23]||(t[23]=[m("Información del Sistema",-1)])]),_:1})]),_:1}),o(a(S),{class:"space-y-3"},{default:r(()=>{var c;return[s("div",null,[t[24]||(t[24]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"ID del Proyecto",-1)),s("p",At,"#"+d(e.proyecto.id),1)]),s("div",null,[t[25]||(t[25]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado",-1)),o(a(A),{class:_(e.proyecto.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},{default:r(()=>[m(d(e.proyecto.activo?"Activo":"Inactivo"),1)]),_:1},8,["class"])]),s("div",null,[t[26]||(t[26]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Creado por",-1)),s("p",jt,d(((c=e.proyecto.creador)==null?void 0:c.name)||"Sistema"),1)]),s("div",null,[t[27]||(t[27]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de creación",-1)),s("p",zt,d(h(e.proyecto.created_at)),1)]),s("div",null,[t[28]||(t[28]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Última actualización",-1)),s("p",It,d(h(e.proyecto.updated_at)),1)])]}),_:1})]),_:1}),e.proyecto.activities&&e.proyecto.activities.length>0?(l(),y(a(H),{key:1},{default:r(()=>[o(a(D),null,{default:r(()=>[o(a(T),null,{default:r(()=>[...t[29]||(t[29]=[m("Actividad Reciente",-1)])]),_:1})]),_:1}),o(a(S),null,{default:r(()=>[s("div",Mt,[(l(!0),b(L,null,K(e.proyecto.activities,c=>{var q;return l(),b("div",{key:c.id,class:"flex items-start gap-3 pb-3 border-b last:border-b-0"},[s("div",Nt,[o(a(Z),{class:"h-4 w-4 text-gray-500"})]),s("div",Ft,[s("p",_t,[s("span",Lt,d(((q=c.causer)==null?void 0:q.name)||"Sistema"),1),m(" "+d(c.description),1)]),s("p",Ut,d(J(c.created_at)),1)])])}),128))])]),_:1})]),_:1})):p("",!0)]),_:1}),o(a(M),{value:"contratos",class:"space-y-4 mt-6"},{default:r(()=>[e.canCreateContracts?(l(),b("div",Rt,[o(a(B),{href:`/admin/contratos/create?proyecto_id=${e.proyecto.id}`},{default:r(()=>[o(a(C),null,{default:r(()=>[o(a(R),{class:"mr-2 h-4 w-4"}),t[30]||(t[30]=m(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])])):p("",!0),e.proyecto.contratos&&e.proyecto.contratos.length>0?(l(),y(a(H),{key:1},{default:r(()=>[o(a(D),null,{default:r(()=>[o(a(T),null,{default:r(()=>[...t[31]||(t[31]=[m("Contratos del Proyecto",-1)])]),_:1}),o(a(te),null,{default:r(()=>[...t[32]||(t[32]=[m(" Lista de contratos asociados a este proyecto ",-1)])]),_:1})]),_:1}),o(a(S),null,{default:r(()=>[s("div",Gt,[o(be,{contratos:e.proyecto.contratos,"show-proyecto":!1,"show-actions":!0,"actions-style":"buttons"},null,8,["contratos"])])]),_:1})]),_:1})):(l(),y(a(H),{key:2},{default:r(()=>[o(a(S),{class:"py-8"},{default:r(()=>[s("div",Ot,[o(a(W),{class:"mx-auto h-12 w-12 text-gray-400"}),t[34]||(t[34]=s("p",{class:"mt-2 text-sm text-gray-600"},"No hay contratos asociados",-1)),e.canCreateContracts?(l(),y(a(B),{key:0,href:`/admin/contratos/create?proyecto_id=${e.proyecto.id}`,class:"mt-4 inline-block"},{default:r(()=>[o(a(C),{variant:"outline"},{default:r(()=>[o(a(R),{class:"mr-2 h-4 w-4"}),t[33]||(t[33]=m(" Crear primer contrato ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])]),_:1})]),_:1}))]),_:1}),o(a(M),{value:"hitos",class:"space-y-4 mt-6"},{default:r(()=>[e.canViewHitos?(l(),y(tt,{key:0,hitos:e.proyecto.hitos||[],"proyecto-id":e.proyecto.id,estadisticas:e.estadisticasHitos,"show-stats":!0,"show-header":!0,"show-actions":!0,"show-view-all":!0,"can-create":e.canCreateHitos,"can-edit":e.canEditHitos,"can-delete":e.canDeleteHitos,"can-manage-deliverables":e.canManageEntregables,"empty-message":"No hay hitos definidos para este proyecto",onView:re,onEdit:ie,onDelete:le,onDuplicate:ne,onAddEntregable:ce,onViewEntregables:de},null,8,["hitos","proyecto-id","estadisticas","can-create","can-edit","can-delete","can-manage-deliverables"])):p("",!0)]),_:1}),o(a(M),{value:"evidencias",class:"space-y-4 mt-6"},{default:r(()=>[o(Ee,{contratos:e.proyecto.contratos||[],"proyecto-id":e.proyecto.id,modo:"admin","puede-gestionar-estado":v.value,"format-date":h},null,8,["contratos","proyecto-id","puede-gestionar-estado"])]),_:1}),o(a(M),{value:"actividad",class:"space-y-4 mt-6"},{default:r(()=>[e.activities&&e.activities.length>0?(l(),y(qe,{key:0,modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=c=>f.value=c),usuarios:e.usuariosActividades,"context-level":"proyecto"},null,8,["modelValue","usuarios"])):p("",!0),o(Ce,{activities:ue.value,title:"Historial de Actividad",description:"Registro completo de cambios y eventos del proyecto, hitos y entregables","empty-message":"No hay actividad registrada"},null,8,["activities"])]),_:1})]),_:1},8,["modelValue"])])]),_:1})],64))}});export{Mo as default};
