import{d as U,c as I,r as H,i as m,e as o,f as t,q as G,w as i,g as r,j as D,b as g,t as c,v as z,h as u,m as d,n as h,A as O,F as C,k as A,y as R,ax as W,s as y}from"./app-NmALTVyN.js";import{_ as X}from"./AdminLayout.vue_vue_type_script_setup_true_lang-bLp48OwR.js";import{_ as b,c as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-BzTFcOtj.js";import{c as Y,_ as p}from"./createLucideIcon-wqcwkUQd.js";import{_ as Z}from"./Input.vue_vue_type_script_setup_true_lang-Bm_1WzJZ.js";import{_ as ee}from"./index-ZW8gywEB.js";import{H as J}from"./HitoCard-CLFDCXqp.js";import{t as _}from"./index-COqoEB39.js";import{A as te}from"./arrow-left-92cQyYkQ.js";import{P as F}from"./plus-ezYOOOnX.js";import{S as oe}from"./search-CgQd1oDs.js";import{L as se}from"./list-BM4knEsT.js";import{T as ie}from"./target-DKjnpYLV.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C3T8umbB.js";import"./index-C2UErq72.js";import"./floating-ui.vue-DabOKq8u.js";import"./x-Cd_4Yvl_.js";import"./index-CmdJBr9K.js";import"./shield-BqM34IAP.js";import"./user-DtOxb5Ze.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-rERjetO9.js";import"./chevron-right-Crr3uzoO.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DI9gfWoU.js";import"./VisuallyHidden-BCgqoBWa.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CEtk9hit.js";import"./index-DVFh-uMH.js";import"./check-zQEdtOat.js";import"./nullish-CHIgUVhi.js";import"./Label.vue_vue_type_script_setup_true_lang-BM_hjP20.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-mVPyQqNq.js";import"./circle-alert-DDqlzooM.js";import"./map-pin-aXg-1VED.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-1Q_mV4Ij.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BGaMd-Nb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-Rn5TBnRj.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C1h5Vtyx.js";import"./tag-Bm7brt-v.js";import"./users-vgqJVzu0.js";import"./vote-BRUZwb_0.js";import"./folder-open-C5pd7ZzZ.js";import"./send-Bi9GDGVw.js";import"./file-text-CT6oxPWB.js";import"./briefcase-Cp62jigF.js";import"./calendar-D33aSez1.js";import"./megaphone-SfxlGp_B.js";import"./user-check-CYc87UfZ.js";import"./clipboard-list-46U3lKIb.js";import"./mail-BsuCB09v.js";import"./message-square-BnCZEtBG.js";import"./external-link-BreQtYoE.js";import"./panel-left-Bot3oP6H.js";import"./index-CSSlEsXb.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-Cgw1tgTs.js";import"./Progress.vue_vue_type_script_setup_true_lang-CM_nP229.js";import"./ellipsis-DS1ly7N8.js";import"./pen-Ck6D51s0.js";import"./copy-BTL9k0oB.js";import"./trash-2-RxFgxxNT.js";import"./calendar-days-Dh1sWqc2.js";import"./clock-Bl_u6Gcl.js";import"./eye-CLEPOwbO.js";import"./es-BDPlFIsO.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=Y("NetworkIcon",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),re={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},le={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ne={class:"text-sm text-muted-foreground mt-1"},de={class:"flex items-center gap-2"},me={key:0,class:"grid grid-cols-2 md:grid-cols-5 gap-4"},ce={class:"text-2xl font-bold"},ue={class:"text-2xl font-bold text-gray-500"},pe={class:"text-2xl font-bold text-blue-500"},fe={class:"text-2xl font-bold text-green-500"},ye={class:"flex flex-col sm:flex-row gap-2"},ve={class:"flex-1"},ge={class:"relative"},xe={class:"flex gap-2"},he={key:1},be={key:0,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},$e={key:1,class:"space-y-3"},ke={class:"rounded-full bg-muted p-3 mb-4"},we={class:"text-muted-foreground text-center mb-4"},Ee={key:3,class:"flex justify-center gap-2 mt-4"},Bt=U({__name:"Index",props:{proyecto:{},hitos:{},filters:{},estadisticas:{},timeline:{},canCreate:{type:Boolean},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageDeliverables:{type:Boolean}},setup(a){var j,q;const l=a,f=I(()=>Array.isArray(l.hitos)?{data:l.hitos,current_page:1,last_page:1,per_page:l.hitos.length,total:l.hitos.length}:l.hitos),k=H(((j=l.filters)==null?void 0:j.search)||""),x=H(((q=l.filters)==null?void 0:q.estado)||""),v=H(!1),K=I(()=>{if(!v.value)return f.value.data;const n=f.value.data.filter(s=>!s.parent_id),e=(s,V=0)=>f.value.data.filter(E=>E.parent_id===s).flatMap(E=>[{...E,_nivel:V},...e(E.id,V+1)]);return n.flatMap(s=>[{...s,_nivel:0},...e(s.id,1)])}),Q=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:l.proyecto.nombre,href:`/admin/proyectos/${l.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${l.proyecto.id}/hitos`}],M=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`)},P=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/edit`)},B=n=>{confirm(`¿Estás seguro de eliminar el hito "${n.nombre}"?`)&&y.delete(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`,{onSuccess:()=>{_.success("Hito eliminado exitosamente")},onError:()=>{_.error("Error al eliminar el hito")}})},N=n=>{y.post(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/duplicar`,{},{onSuccess:()=>{_.success("Hito duplicado exitosamente")},onError:()=>{_.error("Error al duplicar el hito")}})},S=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/entregables/create`)},T=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/entregables`)},L=()=>{y.get(`/admin/proyectos/${l.proyecto.id}/hitos`,{search:k.value,estado:x.value},{preserveState:!0,preserveScroll:!0})},w=n=>{x.value=n,L()};return(n,e)=>(d(),m(C,null,[o(t(G),{title:`Hitos - ${a.proyecto.nombre}`},null,8,["title"]),o(X,{breadcrumbs:Q},{default:i(()=>[r("div",re,[r("div",le,[r("div",null,[e[6]||(e[6]=r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Hitos del Proyecto ",-1)),r("p",ne,c(a.proyecto.nombre),1)]),r("div",de,[o(t(z),{href:`/admin/proyectos/${a.proyecto.id}`},{default:i(()=>[o(t(p),{variant:"outline",size:"sm"},{default:i(()=>[o(t(te),{class:"h-4 w-4 mr-2"}),e[7]||(e[7]=u(" Volver al Proyecto ",-1))]),_:1})]),_:1},8,["href"]),a.canCreate?(d(),g(t(z),{key:0,href:`/admin/proyectos/${a.proyecto.id}/hitos/create`},{default:i(()=>[o(t(p),{size:"sm"},{default:i(()=>[o(t(F),{class:"h-4 w-4 mr-2"}),e[8]||(e[8]=u(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):D("",!0)])]),a.estadisticas?(d(),m("div",me,[o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",ce,c(a.estadisticas.total),1),e[9]||(e[9]=r("p",{class:"text-xs text-muted-foreground"},"Total",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",ue,c(a.estadisticas.pendientes),1),e[10]||(e[10]=r("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",pe,c(a.estadisticas.en_progreso),1),e[11]||(e[11]=r("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",fe,c(a.estadisticas.completados),1),e[12]||(e[12]=r("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",{class:h(["text-2xl font-bold",{"text-red-500":a.estadisticas.vencidos>0}])},c(a.estadisticas.vencidos),3),e[13]||(e[13]=r("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))]),_:1})]),_:1})])):D("",!0),r("div",ye,[r("div",ve,[r("div",ge,[o(t(oe),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o(t(Z),{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=s=>k.value=s),placeholder:"Buscar hitos...",class:"pl-9",onKeyup:O(L,["enter"])},null,8,["modelValue"])])]),r("div",xe,[o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":v.value}),onClick:e[1]||(e[1]=s=>v.value=!v.value),title:"Cambiar vista"},{default:i(()=>[v.value?(d(),g(t(ae),{key:0,class:"h-4 w-4 mr-2"})):(d(),g(t(se),{key:1,class:"h-4 w-4 mr-2"})),u(" "+c(v.value?"Jerárquica":"Plana"),1)]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value===""}),onClick:e[2]||(e[2]=s=>w(""))},{default:i(()=>[...e[14]||(e[14]=[u(" Todos ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="pendiente"}),onClick:e[3]||(e[3]=s=>w("pendiente"))},{default:i(()=>[...e[15]||(e[15]=[u(" Pendientes ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="en_progreso"}),onClick:e[4]||(e[4]=s=>w("en_progreso"))},{default:i(()=>[...e[16]||(e[16]=[u(" En Progreso ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="completado"}),onClick:e[5]||(e[5]=s=>w("completado"))},{default:i(()=>[...e[17]||(e[17]=[u(" Completados ",-1)])]),_:1},8,["class"])])]),f.value.data.length>0?(d(),m("div",he,[v.value?(d(),m("div",$e,[(d(!0),m(C,null,A(K.value,s=>(d(),m("div",{key:s.id,style:R({marginLeft:`${(s._nivel||0)*2}rem`}),class:"transition-all"},[o(J,{hito:s,"proyecto-id":a.proyecto.id,canEdit:a.canEdit,canDelete:a.canDelete,canManageDeliverables:a.canManageDeliverables,showActions:!0,onView:M,onEdit:P,onDelete:B,onDuplicate:N,onAddEntregable:S,onViewEntregables:T},W({_:2},[s._nivel>0?{name:"prepend",fn:i(()=>[o(t(ee),{variant:"outline",class:"mr-2"},{default:i(()=>[u(" Nivel "+c(s._nivel),1)]),_:2},1024)]),key:"0"}:void 0]),1032,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"])],4))),128))])):(d(),m("div",be,[(d(!0),m(C,null,A(f.value.data,s=>(d(),g(J,{key:s.id,hito:s,"proyecto-id":a.proyecto.id,canEdit:a.canEdit,canDelete:a.canDelete,canManageDeliverables:a.canManageDeliverables,showActions:!0,onView:M,onEdit:P,onDelete:B,onDuplicate:N,onAddEntregable:S,onViewEntregables:T},null,8,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"]))),128))]))])):(d(),g(t(b),{key:2},{default:i(()=>[o(t($),{class:"flex flex-col items-center justify-center py-12"},{default:i(()=>[r("div",ke,[o(t(ie),{class:"h-8 w-8 text-muted-foreground"})]),e[19]||(e[19]=r("h3",{class:"text-lg font-semibold mb-2"},"No hay hitos",-1)),r("p",we,c(k.value?"No se encontraron hitos con los filtros aplicados":"Comienza creando el primer hito del proyecto"),1),a.canCreate&&!k.value?(d(),g(t(z),{key:0,href:`/admin/proyectos/${a.proyecto.id}/hitos/create`},{default:i(()=>[o(t(p),null,{default:i(()=>[o(t(F),{class:"h-4 w-4 mr-2"}),e[18]||(e[18]=u(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):D("",!0)]),_:1})]),_:1})),f.value.last_page>1?(d(),m("div",Ee,[(d(!0),m(C,null,A(f.value.last_page,s=>(d(),g(t(p),{key:s,variant:s===f.value.current_page?"default":"outline",size:"sm",onClick:V=>t(y).visit(`/admin/proyectos/${a.proyecto.id}/hitos?page=${s}`)},{default:i(()=>[u(c(s),1)]),_:2},1032,["variant","onClick"]))),128))])):D("",!0)])]),_:1})],64))}});export{Bt as default};
