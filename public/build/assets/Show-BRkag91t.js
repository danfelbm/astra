import{_ as w}from"./index-tJDD-Rzo.js";import{c as qe,_ as A}from"./createLucideIcon-CdYajMF8.js";import{a as j,b as F,c as U,_ as q}from"./CardTitle.vue_vue_type_script_setup_true_lang-B0If0uFj.js";import{_ as ne}from"./CardDescription.vue_vue_type_script_setup_true_lang-DAcZFMoB.js";import{_ as Me,a as Ne,b as ee,c as H,d as He,e as I}from"./TableHeader.vue_vue_type_script_setup_true_lang-C1J4-QpT.js";import{_ as Le}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-DCDvnbac.js";import{_ as Re}from"./CsvImportWizard.vue_vue_type_script_setup_true_lang-DhJLhSth.js";import{d as ve,r as x,o as _e,b as _,w as s,e as t,f as e,g as o,j as b,h as r,t as d,i as f,F as J,k as te,s as z,m as n,x as Te,n as L,c as ue,p as Be,q as De,a as G}from"./app-pH2lMP7e.js";import{H as se}from"./history-DV4s-pi4.js";import{F as ge}from"./file-text-D2G1y88o.js";import{C as be}from"./circle-x-CKJvINZh.js";import{C as le}from"./circle-check-big-DIw0mo0z.js";import{C as ie}from"./clock-B6acgdvJ.js";import{_ as Qe}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-CH22oEBb.js";import{_ as Oe,a as We,b as Xe,c as Ge,d as ae}from"./SelectValue.vue_vue_type_script_setup_true_lang-tHujWSzY.js";import{_ as Je}from"./Checkbox.vue_vue_type_script_setup_true_lang-Do9WdQVm.js";import{_ as Ke}from"./AdminLayout.vue_vue_type_script_setup_true_lang-D0SVvj08.js";import{t as P}from"./index-CermKHup.js";import{_ as de,a as ce}from"./index-EmyB9l8I.js";import{_ as me}from"./AlertTitle.vue_vue_type_script_setup_true_lang-BOKBt3x_.js";import{_ as Ye}from"./Progress.vue_vue_type_script_setup_true_lang-Cm89tvtw.js";import{A as Ze}from"./arrow-left-C55SX2va.js";import{S as pe}from"./square-pen-CBdDHg8I.js";import{C as ea}from"./calendar-BfiAKHku.js";import{M as aa}from"./map-pin-DevsrAjy.js";import{U as ta}from"./users-2IBi9hLL.js";import{U as sa}from"./user-plus-DLEFA0-L.js";import{U as la}from"./upload--2ZaztrC.js";import{C as ia}from"./chevron-left-CosNWhH2.js";import{C as ra}from"./chevron-right-Bx_XDyCm.js";import{V as fe}from"./vote-BICChjcP.js";import{L as oa}from"./loader-circle-Dve3MRR6.js";import{R as na}from"./refresh-cw-BR7bU2mR.js";import{C as ua}from"./circle-alert-Be3O8Az2.js";import{f as da,e as ca}from"./es-BDPlFIsO.js";import"./index-D13mDNdw.js";import"./Input.vue_vue_type_script_setup_true_lang-CjkTkhDf.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-COQJKXLq.js";import"./index-xSNwsOlf.js";import"./floating-ui.vue-BXa_31Ev.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CEcKApMr.js";import"./VisuallyHidden-B4WnRwek.js";import"./x-CODmlH_M.js";import"./DialogTrigger-DxVwQWib.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DPuxQmaB.js";import"./useKbd-kRIii9yh.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-B4J4B3nd.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-BJN_Ghwb.js";import"./trash-2-CKpM237I.js";import"./plus-Byi2epCU.js";import"./search-vQhnULJe.js";import"./filter-DLhXDh9_.js";import"./check-xo9H0LB7.js";import"./save-BYw3mYx9.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-BuJvVU7F.js";import"./RovingFocusItem-BRkVZTQe.js";import"./utils-BYwIaglU.js";import"./Label.vue_vue_type_script_setup_true_lang-CWr1rQHZ.js";import"./git-branch-kN50Mxit.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BvrkQppr.js";import"./index-xrPdL0A0.js";import"./shield-F1yVqDm2.js";import"./user-CaMGY91c.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CdrtTgwG.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Dcum3aE3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-BLpr3XHb.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-D9zM3EVT.js";import"./tag-DKqT_IwT.js";import"./target-BNjg3oB4.js";import"./folder-open-DMe84S-v.js";import"./send-B2DDAy5O.js";import"./briefcase-B906XNtS.js";import"./megaphone-BE1kZ4eB.js";import"./user-check-zQVArAwA.js";import"./clipboard-list-B8B7m6kY.js";import"./mail-OiHiIUAV.js";import"./message-square-gg8pZcvB.js";import"./external-link-D3eCHfRp.js";import"./panel-left-C8r0mKYi.js";import"./index-Csyf4I-I.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=qe("UserMinusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),pa={class:"flex items-center gap-2"},fa={key:0,class:"flex justify-center py-6"},va={key:1,class:"text-center py-6 text-muted-foreground"},_a={key:2,class:"space-y-3"},ga=["onClick"],ba={class:"flex items-center gap-3"},ya={class:"font-medium text-sm"},xa={class:"text-xs text-muted-foreground"},ha={class:"flex items-center gap-3"},ka={class:"text-right text-sm"},wa={class:"text-xs text-muted-foreground mt-1"},$a={key:0},Ca={key:1},Pa={key:2},Sa=ve({__name:"ImportHistory",props:{type:{},entityId:{},title:{default:"Historial de Importaciones"}},setup(c,{expose:h}){const E=c,$=x([]),y=x(!1),g=async()=>{if(E.entityId){y.value=!0;try{const k=E.type==="votacion"?`/admin/votaciones/${E.entityId}/imports/recent`:`/admin/asambleas/${E.entityId}/imports/recent`,C=await fetch(k);if(C.ok){const p=await C.json();$.value=p}}catch(k){console.error("Error loading recent imports:",k)}finally{y.value=!1}}},D=k=>{z.get(`/admin/imports/${k}`)},R=()=>{const k=E.type==="votacion"?`/admin/votaciones/${E.entityId}/imports`:`/admin/asambleas/${E.entityId}/imports`;z.get(k)},T=k=>{switch(k){case"pending":return{icon:ie,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:ie,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:le,label:"Completada",class:"text-green-600"};case"failed":return{icon:be,label:"Fallida",class:"text-red-600"}}},M=k=>new Date(k).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return _e(()=>{g()}),h({loadRecentImports:g}),(k,C)=>(n(),_(e(q),null,{default:s(()=>[t(e(j),null,{default:s(()=>[t(e(F),{class:"flex items-center justify-between"},{default:s(()=>[o("span",pa,[t(e(se),{class:"h-5 w-5"}),r(" "+d(c.title),1)]),$.value.length>0?(n(),_(e(A),{key:0,variant:"outline",size:"sm",onClick:R},{default:s(()=>[...C[0]||(C[0]=[r(" Ver Todas ",-1)])]),_:1})):b("",!0)]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[y.value?(n(),f("div",fa,[...C[1]||(C[1]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):$.value.length===0?(n(),f("div",va,[t(e(se),{class:"mx-auto h-8 w-8 mb-2"}),C[2]||(C[2]=o("p",null,"No hay importaciones registradas",-1)),C[3]||(C[3]=o("p",{class:"text-sm"},"Las importaciones aparecerán aquí una vez que subas archivos CSV",-1))])):(n(),f("div",_a,[(n(!0),f(J,null,te($.value,p=>(n(),f("div",{key:p.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:Q=>D(p.id)},[o("div",ba,[(n(),_(Te(T(p.status).icon),{class:L(["h-4 w-4",T(p.status).class])},null,8,["class"])),o("div",null,[o("p",ya,d(p.name||p.original_filename),1),o("p",xa,d(M(p.created_at))+" • Por "+d(p.created_by.name),1)])]),o("div",ha,[o("div",ka,[t(e(w),{variant:"outline",class:L(T(p.status).class)},{default:s(()=>[r(d(T(p.status).label),1)]),_:2},1032,["class"]),o("p",wa,[p.status==="processing"?(n(),f("span",$a,d(p.progress_percentage)+"% ",1)):p.status==="completed"?(n(),f("span",Ca,d(p.successful_rows)+"/"+d(p.total_rows||p.successful_rows+p.failed_rows)+" registros ",1)):p.status==="failed"&&p.failed_rows>0?(n(),f("span",Pa,d(p.failed_rows)+" errores ",1)):b("",!0)])]),t(e(ge),{class:"h-4 w-4 text-gray-400"})])],8,ga))),128))]))]),_:1})]),_:1}))}}),Aa={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},za={class:"flex items-center justify-between"},Ea={class:"text-3xl font-bold"},Va={class:"mt-2 flex items-center gap-2"},Ia={class:"flex gap-2"},ja={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Fa={class:"space-y-2"},Ua={class:"flex items-center gap-2 text-sm"},qa={class:"flex items-center gap-2 text-sm"},Ma={class:"text-sm font-medium"},Na={class:"space-y-2"},Ha={class:"flex items-center gap-2 text-sm"},La={class:"text-sm text-muted-foreground"},Ra={class:"space-y-2"},Ta={class:"flex items-center gap-2"},Ba={class:"text-2xl font-bold"},Da={class:"text-sm"},Qa={class:"flex items-center justify-between"},Oa={key:0,class:"flex gap-2"},Wa={key:0,class:"mb-4 flex gap-2"},Xa={key:3,class:"flex justify-center py-8"},Ga={key:0,class:"flex items-center gap-2"},Ja={class:"relative"},Ka={key:0,class:"absolute inset-0 flex items-center justify-center"},Ya={key:0,class:"text-green-600 transition-all duration-300"},Za={key:1,class:"text-gray-400 transition-all duration-300"},et={key:1},at={key:0},tt={key:1},st={class:"flex justify-end gap-2"},lt={key:5,class:"flex items-center justify-between mt-4"},it={class:"text-sm text-muted-foreground"},rt={key:0,class:"flex items-center space-x-2"},ot={class:"text-sm"},nt={key:0,class:"flex justify-center py-8"},ut={key:1,class:"text-center py-8 text-gray-500"},dt={key:2,class:"space-y-4"},ct={class:"flex justify-between items-start"},mt={class:"flex-1"},pt={class:"font-semibold text-lg"},ft={key:0,class:"text-sm text-gray-600 mt-1"},vt={class:"flex gap-4 mt-2 text-sm text-gray-500"},_t={key:0,class:"space-y-2"},gt={class:"flex justify-between text-sm"},bt=["href"],Os=ve({__name:"Show",props:{asamblea:{},puede_gestionar_participantes:{type:Boolean},filterFieldsConfig:{}},setup(c){const h=c,E=[{title:"Admin",href:"/admin/dashboard"},{title:"Asambleas",href:"/admin/asambleas"},{title:h.asamblea.nombre,href:"#"}],{route:$}=window,y=x([]),g=x({current_page:1,last_page:1,per_page:20,total:0,from:0,to:0}),D=x(!1),R=x({}),T={fields:h.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por nombre, email o documento...",quickSearchFields:["users.name","users.email","users.documento_identidad"],maxNestingLevel:1,allowSaveFilters:!1,debounceTime:500,autoApply:!1},M=x(!1),k=x("asistente"),C=ue(()=>[{name:"tipo_participacion",label:"Tipo de Participación",type:"select",options:[{value:"asistente",label:"Asistente"},{value:"moderador",label:"Moderador"},{value:"secretario",label:"Secretario"}],value:k.value,required:!1}]),p=x(null),Q=x(!1),W=x(!1),ye=x([]),K=x(null),Y=x([]),Z=x(!1),V=x(null),S=x({}),N=x({}),xe=i=>i?da(new Date(i),"PPPpp",{locale:ca}):"",he=i=>{switch(i){case"moderador":return"bg-purple-100 text-purple-800";case"secretario":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},X=ue(()=>{const i=y.value.filter(m=>{var v;return((v=m.pivot)==null?void 0:v.tipo_participacion)==="moderador"}).length,a=y.value.filter(m=>{var v;return((v=m.pivot)==null?void 0:v.tipo_participacion)==="secretario"}).length,l=y.value.filter(m=>{var v;return((v=m.pivot)==null?void 0:v.tipo_participacion)==="asistente"}).length,u=y.value.filter(m=>{var v;return((v=m.pivot)==null?void 0:v.asistio)===!0}).length;return{moderadores:i,secretarios:a,asistentes:l,presentes:u,total:g.value.total||0}}),B=async(i=1,a={})=>{D.value=!0;try{const l={page:i,...a},u=await G.get($("admin.asambleas.participantes-list",h.asamblea.id),{params:l});y.value=u.data.participantes.data.map(m=>({...m,pivot:{tenant_id:m.tenant_id,tipo_participacion:m.tipo_participacion||"asistente",asistio:m.asistio===1||m.asistio===!0||m.asistio==="1",hora_registro:m.hora_registro}})),g.value={current_page:u.data.participantes.current_page,last_page:u.data.participantes.last_page,per_page:u.data.participantes.per_page,total:u.data.participantes.total,from:u.data.participantes.from,to:u.data.participantes.to}}catch(l){console.error("Error cargando participantes:",l)}finally{D.value=!1}},re=i=>{B(i,R.value)},ke=i=>{R.value=i,B(1,i)},we=()=>{R.value={},B(1,{})},$e=()=>{M.value=!0};Be(M,i=>{i||(k.value="asistente")});const Ce=i=>{if(!i.userIds||i.userIds.length===0)return;const a=i.userIds.length;z.post($("admin.asambleas.manage-participantes",h.asamblea.id),{participante_ids:i.userIds,tipo_participacion:i.extraData.tipo_participacion||"asistente"},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{M.value=!1,P.success(`${a} participante(s) añadido(s) exitosamente`,{duration:2e3}),B(g.value.current_page,R.value)},onError:()=>{P.error("Error al añadir participantes",{description:"Por favor intenta nuevamente",duration:3e3})}})},Pe=i=>{const a=y.value.find(v=>v.id===i),l=(a==null?void 0:a.name)||"Participante";if(!confirm(`¿Estás seguro de remover a ${l} de la asamblea?`))return;const u=y.value.findIndex(v=>v.id===i),m=y.value[u];u!==-1&&(y.value.splice(u,1),g.value.total-=1),z.delete($("admin.asambleas.manage-participantes",h.asamblea.id),{data:{participante_id:i},preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{P.success(`${l} removido de la asamblea`,{duration:2e3})},onError:()=>{m&&u!==-1&&(y.value.splice(u,0,m),g.value.total+=1),P.error("Error al remover participante",{duration:3e3})}})},Se=(i,a)=>{var v;const l=y.value.find(O=>O.id===i),u=(l==null?void 0:l.name)||"Participante",m=(v=l==null?void 0:l.pivot)==null?void 0:v.tipo_participacion;l&&l.pivot&&(l.pivot.tipo_participacion=a),z.put($("admin.asambleas.manage-participantes",h.asamblea.id),{participante_id:i,tipo_participacion:a},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{const O=a.charAt(0).toUpperCase()+a.slice(1);P.success(`${u} asignado como ${O}`,{duration:2e3})},onError:()=>{l&&l.pivot&&m&&(l.pivot.tipo_participacion=m),P.error("Error al actualizar el tipo de participación",{duration:3e3})}})},Ae=(i,a)=>{if(p.value===i)return;p.value=i;const l=y.value.find(m=>m.id===i),u=(l==null?void 0:l.name)||"Participante";l&&l.pivot&&(l.pivot.asistio,l.pivot.asistio=a,a?l.pivot.hora_registro=new Date().toISOString():l.pivot.hora_registro=null),z.put($("admin.asambleas.manage-participantes",h.asamblea.id),{participante_id:i,asistio:a},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{a?P.success(`${u} marcado como presente`,{duration:2e3}):P.info(`${u} marcado como ausente`,{duration:2e3})},onError:()=>{l&&l.pivot&&(l.pivot.asistio=!a,l.pivot.hora_registro=null),P.error("Error al actualizar la asistencia",{description:"Por favor intenta nuevamente",duration:3e3})},onFinish:()=>{p.value=null}})},ze=()=>{z.visit($("admin.asambleas.edit",h.asamblea.id))},Ee=()=>{z.visit($("admin.asambleas.index"))},Ve=async()=>{var i;if((i=h.asamblea)!=null&&i.id)try{const a=await fetch(`/admin/asambleas/${h.asamblea.id}/imports/recent`);ye.value=await a.json()}catch(a){console.error("Error cargando importaciones recientes:",a)}},Ie=i=>{Q.value=!1,Ve(),B(),K.value&&K.value.loadRecentImports(),z.get(`/admin/imports/${i}`)},je=()=>{Q.value=!1},oe=async()=>{Z.value=!0;try{const i=await G.get(`/admin/asambleas/${h.asamblea.id}/votaciones`);i.data.success&&(Y.value=i.data.data)}catch(i){console.error("Error cargando votaciones:",i),P.error("Error al cargar las votaciones")}finally{Z.value=!1}},Fe=async i=>{var a,l;if(!V.value){V.value=i,delete S.value[i];try{const u=await G.post(`/admin/asambleas/${h.asamblea.id}/votaciones/${i}/sync`);if(u.data.success){P.success("Sincronización iniciada");const m=u.data.job_id;Ue(i,m)}}catch(u){console.error("Error iniciando sincronización:",u),P.error(((l=(a=u.response)==null?void 0:a.data)==null?void 0:l.message)||"Error al iniciar la sincronización"),V.value=null}}},Ue=(i,a)=>{N.value[i]&&clearInterval(N.value[i]),N.value[i]=setInterval(async()=>{try{const l=await G.get(`/admin/sync-job/${a}/status`);if(l.data.success){const u=l.data.data;S.value[i]=u,(u.status==="completed"||u.status==="completed_with_errors"||u.status==="failed")&&(clearInterval(N.value[i]),delete N.value[i],V.value=null,setTimeout(()=>{oe()},2e3),setTimeout(()=>{delete S.value[i]},5e3))}}catch(l){console.error("Error obteniendo progreso:",l),clearInterval(N.value[i]),delete N.value[i],V.value=null}},2e3)};return _e(()=>{B(),oe()}),(i,a)=>(n(),f(J,null,[t(e(De),{title:`Asamblea: ${c.asamblea.nombre}`},null,8,["title"]),t(Ke,{breadcrumbs:E},{default:s(()=>[o("div",Aa,[o("div",za,[o("div",null,[o("h1",Ea,d(c.asamblea.nombre),1),o("div",Va,[t(e(w),{class:L(c.asamblea.estado_color)},{default:s(()=>[r(d(c.asamblea.estado_label),1)]),_:1},8,["class"]),t(e(w),{class:L(c.asamblea.tipo==="ordinaria"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800")},{default:s(()=>[r(d(c.asamblea.tipo_label),1)]),_:1},8,["class"]),c.asamblea.activo?(n(),_(e(w),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[...a[6]||(a[6]=[r(" Activa ",-1)])]),_:1})):(n(),_(e(w),{key:1,class:"bg-red-100 text-red-800"},{default:s(()=>[...a[7]||(a[7]=[r(" Inactiva ",-1)])]),_:1}))])]),o("div",Ia,[t(e(A),{variant:"outline",onClick:Ee},{default:s(()=>[t(e(Ze),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=r(" Volver ",-1))]),_:1}),t(e(A),{onClick:ze},{default:s(()=>[t(e(pe),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=r(" Editar ",-1))]),_:1})])]),o("div",ja,[t(e(q),null,{default:s(()=>[t(e(j),{class:"pb-3"},{default:s(()=>[t(e(F),{class:"text-sm font-medium"},{default:s(()=>[...a[10]||(a[10]=[r("Fechas",-1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[o("div",Fa,[o("div",Ua,[t(e(ea),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(c.asamblea.rango_fechas),1)]),o("div",qa,[t(e(ie),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,"Duración: "+d(c.asamblea.duracion),1)]),o("p",Ma,d(c.asamblea.tiempo_restante),1)])]),_:1})]),_:1}),t(e(q),null,{default:s(()=>[t(e(j),{class:"pb-3"},{default:s(()=>[t(e(F),{class:"text-sm font-medium"},{default:s(()=>[...a[11]||(a[11]=[r("Ubicación",-1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[o("div",Na,[o("div",Ha,[t(e(aa),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(c.asamblea.lugar||"No especificado"),1)]),o("p",La,d(c.asamblea.ubicacion_completa),1)])]),_:1})]),_:1}),t(e(q),null,{default:s(()=>[t(e(j),{class:"pb-3"},{default:s(()=>[t(e(F),{class:"text-sm font-medium"},{default:s(()=>[...a[12]||(a[12]=[r("Quórum",-1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[o("div",Ra,[o("div",Ta,[t(e(ta),{class:"h-4 w-4 text-muted-foreground"}),o("span",Ba,d(c.asamblea.asistentes_count)+" / "+d(c.asamblea.quorum_minimo||"∞"),1)]),c.asamblea.alcanza_quorum?(n(),_(e(w),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[t(e(le),{class:"mr-1 h-3 w-3"}),a[13]||(a[13]=r(" Quórum alcanzado ",-1))]),_:1})):c.asamblea.quorum_minimo?(n(),_(e(w),{key:1,class:"bg-yellow-100 text-yellow-800"},{default:s(()=>[t(e(be),{class:"mr-1 h-3 w-3"}),a[14]||(a[14]=r(" Quórum no alcanzado ",-1))]),_:1})):b("",!0)])]),_:1})]),_:1})]),c.asamblea.descripcion?(n(),_(e(q),{key:0},{default:s(()=>[t(e(j),null,{default:s(()=>[t(e(F),null,{default:s(()=>[...a[15]||(a[15]=[r("Descripción",-1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[o("p",Da,d(c.asamblea.descripcion),1)]),_:1})]),_:1})):b("",!0),t(Le,{config:T,onApply:ke,onClear:we}),t(e(q),null,{default:s(()=>[t(e(j),null,{default:s(()=>[o("div",Qa,[o("div",null,[t(e(F),null,{default:s(()=>[...a[16]||(a[16]=[r("Participantes",-1)])]),_:1}),t(e(ne),null,{default:s(()=>[r(d(c.asamblea.participantes_count)+" participantes registrados ",1)]),_:1})]),y.value.length>0?(n(),f("div",Oa,[t(e(w),{variant:"outline"},{default:s(()=>[r(" Moderadores: "+d(X.value.moderadores),1)]),_:1}),t(e(w),{variant:"outline"},{default:s(()=>[r(" Secretarios: "+d(X.value.secretarios),1)]),_:1}),t(e(w),{variant:"outline"},{default:s(()=>[r(" Asistentes: "+d(X.value.asistentes),1)]),_:1}),t(e(w),{variant:"outline"},{default:s(()=>[r(" Presentes: "+d(X.value.presentes),1)]),_:1})])):b("",!0)])]),_:1}),t(e(U),null,{default:s(()=>[c.puede_gestionar_participantes?(n(),f("div",Wa,[t(e(A),{onClick:$e},{default:s(()=>[t(e(sa),{class:"mr-2 h-4 w-4"}),a[17]||(a[17]=r(" Añadir Participantes ",-1))]),_:1}),t(e(A),{variant:"outline",onClick:a[0]||(a[0]=l=>Q.value=!0)},{default:s(()=>[t(e(la),{class:"mr-2 h-4 w-4"}),a[18]||(a[18]=r(" Importar CSV ",-1))]),_:1}),t(e(A),{variant:"outline",onClick:a[1]||(a[1]=l=>W.value=!W.value)},{default:s(()=>[t(e(se),{class:"mr-2 h-4 w-4"}),r(" "+d(W.value?"Ocultar":"Ver")+" Historial ",1)]),_:1})])):b("",!0),Q.value?(n(),_(Re,{key:1,mode:"asamblea","asamblea-id":c.asamblea.id,"asamblea-titulo":c.asamblea.nombre,"redirect-on-success":!0,onSuccess:Ie,onCancel:je,class:"mb-4"},null,8,["asamblea-id","asamblea-titulo"])):b("",!0),W.value?(n(),_(Sa,{key:2,ref_key:"importHistoryRef",ref:K,type:"asamblea","entity-id":c.asamblea.id,title:"Historial de Importaciones",class:"mb-4"},null,8,["entity-id"])):b("",!0),D.value?(n(),f("div",Xa,[...a[19]||(a[19]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):(n(),_(e(Me),{key:4},{default:s(()=>[t(e(Ne),null,{default:s(()=>[t(e(ee),null,{default:s(()=>[t(e(H),null,{default:s(()=>[...a[20]||(a[20]=[r("Nombre",-1)])]),_:1}),t(e(H),null,{default:s(()=>[...a[21]||(a[21]=[r("Email",-1)])]),_:1}),t(e(H),null,{default:s(()=>[...a[22]||(a[22]=[r("Tipo de Participación",-1)])]),_:1}),t(e(H),null,{default:s(()=>[...a[23]||(a[23]=[r("Asistencia",-1)])]),_:1}),t(e(H),null,{default:s(()=>[...a[24]||(a[24]=[r("Hora de Registro",-1)])]),_:1}),t(e(H),null,{default:s(()=>[...a[25]||(a[25]=[r("Registrado por",-1)])]),_:1}),c.puede_gestionar_participantes?(n(),_(e(H),{key:0,class:"text-right"},{default:s(()=>[...a[26]||(a[26]=[r("Acciones",-1)])]),_:1})):b("",!0)]),_:1})]),_:1}),t(e(He),null,{default:s(()=>[(n(!0),f(J,null,te(y.value,l=>(n(),_(e(ee),{key:l.id},{default:s(()=>[t(e(I),{class:"font-medium"},{default:s(()=>[r(d(l.name),1)]),_:2},1024),t(e(I),null,{default:s(()=>[r(d(l.email),1)]),_:2},1024),t(e(I),null,{default:s(()=>{var u;return[t(e(w),{class:L(he(((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente"))},{default:s(()=>{var m;return[r(d(((m=l.pivot)==null?void 0:m.tipo_participacion)||"asistente"),1)]}),_:2},1032,["class"])]}),_:2},1024),t(e(I),null,{default:s(()=>{var u,m,v;return[c.puede_gestionar_participantes&&c.asamblea.estado==="en_curso"?(n(),f("div",Ga,[o("div",Ja,[t(e(Je),{checked:((u=l.pivot)==null?void 0:u.asistio)||!1,disabled:p.value===l.id,"onUpdate:checked":O=>Ae(l.id,O),class:L(p.value===l.id?"opacity-50":"")},null,8,["checked","disabled","onUpdate:checked","class"]),p.value===l.id?(n(),f("div",Ka,[...a[27]||(a[27]=[o("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary"},null,-1)])])):b("",!0)]),(m=l.pivot)!=null&&m.asistio?(n(),f("span",Ya," Presente ")):(n(),f("span",Za," Ausente "))])):(n(),f("div",et,[(v=l.pivot)!=null&&v.asistio?(n(),_(e(w),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[...a[28]||(a[28]=[r(" Presente ",-1)])]),_:1})):(n(),_(e(w),{key:1,variant:"outline"},{default:s(()=>[...a[29]||(a[29]=[r(" Ausente ",-1)])]),_:1}))]))]}),_:2},1024),t(e(I),null,{default:s(()=>{var u;return[r(d((u=l.pivot)!=null&&u.hora_registro?xe(l.pivot.hora_registro):"-"),1)]}),_:2},1024),t(e(I),null,{default:s(()=>{var u;return[(u=l.pivot)!=null&&u.updated_by?(n(),f("span",at,d(l.pivot.updated_by===l.id?"Auto-registro":l.pivot.updated_by_name||"Admin"),1)):(n(),f("span",tt,"-"))]}),_:2},1024),c.puede_gestionar_participantes?(n(),_(e(I),{key:0,class:"text-right"},{default:s(()=>{var u;return[o("div",st,[t(e(Oe),{"model-value":((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente","onUpdate:modelValue":m=>Se(l.id,m)},{default:s(()=>[t(e(We),{class:"w-32"},{default:s(()=>[t(e(Xe))]),_:1}),t(e(Ge),null,{default:s(()=>[t(e(ae),{value:"asistente"},{default:s(()=>[...a[30]||(a[30]=[r("Asistente",-1)])]),_:1}),t(e(ae),{value:"moderador"},{default:s(()=>[...a[31]||(a[31]=[r("Moderador",-1)])]),_:1}),t(e(ae),{value:"secretario"},{default:s(()=>[...a[32]||(a[32]=[r("Secretario",-1)])]),_:1})]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"]),t(e(A),{variant:"ghost",size:"sm",onClick:m=>Pe(l.id)},{default:s(()=>[t(e(ma),{class:"h-4 w-4"})]),_:1},8,["onClick"])])]}),_:2},1024)):b("",!0)]),_:2},1024))),128)),y.value.length===0?(n(),_(e(ee),{key:0},{default:s(()=>[t(e(I),{colspan:"6",class:"text-center py-8"},{default:s(()=>[...a[33]||(a[33]=[o("p",{class:"text-muted-foreground"},"No hay participantes registrados",-1)])]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1})),g.value.total>0?(n(),f("div",lt,[o("div",it," Mostrando "+d(g.value.from)+" a "+d(g.value.to)+" de "+d(g.value.total)+" resultados ",1),g.value.last_page>1?(n(),f("div",rt,[t(e(A),{variant:"outline",size:"sm",disabled:g.value.current_page===1,onClick:a[2]||(a[2]=l=>re(g.value.current_page-1))},{default:s(()=>[t(e(ia),{class:"h-4 w-4"}),a[34]||(a[34]=r(" Anterior ",-1))]),_:1},8,["disabled"]),o("div",ot," Página "+d(g.value.current_page)+" de "+d(g.value.last_page),1),t(e(A),{variant:"outline",size:"sm",disabled:g.value.current_page===g.value.last_page,onClick:a[3]||(a[3]=l=>re(g.value.current_page+1))},{default:s(()=>[a[35]||(a[35]=r(" Siguiente ",-1)),t(e(ra),{class:"h-4 w-4"})]),_:1},8,["disabled"])])):b("",!0)])):b("",!0)]),_:1})]),_:1}),t(e(q),null,{default:s(()=>[t(e(j),null,{default:s(()=>[t(e(F),{class:"flex items-center gap-2"},{default:s(()=>[t(e(fe),{class:"h-5 w-5"}),a[36]||(a[36]=r(" Votaciones Asociadas ",-1))]),_:1}),t(e(ne),null,{default:s(()=>[...a[37]||(a[37]=[r(" Votaciones vinculadas a esta asamblea y estado de sincronización de participantes ",-1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[Z.value?(n(),f("div",nt,[t(e(oa),{class:"h-8 w-8 animate-spin text-gray-400"})])):Y.value.length===0?(n(),f("div",ut,[t(e(fe),{class:"h-12 w-12 mx-auto mb-3 text-gray-300"}),a[39]||(a[39]=o("p",null,"No hay votaciones asociadas a esta asamblea",-1)),t(e(A),{variant:"outline",class:"mt-4",onClick:a[4]||(a[4]=()=>e(z).visit(`/admin/asambleas/${c.asamblea.id}/edit`))},{default:s(()=>[t(e(pe),{class:"h-4 w-4 mr-2"}),a[38]||(a[38]=r(" Editar Asamblea para Agregar Votaciones ",-1))]),_:1})])):(n(),f("div",dt,[(n(!0),f(J,null,te(Y.value,l=>(n(),f("div",{key:l.id,class:"border rounded-lg p-4 space-y-3"},[o("div",ct,[o("div",mt,[o("h4",pt,d(l.titulo),1),l.descripcion?(n(),f("p",ft,d(l.descripcion),1)):b("",!0),o("div",vt,[o("span",null,[a[40]||(a[40]=r("Estado: ",-1)),t(e(w),{variant:l.estado==="activa"?"default":"secondary"},{default:s(()=>[r(d(l.estado),1)]),_:2},1032,["variant"])]),o("span",null,"Votantes: "+d(l.votantes_count),1),o("span",null,"Sincronizados desde asamblea: "+d(l.sincronizados_count),1)])]),l.puede_sincronizar&&c.puede_gestionar_participantes?(n(),_(e(A),{key:0,onClick:u=>Fe(l.id),disabled:V.value===l.id,variant:"outline"},{default:s(()=>[t(e(na),{class:L(["h-4 w-4 mr-2",{"animate-spin":V.value===l.id}])},null,8,["class"]),r(" "+d(V.value===l.id?"Sincronizando...":"Sincronizar Participantes"),1)]),_:2},1032,["onClick","disabled"])):b("",!0)]),S.value[l.id]?(n(),f("div",_t,[o("div",gt,[o("span",null,d(S.value[l.id].message),1),o("span",null,d(Math.round(S.value[l.id].progress))+"%",1)]),t(e(Ye),{"model-value":S.value[l.id].progress},null,8,["model-value"]),S.value[l.id].status==="completed"?(n(),_(e(de),{key:0,class:"mt-2"},{default:s(()=>[t(e(le),{class:"h-4 w-4"}),t(e(me),null,{default:s(()=>[...a[41]||(a[41]=[r("Sincronización completada",-1)])]),_:1}),t(e(ce),null,{default:s(()=>[r(d(S.value[l.id].message),1)]),_:2},1024)]),_:2},1024)):b("",!0),S.value[l.id].status==="failed"?(n(),_(e(de),{key:1,variant:"destructive",class:"mt-2"},{default:s(()=>[t(e(ua),{class:"h-4 w-4"}),t(e(me),null,{default:s(()=>[...a[42]||(a[42]=[r("Error en sincronización",-1)])]),_:1}),t(e(ce),null,{default:s(()=>[r(d(S.value[l.id].message),1)]),_:2},1024)]),_:2},1024)):b("",!0)])):b("",!0)]))),128))]))]),_:1})]),_:1}),c.asamblea.acta_url?(n(),_(e(q),{key:1},{default:s(()=>[t(e(j),null,{default:s(()=>[t(e(F),null,{default:s(()=>[...a[43]||(a[43]=[r("Acta de la Asamblea",-1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[o("a",{href:c.asamblea.acta_url,target:"_blank",class:"flex items-center gap-2 text-blue-600 hover:underline"},[t(e(ge),{class:"h-4 w-4"}),a[44]||(a[44]=r(" Ver Acta ",-1))],8,bt)]),_:1})]),_:1})):b("",!0)]),t(Qe,{modelValue:M.value,"onUpdate:modelValue":a[5]||(a[5]=l=>M.value=l),title:"Añadir Participantes",description:"Selecciona los usuarios que deseas añadir como participantes de la asamblea","search-endpoint":e($)("admin.asambleas.manage-participantes",h.asamblea.id),"extra-fields":C.value,"search-placeholder":"Buscar por nombre, email, documento o teléfono...","submit-button-text":"Añadir Participantes","empty-message":"Escribe para buscar usuarios disponibles","no-results-message":"No se encontraron usuarios con esa búsqueda",onSubmit:Ce},null,8,["modelValue","search-endpoint","extra-fields"])]),_:1})],64))}});export{Os as default};
