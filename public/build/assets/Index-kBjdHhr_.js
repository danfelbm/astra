import{d as ce,r as T,c as D,b as _,w as a,e as t,g as n,f as e,q as ve,t as f,j as B,v as S,h as l,m,A as pe,i as M,F as L,k as P,x as Q,s as I}from"./app-CUy8bq-4.js";import{_ as _e}from"./UserLayout.vue_vue_type_script_setup_true_lang-CMfPTi5J.js";import{_ as w,a as k,b as $,c as C}from"./CardTitle.vue_vue_type_script_setup_true_lang-aQWwj-VV.js";import{_ as W}from"./CardDescription.vue_vue_type_script_setup_true_lang-D9Sm1XFf.js";import{c as ge,_ as g}from"./createLucideIcon-BVeAo22y.js";import{_ as Y}from"./index-nP7KVplh.js";import{_ as xe}from"./Input.vue_vue_type_script_setup_true_lang-KDLmivUK.js";import{_ as N,a as U,b as q,c as K,d as p}from"./SelectValue.vue_vue_type_script_setup_true_lang-CDO9BPe3.js";import{_ as be,a as he,b as Z,c as x,d as ye,e as b}from"./TableHeader.vue_vue_type_script_setup_true_lang-Ch5EnOT-.js";import{A as we}from"./arrow-left-Cs6eDjxO.js";import{U as ke}from"./upload-CZha5Hz_.js";import{F as A}from"./file-text-DLYSBMo_.js";import{C as ee}from"./circle-check-big-BoVlpGZu.js";import{C as O}from"./clock-C6V-0lcU.js";import{C as te}from"./circle-x-D3aL8uUy.js";import{F as $e}from"./filter-OXBrqNgh.js";import{E as Ce}from"./eye-DZg-6F1p.js";import{S as Ve}from"./square-pen-CsztrSPy.js";import{T as Ee}from"./trash-2-DTvY1Q0A.js";import{V as ze}from"./video-DONBtULa.js";import{C as Me}from"./camera-BBisJGra.js";import"./useFlashMessages-BSGtS98b.js";import"./index-aYAdEGHe.js";import"./floating-ui.vue-BuhgbMW1.js";import"./x-BIc-vpoP.js";import"./index-Cibtne3p.js";import"./shield-CM4rzlKb.js";import"./user-BblbUKaH.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-FYTrsXKF.js";import"./chevron-right-BN0pcRkC.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BlrYM9n8.js";import"./VisuallyHidden-W3a4-zje.js";import"./index-Cp4rSUgH.js";import"./Label.vue_vue_type_script_setup_true_lang-C8Yg27qk.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CLMRNulS.js";import"./index-B1IwCVKl.js";import"./circle-alert-C27dg7Ep.js";import"./map-pin-DnLb6Xc5.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CqolT--g.js";import"./ellipsis-DOX_Jhdl.js";import"./usePermissions-6mfi9WNH.js";import"./square-check-big-Dt7HCeZl.js";import"./users-CtZ6ZZ1s.js";import"./folder-open-Bt9R0Kno.js";import"./milestone-BXaKJacw.js";import"./index-BqMYO_2s.js";import"./check-cYkI6jVy.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=ge("AudioLinesIcon",[["path",{d:"M2 10v3",key:"1fnikh"}],["path",{d:"M6 6v11",key:"11sgs0"}],["path",{d:"M10 3v18",key:"yhl04a"}],["path",{d:"M14 8v7",key:"3a1oy3"}],["path",{d:"M18 5v13",key:"123xd1"}],["path",{d:"M22 10v3",key:"154ddg"}]]),Te={class:"space-y-6"},Be={class:"flex items-center justify-between"},Se={class:"text-muted-foreground mt-2"},Ae={class:"flex gap-2"},je={class:"grid gap-4 md:grid-cols-4"},De={class:"text-2xl font-bold"},Le={class:"text-2xl font-bold"},Pe={class:"text-2xl font-bold"},Ie={class:"text-2xl font-bold"},Ne={class:"grid gap-4 md:grid-cols-5"},Ue={class:"flex gap-2"},qe={key:0,class:"text-center py-8"},Ke={class:"flex items-center gap-2"},Oe={class:"capitalize"},Re={class:"text-sm"},Ge={class:"text-sm"},Xe={class:"flex items-center gap-2"},He={class:"text-xs text-muted-foreground"},Je={class:"text-sm text-muted-foreground"},Qe={class:"text-sm text-muted-foreground"},We={class:"flex items-center justify-end gap-1"},Ye={key:2,class:"mt-4 flex justify-center"},Ze={class:"flex gap-1"},Xt=ce({__name:"Index",props:{contrato:{},evidencias:{},filters:{},estadisticas:{},authPermissions:{}},setup(d){var R,G,X,H;const c=d,F=T(((R=c.filters)==null?void 0:R.search)||""),V=T(((G=c.filters)==null?void 0:G.tipo)||"all"),E=T(((X=c.filters)==null?void 0:X.estado)||"all"),z=T(((H=c.filters)==null?void 0:H.obligacion_id)||"all"),ae=o=>({imagen:Me,video:ze,audio:Fe,documento:A})[o]||A,se=o=>({pendiente:"secondary",aprobada:"success",rechazada:"destructive"})[o]||"default",le=o=>({pendiente:O,aprobada:ee,rechazada:te})[o]||O,oe=D(()=>{var o;return((o=c.authPermissions)==null?void 0:o.includes("evidencias.edit_own"))||!1}),ie=D(()=>{var o;return((o=c.authPermissions)==null?void 0:o.includes("evidencias.delete_own"))||!1}),ne=D(()=>{var o;return((o=c.authPermissions)==null?void 0:o.includes("evidencias.create_own"))||!1}),j=()=>{I.get(route("user.mis-contratos.evidencias.index",c.contrato.id),{search:F.value,tipo:V.value==="all"?"":V.value,estado:E.value==="all"?"":E.value,obligacion_id:z.value==="all"?"":z.value},{preserveState:!0,preserveScroll:!0})},de=()=>{F.value="",V.value="all",E.value="all",z.value="all",j()},re=o=>{confirm("¿Estás seguro de que deseas eliminar esta evidencia?")&&I.delete(route("user.mis-contratos.evidencias.destroy",[c.contrato.id,o]),{preserveScroll:!0,onSuccess:()=>{}})},ue=o=>o?new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",fe=o=>{if(o===0)return"0 Bytes";const s=1024,i=["Bytes","KB","MB","GB"],u=Math.floor(Math.log(o)/Math.log(s));return Math.round(o/Math.pow(s,u)*100)/100+" "+i[u]},me=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Contratos",href:"/miembro/mis-contratos"},{title:c.contrato.nombre,href:`/miembro/mis-contratos/${c.contrato.id}`},{title:"Evidencias",href:"#"}];return(o,s)=>(m(),_(_e,{title:`Evidencias - ${d.contrato.nombre}`,breadcrumbs:me},{default:a(()=>[t(e(ve),{title:`Evidencias - ${d.contrato.nombre}`},null,8,["title"]),n("div",Te,[n("div",Be,[n("div",null,[s[4]||(s[4]=n("h1",{class:"text-3xl font-bold tracking-tight"},"Evidencias del Contrato",-1)),n("p",Se," Gestione todas las evidencias de cumplimiento de "+f(d.contrato.nombre),1)]),n("div",Ae,[t(e(g),{href:o.route("user.mis-contratos.show",d.contrato.id),as:e(S),variant:"outline"},{default:a(()=>[t(e(we),{class:"w-4 h-4 mr-2"}),s[5]||(s[5]=l(" Volver al Contrato ",-1))]),_:1},8,["href","as"]),ne.value?(m(),_(e(g),{key:0,href:o.route("user.mis-contratos.evidencias.create",d.contrato.id),as:e(S)},{default:a(()=>[t(e(ke),{class:"w-4 h-4 mr-2"}),s[6]||(s[6]=l(" Nueva Evidencia ",-1))]),_:1},8,["href","as"])):B("",!0)])]),n("div",je,[t(e(w),null,{default:a(()=>[t(e(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e($),{class:"text-sm font-medium"},{default:a(()=>[...s[7]||(s[7]=[l("Total Evidencias",-1)])]),_:1}),t(e(A),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(C),null,{default:a(()=>[n("div",De,f(d.evidencias.total),1)]),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t(e(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e($),{class:"text-sm font-medium"},{default:a(()=>[...s[8]||(s[8]=[l("Aprobadas",-1)])]),_:1}),t(e(ee),{class:"h-4 w-4 text-green-600"})]),_:1}),t(e(C),null,{default:a(()=>{var i,u;return[n("div",Le,f(((u=(i=d.evidencias)==null?void 0:i.data)==null?void 0:u.filter(v=>v.estado==="aprobada").length)||0),1)]}),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t(e(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e($),{class:"text-sm font-medium"},{default:a(()=>[...s[9]||(s[9]=[l("Pendientes",-1)])]),_:1}),t(e(O),{class:"h-4 w-4 text-orange-600"})]),_:1}),t(e(C),null,{default:a(()=>{var i,u;return[n("div",Pe,f(((u=(i=d.evidencias)==null?void 0:i.data)==null?void 0:u.filter(v=>v.estado==="pendiente").length)||0),1)]}),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t(e(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e($),{class:"text-sm font-medium"},{default:a(()=>[...s[10]||(s[10]=[l("Rechazadas",-1)])]),_:1}),t(e(te),{class:"h-4 w-4 text-red-600"})]),_:1}),t(e(C),null,{default:a(()=>{var i,u;return[n("div",Ie,f(((u=(i=d.evidencias)==null?void 0:i.data)==null?void 0:u.filter(v=>v.estado==="rechazada").length)||0),1)]}),_:1})]),_:1})]),t(e(w),null,{default:a(()=>[t(e(k),null,{default:a(()=>[t(e($),null,{default:a(()=>[...s[11]||(s[11]=[l("Filtros",-1)])]),_:1}),t(e(W),null,{default:a(()=>[...s[12]||(s[12]=[l("Filtre las evidencias por tipo, estado u obligación",-1)])]),_:1})]),_:1}),t(e(C),null,{default:a(()=>[n("div",Ne,[n("div",null,[t(e(xe),{modelValue:F.value,"onUpdate:modelValue":s[0]||(s[0]=i=>F.value=i),placeholder:"Buscar por descripción...",onKeyup:pe(j,["enter"])},null,8,["modelValue"])]),n("div",null,[t(e(N),{modelValue:V.value,"onUpdate:modelValue":s[1]||(s[1]=i=>V.value=i)},{default:a(()=>[t(e(U),null,{default:a(()=>[t(e(q),{placeholder:"Tipo de evidencia"})]),_:1}),t(e(K),null,{default:a(()=>[t(e(p),{value:"all"},{default:a(()=>[...s[13]||(s[13]=[l("Todos los tipos",-1)])]),_:1}),t(e(p),{value:"imagen"},{default:a(()=>[...s[14]||(s[14]=[l("Imagen",-1)])]),_:1}),t(e(p),{value:"video"},{default:a(()=>[...s[15]||(s[15]=[l("Video",-1)])]),_:1}),t(e(p),{value:"audio"},{default:a(()=>[...s[16]||(s[16]=[l("Audio",-1)])]),_:1}),t(e(p),{value:"documento"},{default:a(()=>[...s[17]||(s[17]=[l("Documento",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",null,[t(e(N),{modelValue:E.value,"onUpdate:modelValue":s[2]||(s[2]=i=>E.value=i)},{default:a(()=>[t(e(U),null,{default:a(()=>[t(e(q),{placeholder:"Estado"})]),_:1}),t(e(K),null,{default:a(()=>[t(e(p),{value:"all"},{default:a(()=>[...s[18]||(s[18]=[l("Todos los estados",-1)])]),_:1}),t(e(p),{value:"pendiente"},{default:a(()=>[...s[19]||(s[19]=[l("Pendiente",-1)])]),_:1}),t(e(p),{value:"aprobada"},{default:a(()=>[...s[20]||(s[20]=[l("Aprobada",-1)])]),_:1}),t(e(p),{value:"rechazada"},{default:a(()=>[...s[21]||(s[21]=[l("Rechazada",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",null,[t(e(N),{modelValue:z.value,"onUpdate:modelValue":s[3]||(s[3]=i=>z.value=i)},{default:a(()=>[t(e(U),null,{default:a(()=>[t(e(q),{placeholder:"Obligación"})]),_:1}),t(e(K),null,{default:a(()=>[t(e(p),{value:"all"},{default:a(()=>[...s[22]||(s[22]=[l("Todas las obligaciones",-1)])]),_:1}),(m(!0),M(L,null,P(d.contrato.obligaciones||[],i=>(m(),_(e(p),{key:i.id,value:i.id.toString()},{default:a(()=>[l(f(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),n("div",Ue,[t(e(g),{onClick:j,class:"flex-1"},{default:a(()=>[t(e($e),{class:"w-4 h-4 mr-2"}),s[23]||(s[23]=l(" Filtrar ",-1))]),_:1}),t(e(g),{onClick:de,variant:"outline"},{default:a(()=>[...s[24]||(s[24]=[l(" Limpiar ",-1)])]),_:1})])])]),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t(e(k),null,{default:a(()=>[t(e($),null,{default:a(()=>[...s[25]||(s[25]=[l("Evidencias Registradas",-1)])]),_:1}),t(e(W),null,{default:a(()=>{var i,u,v;return[l(" Mostrando "+f(((u=(i=d.evidencias)==null?void 0:i.data)==null?void 0:u.length)||0)+" de "+f(((v=d.evidencias)==null?void 0:v.total)||0)+" evidencias ",1)]}),_:1})]),_:1}),t(e(C),null,{default:a(()=>{var i,u,v,J;return[(u=(i=d.evidencias)==null?void 0:i.data)!=null&&u.length?(m(),_(e(be),{key:1},{default:a(()=>[t(e(he),null,{default:a(()=>[t(e(Z),null,{default:a(()=>[t(e(x),null,{default:a(()=>[...s[27]||(s[27]=[l("Tipo",-1)])]),_:1}),t(e(x),null,{default:a(()=>[...s[28]||(s[28]=[l("Obligación",-1)])]),_:1}),t(e(x),null,{default:a(()=>[...s[29]||(s[29]=[l("Descripción",-1)])]),_:1}),t(e(x),null,{default:a(()=>[...s[30]||(s[30]=[l("Archivos",-1)])]),_:1}),t(e(x),null,{default:a(()=>[...s[31]||(s[31]=[l("Estado",-1)])]),_:1}),t(e(x),null,{default:a(()=>[...s[32]||(s[32]=[l("Fecha",-1)])]),_:1}),t(e(x),null,{default:a(()=>[...s[33]||(s[33]=[l("Tamaño",-1)])]),_:1}),t(e(x),{class:"text-right"},{default:a(()=>[...s[34]||(s[34]=[l("Acciones",-1)])]),_:1})]),_:1})]),_:1}),t(e(ye),null,{default:a(()=>{var h;return[(m(!0),M(L,null,P(((h=d.evidencias)==null?void 0:h.data)||[],r=>(m(),_(e(Z),{key:r.id},{default:a(()=>[t(e(b),null,{default:a(()=>[n("div",Ke,[(m(),_(Q(ae(r.tipo_evidencia)),{class:"w-4 h-4 text-muted-foreground"})),n("span",Oe,f(r.tipo_evidencia),1)])]),_:2},1024),t(e(b),null,{default:a(()=>{var y;return[n("span",Re,f(((y=r.obligacion)==null?void 0:y.nombre)||"-"),1)]}),_:2},1024),t(e(b),null,{default:a(()=>[n("span",Ge,f(r.descripcion||"Sin descripción"),1)]),_:2},1024),t(e(b),null,{default:a(()=>[n("div",Xe,[t(e(Y),{variant:"secondary",class:"text-xs"},{default:a(()=>[l(f(r.total_archivos||1),1)]),_:2},1024),n("span",He,f((r.total_archivos||1)===1?"archivo":"archivos"),1)])]),_:2},1024),t(e(b),null,{default:a(()=>[t(e(Y),{variant:se(r.estado)},{default:a(()=>[(m(),_(Q(le(r.estado)),{class:"w-3 h-3 mr-1"})),l(" "+f(r.estado),1)]),_:2},1032,["variant"])]),_:2},1024),t(e(b),null,{default:a(()=>[n("span",Je,f(ue(r.created_at)),1)]),_:2},1024),t(e(b),null,{default:a(()=>{var y;return[n("span",Qe,f(fe(((y=r.metadata)==null?void 0:y.size)||0)),1)]}),_:2},1024),t(e(b),{class:"text-right"},{default:a(()=>[n("div",We,[t(e(g),{href:o.route("user.mis-contratos.evidencias.show",[d.contrato.id,r.id]),as:e(S),variant:"ghost",size:"sm"},{default:a(()=>[t(e(Ce),{class:"w-4 h-4"})]),_:1},8,["href","as"]),oe.value&&r.estado==="pendiente"?(m(),_(e(g),{key:0,href:o.route("user.mis-contratos.evidencias.edit",[d.contrato.id,r.id]),as:e(S),variant:"ghost",size:"sm"},{default:a(()=>[t(e(Ve),{class:"w-4 h-4"})]),_:1},8,["href","as"])):B("",!0),ie.value&&r.estado==="pendiente"?(m(),_(e(g),{key:1,onClick:y=>re(r.id),variant:"ghost",size:"sm",class:"text-destructive hover:text-destructive"},{default:a(()=>[t(e(Ee),{class:"w-4 h-4"})]),_:1},8,["onClick"])):B("",!0)])]),_:2},1024)]),_:2},1024))),128))]}),_:1})]),_:1})):(m(),M("div",qe,[t(e(A),{class:"w-12 h-12 mx-auto text-muted-foreground mb-3"}),s[26]||(s[26]=n("p",{class:"text-muted-foreground"},"No se encontraron evidencias con los filtros aplicados",-1))])),(((v=d.evidencias)==null?void 0:v.last_page)||1)>1?(m(),M("div",Ye,[n("nav",Ze,[(m(!0),M(L,null,P(((J=d.evidencias)==null?void 0:J.last_page)||1,h=>{var r;return m(),_(e(g),{key:h,onClick:y=>e(I).get(o.route("user.mis-contratos.evidencias.index",d.contrato.id),{...d.filters,page:h}),variant:h===(((r=d.evidencias)==null?void 0:r.current_page)||1)?"default":"outline",size:"sm"},{default:a(()=>[l(f(h),1)]),_:2},1032,["onClick","variant"])}),128))])])):B("",!0)]}),_:1})]),_:1})])]),_:1},8,["title"]))}});export{Xt as default};
