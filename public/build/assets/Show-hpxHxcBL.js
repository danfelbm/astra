import{d as Q,c as D,i as c,j as b,g as o,t as d,F as P,k as K,b as _,w as t,e as a,f as e,n as G,h as i,m as l,x as ie,r as S,T as We,M as Je,N as Xe,u as te,q as Ke,s as pe,y as Ze,O as re,a as ge}from"./app-DB52i0Vi.js";import{_ as H}from"./index-CBsS3L2Y.js";import{c as Z,_ as k}from"./createLucideIcon-CDD88oTc.js";import{c as R,_ as M,a as O,b as U}from"./CardTitle.vue_vue_type_script_setup_true_lang-DhGz-PEe.js";import{_ as E}from"./Label.vue_vue_type_script_setup_true_lang-DNBAD1R6.js";import{_ as Qe}from"./Checkbox.vue_vue_type_script_setup_true_lang-C7MoCfHr.js";import{_ as ve,a as be}from"./index-DtSyrxtN.js";import{R as oe}from"./RichTextEditor-Ctn-gsde.js";import{_ as Ye}from"./HistorialCandidatura.vue_vue_type_script_setup_true_lang-CkNV8SFR.js";import{_ as ye}from"./Textarea.vue_vue_type_script_setup_true_lang-7R2GJmbJ.js";import{F as je}from"./file-text-P5qiexdG.js";import{E as ea}from"./eye-DCSEm6gP.js";import{D as aa}from"./download-D5H5Xxnp.js";import{E as ta}from"./external-link-7U9r7dL8.js";import{U as ra}from"./users-YBraLpAg.js";import{U as le}from"./user-CkpVpm_2.js";import{P as oa}from"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DcNzwwrA.js";import{M as Ee}from"./mail-lODDXllb.js";import{C as de}from"./calendar-BG7OdIRp.js";import{H as sa}from"./hash-FdEiBkgP.js";import{B as na}from"./briefcase-Cfi8w0YR.js";import{e as xe,_ as he,a as _e,b as ke,c as we,d as Ce}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Lbr02lfH.js";import{C as Ve}from"./clock-BeSNEDiZ.js";import{C as W}from"./circle-check-big-Dcr0bDve.js";import{C as J}from"./circle-x-9HpFn4h6.js";import{M as X}from"./message-square-CCSeZ8WS.js";import{P as Te}from"./plus-BOHl1_uP.js";import{_ as la}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as ia}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Dw_nrbsE.js";import{A as da}from"./arrow-left-DwtkFjEE.js";import{L as $e}from"./loader-circle-_x6lqtrV.js";import{T as ua,a as ca}from"./toggle-right-C0tPJMEg.js";import{T as Ae}from"./triangle-alert-CQI6pskb.js";import{S as ma}from"./square-check-big-jtf2sZDR.js";import{C as fa}from"./circle-check-Cis2SXeg.js";import{H as Se}from"./history-3Ud0anOy.js";import"./index-C97ua1Jz.js";import"./Input.vue_vue_type_script_setup_true_lang-BMJpcIBW.js";import"./index-BEwfH5Us.js";import"./floating-ui.vue-TDhXKOz6.js";import"./check-BSa6upwI.js";import"./italic-C8AWRRbi.js";import"./list-DTFpUi_J.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-LGMRVQul.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-C9RMd-fi.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-D_J3ghab.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CZdpgezo.js";import"./VisuallyHidden-7WJPGwXK.js";import"./chevron-right-BOo7MKuO.js";import"./x-DhYwZj5g.js";import"./index-lDsEFH4z.js";import"./shield-NSmx5WMc.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DQFkAj1L.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-fjSICTO7.js";import"./index-B7CL-mW0.js";import"./circle-alert-Fzh2I4oh.js";import"./map-pin-uatvRRf1.js";import"./chevrons-up-down-BTqveiFu.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BWza2RrI.js";import"./tag-wZuE_sUU.js";import"./target-Bz_VNBhI.js";import"./vote-DanWGhka.js";import"./folder-open-BNvjzsbB.js";import"./send-xk5URWTc.js";import"./megaphone-CKthpsg2.js";import"./user-check-CKyH3W5C.js";import"./clipboard-list-BDbvISjb.js";import"./panel-left-BuXJDLUe.js";import"./index-4f99ARWI.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=Z("MessageCircleIcon",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=Z("MessageSquareOffIcon",[["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M3.6 3.6c-.4.3-.6.8-.6 1.4v16l4-4h10",key:"pwpm4a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Z("RotateCcwIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=Z("StickyNoteIcon",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=Z("Undo2Icon",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=Z("WrenchIcon",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),xa={class:"space-y-2"},ha={key:0},_a={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},ka={key:1,class:"text-sm text-muted-foreground italic"},wa={key:2,class:"space-y-2"},Ca={class:"flex items-center justify-between"},$a={class:"flex items-center space-x-3 flex-1 min-w-0"},Aa={class:"flex-shrink-0"},Sa={class:"flex-1 min-w-0"},za={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},ja={class:"flex items-center space-x-1 flex-shrink-0"},se=Q({__name:"FileFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1}},setup(s){const v=s,y=D(()=>{if(!v.value)return[];if(Array.isArray(v.value))return v.value.map((n,f)=>{const h=V(n);return{id:`file_${f}`,name:h,path:n,url:n.startsWith("http")?n:`/storage/${n}`,extension:z(h)}});if(typeof v.value=="string"){const n=V(v.value);return[{id:"file_0",name:n,path:v.value,url:v.value.startsWith("http")?v.value:`/storage/${v.value}`,extension:z(n)}]}return[]}),V=n=>{if(!n)return"archivo";const f=n.split("/");return f[f.length-1]||"archivo"},z=n=>{const f=n.split(".");return f.length>1?f[f.length-1].toLowerCase():""},T=n=>{switch(n){case"pdf":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"doc":case"docx":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"xls":case"xlsx":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"jpg":case"jpeg":case"png":case"gif":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},w=n=>{window.open(n,"_blank")},m=(n,f)=>{const h=document.createElement("a");h.href=n+"?download=true",h.download=f,h.target="_blank",document.body.appendChild(h),h.click(),document.body.removeChild(h)};return(n,f)=>(l(),c("div",xa,[s.showLabel&&s.label?(l(),c("div",ha,[o("label",_a,d(s.label),1)])):b("",!0),y.value.length===0?(l(),c("div",ka," No hay archivos adjuntos ")):(l(),c("div",wa,[(l(!0),c(P,null,K(y.value,h=>(l(),_(e(M),{key:h.id,class:"hover:shadow-md transition-shadow duration-200"},{default:t(()=>[a(e(R),{class:"p-3"},{default:t(()=>[o("div",Ca,[o("div",$a,[o("div",Aa,[a(e(je),{class:"h-8 w-8 text-red-500"})]),o("div",Sa,[o("p",za,d(h.name),1),a(e(H),{class:G([T(h.extension),"mt-1"])},{default:t(()=>[i(d(h.extension.toUpperCase()),1)]),_:2},1032,["class"])])]),o("div",ja,[a(e(k),{variant:"ghost",size:"sm",onClick:N=>w(h.url),class:"hover:bg-blue-50 dark:hover:bg-blue-900",title:"Ver archivo"},{default:t(()=>[a(e(ea),{class:"h-4 w-4"}),f[0]||(f[0]=o("span",{class:"ml-1 hidden sm:inline"},"Ver",-1))]),_:1},8,["onClick"]),a(e(k),{variant:"ghost",size:"sm",onClick:N=>m(h.url,h.name),class:"hover:bg-green-50 dark:hover:bg-green-900",title:"Descargar archivo"},{default:t(()=>[a(e(aa),{class:"h-4 w-4"}),f[1]||(f[1]=o("span",{class:"ml-1 hidden sm:inline"},"Descargar",-1))]),_:1},8,["onClick"]),a(e(k),{variant:"ghost",size:"sm",onClick:N=>w(h.url),class:"hover:bg-purple-50 dark:hover:bg-purple-900",title:"Abrir en nueva pestaña"},{default:t(()=>[a(e(ta),{class:"h-4 w-4"})]),_:1},8,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))]))]))}}),Ea={class:"space-y-2"},Va={key:0,class:"flex items-center gap-2"},Ta={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Fa={key:1,class:"text-sm text-muted-foreground italic"},La={key:2,class:"space-y-3"},Na={class:"flex items-center justify-between"},Ra={class:"flex items-center gap-2"},Ma={class:"flex items-center gap-2 min-w-[140px]"},Da={class:"flex-1"},Ia={key:0,class:"text-sm text-muted-foreground italic"},ne=Q({__name:"RepeaterFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1},fields:{},itemName:{default:"Elemento"}},setup(s){const v=s,y=D(()=>v.value?Array.isArray(v.value)?v.value.map((m,n)=>m.id&&m.data?m:{id:`item_${n}`,data:m}):[]:[]),V=(m,n)=>{if(m==null||m==="")return"No especificado";if(Array.isArray(m))return m.join(", ");if(n&&(n.includes("fecha")||n.includes("date")))try{return new Date(m).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return m.toString()}return typeof m=="boolean"?m?"Sí":"No":m.toString()},z=m=>{if(v.fields&&v.fields.length>0){const n=v.fields.find(f=>f.id===m);if(n)return n.title}return m.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()).replace(/Id$/i,"").replace(/Contacto$/i,"").trim()},T=m=>{const n=m.toLowerCase();return n.includes("nombre")||n.includes("name")?le:n.includes("telefono")||n.includes("phone")||n.includes("celular")?oa:n.includes("email")||n.includes("correo")?Ee:n.includes("fecha")||n.includes("date")?de:n.includes("numero")||n.includes("cantidad")?sa:n.includes("documento")||n.includes("cedula")?je:n.includes("cargo")||n.includes("empresa")||n.includes("trabajo")?na:null},w=m=>["nombre","name","titulo","title","cargo","empresa"].some(f=>m.toLowerCase().includes(f));return(m,n)=>(l(),c("div",Ea,[s.showLabel&&s.label?(l(),c("div",Va,[a(e(ra),{class:"h-4 w-4 text-muted-foreground"}),o("label",Ta,d(s.label),1),a(e(H),{variant:"secondary",class:"ml-2"},{default:t(()=>[i(d(y.value.length)+" "+d(y.value.length===1?s.itemName:`${s.itemName}s`),1)]),_:1})])):b("",!0),y.value.length===0?(l(),c("div",Fa," No hay "+d(s.itemName.toLowerCase())+"s registrados ",1)):(l(),c("div",La,[(l(!0),c(P,null,K(y.value,(f,h)=>(l(),_(e(M),{key:f.id,class:"hover:shadow-md transition-all duration-200"},{default:t(()=>[a(e(O),{class:"pb-3"},{default:t(()=>[o("div",Na,[o("div",Ra,[a(e(H),{variant:"outline",class:"font-normal"},{default:t(()=>[i(d(s.itemName)+" "+d(h+1),1)]),_:2},1024)])])]),_:2},1024),a(e(R),{class:"space-y-3"},{default:t(()=>[(l(!0),c(P,null,K(f.data,(N,F)=>(l(),c("div",{key:F,class:"flex flex-col sm:flex-row sm:items-start gap-2"},[o("div",Ma,[T(String(F))?(l(),_(ie(T(String(F))),{key:0,class:"h-4 w-4 text-muted-foreground flex-shrink-0"})):b("",!0),a(e(E),{class:G(["text-sm",w(String(F))?"font-semibold":"font-medium text-muted-foreground"])},{default:t(()=>[i(d(z(String(F)))+": ",1)]),_:2},1032,["class"])]),o("div",Da,[o("p",{class:G(["text-sm",w(String(F))?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"])},d(V(N,String(F))),3)])]))),128)),Object.keys(f.data).length===0?(l(),c("div",Ia," Sin información disponible ")):b("",!0)]),_:2},1024)]),_:2},1024))),128))]))]))}}),Ba={class:"border rounded-lg p-4 space-y-3"},Oa={class:"flex items-start justify-between"},qa={class:"flex-1"},Ua={class:"font-medium text-sm"},Ha={key:0,class:"mt-2"},Pa={key:1,class:"mt-2"},Ga={key:2,class:"text-sm text-muted-foreground mt-1"},Wa={class:"flex items-center gap-2"},Ja={key:0,class:"pt-2 border-t"},Xa={class:"flex items-start gap-2 text-xs text-muted-foreground"},Ka={class:"flex-1"},Za={class:"font-medium"},Qa={key:0,class:"flex items-center gap-1 mt-0.5"},Ya={key:0,class:"mt-2 p-2 bg-muted rounded text-xs"},et={class:"flex items-start gap-1"},at={class:"flex-1"},tt={key:1,class:"flex gap-2 pt-2"},rt={class:"space-y-4 py-4"},ot={key:0,class:"mt-2 p-2 bg-muted rounded"},st={key:1,class:"mt-2 p-2 bg-muted rounded"},nt={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},lt={class:"space-y-4 py-4"},it={key:0,class:"mt-2 p-2 bg-muted rounded"},dt={key:1,class:"mt-2 p-2 bg-muted rounded"},ut={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},ct=Q({__name:"AprobacionCampo",props:{candidaturaId:{},campoId:{},campoTitle:{},valor:{},aprobacion:{},puedeAprobar:{type:Boolean},readonly:{type:Boolean}},emits:["campo-actualizado"],setup(s,{emit:v}){const y=s,V=v,z=S(!1),T=S(!1),w=S(""),m=S(!1),n=D(()=>y.aprobacion?y.aprobacion.aprobado?"aprobado":"rechazado":"pendiente"),f=D(()=>y.aprobacion?y.aprobacion.aprobado?"bg-green-100 text-green-800":"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),h=D(()=>y.aprobacion?y.aprobacion.aprobado?"Aprobado":"Rechazado":"Pendiente"),N=D(()=>y.aprobacion?y.aprobacion.aprobado?W:J:Ve),F=async()=>{var p;m.value=!0;try{const u=await fetch(`/admin/candidaturas/${y.candidaturaId}/campos/${y.campoId}/aprobar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((p=document.querySelector('meta[name="csrf-token"]'))==null?void 0:p.getAttribute("content"))||""},body:JSON.stringify({comentario:w.value||null})}),$=await u.json();u.ok&&$.success?(V("campo-actualizado",$.aprobacion),z.value=!1,w.value=""):console.error("Error al aprobar campo:",$)}catch(u){console.error("Error al aprobar campo:",u)}finally{m.value=!1}},I=async()=>{var p;if(w.value.trim()){m.value=!0;try{const u=await fetch(`/admin/candidaturas/${y.candidaturaId}/campos/${y.campoId}/rechazar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((p=document.querySelector('meta[name="csrf-token"]'))==null?void 0:p.getAttribute("content"))||""},body:JSON.stringify({comentario:w.value})}),$=await u.json();u.ok&&$.success?(V("campo-actualizado",$.aprobacion),T.value=!1,w.value=""):console.error("Error al rechazar campo:",$)}catch(u){console.error("Error al rechazar campo:",u)}finally{m.value=!1}}},j=D(()=>{if(Array.isArray(y.valor)&&y.valor.length>0){const p=y.valor[0];if(typeof p=="string"&&(p.includes("uploads/")||p.includes(".pdf")||p.includes(".doc")||p.includes(".jpg")||p.includes(".png")))return!0}return!1}),C=D(()=>{if(Array.isArray(y.valor)&&y.valor.length>0){const p=y.valor[0];if(typeof p=="object"&&p!==null)return p.hasOwnProperty("id")&&p.hasOwnProperty("data")||typeof p=="object"&&!Array.isArray(p)}return!1}),L=D(()=>typeof y.valor=="object"&&y.valor!==null&&!Array.isArray(y.valor)?y.valor.hasOwnProperty("accepted")&&y.valor.hasOwnProperty("timestamp"):!1),q=p=>{if(j.value||C.value)return"";if(L.value&&typeof p=="object"&&p!==null)if(p.accepted===!0)try{return`✅ Aceptado el ${new Date(p.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return Array.isArray(p)?p.join(", "):typeof p=="object"&&p!==null?JSON.stringify(p):(p==null?void 0:p.toString())||"Sin valor"};return(p,u)=>{var $;return l(),c(P,null,[o("div",Ba,[o("div",Oa,[o("div",qa,[o("h4",Ua,d(s.campoTitle),1),j.value?(l(),c("div",Ha,[a(se,{value:s.valor,label:s.campoTitle},null,8,["value","label"])])):C.value?(l(),c("div",Pa,[a(ne,{value:s.valor,label:s.campoTitle},null,8,["value","label"])])):(l(),c("p",Ga,d(q(s.valor)),1))]),o("div",Wa,[a(e(H),{class:G([f.value,"flex items-center gap-1"])},{default:t(()=>[(l(),_(ie(N.value),{class:"h-3 w-3"})),i(" "+d(h.value),1)]),_:1},8,["class"])])]),($=s.aprobacion)!=null&&$.aprobado_por?(l(),c("div",Ja,[o("div",Xa,[a(e(le),{class:"h-3 w-3 mt-0.5"}),o("div",Ka,[o("p",null,[i(d(s.aprobacion.aprobado?"Aprobado":"Rechazado")+" por ",1),o("span",Za,d(s.aprobacion.aprobado_por.name),1)]),s.aprobacion.fecha_aprobacion?(l(),c("p",Qa,[a(e(de),{class:"h-3 w-3"}),i(" "+d(s.aprobacion.fecha_aprobacion),1)])):b("",!0)])]),s.aprobacion.comentario?(l(),c("div",Ya,[o("div",et,[a(e(X),{class:"h-3 w-3 mt-0.5 text-muted-foreground"}),o("p",at,d(s.aprobacion.comentario),1)])])):b("",!0)])):b("",!0),s.puedeAprobar&&!s.readonly?(l(),c("div",tt,[n.value!=="aprobado"?(l(),_(e(k),{key:0,size:"sm",variant:"outline",class:"text-green-700 border-green-300 hover:bg-green-50",onClick:u[0]||(u[0]=A=>z.value=!0)},{default:t(()=>[a(e(W),{class:"h-3 w-3 mr-1"}),u[8]||(u[8]=i(" Aprobar ",-1))]),_:1})):b("",!0),n.value!=="rechazado"?(l(),_(e(k),{key:1,size:"sm",variant:"outline",class:"text-red-700 border-red-300 hover:bg-red-50",onClick:u[1]||(u[1]=A=>T.value=!0)},{default:t(()=>[a(e(J),{class:"h-3 w-3 mr-1"}),u[9]||(u[9]=i(" Rechazar ",-1))]),_:1})):b("",!0)])):b("",!0)]),a(e(xe),{open:z.value,"onUpdate:open":u[4]||(u[4]=A=>z.value=A)},{default:t(()=>[a(e(he),null,{default:t(()=>[a(e(_e),null,{default:t(()=>[a(e(ke),null,{default:t(()=>[...u[10]||(u[10]=[i("Aprobar Campo",-1)])]),_:1}),a(e(we),null,{default:t(()=>[i(' Estás aprobando el campo "'+d(s.campoTitle)+'". Puedes agregar un comentario opcional. ',1)]),_:1})]),_:1}),o("div",rt,[o("div",null,[a(e(E),null,{default:t(()=>[...u[11]||(u[11]=[i("Valor actual del campo",-1)])]),_:1}),j.value?(l(),c("div",ot,[a(se,{value:s.valor,label:s.campoTitle},null,8,["value","label"])])):C.value?(l(),c("div",st,[a(ne,{value:s.valor,label:s.campoTitle},null,8,["value","label"])])):(l(),c("p",nt,d(q(s.valor)),1))]),o("div",null,[a(e(E),{for:"comentario-aprobacion"},{default:t(()=>[...u[12]||(u[12]=[i(" Comentario (opcional) ",-1)])]),_:1}),a(e(ye),{id:"comentario-aprobacion",modelValue:w.value,"onUpdate:modelValue":u[2]||(u[2]=A=>w.value=A),placeholder:"Agregar comentario...",rows:"3"},null,8,["modelValue"])])]),a(e(Ce),null,{default:t(()=>[a(e(k),{variant:"outline",onClick:u[3]||(u[3]=A=>z.value=!1),disabled:m.value},{default:t(()=>[...u[13]||(u[13]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:F,disabled:m.value,class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[a(e(W),{class:"h-4 w-4 mr-2"}),i(" "+d(m.value?"Aprobando...":"Aprobar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),a(e(xe),{open:T.value,"onUpdate:open":u[7]||(u[7]=A=>T.value=A)},{default:t(()=>[a(e(he),null,{default:t(()=>[a(e(_e),null,{default:t(()=>[a(e(ke),null,{default:t(()=>[...u[14]||(u[14]=[i("Rechazar Campo",-1)])]),_:1}),a(e(we),null,{default:t(()=>[i(' Estás rechazando el campo "'+d(s.campoTitle)+'". Por favor, indica el motivo del rechazo. ',1)]),_:1})]),_:1}),o("div",lt,[o("div",null,[a(e(E),null,{default:t(()=>[...u[15]||(u[15]=[i("Valor actual del campo",-1)])]),_:1}),j.value?(l(),c("div",it,[a(se,{value:s.valor,label:s.campoTitle},null,8,["value","label"])])):C.value?(l(),c("div",dt,[a(ne,{value:s.valor,label:s.campoTitle},null,8,["value","label"])])):(l(),c("p",ut,d(q(s.valor)),1))]),o("div",null,[a(e(E),{for:"comentario-rechazo"},{default:t(()=>[...u[16]||(u[16]=[i(" Motivo del rechazo * ",-1)])]),_:1}),a(e(ye),{id:"comentario-rechazo",modelValue:w.value,"onUpdate:modelValue":u[5]||(u[5]=A=>w.value=A),placeholder:"Explica qué debe corregir el usuario...",rows:"4",required:""},null,8,["modelValue"])])]),a(e(Ce),null,{default:t(()=>[a(e(k),{variant:"outline",onClick:u[6]||(u[6]=A=>T.value=!1),disabled:m.value},{default:t(()=>[...u[17]||(u[17]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{variant:"destructive",onClick:I,disabled:!w.value.trim()||m.value},{default:t(()=>[a(e(J),{class:"h-4 w-4 mr-2"}),i(" "+d(m.value?"Rechazando...":"Rechazar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),mt={class:"space-y-4"},ft={class:"flex items-center justify-between mb-4"},pt={class:"text-lg font-medium text-gray-900 dark:text-gray-100 flex items-center gap-2"},gt={key:0,class:"space-y-3"},vt={key:0,class:"absolute left-5 top-10 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700"},bt={class:"flex gap-3"},yt={class:"relative z-10 flex-shrink-0"},xt={class:"flex-1 pb-4"},ht={class:"flex items-start justify-between mb-3"},_t={class:"flex items-center gap-2 mb-1"},kt={class:"font-medium text-sm"},wt={class:"flex items-center gap-2 text-xs text-muted-foreground"},Ct={key:0,class:"flex items-center gap-1"},$t=["innerHTML"],At={key:1,class:"text-center py-8"},St=Q({__name:"ComentariosHistorial",props:{comentarios:{},puedeAgregar:{type:Boolean,default:!1}},emits:["agregar-comentario"],setup(s){const v=s,y=D(()=>v.comentarios),V=m=>({"message-circle":pa,"check-circle":W,"x-circle":J,"rotate-ccw":va,"sticky-note":ba,"message-square":X})[m]||X,z=m=>{const n={general:"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",aprobacion:"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400",rechazo:"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400",borrador:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400",nota_admin:"bg-gray-100 text-gray-600 dark:bg-gray-900/30 dark:text-gray-400"};return n[m]||n.general},T=m=>({general:"default",aprobacion:"default",rechazo:"destructive",borrador:"secondary",nota_admin:"outline"})[m]||"default",w=m=>{const n=new Date(m);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(n)};return(m,n)=>(l(),c("div",mt,[o("div",ft,[o("h3",pt,[a(e(X),{class:"h-5 w-5"}),n[1]||(n[1]=i(" Historial de Comentarios ",-1)),a(e(H),{variant:"secondary"},{default:t(()=>[i(d(s.comentarios.length),1)]),_:1})]),s.puedeAgregar?(l(),_(e(k),{key:0,onClick:n[0]||(n[0]=f=>m.$emit("agregar-comentario")),size:"sm",variant:"outline"},{default:t(()=>[a(e(Te),{class:"h-4 w-4 mr-2"}),n[2]||(n[2]=i(" Agregar comentario ",-1))]),_:1})):b("",!0)]),s.comentarios.length>0?(l(),c("div",gt,[a(We,{name:"fade"},{default:t(()=>[(l(!0),c(P,null,K(y.value,f=>(l(),c("div",{key:f.id,class:"relative"},[y.value.indexOf(f)<y.value.length-1?(l(),c("div",vt)):b("",!0),o("div",bt,[o("div",yt,[o("div",{class:G(["w-10 h-10 rounded-full flex items-center justify-center",z(f.tipo)])},[(l(),_(ie(V(f.tipo_icon)),{class:"h-5 w-5"}))],2)]),o("div",xt,[a(e(M),null,{default:t(()=>[a(e(R),{class:"pt-4"},{default:t(()=>{var h;return[o("div",ht,[o("div",null,[o("div",_t,[o("span",kt,d(((h=f.created_by)==null?void 0:h.name)||"Sistema"),1),a(e(H),{variant:T(f.tipo)},{default:t(()=>[i(d(f.tipo_label),1)]),_:2},1032,["variant"]),f.version_candidatura?(l(),_(e(H),{key:0,variant:"outline"},{default:t(()=>[i(" v"+d(f.version_candidatura),1)]),_:2},1024)):b("",!0)]),o("div",wt,[a(e(de),{class:"h-3 w-3"}),o("span",null,d(w(f.fecha)),1),n[5]||(n[5]=o("span",null,"•",-1)),o("span",null,d(f.fecha_relativa),1),f.enviado_por_email?(l(),c("span",Ct,[n[3]||(n[3]=o("span",null,"•",-1)),a(e(Ee),{class:"h-3 w-3"}),n[4]||(n[4]=o("span",null,"Notificado",-1))])):b("",!0)])])]),o("div",{class:"prose prose-sm max-w-none dark:prose-invert",innerHTML:f.comentario},null,8,$t)]}),_:2},1024)]),_:2},1024)])])]))),128))]),_:1})])):(l(),c("div",At,[a(e(ga),{class:"h-12 w-12 text-gray-400 mx-auto mb-3"}),n[6]||(n[6]=o("p",{class:"text-sm text-muted-foreground"}," No hay comentarios históricos ",-1))]))]))}}),zt=la(St,[["__scopeId","data-v-e630c3bf"]]),jt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Et={class:"flex items-center justify-between"},Vt={class:"text-3xl font-bold"},Tt={class:"text-muted-foreground"},Ft={class:"flex items-center justify-between"},Lt={class:"flex items-center gap-4"},Nt={class:"flex items-center gap-2"},Rt={class:"text-sm text-muted-foreground"},Mt={key:0,class:"flex items-center gap-2 text-sm"},Dt={class:"text-muted-foreground"},It={key:0,class:"flex gap-2"},Bt={class:"flex justify-end gap-2"},Ot={key:0,class:"text-sm text-destructive mt-1"},qt={class:"flex justify-end gap-2"},Ut={class:"p-4 bg-orange-100 dark:bg-orange-900/30 rounded-lg"},Ht={class:"flex items-start gap-3"},Pt={key:0,class:"text-sm text-destructive mt-1"},Gt={class:"flex justify-end gap-2"},Wt={class:"grid gap-4 md:grid-cols-2"},Jt={class:"text-muted-foreground"},Xt={class:"text-muted-foreground"},Kt={class:"text-muted-foreground"},Zt={class:"text-muted-foreground"},Qt={class:"flex items-center gap-2"},Yt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},er={class:"text-center"},ar={class:"text-2xl font-bold"},tr={class:"text-center"},rr={class:"text-2xl font-bold text-green-600"},or={class:"text-center"},sr={class:"text-2xl font-bold text-red-600"},nr={class:"text-center"},lr={class:"text-2xl font-bold text-yellow-600"},ir={class:"mt-4"},dr={class:"flex justify-between text-sm mb-1"},ur={class:"w-full bg-gray-200 rounded-full h-2"},cr=["innerHTML"],mr={key:0,class:"mt-4 pt-4 border-t border-blue-200 dark:border-blue-700"},fr={class:"flex items-center space-x-3"},pr={class:"flex justify-end gap-2"},gr={key:0,class:"text-center py-8"},vr={key:1,class:"space-y-6"},br={key:0},yr={key:0,class:"text-red-500"},xr={key:0,class:"text-xs text-muted-foreground mb-2"},hr={class:"mt-2"},_r={key:2,class:"text-muted-foreground"},kr={key:1,class:"space-y-4"},Io=Q({__name:"Show",props:{candidatura:{},configuracion_campos:{},campo_aprobaciones:{},resumen_aprobaciones:{},puede_aprobar_campos:{type:Boolean},puede_comentar:{type:Boolean},comentarios:{}},setup(s){var fe;const v=s,V=((fe=Je().props.auth)==null?void 0:fe.user)||null,z=Xe(v.campo_aprobaciones||{}),T=x=>{z[x.campo_id]=x,pe.reload({only:["resumen_aprobaciones"]})},w=S(!1),m=[{title:"Admin",href:"/admin/dashboard"},{title:"Candidaturas",href:"/admin/candidaturas"},{title:v.candidatura.usuario.name,href:"#"}],n=S(!1),f=S(!1),h=S(!1),N=S(v.candidatura.subsanar),F=S(!1),I=S(""),j=te({comentarios:""}),C=te({comentarios:""}),L=te({motivo:""}),q=S(!1),p=S(v.comentarios||[]),u=S(!1),$=S(!1),A=S(""),B=te({comentario:"",tipo:"general",enviar_email:!1}),Fe=D(()=>v.candidatura.estado==="pendiente"&&!ue(v.candidatura.formulario_data)),Le=D(()=>v.candidatura.estado==="pendiente"),Ne=D(()=>v.candidatura.estado==="aprobado"||v.candidatura.estado==="rechazado"||v.candidatura.estado==="pendiente"),ue=x=>!x||Object.keys(x).length===0,Re=()=>{j.post(`/admin/candidaturas/${v.candidatura.id}/aprobar`,{onSuccess:()=>{if(n.value=!1,j.comentarios){const x=Y(j.comentarios,"aprobacion");p.value.unshift(x),v.candidatura.comentarios_admin=j.comentarios,u.value=!0}}})},Me=()=>{C.comentarios.trim()&&C.post(`/admin/candidaturas/${v.candidatura.id}/rechazar`,{onSuccess:()=>{f.value=!1;const x=Y(C.comentarios,"rechazo");p.value.unshift(x),v.candidatura.comentarios_admin=C.comentarios,u.value=!0}})},De=()=>{j.reset(),n.value=!1},Ie=()=>{C.reset(),f.value=!1},Be=()=>{L.post(`/admin/candidaturas/${v.candidatura.id}/volver-borrador`,{onSuccess:()=>{if(h.value=!1,N.value=!0,L.motivo){const x=Y(L.motivo,"borrador");p.value.unshift(x),v.candidatura.comentarios_admin=L.motivo,u.value=!0}I.value="Candidatura devuelta a borrador con subsanación habilitada",setTimeout(()=>{I.value=""},3e3)}})},Oe=()=>{L.reset(),h.value=!1},Y=(x,r)=>{const g=new Date,ee={general:"Comentario General",aprobacion:"Aprobación",rechazo:"Rechazo",borrador:"Vuelta a Borrador",nota_admin:"Nota Administrativa"},ae={general:"bg-blue-100 text-blue-800",aprobacion:"bg-green-100 text-green-800",rechazo:"bg-red-100 text-red-800",borrador:"bg-yellow-100 text-yellow-800",nota_admin:"bg-gray-100 text-gray-800"},Ge={general:"message-circle",aprobacion:"check-circle",rechazo:"x-circle",borrador:"rotate-ccw",nota_admin:"sticky-note"};return{id:Date.now(),comentario:x,tipo:r,tipo_label:ee[r]||"Desconocido",tipo_color:ae[r]||"bg-gray-100 text-gray-800",tipo_icon:Ge[r]||"message-square",version_candidatura:v.candidatura.version,enviado_por_email:!0,created_by:V?{id:V.id,name:V.name,email:V.email}:void 0,fecha:g.toISOString(),fecha_formateada:g.toLocaleDateString("es-ES")+" "+g.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),fecha_relativa:"hace unos segundos"}},qe=async()=>{if(B.comentario.trim()){$.value=!0;try{const x=await ge.post(`/admin/candidaturas/${v.candidatura.id}/comentarios`,{comentario:B.comentario,tipo:B.tipo,enviar_email:B.enviar_email});x.data.success&&(p.value.unshift(x.data.comentario),v.candidatura.comentarios_admin=x.data.comentario.comentario,B.reset(),q.value=!1,u.value=!0,A.value=x.data.message||"Comentario agregado exitosamente",setTimeout(()=>{A.value=""},5e3),setTimeout(()=>{const r=document.querySelector("#historial-comentarios");r&&r.scrollIntoView({behavior:"smooth",block:"nearest"})},100))}catch(x){console.error("Error al agregar comentario:",x)}finally{$.value=!1}}},Ue=()=>{B.reset(),q.value=!1},He=async()=>{F.value=!0,I.value="";try{const x=await ge.post(`/admin/candidaturas/${v.candidatura.id}/toggle-subsanar`);if(x.data.success){N.value=x.data.subsanar,I.value=x.data.message;const r=x.data.subsanar?"Se habilitó la subsanación para esta candidatura":"Se deshabilitó la subsanación para esta candidatura",g=Y(r,"nota_admin");p.value.unshift(g),setTimeout(()=>{I.value=""},3e3)}}catch(x){console.error("Error al cambiar estado de subsanación:",x),I.value="Error al cambiar el estado de subsanación",setTimeout(()=>{I.value=""},3e3)}finally{F.value=!1}},ce=()=>{q.value=!0,setTimeout(()=>{const x=document.querySelector("#formulario-comentario");x&&x.scrollIntoView({behavior:"smooth",block:"center"})},100)},Pe=(x,r)=>{if(!r)return"No especificado";switch(x.type){case"checkbox":return Array.isArray(r)?r.join(", "):r;case"date":case"datepicker":try{return new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return r}case"disclaimer":if(typeof r=="object"&&r!==null)if(r.accepted===!0)try{return`✅ Aceptado el ${new Date(r.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return r;case"file":return null;case"repeater":return null;case"textarea":return r;default:return r}},me=x=>new Date(x).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(x,r)=>(l(),c(P,null,[a(e(Ke),{title:`Candidatura - ${s.candidatura.usuario.name}`},null,8,["title"]),a(ia,{breadcrumbs:m},{default:t(()=>[o("div",jt,[o("div",Et,[o("div",null,[o("h1",Vt,d(s.candidatura.usuario.name),1),o("p",Tt," Candidatura "+d(s.candidatura.estado_label)+" - Versión "+d(s.candidatura.version),1)]),a(e(k),{variant:"outline",onClick:r[0]||(r[0]=g=>e(pe).visit("/admin/candidaturas"))},{default:t(()=>[a(e(da),{class:"mr-2 h-4 w-4"}),r[11]||(r[11]=i(" Volver a Lista ",-1))]),_:1})]),a(e(M),null,{default:t(()=>[a(e(R),{class:"p-6"},{default:t(()=>[o("div",Ft,[o("div",Lt,[o("div",Nt,[a(e(H),{class:G([s.candidatura.estado_color,"text-sm"])},{default:t(()=>[i(d(s.candidatura.estado_label),1)]),_:1},8,["class"]),o("span",Rt," Versión "+d(s.candidatura.version),1)]),s.candidatura.aprobado_por?(l(),c("div",Mt,[a(e(le),{class:"h-4 w-4"}),o("span",null,d(s.candidatura.aprobado_por.name),1),o("span",Dt,"- "+d(s.candidatura.fecha_aprobacion),1)])):b("",!0)]),!n.value&&!f.value&&!h.value&&!q.value?(l(),c("div",It,[Fe.value?(l(),_(e(k),{key:0,onClick:r[1]||(r[1]=g=>n.value=!0),class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[a(e(W),{class:"mr-2 h-4 w-4"}),r[12]||(r[12]=i(" Aprobar ",-1))]),_:1})):b("",!0),Le.value?(l(),_(e(k),{key:1,variant:"destructive",onClick:r[2]||(r[2]=g=>f.value=!0)},{default:t(()=>[a(e(J),{class:"mr-2 h-4 w-4"}),r[13]||(r[13]=i(" Rechazar ",-1))]),_:1})):b("",!0),Ne.value?(l(),_(e(k),{key:2,variant:"outline",onClick:r[3]||(r[3]=g=>h.value=!0),class:"border-orange-300 text-orange-700 hover:bg-orange-50"},{default:t(()=>[a(e(ze),{class:"mr-2 h-4 w-4"}),r[14]||(r[14]=i(" Volver a Borrador ",-1))]),_:1})):b("",!0),s.candidatura.estado==="borrador"?(l(),_(e(k),{key:3,onClick:He,disabled:F.value,variant:N.value?"default":"outline",class:G(N.value?"bg-blue-600 hover:bg-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50")},{default:t(()=>[F.value?(l(),_(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(l(),_(ie(N.value?e(ua):e(ca)),{key:1,class:"mr-2 h-4 w-4"})),i(" "+d(N.value?"Subsanación Habilitada":"Habilitar Subsanación"),1)]),_:1},8,["disabled","variant","class"])):b("",!0),s.puede_comentar?(l(),_(e(k),{key:4,variant:"outline",onClick:ce,class:"border-indigo-300 text-indigo-600 hover:bg-indigo-50"},{default:t(()=>[a(e(X),{class:"mr-2 h-4 w-4"}),r[15]||(r[15]=i(" Agregar Comentario ",-1))]),_:1})):b("",!0)])):b("",!0)])]),_:1})]),_:1}),n.value?(l(),_(e(M),{key:0,class:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20"},{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"text-green-800 dark:text-green-200 flex items-center gap-2"},{default:t(()=>[a(e(W),{class:"h-5 w-5"}),r[16]||(r[16]=i(" Aprobar Candidatura ",-1))]),_:1})]),_:1}),a(e(R),{class:"space-y-4"},{default:t(()=>[o("div",null,[a(e(E),{for:"approval_comments"},{default:t(()=>[...r[17]||(r[17]=[i("Comentarios (opcional)",-1)])]),_:1}),a(oe,{modelValue:e(j).comentarios,"onUpdate:modelValue":r[4]||(r[4]=g=>e(j).comentarios=g),placeholder:"Comentarios adicionales para el usuario...",rows:3},null,8,["modelValue"])]),o("div",Bt,[a(e(k),{variant:"outline",onClick:De,disabled:e(j).processing},{default:t(()=>[...r[18]||(r[18]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:Re,disabled:e(j).processing,class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[i(d(e(j).processing?"Aprobando...":"Confirmar Aprobación"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),f.value?(l(),_(e(M),{key:1,class:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/20"},{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"text-red-800 dark:text-red-200 flex items-center gap-2"},{default:t(()=>[a(e(J),{class:"h-5 w-5"}),r[19]||(r[19]=i(" Rechazar Candidatura ",-1))]),_:1})]),_:1}),a(e(R),{class:"space-y-4"},{default:t(()=>[o("div",null,[a(e(E),{for:"rejection_comments"},{default:t(()=>[...r[20]||(r[20]=[i("Motivo del rechazo *",-1)])]),_:1}),a(oe,{modelValue:e(C).comentarios,"onUpdate:modelValue":r[5]||(r[5]=g=>e(C).comentarios=g),placeholder:"Explica al usuario qué debe corregir...",rows:4},null,8,["modelValue"]),e(C).errors.comentarios?(l(),c("p",Ot,d(e(C).errors.comentarios),1)):b("",!0)]),o("div",qt,[a(e(k),{variant:"outline",onClick:Ie,disabled:e(C).processing},{default:t(()=>[...r[21]||(r[21]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{variant:"destructive",onClick:Me,disabled:!e(C).comentarios.trim()||e(C).processing},{default:t(()=>[i(d(e(C).processing?"Rechazando...":"Confirmar Rechazo"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),h.value?(l(),_(e(M),{key:2,class:"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-950/20"},{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"text-orange-800 dark:text-orange-200 flex items-center gap-2"},{default:t(()=>[a(e(ze),{class:"h-5 w-5"}),r[22]||(r[22]=i(" Volver Candidatura a Borrador ",-1))]),_:1})]),_:1}),a(e(R),{class:"space-y-4"},{default:t(()=>[o("div",Ut,[o("div",Ht,[a(e(Ae),{class:"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5"}),r[23]||(r[23]=o("div",{class:"text-sm text-orange-800 dark:text-orange-200"},[o("p",{class:"font-medium"},'Esta acción volverá la candidatura al estado "Borrador"'),o("p",{class:"mt-1"},"El usuario podrá editar su candidatura nuevamente y deberá ser revisada otra vez.")],-1))])]),o("div",null,[a(e(E),{for:"revert_reason"},{default:t(()=>[...r[24]||(r[24]=[i("Motivo (opcional)",-1)])]),_:1}),a(oe,{modelValue:e(L).motivo,"onUpdate:modelValue":r[6]||(r[6]=g=>e(L).motivo=g),placeholder:"Explica al usuario por qué su candidatura volvió a borrador...",rows:3},null,8,["modelValue"]),e(L).errors.motivo?(l(),c("p",Pt,d(e(L).errors.motivo),1)):b("",!0)]),o("div",Gt,[a(e(k),{variant:"outline",onClick:Oe,disabled:e(L).processing},{default:t(()=>[...r[25]||(r[25]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:Be,disabled:e(L).processing,class:"bg-orange-600 hover:bg-orange-700"},{default:t(()=>[i(d(e(L).processing?"Procesando...":"Confirmar"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),a(e(M),null,{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"flex items-center gap-2"},{default:t(()=>[a(e(le),{class:"h-5 w-5"}),r[26]||(r[26]=i(" Información del Usuario ",-1))]),_:1})]),_:1}),a(e(R),null,{default:t(()=>[o("div",Wt,[o("div",null,[a(e(E),{class:"text-sm font-medium"},{default:t(()=>[...r[27]||(r[27]=[i("Nombre",-1)])]),_:1}),o("p",Jt,d(s.candidatura.usuario.name),1)]),o("div",null,[a(e(E),{class:"text-sm font-medium"},{default:t(()=>[...r[28]||(r[28]=[i("Email",-1)])]),_:1}),o("p",Xt,d(s.candidatura.usuario.email),1)]),o("div",null,[a(e(E),{class:"text-sm font-medium"},{default:t(()=>[...r[29]||(r[29]=[i("Fecha de creación",-1)])]),_:1}),o("p",Kt,d(me(s.candidatura.created_at)),1)]),o("div",null,[a(e(E),{class:"text-sm font-medium"},{default:t(()=>[...r[30]||(r[30]=[i("Última actualización",-1)])]),_:1}),o("p",Zt,d(me(s.candidatura.updated_at)),1)])])]),_:1})]),_:1}),s.resumen_aprobaciones&&s.puede_aprobar_campos?(l(),_(e(M),{key:3,class:"border-indigo-200 dark:border-indigo-800"},{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"flex items-center justify-between"},{default:t(()=>[o("span",Qt,[a(e(ma),{class:"h-5 w-5"}),r[31]||(r[31]=i(" Aprobación de Campos ",-1))]),a(e(k),{variant:"outline",size:"sm",onClick:r[7]||(r[7]=g=>w.value=!w.value)},{default:t(()=>[i(d(w.value?"Ocultar Aprobaciones":"Mostrar Aprobaciones"),1)]),_:1})]),_:1})]),_:1}),a(e(R),null,{default:t(()=>[o("div",Yt,[o("div",er,[o("p",ar,d(s.resumen_aprobaciones.total),1),r[32]||(r[32]=o("p",{class:"text-xs text-muted-foreground"},"Total Campos",-1))]),o("div",tr,[o("p",rr,d(s.resumen_aprobaciones.aprobados),1),r[33]||(r[33]=o("p",{class:"text-xs text-muted-foreground"},"Aprobados",-1))]),o("div",or,[o("p",sr,d(s.resumen_aprobaciones.rechazados),1),r[34]||(r[34]=o("p",{class:"text-xs text-muted-foreground"},"Rechazados",-1))]),o("div",nr,[o("p",lr,d(s.resumen_aprobaciones.pendientes),1),r[35]||(r[35]=o("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))])]),o("div",ir,[o("div",dr,[r[36]||(r[36]=o("span",null,"Progreso de Aprobación",-1)),o("span",null,d(s.resumen_aprobaciones.porcentaje_aprobado)+"%",1)]),o("div",ur,[o("div",{class:"bg-green-600 h-2 rounded-full transition-all",style:Ze({width:`${s.resumen_aprobaciones.porcentaje_aprobado}%`})},null,4)])])]),_:1})]),_:1})):b("",!0),a(re,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:t(()=>[A.value?(l(),_(e(ve),{key:0,class:"border-green-200 bg-green-50 dark:bg-green-950/20"},{default:t(()=>[a(e(fa),{class:"h-4 w-4 text-green-600"}),a(e(be),{class:"text-green-800 dark:text-green-200"},{default:t(()=>[i(d(A.value),1)]),_:1})]),_:1})):b("",!0)]),_:1}),a(re,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:t(()=>[I.value?(l(),_(e(ve),{key:0,class:"border-blue-200 bg-blue-50 dark:bg-blue-950/20"},{default:t(()=>[a(e(ya),{class:"h-4 w-4 text-blue-600"}),a(e(be),{class:"text-blue-800 dark:text-blue-200"},{default:t(()=>[i(d(I.value),1)]),_:1})]),_:1})):b("",!0)]),_:1}),s.candidatura.comentarios_admin?(l(),_(e(M),{key:4,class:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20"},{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"text-blue-800 dark:text-blue-200 flex items-center gap-2"},{default:t(()=>[a(e(X),{class:"h-5 w-5"}),r[37]||(r[37]=i(" Comentarios de la comisión (actual) ",-1)),a(re,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"transform opacity-0 scale-75","enter-to-class":"transform opacity-100 scale-100"},{default:t(()=>[p.value.length>1?(l(),_(e(H),{variant:"secondary",key:p.value.length},{default:t(()=>[i(" +"+d(p.value.length-1)+" históricos ",1)]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1}),a(e(R),null,{default:t(()=>[o("div",{class:"text-blue-700 dark:text-blue-300 prose prose-sm max-w-none",innerHTML:s.candidatura.comentarios_admin},null,8,cr),p.value.length>0?(l(),c("div",mr,[a(e(k),{onClick:r[8]||(r[8]=g=>u.value=!u.value),variant:"ghost",size:"sm",class:"text-blue-600 hover:text-blue-700"},{default:t(()=>[a(e(Se),{class:"h-4 w-4 mr-2"}),i(" "+d(u.value?"Ocultar":"Ver")+" historial de comentarios ",1)]),_:1})])):b("",!0)]),_:1})]),_:1})):b("",!0),q.value&&s.puede_comentar?(l(),_(e(M),{key:5,id:"formulario-comentario",class:"border-indigo-200 dark:border-indigo-800 bg-indigo-50 dark:bg-indigo-950/20"},{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"text-indigo-800 dark:text-indigo-200 flex items-center gap-2"},{default:t(()=>[a(e(Te),{class:"h-5 w-5"}),r[38]||(r[38]=i(" Agregar Comentario ",-1))]),_:1})]),_:1}),a(e(R),{class:"space-y-4"},{default:t(()=>[o("div",null,[a(e(E),{for:"nuevo_comentario"},{default:t(()=>[...r[39]||(r[39]=[i("Comentario *",-1)])]),_:1}),a(oe,{modelValue:e(B).comentario,"onUpdate:modelValue":r[9]||(r[9]=g=>e(B).comentario=g),placeholder:"Escribe tu comentario aquí...",rows:4},null,8,["modelValue"])]),o("div",fr,[a(e(Qe),{id:"enviar-email",checked:e(B).enviar_email,"onUpdate:checked":r[10]||(r[10]=g=>e(B).enviar_email=g)},null,8,["checked"]),a(e(E),{for:"enviar-email",class:"cursor-pointer"},{default:t(()=>[...r[40]||(r[40]=[i(" Notificar al usuario por correo electrónico ",-1)])]),_:1})]),o("div",pr,[a(e(k),{variant:"outline",onClick:Ue,disabled:$.value},{default:t(()=>[...r[41]||(r[41]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:qe,disabled:!e(B).comentario.trim()||$.value,class:"bg-indigo-600 hover:bg-indigo-700"},{default:t(()=>[$.value?(l(),_(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):b("",!0),i(" "+d($.value?"Guardando...":"Guardar comentario"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),a(re,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 translate-y-4","enter-to-class":"transform opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 translate-y-0","leave-to-class":"transform opacity-0 translate-y-4"},{default:t(()=>[u.value&&p.value.length>0?(l(),_(e(M),{key:0,id:"historial-comentarios"},{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"flex items-center gap-2"},{default:t(()=>[a(e(Se),{class:"h-5 w-5"}),r[42]||(r[42]=i(" Historial de Comentarios ",-1))]),_:1})]),_:1}),a(e(R),null,{default:t(()=>[a(zt,{comentarios:p.value,"puede-agregar":!0,onAgregarComentario:ce},null,8,["comentarios"])]),_:1})]),_:1})):b("",!0)]),_:1}),a(e(M),null,{default:t(()=>[a(e(O),null,{default:t(()=>[a(e(U),{class:"flex items-center gap-2"},{default:t(()=>[a(e(Ve),{class:"h-5 w-5"}),r[43]||(r[43]=i(" Datos de la Candidatura ",-1))]),_:1})]),_:1}),a(e(R),null,{default:t(()=>[ue(s.candidatura.formulario_data)?(l(),c("div",gr,[a(e(Ae),{class:"mx-auto h-12 w-12 text-yellow-500"}),r[44]||(r[44]=o("h3",{class:"mt-4 text-lg font-medium"},"Candidatura vacía",-1)),r[45]||(r[45]=o("p",{class:"text-muted-foreground"},"El usuario aún no ha completado su perfil de candidatura.",-1))])):(l(),c("div",vr,[w.value?(l(),c("div",kr,[(l(!0),c(P,null,K(s.configuracion_campos,g=>(l(),_(ct,{key:g.id,"candidatura-id":s.candidatura.id,"campo-id":g.id,"campo-title":g.title,valor:s.candidatura.formulario_data[g.id],aprobacion:z[g.id],"puede-aprobar":s.puede_aprobar_campos,readonly:s.candidatura.estado==="aprobado",onCampoActualizado:T},null,8,["candidatura-id","campo-id","campo-title","valor","aprobacion","puede-aprobar","readonly"]))),128))])):(l(),c("div",br,[(l(!0),c(P,null,K(s.configuracion_campos,g=>{var ee,ae;return l(),c("div",{key:g.id,class:"border-b pb-4 last:border-b-0"},[a(e(E),{class:"text-sm font-medium flex items-center gap-1"},{default:t(()=>[i(d(g.title)+" ",1),g.required?(l(),c("span",yr,"*")):b("",!0)]),_:2},1024),g.description?(l(),c("p",xr,d(g.description),1)):b("",!0),o("div",hr,[g.type==="file"?(l(),_(se,{key:0,value:s.candidatura.formulario_data[g.id],label:g.title},null,8,["value","label"])):g.type==="repeater"?(l(),_(ne,{key:1,value:s.candidatura.formulario_data[g.id],label:g.title,fields:(ee=g.repeaterConfig)==null?void 0:ee.fields,"item-name":((ae=g.repeaterConfig)==null?void 0:ae.itemName)||"Elemento"},null,8,["value","label","fields","item-name"])):(l(),c("p",_r,d(Pe(g,s.candidatura.formulario_data[g.id])),1))])])}),128))]))]))]),_:1})]),_:1}),a(Ye,{"candidatura-id":s.candidatura.id,"version-actual":s.candidatura.version,"is-admin":!0},null,8,["candidatura-id","version-actual"])])]),_:1})],64))}});export{Io as default};
