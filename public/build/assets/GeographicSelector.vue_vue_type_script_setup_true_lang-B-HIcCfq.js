import{c as te}from"./createLucideIcon-BfVy0SFr.js";import{_ as ie,a as oe,b as se,c as de}from"./CardTitle.vue_vue_type_script_setup_true_lang-CfXCxct6.js";import{_ as N}from"./Label.vue_vue_type_script_setup_true_lang-B6qLE2NP.js";import{_ as M,a as T,b as E,c as A,d as P}from"./SelectValue.vue_vue_type_script_setup_true_lang-DhdtXOhv.js";import{d as re,k,c as v,y as ue,w as ne,p as ce,j as h,o as u,l as X,u as i,n as me,e as s,i as _,b as d,f as Y,g as f,t as c,a as p,r as F,F as G,H as w}from"./app-DDSU5uN7.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=te("ChevronsUpDownIcon",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),pe={class:"text-sm text-muted-foreground"},fe={class:"w-full"},ve={key:0,class:"text-xs text-muted-foreground mt-1"},_e={key:0,class:"w-full"},he={key:0,class:"text-xs text-muted-foreground mt-1"},ge={key:1,class:"w-full"},we={key:0,class:"text-xs text-muted-foreground mt-1"},ye={key:2,class:"w-full"},be={key:0,class:"text-xs text-muted-foreground mt-1"},Be=re({__name:"GeographicSelector",props:{modelValue:{default:()=>({territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[]})},disabled:{type:Boolean,default:!1},title:{default:"Ubicación Geográfica"},description:{default:"Selecciona la ubicación"},mode:{default:"multiple"},showCard:{type:Boolean,default:!0},municipioLabel:{default:"Municipio"},showLocalidad:{type:Boolean,default:!0},showDepartamento:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(Z,{emit:I}){const n=Z,ee=I,q=k([]),C=k([]),L=k([]),B=k([]),m=k(!1),o=v(()=>n.mode==="multiple"),y=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.territorios_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.territorio_id;return l?[l]:[]}}),g=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.departamentos_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.departamento_id;return l?[l]:[]}}),b=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.municipios_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.municipio_id;return l?[l]:[]}}),z=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.localidades_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.localidad_id;return l?[l]:[]}}),J=ue();v(()=>{var e;return((e=J.props.auth)==null?void 0:e.isAdmin)||!1});const ae=v(()=>{var e;return!!((e=J.props.auth)!=null&&e.user)}),j=v(()=>ae.value?window.location.pathname.startsWith("/admin")?"/admin/geographic":"/api/geographic":"/api/public/geographic");ne(g,e=>{e.length>0&&D(e)},{immediate:!1});const le=async()=>{try{m.value=!0;const e=await fetch(`${j.value}/territorios`);q.value=await e.json()}catch(e){console.error("Error loading territorios:",e)}finally{m.value=!1}},H=async e=>{if(!e.length){C.value=[];return}try{m.value=!0;const a=await fetch(`${j.value}/departamentos?territorio_ids=${e.join(",")}`);C.value=await a.json()}catch(a){console.error("Error loading departamentos:",a)}finally{m.value=!1}},D=async e=>{if(!e.length){L.value=[];return}try{m.value=!0;const a=await fetch(`${j.value}/municipios?departamento_ids=${e.join(",")}`);L.value=await a.json()}catch(a){console.error("Error loading municipios:",a)}finally{m.value=!1}},W=async e=>{if(!e.length){B.value=[];return}try{m.value=!0;const a=await fetch(`${j.value}/localidades?municipio_ids=${e.join(",")}`);B.value=await a.json()}catch(a){console.error("Error loading localidades:",a)}finally{m.value=!1}},U=(e,a)=>{var V,$,S,t,K,O,Q,R;let l;if(o.value){const r=Array.isArray(e)?e.map(Number).filter(Boolean):e?[Number(e)].filter(Boolean):[];l={territorios_ids:((V=n.modelValue)==null?void 0:V.territorios_ids)||[],departamentos_ids:(($=n.modelValue)==null?void 0:$.departamentos_ids)||[],municipios_ids:((S=n.modelValue)==null?void 0:S.municipios_ids)||[],localidades_ids:((t=n.modelValue)==null?void 0:t.localidades_ids)||[]},a==="territorio"?(l.territorios_ids=r,l.departamentos_ids=[],l.municipios_ids=[],l.localidades_ids=[],w(()=>H(r))):a==="departamento"?(l.departamentos_ids=r,l.municipios_ids=[],l.localidades_ids=[],w(()=>D(r))):a==="municipio"?(l.municipios_ids=r,l.localidades_ids=[],w(()=>W(r))):a==="localidad"&&(l.localidades_ids=r)}else{const r=e?Number(e):void 0;l={territorio_id:(K=n.modelValue)==null?void 0:K.territorio_id,departamento_id:(O=n.modelValue)==null?void 0:O.departamento_id,municipio_id:(Q=n.modelValue)==null?void 0:Q.municipio_id,localidad_id:(R=n.modelValue)==null?void 0:R.localidad_id},a==="territorio"?(l.territorio_id=r,l.departamento_id=void 0,l.municipio_id=void 0,l.localidad_id=void 0,w(()=>H(r?[r]:[]))):a==="departamento"?(l.departamento_id=r,l.municipio_id=void 0,l.localidad_id=void 0,w(()=>D(r?[r]:[]))):a==="municipio"?(l.municipio_id=r,l.localidad_id=void 0,w(()=>W(r?[r]:[]))):a==="localidad"&&(l.localidad_id=r)}ee("update:modelValue",l)};ce(async()=>{await le(),y.value.length&&await H(y.value),g.value.length&&await D(g.value),b.value.length&&await W(b.value)});const x=(e,a,l)=>o.value?`${e} ${e===1?a:l} seleccionado${e===1?"":"s"}`:"";return(e,a)=>(u(),h(X(e.showCard?i(ie):"div"),{class:me(e.showCard?"border-dashed":"")},{default:s(()=>[e.showCard?(u(),h(i(oe),{key:0},{default:s(()=>[d(i(se),{class:"text-base"},{default:s(()=>[f(c(e.title),1)]),_:1}),Y("p",pe,c(e.description),1)]),_:1})):_("",!0),(u(),h(X(e.showCard?i(de):"div"),{class:"space-y-4"},{default:s(()=>{var l,V,$,S;return[Y("div",fe,[d(i(N),null,{default:s(()=>[f("Territorio"+c(o.value?"s":""),1)]),_:1}),d(i(M),{"model-value":o.value?y.value.map(t=>t.toString()):((l=y.value[0])==null?void 0:l.toString())||"","onUpdate:modelValue":a[0]||(a[0]=t=>U(t,"territorio")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(i(T),{class:"w-full"},{default:s(()=>[d(i(E),{placeholder:`Seleccionar territorio${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),d(i(A),null,{default:s(()=>[(u(!0),p(G,null,F(q.value,t=>(u(),h(i(P),{key:t.id,value:t.id.toString()},{default:s(()=>[f(c(t.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",ve,c(x(y.value.length,"territorio","territorios")),1)):_("",!0)]),e.showDepartamento&&C.value.length>0?(u(),p("div",_e,[d(i(N),null,{default:s(()=>[f("Departamento"+c(o.value?"s":""),1)]),_:1}),d(i(M),{"model-value":o.value?g.value.map(t=>t.toString()):((V=g.value[0])==null?void 0:V.toString())||"","onUpdate:modelValue":a[1]||(a[1]=t=>U(t,"departamento")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(i(T),{class:"w-full"},{default:s(()=>[d(i(E),{placeholder:`Seleccionar departamento${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),d(i(A),null,{default:s(()=>[(u(!0),p(G,null,F(C.value,t=>(u(),h(i(P),{key:t.id,value:t.id.toString()},{default:s(()=>[f(c(t.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",he,c(x(g.value.length,"departamento","departamentos")),1)):_("",!0)])):_("",!0),L.value.length>0?(u(),p("div",ge,[d(i(N),null,{default:s(()=>[f(c(e.municipioLabel)+c(o.value?"s":""),1)]),_:1}),d(i(M),{"model-value":o.value?b.value.map(t=>t.toString()):(($=b.value[0])==null?void 0:$.toString())||"","onUpdate:modelValue":a[2]||(a[2]=t=>U(t,"municipio")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(i(T),{class:"w-full"},{default:s(()=>[d(i(E),{placeholder:`Seleccionar ${e.municipioLabel.toLowerCase()}${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),d(i(A),null,{default:s(()=>[(u(!0),p(G,null,F(L.value,t=>(u(),h(i(P),{key:t.id,value:t.id.toString()},{default:s(()=>[f(c(t.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",we,c(x(b.value.length,e.municipioLabel.toLowerCase(),e.municipioLabel.toLowerCase()+"s")),1)):_("",!0)])):_("",!0),e.showLocalidad&&B.value.length>0?(u(),p("div",ye,[d(i(N),null,{default:s(()=>[f("Localidad"+c(o.value?"es":""),1)]),_:1}),d(i(M),{"model-value":o.value?z.value.map(t=>t.toString()):((S=z.value[0])==null?void 0:S.toString())||"","onUpdate:modelValue":a[3]||(a[3]=t=>U(t,"localidad")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(i(T),{class:"w-full"},{default:s(()=>[d(i(E),{placeholder:`Seleccionar localidad${o.value?"es":""}...`},null,8,["placeholder"])]),_:1}),d(i(A),null,{default:s(()=>[(u(!0),p(G,null,F(B.value,t=>(u(),h(i(P),{key:t.id,value:t.id.toString()},{default:s(()=>[f(c(t.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",be,c(x(z.value.length,"localidad","localidades")),1)):_("",!0)])):_("",!0)]}),_:1}))]),_:1},8,["class"]))}});export{Le as C,Be as _};
