import{d as F,Z as ne,c as B,k as $,w as Y,j as M,o as n,e as V,E as j,b as w,u as e,A as O,p as ee,x as te,y as z,I as se,C as W,a as m,i as D,f as p,m as ie,g as v,t as k,h as Z,n as re,F as de,r as ue}from"./app-xs2pVVIS.js";import{_ as J}from"./InputError.vue_vue_type_script_setup_true_lang-CVUg1cWi.js";import{P as K,a as U,_ as T}from"./createLucideIcon-BYWdBvJB.js";import{h as ce,u as pe,n as H,_ as Q,a as me}from"./Label.vue_vue_type_script_setup_true_lang-CpLnMmFG.js";import{a as fe,c as ve,u as ge,g as _e,d as he,b as ae}from"./VisuallyHidden-nSZojRsV.js";import{V as ye}from"./VisuallyHiddenInput-gYGyQkh3.js";import{_ as be}from"./AuthLayout.vue_vue_type_script_setup_true_lang-DvdZEf_l.js";import{M as xe}from"./mail-BDu3ClhK.js";import{L}from"./loader-circle-DpEWjNl8.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BqcQ5ph7.js";const ke=["INPUT","TEXTAREA"];function we(u,l,o,s={}){if(!l||s.enableIgnoredElement&&ke.includes(l.nodeName))return null;const{arrowKeyOptions:d="both",attributeName:f="[data-reka-collection-item]",itemsArray:c=[],loop:g=!0,dir:_="ltr",preventScroll:x=!0,focus:y=!1}=s,[I,C,P,A,N,S]=[u.key==="ArrowRight",u.key==="ArrowLeft",u.key==="ArrowUp",u.key==="ArrowDown",u.key==="Home",u.key==="End"],E=P||A,i=I||C;if(!N&&!S&&(!E&&!i||d==="vertical"&&i||d==="horizontal"&&E))return null;const t=c;if(!t.length)return null;x&&u.preventDefault();let h=null;return i||E?h=oe(t,l,{goForward:E?A:_==="ltr"?I:C,loop:g}):N?h=t.at(0)||null:S&&(h=t.at(-1)||null),y&&(h==null||h.focus()),h}function oe(u,l,o,s=u.length){if(--s===0)return null;const d=u.indexOf(l),f=o.goForward?d+1:d-1;if(!o.loop&&(f<0||f>=u.length))return null;const c=(f+u.length)%u.length,g=u[c];return g?g.hasAttribute("disabled")&&g.getAttribute("disabled")!=="false"?oe(u,g,o,s):g:null}const[Ce,Ve]=ve("PinInputRoot");var Ee=F({inheritAttrs:!1,__name:"PinInputRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:Array,required:!1},placeholder:{type:String,required:!1,default:""},mask:{type:Boolean,required:!1},otp:{type:Boolean,required:!1},type:{type:null,required:!1,default:"text"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","complete"],setup(u,{emit:l}){const o=u,s=l,{mask:d,otp:f,placeholder:c,type:g,disabled:_,dir:x}=ne(o),{forwardRef:y}=ce(),I=fe(x),C=pe(o,"modelValue",s,{defaultValue:o.defaultValue??[],passive:o.modelValue===void 0}),P=B(()=>Array.isArray(C.value)?[...C.value]:[]),A=$(new Set);function N(i){A.value.add(i)}const S=B(()=>o.type==="number"),E=B(()=>P.value.filter(t=>!!t||S.value&&t===0).length===A.value.size);return Y(C,()=>{E.value&&s("complete",C.value)},{deep:!0}),Ve({modelValue:C,currentModelValue:P,mask:d,otp:f,placeholder:c,type:g,dir:I,disabled:_,isCompleted:E,inputElements:A,onInputElementChange:N,isNumericMode:S}),(i,t)=>(n(),M(e(K),O(i.$attrs,{ref:e(y),dir:e(I),"data-complete":E.value?"":void 0,"data-disabled":e(_)?"":void 0}),{default:V(()=>[j(i.$slots,"default",{modelValue:e(C)}),w(ye,{id:i.id,as:"input",feature:"focusable",tabindex:"-1",value:P.value.join(""),name:i.name??"",disabled:e(_),required:i.required,onFocus:t[0]||(t[0]=h=>{var a,r;return(r=(a=Array.from(A.value))==null?void 0:a[0])==null?void 0:r.focus()})},null,8,["id","value","name","disabled","required"])]),_:3},16,["dir","data-complete","data-disabled"]))}}),Ie=Ee,Pe=F({__name:"PinInputInput",props:{index:{type:Number,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},setup(u){const l=u,o=Ce(),s=B(()=>Array.from(o.inputElements.value)),d=B(()=>o.currentModelValue.value[l.index]),f=B(()=>l.disabled||o.disabled.value),c=B(()=>o.otp.value),g=B(()=>o.mask.value),{primitiveElement:_,currentElement:x}=ge();function y(a){var q;const r=a.target;if((((q=a.data)==null?void 0:q.length)??0)>1){i(r.value);return}if(o.isNumericMode.value&&!/^\d*$/.test(r.value)){r.value=r.value.replace(/\D/g,"");return}r.value=a.data??"",h(l.index,r.value);const b=s.value[l.index+1];b&&b.focus()}function I(){const a=x.value;se(()=>{a&&!a.value&&(a.placeholder=o.placeholder.value)})}function C(a){we(a,_e(),void 0,{itemsArray:s.value,focus:!0,loop:!1,arrowKeyOptions:"horizontal",dir:o.dir.value})}function P(a){if(a.preventDefault(),a.target.value)h(l.index,"");else{const q=s.value[l.index-1];q&&(q.focus(),h(l.index-1,""))}}function A(a){a.key==="Delete"&&(a.preventDefault(),h(l.index,""))}function N(a){const r=a.target;r.setSelectionRange(1,1),r.value||(r.placeholder="")}function S(a){I()}function E(a){a.preventDefault();const r=a.clipboardData;if(!r)return;const b=r.getData("text");i(b)}function i(a){var G;const r=[...o.currentModelValue.value],b=a.length>=s.value.length?0:l.index,q=Math.min(b+a.length,s.value.length);for(let R=b;R<q;R++){const le=s.value[R],X=a[R-b];o.isNumericMode.value&&!/^\d*$/.test(X)||(r[R]=X,le.focus())}o.modelValue.value=r,(G=s.value[q])==null||G.focus()}function t(a){let r=a.length-1;for(;r>=0&&a[r]==="";)a.pop(),r--;return a}function h(a,r){const b=[...o.currentModelValue.value];if(o.isNumericMode.value){const q=+r;r===""||isNaN(q)?delete b[a]:b[a]=q}else b[a]=r;o.modelValue.value=t(b)}return Y(d,()=>{d.value||I()}),ee(()=>{o.onInputElementChange(x.value)}),te(()=>{var a;(a=o.inputElements)==null||a.value.delete(x.value)}),(a,r)=>(n(),M(e(K),{ref_key:"primitiveElement",ref:_,autocapitalize:"none",as:a.as,"as-child":a.asChild,autocomplete:c.value?"one-time-code":"false",type:g.value?"password":"text",inputmode:e(o).isNumericMode.value?"numeric":"text",pattern:e(o).isNumericMode.value?"[0-9]*":void 0,placeholder:e(o).placeholder.value,value:d.value,disabled:f.value,"data-disabled":f.value?"":void 0,"data-complete":e(o).isCompleted.value?"":void 0,"aria-label":`pin input ${a.index+1} of ${s.value.length}`,onInput:r[0]||(r[0]=b=>y(b)),onKeydown:[z(C,["left","right","up","down","home","end"]),z(P,["backspace"]),z(A,["delete"])],onFocus:N,onBlur:S,onPaste:E},{default:V(()=>[j(a.$slots,"default")]),_:3},8,["as","as-child","autocomplete","type","inputmode","pattern","placeholder","value","disabled","data-disabled","data-complete","aria-label"]))}}),Ae=Pe;const qe=F({__name:"PinInput",props:{modelValue:{default:()=>[]},defaultValue:{},placeholder:{},mask:{type:Boolean},otp:{type:Boolean},type:{},dir:{},disabled:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue","complete"],setup(u,{emit:l}){const o=u,s=l,d=H(o,"class"),f=he(d,s);return(c,g)=>(n(),M(e(Ie),O({"data-slot":"pin-input"},e(f),{class:e(U)("flex items-center gap-2 has-disabled:opacity-50 disabled:cursor-not-allowed",o.class)}),{default:V(()=>[j(c.$slots,"default")]),_:3},16,["class"]))}}),Be=F({__name:"PinInputGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const l=u,o=H(l,"class"),s=ae(o);return(d,f)=>(n(),M(e(K),O({"data-slot":"pin-input-group"},e(s),{class:e(U)("flex items-center",l.class)}),{default:V(()=>[j(d.$slots,"default")]),_:3},16,["class"]))}}),Me=F({__name:"PinInputSlot",props:{index:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(u){const l=u,o=H(l,"class"),s=ae(o);return(d,f)=>(n(),M(e(Ae),O({"data-slot":"pin-input-slot"},e(s),{class:e(U)("border-input focus:border-ring focus:ring-ring/50 focus:aria-invalid:ring-destructive/20 dark:bg-input/30 dark:focus:aria-invalid:ring-destructive/40 aria-invalid:border-destructive focus:aria-invalid:border-destructive relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none text-center first:rounded-l-md first:border-l last:rounded-r-md focus:z-10 focus:ring-[3px]",l.class)}),null,16,["class"]))}}),Se={key:0,class:"mb-4 text-center text-muted-foreground"},Ne={key:0},$e={key:0},Fe={key:1},Re={key:2},De={key:3},Te={key:1},je={key:1,class:"mb-4 text-center text-muted-foreground"},Oe={key:0},ze={key:1},We={key:2},Le={key:2,class:"mb-4 text-center text-sm font-medium text-green-600"},Ke={class:"grid gap-6"},Ue={class:"grid gap-2"},He={class:"relative"},Ge={class:"grid gap-6"},Xe={class:"text-center"},Ze={class:"text-sm text-muted-foreground"},Je={key:0},Qe={key:0},Ye={class:"font-medium"},et={key:1},tt={class:"font-medium"},at={key:2},ot={class:"font-medium"},lt={key:1},nt={key:0},st={class:"font-medium"},it={key:1},rt={class:"font-medium"},dt={class:"font-medium"},ut={key:2},ct={class:"font-medium"},pt={class:"font-medium"},mt={class:"grid gap-2"},ft={class:"flex justify-center"},vt={class:"flex flex-col gap-3"},gt={class:"flex flex-col gap-2 text-center"},_t={class:"mt-6 text-center text-xs text-muted-foreground"},ht={key:0},yt={key:1},qt=F({__name:"LoginOTP",props:{status:{},authConfig:{},censoredEmail:{},otpCredential:{},otpChannel:{},whatsappEnabled:{type:Boolean}},setup(u){const l=u,o=$(l.censoredEmail?"otp":"credential"),s=$(l.censoredEmail||""),d=B(()=>l.authConfig||{login_type:"email",input_type:"email",placeholder:"correo@ejemplo.com",pattern:null,label:"Correo Electrónico"}),f=W({credential:""}),c=W({credential:l.otpCredential||"",otp_code:[]}),g=W({credential:"",otp_code:""}),_=$(!1),x=$(0),y=$(null),I=B(()=>x.value===0),C=B(()=>x.value>0?`Reenviar en ${x.value}s`:"Reenviar código"),P=(i=60)=>{x.value=i,y.value&&clearInterval(y.value),y.value=window.setInterval(()=>{x.value--,x.value<=0&&(clearInterval(y.value),y.value=null)},1e3)},A=()=>{_.value=!0,f.post(route("auth.request-otp"),{onSuccess:i=>{i.props&&i.props.censoredEmail&&(s.value=i.props.censoredEmail),o.value="otp",c.credential=f.credential,c.clearErrors(),P(60)},onError:()=>{},onFinish:()=>{_.value=!1}})},N=()=>{const i=c.otp_code.join("");g.credential=c.credential,g.otp_code=i,g.post(route("auth.verify-otp"),{onSuccess:()=>{},onError:()=>{c.otp_code=[]}})},S=()=>{I.value&&(_.value=!0,c.post(route("auth.resend-otp"),{onSuccess:i=>{i.props&&i.props.censoredEmail&&(s.value=i.props.censoredEmail),P(60)},onFinish:()=>{_.value=!1}}))},E=()=>{o.value="credential",c.reset(),y.value&&(clearInterval(y.value),y.value=null),x.value=0};return ee(()=>{o.value==="otp"&&P(60)}),te(()=>{y.value&&clearInterval(y.value)}),(i,t)=>(n(),M(be,{title:o.value==="credential"?"Iniciar Sesión":"Verificar Código"},{default:V(()=>[w(e(ie),{title:"Iniciar Sesión"}),o.value==="credential"?(n(),m("div",Se,[d.value.login_type==="documento"?(n(),m("p",Ne,[t[2]||(t[2]=v(" Ingresa tu documento de identidad para recibir el código de verificación ")),i.whatsappEnabled?l.otpChannel==="whatsapp"?(n(),m("strong",Fe,"vía WhatsApp")):l.otpChannel==="both"?(n(),m("strong",Re,"vía correo electrónico y WhatsApp")):(n(),m("strong",De,"vía correo electrónico")):(n(),m("strong",$e,"vía correo electrónico"))])):(n(),m("p",Te," Ingresa tu "+k(d.value.label.toLowerCase())+" para recibir el código de verificación ",1))])):(n(),m("div",je,[l.otpChannel==="whatsapp"?(n(),m("p",Oe,t[3]||(t[3]=[v(" Ingresa el código de 6 dígitos enviado a tu "),p("strong",null,"WhatsApp",-1)]))):l.otpChannel==="both"?(n(),m("p",ze,t[4]||(t[4]=[v(" Ingresa el código de 6 dígitos enviado a tu "),p("strong",null,"correo y WhatsApp",-1)]))):(n(),m("p",We,t[5]||(t[5]=[v(" Ingresa el código de 6 dígitos enviado a tu "),p("strong",null,"correo",-1)])))])),i.status?(n(),m("div",Le,k(i.status),1)):D("",!0),o.value==="credential"?(n(),m("form",{key:3,onSubmit:Z(A,["prevent"]),class:"flex flex-col gap-6"},[p("div",Ke,[p("div",Ue,[w(e(Q),{for:"credential"},{default:V(()=>[v(k(d.value.label),1)]),_:1}),p("div",He,[d.value.login_type==="email"?(n(),M(e(xe),{key:0,class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"})):D("",!0),w(e(me),{id:"credential",type:d.value.input_type,required:"",autofocus:"",tabindex:"1",autocomplete:d.value.login_type==="email"?"email":"off",inputmode:d.value.login_type==="documento"?"numeric":void 0,modelValue:e(f).credential,"onUpdate:modelValue":t[0]||(t[0]=h=>e(f).credential=h),placeholder:d.value.placeholder,pattern:d.value.pattern,class:re({"pl-10":d.value.login_type==="email"})},null,8,["type","autocomplete","inputmode","modelValue","placeholder","pattern","class"])]),w(J,{message:e(f).errors.credential},null,8,["message"])]),w(e(T),{type:"submit",class:"mt-4 w-full",tabindex:"2",disabled:e(f).processing||_.value},{default:V(()=>[e(f).processing||_.value?(n(),M(e(L),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):D("",!0),v(" "+k(e(f).processing||_.value?"Enviando...":"Enviar Código"),1)]),_:1},8,["disabled"])])],32)):(n(),m("form",{key:4,onSubmit:Z(N,["prevent"]),class:"flex flex-col gap-6"},[p("div",Ge,[p("div",Xe,[p("p",Ze,[d.value.login_type==="email"?(n(),m("span",Je,[l.otpChannel==="whatsapp"?(n(),m("span",Qe,[t[6]||(t[6]=v(" Código enviado por WhatsApp al número asociado con ")),p("span",Ye,k(s.value||e(c).credential),1)])):l.otpChannel==="both"?(n(),m("span",et,[t[7]||(t[7]=v(" Código enviado al email ")),p("span",tt,k(s.value||e(c).credential),1),t[8]||(t[8]=v(" y WhatsApp "))])):(n(),m("span",at,[t[9]||(t[9]=v(" Código enviado al email ")),p("span",ot,k(s.value||e(c).credential),1)]))])):(n(),m("span",lt,[l.otpChannel==="whatsapp"?(n(),m("span",nt,[t[10]||(t[10]=v(" Código enviado por WhatsApp al número asociado con el documento ")),p("span",st,k(e(c).credential),1)])):l.otpChannel==="both"?(n(),m("span",it,[t[11]||(t[11]=v(" Código enviado al email ")),p("span",rt,k(s.value),1),t[12]||(t[12]=v(" y WhatsApp asociados al documento ")),p("span",dt,k(e(c).credential),1)])):(n(),m("span",ut,[t[13]||(t[13]=v(" Código enviado al email ")),p("span",ct,k(s.value),1),t[14]||(t[14]=v(" asociado al documento ")),p("span",pt,k(e(c).credential),1)]))]))])]),p("div",mt,[w(e(Q),{class:"text-center"},{default:V(()=>t[15]||(t[15]=[v("Código de Verificación")])),_:1}),p("div",ft,[w(e(qe),{modelValue:e(c).otp_code,"onUpdate:modelValue":t[1]||(t[1]=h=>e(c).otp_code=h),length:6,type:"text",placeholder:"0",class:"gap-2"},{default:V(()=>[w(e(Be),null,{default:V(()=>[(n(),m(de,null,ue(6,(h,a)=>w(e(Me),{key:h,index:a,class:"h-12 w-12 text-lg font-medium",inputmode:"numeric"},null,8,["index"])),64))]),_:1})]),_:1},8,["modelValue"])]),w(J,{message:e(c).errors.otp_code},null,8,["message"])]),p("div",vt,[w(e(T),{type:"submit",class:"w-full",disabled:e(g).processing||e(c).otp_code.join("").length!==6},{default:V(()=>[e(g).processing?(n(),M(e(L),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):D("",!0),v(" "+k(e(g).processing?"Verificando...":"Verificar Código"),1)]),_:1},8,["disabled"]),p("div",gt,[w(e(T),{type:"button",variant:"ghost",size:"sm",onClick:S,disabled:!I.value||_.value},{default:V(()=>[_.value?(n(),M(e(L),{key:0,class:"mr-2 h-3 w-3 animate-spin"})):D("",!0),v(" "+k(_.value?"Enviando...":C.value),1)]),_:1},8,["disabled"]),w(e(T),{type:"button",variant:"ghost",size:"sm",onClick:E},{default:V(()=>[v(k(d.value.login_type==="email"?"Cambiar correo electrónico":"Cambiar documento"),1)]),_:1})])])])],32)),p("div",_t,[o.value==="credential"?(n(),m("p",ht," Solo personas registradas como militantes pueden acceder al sistema. ")):(n(),m("p",yt," El código expira en 10 minutos. Si no lo recibes, verifica tu bandeja de spam. ")),t[16]||(t[16]=p("br",null,null,-1)),t[17]||(t[17]=p("p",null,[v(" Si necesitas ayuda escribe a "),p("b",null,"soporte@colombiahumana.co"),v(" para soporte sobre la plataforma. Para inquietudes jurídicas a "),p("b",null,"juridicoelectoral@colombiahumana.co")],-1))])]),_:1},8,["title"]))}});export{qt as default};
