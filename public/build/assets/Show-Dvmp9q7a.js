import{_ as h}from"./index-GoXl7zHJ.js";import{c as ve,_ as S}from"./createLucideIcon-B1k9xl0j.js";import{a as I,b as j,c as F,_ as q}from"./CardTitle.vue_vue_type_script_setup_true_lang-CNV2dJlR.js";import{_ as ne}from"./CardDescription.vue_vue_type_script_setup_true_lang-24Grk1LC.js";import{_ as Me,a as He,b as ee,c as H,d as Ne,e as V}from"./TableHeader.vue_vue_type_script_setup_true_lang-BsjUJ67l.js";import{_ as Le}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-8irVdjqB.js";import{_ as Re}from"./CsvImportWizard.vue_vue_type_script_setup_true_lang-BOl32-D9.js";import{d as _e,r as y,o as ge,b as v,e as n,w as t,f as s,u as e,g as o,j as g,h as r,t as d,i as p,F as G,k as se,W as A,q as Te,n as N,c as ue,m as Be,p as De,a as X}from"./app-CP1YmMoZ.js";import{H as te}from"./history-2iJ9nADX.js";import{F as be}from"./file-text-FY7E8fFz.js";import{C as ye}from"./circle-x-CWE38WZC.js";import{C as le}from"./circle-check-big-B0hgvGN4.js";import{C as ie}from"./clock-oRJZVP6R.js";import{_ as Qe}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-Bv0ABivU.js";import{_ as We,a as Oe,b as Xe,c as Ge,d as ae}from"./SelectValue.vue_vue_type_script_setup_true_lang-CcYNmYVt.js";import{_ as Je}from"./Checkbox.vue_vue_type_script_setup_true_lang-jS18uQiG.js";import{_ as Ke}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DMCvBuGo.js";import{t as C}from"./index-S3BBeh0J.js";import{_ as de,a as ce}from"./index-BE_XZbED.js";import{_ as me}from"./AlertTitle.vue_vue_type_script_setup_true_lang-B2Q5eCVz.js";import{_ as Ye}from"./Progress.vue_vue_type_script_setup_true_lang-DcrM3dXj.js";import{A as Ze}from"./arrow-left-BQpokHfr.js";import{S as pe}from"./square-pen-apB2SiDJ.js";import{C as ea}from"./calendar-CFQzeY2m.js";import{M as aa}from"./map-pin-DITVkYmT.js";import{U as sa}from"./users-B5sI-BuP.js";import{U as ta}from"./upload-DMKloDLY.js";import{C as la}from"./chevron-left-DCaRm1vB.js";import{C as ia}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BQUhOSPN.js";import{V as fe}from"./vote-DL1APX8l.js";import{L as ra}from"./loader-circle-C7osYouZ.js";import{R as oa}from"./refresh-cw-nxObWRex.js";import{C as na}from"./circle-alert-5uXwko6v.js";import{f as ua,e as da}from"./es-BRx6Co7f.js";import"./index-BiWnI7cE.js";import"./Input.vue_vue_type_script_setup_true_lang-CV2X9-dW.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-0GEtV5ex.js";import"./index-D5ysKG8g.js";import"./floating-ui.vue-nhGmn9M4.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BeE7juvx.js";import"./VisuallyHidden-BdDHiRv9.js";import"./x-C8LeRxX6.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BAWyxZWM.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-DYVE3h_T.js";import"./trash-2-P2SHUhel.js";import"./plus-DuFIs0Ga.js";import"./search-dyCwx1IB.js";import"./filter-BJpbBZOQ.js";import"./check-D8hxoy4M.js";import"./save-bZ8mKvmC.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-BERLG6Mh.js";import"./RovingFocusItem-CnAi34uW.js";import"./utils-qIgYKbTI.js";import"./Label.vue_vue_type_script_setup_true_lang-DB2XL-fR.js";import"./git-branch-CHb0qPYg.js";import"./nullish-CHIgUVhi.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-xkKDDLMB.js";import"./index-BIZqS9oN.js";import"./shield-Cifvz0vu.js";import"./user-yW0LRUfd.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BUmLPkWv.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-DYnE406G.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-CUOrutkL.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-XogMyztG.js";import"./briefcase-COkNuOiT.js";import"./megaphone-BuAzIuya.js";import"./user-check-2WTmV45F.js";import"./external-link-DOLK02By.js";import"./panel-left-Xkj_smuN.js";import"./index-WNJArNv6.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=ve("UserMinusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=ve("UserPlusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),pa={class:"flex items-center gap-2"},fa={key:0,class:"flex justify-center py-6"},va={key:1,class:"text-center py-6 text-muted-foreground"},_a={key:2,class:"space-y-3"},ga=["onClick"],ba={class:"flex items-center gap-3"},ya={class:"font-medium text-sm"},xa={class:"text-xs text-muted-foreground"},ka={class:"flex items-center gap-3"},ha={class:"text-right text-sm"},wa={class:"text-xs text-muted-foreground mt-1"},$a={key:0},Ca={key:1},Pa={key:2},Sa=_e({__name:"ImportHistory",props:{type:{},entityId:{},title:{default:"Historial de Importaciones"}},setup(J,{expose:k}){const z=J,w=y([]),b=y(!1),_=async()=>{if(z.entityId){b.value=!0;try{const x=z.type==="votacion"?`/admin/votaciones/${z.entityId}/imports/recent`:`/admin/asambleas/${z.entityId}/imports/recent`,$=await fetch(x);if($.ok){const m=await $.json();w.value=m}}catch(x){console.error("Error loading recent imports:",x)}finally{b.value=!1}}},B=x=>{A.get(`/admin/imports/${x}`)},L=()=>{const x=z.type==="votacion"?`/admin/votaciones/${z.entityId}/imports`:`/admin/asambleas/${z.entityId}/imports`;A.get(x)},R=x=>{switch(x){case"pending":return{icon:ie,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:ie,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:le,label:"Completada",class:"text-green-600"};case"failed":return{icon:ye,label:"Fallida",class:"text-red-600"}}},U=x=>new Date(x).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return ge(()=>{_()}),k({loadRecentImports:_}),(x,$)=>(n(),v(e(q),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(j),{class:"flex items-center justify-between"},{default:t(()=>[o("span",pa,[s(e(te),{class:"h-5 w-5"}),r(" "+d(x.title),1)]),w.value.length>0?(n(),v(e(S),{key:0,variant:"outline",size:"sm",onClick:L},{default:t(()=>[...$[0]||($[0]=[r(" Ver Todas ",-1)])]),_:1})):g("",!0)]),_:1})]),_:1}),s(e(F),null,{default:t(()=>[b.value?(n(),p("div",fa,[...$[1]||($[1]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):w.value.length===0?(n(),p("div",va,[s(e(te),{class:"mx-auto h-8 w-8 mb-2"}),$[2]||($[2]=o("p",null,"No hay importaciones registradas",-1)),$[3]||($[3]=o("p",{class:"text-sm"},"Las importaciones aparecerán aquí una vez que subas archivos CSV",-1))])):(n(),p("div",_a,[(n(!0),p(G,null,se(w.value,m=>(n(),p("div",{key:m.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:D=>B(m.id)},[o("div",ba,[(n(),v(Te(R(m.status).icon),{class:N(["h-4 w-4",R(m.status).class])},null,8,["class"])),o("div",null,[o("p",ya,d(m.name||m.original_filename),1),o("p",xa,d(U(m.created_at))+" • Por "+d(m.created_by.name),1)])]),o("div",ka,[o("div",ha,[s(e(h),{variant:"outline",class:N(R(m.status).class)},{default:t(()=>[r(d(R(m.status).label),1)]),_:2},1032,["class"]),o("p",wa,[m.status==="processing"?(n(),p("span",$a,d(m.progress_percentage)+"% ",1)):m.status==="completed"?(n(),p("span",Ca,d(m.successful_rows)+"/"+d(m.total_rows||m.successful_rows+m.failed_rows)+" registros ",1)):m.status==="failed"&&m.failed_rows>0?(n(),p("span",Pa,d(m.failed_rows)+" errores ",1)):g("",!0)])]),s(e(be),{class:"h-4 w-4 text-gray-400"})])],8,ga))),128))]))]),_:1})]),_:1}))}}),Aa={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},za={class:"flex items-center justify-between"},Ea={class:"text-3xl font-bold"},Va={class:"mt-2 flex items-center gap-2"},Ia={class:"flex gap-2"},ja={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Fa={class:"space-y-2"},qa={class:"flex items-center gap-2 text-sm"},Ua={class:"flex items-center gap-2 text-sm"},Ma={class:"text-sm font-medium"},Ha={class:"space-y-2"},Na={class:"flex items-center gap-2 text-sm"},La={class:"text-sm text-muted-foreground"},Ra={class:"space-y-2"},Ta={class:"flex items-center gap-2"},Ba={class:"text-2xl font-bold"},Da={class:"text-sm"},Qa={class:"flex items-center justify-between"},Wa={key:0,class:"flex gap-2"},Oa={key:0,class:"mb-4 flex gap-2"},Xa={key:3,class:"flex justify-center py-8"},Ga={key:0,class:"flex items-center gap-2"},Ja={class:"relative"},Ka={key:0,class:"absolute inset-0 flex items-center justify-center"},Ya={key:0,class:"text-green-600 transition-all duration-300"},Za={key:1,class:"text-gray-400 transition-all duration-300"},es={key:1},as={key:0},ss={key:1},ts={class:"flex justify-end gap-2"},ls={key:5,class:"flex items-center justify-between mt-4"},is={class:"text-sm text-muted-foreground"},rs={key:0,class:"flex items-center space-x-2"},os={class:"text-sm"},ns={key:0,class:"flex justify-center py-8"},us={key:1,class:"text-center py-8 text-gray-500"},ds={key:2,class:"space-y-4"},cs={class:"flex justify-between items-start"},ms={class:"flex-1"},ps={class:"font-semibold text-lg"},fs={key:0,class:"text-sm text-gray-600 mt-1"},vs={class:"flex gap-4 mt-2 text-sm text-gray-500"},_s={key:0,class:"space-y-2"},gs={class:"flex justify-between text-sm"},bs=["href"],Ut=_e({__name:"Show",props:{asamblea:{},puede_gestionar_participantes:{type:Boolean},filterFieldsConfig:{}},setup(J){const k=J,z=[{title:"Admin",href:"/admin/dashboard"},{title:"Asambleas",href:"/admin/asambleas"},{title:k.asamblea.nombre,href:"#"}],{route:w}=window,b=y([]),_=y({current_page:1,last_page:1,per_page:20,total:0,from:0,to:0}),B=y(!1),L=y({}),R={fields:k.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por nombre, email o documento...",quickSearchFields:["users.name","users.email","users.documento_identidad"],maxNestingLevel:1,allowSaveFilters:!1,debounceTime:500,autoApply:!1},U=y(!1),x=y("asistente"),$=ue(()=>[{name:"tipo_participacion",label:"Tipo de Participación",type:"select",options:[{value:"asistente",label:"Asistente"},{value:"moderador",label:"Moderador"},{value:"secretario",label:"Secretario"}],value:x.value,required:!1}]),m=y(null),D=y(!1),W=y(!1),xe=y([]),K=y(null),Y=y([]),Z=y(!1),E=y(null),P=y({}),M=y({}),ke=i=>i?ua(new Date(i),"PPPpp",{locale:da}):"",he=i=>{switch(i){case"moderador":return"bg-purple-100 text-purple-800";case"secretario":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},O=ue(()=>{const i=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.tipo_participacion)==="moderador"}).length,a=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.tipo_participacion)==="secretario"}).length,l=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.tipo_participacion)==="asistente"}).length,u=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.asistio)===!0}).length;return{moderadores:i,secretarios:a,asistentes:l,presentes:u,total:_.value.total||0}}),T=async(i=1,a={})=>{B.value=!0;try{const l={page:i,...a},u=await X.get(w("admin.asambleas.participantes-list",k.asamblea.id),{params:l});b.value=u.data.participantes.data.map(c=>({...c,pivot:{tenant_id:c.tenant_id,tipo_participacion:c.tipo_participacion||"asistente",asistio:c.asistio===1||c.asistio===!0||c.asistio==="1",hora_registro:c.hora_registro}})),_.value={current_page:u.data.participantes.current_page,last_page:u.data.participantes.last_page,per_page:u.data.participantes.per_page,total:u.data.participantes.total,from:u.data.participantes.from,to:u.data.participantes.to}}catch(l){console.error("Error cargando participantes:",l)}finally{B.value=!1}},re=i=>{T(i,L.value)},we=i=>{L.value=i,T(1,i)},$e=()=>{L.value={},T(1,{})},Ce=()=>{U.value=!0};Be(U,i=>{i||(x.value="asistente")});const Pe=i=>{if(!i.userIds||i.userIds.length===0)return;const a=i.userIds.length;A.post(w("admin.asambleas.manage-participantes",k.asamblea.id),{participante_ids:i.userIds,tipo_participacion:i.extraData.tipo_participacion||"asistente"},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{U.value=!1,C.success(`${a} participante(s) añadido(s) exitosamente`,{duration:2e3}),T(_.value.current_page,L.value)},onError:()=>{C.error("Error al añadir participantes",{description:"Por favor intenta nuevamente",duration:3e3})}})},Se=i=>{const a=b.value.find(f=>f.id===i),l=(a==null?void 0:a.name)||"Participante";if(!confirm(`¿Estás seguro de remover a ${l} de la asamblea?`))return;const u=b.value.findIndex(f=>f.id===i),c=b.value[u];u!==-1&&(b.value.splice(u,1),_.value.total-=1),A.delete(w("admin.asambleas.manage-participantes",k.asamblea.id),{data:{participante_id:i},preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{C.success(`${l} removido de la asamblea`,{duration:2e3})},onError:()=>{c&&u!==-1&&(b.value.splice(u,0,c),_.value.total+=1),C.error("Error al remover participante",{duration:3e3})}})},Ae=(i,a)=>{var f;const l=b.value.find(Q=>Q.id===i),u=(l==null?void 0:l.name)||"Participante",c=(f=l==null?void 0:l.pivot)==null?void 0:f.tipo_participacion;l&&l.pivot&&(l.pivot.tipo_participacion=a),A.put(w("admin.asambleas.manage-participantes",k.asamblea.id),{participante_id:i,tipo_participacion:a},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{const Q=a.charAt(0).toUpperCase()+a.slice(1);C.success(`${u} asignado como ${Q}`,{duration:2e3})},onError:()=>{l&&l.pivot&&c&&(l.pivot.tipo_participacion=c),C.error("Error al actualizar el tipo de participación",{duration:3e3})}})},ze=(i,a)=>{if(m.value===i)return;m.value=i;const l=b.value.find(c=>c.id===i),u=(l==null?void 0:l.name)||"Participante";l&&l.pivot&&(l.pivot.asistio,l.pivot.asistio=a,a?l.pivot.hora_registro=new Date().toISOString():l.pivot.hora_registro=null),A.put(w("admin.asambleas.manage-participantes",k.asamblea.id),{participante_id:i,asistio:a},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{a?C.success(`${u} marcado como presente`,{duration:2e3}):C.info(`${u} marcado como ausente`,{duration:2e3})},onError:()=>{l&&l.pivot&&(l.pivot.asistio=!a,l.pivot.hora_registro=null),C.error("Error al actualizar la asistencia",{description:"Por favor intenta nuevamente",duration:3e3})},onFinish:()=>{m.value=null}})},Ee=()=>{A.visit(w("admin.asambleas.edit",k.asamblea.id))},Ve=()=>{A.visit(w("admin.asambleas.index"))},Ie=async()=>{var i;if((i=k.asamblea)!=null&&i.id)try{const a=await fetch(`/admin/asambleas/${k.asamblea.id}/imports/recent`);xe.value=await a.json()}catch(a){console.error("Error cargando importaciones recientes:",a)}},je=i=>{D.value=!1,Ie(),T(),K.value&&K.value.loadRecentImports(),A.get(`/admin/imports/${i}`)},Fe=()=>{D.value=!1},oe=async()=>{Z.value=!0;try{const i=await X.get(`/admin/asambleas/${k.asamblea.id}/votaciones`);i.data.success&&(Y.value=i.data.data)}catch(i){console.error("Error cargando votaciones:",i),C.error("Error al cargar las votaciones")}finally{Z.value=!1}},qe=async i=>{var a,l;if(!E.value){E.value=i,delete P.value[i];try{const u=await X.post(`/admin/asambleas/${k.asamblea.id}/votaciones/${i}/sync`);if(u.data.success){C.success("Sincronización iniciada");const c=u.data.job_id;Ue(i,c)}}catch(u){console.error("Error iniciando sincronización:",u),C.error(((l=(a=u.response)==null?void 0:a.data)==null?void 0:l.message)||"Error al iniciar la sincronización"),E.value=null}}},Ue=(i,a)=>{M.value[i]&&clearInterval(M.value[i]),M.value[i]=setInterval(async()=>{try{const l=await X.get(`/admin/sync-job/${a}/status`);if(l.data.success){const u=l.data.data;P.value[i]=u,(u.status==="completed"||u.status==="completed_with_errors"||u.status==="failed")&&(clearInterval(M.value[i]),delete M.value[i],E.value=null,setTimeout(()=>{oe()},2e3),setTimeout(()=>{delete P.value[i]},5e3))}}catch(l){console.error("Error obteniendo progreso:",l),clearInterval(M.value[i]),delete M.value[i],E.value=null}},2e3)};return ge(()=>{T(),oe()}),(i,a)=>(n(),p(G,null,[s(e(De),{title:`Asamblea: ${i.asamblea.nombre}`},null,8,["title"]),s(Ke,{breadcrumbs:z},{default:t(()=>[o("div",Aa,[o("div",za,[o("div",null,[o("h1",Ea,d(i.asamblea.nombre),1),o("div",Va,[s(e(h),{class:N(i.asamblea.estado_color)},{default:t(()=>[r(d(i.asamblea.estado_label),1)]),_:1},8,["class"]),s(e(h),{class:N(i.asamblea.tipo==="ordinaria"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800")},{default:t(()=>[r(d(i.asamblea.tipo_label),1)]),_:1},8,["class"]),i.asamblea.activo?(n(),v(e(h),{key:0,class:"bg-green-100 text-green-800"},{default:t(()=>[...a[6]||(a[6]=[r(" Activa ",-1)])]),_:1})):(n(),v(e(h),{key:1,class:"bg-red-100 text-red-800"},{default:t(()=>[...a[7]||(a[7]=[r(" Inactiva ",-1)])]),_:1}))])]),o("div",Ia,[s(e(S),{variant:"outline",onClick:Ve},{default:t(()=>[s(e(Ze),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=r(" Volver ",-1))]),_:1}),s(e(S),{onClick:Ee},{default:t(()=>[s(e(pe),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=r(" Editar ",-1))]),_:1})])]),o("div",ja,[s(e(q),null,{default:t(()=>[s(e(I),{class:"pb-3"},{default:t(()=>[s(e(j),{class:"text-sm font-medium"},{default:t(()=>[...a[10]||(a[10]=[r("Fechas",-1)])]),_:1})]),_:1}),s(e(F),null,{default:t(()=>[o("div",Fa,[o("div",qa,[s(e(ea),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.rango_fechas),1)]),o("div",Ua,[s(e(ie),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,"Duración: "+d(i.asamblea.duracion),1)]),o("p",Ma,d(i.asamblea.tiempo_restante),1)])]),_:1})]),_:1}),s(e(q),null,{default:t(()=>[s(e(I),{class:"pb-3"},{default:t(()=>[s(e(j),{class:"text-sm font-medium"},{default:t(()=>[...a[11]||(a[11]=[r("Ubicación",-1)])]),_:1})]),_:1}),s(e(F),null,{default:t(()=>[o("div",Ha,[o("div",Na,[s(e(aa),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.lugar||"No especificado"),1)]),o("p",La,d(i.asamblea.ubicacion_completa),1)])]),_:1})]),_:1}),s(e(q),null,{default:t(()=>[s(e(I),{class:"pb-3"},{default:t(()=>[s(e(j),{class:"text-sm font-medium"},{default:t(()=>[...a[12]||(a[12]=[r("Quórum",-1)])]),_:1})]),_:1}),s(e(F),null,{default:t(()=>[o("div",Ra,[o("div",Ta,[s(e(sa),{class:"h-4 w-4 text-muted-foreground"}),o("span",Ba,d(i.asamblea.asistentes_count)+" / "+d(i.asamblea.quorum_minimo||"∞"),1)]),i.asamblea.alcanza_quorum?(n(),v(e(h),{key:0,class:"bg-green-100 text-green-800"},{default:t(()=>[s(e(le),{class:"mr-1 h-3 w-3"}),a[13]||(a[13]=r(" Quórum alcanzado ",-1))]),_:1})):i.asamblea.quorum_minimo?(n(),v(e(h),{key:1,class:"bg-yellow-100 text-yellow-800"},{default:t(()=>[s(e(ye),{class:"mr-1 h-3 w-3"}),a[14]||(a[14]=r(" Quórum no alcanzado ",-1))]),_:1})):g("",!0)])]),_:1})]),_:1})]),i.asamblea.descripcion?(n(),v(e(q),{key:0},{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(j),null,{default:t(()=>[...a[15]||(a[15]=[r("Descripción",-1)])]),_:1})]),_:1}),s(e(F),null,{default:t(()=>[o("p",Da,d(i.asamblea.descripcion),1)]),_:1})]),_:1})):g("",!0),s(Le,{config:R,onApply:we,onClear:$e}),s(e(q),null,{default:t(()=>[s(e(I),null,{default:t(()=>[o("div",Qa,[o("div",null,[s(e(j),null,{default:t(()=>[...a[16]||(a[16]=[r("Participantes",-1)])]),_:1}),s(e(ne),null,{default:t(()=>[r(d(i.asamblea.participantes_count)+" participantes registrados ",1)]),_:1})]),b.value.length>0?(n(),p("div",Wa,[s(e(h),{variant:"outline"},{default:t(()=>[r(" Moderadores: "+d(O.value.moderadores),1)]),_:1}),s(e(h),{variant:"outline"},{default:t(()=>[r(" Secretarios: "+d(O.value.secretarios),1)]),_:1}),s(e(h),{variant:"outline"},{default:t(()=>[r(" Asistentes: "+d(O.value.asistentes),1)]),_:1}),s(e(h),{variant:"outline"},{default:t(()=>[r(" Presentes: "+d(O.value.presentes),1)]),_:1})])):g("",!0)])]),_:1}),s(e(F),null,{default:t(()=>[i.puede_gestionar_participantes?(n(),p("div",Oa,[s(e(S),{onClick:Ce},{default:t(()=>[s(e(ma),{class:"mr-2 h-4 w-4"}),a[17]||(a[17]=r(" Añadir Participantes ",-1))]),_:1}),s(e(S),{variant:"outline",onClick:a[0]||(a[0]=l=>D.value=!0)},{default:t(()=>[s(e(ta),{class:"mr-2 h-4 w-4"}),a[18]||(a[18]=r(" Importar CSV ",-1))]),_:1}),s(e(S),{variant:"outline",onClick:a[1]||(a[1]=l=>W.value=!W.value)},{default:t(()=>[s(e(te),{class:"mr-2 h-4 w-4"}),r(" "+d(W.value?"Ocultar":"Ver")+" Historial ",1)]),_:1})])):g("",!0),D.value?(n(),v(Re,{key:1,mode:"asamblea","asamblea-id":i.asamblea.id,"asamblea-titulo":i.asamblea.nombre,"redirect-on-success":!0,onSuccess:je,onCancel:Fe,class:"mb-4"},null,8,["asamblea-id","asamblea-titulo"])):g("",!0),W.value?(n(),v(Sa,{key:2,ref_key:"importHistoryRef",ref:K,type:"asamblea","entity-id":i.asamblea.id,title:"Historial de Importaciones",class:"mb-4"},null,8,["entity-id"])):g("",!0),B.value?(n(),p("div",Xa,[...a[19]||(a[19]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):(n(),v(e(Me),{key:4},{default:t(()=>[s(e(He),null,{default:t(()=>[s(e(ee),null,{default:t(()=>[s(e(H),null,{default:t(()=>[...a[20]||(a[20]=[r("Nombre",-1)])]),_:1}),s(e(H),null,{default:t(()=>[...a[21]||(a[21]=[r("Email",-1)])]),_:1}),s(e(H),null,{default:t(()=>[...a[22]||(a[22]=[r("Tipo de Participación",-1)])]),_:1}),s(e(H),null,{default:t(()=>[...a[23]||(a[23]=[r("Asistencia",-1)])]),_:1}),s(e(H),null,{default:t(()=>[...a[24]||(a[24]=[r("Hora de Registro",-1)])]),_:1}),s(e(H),null,{default:t(()=>[...a[25]||(a[25]=[r("Registrado por",-1)])]),_:1}),i.puede_gestionar_participantes?(n(),v(e(H),{key:0,class:"text-right"},{default:t(()=>[...a[26]||(a[26]=[r("Acciones",-1)])]),_:1})):g("",!0)]),_:1})]),_:1}),s(e(Ne),null,{default:t(()=>[(n(!0),p(G,null,se(b.value,l=>(n(),v(e(ee),{key:l.id},{default:t(()=>[s(e(V),{class:"font-medium"},{default:t(()=>[r(d(l.name),1)]),_:2},1024),s(e(V),null,{default:t(()=>[r(d(l.email),1)]),_:2},1024),s(e(V),null,{default:t(()=>{var u;return[s(e(h),{class:N(he(((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente"))},{default:t(()=>{var c;return[r(d(((c=l.pivot)==null?void 0:c.tipo_participacion)||"asistente"),1)]}),_:2},1032,["class"])]}),_:2},1024),s(e(V),null,{default:t(()=>{var u,c,f;return[i.puede_gestionar_participantes&&i.asamblea.estado==="en_curso"?(n(),p("div",Ga,[o("div",Ja,[s(e(Je),{checked:((u=l.pivot)==null?void 0:u.asistio)||!1,disabled:m.value===l.id,"onUpdate:checked":Q=>ze(l.id,Q),class:N(m.value===l.id?"opacity-50":"")},null,8,["checked","disabled","onUpdate:checked","class"]),m.value===l.id?(n(),p("div",Ka,[...a[27]||(a[27]=[o("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary"},null,-1)])])):g("",!0)]),(c=l.pivot)!=null&&c.asistio?(n(),p("span",Ya," Presente ")):(n(),p("span",Za," Ausente "))])):(n(),p("div",es,[(f=l.pivot)!=null&&f.asistio?(n(),v(e(h),{key:0,class:"bg-green-100 text-green-800"},{default:t(()=>[...a[28]||(a[28]=[r(" Presente ",-1)])]),_:1})):(n(),v(e(h),{key:1,variant:"outline"},{default:t(()=>[...a[29]||(a[29]=[r(" Ausente ",-1)])]),_:1}))]))]}),_:2},1024),s(e(V),null,{default:t(()=>{var u;return[r(d((u=l.pivot)!=null&&u.hora_registro?ke(l.pivot.hora_registro):"-"),1)]}),_:2},1024),s(e(V),null,{default:t(()=>{var u;return[(u=l.pivot)!=null&&u.updated_by?(n(),p("span",as,d(l.pivot.updated_by===l.id?"Auto-registro":l.pivot.updated_by_name||"Admin"),1)):(n(),p("span",ss,"-"))]}),_:2},1024),i.puede_gestionar_participantes?(n(),v(e(V),{key:0,class:"text-right"},{default:t(()=>{var u;return[o("div",ts,[s(e(We),{"model-value":((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente","onUpdate:modelValue":c=>Ae(l.id,c)},{default:t(()=>[s(e(Oe),{class:"w-32"},{default:t(()=>[s(e(Xe))]),_:1}),s(e(Ge),null,{default:t(()=>[s(e(ae),{value:"asistente"},{default:t(()=>[...a[30]||(a[30]=[r("Asistente",-1)])]),_:1}),s(e(ae),{value:"moderador"},{default:t(()=>[...a[31]||(a[31]=[r("Moderador",-1)])]),_:1}),s(e(ae),{value:"secretario"},{default:t(()=>[...a[32]||(a[32]=[r("Secretario",-1)])]),_:1})]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"]),s(e(S),{variant:"ghost",size:"sm",onClick:c=>Se(l.id)},{default:t(()=>[s(e(ca),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])]}),_:2},1024)):g("",!0)]),_:2},1024))),128)),b.value.length===0?(n(),v(e(ee),{key:0},{default:t(()=>[s(e(V),{colspan:"6",class:"text-center py-8"},{default:t(()=>[...a[33]||(a[33]=[o("p",{class:"text-muted-foreground"},"No hay participantes registrados",-1)])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})),_.value.total>0?(n(),p("div",ls,[o("div",is," Mostrando "+d(_.value.from)+" a "+d(_.value.to)+" de "+d(_.value.total)+" resultados ",1),_.value.last_page>1?(n(),p("div",rs,[s(e(S),{variant:"outline",size:"sm",disabled:_.value.current_page===1,onClick:a[2]||(a[2]=l=>re(_.value.current_page-1))},{default:t(()=>[s(e(la),{class:"h-4 w-4"}),a[34]||(a[34]=r(" Anterior ",-1))]),_:1},8,["disabled"]),o("div",os," Página "+d(_.value.current_page)+" de "+d(_.value.last_page),1),s(e(S),{variant:"outline",size:"sm",disabled:_.value.current_page===_.value.last_page,onClick:a[3]||(a[3]=l=>re(_.value.current_page+1))},{default:t(()=>[a[35]||(a[35]=r(" Siguiente ",-1)),s(e(ia),{class:"h-4 w-4"})]),_:1},8,["disabled"])])):g("",!0)])):g("",!0)]),_:1})]),_:1}),s(e(q),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(j),{class:"flex items-center gap-2"},{default:t(()=>[s(e(fe),{class:"h-5 w-5"}),a[36]||(a[36]=r(" Votaciones Asociadas ",-1))]),_:1}),s(e(ne),null,{default:t(()=>[...a[37]||(a[37]=[r(" Votaciones vinculadas a esta asamblea y estado de sincronización de participantes ",-1)])]),_:1})]),_:1}),s(e(F),null,{default:t(()=>[Z.value?(n(),p("div",ns,[s(e(ra),{class:"h-8 w-8 animate-spin text-gray-400"})])):Y.value.length===0?(n(),p("div",us,[s(e(fe),{class:"h-12 w-12 mx-auto mb-3 text-gray-300"}),a[39]||(a[39]=o("p",null,"No hay votaciones asociadas a esta asamblea",-1)),s(e(S),{variant:"outline",class:"mt-4",onClick:a[4]||(a[4]=()=>e(A).visit(`/admin/asambleas/${i.asamblea.id}/edit`))},{default:t(()=>[s(e(pe),{class:"h-4 w-4 mr-2"}),a[38]||(a[38]=r(" Editar Asamblea para Agregar Votaciones ",-1))]),_:1})])):(n(),p("div",ds,[(n(!0),p(G,null,se(Y.value,l=>(n(),p("div",{key:l.id,class:"border rounded-lg p-4 space-y-3"},[o("div",cs,[o("div",ms,[o("h4",ps,d(l.titulo),1),l.descripcion?(n(),p("p",fs,d(l.descripcion),1)):g("",!0),o("div",vs,[o("span",null,[a[40]||(a[40]=r("Estado: ",-1)),s(e(h),{variant:l.estado==="activa"?"default":"secondary"},{default:t(()=>[r(d(l.estado),1)]),_:2},1032,["variant"])]),o("span",null,"Votantes: "+d(l.votantes_count),1),o("span",null,"Sincronizados desde asamblea: "+d(l.sincronizados_count),1)])]),l.puede_sincronizar&&i.puede_gestionar_participantes?(n(),v(e(S),{key:0,onClick:u=>qe(l.id),disabled:E.value===l.id,variant:"outline"},{default:t(()=>[s(e(oa),{class:N(["h-4 w-4 mr-2",{"animate-spin":E.value===l.id}])},null,8,["class"]),r(" "+d(E.value===l.id?"Sincronizando...":"Sincronizar Participantes"),1)]),_:2},1032,["onClick","disabled"])):g("",!0)]),P.value[l.id]?(n(),p("div",_s,[o("div",gs,[o("span",null,d(P.value[l.id].message),1),o("span",null,d(Math.round(P.value[l.id].progress))+"%",1)]),s(e(Ye),{"model-value":P.value[l.id].progress},null,8,["model-value"]),P.value[l.id].status==="completed"?(n(),v(e(de),{key:0,class:"mt-2"},{default:t(()=>[s(e(le),{class:"h-4 w-4"}),s(e(me),null,{default:t(()=>[...a[41]||(a[41]=[r("Sincronización completada",-1)])]),_:1}),s(e(ce),null,{default:t(()=>[r(d(P.value[l.id].message),1)]),_:2},1024)]),_:2},1024)):g("",!0),P.value[l.id].status==="failed"?(n(),v(e(de),{key:1,variant:"destructive",class:"mt-2"},{default:t(()=>[s(e(na),{class:"h-4 w-4"}),s(e(me),null,{default:t(()=>[...a[42]||(a[42]=[r("Error en sincronización",-1)])]),_:1}),s(e(ce),null,{default:t(()=>[r(d(P.value[l.id].message),1)]),_:2},1024)]),_:2},1024)):g("",!0)])):g("",!0)]))),128))]))]),_:1})]),_:1}),i.asamblea.acta_url?(n(),v(e(q),{key:1},{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(j),null,{default:t(()=>[...a[43]||(a[43]=[r("Acta de la Asamblea",-1)])]),_:1})]),_:1}),s(e(F),null,{default:t(()=>[o("a",{href:i.asamblea.acta_url,target:"_blank",class:"flex items-center gap-2 text-blue-600 hover:underline"},[s(e(be),{class:"h-4 w-4"}),a[44]||(a[44]=r(" Ver Acta ",-1))],8,bs)]),_:1})]),_:1})):g("",!0)]),s(Qe,{modelValue:U.value,"onUpdate:modelValue":a[5]||(a[5]=l=>U.value=l),title:"Añadir Participantes",description:"Selecciona los usuarios que deseas añadir como participantes de la asamblea","search-endpoint":e(w)("admin.asambleas.manage-participantes",k.asamblea.id),"extra-fields":$.value,"search-placeholder":"Buscar por nombre, email, documento o teléfono...","submit-button-text":"Añadir Participantes","empty-message":"Escribe para buscar usuarios disponibles","no-results-message":"No se encontraron usuarios con esa búsqueda",onSubmit:Pe},null,8,["modelValue","search-endpoint","extra-fields"])]),_:1})],64))}});export{Ut as default};
