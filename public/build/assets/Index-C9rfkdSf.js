import{d as q,c as P,r as E,i as k,e as o,f as e,q as I,w as i,g as r,j as H,t as d,b as w,v as D,h as m,m as p,n as y,A as F,F as A,k as J,s as x}from"./app-DvrHxm-A.js";import{_ as K}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Dzj5c9-q.js";import{_ as g,c as h}from"./CardTitle.vue_vue_type_script_setup_true_lang-DMIs0XFP.js";import{c as Q,_ as c}from"./createLucideIcon-C9SNFSBj.js";import{_ as U}from"./Input.vue_vue_type_script_setup_true_lang-Brldm4hc.js";import{_ as G}from"./HitosDashboard.vue_vue_type_script_setup_true_lang-8ZRoJcTC.js";import{t as M}from"./index-DgnEweSZ.js";import{A as O}from"./arrow-left-CWnBJ8ea.js";import{P as R}from"./plus-ht-a-3Mo.js";import{S as W}from"./search-BVcAX9Sq.js";import{L as X}from"./list-BO9-kNlf.js";import"./useFlashMessages-CHloRx3R.js";import"./index-BLDMSd0k.js";import"./floating-ui.vue-Cf7FBWFK.js";import"./x-NXrdhfCU.js";import"./index-BW7-Zy45.js";import"./shield-BbDYIPbs.js";import"./user-CnCAmwg9.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Beu1EXTj.js";import"./chevron-right-m0_abZes.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CZkE-gea.js";import"./VisuallyHidden-DsBEBkn1.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-WMyc99vm.js";import"./index-DxNcCC-q.js";import"./check-u3RvEb0M.js";import"./Label.vue_vue_type_script_setup_true_lang-DO_0a9LA.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang--qJKglHx.js";import"./circle-alert-MTeQVoNG.js";import"./map-pin-vSY5kVk7.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-TQq5mQR5.js";import"./chevrons-up-down-DP5H385v.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-y-25SQ4W.js";import"./tag-NFwqbqe3.js";import"./users-RWV-6XWO.js";import"./target-CJ8YoB3s.js";import"./vote-N73-qYuX.js";import"./folder-open-6TjxLcK8.js";import"./send-BgrB1uCa.js";import"./file-text-BaRiPrEZ.js";import"./briefcase-0oCEXVio.js";import"./calendar-LPftFaUR.js";import"./megaphone-CjEeNjq7.js";import"./user-check-tcc16dFR.js";import"./clipboard-list-CitBJiId.js";import"./mail-B5jeg0pD.js";import"./message-square-C1oG1Soh.js";import"./external-link-IkNiKorY.js";import"./panel-left-6VkgvZCp.js";import"./index-fBOGNOl1.js";import"./index-CkGx2BsQ.js";import"./Progress.vue_vue_type_script_setup_true_lang-BfSziViM.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-eEJzrkA3.js";import"./Separator.vue_vue_type_script_setup_true_lang-1pSfRjiQ.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CQqij5Xj.js";import"./es-BDPlFIsO.js";import"./StatusChangeModal.vue_vue_type_script_setup_true_lang-znp2MKkB.js";import"./Switch.vue_vue_type_script_setup_true_lang-DGbrmhDP.js";import"./VisuallyHiddenInput-CTEU0gLm.js";import"./ComentarioContextoInput.vue_vue_type_script_setup_true_lang-DdO8hm_H.js";import"./RichTextEditor-_8LEeKnb.js";import"./italic-ruLSrjLX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FileUploadField.vue_vue_type_script_setup_true_lang-CAmGm2fo.js";import"./useFileUpload-pklDtcfO.js";import"./upload-Dy1sQ_34.js";import"./file-13TEx2ga.js";import"./eye-G5n6j-F0.js";import"./download-6HPizJ9j.js";import"./paperclip-C200O0sq.js";import"./circle-x-CMNW14IR.js";import"./clock-CAkFilXS.js";import"./circle-check-big-XiYYpZgm.js";import"./loader-circle-CZL8Kmhy.js";import"./flag-B3C9F7M-.js";import"./square-pen-CuYWTOhv.js";import"./trash-2-0hXXyiOB.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-Dnc-YD0L.js";import"./RovingFocusItem-qX6RLn2v.js";import"./utils-CzAhuahs.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=Q("NetworkIcon",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),Z={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},tt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},et={class:"text-sm text-muted-foreground mt-1"},ot={class:"flex items-center gap-2"},it={key:0,class:"grid grid-cols-2 md:grid-cols-5 gap-4"},rt={class:"text-2xl font-bold"},st={class:"text-2xl font-bold text-gray-500"},at={class:"text-2xl font-bold text-blue-500"},lt={class:"text-2xl font-bold text-green-500"},nt={class:"flex flex-col sm:flex-row gap-2"},dt={class:"flex-1"},mt={class:"relative"},pt={class:"flex gap-2"},ct={key:1,class:"flex justify-center gap-2 mt-4"},Le=q({__name:"Index",props:{proyecto:{},hitos:{},filters:{},estadisticas:{},timeline:{},canCreate:{type:Boolean},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageDeliverables:{type:Boolean}},setup(s){var z,B;const l=s,u=P(()=>Array.isArray(l.hitos)?{data:l.hitos,current_page:1,last_page:1,per_page:l.hitos.length,total:l.hitos.length}:l.hitos),C=E(((z=l.filters)==null?void 0:z.search)||""),f=E(((B=l.filters)==null?void 0:B.estado)||""),v=E(!1);P(()=>{if(!v.value)return u.value.data;const n=u.value.data.filter(a=>!a.parent_id),t=(a,_=0)=>u.value.data.filter($=>$.parent_id===a).flatMap($=>[{...$,_nivel:_},...t($.id,_+1)]);return n.flatMap(a=>[{...a,_nivel:0},...t(a.id,1)])});const N=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:l.proyecto.nombre,href:`/admin/proyectos/${l.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${l.proyecto.id}/hitos`}],S=n=>{x.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`)},T=n=>{x.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/edit`)},L=n=>{confirm(`¿Estás seguro de eliminar el hito "${n.nombre}"?`)&&x.delete(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`,{onSuccess:()=>{M.success("Hito eliminado exitosamente")},onError:()=>{M.error("Error al eliminar el hito")}})},j=n=>{x.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/entregables/create`)},V=()=>{x.get(`/admin/proyectos/${l.proyecto.id}/hitos`,{search:C.value,estado:f.value},{preserveState:!0,preserveScroll:!0})},b=n=>{f.value=n,V()};return(n,t)=>(p(),k(A,null,[o(e(I),{title:`Hitos - ${s.proyecto.nombre}`},null,8,["title"]),o(K,{breadcrumbs:N},{default:i(()=>[r("div",Z,[r("div",tt,[r("div",null,[t[6]||(t[6]=r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Hitos del Proyecto ",-1)),r("p",et,d(s.proyecto.nombre),1)]),r("div",ot,[o(e(D),{href:`/admin/proyectos/${s.proyecto.id}`},{default:i(()=>[o(e(c),{variant:"outline",size:"sm"},{default:i(()=>[o(e(O),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=m(" Volver al Proyecto ",-1))]),_:1})]),_:1},8,["href"]),s.canCreate?(p(),w(e(D),{key:0,href:`/admin/proyectos/${s.proyecto.id}/hitos/create`},{default:i(()=>[o(e(c),{size:"sm"},{default:i(()=>[o(e(R),{class:"h-4 w-4 mr-2"}),t[8]||(t[8]=m(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):H("",!0)])]),s.estadisticas?(p(),k("div",it,[o(e(g),null,{default:i(()=>[o(e(h),{class:"p-4"},{default:i(()=>[r("p",rt,d(s.estadisticas.total),1),t[9]||(t[9]=r("p",{class:"text-xs text-muted-foreground"},"Total",-1))]),_:1})]),_:1}),o(e(g),null,{default:i(()=>[o(e(h),{class:"p-4"},{default:i(()=>[r("p",st,d(s.estadisticas.pendientes),1),t[10]||(t[10]=r("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),_:1})]),_:1}),o(e(g),null,{default:i(()=>[o(e(h),{class:"p-4"},{default:i(()=>[r("p",at,d(s.estadisticas.en_progreso),1),t[11]||(t[11]=r("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),_:1})]),_:1}),o(e(g),null,{default:i(()=>[o(e(h),{class:"p-4"},{default:i(()=>[r("p",lt,d(s.estadisticas.completados),1),t[12]||(t[12]=r("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),_:1})]),_:1}),o(e(g),null,{default:i(()=>[o(e(h),{class:"p-4"},{default:i(()=>[r("p",{class:y(["text-2xl font-bold",{"text-red-500":s.estadisticas.vencidos>0}])},d(s.estadisticas.vencidos),3),t[13]||(t[13]=r("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))]),_:1})]),_:1})])):H("",!0),r("div",nt,[r("div",dt,[r("div",mt,[o(e(W),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o(e(U),{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=a=>C.value=a),placeholder:"Buscar hitos...",class:"pl-9",onKeyup:F(V,["enter"])},null,8,["modelValue"])])]),r("div",pt,[o(e(c),{variant:"outline",size:"sm",class:y({"bg-primary text-primary-foreground":v.value}),onClick:t[1]||(t[1]=a=>v.value=!v.value),title:"Cambiar vista"},{default:i(()=>[v.value?(p(),w(e(Y),{key:0,class:"h-4 w-4 mr-2"})):(p(),w(e(X),{key:1,class:"h-4 w-4 mr-2"})),m(" "+d(v.value?"Jerárquica":"Plana"),1)]),_:1},8,["class"]),o(e(c),{variant:"outline",size:"sm",class:y({"bg-primary text-primary-foreground":f.value===""}),onClick:t[2]||(t[2]=a=>b(""))},{default:i(()=>[...t[14]||(t[14]=[m(" Todos ",-1)])]),_:1},8,["class"]),o(e(c),{variant:"outline",size:"sm",class:y({"bg-primary text-primary-foreground":f.value==="pendiente"}),onClick:t[3]||(t[3]=a=>b("pendiente"))},{default:i(()=>[...t[15]||(t[15]=[m(" Pendientes ",-1)])]),_:1},8,["class"]),o(e(c),{variant:"outline",size:"sm",class:y({"bg-primary text-primary-foreground":f.value==="en_progreso"}),onClick:t[4]||(t[4]=a=>b("en_progreso"))},{default:i(()=>[...t[16]||(t[16]=[m(" En Progreso ",-1)])]),_:1},8,["class"]),o(e(c),{variant:"outline",size:"sm",class:y({"bg-primary text-primary-foreground":f.value==="completado"}),onClick:t[5]||(t[5]=a=>b("completado"))},{default:i(()=>[...t[17]||(t[17]=[m(" Completados ",-1)])]),_:1},8,["class"])])]),o(G,{hitos:u.value.data,"proyecto-id":s.proyecto.id,"can-edit":s.canEdit,"can-delete":s.canDelete,"can-manage-deliverables":s.canManageDeliverables,"can-complete":s.canManageDeliverables,"base-url":"/admin/proyectos",onViewHito:S,onEditHito:T,onDeleteHito:L,onAddEntregable:j},null,8,["hitos","proyecto-id","can-edit","can-delete","can-manage-deliverables","can-complete"]),u.value.last_page>1?(p(),k("div",ct,[(p(!0),k(A,null,J(u.value.last_page,a=>(p(),w(e(c),{key:a,variant:a===u.value.current_page?"default":"outline",size:"sm",onClick:_=>e(x).visit(`/admin/proyectos/${s.proyecto.id}/hitos?page=${a}`)},{default:i(()=>[m(d(a),1)]),_:2},1032,["variant","onClick"]))),128))])):H("",!0)])]),_:1})],64))}});export{Le as default};
