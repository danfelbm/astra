import{d as F,c as P,r as z,i as w,e as o,f as e,q as J,w as a,g as s,j as S,t as m,b as _,v as D,h as p,m as c,n as v,A as K,F as A,k as Q,s as d}from"./app-y4isNqXm.js";import{_ as G}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BvSka-gx.js";import{_ as b,c as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dadbzwfh.js";import{c as O,_ as u}from"./createLucideIcon-mCVR8rL0.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-BKHyNrqK.js";import{_ as W}from"./HitosDashboard.vue_vue_type_script_setup_true_lang-BF7lnAQi.js";import{t as x}from"./index-C9YznISG.js";import{A as X}from"./arrow-left-K7rTb4BN.js";import{P as Y}from"./plus-CUf-YtBc.js";import{S as Z}from"./search-BbWGgfIJ.js";import{L as tt}from"./list-CQPKlXsx.js";import"./useFlashMessages-FTGjIqdP.js";import"./index-C2MoGcR6.js";import"./floating-ui.vue-xdvz-kq7.js";import"./x-D_E1k7_n.js";import"./index-B9qYd8OT.js";import"./shield-DWoLTuqf.js";import"./user-C_FJcT-g.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-6vX9ZX1T.js";import"./chevron-right-bINHmwj6.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-C8Rk8AiP.js";import"./VisuallyHidden-DJswMYCp.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-BUdvrEJT.js";import"./index-CcU3hycU.js";import"./check-6I8478aV.js";import"./Label.vue_vue_type_script_setup_true_lang-CC4rd9kP.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CNb--sGY.js";import"./circle-alert-Ddoyjw3_.js";import"./map-pin-DcjZ8yWx.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-CBpBOOKh.js";import"./chevrons-up-down-EHQTTQnX.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-i_DNMnhz.js";import"./folder-DV0e_XpO.js";import"./users-TaqwL9Hf.js";import"./target-Cwu941VC.js";import"./vote-BE31yCSr.js";import"./folder-open-CR778kJc.js";import"./send-CMlKMa8p.js";import"./file-text-D6v7F4kd.js";import"./briefcase-CGik1Ys4.js";import"./calendar-VmbXhbGS.js";import"./megaphone-DZTXB9Yd.js";import"./user-check-C1eQjWhi.js";import"./clipboard-list-2XROZaCh.js";import"./mail-Mb4dvj7E.js";import"./message-square-rXQT8F_4.js";import"./external-link-CByLedJd.js";import"./panel-left-50tlwzCJ.js";import"./index-DRJ3k44r.js";import"./index-XQn911Vk.js";import"./Progress.vue_vue_type_script_setup_true_lang-XR50aG_U.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-5wiguyj2.js";import"./Separator.vue_vue_type_script_setup_true_lang-CabZdf2c.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DPPBreJV.js";import"./es-BDPlFIsO.js";import"./EntregablesFilters.vue_vue_type_script_setup_true_lang-CovGrAK8.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-C2fd16d3.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BvofcSrr.js";import"./Switch.vue_vue_type_script_setup_true_lang-B7Oys8bJ.js";import"./VisuallyHiddenInput-BXSfD9RT.js";import"./ComentarioContextoInput.vue_vue_type_script_setup_true_lang-nBlqHF55.js";import"./RichTextEditor-DjXUATEi.js";import"./italic-c2DXA8Cn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FileUploadField.vue_vue_type_script_setup_true_lang-BHgFVjjV.js";import"./useFileUpload-nSXA6ajj.js";import"./upload-CTGyYtkC.js";import"./file-DFWhB8GO.js";import"./eye-BFD7WhEX.js";import"./download-rGrR-Gcc.js";import"./paperclip-yGmwe5hS.js";import"./circle-x-D0ZGd2FL.js";import"./clock-CGn_bZQ6.js";import"./circle-check-big-DJnT-ptJ.js";import"./loader-circle-D_Ekdlkw.js";import"./square-pen-DEFJhBdJ.js";import"./circle-check-DOdOsOVO.js";import"./trash-2-BoTHZSgE.js";import"./filter-DJy2mfzd.js";import"./flag-Ubg9DDrE.js";import"./EvidenciasTable.vue_vue_type_script_setup_true_lang-Cqj6D_eZ.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-FYV2WCad.js";import"./useArrowNavigation-B5rxJs06.js";import"./image-COS_Wzkl.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-sp3f-yPe.js";import"./RovingFocusItem-Cj1tEZKG.js";import"./utils-L12AeMjz.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-Dd0hows2.js";import"./ActivityLog.vue_vue_type_script_setup_true_lang-DIRBBL7H.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-CtQPrOzG.js";import"./arrow-right-xG2-7MuZ.js";import"./parseISO-DFjB8F03.js";import"./CamposPersonalizadosDisplay.vue_vue_type_script_setup_true_lang-NmamyKlI.js";import"./ComentariosPanel.vue_vue_type_script_setup_true_lang-B3sU-l4z.js";import"./ellipsis-BV_mrgMK.js";import"./chevron-left-X1RdjtZv.js";import"./refresh-cw-DtehbA0A.js";import"./index-Dps3Wpmu.js";import"./differenceInDays-CDkc-BiT.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=O("NetworkIcon",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),ot={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},rt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},it={class:"text-sm text-muted-foreground mt-1"},at={class:"flex items-center gap-2"},st={key:0,class:"grid grid-cols-2 md:grid-cols-5 gap-4"},lt={class:"text-2xl font-bold"},nt={class:"text-2xl font-bold text-gray-500"},dt={class:"text-2xl font-bold text-blue-500"},mt={class:"text-2xl font-bold text-green-500"},pt={class:"flex flex-col sm:flex-row gap-2"},ct={class:"flex-1"},ut={class:"relative"},ft={class:"flex gap-2"},yt={key:1,class:"flex justify-center gap-2 mt-4"},lo=F({__name:"Index",props:{proyecto:{},hitos:{},filters:{},estadisticas:{},timeline:{},canCreate:{type:Boolean},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageDeliverables:{type:Boolean}},setup(l){var H,B;const n=l,f=P(()=>Array.isArray(n.hitos)?{data:n.hitos,current_page:1,last_page:1,per_page:n.hitos.length,total:n.hitos.length}:n.hitos),C=z(((H=n.filters)==null?void 0:H.search)||""),y=z(((B=n.filters)==null?void 0:B.estado)||""),g=z(!1);P(()=>{if(!g.value)return f.value.data;const i=f.value.data.filter(r=>!r.parent_id),t=(r,h=0)=>f.value.data.filter(E=>E.parent_id===r).flatMap(E=>[{...E,_nivel:h},...t(E.id,h+1)]);return i.flatMap(r=>[{...r,_nivel:0},...t(r.id,1)])});const M=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:n.proyecto.nombre,href:`/admin/proyectos/${n.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${n.proyecto.id}/hitos`}],N=i=>{d.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}`)},T=i=>{d.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}/edit`)},L=i=>{confirm(`¿Estás seguro de eliminar el hito "${i.nombre}"?`)&&d.delete(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}`,{onSuccess:()=>{x.success("Hito eliminado exitosamente")},onError:()=>{x.error("Error al eliminar el hito")}})},j=i=>{d.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${i.id}/entregables/create`)},q=(i,t)=>{d.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${t.id}/entregables/${i.id}`)},I=(i,t,r)=>{d.post(`/admin/proyectos/${n.proyecto.id}/hitos/${i.hito_id}/entregables/${i.id}/completar`,{notas:t,archivos:r,agregar_comentario:!!t},{preserveScroll:!0,onSuccess:()=>{x.success("Entregable marcado como completado")},onError:()=>{x.error("Error al completar el entregable")}})},U=(i,t,r,h)=>{d.post(`/admin/proyectos/${n.proyecto.id}/hitos/${i.hito_id}/entregables/${i.id}/actualizar-estado`,{estado:t,observaciones:r,archivos:h,agregar_comentario:!!r},{preserveScroll:!0,onSuccess:()=>{x.success("Estado del entregable actualizado")},onError:()=>{x.error("Error al actualizar el estado")}})},V=()=>{d.get(`/admin/proyectos/${n.proyecto.id}/hitos`,{search:C.value,estado:y.value},{preserveState:!0,preserveScroll:!0})},k=i=>{y.value=i,V()};return(i,t)=>(c(),w(A,null,[o(e(J),{title:`Hitos - ${l.proyecto.nombre}`},null,8,["title"]),o(G,{breadcrumbs:M},{default:a(()=>[s("div",ot,[s("div",rt,[s("div",null,[t[6]||(t[6]=s("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Hitos del Proyecto ",-1)),s("p",it,m(l.proyecto.nombre),1)]),s("div",at,[o(e(D),{href:`/admin/proyectos/${l.proyecto.id}`},{default:a(()=>[o(e(u),{variant:"outline",size:"sm"},{default:a(()=>[o(e(X),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=p(" Volver al Proyecto ",-1))]),_:1})]),_:1},8,["href"]),l.canCreate?(c(),_(e(D),{key:0,href:`/admin/proyectos/${l.proyecto.id}/hitos/create`},{default:a(()=>[o(e(u),{size:"sm"},{default:a(()=>[o(e(Y),{class:"h-4 w-4 mr-2"}),t[8]||(t[8]=p(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):S("",!0)])]),l.estadisticas?(c(),w("div",st,[o(e(b),null,{default:a(()=>[o(e($),{class:"p-4"},{default:a(()=>[s("p",lt,m(l.estadisticas.total),1),t[9]||(t[9]=s("p",{class:"text-xs text-muted-foreground"},"Total",-1))]),_:1})]),_:1}),o(e(b),null,{default:a(()=>[o(e($),{class:"p-4"},{default:a(()=>[s("p",nt,m(l.estadisticas.pendientes),1),t[10]||(t[10]=s("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),_:1})]),_:1}),o(e(b),null,{default:a(()=>[o(e($),{class:"p-4"},{default:a(()=>[s("p",dt,m(l.estadisticas.en_progreso),1),t[11]||(t[11]=s("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),_:1})]),_:1}),o(e(b),null,{default:a(()=>[o(e($),{class:"p-4"},{default:a(()=>[s("p",mt,m(l.estadisticas.completados),1),t[12]||(t[12]=s("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),_:1})]),_:1}),o(e(b),null,{default:a(()=>[o(e($),{class:"p-4"},{default:a(()=>[s("p",{class:v(["text-2xl font-bold",{"text-red-500":l.estadisticas.vencidos>0}])},m(l.estadisticas.vencidos),3),t[13]||(t[13]=s("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))]),_:1})]),_:1})])):S("",!0),s("div",pt,[s("div",ct,[s("div",ut,[o(e(Z),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o(e(R),{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=r=>C.value=r),placeholder:"Buscar hitos...",class:"pl-9",onKeyup:K(V,["enter"])},null,8,["modelValue"])])]),s("div",ft,[o(e(u),{variant:"outline",size:"sm",class:v({"bg-primary text-primary-foreground":g.value}),onClick:t[1]||(t[1]=r=>g.value=!g.value),title:"Cambiar vista"},{default:a(()=>[g.value?(c(),_(e(et),{key:0,class:"h-4 w-4 mr-2"})):(c(),_(e(tt),{key:1,class:"h-4 w-4 mr-2"})),p(" "+m(g.value?"Jerárquica":"Plana"),1)]),_:1},8,["class"]),o(e(u),{variant:"outline",size:"sm",class:v({"bg-primary text-primary-foreground":y.value===""}),onClick:t[2]||(t[2]=r=>k(""))},{default:a(()=>[...t[14]||(t[14]=[p(" Todos ",-1)])]),_:1},8,["class"]),o(e(u),{variant:"outline",size:"sm",class:v({"bg-primary text-primary-foreground":y.value==="pendiente"}),onClick:t[3]||(t[3]=r=>k("pendiente"))},{default:a(()=>[...t[15]||(t[15]=[p(" Pendientes ",-1)])]),_:1},8,["class"]),o(e(u),{variant:"outline",size:"sm",class:v({"bg-primary text-primary-foreground":y.value==="en_progreso"}),onClick:t[4]||(t[4]=r=>k("en_progreso"))},{default:a(()=>[...t[16]||(t[16]=[p(" En Progreso ",-1)])]),_:1},8,["class"]),o(e(u),{variant:"outline",size:"sm",class:v({"bg-primary text-primary-foreground":y.value==="completado"}),onClick:t[5]||(t[5]=r=>k("completado"))},{default:a(()=>[...t[17]||(t[17]=[p(" Completados ",-1)])]),_:1},8,["class"])])]),o(W,{hitos:f.value.data,"proyecto-id":l.proyecto.id,"can-edit":l.canEdit,"can-delete":l.canDelete,"can-manage-deliverables":l.canManageDeliverables,"can-complete":l.canManageDeliverables,"base-url":"/admin/proyectos",onViewHito:N,onEditHito:T,onDeleteHito:L,onAddEntregable:j,onViewEntregable:q,onCompleteEntregable:I,onUpdateEntregableStatus:U},null,8,["hitos","proyecto-id","can-edit","can-delete","can-manage-deliverables","can-complete"]),f.value.last_page>1?(c(),w("div",yt,[(c(!0),w(A,null,Q(f.value.last_page,r=>(c(),_(e(u),{key:r,variant:r===f.value.current_page?"default":"outline",size:"sm",onClick:h=>e(d).visit(`/admin/proyectos/${l.proyecto.id}/hitos?page=${r}`)},{default:a(()=>[p(m(r),1)]),_:2},1032,["variant","onClick"]))),128))])):S("",!0)])]),_:1})],64))}});export{lo as default};
