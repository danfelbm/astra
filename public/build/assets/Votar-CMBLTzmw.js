import{d as C,C as k,k as F,c as v,a as T,o as S,b as e,u as o,m as A,e as i,f as a,t as m,g as s,n as M,h as z,F as B,W as q}from"./app-uqgoC9P3.js";import{_ as N}from"./index-Ch-ylojk.js";import{_ as g}from"./createLucideIcon-DYYZ8d8j.js";import{_ as b,c as x,a as U,b as j}from"./CardTitle.vue_vue_type_script_setup_true_lang-DYxclH40.js";import{_ as L,a as R,b as W,c as G,d as H,e as I,f as J,g as K}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-Ctk_vMrv.js";import{_ as O}from"./UserLayout.vue_vue_type_script_setup_true_lang-BlvY9m3L.js";import{D as P}from"./DynamicFormRenderer-6Ce0xEIi.js";import{A as Q}from"./arrow-left-DiBkjcYj.js";import{C as X}from"./clock-Xir7CfmS.js";import{T as Y}from"./triangle-alert-DaHjRgLY.js";import{V as $}from"./vote-CjDHfvbc.js";import"./index-3PJFboPx.js";import"./VisuallyHidden-D4UYEJiU.js";import"./Input.vue_vue_type_script_setup_true_lang-BUQ8h4mk.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D7Yoy2IF.js";import"./PopperContent-bQryVTkf.js";import"./floating-ui.vue-9q4rJ5MR.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-WmfZ5qRR.js";import"./check-DIu3_Sq6.js";import"./nullish-CHIgUVhi.js";import"./x-CVrJT_FT.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DQs-6ABP.js";import"./index-BwwIHVWL.js";import"./shield-B0yuCzDx.js";import"./user-CjmsF3u4.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D6Z3yHKs.js";import"./Label.vue_vue_type_script_setup_true_lang-C0Y6AGVd.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Dzid8Kmk.js";import"./index-JMjM76-u.js";import"./circle-alert-D1W5s3bu.js";import"./map-pin-CD_aikIG.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BjaJLPMP.js";import"./square-check-big-B-anHbk4.js";import"./file-text-E2I6sKSt.js";import"./users-sB3os_bH.js";import"./index-CIjidGQc.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DtaWd4Ev.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-pqHpkWWC.js";import"./Textarea.vue_vue_type_script_setup_true_lang-X9kLRArE.js";import"./plus-DA0fGvSy.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-Dhz-N00G.js";import"./RovingFocusItem-DHriXEq5.js";import"./utils-BxRIveoW.js";import"./VisuallyHiddenInput-DaG3v3Va.js";import"./useConditionalFields-4W4E_0E0.js";import"./upload-CuuYaseO.js";import"./eye-CG1F308a.js";import"./download-_FkkBxqq.js";import"./calendar-ChB8nT0z.js";import"./grip-vertical-Dkqk6v0b.js";import"./trash-2-BRDtwBGY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},tt={class:"flex items-center justify-between"},ot={class:"text-3xl font-bold"},et={class:"text-muted-foreground"},rt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},it={class:"flex items-center gap-2"},at={class:"flex items-center gap-2 text-sm text-muted-foreground"},st={class:"flex items-center gap-2 text-sm"},nt={class:"flex justify-end pt-6 border-t"},no=C({__name:"Votar",props:{votacion:{},candidatosElegibles:{}},setup(h){const d=h,V=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Votaciones",href:"/miembro/votaciones"},{title:"Votar",href:"#"}],n=k((()=>{const r={};return d.votacion.formulario_config.forEach(t=>{t.type==="checkbox"?r[t.id]=[]:r[t.id]=""}),{respuestas:r}})()),u=F(!1),y=()=>{n.post(route("user.votaciones.store",{votacion:d.votacion.id}),{onSuccess:()=>{},onError:r=>{console.error("Errores de validación:",r)}})},w=()=>{q.get(route("user.votaciones.index"))},D=r=>new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=v(()=>{const r=new Date,l=new Date(d.votacion.fecha_fin).getTime()-r.getTime();if(l<=0)return"Expirada";const c=Math.floor(l/(1e3*60*60)),f=Math.floor(l%(1e3*60*60)/(1e3*60));if(c>24){const _=Math.floor(c/24);return`${_} día${_>1?"s":""}`}else return c>0?`${c}h ${f}m`:`${f}m`}),E=v(()=>d.votacion.formulario_config.every(r=>{if(!r.required)return!0;const t=n.respuestas[r.id];return r.type==="checkbox"?Array.isArray(t)&&t.length>0:r.type==="convocatoria"?t!==""&&t!==void 0:t&&t.toString().trim()!==""}));return(r,t)=>(S(),T(B,null,[e(o(A),{title:`Votar: ${r.votacion.titulo}`},null,8,["title"]),e(O,{breadcrumbs:V},{default:i(()=>[a("div",Z,[a("div",tt,[a("div",null,[a("h1",ot,m(r.votacion.titulo),1),a("p",et,m(r.votacion.descripcion),1)]),e(o(g),{variant:"outline",onClick:w},{default:i(()=>[e(o(Q),{class:"mr-2 h-4 w-4"}),t[3]||(t[3]=s(" Volver ",-1))]),_:1})]),e(o(b),null,{default:i(()=>[e(o(x),{class:"pt-6"},{default:i(()=>[a("div",rt,[a("div",it,[e(o(N),{variant:"outline"},{default:i(()=>[s(m(r.votacion.categoria.nombre),1)]),_:1})]),a("div",at,[e(o(X),{class:"h-4 w-4"}),s(" Termina: "+m(D(r.votacion.fecha_fin)),1)]),a("div",st,[e(o(Y),{class:"h-4 w-4 text-orange-600"}),a("span",{class:M(p.value==="Expirada"?"text-red-600":"text-orange-600")},m(p.value==="Expirada"?"Votación expirada":`Tiempo restante: ${p.value}`),3)])])]),_:1})]),_:1}),e(o(b),null,{default:i(()=>[e(o(U),null,{default:i(()=>[e(o(j),{class:"flex items-center gap-2"},{default:i(()=>[e(o($),{class:"h-5 w-5"}),t[4]||(t[4]=s(" Formulario de Votación ",-1))]),_:1})]),_:1}),e(o(x),null,{default:i(()=>[a("form",{onSubmit:t[1]||(t[1]=z(l=>u.value=!0,["prevent"])),class:"space-y-6"},[e(P,{fields:r.votacion.formulario_config,modelValue:o(n).respuestas,"onUpdate:modelValue":t[0]||(t[0]=l=>o(n).respuestas=l),"candidatos-elegibles":r.candidatosElegibles||{},errors:o(n).errors,disabled:o(n).processing,title:"",description:"",context:"votacion"},null,8,["fields","modelValue","candidatos-elegibles","errors","disabled"]),a("div",nt,[e(o(g),{type:"submit",disabled:!E.value||o(n).processing,class:"min-w-32"},{default:i(()=>[e(o($),{class:"mr-2 h-4 w-4"}),s(" "+m(o(n).processing?"Enviando...":"Enviar Voto"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),e(o(L),{open:u.value,"onUpdate:open":t[2]||(t[2]=l=>u.value=l)},{default:i(()=>[e(o(R),null,{default:i(()=>[e(o(W),null,{default:i(()=>[e(o(G),null,{default:i(()=>[...t[5]||(t[5]=[s("¿Confirmar voto?",-1)])]),_:1}),e(o(H),null,{default:i(()=>[...t[6]||(t[6]=[s(" Una vez enviado tu voto, no podrás modificarlo. ¿Estás seguro de que quieres proceder? ",-1)])]),_:1})]),_:1}),e(o(I),null,{default:i(()=>[e(o(J),null,{default:i(()=>[...t[7]||(t[7]=[s("Cancelar",-1)])]),_:1}),e(o(K),{onClick:y,class:"bg-primary"},{default:i(()=>[...t[8]||(t[8]=[s(" Confirmar Voto ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{no as default};
