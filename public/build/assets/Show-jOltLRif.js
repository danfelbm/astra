import{r as N,s as _,d as ie,c as L,b as f,w as o,j as p,e as s,f as e,g as r,i as h,h as d,t as c,v as P,n as I,F as A,k as F,m as l,q as ve,x as xe,l as ae}from"./app-D3uL80DL.js";import{_ as he}from"./AdminLayout.vue_vue_type_script_setup_true_lang-5b8sApI_.js";import{a as T,b as B,c as q,_ as C}from"./CardTitle.vue_vue_type_script_setup_true_lang-qn2XrUlO.js";import{_ as ne}from"./CardDescription.vue_vue_type_script_setup_true_lang-DxN2cRJp.js";import{_ as D}from"./createLucideIcon-BrIWJaVK.js";import{_ as H}from"./index-oixONa7Y.js";import{_ as de}from"./Progress.vue_vue_type_script_setup_true_lang-3xp5v5iG.js";import{_ as be,a as we,b as O,c as R}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-DyhNKN5y.js";import{_ as $e,a as Ee,b as se,c as j,d as _e,e as M}from"./TableHeader.vue_vue_type_script_setup_true_lang-B9n_iXov.js";import{t as V}from"./index-B0qEHdwE.js";import{E as ke}from"./EtiquetaDisplay-Cn0qTAYe.js";import{E as qe}from"./EtiquetaSelector-B5ktQF1r.js";import{_ as Ce}from"./ContratosList.vue_vue_type_script_setup_true_lang-B5HMC3nJ.js";import{_ as Se}from"./EvidenciaFilters.vue_vue_type_script_setup_true_lang-CsSxkqxt.js";import{_ as De,a as He,b as Pe,c as Ve}from"./AccordionContent.vue_vue_type_script_setup_true_lang-D-FVoQmw.js";import{L as Te,H as Be}from"./HitoCard-8eFBUCmG.js";import{T as Z}from"./target-oXTbk5NL.js";import{P as G}from"./plus-D-R--w-I.js";import{S as oe}from"./square-pen-qpqeOssU.js";import{T as je}from"./trash-2-05Ewy39g.js";import{I as Me}from"./info-C6cQxCO8.js";import{F as W}from"./file-text-DcJUgIfz.js";import{M as ze,B as Ae,C as Ne}from"./milestone-Ca-HdFqn.js";import{I as Y}from"./image-CYIn1MXk.js";import{F as Ie}from"./flag-7MApIWOX.js";import{C as re}from"./calendar-CDRuCcQt.js";import{C as Fe}from"./clock-j5gzA8iu.js";import{U as le}from"./user-CWm-7GfG.js";import{E as Le}from"./external-link-fPhA16MY.js";import{D as Ue}from"./download-BGT3MxGT.js";import{C as Oe}from"./circle-check-big-DAa-ZeGI.js";import{C as Re}from"./circle-play-BW5ISTD9.js";import{C as Ge}from"./circle-alert-k0Ae0_nD.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BznyTpGx.js";import"./index-TDmGTbds.js";import"./floating-ui.vue-BNjM7QfA.js";import"./x-BzM2ne4W.js";import"./Input.vue_vue_type_script_setup_true_lang-uaeWT7ys.js";import"./index-Co0N6nza.js";import"./index-bPeRYsmi.js";import"./shield-B6xROWvg.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-oX-V50Fz.js";import"./chevron-right-Dr7PM1oh.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BH87WPyf.js";import"./VisuallyHidden-C1r3Vs3T.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-BOihT4Gi.js";import"./check-BgfrpJ3m.js";import"./Label.vue_vue_type_script_setup_true_lang-gGRu1ZPZ.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CMVjCFVi.js";import"./map-pin-D30VnEkT.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-D6KXfYdF.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Di9ublVQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-MvU5-ZU8.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C247yu8_.js";import"./tag-BE3jt4iA.js";import"./users-DQdQrWqw.js";import"./vote-BVQT8UmH.js";import"./folder-open-8K0iuanW.js";import"./send-DuzmAr6j.js";import"./briefcase-BEuFNtLg.js";import"./megaphone-NaazjYw7.js";import"./user-check-DUScA6Vz.js";import"./clipboard-list-DWwYfDFn.js";import"./mail-TC-dEBUZ.js";import"./message-square-C2LYB39K.js";import"./panel-left-uN3Ol8Pl.js";import"./index-dOclHMU_.js";import"./RovingFocusItem-ByMnhA07.js";import"./utils-Br8-RYzW.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BH6AUmpH.js";import"./layers-DDC6xzf7.js";import"./zap-CvTlzA1l.js";import"./trending-up-DSKbwzfh.js";import"./award-DnZFa3SG.js";import"./hash-Dcrv1ENn.js";import"./index-Bjt9oCqj.js";import"./search-BXL9qeIH.js";import"./useKbd-kRIii9yh.js";import"./VisuallyHiddenInput-DZUA9VZv.js";import"./useEtiquetaHierarchy-Bbixf3DF.js";import"./list-BdV2-Xd-.js";import"./tree-pine-ivYGHfFV.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-D75gecXx.js";import"./useToast-CQ2HDH3p.js";import"./dollar-sign-DjRRVuJ3.js";import"./ellipsis-Cc4SK3ef.js";import"./eye-CtABHz_g.js";import"./copy-CW0bD_1k.js";import"./useArrowNavigation-B5rxJs06.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-DnPveQ04.js";import"./pen-Silk4Uhy.js";import"./calendar-days-D_I1_o0H.js";import"./es-BDPlFIsO.js";function Je(){const a=N(!1),u=N(null);async function z(x,m){return a.value=!0,u.value=null,new Promise((v,w)=>{_.post(`/admin/proyectos/${x}/etiquetas`,{etiqueta_id:m},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{a.value=!1,v(!0)},onError:$=>{a.value=!1,u.value=Object.values($).join(", "),w($)}})})}async function b(x,m){return a.value=!0,u.value=null,new Promise((v,w)=>{_.delete(`/admin/proyectos/${x}/etiquetas/${m}`,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{a.value=!1,v(!0)},onError:$=>{a.value=!1,u.value="Error al quitar la etiqueta",w($)}})})}async function E(x,m){return a.value=!0,u.value=null,new Promise((v,w)=>{_.put(`/admin/proyectos/${x}/etiquetas/sync`,{etiquetas:m},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{a.value=!1,v(!0)},onError:$=>{a.value=!1,u.value="Error al sincronizar etiquetas",w($)}})})}async function g(x){a.value=!0,u.value=null;try{const m=await fetch(`/admin/proyectos/${x}/etiquetas/suggest`);if(!m.ok)throw new Error("Error al obtener sugerencias");const v=await m.json();return a.value=!1,v.etiquetas||[]}catch(m){return a.value=!1,u.value="Error al obtener sugerencias de etiquetas",console.error(m),[]}}async function k(x){var m;a.value=!0,u.value=null;try{const v=await fetch("/admin/etiquetas",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.getAttribute("content"))||""},body:JSON.stringify(x)});if(!v.ok){const $=await v.json();throw new Error($.message||"Error al crear etiqueta")}const w=await v.json();return a.value=!1,w.data}catch(v){return a.value=!1,u.value=v.message||"Error al crear etiqueta",console.error(v),null}}async function S(x){if(x.length<2)return[];try{const m=await fetch(`/admin/etiquetas/search?q=${encodeURIComponent(x)}`);if(!m.ok)throw new Error("Error al buscar etiquetas");return(await m.json()).data||[]}catch(m){return console.error("Error buscando etiquetas:",m),[]}}function J(x){const m=new Map;return x.forEach(v=>{var $;const w=(($=v.categoria)==null?void 0:$.nombre)||"Sin categoría";m.has(w)||m.set(w,[]),m.get(w).push(v)}),m}function K(x){var m;return x.color||((m=x.categoria)==null?void 0:m.color)||"gray"}function X(x,m=10){return x<m}async function Q(x,m){return a.value=!0,u.value=null,new Promise((v,w)=>{_.post(`/admin/proyectos/${x}/etiquetas/reorder`,{etiquetas:m},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{a.value=!1,v(!0)},onError:$=>{a.value=!1,u.value="Error al reordenar etiquetas",w($)}})})}return{isLoading:a,error:u,addEtiquetaToProyecto:z,removeEtiquetaFromProyecto:b,syncEtiquetasProyecto:E,getSugerenciasEtiquetas:g,reorderEtiquetas:Q,createEtiqueta:k,searchEtiquetas:S,groupEtiquetasByCategoria:J,getEtiquetaColor:K,canAddMoreEtiquetas:X}}const Ke={key:0,class:"flex items-center gap-2"},Xe={key:0,class:"mb-6"},Qe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},We={class:"text-center"},Ye={class:"text-2xl font-bold"},Ze={class:"text-center"},et={class:"text-2xl font-bold text-blue-500"},tt={class:"text-center"},at={class:"text-2xl font-bold text-green-500"},st={class:"text-center"},ot={class:"space-y-2"},rt={class:"flex justify-between items-center text-sm"},lt={class:"font-medium"},it={key:1,class:"space-y-4"},nt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},dt={key:2,class:"text-center py-6"},ct={class:"text-muted-foreground mb-3"},ut=ie({__name:"HitosGrid",props:{hitos:{},proyectoId:{},proyectoNombre:{},estadisticas:{},showStats:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0},showViewAll:{type:Boolean,default:!0},maxHitos:{default:void 0},canCreate:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},emptyMessage:{default:"No hay hitos definidos para este proyecto"}},emits:["view","edit","delete","duplicate","add-entregable","view-entregables"],setup(a){const u=a,z=L(()=>u.maxHitos&&u.maxHitos>0?u.hitos.slice(0,u.maxHitos):u.hitos),b=L(()=>u.maxHitos&&u.hitos.length>u.maxHitos);return(E,g)=>(l(),f(e(C),null,{default:o(()=>[a.showHeader?(l(),f(e(T),{key:0,class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[r("div",null,[s(e(B),{class:"flex items-center gap-2"},{default:o(()=>[s(e(Z),{class:"h-5 w-5"}),g[0]||(g[0]=d(" Hitos y Entregables ",-1))]),_:1}),a.proyectoNombre?(l(),f(e(ne),{key:0},{default:o(()=>[d(c(a.proyectoNombre),1)]),_:1})):p("",!0)]),a.showActions?(l(),h("div",Ke,[a.showViewAll&&a.hitos.length>0?(l(),f(e(P),{key:0,href:`/admin/proyectos/${a.proyectoId}/hitos`},{default:o(()=>[s(e(D),{variant:"outline",size:"sm"},{default:o(()=>[s(e(Te),{class:"h-4 w-4 mr-2"}),g[1]||(g[1]=d(" Ver Todos ",-1))]),_:1})]),_:1},8,["href"])):p("",!0),a.canCreate?(l(),f(e(P),{key:1,href:`/admin/proyectos/${a.proyectoId}/hitos/create`},{default:o(()=>[s(e(D),{size:"sm"},{default:o(()=>[s(e(G),{class:"h-4 w-4 mr-2"}),g[2]||(g[2]=d(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])):p("",!0)]),_:1})):p("",!0),s(e(q),null,{default:o(()=>[a.showStats&&a.estadisticas&&a.estadisticas.total>0?(l(),h("div",Xe,[r("div",Qe,[r("div",We,[r("p",Ye,c(a.estadisticas.total),1),g[3]||(g[3]=r("p",{class:"text-xs text-muted-foreground"},"Total Hitos",-1))]),r("div",Ze,[r("p",et,c(a.estadisticas.en_progreso),1),g[4]||(g[4]=r("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),r("div",tt,[r("p",at,c(a.estadisticas.completados),1),g[5]||(g[5]=r("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),r("div",st,[r("p",{class:I(["text-2xl font-bold",{"text-red-500":a.estadisticas.vencidos>0}])},c(a.estadisticas.vencidos),3),g[6]||(g[6]=r("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))])]),r("div",ot,[r("div",rt,[g[7]||(g[7]=r("span",{class:"text-muted-foreground"},"Progreso General",-1)),r("span",lt,c(a.estadisticas.progreso_general)+"%",1)]),s(e(de),{value:a.estadisticas.progreso_general,class:"h-2"},null,8,["value"])])])):p("",!0),a.hitos.length>0?(l(),h("div",it,[r("div",nt,[(l(!0),h(A,null,F(z.value,k=>(l(),f(Be,{key:k.id,hito:k,canEdit:a.canEdit,canDelete:a.canDelete,canManageDeliverables:a.canManageDeliverables,showActions:!0,onView:S=>E.$emit("view",k),onEdit:S=>E.$emit("edit",k),onDelete:S=>E.$emit("delete",k),onDuplicate:S=>E.$emit("duplicate",k),onAddEntregable:S=>E.$emit("add-entregable",k),onViewEntregables:S=>E.$emit("view-entregables",k)},null,8,["hito","canEdit","canDelete","canManageDeliverables","onView","onEdit","onDelete","onDuplicate","onAddEntregable","onViewEntregables"]))),128))]),b.value?(l(),f(e(P),{key:0,href:`/admin/proyectos/${a.proyectoId}/hitos`,class:"block text-center mt-4 text-sm text-primary hover:underline"},{default:o(()=>[d(" Ver todos los hitos ("+c(a.hitos.length)+") ",1)]),_:1},8,["href"])):p("",!0)])):(l(),h("div",dt,[s(e(Z),{class:"h-10 w-10 mx-auto text-muted-foreground mb-3"}),r("p",ct,c(a.emptyMessage),1),a.canCreate?(l(),f(e(P),{key:0,href:`/admin/proyectos/${a.proyectoId}/hitos/create`},{default:o(()=>[s(e(D),{variant:"outline",size:"sm"},{default:o(()=>[s(e(G),{class:"h-4 w-4 mr-2"}),g[8]||(g[8]=d(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)]))]),_:1})]),_:1}))}}),mt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ft={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},yt={class:"text-2xl font-bold text-gray-900 dark:text-white"},gt={key:0,class:"mt-2 text-gray-600 dark:text-gray-400"},pt={class:"flex gap-2"},vt={class:"flex items-center justify-between"},xt={class:"flex items-center gap-3"},ht={class:"flex items-center gap-3"},bt={class:"space-y-2"},wt={class:"flex justify-between text-sm"},$t={class:"font-medium"},Et={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2"},_t={class:"flex items-start gap-3"},kt={class:"font-medium"},qt={class:"text-xs text-gray-500"},Ct={key:0,class:"flex items-start gap-3"},St={class:"font-medium"},Dt={class:"text-xs text-gray-500"},Ht={key:0,class:"flex items-center gap-3 pt-2"},Pt={class:"font-medium ml-2"},Vt={key:0},Tt={key:1,class:"text-sm text-muted-foreground"},Bt={key:1,class:"space-y-4"},jt={class:"flex gap-2"},Mt={class:"space-y-4"},zt={class:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},At={class:"text-gray-900 dark:text-gray-100"},Nt={key:0,class:"flex items-center gap-3"},It={class:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Ft={class:"font-medium"},Lt={class:"text-sm text-gray-500"},Ut={key:1,class:"text-gray-500"},Ot={class:"font-mono"},Rt={class:"font-medium"},Gt={class:"text-sm"},Jt={class:"text-sm"},Kt={class:"space-y-3"},Xt={class:"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Qt={class:"flex-1"},Wt={class:"text-sm"},Yt={class:"font-medium"},Zt={class:"text-xs text-gray-500 mt-1"},ea={key:0,class:"flex justify-end"},ta={class:"space-y-4"},aa={class:"text-center"},sa={key:1},oa={class:"flex items-center justify-between w-full pr-4"},ra={class:"flex items-center gap-3"},la={class:"text-left"},ia={class:"font-semibold"},na={class:"text-sm text-gray-500"},da={class:"flex items-center gap-3"},ca={class:"text-sm text-gray-600"},ua={class:"text-sm"},ma=["href"],fa={class:"text-center"},ya={class:"text-center"},to=ie({__name:"Show",props:{proyecto:{},categorias:{},totales:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageTags:{type:Boolean},canViewContracts:{type:Boolean},canCreateContracts:{type:Boolean},canViewHitos:{type:Boolean},canCreateHitos:{type:Boolean},canEditHitos:{type:Boolean},canDeleteHitos:{type:Boolean},canManageEntregables:{type:Boolean},estadisticasHitos:{}},setup(a){const u=a,z=N("general"),b=N({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null}),E=N(!1),g=N([]),{syncEtiquetasProyecto:k,isLoading:S}=Je();u.proyecto.etiquetas&&(g.value=u.proyecto.etiquetas.map(i=>i.id));const J=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:u.proyecto.nombre,href:`/admin/proyectos/${u.proyecto.id}`}],K=()=>{confirm(`¿Estás seguro de eliminar el proyecto "${u.proyecto.nombre}"?`)&&_.delete(`/admin/proyectos/${u.proyecto.id}`,{onSuccess:()=>{V.success("Proyecto eliminado exitosamente")},onError:()=>{V.error("Error al eliminar el proyecto")}})},X=i=>({planificacion:Z,en_progreso:Re,pausado:Ne,completado:Oe,cancelado:Ae})[i]||Ge,Q=i=>({planificacion:"bg-blue-100 text-blue-800",en_progreso:"bg-yellow-100 text-yellow-800",pausado:"bg-orange-100 text-orange-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[i]||"bg-gray-100 text-gray-800",x=i=>({baja:"bg-gray-100 text-gray-800",media:"bg-blue-100 text-blue-800",alta:"bg-orange-100 text-orange-800",critica:"bg-red-100 text-red-800"})[i]||"bg-gray-100 text-gray-800",m=i=>new Date(i).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),v=i=>{const t=Math.floor((new Date(i).getTime()-new Date().getTime())/864e5);return t===0?"Hoy":t===1?"Mañana":t===-1?"Ayer":t>0?`En ${t} días`:`Hace ${Math.abs(t)} días`},w=async()=>{try{await k(u.proyecto.id,g.value),E.value=!1,V.success("Etiquetas actualizadas exitosamente"),_.reload({only:["proyecto"]})}catch{V.error("Error al actualizar las etiquetas")}},$=()=>{var i;g.value=((i=u.proyecto.etiquetas)==null?void 0:i.map(t=>t.id))||[],E.value=!1},ce=i=>{_.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${i.id}`)},ue=i=>{_.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${i.id}/edit`)},me=i=>{confirm(`¿Estás seguro de eliminar el hito "${i.nombre}"? Se eliminarán también todos sus entregables.`)&&_.delete(`/admin/proyectos/${u.proyecto.id}/hitos/${i.id}`,{onSuccess:()=>{V.success("Hito eliminado exitosamente"),_.reload({only:["proyecto"]})},onError:()=>{V.error("Error al eliminar el hito")}})},fe=i=>{_.post(`/admin/proyectos/${u.proyecto.id}/hitos/${i.id}/duplicar`,{},{onSuccess:()=>{V.success("Hito duplicado exitosamente"),_.reload({only:["proyecto"]})},onError:()=>{V.error("Error al duplicar el hito")}})},ye=i=>{_.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${i.id}/entregables/create`)},ge=i=>{_.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${i.id}/entregables`)},U=L(()=>{const i=[];return u.proyecto.contratos&&u.proyecto.contratos.forEach(t=>{t.obligaciones&&t.obligaciones.forEach(n=>{n.evidencias&&n.evidencias.forEach(y=>{i.push({...y,contrato_id:t.id,contrato_numero:t.numero_contrato,contrato_nombre:t.nombre,obligacion_titulo:n.titulo,_contrato:t})})})}),i}),pe=L(()=>{let i=U.value;return b.value.contrato_id&&(i=i.filter(t=>t.contrato_id===b.value.contrato_id)),b.value.tipo&&(i=i.filter(t=>t.tipo_evidencia===b.value.tipo)),b.value.estado&&(i=i.filter(t=>t.estado===b.value.estado)),b.value.usuario_id&&(i=i.filter(t=>{var n;return((n=t.usuario)==null?void 0:n.id)===b.value.usuario_id})),(b.value.fecha_inicio||b.value.fecha_fin)&&(i=i.filter(t=>{const n=new Date(t.created_at);if(b.value.fecha_inicio){const y=new Date(b.value.fecha_inicio);if(n<y)return!1}if(b.value.fecha_fin){const y=new Date(b.value.fecha_fin);if(y.setHours(23,59,59,999),n>y)return!1}return!0})),i}),ee=L(()=>{const i={};return pe.value.forEach(t=>{i[t.contrato_id]||(i[t.contrato_id]={contrato:t._contrato,evidencias:[]}),i[t.contrato_id].evidencias.push(t)}),Object.values(i)});return(i,t)=>(l(),h(A,null,[s(e(ve),{title:`Proyecto: ${a.proyecto.nombre}`},null,8,["title"]),s(he,{breadcrumbs:J},{default:o(()=>[r("div",mt,[r("div",ft,[r("div",null,[r("h1",yt,c(a.proyecto.nombre),1),a.proyecto.descripcion?(l(),h("p",gt,c(a.proyecto.descripcion),1)):p("",!0)]),r("div",pt,[a.canEdit?(l(),f(e(P),{key:0,href:`/admin/proyectos/${a.proyecto.id}/edit`},{default:o(()=>[s(e(D),null,{default:o(()=>[s(e(oe),{class:"mr-2 h-4 w-4"}),t[6]||(t[6]=d(" Editar ",-1))]),_:1})]),_:1},8,["href"])):p("",!0),a.canDelete?(l(),f(e(D),{key:1,variant:"destructive",onClick:K},{default:o(()=>[s(e(je),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=d(" Eliminar ",-1))]),_:1})):p("",!0)])]),s(e(be),{modelValue:z.value,"onUpdate:modelValue":t[5]||(t[5]=n=>z.value=n),class:"w-full"},{default:o(()=>[s(e(we),{class:"grid w-full grid-cols-4"},{default:o(()=>[s(e(O),{value:"general"},{default:o(()=>[s(e(Me),{class:"mr-2 h-4 w-4"}),t[8]||(t[8]=d(" General ",-1))]),_:1}),s(e(O),{value:"contratos"},{default:o(()=>{var n;return[s(e(W),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=d(" Contratos ",-1)),(n=a.totales)!=null&&n.contratos?(l(),f(e(H),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:o(()=>[d(c(a.totales.contratos),1)]),_:1})):p("",!0)]}),_:1}),s(e(O),{value:"hitos"},{default:o(()=>{var n;return[s(e(ze),{class:"mr-2 h-4 w-4"}),t[10]||(t[10]=d(" Hitos y Entregables ",-1)),(n=a.totales)!=null&&n.hitos?(l(),f(e(H),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:o(()=>[d(c(a.totales.hitos),1)]),_:1})):p("",!0)]}),_:1}),s(e(O),{value:"evidencias"},{default:o(()=>{var n;return[s(e(Y),{class:"mr-2 h-4 w-4"}),t[11]||(t[11]=d(" Evidencias ",-1)),(n=a.totales)!=null&&n.evidencias?(l(),f(e(H),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:o(()=>[d(c(a.totales.evidencias),1)]),_:1})):p("",!0)]}),_:1})]),_:1}),s(e(R),{value:"general",class:"space-y-4 mt-6"},{default:o(()=>[s(e(C),null,{default:o(()=>[s(e(T),null,{default:o(()=>[s(e(B),null,{default:o(()=>[...t[12]||(t[12]=[d("Estado del Proyecto",-1)])]),_:1})]),_:1}),s(e(q),{class:"space-y-4"},{default:o(()=>[r("div",vt,[r("div",xt,[(l(),f(xe(X(a.proyecto.estado)),{class:"h-5 w-5 text-gray-500"})),t[13]||(t[13]=r("span",{class:"font-medium"},"Estado:",-1)),s(e(H),{class:I(Q(a.proyecto.estado))},{default:o(()=>[d(c(a.proyecto.estado_label),1)]),_:1},8,["class"])]),r("div",ht,[s(e(Ie),{class:"h-5 w-5 text-gray-500"}),t[14]||(t[14]=r("span",{class:"font-medium"},"Prioridad:",-1)),s(e(H),{class:I(x(a.proyecto.prioridad))},{default:o(()=>[d(c(a.proyecto.prioridad_label),1)]),_:1},8,["class"])])]),r("div",bt,[r("div",wt,[t[15]||(t[15]=r("span",{class:"text-gray-600 dark:text-gray-400"},"Progreso",-1)),r("span",$t,c(a.proyecto.porcentaje_completado)+"%",1)]),s(e(de),{value:a.proyecto.porcentaje_completado,class:"h-2"},null,8,["value"])]),r("div",Et,[r("div",_t,[s(e(re),{class:"h-5 w-5 text-gray-500 mt-0.5"}),r("div",null,[t[16]||(t[16]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de inicio",-1)),r("p",kt,c(m(a.proyecto.fecha_inicio)),1),r("p",qt,c(v(a.proyecto.fecha_inicio)),1)])]),a.proyecto.fecha_fin?(l(),h("div",Ct,[s(e(re),{class:"h-5 w-5 text-gray-500 mt-0.5"}),r("div",null,[t[17]||(t[17]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de fin",-1)),r("p",St,c(m(a.proyecto.fecha_fin)),1),r("p",Dt,c(v(a.proyecto.fecha_fin)),1)])])):p("",!0)]),a.proyecto.duracion_dias?(l(),h("div",Ht,[s(e(Fe),{class:"h-5 w-5 text-gray-500"}),r("div",null,[t[18]||(t[18]=r("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Duración total:",-1)),r("span",Pt,c(a.proyecto.duracion_dias)+" días",1)])])):p("",!0)]),_:1})]),_:1}),s(e(C),null,{default:o(()=>[s(e(T),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[s(e(B),null,{default:o(()=>[...t[19]||(t[19]=[d(" Etiquetas ",-1)])]),_:1}),a.canManageTags&&!E.value?(l(),f(e(D),{key:0,variant:"ghost",size:"sm",onClick:t[0]||(t[0]=n=>E.value=!0)},{default:o(()=>[s(e(oe),{class:"h-4 w-4"})]),_:1})):p("",!0)]),_:1}),s(e(q),null,{default:o(()=>[E.value?(l(),h("div",Bt,[a.categorias?(l(),f(qe,{key:0,modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=n=>g.value=n),categorias:a.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas...",description:"Selecciona hasta 10 etiquetas para este proyecto"},null,8,["modelValue","categorias"])):p("",!0),r("div",jt,[s(e(D),{size:"sm",onClick:w,disabled:e(S)},{default:o(()=>[...t[20]||(t[20]=[d(" Guardar ",-1)])]),_:1},8,["disabled"]),s(e(D),{size:"sm",variant:"outline",onClick:$,disabled:e(S)},{default:o(()=>[...t[21]||(t[21]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"])])])):(l(),h("div",Vt,[a.proyecto.etiquetas&&a.proyecto.etiquetas.length>0?(l(),f(ke,{key:0,etiquetas:a.proyecto.etiquetas,"show-categoria":!0,interactive:!0,size:"md"},null,8,["etiquetas"])):(l(),h("p",Tt," No hay etiquetas asignadas "))]))]),_:1})]),_:1}),a.proyecto.campos_personalizados&&a.proyecto.campos_personalizados.length>0?(l(),f(e(C),{key:0},{default:o(()=>[s(e(T),null,{default:o(()=>[s(e(B),null,{default:o(()=>[...t[22]||(t[22]=[d("Campos Personalizados",-1)])]),_:1})]),_:1}),s(e(q),null,{default:o(()=>[r("div",Mt,[(l(!0),h(A,null,F(a.proyecto.campos_personalizados,n=>{var y;return l(),h("div",{key:n.id,class:"py-2 border-b last:border-b-0"},[r("p",zt,c((y=n.campo_personalizado)==null?void 0:y.nombre),1),r("p",At,c(n.valor_formateado||n.valor||"-"),1)])}),128))])]),_:1})]),_:1})):p("",!0),s(e(C),null,{default:o(()=>[s(e(T),null,{default:o(()=>[s(e(B),null,{default:o(()=>[...t[23]||(t[23]=[d("Responsable",-1)])]),_:1})]),_:1}),s(e(q),null,{default:o(()=>[a.proyecto.responsable?(l(),h("div",Nt,[r("div",It,[s(e(le),{class:"h-5 w-5 text-gray-500"})]),r("div",null,[r("p",Ft,c(a.proyecto.responsable.name),1),r("p",Lt,c(a.proyecto.responsable.email),1)])])):(l(),h("p",Ut,"Sin asignar"))]),_:1})]),_:1}),s(e(C),null,{default:o(()=>[s(e(T),null,{default:o(()=>[s(e(B),null,{default:o(()=>[...t[24]||(t[24]=[d("Información del Sistema",-1)])]),_:1})]),_:1}),s(e(q),{class:"space-y-3"},{default:o(()=>{var n;return[r("div",null,[t[25]||(t[25]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"ID del Proyecto",-1)),r("p",Ot,"#"+c(a.proyecto.id),1)]),r("div",null,[t[26]||(t[26]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado",-1)),s(e(H),{class:I(a.proyecto.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},{default:o(()=>[d(c(a.proyecto.activo?"Activo":"Inactivo"),1)]),_:1},8,["class"])]),r("div",null,[t[27]||(t[27]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Creado por",-1)),r("p",Rt,c(((n=a.proyecto.creador)==null?void 0:n.name)||"Sistema"),1)]),r("div",null,[t[28]||(t[28]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de creación",-1)),r("p",Gt,c(m(a.proyecto.created_at)),1)]),r("div",null,[t[29]||(t[29]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Última actualización",-1)),r("p",Jt,c(m(a.proyecto.updated_at)),1)])]}),_:1})]),_:1}),a.proyecto.activities&&a.proyecto.activities.length>0?(l(),f(e(C),{key:1},{default:o(()=>[s(e(T),null,{default:o(()=>[s(e(B),null,{default:o(()=>[...t[30]||(t[30]=[d("Actividad Reciente",-1)])]),_:1})]),_:1}),s(e(q),null,{default:o(()=>[r("div",Kt,[(l(!0),h(A,null,F(a.proyecto.activities,n=>{var y;return l(),h("div",{key:n.id,class:"flex items-start gap-3 pb-3 border-b last:border-b-0"},[r("div",Xt,[s(e(le),{class:"h-4 w-4 text-gray-500"})]),r("div",Qt,[r("p",Wt,[r("span",Yt,c(((y=n.causer)==null?void 0:y.name)||"Sistema"),1),d(" "+c(n.description),1)]),r("p",Zt,c(v(n.created_at)),1)])])}),128))])]),_:1})]),_:1})):p("",!0)]),_:1}),s(e(R),{value:"contratos",class:"space-y-4 mt-6"},{default:o(()=>[a.canCreateContracts?(l(),h("div",ea,[s(e(P),{href:`/admin/contratos/create?proyecto_id=${a.proyecto.id}`},{default:o(()=>[s(e(D),null,{default:o(()=>[s(e(G),{class:"mr-2 h-4 w-4"}),t[31]||(t[31]=d(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])])):p("",!0),a.proyecto.contratos&&a.proyecto.contratos.length>0?(l(),f(e(C),{key:1},{default:o(()=>[s(e(T),null,{default:o(()=>[s(e(B),null,{default:o(()=>[...t[32]||(t[32]=[d("Contratos del Proyecto",-1)])]),_:1}),s(e(ne),null,{default:o(()=>[...t[33]||(t[33]=[d(" Lista de contratos asociados a este proyecto ",-1)])]),_:1})]),_:1}),s(e(q),null,{default:o(()=>[r("div",ta,[s(Ce,{contratos:a.proyecto.contratos,"show-proyecto":!1,"show-actions":!0,"actions-style":"buttons"},null,8,["contratos"])])]),_:1})]),_:1})):(l(),f(e(C),{key:2},{default:o(()=>[s(e(q),{class:"py-8"},{default:o(()=>[r("div",aa,[s(e(W),{class:"mx-auto h-12 w-12 text-gray-400"}),t[35]||(t[35]=r("p",{class:"mt-2 text-sm text-gray-600"},"No hay contratos asociados",-1)),a.canCreateContracts?(l(),f(e(P),{key:0,href:`/admin/contratos/create?proyecto_id=${a.proyecto.id}`,class:"mt-4 inline-block"},{default:o(()=>[s(e(D),{variant:"outline"},{default:o(()=>[s(e(G),{class:"mr-2 h-4 w-4"}),t[34]||(t[34]=d(" Crear primer contrato ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])]),_:1})]),_:1}))]),_:1}),s(e(R),{value:"hitos",class:"space-y-4 mt-6"},{default:o(()=>[a.canViewHitos?(l(),f(ut,{key:0,hitos:a.proyecto.hitos||[],"proyecto-id":a.proyecto.id,estadisticas:a.estadisticasHitos,"show-stats":!0,"show-header":!0,"show-actions":!0,"show-view-all":!0,"can-create":a.canCreateHitos,"can-edit":a.canEditHitos,"can-delete":a.canDeleteHitos,"can-manage-deliverables":a.canManageEntregables,"empty-message":"No hay hitos definidos para este proyecto",onView:ce,onEdit:ue,onDelete:me,onDuplicate:fe,onAddEntregable:ye,onViewEntregables:ge},null,8,["hitos","proyecto-id","estadisticas","can-create","can-edit","can-delete","can-manage-deliverables"])):p("",!0)]),_:1}),s(e(R),{value:"evidencias",class:"space-y-4 mt-6"},{default:o(()=>[U.value.length>0?(l(),f(Se,{key:0,modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=n=>b.value=n),contratos:a.proyecto.contratos||[],evidencias:U.value},null,8,["modelValue","contratos","evidencias"])):p("",!0),ee.value.length>0?(l(),h("div",sa,[s(e(De),{type:"multiple",class:"space-y-4",collapsible:""},{default:o(()=>[(l(!0),h(A,null,F(ee.value,n=>(l(),f(e(He),{key:n.contrato.id,value:`contrato-${n.contrato.id}`,class:"border rounded-lg bg-card"},{default:o(()=>[s(e(Pe),{class:"px-4 py-3 hover:no-underline hover:bg-gray-50 dark:hover:bg-gray-800 rounded-t-lg"},{default:o(()=>[r("div",oa,[r("div",ra,[s(e(W),{class:"h-5 w-5 text-gray-500"}),r("div",la,[r("div",ia,c(n.contrato.nombre),1),r("div",na,c(n.contrato.numero_contrato||"Sin número"),1)])]),r("div",da,[s(e(H),{variant:"secondary"},{default:o(()=>[d(c(n.evidencias.length)+" evidencia(s) ",1)]),_:2},1024),s(e(P),{href:`/admin/contratos/${n.contrato.id}`,onClick:t[3]||(t[3]=ae(()=>{},["stop"])),class:"text-blue-600 hover:text-blue-800 flex items-center gap-1"},{default:o(()=>[t[36]||(t[36]=d(" Ver contrato ",-1)),s(e(Le),{class:"h-3 w-3"})]),_:1},8,["href"])])])]),_:2},1024),s(e(Ve),{class:"px-4 pb-4"},{default:o(()=>[s(e($e),null,{default:o(()=>[s(e(Ee),null,{default:o(()=>[s(e(se),null,{default:o(()=>[s(e(j),null,{default:o(()=>[...t[37]||(t[37]=[d("Tipo",-1)])]),_:1}),s(e(j),null,{default:o(()=>[...t[38]||(t[38]=[d("Obligación",-1)])]),_:1}),s(e(j),null,{default:o(()=>[...t[39]||(t[39]=[d("Descripción",-1)])]),_:1}),s(e(j),null,{default:o(()=>[...t[40]||(t[40]=[d("Usuario",-1)])]),_:1}),s(e(j),null,{default:o(()=>[...t[41]||(t[41]=[d("Estado",-1)])]),_:1}),s(e(j),null,{default:o(()=>[...t[42]||(t[42]=[d("Fecha",-1)])]),_:1}),s(e(j),{class:"text-right"},{default:o(()=>[...t[43]||(t[43]=[d("Acciones",-1)])]),_:1})]),_:1})]),_:1}),s(e(_e),null,{default:o(()=>[(l(!0),h(A,null,F(n.evidencias,y=>(l(),f(e(se),{key:y.id,class:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800"},{default:o(()=>[s(e(P),{href:`/admin/contratos/${y.contrato_id}/evidencias/${y.id}`,class:"contents"},{default:o(()=>[s(e(M),null,{default:o(()=>[s(e(H),{variant:"outline"},{default:o(()=>[d(c(y.tipo_evidencia),1)]),_:2},1024)]),_:2},1024),s(e(M),null,{default:o(()=>[d(c(y.obligacion_titulo),1)]),_:2},1024),s(e(M),null,{default:o(()=>[r("span",ca,c(y.descripcion||"-"),1)]),_:2},1024),s(e(M),null,{default:o(()=>{var te;return[r("span",ua,c(((te=y.usuario)==null?void 0:te.name)||"-"),1)]}),_:2},1024),s(e(M),null,{default:o(()=>[s(e(H),{class:I({"bg-yellow-100 text-yellow-800":y.estado==="pendiente","bg-green-100 text-green-800":y.estado==="aprobada","bg-red-100 text-red-800":y.estado==="rechazada"})},{default:o(()=>[d(c(y.estado),1)]),_:2},1032,["class"])]),_:2},1024),s(e(M),null,{default:o(()=>[d(c(m(y.created_at)),1)]),_:2},1024),s(e(M),{class:"text-right"},{default:o(()=>[y.archivo_url?(l(),h("a",{key:0,href:y.archivo_url,target:"_blank",class:"inline-flex items-center text-blue-600 hover:text-blue-800",onClick:t[4]||(t[4]=ae(()=>{},["stop"]))},[s(e(Ue),{class:"h-4 w-4"})],8,ma)):p("",!0)]),_:2},1024)]),_:2},1032,["href"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})])):U.value.length===0?(l(),f(e(C),{key:2},{default:o(()=>[s(e(q),{class:"py-8"},{default:o(()=>[r("div",fa,[s(e(Y),{class:"mx-auto h-12 w-12 text-gray-400"}),t[44]||(t[44]=r("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias cargadas",-1)),t[45]||(t[45]=r("p",{class:"text-xs text-gray-500 mt-1"},"Las evidencias se cargan desde los contratos",-1))])]),_:1})]),_:1})):(l(),f(e(C),{key:3},{default:o(()=>[s(e(q),{class:"py-8"},{default:o(()=>[r("div",ya,[s(e(Y),{class:"mx-auto h-12 w-12 text-gray-400"}),t[46]||(t[46]=r("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias que coincidan con los filtros",-1)),t[47]||(t[47]=r("p",{class:"text-xs text-gray-500 mt-1"},"Intenta ajustar los criterios de búsqueda",-1))])]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"])])]),_:1})],64))}});export{to as default};
