import{d as Ue,u as je,r as _,c as V,p as K,o as Ie,B as Ne,I as Re,b as h,w as s,e as a,g as i,f as t,q as Te,h as d,t as p,i as u,j as y,m as l,l as Oe,F as I,k as N,x as ze,a5 as ce,s as Q}from"./app-b8_bfoa9.js";import{_ as Ge}from"./UserLayout.vue_vue_type_script_setup_true_lang-BCziLpib.js";import{_ as R,a as T,b as O,c as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-ChEDhgpu.js";import{_ as Y}from"./CardDescription.vue_vue_type_script_setup_true_lang-DtsxPWIA.js";import{_ as f}from"./createLucideIcon-jMLPrHZq.js";import{_ as G}from"./Label.vue_vue_type_script_setup_true_lang-DReL3nOQ.js";import{_ as Le}from"./Textarea.vue_vue_type_script_setup_true_lang-BsHInGhh.js";import{_ as ue,a as ve,b as me,c as pe,d as fe}from"./SelectValue.vue_vue_type_script_setup_true_lang-D7ECgYt-.js";import{_ as qe}from"./Checkbox.vue_vue_type_script_setup_true_lang--RqN3OLk.js";import{_ as Pe}from"./FileUploadField.vue_vue_type_script_setup_true_lang-BfPe5MJ3.js";import{u as We}from"./useAutoSave-BOjPwtjD.js";import{u as He}from"./useFileUpload-C708CmA1.js";import{t as g}from"./index-D0lNZ1Y3.js";import{F as Z}from"./file-text-DR9j7dm-.js";import{M as _e}from"./music-DWVL0_0w.js";import{V as L}from"./video-BPXbERXo.js";import{I as Xe}from"./image-CXSfaGjI.js";import{A as Je}from"./arrow-left-NLFSzuUf.js";import{C as he}from"./clock-D-_0P1Dt.js";import{C as ge}from"./circle-check-big-C36JSWNF.js";import{C as Ke}from"./circle-alert-BTKmsP7n.js";import{X as be}from"./x-DygrjMee.js";import{C as xe}from"./camera-DYHmtjp-.js";import{M as ee}from"./mic-BGQdbXts.js";import{S as Qe}from"./save-EDqEoPbB.js";import{U as Ye}from"./upload-DWQiMB5j.js";import"./useFlashMessages-Co-C9Fxp.js";import"./index-BShGxGH8.js";import"./floating-ui.vue-DHf3hBf9.js";import"./Input.vue_vue_type_script_setup_true_lang-D7NW1pkf.js";import"./index-BdKmsfpb.js";import"./index-BX9ZO_bI.js";import"./shield-DhmbrWHL.js";import"./user-DNFTuXTN.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-PTnNV47i.js";import"./chevron-right-0CYeO5om.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-U4pP91Co.js";import"./VisuallyHidden-7ZQM_wZx.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Bg5KjcOV.js";import"./map-pin-DEhkaLO3.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BGH4Gs5x.js";import"./usePermissions-CyjG5SHA.js";import"./square-check-big-B71pyzDm.js";import"./users-Bi6hX7US.js";import"./folder-open-BYsbd4v9.js";import"./index-CcfiZCze.js";import"./check-C8Dm3S8L.js";import"./file-C_ghyOle.js";import"./eye-Dc5wk_Ma.js";import"./download-C4_wDjhP.js";import"./debounce-OIu2wLsu.js";const Ze={class:"space-y-6"},et={class:"flex justify-between items-start"},tt={class:"text-muted-foreground"},ot={class:"flex items-center gap-2"},at={key:0,class:"flex items-center text-sm text-muted-foreground"},it={key:1,class:"flex items-center text-sm text-green-600"},st={key:2,class:"flex items-center text-sm text-red-600"},rt={class:"grid gap-6 lg:grid-cols-3"},nt={class:"lg:col-span-2 space-y-6"},lt={class:"space-y-4"},dt={key:0,class:"p-3 bg-muted/30 rounded-lg"},ct={class:"text-sm text-muted-foreground"},ut={key:0,class:"space-y-4"},vt={class:"relative bg-muted/30 rounded-lg p-4"},mt={key:0,class:"text-center"},pt=["src"],ft={key:1,class:"text-center"},_t=["src"],ht={key:2,class:"flex flex-col items-center gap-4"},gt=["src"],bt={key:3,class:"flex items-center justify-center gap-4 py-8"},xt={class:"text-center"},yt={class:"font-medium"},kt={class:"text-sm text-muted-foreground text-center"},wt={key:1,class:"space-y-4"},Ct={class:"grid grid-cols-3 gap-3"},$t={class:"space-y-6"},Et={class:"space-y-3"},St={key:0,class:"text-sm text-muted-foreground"},Vt={key:1},At={class:"flex-1"},Bt={class:"text-xs text-muted-foreground"},Ft={class:"text-sm"},Dt={class:"text-sm"},Mt={class:"text-sm"},Ut={key:0},jt={class:"text-sm font-medium text-muted-foreground"},It={class:"space-y-1"},Nt={key:0,class:"fixed bottom-0 left-0 right-0 bg-background border-t border-border shadow-lg z-50"},Rt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Tt={class:"flex items-center justify-between py-4"},Ot={class:"flex items-center gap-4"},zt={key:0,class:"flex items-center text-sm text-muted-foreground"},Gt={key:1,class:"flex items-center text-sm text-green-600"},Lt={class:"flex items-center gap-3"},qt={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50"},Pt={class:"bg-background rounded-lg p-6 max-w-2xl w-full mx-4"},Wt={class:"flex items-center justify-between mb-4"},Ht={class:"text-lg font-semibold"},Xt={class:"space-y-4"},Jt={key:0,class:"relative"},Kt={key:1,class:"flex items-center justify-center gap-2 text-red-600"},Qt={class:"font-mono"},Yt={class:"flex justify-center gap-3"},Qo=Ue({__name:"Edit",props:{contrato:{},evidencia:{},obligaciones:{},entregables:{},tiposEvidencia:{}},setup(k){var de;const c=k,ye=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Contratos",href:"/miembro/mis-contratos"},{title:c.contrato.nombre,href:`/miembro/mis-contratos/${c.contrato.id}`},{title:"Evidencias",href:`/miembro/mis-contratos/${c.contrato.id}/evidencias`},{title:"Editar Evidencia",href:"#"}],{uploadFiles:ke}=He(),o=je({obligacion_id:c.evidencia.obligacion_id,tipo_evidencia:c.evidencia.tipo_evidencia,archivo_path:c.evidencia.archivo_path,archivo_nombre:c.evidencia.archivo_nombre,archivos_paths:c.evidencia.archivos_paths||(c.evidencia.archivo_path?[c.evidencia.archivo_path]:[]),archivos_nombres:c.evidencia.archivos_nombres||(c.evidencia.archivo_nombre?[c.evidencia.archivo_nombre]:[]),descripcion:c.evidencia.descripcion||"",entregable_ids:((de=c.evidencia.entregables)==null?void 0:de.map(r=>r.id))||[],metadata:c.evidencia.metadata||null}),$=_(c.evidencia.archivos_paths||(c.evidencia.archivo_path?[c.evidencia.archivo_path]:[])),te=_(!1),w=_("idle"),F=_(!1),D=_(null),E=_(null),q=_(!1),v=_("photo");let C=null,S=null;const P=_([]),b=_(!1),M=_(0);let U=null;const W=V(()=>c.obligaciones.find(r=>r.id===o.obligacion_id)),oe=V(()=>c.entregables.filter(r=>r.estado!=="completado")),H=V(()=>c.entregables.filter(r=>o.entregable_ids.includes(r.id))),ae=V(()=>o.obligacion_id&&o.tipo_evidencia&&!o.processing),we=V(()=>({imagen:Xe,video:L,audio:_e,documento:Z})[o.tipo_evidencia||"documento"]||Z),j=V(()=>E.value?URL.createObjectURL(E.value):c.evidencia.archivo_url),Ce=V(()=>o.data()),{startAutoSave:$e,stopAutoSave:ie}=We(Ce,r=>Q.post(route("user.mis-contratos.evidencias.autosave",c.contrato.id),r,{preserveScroll:!0,preserveState:!0,only:[]}));K(()=>o.data(),()=>{F.value=o.isDirty},{deep:!0}),K(()=>o.tipo_evidencia,(r,e)=>{if(e&&r&&r!==e){if((o.archivos_paths.length>0||o.archivo_path||D.value||E.value||$.value.length>0)&&!confirm(`¿Estás seguro de cambiar el tipo de evidencia? Se perderán los archivos seleccionados para "${e}".`)){o.tipo_evidencia=e;return}o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,D.value=null,E.value=null,$.value=[],g.info(`Tipo de evidencia cambiado a "${r}". Archivos limpiados.`)}});const Ee=()=>{te.value=F.value||o.processing},Se=async r=>{if(r.length>0){const e=o.archivos_paths.length,x=r.length;if(e+x>10){g.error(`No puedes subir más de 10 archivos. Actualmente tienes ${e} archivo(s).`);return}if(!o.tipo_evidencia){const n=r[0];n.type.startsWith("image/")?o.tipo_evidencia="imagen":n.type.startsWith("video/")?o.tipo_evidencia="video":n.type.startsWith("audio/")?o.tipo_evidencia="audio":o.tipo_evidencia="documento"}try{g.info(`Subiendo ${r.length} archivo(s)...`);const n=await ke(r,{module:"evidencias",fieldId:o.tipo_evidencia||"archivo",onProgress:(m,A)=>{}});if(n.length>0){const m=[...o.archivos_paths,...n.map(J=>J.path)],A=[...o.archivos_nombres,...n.map(J=>J.name)];o.archivos_paths=m,o.archivos_nombres=A,!o.archivo_path&&m.length>0&&(o.archivo_path=m[0],o.archivo_nombre=A[0],o.metadata=n[0].metadata),$.value=m,g.success(`${n.length} archivo(s) subido(s) exitosamente. Total: ${m.length}/10`)}}catch(n){console.error("Error al subir archivos:",n),g.error("Error al subir archivos")}}else D.value=null,o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,$.value=[]},Ve=()=>{D.value=null,E.value=null,o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,$.value=[]},X=r=>{v.value=r,q.value=!0,Ae()},Ae=async()=>{try{const r={video:v.value==="photo"||v.value==="video",audio:v.value==="video"||v.value==="audio"};if(S=await navigator.mediaDevices.getUserMedia(r),v.value==="photo"||v.value==="video"){const e=document.getElementById("captureVideo");e&&(e.srcObject=S)}}catch(r){console.error("Error accessing media devices:",r),g.error("No se pudo acceder a la cámara/micrófono"),B()}},Be=()=>{const r=document.getElementById("captureVideo"),e=document.createElement("canvas");e.width=r.videoWidth,e.height=r.videoHeight;const x=e.getContext("2d");x&&(x.drawImage(r,0,0),e.toBlob(n=>{n&&(E.value=n,o.archivo_nombre=`foto_${Date.now()}.jpg`,o.tipo_evidencia="imagen",B())},"image/jpeg",.8))},se=()=>{S&&(P.value=[],C=new MediaRecorder(S),C.ondataavailable=r=>{r.data.size>0&&P.value.push(r.data)},C.onstop=()=>{const r=new Blob(P.value,{type:v.value==="video"?"video/webm":"audio/webm"});E.value=r;const e=(v.value==="video","webm");o.archivo_nombre=`${v.value}_${Date.now()}.${e}`,o.tipo_evidencia=v.value,ne(),B()},C.start(),b.value=!0,Fe())},re=()=>{C&&b.value&&(C.stop(),b.value=!1)},Fe=()=>{M.value=0,U=setInterval(()=>{M.value+=1},1e3)},ne=()=>{U&&(clearInterval(U),U=null),M.value=0},B=()=>{q.value=!1,S&&(S.getTracks().forEach(r=>r.stop()),S=null),C&&(C=null),ne(),b.value=!1},De=r=>{const e=Math.floor(r/60),x=r%60;return`${e.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`},le=async()=>{if(ae.value){if(o.archivos_paths.length===0&&!o.archivo_path){g.error("Por favor seleccione o capture al menos un archivo");return}o.put(route("user.mis-contratos.evidencias.update",[c.contrato.id,c.evidencia.id]),{onSuccess:()=>{g.success(`Evidencia actualizada exitosamente con ${o.archivos_paths.length} archivo(s)`),F.value=!1,ie()},onError:r=>{console.error("Errores:",r),g.error("Error al actualizar la evidencia")}})}},Me=()=>{Q.post(route("user.mis-contratos.evidencias.autosave",c.contrato.id),o.data(),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g.success("Borrador guardado"),w.value="saved",setTimeout(()=>{w.value="idle"},2e3)},onError:()=>{g.error("Error al guardar borrador"),w.value="error"}})};return Ie(()=>{K(()=>F.value,Ee,{immediate:!0}),$e()}),Ne(()=>{ie(),B()}),(r,e)=>{const x=Re("Link");return l(),h(Ge,{breadcrumbs:ye},{default:s(()=>[a(t(Te),{title:"Editar Evidencia"}),i("div",Ze,[i("div",et,[i("div",null,[a(x,{href:r.route("user.mis-contratos.evidencias.show",[k.contrato.id,k.evidencia.id]),class:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-2"},{default:s(()=>[a(t(Je),{class:"w-4 h-4 mr-2"}),e[8]||(e[8]=d(" Volver a Ver Evidencia ",-1))]),_:1},8,["href"]),e[10]||(e[10]=i("h2",{class:"text-3xl font-bold tracking-tight"},"Editar Evidencia",-1)),i("p",tt,[e[9]||(e[9]=d(" Modificar evidencia para: ",-1)),i("strong",null,p(k.contrato.nombre),1)])]),i("div",ot,[w.value==="saving"?(l(),u("div",at,[a(t(he),{class:"w-4 h-4 mr-1 animate-spin"}),e[11]||(e[11]=d(" Guardando... ",-1))])):w.value==="saved"?(l(),u("div",it,[a(t(ge),{class:"w-4 h-4 mr-1"}),e[12]||(e[12]=d(" Guardado ",-1))])):w.value==="error"?(l(),u("div",st,[a(t(Ke),{class:"w-4 h-4 mr-1"}),e[13]||(e[13]=d(" Error al guardar ",-1))])):y("",!0)])]),i("form",{onSubmit:Oe(le,["prevent"]),class:"space-y-6"},[i("div",rt,[i("div",nt,[a(t(R),null,{default:s(()=>[a(t(T),null,{default:s(()=>[a(t(O),null,{default:s(()=>[...e[14]||(e[14]=[d("Obligación Contractual",-1)])]),_:1}),a(t(Y),null,{default:s(()=>[...e[15]||(e[15]=[d(" Selecciona la obligación a la que corresponde esta evidencia ",-1)])]),_:1})]),_:1}),a(t(z),null,{default:s(()=>{var n;return[i("div",lt,[i("div",null,[a(t(G),{for:"obligacion_id"},{default:s(()=>[...e[16]||(e[16]=[d("Obligación *",-1)])]),_:1}),a(t(ue),{modelValue:t(o).obligacion_id,"onUpdate:modelValue":e[0]||(e[0]=m=>t(o).obligacion_id=m),required:""},{default:s(()=>[a(t(ve),null,{default:s(()=>[a(t(me),{placeholder:"Seleccionar obligación..."})]),_:1}),a(t(pe),null,{default:s(()=>[(l(!0),u(I,null,N(k.obligaciones,m=>(l(),h(t(fe),{key:m.id,value:m.id},{default:s(()=>[d(p(m.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),(n=W.value)!=null&&n.descripcion?(l(),u("div",dt,[i("p",ct,p(W.value.descripcion),1)])):y("",!0)])]}),_:1})]),_:1}),a(t(R),null,{default:s(()=>[a(t(T),null,{default:s(()=>[a(t(O),{class:"flex items-center gap-2"},{default:s(()=>[(l(),h(ze(we.value),{class:"w-5 h-5"})),e[17]||(e[17]=d(" Archivo de Evidencia ",-1))]),_:1}),a(t(Y),null,{default:s(()=>[...e[18]||(e[18]=[d(" Sube un archivo o captura directamente desde tu dispositivo ",-1)])]),_:1})]),_:1}),a(t(z),{class:"space-y-6"},{default:s(()=>[i("div",null,[a(t(G),{for:"tipo_evidencia"},{default:s(()=>[...e[19]||(e[19]=[d("Tipo de Evidencia *",-1)])]),_:1}),a(t(ue),{modelValue:t(o).tipo_evidencia,"onUpdate:modelValue":e[1]||(e[1]=n=>t(o).tipo_evidencia=n),required:""},{default:s(()=>[a(t(ve),null,{default:s(()=>[a(t(me),{placeholder:"Seleccionar tipo..."})]),_:1}),a(t(pe),null,{default:s(()=>[(l(!0),u(I,null,N(k.tiposEvidencia,n=>(l(),h(t(fe),{key:n.value,value:n.value},{default:s(()=>[d(p(n.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),j.value?(l(),u("div",ut,[i("div",vt,[t(o).tipo_evidencia==="imagen"?(l(),u("div",mt,[i("img",{src:j.value,alt:"Vista previa",class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"},null,8,pt)])):t(o).tipo_evidencia==="video"?(l(),u("div",ft,[i("video",{src:j.value,controls:"",class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}," Tu navegador no soporta la reproducción de video. ",8,_t)])):t(o).tipo_evidencia==="audio"?(l(),u("div",ht,[a(t(_e),{class:"w-12 h-12 text-muted-foreground"}),i("audio",{src:j.value,controls:"",class:"w-full max-w-md"}," Tu navegador no soporta la reproducción de audio. ",8,gt)])):(l(),u("div",bt,[a(t(Z),{class:"w-12 h-12 text-muted-foreground"}),i("div",xt,[i("p",yt,p(t(o).archivo_nombre),1),e[20]||(e[20]=i("p",{class:"text-sm text-muted-foreground"},"Documento",-1))])])),a(t(f),{type:"button",onClick:Ve,variant:"destructive",size:"sm",class:"absolute top-2 right-2"},{default:s(()=>[a(t(be),{class:"w-4 h-4"})]),_:1})]),i("p",kt,p(t(o).archivo_nombre),1)])):(l(),u("div",wt,[a(Pe,{modelValue:$.value,"onUpdate:modelValue":e[2]||(e[2]=n=>$.value=n),onFilesSelected:Se,label:"",description:`Selecciona archivos desde tu dispositivo (${t(o).archivos_paths.length}/10 archivos)`,accept:t(o).tipo_evidencia?`${t(o).tipo_evidencia}/*`:"*/*","max-file-size":50,multiple:!0,"max-files":10,disabled:t(o).processing,module:"evidencias","field-id":t(o).tipo_evidencia||"archivo","auto-upload":!1},null,8,["modelValue","description","accept","disabled","field-id"]),e[24]||(e[24]=i("div",{class:"text-center"},[i("div",{class:"relative"},[i("div",{class:"absolute inset-0 flex items-center"},[i("span",{class:"w-full border-t"})]),i("div",{class:"relative flex justify-center text-xs uppercase"},[i("span",{class:"bg-background px-2 text-muted-foreground"},"O capturar directamente")])])],-1)),i("div",Ct,[a(t(f),{type:"button",onClick:e[3]||(e[3]=n=>X("photo")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:s(()=>[a(t(xe),{class:"w-6 h-6"}),e[21]||(e[21]=i("span",{class:"text-xs"},"Foto",-1))]),_:1}),a(t(f),{type:"button",onClick:e[4]||(e[4]=n=>X("video")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:s(()=>[a(t(L),{class:"w-6 h-6"}),e[22]||(e[22]=i("span",{class:"text-xs"},"Video",-1))]),_:1}),a(t(f),{type:"button",onClick:e[5]||(e[5]=n=>X("audio")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:s(()=>[a(t(ee),{class:"w-6 h-6"}),e[23]||(e[23]=i("span",{class:"text-xs"},"Audio",-1))]),_:1})])])),i("div",null,[a(t(G),{for:"descripcion"},{default:s(()=>[...e[25]||(e[25]=[d("Descripción",-1)])]),_:1}),a(t(Le),{modelValue:t(o).descripcion,"onUpdate:modelValue":e[6]||(e[6]=n=>t(o).descripcion=n),placeholder:"Describe brevemente esta evidencia...",rows:"3"},null,8,["modelValue"])])]),_:1})]),_:1})]),i("div",$t,[a(t(R),null,{default:s(()=>[a(t(T),null,{default:s(()=>[a(t(O),null,{default:s(()=>[...e[26]||(e[26]=[d("Entregables Asociados",-1)])]),_:1}),a(t(Y),null,{default:s(()=>[...e[27]||(e[27]=[d(" Opcional: Asocia esta evidencia con entregables específicos ",-1)])]),_:1})]),_:1}),a(t(z),null,{default:s(()=>[i("div",Et,[oe.value.length===0?(l(),u("div",St," No hay entregables disponibles en este proyecto ")):(l(),u("div",Vt,[(l(!0),u(I,null,N(oe.value,n=>(l(),u("div",{key:n.id,class:"flex items-start space-x-3"},[a(t(qe),{id:`entregable-${n.id}`,checked:t(o).entregable_ids.includes(n.id),"onUpdate:checked":m=>{if(m)t(o).entregable_ids.push(n.id);else{const A=t(o).entregable_ids.indexOf(n.id);A>-1&&t(o).entregable_ids.splice(A,1)}}},null,8,["id","checked","onUpdate:checked"]),i("div",At,[a(t(G),{for:`entregable-${n.id}`,class:"text-sm font-medium cursor-pointer"},{default:s(()=>[d(p(n.nombre),1)]),_:2},1032,["for"]),i("p",Bt,p(n.hito),1)])]))),128))]))])]),_:1})]),_:1}),a(t(R),null,{default:s(()=>[a(t(T),null,{default:s(()=>[a(t(O),null,{default:s(()=>[...e[28]||(e[28]=[d("Resumen",-1)])]),_:1})]),_:1}),a(t(z),{class:"space-y-3"},{default:s(()=>{var n;return[i("div",null,[e[29]||(e[29]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Obligación",-1)),i("p",Ft,p(((n=W.value)==null?void 0:n.nombre)||"No seleccionada"),1)]),i("div",null,[e[30]||(e[30]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Tipo",-1)),i("p",Dt,p(t(o).tipo_evidencia||"No seleccionado"),1)]),i("div",null,[e[31]||(e[31]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Archivo",-1)),i("p",Mt,p(t(o).archivo_nombre||"Ninguno"),1)]),H.value.length>0?(l(),u("div",Ut,[i("p",jt,"Entregables ("+p(H.value.length)+")",1),i("div",It,[(l(!0),u(I,null,N(H.value,m=>(l(),u("p",{key:m.id,class:"text-xs text-muted-foreground"},p(m.nombre),1))),128))])])):y("",!0)]}),_:1})]),_:1})])])],32)]),(l(),h(ce,{to:"body"},[te.value?(l(),u("div",Nt,[i("div",Rt,[i("div",Tt,[i("div",Ot,[a(t(f),{type:"button",onClick:Me,variant:"outline",disabled:t(o).processing},{default:s(()=>[a(t(Qe),{class:"w-4 h-4 mr-2"}),e[32]||(e[32]=d(" Guardar Borrador ",-1))]),_:1},8,["disabled"]),w.value==="saving"?(l(),u("div",zt,[a(t(he),{class:"w-4 h-4 mr-1 animate-spin"}),e[33]||(e[33]=d(" Autoguardando... ",-1))])):w.value==="saved"?(l(),u("div",Gt,[a(t(ge),{class:"w-4 h-4 mr-1"}),e[34]||(e[34]=d(" Autoguardado ",-1))])):y("",!0)]),i("div",Lt,[a(t(f),{type:"button",onClick:e[7]||(e[7]=n=>t(Q).visit(r.route("user.mis-contratos.evidencias.show",[k.contrato.id,k.evidencia.id]))),variant:"outline"},{default:s(()=>[...e[35]||(e[35]=[d(" Cancelar ",-1)])]),_:1}),a(t(f),{type:"button",onClick:le,disabled:!ae.value,loading:t(o).processing},{default:s(()=>[a(t(Ye),{class:"w-4 h-4 mr-2"}),e[36]||(e[36]=d(" Actualizar Evidencia ",-1))]),_:1},8,["disabled","loading"])])])])])):y("",!0)])),(l(),h(ce,{to:"body"},[q.value?(l(),u("div",qt,[i("div",Pt,[i("div",Wt,[i("h3",Ht," Capturar "+p(v.value==="photo"?"Foto":v.value==="video"?"Video":"Audio"),1),a(t(f),{onClick:B,variant:"outline",size:"sm"},{default:s(()=>[a(t(be),{class:"w-4 h-4"})]),_:1})]),i("div",Xt,[v.value==="photo"||v.value==="video"?(l(),u("div",Jt,[...e[37]||(e[37]=[i("video",{id:"captureVideo",autoplay:"",muted:"",class:"w-full rounded-lg bg-black"},null,-1)])])):y("",!0),b.value?(l(),u("div",Kt,[e[38]||(e[38]=i("div",{class:"w-3 h-3 bg-red-600 rounded-full animate-pulse"},null,-1)),i("span",Qt,p(De(M.value)),1)])):y("",!0),i("div",Yt,[v.value==="photo"?(l(),h(t(f),{key:0,onClick:Be,class:"flex items-center gap-2"},{default:s(()=>[a(t(xe),{class:"w-4 h-4"}),e[39]||(e[39]=d(" Tomar Foto ",-1))]),_:1})):v.value==="video"&&!b.value?(l(),h(t(f),{key:1,onClick:se,class:"flex items-center gap-2"},{default:s(()=>[a(t(L),{class:"w-4 h-4"}),e[40]||(e[40]=d(" Iniciar Grabación ",-1))]),_:1})):v.value==="video"&&b.value?(l(),h(t(f),{key:2,onClick:re,variant:"destructive",class:"flex items-center gap-2"},{default:s(()=>[a(t(L),{class:"w-4 h-4"}),e[41]||(e[41]=d(" Detener Grabación ",-1))]),_:1})):v.value==="audio"&&!b.value?(l(),h(t(f),{key:3,onClick:se,class:"flex items-center gap-2"},{default:s(()=>[a(t(ee),{class:"w-4 h-4"}),e[42]||(e[42]=d(" Iniciar Grabación ",-1))]),_:1})):v.value==="audio"&&b.value?(l(),h(t(f),{key:4,onClick:re,variant:"destructive",class:"flex items-center gap-2"},{default:s(()=>[a(t(ee),{class:"w-4 h-4"}),e[43]||(e[43]=d(" Detener Grabación ",-1))]),_:1})):y("",!0)])])])])):y("",!0)]))]),_:1})}}});export{Qo as default};
