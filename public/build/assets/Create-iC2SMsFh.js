import{d as G,C as z,k as A,a as u,o as n,b as t,u as e,m as L,e as l,f as i,P as S,g as a,h as M,i as p,n as _,t as m,F as U,r as D,j as J}from"./app-DkmRr0KC.js";import{_ as O}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BZkq0Z9C.js";import{_ as k}from"./createLucideIcon-DXkxOUK0.js";import{_ as x,a as g,b,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-C5ejVlRg.js";import{_ as V}from"./CardDescription.vue_vue_type_script_setup_true_lang-BocLyR7u.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-DihuhIKU.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-CJyIYAf6.js";import{_ as T,a as I,b as W,c as q,d as B}from"./SelectValue.vue_vue_type_script_setup_true_lang-CLO-V0CQ.js";import{_ as H}from"./Switch.vue_vue_type_script_setup_true_lang-Bj4sd1lI.js";import{_ as K}from"./Checkbox.vue_vue_type_script_setup_true_lang-CGBXdJMY.js";import{_ as Q}from"./GeographicSelector.vue_vue_type_script_setup_true_lang-ZxQp_3oc.js";import{_ as X}from"./AvatarUpload.vue_vue_type_script_setup_true_lang-BhfTm6ll.js";import{t as N}from"./index-BYI2yCwO.js";import{A as Y}from"./arrow-left-D0SI--kH.js";import{S as Z}from"./save-B69fHCJ8.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DWY7xu_8.js";import"./index-BdJFCkyv.js";import"./floating-ui.vue-CeXbWfQj.js";import"./x-D_lEJPee.js";import"./index-Bku5qikM.js";import"./shield-Bf5LORgb.js";import"./user-AeqXvCM3.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BBdfce-v.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CMBoC-Ke.js";import"./VisuallyHidden-B4JTwG-M.js";import"./PopperContent-a6xuH_X0.js";import"./index-C9_fScWN.js";import"./circle-alert-Cn12rJzD.js";import"./map-pin-mX_8rXlu.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-BVcPZ7jF.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-k4KAYPpm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-B-pcg4Yq.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CzJh65a2.js";import"./users-CeUnMfI3.js";import"./vote-_t7hyScb.js";import"./file-text-DxNfQIRv.js";import"./calendar-BT7rYFTu.js";import"./briefcase-B0ly6Wi6.js";import"./megaphone-B6v_6gK6.js";import"./user-check-BBr3uT-e.js";import"./external-link-De-IGLrQ.js";import"./panel-left-CmBWsR_X.js";import"./index-DVRv0UkJ.js";import"./check-Co91sU4n.js";import"./index-ljVxmsRr.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHiddenInput-Gjm3l0BY.js";import"./loader-circle-DmzD_GFT.js";import"./upload-Oe4sEJiV.js";const h={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ee={class:"flex items-center justify-between"},oe={class:"grid gap-4 md:grid-cols-2"},re={key:0,class:"text-sm text-red-600 mt-1"},te={key:0,class:"text-sm text-red-600 mt-1"},se={key:0,class:"text-sm text-red-600 mt-1"},le={key:0,class:"text-sm text-red-600 mt-1"},ae={key:0,class:"text-sm text-red-600 mt-1"},ie={class:"grid gap-4 md:grid-cols-2"},de={key:0,class:"text-sm text-red-600 mt-1"},ne={key:0,class:"text-sm text-red-600 mt-1"},ue={class:"space-y-4"},me={key:0},pe={class:"space-y-2 max-h-64 overflow-y-auto border rounded-lg p-4"},fe={class:"flex-1"},_e={key:0,class:"text-sm text-muted-foreground"},ce={key:1,class:"text-xs text-blue-600"},ve={key:0,class:"text-sm text-red-600 mt-1"},xe={key:1},ge={key:0,class:"text-sm text-red-600 mt-1"},be={class:"flex items-center space-x-2"},ye={key:0,class:"text-sm text-red-600 mt-2"},Ve={class:"flex items-center justify-end space-x-2"},yo=G({__name:"Create",props:{cargos:{},roles:{},canAssignRoles:{type:Boolean}},setup(we){const R=[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Nuevo Usuario",href:"#"}],r=z({name:"",email:"",password:"",password_confirmation:"",role_ids:[],cargo_id:"none",documento_identidad:"",telefono:"",direccion:"",territorio_id:null,departamento_id:null,municipio_id:null,localidad_id:null,activo:!0,avatar:null}),w=A(null),$=A({territorio_id:void 0,departamento_id:void 0,municipio_id:void 0,localidad_id:void 0}),P=d=>{$.value=d,r.territorio_id=d.territorio_id||null,r.departamento_id=d.departamento_id||null,r.municipio_id=d.municipio_id||null,r.localidad_id=d.localidad_id||null},j=d=>{r.avatar=d;const o=new FileReader;o.onload=s=>{var v;w.value=(v=s.target)==null?void 0:v.result},o.readAsDataURL(d),N.success("Avatar seleccionado. Se cargará al crear el usuario.")},F=()=>{r.avatar=null,w.value=null,N.success("Avatar eliminado")},E=()=>{r.avatar?r.transform(d=>{const o=new FormData;return Object.keys(d).forEach(s=>{s==="avatar"&&d[s]?o.append("avatar",d[s]):s==="role_ids"&&Array.isArray(d[s])?d[s].forEach(v=>{o.append("role_ids[]",v.toString())}):d[s]!==null&&d[s]!==void 0&&o.append(s,d[s].toString())}),o}).post(route("admin.usuarios.store"),{forceFormData:!0}):r.post(route("admin.usuarios.store"))};return(d,o)=>(n(),u(U,null,[t(e(L),{title:"Crear Usuario"}),t(O,{breadcrumbs:R},{default:l(()=>[i("div",h,[i("div",ee,[o[10]||(o[10]=i("div",null,[i("h1",{class:"text-3xl font-bold tracking-tight"},"Crear Usuario"),i("p",{class:"text-muted-foreground"}," Registra un nuevo usuario en el sistema ")],-1)),t(e(S),{href:d.route("admin.usuarios.index")},{default:l(()=>[t(e(k),{variant:"outline"},{default:l(()=>[t(e(Y),{class:"mr-2 h-4 w-4"}),o[9]||(o[9]=a(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),i("form",{onSubmit:M(E,["prevent"]),class:"space-y-6"},[t(e(x),null,{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(b),null,{default:l(()=>[...o[11]||(o[11]=[a("Foto de Perfil",-1)])]),_:1}),t(e(V),null,{default:l(()=>[...o[12]||(o[12]=[a(" Avatar personalizado del usuario (opcional) ",-1)])]),_:1})]),_:1}),t(e(y),null,{default:l(()=>[t(X,{"model-value":w.value,"user-name":e(r).name||"Nuevo Usuario",label:"Avatar del usuario",description:"Sube una foto de perfil para el nuevo usuario. JPG, PNG o WEBP. Máximo 5MB.",onUpload:j,onDelete:F},null,8,["model-value","user-name"])]),_:1})]),_:1}),t(e(x),null,{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(b),null,{default:l(()=>[...o[13]||(o[13]=[a("Información Básica",-1)])]),_:1}),t(e(V),null,{default:l(()=>[...o[14]||(o[14]=[a(" Datos principales del usuario ",-1)])]),_:1})]),_:1}),t(e(y),{class:"space-y-4"},{default:l(()=>[i("div",oe,[i("div",null,[t(e(f),{for:"name"},{default:l(()=>[...o[15]||(o[15]=[a("Nombre completo *",-1)])]),_:1}),t(e(c),{id:"name",modelValue:e(r).name,"onUpdate:modelValue":o[0]||(o[0]=s=>e(r).name=s),type:"text",placeholder:"Juan Pérez",class:_({"border-red-500":e(r).errors.name})},null,8,["modelValue","class"]),e(r).errors.name?(n(),u("p",re,m(e(r).errors.name),1)):p("",!0)]),i("div",null,[t(e(f),{for:"email"},{default:l(()=>[...o[16]||(o[16]=[a("Correo electrónico *",-1)])]),_:1}),t(e(c),{id:"email",modelValue:e(r).email,"onUpdate:modelValue":o[1]||(o[1]=s=>e(r).email=s),type:"email",placeholder:"juan@ejemplo.com",class:_({"border-red-500":e(r).errors.email})},null,8,["modelValue","class"]),e(r).errors.email?(n(),u("p",te,m(e(r).errors.email),1)):p("",!0)]),i("div",null,[t(e(f),{for:"documento_identidad"},{default:l(()=>[...o[17]||(o[17]=[a("Documento de identidad",-1)])]),_:1}),t(e(c),{id:"documento_identidad",modelValue:e(r).documento_identidad,"onUpdate:modelValue":o[2]||(o[2]=s=>e(r).documento_identidad=s),type:"text",placeholder:"12345678",class:_({"border-red-500":e(r).errors.documento_identidad})},null,8,["modelValue","class"]),e(r).errors.documento_identidad?(n(),u("p",se,m(e(r).errors.documento_identidad),1)):p("",!0)]),i("div",null,[t(e(f),{for:"telefono"},{default:l(()=>[...o[18]||(o[18]=[a("Teléfono",-1)])]),_:1}),t(e(c),{id:"telefono",modelValue:e(r).telefono,"onUpdate:modelValue":o[3]||(o[3]=s=>e(r).telefono=s),type:"tel",placeholder:"3001234567",class:_({"border-red-500":e(r).errors.telefono})},null,8,["modelValue","class"]),e(r).errors.telefono?(n(),u("p",le,m(e(r).errors.telefono),1)):p("",!0)])]),i("div",null,[t(e(f),{for:"direccion"},{default:l(()=>[...o[19]||(o[19]=[a("Dirección",-1)])]),_:1}),t(e(c),{id:"direccion",modelValue:e(r).direccion,"onUpdate:modelValue":o[4]||(o[4]=s=>e(r).direccion=s),type:"text",placeholder:"Calle 123 #45-67",class:_({"border-red-500":e(r).errors.direccion})},null,8,["modelValue","class"]),e(r).errors.direccion?(n(),u("p",ae,m(e(r).errors.direccion),1)):p("",!0)])]),_:1})]),_:1}),t(e(x),null,{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(b),null,{default:l(()=>[...o[20]||(o[20]=[a("Seguridad",-1)])]),_:1}),t(e(V),null,{default:l(()=>[...o[21]||(o[21]=[a(" Configuración de acceso y contraseña ",-1)])]),_:1})]),_:1}),t(e(y),{class:"space-y-4"},{default:l(()=>[i("div",ie,[i("div",null,[t(e(f),{for:"password"},{default:l(()=>[...o[22]||(o[22]=[a("Contraseña *",-1)])]),_:1}),t(e(c),{id:"password",modelValue:e(r).password,"onUpdate:modelValue":o[5]||(o[5]=s=>e(r).password=s),type:"password",placeholder:"••••••••",class:_({"border-red-500":e(r).errors.password})},null,8,["modelValue","class"]),e(r).errors.password?(n(),u("p",de,m(e(r).errors.password),1)):p("",!0)]),i("div",null,[t(e(f),{for:"password_confirmation"},{default:l(()=>[...o[23]||(o[23]=[a("Confirmar contraseña *",-1)])]),_:1}),t(e(c),{id:"password_confirmation",modelValue:e(r).password_confirmation,"onUpdate:modelValue":o[6]||(o[6]=s=>e(r).password_confirmation=s),type:"password",placeholder:"••••••••",class:_({"border-red-500":e(r).errors.password_confirmation})},null,8,["modelValue","class"]),e(r).errors.password_confirmation?(n(),u("p",ne,m(e(r).errors.password_confirmation),1)):p("",!0)])]),i("div",ue,[d.canAssignRoles?(n(),u("div",me,[t(e(f),null,{default:l(()=>[...o[24]||(o[24]=[a("Roles del usuario *",-1)])]),_:1}),o[25]||(o[25]=i("p",{class:"text-sm text-muted-foreground mb-3"}," Selecciona uno o más roles para este usuario ",-1)),i("div",pe,[(n(!0),u(U,null,D(d.roles,s=>(n(),u("div",{key:s.value,class:"flex items-start space-x-3 py-2"},[t(e(K),{id:`role-${s.value}`,checked:e(r).role_ids.includes(s.value),"onUpdate:checked":v=>{if(v)e(r).role_ids.includes(s.value)||e(r).role_ids.push(s.value);else{const C=e(r).role_ids.indexOf(s.value);C>-1&&e(r).role_ids.splice(C,1)}}},null,8,["id","checked","onUpdate:checked"]),i("div",fe,[t(e(f),{for:`role-${s.value}`,class:"text-base font-medium cursor-pointer"},{default:l(()=>[a(m(s.label),1)]),_:2},1032,["for"]),s.description?(n(),u("p",_e,m(s.description),1)):p("",!0),s.is_system?(n(),u("span",ce," (Rol del Sistema) ")):p("",!0)])]))),128))]),e(r).errors.role_ids?(n(),u("p",ve,m(e(r).errors.role_ids),1)):p("",!0)])):(n(),u("div",xe,[t(e(f),null,{default:l(()=>[...o[26]||(o[26]=[a("Rol",-1)])]),_:1}),o[27]||(o[27]=i("div",{class:"p-3 bg-muted rounded-md"},[i("p",{class:"text-sm text-muted-foreground"}," Se asignará el rol por defecto al usuario ")],-1))])),i("div",null,[t(e(f),{for:"cargo_id"},{default:l(()=>[...o[28]||(o[28]=[a("Cargo",-1)])]),_:1}),t(e(T),{modelValue:e(r).cargo_id,"onUpdate:modelValue":o[7]||(o[7]=s=>e(r).cargo_id=s)},{default:l(()=>[t(e(I),{class:_({"border-red-500":e(r).errors.cargo_id})},{default:l(()=>[t(e(W),{placeholder:"Selecciona un cargo"})]),_:1},8,["class"]),t(e(q),null,{default:l(()=>[t(e(B),{value:"none"},{default:l(()=>[...o[29]||(o[29]=[a("Sin cargo",-1)])]),_:1}),(n(!0),u(U,null,D(d.cargos,s=>(n(),J(e(B),{key:s.id,value:s.id.toString()},{default:l(()=>[a(m(s.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(r).errors.cargo_id?(n(),u("p",ge,m(e(r).errors.cargo_id),1)):p("",!0)])]),i("div",be,[t(e(H),{id:"activo",checked:e(r).activo,"onUpdate:checked":o[8]||(o[8]=s=>e(r).activo=s)},null,8,["checked"]),t(e(f),{for:"activo"},{default:l(()=>[...o[30]||(o[30]=[a("Usuario activo",-1)])]),_:1})])]),_:1})]),_:1}),t(e(x),null,{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(b),null,{default:l(()=>[...o[31]||(o[31]=[a("Ubicación Geográfica",-1)])]),_:1}),t(e(V),null,{default:l(()=>[...o[32]||(o[32]=[a(" Define la ubicación del usuario (opcional) ",-1)])]),_:1})]),_:1}),t(e(y),null,{default:l(()=>[t(Q,{"model-value":$.value,"onUpdate:modelValue":P,mode:"single","show-card":!1,title:"",description:""},null,8,["model-value"]),e(r).errors.territorio_id||e(r).errors.departamento_id||e(r).errors.municipio_id||e(r).errors.localidad_id?(n(),u("div",ye,m(e(r).errors.territorio_id||e(r).errors.departamento_id||e(r).errors.municipio_id||e(r).errors.localidad_id),1)):p("",!0)]),_:1})]),_:1}),i("div",Ve,[t(e(S),{href:d.route("admin.usuarios.index")},{default:l(()=>[t(e(k),{variant:"outline",type:"button"},{default:l(()=>[...o[33]||(o[33]=[a(" Cancelar ",-1)])]),_:1})]),_:1},8,["href"]),t(e(k),{type:"submit",disabled:e(r).processing},{default:l(()=>[t(e(Z),{class:"mr-2 h-4 w-4"}),o[34]||(o[34]=a(" Crear Usuario ",-1))]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{yo as default};
