import{d as J,r as T,c as Q,i as p,e as d,f as s,u as e,p as Y,w as o,g as t,h as l,R as Z,b as c,j as _,t as n,n as f,q as h,F as j,k as ee,W as H}from"./app-DiTimFRW.js";import{_ as P}from"./index-B3yR8zRW.js";import{_ as q}from"./createLucideIcon-Dk3zluZI.js";import{_ as b,a as S,b as $,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-Do8VxmPU.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-DV6Pygaj.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-4iKq4xxO.js";import{_ as ae}from"./Separator.vue_vue_type_script_setup_true_lang-B9wB-a4L.js";import{_ as O,a as U}from"./index-ClqEMARa.js";import{_ as se}from"./GuestLayout.vue_vue_type_script_setup_true_lang-B7szxSst.js";import{C as g}from"./circle-check-big-BiInhZH3.js";import{C as w}from"./circle-x-u6a-lriS.js";import{S as D}from"./shield-OXelDVUT.js";import{S as K}from"./search-cLCdZBht.js";import{H as oe}from"./hash-CWc08ydP.js";import{C as ie}from"./copy-4ByPj7Tu.js";import{C as le}from"./clock-D_txVMHF.js";import{T as ne}from"./triangle-alert-B61qWXb5.js";import{E as re}from"./external-link-aUFy3D_k.js";import"./index-C21nUFg-.js";import"./index-DxL_b2wa.js";import"./floating-ui.vue-D_og6XPx.js";import"./index-BI0ShkNY.js";import"./index-EWMIzLdg.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-D4VxpJOB.js";const de={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ue={class:"text-center"},ce={class:"text-4xl font-bold flex items-center justify-center gap-3"},fe={class:"space-y-4"},me={class:"flex gap-2"},ve={key:0,class:"max-w-4xl mx-auto w-full space-y-6"},pe={class:"flex items-center gap-4"},_e={class:"flex-1"},ge={class:"space-y-4"},xe={class:"flex items-center gap-2"},ke={class:"text-xs font-mono bg-muted p-3 rounded flex-1 break-all"},he={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},be={class:"flex items-center gap-1"},ye={class:"flex items-center gap-1"},we={class:"flex items-center gap-1"},Ce={class:"flex items-center gap-1"},Ve={class:"space-y-4"},Te={key:0,class:"text-muted-foreground"},Se={class:"flex flex-wrap gap-4 text-sm"},$e={class:"flex items-center gap-2"},Ie={class:"flex items-center gap-2 text-muted-foreground"},qe={class:"space-y-6"},De={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-6"},Ee={class:"font-medium"},Ae={class:"font-mono text-xs break-all bg-muted p-2 rounded"},Fe={class:"space-y-6"},Le={class:"flex items-start justify-between"},Ne={class:"flex-1"},Be={key:0,class:"text-red-500"},Re={key:0,class:"text-sm text-muted-foreground mt-1"},ze={class:"bg-muted/30 rounded-lg p-4"},je={class:"text-lg"},He={key:1,class:"max-w-2xl mx-auto text-center space-y-4"},Pe={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},Oe={class:"text-center p-4"},Ue={class:"text-center p-4"},Ke={class:"text-center p-4"},_t=J({__name:"VerificarToken",props:{token:{},verification:{}},setup(W){const E=W,x=T(E.token||""),C=T(!1),i=T(E.verification||null),v=Q(()=>{if(!i.value)return null;const u=i.value;return u.is_valid?{icon:g,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",label:"VÁLIDO",description:"Token verificado criptográficamente"}:{icon:w,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"INVÁLIDO",description:u.error||"Token no válido o corrupto"}}),A=()=>{x.value.trim()&&(C.value=!0,H.get(`/verificar-token/${encodeURIComponent(x.value.trim())}`,{},{onFinish:()=>{C.value=!1}}))},I=u=>new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),M=(u,a)=>!a&&a!==0?"Sin respuesta":u.type==="checkbox"?Array.isArray(a)&&a.length>0?a.join(", "):"Sin respuesta":a.toString(),V=T(!1),X=async()=>{var u;if((u=i.value)!=null&&u.token)try{await navigator.clipboard.writeText(i.value.token),V.value=!0,setTimeout(()=>{V.value=!1},2e3)}catch(a){console.error("Error al copiar token:",a)}},G=()=>{x.value="",i.value=null,H.get("/verificar-token")};return(u,a)=>(d(),p(j,null,[s(e(Y),{title:"Verificación de Tokens de Votación"}),s(se,{title:"Verificar Token",description:"Verifica la autenticidad de tokens de votación"},{default:o(()=>{var F,L;return[t("div",de,[t("div",ue,[t("h1",ce,[s(e(D),{class:"h-10 w-10 text-blue-600"}),a[1]||(a[1]=l(" Verificación de Tokens ",-1))]),a[2]||(a[2]=t("p",{class:"text-muted-foreground mt-2 max-w-2xl mx-auto"}," Verifica la autenticidad e integridad de cualquier token de votación de forma pública y anónima. Utiliza criptografía digital para garantizar que los votos no han sido alterados. ",-1))]),s(e(b),{class:"max-w-2xl mx-auto w-full"},{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),{class:"flex items-center gap-2"},{default:o(()=>[s(e(K),{class:"h-5 w-5"}),a[3]||(a[3]=l(" Buscar Token ",-1))]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",fe,[t("div",null,[s(e(m),{for:"token-input"},{default:o(()=>[...a[4]||(a[4]=[l("Token de Votación",-1)])]),_:1}),s(e(te),{id:"token-input",modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=r=>x.value=r),placeholder:"Pega aquí tu token de votación para verificar...",onKeyup:Z(A,["enter"]),class:"font-mono text-sm"},null,8,["modelValue"])]),t("div",me,[s(e(q),{onClick:A,disabled:!x.value.trim()||C.value,class:"flex-1"},{default:o(()=>[s(e(K),{class:"mr-2 h-4 w-4"}),l(" "+n(C.value?"Verificando...":"Verificar Token"),1)]),_:1},8,["disabled"]),i.value?(d(),c(e(q),{key:0,onClick:G,variant:"outline"},{default:o(()=>[...a[5]||(a[5]=[l(" Limpiar ",-1)])]),_:1})):_("",!0)])])]),_:1})]),_:1}),i.value?(d(),p("div",ve,[s(e(b),{class:f([(F=v.value)==null?void 0:F.borderColor,(L=v.value)==null?void 0:L.bgColor])},{default:o(()=>[s(e(y),{class:"pt-6"},{default:o(()=>{var r,k,N,B,R,z;return[t("div",pe,[(d(),c(h((r=v.value)==null?void 0:r.icon),{class:f(["h-12 w-12",(k=v.value)==null?void 0:k.color])},null,8,["class"])),t("div",_e,[t("h2",{class:f(["text-2xl font-bold",(N=v.value)==null?void 0:N.color])},n((B=v.value)==null?void 0:B.label),3),t("p",{class:f(["text-sm",(R=v.value)==null?void 0:R.color])},n((z=v.value)==null?void 0:z.description),3)])])]}),_:1})]),_:1},8,["class"]),s(e(b),null,{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),{class:"flex items-center gap-2"},{default:o(()=>[s(e(oe),{class:"h-5 w-5"}),a[6]||(a[6]=l(" Información del Token ",-1))]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",ge,[t("div",null,[s(e(m),{class:"text-sm font-medium text-muted-foreground"},{default:o(()=>[...a[7]||(a[7]=[l("Token",-1)])]),_:1}),t("div",xe,[t("p",ke,n(i.value.token),1),s(e(q),{variant:"outline",size:"sm",onClick:X,class:f({"bg-green-50 border-green-200":V.value})},{default:o(()=>[s(e(ie),{class:"h-4 w-4"}),l(" "+n(V.value?"Copiado!":"Copiar"),1)]),_:1},8,["class"])])]),t("div",he,[t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>[...a[8]||(a[8]=[l("Formato",-1)])]),_:1}),t("div",be,[(d(),c(h(i.value.verification_details.format_valid?e(g):e(w)),{class:f(["h-4 w-4",i.value.verification_details.format_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(i.value.verification_details.format_valid?"Válido":"Inválido"),1)])]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>[...a[9]||(a[9]=[l("Firma Digital",-1)])]),_:1}),t("div",ye,[(d(),c(h(i.value.verification_details.signature_valid?e(g):e(w)),{class:f(["h-4 w-4",i.value.verification_details.signature_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(i.value.verification_details.signature_valid?"Válida":"Inválida"),1)])]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>[...a[10]||(a[10]=[l("Integridad",-1)])]),_:1}),t("div",we,[(d(),c(h(i.value.verification_details.hash_valid?e(g):e(w)),{class:f(["h-4 w-4",i.value.verification_details.hash_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(i.value.verification_details.hash_valid?"Íntegro":"Alterado"),1)])]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>[...a[11]||(a[11]=[l("Votación",-1)])]),_:1}),t("div",Ce,[(d(),c(h(i.value.verification_details.votacion_exists?e(g):e(w)),{class:f(["h-4 w-4",i.value.verification_details.votacion_exists?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(i.value.verification_details.votacion_exists?"Existe":"No existe"),1)])])])])]),_:1})]),_:1}),i.value.votacion?(d(),c(e(b),{key:0},{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),null,{default:o(()=>[l(n(i.value.votacion.titulo),1)]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",Ve,[i.value.votacion.descripcion?(d(),p("p",Te,n(i.value.votacion.descripcion),1)):_("",!0),t("div",Se,[t("div",$e,[s(e(P),{variant:"outline"},{default:o(()=>[l(n(i.value.votacion.categoria),1)]),_:1})]),t("div",Ie,[s(e(le),{class:"h-4 w-4"}),l(" "+n(I(i.value.votacion.fecha_inicio))+" - "+n(I(i.value.votacion.fecha_fin)),1)])])])]),_:1})]),_:1})):_("",!0),i.value.vote_data&&i.value.votacion?(d(),c(e(b),{key:1},{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),{class:"flex items-center gap-2"},{default:o(()=>[s(e(g),{class:"h-5 w-5"}),a[12]||(a[12]=l(" Respuestas del Voto ",-1))]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",qe,[t("div",De,[t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>[...a[13]||(a[13]=[l("Fecha del Voto",-1)])]),_:1}),t("p",Ee,n(I(i.value.vote_data.timestamp)),1)]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>[...a[14]||(a[14]=[l("Hash de Verificación",-1)])]),_:1}),t("p",Ae,n(i.value.vote_data.vote_hash),1)])]),t("div",Fe,[(d(!0),p(j,null,ee(i.value.votacion.formulario_config,(r,k)=>(d(),p("div",{key:r.id,class:"space-y-2"},[t("div",Le,[t("div",Ne,[s(e(m),{class:"text-base font-medium"},{default:o(()=>[l(n(k+1)+". "+n(r.title)+" ",1),r.required?(d(),p("span",Be,"*")):_("",!0)]),_:2},1024),r.description?(d(),p("p",Re,n(r.description),1)):_("",!0)]),s(e(P),{variant:"secondary",class:"ml-4"},{default:o(()=>[l(n(r.type==="text"?"Texto":r.type==="textarea"?"Texto largo":r.type==="select"?"Selección":r.type==="radio"?"Opción única":r.type==="checkbox"?"Múltiple":r.type),1)]),_:2},1024)]),t("div",ze,[t("p",je,n(M(r,i.value.vote_data.respuestas[r.id])),1)]),k<i.value.votacion.formulario_config.length-1?(d(),c(e(ae),{key:0,class:"mt-6"})):_("",!0)]))),128))])])]),_:1})]),_:1})):_("",!0),s(e(O),null,{default:o(()=>[s(e(D),{class:"h-4 w-4"}),s(e(U),null,{default:o(()=>[...a[15]||(a[15]=[t("strong",null,"Verificación criptográfica:",-1),l(" Este token ha sido verificado usando criptografía digital RSA-2048 con SHA-256. La verificación confirma que el voto proviene del sistema oficial y no ha sido alterado. ",-1),t("br",null,null,-1),t("br",null,null,-1),t("strong",null,"Privacidad:",-1),l(" Esta verificación es completamente anónima. No se puede determinar la identidad del votante a partir de este token. ",-1)])]),_:1})]),_:1})])):(d(),p("div",He,[s(e(O),null,{default:o(()=>[s(e(ne),{class:"h-4 w-4"}),s(e(U),null,{default:o(()=>[...a[16]||(a[16]=[t("strong",null,"¿Cómo funciona?",-1),t("br",null,null,-1),l(" Cada voto genera un token firmado digitalmente que contiene las respuestas del formulario. Puedes verificar públicamente que tu voto fue procesado correctamente sin revelar tu identidad. ",-1)])]),_:1})]),_:1}),t("div",Pe,[t("div",Oe,[s(e(D),{class:"h-8 w-8 text-blue-600 mx-auto mb-2"}),a[17]||(a[17]=t("h3",{class:"font-medium"},"Seguridad",-1)),a[18]||(a[18]=t("p",{class:"text-muted-foreground"},"Criptografía RSA-2048",-1))]),t("div",Ue,[s(e(g),{class:"h-8 w-8 text-green-600 mx-auto mb-2"}),a[19]||(a[19]=t("h3",{class:"font-medium"},"Verificable",-1)),a[20]||(a[20]=t("p",{class:"text-muted-foreground"},"Integridad garantizada",-1))]),t("div",Ke,[s(e(re),{class:"h-8 w-8 text-purple-600 mx-auto mb-2"}),a[21]||(a[21]=t("h3",{class:"font-medium"},"Público",-1)),a[22]||(a[22]=t("p",{class:"text-muted-foreground"},"Sin autenticación",-1))])])]))])]}),_:1})],64))}});export{_t as default};
