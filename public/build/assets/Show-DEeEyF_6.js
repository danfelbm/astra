import{_ as de}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Dw_nrbsE.js";import{r as j,s as $,d as Z,c as L,b as g,w as r,j as p,e as o,f as t,g as s,i as h,h as m,t as d,v as B,n as _,F,k as J,m as i,q as ue,x as me}from"./app-DB52i0Vi.js";import{a as P,b as V,c as S,_ as H}from"./CardTitle.vue_vue_type_script_setup_true_lang-DhGz-PEe.js";import{_ as ee}from"./CardDescription.vue_vue_type_script_setup_true_lang-DtOg4Wyo.js";import{_ as q}from"./createLucideIcon-CDD88oTc.js";import{_ as A}from"./index-CBsS3L2Y.js";import{_ as te}from"./Progress.vue_vue_type_script_setup_true_lang-DZVR2xvy.js";import{_ as fe,a as ye,b as M,c as N}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-Iq2M3fOH.js";import{t as D}from"./index-B7CL-mW0.js";import{E as ge}from"./EtiquetaDisplay-BAbZn1RR.js";import{E as pe}from"./EtiquetaSelector-DKmKLTUf.js";import{_ as ve}from"./ContratosList.vue_vue_type_script_setup_true_lang-DBkHsOTd.js";import{M as xe,_ as he,B as be,C as we}from"./EvidenciasDisplay.vue_vue_type_script_setup_true_lang-BVI7w0v1.js";import{_ as Ee,a as $e}from"./ActivityLog.vue_vue_type_script_setup_true_lang-C2-uy0yU.js";import{L as ke,H as qe}from"./HitoCard-D6UDo1J3.js";import{T as K}from"./target-Bz_VNBhI.js";import{P as R}from"./plus-BOHl1_uP.js";import{S as X}from"./square-pen-B5xRwGN3.js";import{T as Ce}from"./trash-2-MPzAwngH.js";import{I as Se}from"./info-oIlZl1hZ.js";import{F as Q}from"./file-text-P5qiexdG.js";import{I as He}from"./image-C_zcE-Hu.js";import{A as De}from"./activity-DZMNc0fK.js";import{F as Pe}from"./flag-CB-af8Y_.js";import{C as W}from"./calendar-BG7OdIRp.js";import{C as Ve}from"./clock-BeSNEDiZ.js";import{U as Y}from"./user-CkpVpm_2.js";import{C as Be}from"./circle-check-big-Dcr0bDve.js";import{C as Te}from"./circle-play-BS3XuN4_.js";import{C as Ae}from"./circle-alert-Fzh2I4oh.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DcNzwwrA.js";import"./index-BEwfH5Us.js";import"./floating-ui.vue-TDhXKOz6.js";import"./x-DhYwZj5g.js";import"./Input.vue_vue_type_script_setup_true_lang-BMJpcIBW.js";import"./index-C97ua1Jz.js";import"./index-lDsEFH4z.js";import"./shield-NSmx5WMc.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DQFkAj1L.js";import"./chevron-right-BOo7MKuO.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-Lbr02lfH.js";import"./VisuallyHidden-7WJPGwXK.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CZdpgezo.js";import"./check-BSa6upwI.js";import"./Label.vue_vue_type_script_setup_true_lang-DNBAD1R6.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-fjSICTO7.js";import"./map-pin-uatvRRf1.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-LGMRVQul.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-C9RMd-fi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-BTqveiFu.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BWza2RrI.js";import"./tag-wZuE_sUU.js";import"./users-YBraLpAg.js";import"./vote-DanWGhka.js";import"./folder-open-BNvjzsbB.js";import"./send-xk5URWTc.js";import"./briefcase-Cfi8w0YR.js";import"./megaphone-CKthpsg2.js";import"./user-check-CKyH3W5C.js";import"./clipboard-list-BDbvISjb.js";import"./mail-lODDXllb.js";import"./message-square-CCSeZ8WS.js";import"./external-link-7U9r7dL8.js";import"./panel-left-BuXJDLUe.js";import"./index-4f99ARWI.js";import"./RovingFocusItem-DW7D6Yqz.js";import"./utils-CJ5k_34a.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-CV_2NFgH.js";import"./layers-DMLYhwKX.js";import"./zap-BAuhNbQ-.js";import"./trending-up-BKV0UOsj.js";import"./award-B1rv3Nrf.js";import"./hash-FdEiBkgP.js";import"./index-CLMqhBtv.js";import"./search-CXmRwHPJ.js";import"./useKbd-kRIii9yh.js";import"./VisuallyHiddenInput-C3mc9z8K.js";import"./useEtiquetaHierarchy-DRx38EzJ.js";import"./list-DTFpUi_J.js";import"./tree-pine-BGL1so50.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-C7MoCfHr.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-C-HreWb1.js";import"./useToast-KtKCdXwu.js";import"./dollar-sign-DPEYK27T.js";import"./ellipsis-BsqMRhEh.js";import"./eye-DCSEm6gP.js";import"./download-D5H5Xxnp.js";import"./copy-CM-sXNCd.js";import"./AccordionContent.vue_vue_type_script_setup_true_lang-fr91myHt.js";import"./useArrowNavigation-B5rxJs06.js";import"./Textarea.vue_vue_type_script_setup_true_lang-7R2GJmbJ.js";import"./circle-x-9HpFn4h6.js";import"./filter-BzGzjYoE.js";import"./es-BDPlFIsO.js";import"./parseISO-DFjB8F03.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-C3e9nxl5.js";import"./pen-BXlbbMVH.js";import"./calendar-days-DILjHcty.js";function je(){const e=j(!1),n=j(null);async function T(x,u){return e.value=!0,n.value=null,new Promise((y,b)=>{$.post(`/admin/proyectos/${x}/etiquetas`,{etiqueta_id:u},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,y(!0)},onError:E=>{e.value=!1,n.value=Object.values(E).join(", "),b(E)}})})}async function z(x,u){return e.value=!0,n.value=null,new Promise((y,b)=>{$.delete(`/admin/proyectos/${x}/etiquetas/${u}`,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,y(!0)},onError:E=>{e.value=!1,n.value="Error al quitar la etiqueta",b(E)}})})}async function v(x,u){return e.value=!0,n.value=null,new Promise((y,b)=>{$.put(`/admin/proyectos/${x}/etiquetas/sync`,{etiquetas:u},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,y(!0)},onError:E=>{e.value=!1,n.value="Error al sincronizar etiquetas",b(E)}})})}async function f(x){e.value=!0,n.value=null;try{const u=await fetch(`/admin/proyectos/${x}/etiquetas/suggest`);if(!u.ok)throw new Error("Error al obtener sugerencias");const y=await u.json();return e.value=!1,y.etiquetas||[]}catch(u){return e.value=!1,n.value="Error al obtener sugerencias de etiquetas",console.error(u),[]}}async function w(x){var u;e.value=!0,n.value=null;try{const y=await fetch("/admin/etiquetas",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"))||""},body:JSON.stringify(x)});if(!y.ok){const E=await y.json();throw new Error(E.message||"Error al crear etiqueta")}const b=await y.json();return e.value=!1,b.data}catch(y){return e.value=!1,n.value=y.message||"Error al crear etiqueta",console.error(y),null}}async function C(x){if(x.length<2)return[];try{const u=await fetch(`/admin/etiquetas/search?q=${encodeURIComponent(x)}`);if(!u.ok)throw new Error("Error al buscar etiquetas");return(await u.json()).data||[]}catch(u){return console.error("Error buscando etiquetas:",u),[]}}function I(x){const u=new Map;return x.forEach(y=>{var E;const b=((E=y.categoria)==null?void 0:E.nombre)||"Sin categoría";u.has(b)||u.set(b,[]),u.get(b).push(y)}),u}function U(x){var u;return x.color||((u=x.categoria)==null?void 0:u.color)||"gray"}function G(x,u=10){return x<u}async function O(x,u){return e.value=!0,n.value=null,new Promise((y,b)=>{$.post(`/admin/proyectos/${x}/etiquetas/reorder`,{etiquetas:u},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e.value=!1,y(!0)},onError:E=>{e.value=!1,n.value="Error al reordenar etiquetas",b(E)}})})}return{isLoading:e,error:n,addEtiquetaToProyecto:T,removeEtiquetaFromProyecto:z,syncEtiquetasProyecto:v,getSugerenciasEtiquetas:f,reorderEtiquetas:O,createEtiqueta:w,searchEtiquetas:C,groupEtiquetasByCategoria:I,getEtiquetaColor:U,canAddMoreEtiquetas:G}}const ze={key:0,class:"flex items-center gap-2"},Me={key:0,class:"mb-6"},Ne={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},Ie={class:"text-center"},_e={class:"text-2xl font-bold"},Fe={class:"text-center"},Le={class:"text-2xl font-bold text-blue-500"},Re={class:"text-center"},Ue={class:"text-2xl font-bold text-green-500"},Ge={class:"text-center"},Oe={class:"space-y-2"},Je={class:"flex justify-between items-center text-sm"},Ke={class:"font-medium"},Xe={key:1,class:"space-y-4"},Qe={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},We={key:2,class:"text-center py-6"},Ye={class:"text-muted-foreground mb-3"},Ze=Z({__name:"HitosGrid",props:{hitos:{},proyectoId:{},proyectoNombre:{},estadisticas:{},showStats:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0},showViewAll:{type:Boolean,default:!0},maxHitos:{default:void 0},canCreate:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},emptyMessage:{default:"No hay hitos definidos para este proyecto"}},emits:["view","edit","delete","duplicate","add-entregable","view-entregables"],setup(e){const n=e,T=L(()=>n.maxHitos&&n.maxHitos>0?n.hitos.slice(0,n.maxHitos):n.hitos),z=L(()=>n.maxHitos&&n.hitos.length>n.maxHitos);return(v,f)=>(i(),g(t(H),null,{default:r(()=>[e.showHeader?(i(),g(t(P),{key:0,class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:r(()=>[s("div",null,[o(t(V),{class:"flex items-center gap-2"},{default:r(()=>[o(t(K),{class:"h-5 w-5"}),f[0]||(f[0]=m(" Hitos y Entregables ",-1))]),_:1}),e.proyectoNombre?(i(),g(t(ee),{key:0},{default:r(()=>[m(d(e.proyectoNombre),1)]),_:1})):p("",!0)]),e.showActions?(i(),h("div",ze,[e.showViewAll&&e.hitos.length>0?(i(),g(t(B),{key:0,href:`/admin/proyectos/${e.proyectoId}/hitos`},{default:r(()=>[o(t(q),{variant:"outline",size:"sm"},{default:r(()=>[o(t(ke),{class:"h-4 w-4 mr-2"}),f[1]||(f[1]=m(" Ver Todos ",-1))]),_:1})]),_:1},8,["href"])):p("",!0),e.canCreate?(i(),g(t(B),{key:1,href:`/admin/proyectos/${e.proyectoId}/hitos/create`},{default:r(()=>[o(t(q),{size:"sm"},{default:r(()=>[o(t(R),{class:"h-4 w-4 mr-2"}),f[2]||(f[2]=m(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])):p("",!0)]),_:1})):p("",!0),o(t(S),null,{default:r(()=>[e.showStats&&e.estadisticas&&e.estadisticas.total>0?(i(),h("div",Me,[s("div",Ne,[s("div",Ie,[s("p",_e,d(e.estadisticas.total),1),f[3]||(f[3]=s("p",{class:"text-xs text-muted-foreground"},"Total Hitos",-1))]),s("div",Fe,[s("p",Le,d(e.estadisticas.en_progreso),1),f[4]||(f[4]=s("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),s("div",Re,[s("p",Ue,d(e.estadisticas.completados),1),f[5]||(f[5]=s("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),s("div",Ge,[s("p",{class:_(["text-2xl font-bold",{"text-red-500":e.estadisticas.vencidos>0}])},d(e.estadisticas.vencidos),3),f[6]||(f[6]=s("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))])]),s("div",Oe,[s("div",Je,[f[7]||(f[7]=s("span",{class:"text-muted-foreground"},"Progreso General",-1)),s("span",Ke,d(e.estadisticas.progreso_general)+"%",1)]),o(t(te),{value:e.estadisticas.progreso_general,class:"h-2"},null,8,["value"])])])):p("",!0),e.hitos.length>0?(i(),h("div",Xe,[s("div",Qe,[(i(!0),h(F,null,J(T.value,w=>(i(),g(qe,{key:w.id,hito:w,canEdit:e.canEdit,canDelete:e.canDelete,canManageDeliverables:e.canManageDeliverables,showActions:!0,onView:C=>v.$emit("view",w),onEdit:C=>v.$emit("edit",w),onDelete:C=>v.$emit("delete",w),onDuplicate:C=>v.$emit("duplicate",w),onAddEntregable:C=>v.$emit("add-entregable",w),onViewEntregables:C=>v.$emit("view-entregables",w)},null,8,["hito","canEdit","canDelete","canManageDeliverables","onView","onEdit","onDelete","onDuplicate","onAddEntregable","onViewEntregables"]))),128))]),z.value?(i(),g(t(B),{key:0,href:`/admin/proyectos/${e.proyectoId}/hitos`,class:"block text-center mt-4 text-sm text-primary hover:underline"},{default:r(()=>[m(" Ver todos los hitos ("+d(e.hitos.length)+") ",1)]),_:1},8,["href"])):p("",!0)])):(i(),h("div",We,[o(t(K),{class:"h-10 w-10 mx-auto text-muted-foreground mb-3"}),s("p",Ye,d(e.emptyMessage),1),e.canCreate?(i(),g(t(B),{key:0,href:`/admin/proyectos/${e.proyectoId}/hitos/create`},{default:r(()=>[o(t(q),{variant:"outline",size:"sm"},{default:r(()=>[o(t(R),{class:"h-4 w-4 mr-2"}),f[8]||(f[8]=m(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)]))]),_:1})]),_:1}))}}),et={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},tt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},at={class:"text-2xl font-bold text-gray-900 dark:text-white"},ot={key:0,class:"mt-2 text-gray-600 dark:text-gray-400"},st={class:"flex gap-2"},rt={class:"flex items-center justify-between"},it={class:"flex items-center gap-3"},lt={class:"flex items-center gap-3"},nt={class:"space-y-2"},ct={class:"flex justify-between text-sm"},dt={class:"font-medium"},ut={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2"},mt={class:"flex items-start gap-3"},ft={class:"font-medium"},yt={class:"text-xs text-gray-500"},gt={key:0,class:"flex items-start gap-3"},pt={class:"font-medium"},vt={class:"text-xs text-gray-500"},xt={key:0,class:"flex items-center gap-3 pt-2"},ht={class:"font-medium ml-2"},bt={key:0},wt={key:1,class:"text-sm text-muted-foreground"},Et={key:1,class:"space-y-4"},$t={class:"flex gap-2"},kt={class:"space-y-4"},qt={class:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},Ct={class:"text-gray-900 dark:text-gray-100"},St={key:0,class:"flex items-center gap-3"},Ht={class:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Dt={class:"font-medium"},Pt={class:"text-sm text-gray-500"},Vt={key:1,class:"text-gray-500"},Bt={class:"font-mono"},Tt={class:"font-medium"},At={class:"text-sm"},jt={class:"text-sm"},zt={class:"space-y-3"},Mt={class:"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Nt={class:"flex-1"},It={class:"text-sm"},_t={class:"font-medium"},Ft={class:"text-xs text-gray-500 mt-1"},Lt={key:0,class:"flex justify-end"},Rt={class:"space-y-4"},Ut={class:"text-center"},Mo=Z({__name:"Show",props:{proyecto:{},categorias:{},activities:{},usuariosActividades:{},authPermissions:{},totales:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageTags:{type:Boolean},canViewContracts:{type:Boolean},canCreateContracts:{type:Boolean},canViewHitos:{type:Boolean},canCreateHitos:{type:Boolean},canEditHitos:{type:Boolean},canDeleteHitos:{type:Boolean},canManageEntregables:{type:Boolean},estadisticasHitos:{}},setup(e){const n=e,T=j("general"),z=L(()=>{var l,a;return((l=n.authPermissions)==null?void 0:l.includes("evidencias.aprobar"))||((a=n.authPermissions)==null?void 0:a.includes("evidencias.rechazar"))||!1}),v=j({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null}),f=j(!1),w=j([]),{syncEtiquetasProyecto:C,isLoading:I}=je();n.proyecto.etiquetas&&(w.value=n.proyecto.etiquetas.map(l=>l.id));const U=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:n.proyecto.nombre,href:`/admin/proyectos/${n.proyecto.id}`}],G=()=>{confirm(`¿Estás seguro de eliminar el proyecto "${n.proyecto.nombre}"?`)&&$.delete(`/admin/proyectos/${n.proyecto.id}`,{onSuccess:()=>{D.success("Proyecto eliminado exitosamente")},onError:()=>{D.error("Error al eliminar el proyecto")}})},O=l=>({planificacion:K,en_progreso:Te,pausado:we,completado:Be,cancelado:be})[l]||Ae,x=l=>({planificacion:"bg-blue-100 text-blue-800",en_progreso:"bg-yellow-100 text-yellow-800",pausado:"bg-orange-100 text-orange-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[l]||"bg-gray-100 text-gray-800",u=l=>({baja:"bg-gray-100 text-gray-800",media:"bg-blue-100 text-blue-800",alta:"bg-orange-100 text-orange-800",critica:"bg-red-100 text-red-800"})[l]||"bg-gray-100 text-gray-800",y=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),b=l=>{const a=Math.floor((new Date(l).getTime()-new Date().getTime())/864e5);return a===0?"Hoy":a===1?"Mañana":a===-1?"Ayer":a>0?`En ${a} días`:`Hace ${Math.abs(a)} días`},E=async()=>{try{await C(n.proyecto.id,w.value),f.value=!1,D.success("Etiquetas actualizadas exitosamente"),$.reload({only:["proyecto"]})}catch{D.error("Error al actualizar las etiquetas")}},ae=()=>{var l;w.value=((l=n.proyecto.etiquetas)==null?void 0:l.map(a=>a.id))||[],f.value=!1},oe=l=>{$.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${l.id}`)},se=l=>{$.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${l.id}/edit`)},re=l=>{confirm(`¿Estás seguro de eliminar el hito "${l.nombre}"? Se eliminarán también todos sus entregables.`)&&$.delete(`/admin/proyectos/${n.proyecto.id}/hitos/${l.id}`,{onSuccess:()=>{D.success("Hito eliminado exitosamente"),$.reload({only:["proyecto"]})},onError:()=>{D.error("Error al eliminar el hito")}})},ie=l=>{$.post(`/admin/proyectos/${n.proyecto.id}/hitos/${l.id}/duplicar`,{},{onSuccess:()=>{D.success("Hito duplicado exitosamente"),$.reload({only:["proyecto"]})},onError:()=>{D.error("Error al duplicar el hito")}})},le=l=>{$.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${l.id}/entregables/create`)},ne=l=>{$.visit(`/admin/proyectos/${n.proyecto.id}/hitos/${l.id}/entregables`)},ce=L(()=>{let l=n.activities||[];return v.value.usuario_id&&(l=l.filter(a=>{var c;return((c=a.causer)==null?void 0:c.id)===v.value.usuario_id})),v.value.tipo_entidad&&(l=l.filter(a=>a.subject_type===v.value.tipo_entidad)),v.value.tipo_accion&&(l=l.filter(a=>a.event===v.value.tipo_accion)),(v.value.fecha_inicio||v.value.fecha_fin)&&(l=l.filter(a=>{const c=new Date(a.created_at);if(v.value.fecha_inicio){const k=new Date(v.value.fecha_inicio);if(c<k)return!1}if(v.value.fecha_fin){const k=new Date(v.value.fecha_fin);if(k.setHours(23,59,59,999),c>k)return!1}return!0})),l});return(l,a)=>(i(),h(F,null,[o(t(ue),{title:`Proyecto: ${e.proyecto.nombre}`},null,8,["title"]),o(de,{breadcrumbs:U},{default:r(()=>[s("div",et,[s("div",tt,[s("div",null,[s("h1",at,d(e.proyecto.nombre),1),e.proyecto.descripcion?(i(),h("p",ot,d(e.proyecto.descripcion),1)):p("",!0)]),s("div",st,[e.canEdit?(i(),g(t(B),{key:0,href:`/admin/proyectos/${e.proyecto.id}/edit`},{default:r(()=>[o(t(q),null,{default:r(()=>[o(t(X),{class:"mr-2 h-4 w-4"}),a[4]||(a[4]=m(" Editar ",-1))]),_:1})]),_:1},8,["href"])):p("",!0),e.canDelete?(i(),g(t(q),{key:1,variant:"destructive",onClick:G},{default:r(()=>[o(t(Ce),{class:"mr-2 h-4 w-4"}),a[5]||(a[5]=m(" Eliminar ",-1))]),_:1})):p("",!0)])]),o(t(fe),{modelValue:T.value,"onUpdate:modelValue":a[3]||(a[3]=c=>T.value=c),class:"w-full"},{default:r(()=>[o(t(ye),{class:"grid w-full grid-cols-5"},{default:r(()=>[o(t(M),{value:"general"},{default:r(()=>[o(t(Se),{class:"mr-2 h-4 w-4"}),a[6]||(a[6]=m(" General ",-1))]),_:1}),o(t(M),{value:"contratos"},{default:r(()=>{var c;return[o(t(Q),{class:"mr-2 h-4 w-4"}),a[7]||(a[7]=m(" Contratos ",-1)),(c=e.totales)!=null&&c.contratos?(i(),g(t(A),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:r(()=>[m(d(e.totales.contratos),1)]),_:1})):p("",!0)]}),_:1}),o(t(M),{value:"hitos"},{default:r(()=>{var c;return[o(t(xe),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=m(" Hitos y Entregables ",-1)),(c=e.totales)!=null&&c.hitos?(i(),g(t(A),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:r(()=>[m(d(e.totales.hitos),1)]),_:1})):p("",!0)]}),_:1}),o(t(M),{value:"evidencias"},{default:r(()=>{var c;return[o(t(He),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=m(" Evidencias ",-1)),(c=e.totales)!=null&&c.evidencias?(i(),g(t(A),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:r(()=>[m(d(e.totales.evidencias),1)]),_:1})):p("",!0)]}),_:1}),o(t(M),{value:"actividad"},{default:r(()=>[o(t(De),{class:"mr-2 h-4 w-4"}),a[10]||(a[10]=m(" Actividad ",-1))]),_:1})]),_:1}),o(t(N),{value:"general",class:"space-y-4 mt-6"},{default:r(()=>[o(t(H),null,{default:r(()=>[o(t(P),null,{default:r(()=>[o(t(V),null,{default:r(()=>[...a[11]||(a[11]=[m("Estado del Proyecto",-1)])]),_:1})]),_:1}),o(t(S),{class:"space-y-4"},{default:r(()=>[s("div",rt,[s("div",it,[(i(),g(me(O(e.proyecto.estado)),{class:"h-5 w-5 text-gray-500"})),a[12]||(a[12]=s("span",{class:"font-medium"},"Estado:",-1)),o(t(A),{class:_(x(e.proyecto.estado))},{default:r(()=>[m(d(e.proyecto.estado_label),1)]),_:1},8,["class"])]),s("div",lt,[o(t(Pe),{class:"h-5 w-5 text-gray-500"}),a[13]||(a[13]=s("span",{class:"font-medium"},"Prioridad:",-1)),o(t(A),{class:_(u(e.proyecto.prioridad))},{default:r(()=>[m(d(e.proyecto.prioridad_label),1)]),_:1},8,["class"])])]),s("div",nt,[s("div",ct,[a[14]||(a[14]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Progreso",-1)),s("span",dt,d(e.proyecto.porcentaje_completado)+"%",1)]),o(t(te),{"model-value":e.proyecto.porcentaje_completado,class:"h-2"},null,8,["model-value"])]),s("div",ut,[s("div",mt,[o(t(W),{class:"h-5 w-5 text-gray-500 mt-0.5"}),s("div",null,[a[15]||(a[15]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de inicio",-1)),s("p",ft,d(y(e.proyecto.fecha_inicio)),1),s("p",yt,d(b(e.proyecto.fecha_inicio)),1)])]),e.proyecto.fecha_fin?(i(),h("div",gt,[o(t(W),{class:"h-5 w-5 text-gray-500 mt-0.5"}),s("div",null,[a[16]||(a[16]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de fin",-1)),s("p",pt,d(y(e.proyecto.fecha_fin)),1),s("p",vt,d(b(e.proyecto.fecha_fin)),1)])])):p("",!0)]),e.proyecto.duracion_dias?(i(),h("div",xt,[o(t(Ve),{class:"h-5 w-5 text-gray-500"}),s("div",null,[a[17]||(a[17]=s("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Duración total:",-1)),s("span",ht,d(e.proyecto.duracion_dias)+" días",1)])])):p("",!0)]),_:1})]),_:1}),o(t(H),null,{default:r(()=>[o(t(P),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:r(()=>[o(t(V),null,{default:r(()=>[...a[18]||(a[18]=[m(" Etiquetas ",-1)])]),_:1}),e.canManageTags&&!f.value?(i(),g(t(q),{key:0,variant:"ghost",size:"sm",onClick:a[0]||(a[0]=c=>f.value=!0)},{default:r(()=>[o(t(X),{class:"h-4 w-4"})]),_:1})):p("",!0)]),_:1}),o(t(S),null,{default:r(()=>[f.value?(i(),h("div",Et,[e.categorias?(i(),g(pe,{key:0,modelValue:w.value,"onUpdate:modelValue":a[1]||(a[1]=c=>w.value=c),categorias:e.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas...",description:"Selecciona hasta 10 etiquetas para este proyecto"},null,8,["modelValue","categorias"])):p("",!0),s("div",$t,[o(t(q),{size:"sm",onClick:E,disabled:t(I)},{default:r(()=>[...a[19]||(a[19]=[m(" Guardar ",-1)])]),_:1},8,["disabled"]),o(t(q),{size:"sm",variant:"outline",onClick:ae,disabled:t(I)},{default:r(()=>[...a[20]||(a[20]=[m(" Cancelar ",-1)])]),_:1},8,["disabled"])])])):(i(),h("div",bt,[e.proyecto.etiquetas&&e.proyecto.etiquetas.length>0?(i(),g(ge,{key:0,etiquetas:e.proyecto.etiquetas,"show-categoria":!0,interactive:!0,size:"md"},null,8,["etiquetas"])):(i(),h("p",wt," No hay etiquetas asignadas "))]))]),_:1})]),_:1}),e.proyecto.campos_personalizados&&e.proyecto.campos_personalizados.length>0?(i(),g(t(H),{key:0},{default:r(()=>[o(t(P),null,{default:r(()=>[o(t(V),null,{default:r(()=>[...a[21]||(a[21]=[m("Campos Personalizados",-1)])]),_:1})]),_:1}),o(t(S),null,{default:r(()=>[s("div",kt,[(i(!0),h(F,null,J(e.proyecto.campos_personalizados,c=>{var k;return i(),h("div",{key:c.id,class:"py-2 border-b last:border-b-0"},[s("p",qt,d((k=c.campo_personalizado)==null?void 0:k.nombre),1),s("p",Ct,d(c.valor_formateado||c.valor||"-"),1)])}),128))])]),_:1})]),_:1})):p("",!0),o(t(H),null,{default:r(()=>[o(t(P),null,{default:r(()=>[o(t(V),null,{default:r(()=>[...a[22]||(a[22]=[m("Responsable",-1)])]),_:1})]),_:1}),o(t(S),null,{default:r(()=>[e.proyecto.responsable?(i(),h("div",St,[s("div",Ht,[o(t(Y),{class:"h-5 w-5 text-gray-500"})]),s("div",null,[s("p",Dt,d(e.proyecto.responsable.name),1),s("p",Pt,d(e.proyecto.responsable.email),1)])])):(i(),h("p",Vt,"Sin asignar"))]),_:1})]),_:1}),o(t(H),null,{default:r(()=>[o(t(P),null,{default:r(()=>[o(t(V),null,{default:r(()=>[...a[23]||(a[23]=[m("Información del Sistema",-1)])]),_:1})]),_:1}),o(t(S),{class:"space-y-3"},{default:r(()=>{var c;return[s("div",null,[a[24]||(a[24]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"ID del Proyecto",-1)),s("p",Bt,"#"+d(e.proyecto.id),1)]),s("div",null,[a[25]||(a[25]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado",-1)),o(t(A),{class:_(e.proyecto.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},{default:r(()=>[m(d(e.proyecto.activo?"Activo":"Inactivo"),1)]),_:1},8,["class"])]),s("div",null,[a[26]||(a[26]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Creado por",-1)),s("p",Tt,d(((c=e.proyecto.creador)==null?void 0:c.name)||"Sistema"),1)]),s("div",null,[a[27]||(a[27]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de creación",-1)),s("p",At,d(y(e.proyecto.created_at)),1)]),s("div",null,[a[28]||(a[28]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Última actualización",-1)),s("p",jt,d(y(e.proyecto.updated_at)),1)])]}),_:1})]),_:1}),e.proyecto.activities&&e.proyecto.activities.length>0?(i(),g(t(H),{key:1},{default:r(()=>[o(t(P),null,{default:r(()=>[o(t(V),null,{default:r(()=>[...a[29]||(a[29]=[m("Actividad Reciente",-1)])]),_:1})]),_:1}),o(t(S),null,{default:r(()=>[s("div",zt,[(i(!0),h(F,null,J(e.proyecto.activities,c=>{var k;return i(),h("div",{key:c.id,class:"flex items-start gap-3 pb-3 border-b last:border-b-0"},[s("div",Mt,[o(t(Y),{class:"h-4 w-4 text-gray-500"})]),s("div",Nt,[s("p",It,[s("span",_t,d(((k=c.causer)==null?void 0:k.name)||"Sistema"),1),m(" "+d(c.description),1)]),s("p",Ft,d(b(c.created_at)),1)])])}),128))])]),_:1})]),_:1})):p("",!0)]),_:1}),o(t(N),{value:"contratos",class:"space-y-4 mt-6"},{default:r(()=>[e.canCreateContracts?(i(),h("div",Lt,[o(t(B),{href:`/admin/contratos/create?proyecto_id=${e.proyecto.id}`},{default:r(()=>[o(t(q),null,{default:r(()=>[o(t(R),{class:"mr-2 h-4 w-4"}),a[30]||(a[30]=m(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])])):p("",!0),e.proyecto.contratos&&e.proyecto.contratos.length>0?(i(),g(t(H),{key:1},{default:r(()=>[o(t(P),null,{default:r(()=>[o(t(V),null,{default:r(()=>[...a[31]||(a[31]=[m("Contratos del Proyecto",-1)])]),_:1}),o(t(ee),null,{default:r(()=>[...a[32]||(a[32]=[m(" Lista de contratos asociados a este proyecto ",-1)])]),_:1})]),_:1}),o(t(S),null,{default:r(()=>[s("div",Rt,[o(ve,{contratos:e.proyecto.contratos,"show-proyecto":!1,"show-actions":!0,"actions-style":"buttons"},null,8,["contratos"])])]),_:1})]),_:1})):(i(),g(t(H),{key:2},{default:r(()=>[o(t(S),{class:"py-8"},{default:r(()=>[s("div",Ut,[o(t(Q),{class:"mx-auto h-12 w-12 text-gray-400"}),a[34]||(a[34]=s("p",{class:"mt-2 text-sm text-gray-600"},"No hay contratos asociados",-1)),e.canCreateContracts?(i(),g(t(B),{key:0,href:`/admin/contratos/create?proyecto_id=${e.proyecto.id}`,class:"mt-4 inline-block"},{default:r(()=>[o(t(q),{variant:"outline"},{default:r(()=>[o(t(R),{class:"mr-2 h-4 w-4"}),a[33]||(a[33]=m(" Crear primer contrato ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])]),_:1})]),_:1}))]),_:1}),o(t(N),{value:"hitos",class:"space-y-4 mt-6"},{default:r(()=>[e.canViewHitos?(i(),g(Ze,{key:0,hitos:e.proyecto.hitos||[],"proyecto-id":e.proyecto.id,estadisticas:e.estadisticasHitos,"show-stats":!0,"show-header":!0,"show-actions":!0,"show-view-all":!0,"can-create":e.canCreateHitos,"can-edit":e.canEditHitos,"can-delete":e.canDeleteHitos,"can-manage-deliverables":e.canManageEntregables,"empty-message":"No hay hitos definidos para este proyecto",onView:oe,onEdit:se,onDelete:re,onDuplicate:ie,onAddEntregable:le,onViewEntregables:ne},null,8,["hitos","proyecto-id","estadisticas","can-create","can-edit","can-delete","can-manage-deliverables"])):p("",!0)]),_:1}),o(t(N),{value:"evidencias",class:"space-y-4 mt-6"},{default:r(()=>[o(he,{contratos:e.proyecto.contratos||[],"proyecto-id":e.proyecto.id,modo:"admin","puede-gestionar-estado":z.value,"format-date":y},null,8,["contratos","proyecto-id","puede-gestionar-estado"])]),_:1}),o(t(N),{value:"actividad",class:"space-y-4 mt-6"},{default:r(()=>[e.activities&&e.activities.length>0?(i(),g(Ee,{key:0,modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=c=>v.value=c),usuarios:e.usuariosActividades,"context-level":"proyecto"},null,8,["modelValue","usuarios"])):p("",!0),o($e,{activities:ce.value,title:"Historial de Actividad",description:"Registro completo de cambios y eventos del proyecto, hitos y entregables","empty-message":"No hay actividad registrada"},null,8,["activities"])]),_:1})]),_:1},8,["modelValue"])])]),_:1})],64))}});export{Mo as default};
