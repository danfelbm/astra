import{r as U,p as xe,c as ne,d as _e,i as D,g as E,j as k,F as J,k as de,e as h,f as r,w as y,h as A,b as O,m as g,x as Ue,t as N,n as Z,l as st,ai as St,o as _n,B as qn,W as sn,a as Kn,a1 as Qn,s as $t,v as dn}from"./app-D295TwpG.js";import{g as Zn}from"./Input.vue_vue_type_script_setup_true_lang-BrdPP5Ww.js";import{_ as Dn,c as Sn,b as kn,a as Jn}from"./CardTitle.vue_vue_type_script_setup_true_lang-BxiJGsdC.js";import{c as Tn,_ as j}from"./createLucideIcon-D-eVYV0X.js";import{_ as ye}from"./index-pTKOFCV9.js";import{_ as cn}from"./Progress.vue_vue_type_script_setup_true_lang-F8q0aufm.js";import{_ as jt}from"./ScrollArea.vue_vue_type_script_setup_true_lang-D3qPf5Rm.js";import{_ as ea}from"./Separator.vue_vue_type_script_setup_true_lang-B80DBoq-.js";import{C as ta,_ as It,a as Ot,b as Pt,c as At,d as Ye}from"./SelectValue.vue_vue_type_script_setup_true_lang-BgxQu3ec.js";import{_ as na,a as aa,b as oa,c as la,d as ia,e as ra,f as sa,g as da}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BoU8BX2d.js";import{f as Xt,e as Gt}from"./es-BDPlFIsO.js";import{_ as ca}from"./StatusChangeModal.vue_vue_type_script_setup_true_lang-BFP0Erv4.js";import{_ as ua}from"./Switch.vue_vue_type_script_setup_true_lang-C96XcaL1.js";import{_ as fa}from"./Label.vue_vue_type_script_setup_true_lang-BJwJYrXW.js";import{L as ma}from"./list-Bx2T3jMD.js";import{L as ga,_ as $n,a as In}from"./useFlashMessages-BiQJq8LA.js";import{C as tt}from"./circle-alert-d8VqH1J6.js";import{C as kt}from"./circle-x-CE_9h50a.js";import{C as Pe}from"./clock-DN-ZQrgB.js";import{C as nt}from"./circle-check-big-GKWDCEY_.js";import{C as On}from"./chevron-right-G87vJ0iu.js";import{F as ha}from"./flag-B_GmGB5i.js";import{C as Wt}from"./calendar-CmZyVkh_.js";import{U as mt}from"./user-BAGTpZS5.js";import{E as pa}from"./eye-BCeC5IXc.js";import{S as qt}from"./square-pen-CYUVx_fI.js";import{M as Kt}from"./message-square-Cfm67azv.js";import{A as wt}from"./activity-Do6hnVOu.js";import{U as va}from"./users-Vb3jmSQ5.js";import{T as Pn}from"./trash-2-Dhclb-Fp.js";import{F as ba}from"./file-text-C-TiYlL7.js";import{_ as ya,a as wa,b as xa,c as Ea}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-DasIy7vT.js";import{_ as Ca}from"./ComentariosPanel.vue_vue_type_script_setup_true_lang-DO4P9MVw.js";import{_ as _a}from"./CardDescription.vue_vue_type_script_setup_true_lang-C5ihZYBK.js";import{_ as Nt}from"./Skeleton.vue_vue_type_script_setup_true_lang-DKx1h7W0.js";import{_ as Da}from"./ActivityLog.vue_vue_type_script_setup_true_lang-N7E5u-1b.js";import{R as Sa}from"./refresh-cw-Pc57zED6.js";import{T as un}from"./target-COXHheAd.js";import{E as fn}from"./external-link-C9WOeEFB.js";import{F as ka}from"./folder-open-RpPo5MZo.js";import{P as mn}from"./plus-BCXcPYTn.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Tn("Columns3Icon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=Tn("ListTodoIcon",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),je={VIEW_MODE:"entregables-view-mode",CONFIRM_ON_DRAG:"entregables-confirm-drag"},qe={pendiente:{label:"Pendiente",color:"text-gray-800",bgColor:"bg-gray-100",dotColor:"bg-gray-400"},en_progreso:{label:"En Progreso",color:"text-blue-800",bgColor:"bg-blue-100",dotColor:"bg-blue-500"},completado:{label:"Completado",color:"text-green-800",bgColor:"bg-green-100",dotColor:"bg-green-500"},cancelado:{label:"Cancelado",color:"text-red-800",bgColor:"bg-red-100",dotColor:"bg-red-500"}},gt={baja:{label:"Baja",color:"text-gray-600",bgColor:"bg-gray-100"},media:{label:"Media",color:"text-yellow-800",bgColor:"bg-yellow-100"},alta:{label:"Alta",color:"text-red-800",bgColor:"bg-red-100"}},Qt=["pendiente","en_progreso","completado","cancelado"];function at(e,t={}){const{defaultViewMode:a="list",defaultConfirmOnDrag:n=!0}=t,o=U(localStorage.getItem(je.VIEW_MODE)||a),l=U(localStorage.getItem(je.CONFIRM_ON_DRAG)!==null?localStorage.getItem(je.CONFIRM_ON_DRAG)==="true":n);xe(o,u=>{localStorage.setItem(je.VIEW_MODE,u)}),xe(l,u=>{localStorage.setItem(je.CONFIRM_ON_DRAG,String(u))});const i=ne(()=>({pendientes:e.value.filter(u=>u.estado==="pendiente"),en_progreso:e.value.filter(u=>u.estado==="en_progreso"),completados:e.value.filter(u=>u.estado==="completado"),cancelados:e.value.filter(u=>u.estado==="cancelado")}));return{viewMode:o,confirmOnDrag:l,entregablesAgrupados:i,getEstadoConfig:u=>qe[u]||qe.pendiente,getPrioridadConfig:u=>gt[u]||gt.baja,getEstadoColor:u=>{const x=qe[u];return x?`${x.bgColor} ${x.color}`:"bg-gray-100 text-gray-800"},getPrioridadColor:u=>{const x=gt[u];return x?`${x.bgColor} ${x.color}`:"bg-gray-100 text-gray-600"},formatDate:u=>u?Xt(new Date(u),"dd MMM yyyy",{locale:Gt}):"Sin fecha",formatDateTime:u=>u?Xt(new Date(u),"dd MMM yyyy 'a las' HH:mm",{locale:Gt}):"-",getDiasRestantes:u=>{if(!u)return null;const x=Math.ceil((new Date(u).getTime()-new Date().getTime())/(1e3*60*60*24));return x<0?`Vencido hace ${Math.abs(x)} días`:x===0?"Vence hoy":x===1?"Vence mañana":`${x} días`},isVencido:(u,x)=>!u||x==="completado"||x==="cancelado"?!1:new Date(u)<new Date}}const $a={class:"flex items-center justify-between gap-4 flex-wrap"},Ia={class:"flex gap-1 bg-muted p-1 rounded-lg"},Oa={class:"ml-1.5 hidden sm:inline text-xs"},Pa={key:0,class:"flex items-center gap-2"},Aa=_e({__name:"HitosViewModeToggle",props:{modelValue:{},confirmOnDrag:{type:Boolean}},emits:["update:modelValue","update:confirmOnDrag"],setup(e,{emit:t}){const a=t,n=[{value:"list",icon:ma,label:"Lista"},{value:"tabs",icon:ga,label:"Tabs"},{value:"kanban",icon:Ta,label:"Kanban"}];return(o,l)=>(g(),D("div",$a,[E("div",Ia,[(g(),D(J,null,de(n,i=>h(r(j),{key:i.value,variant:e.modelValue===i.value?"default":"ghost",size:"sm",class:"h-8 px-3",title:i.label,onClick:s=>a("update:modelValue",i.value)},{default:y(()=>[(g(),O(Ue(i.icon),{class:"h-4 w-4"})),E("span",Oa,N(i.label),1)]),_:2},1032,["variant","title","onClick"])),64))]),e.modelValue==="kanban"?(g(),D("div",Pa,[h(r(ua),{id:"confirm-drag","model-value":e.confirmOnDrag,"onUpdate:modelValue":l[0]||(l[0]=i=>a("update:confirmOnDrag",i))},null,8,["model-value"]),h(r(fa),{for:"confirm-drag",class:"text-sm text-muted-foreground cursor-pointer"},{default:y(()=>[...l[1]||(l[1]=[A(" Confirmar al arrastrar ",-1)])]),_:1})])):k("",!0)]))}}),Na={class:"flex items-start gap-2"},Ma={class:"flex-1 min-w-0"},Ra={class:"flex items-center gap-2 flex-wrap"},Ba={key:0,class:"mt-1.5 flex items-center gap-2 text-xs text-muted-foreground"},Fa={key:1,class:"flex items-center gap-1 truncate"},Ha={key:0,class:"flex gap-1 mt-2 pt-2 border-t"},Va={key:0,class:"ml-1"},za={key:1,class:"ml-8 mt-3 space-y-3"},Ua={key:0,class:"text-sm text-muted-foreground"},La={class:"flex flex-wrap gap-4 text-sm"},Ya={class:"flex items-center gap-1 text-muted-foreground"},ja={key:0,class:"flex items-center gap-1 text-muted-foreground"},Xa={key:1,class:"flex items-center gap-2"},Ga={class:"flex gap-1 flex-wrap"},Wa={key:2,class:"text-sm text-muted-foreground space-y-1"},qa={key:0,class:"flex items-center gap-1"},Ka={key:1,class:"flex items-center gap-1"},Qa={key:2,class:"italic mt-2"},Za={key:2,class:"flex items-center gap-1 mt-3 pt-3 border-t"},nn=_e({__name:"HitosEntregableCard",props:{entregable:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},expanded:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},variant:{default:"default"}},emits:["toggle-expand","view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const a=e,n=t,o=U([]),{getEstadoColor:l,getPrioridadColor:i,formatDate:s,formatDateTime:c,getDiasRestantes:d,isVencido:m}=at(o),p=ne(()=>qe[a.entregable.estado]),_=ne(()=>gt[a.entregable.prioridad]),f=ne(()=>d(a.entregable.fecha_fin)),w=ne(()=>m(a.entregable.fecha_fin,a.entregable.estado)),u=ne(()=>a.entregable.estado==="completado"),x=ne(()=>a.entregable.estado==="cancelado"),V=ne(()=>{switch(a.entregable.estado){case"completado":return nt;case"en_progreso":return Pe;case"cancelado":return kt;default:return tt}}),B=ne(()=>{const L="transition-all duration-150",C={en_progreso:"border-l-4 border-l-blue-500",completado:"border-l-4 border-l-green-500 bg-green-50/30",cancelado:"border-l-4 border-l-red-500 bg-red-50/30"},z=[L];return C[a.entregable.estado]&&z.push(C[a.entregable.estado]),a.draggable&&z.push("cursor-grab active:cursor-grabbing hover:shadow-md"),z.join(" ")});return(L,C)=>(g(),O(r(Dn),{class:Z(B.value),"data-id":e.entregable.id,"data-estado":e.entregable.estado},{default:y(()=>[h(r(Sn),{class:Z(e.variant==="kanban"?"p-3":"p-4")},{default:y(()=>[E("div",Na,[e.variant!=="kanban"?(g(),O(r(j),{key:0,variant:"ghost",size:"sm",class:"h-6 w-6 p-0 flex-shrink-0",onClick:C[0]||(C[0]=z=>n("toggle-expand"))},{default:y(()=>[e.expanded?(g(),O(r(ta),{key:1,class:"h-4 w-4"})):(g(),O(r(On),{key:0,class:"h-4 w-4"}))]),_:1})):k("",!0),e.variant==="kanban"?(g(),O(Ue(V.value),{key:1,class:Z(["h-4 w-4 flex-shrink-0 mt-0.5",p.value.color])},null,8,["class"])):k("",!0),E("div",Ma,[E("div",Ra,[E("h4",{class:Z(["font-medium truncate",{"line-through text-muted-foreground":u.value,"text-sm":e.variant==="kanban"}])},N(e.entregable.nombre),3),e.variant!=="kanban"?(g(),D(J,{key:0},[h(r(ye),{class:Z([r(i)(e.entregable.prioridad),"text-[10px] px-1.5"]),variant:"outline"},{default:y(()=>[A(N(_.value.label),1)]),_:1},8,["class"]),h(r(ye),{class:Z([r(l)(e.entregable.estado),"text-[10px] px-1.5"])},{default:y(()=>[A(N(p.value.label),1)]),_:1},8,["class"])],64)):k("",!0),e.variant==="kanban"&&e.entregable.prioridad==="alta"?(g(),O(r(ye),{key:1,class:"bg-red-100 text-red-800 text-[10px] px-1"},{default:y(()=>[h(r(ha),{class:"h-3 w-3"})]),_:1})):k("",!0)]),e.variant==="kanban"?(g(),D("div",Ba,[e.entregable.fecha_fin?(g(),D("span",{key:0,class:Z(["flex items-center gap-1",{"text-red-600":w.value}])},[h(r(Wt),{class:"h-3 w-3"}),A(" "+N(r(s)(e.entregable.fecha_fin)),1)],2)):k("",!0),e.entregable.responsable?(g(),D("span",Fa,[h(r(mt),{class:"h-3 w-3"}),A(" "+N(e.entregable.responsable.name),1)])):k("",!0)])):k("",!0)])]),e.variant==="kanban"?(g(),D("div",Ha,[h(r(j),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:C[1]||(C[1]=st(z=>n("view"),["stop"]))},{default:y(()=>[h(r(pa),{class:"h-3 w-3 mr-1"}),C[12]||(C[12]=A(" Ver ",-1))]),_:1}),h(r(j),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:C[2]||(C[2]=st(z=>n("edit"),["stop"]))},{default:y(()=>[h(r(qt),{class:"h-3 w-3 mr-1"}),C[13]||(C[13]=A(" Editar ",-1))]),_:1}),h(r(j),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:C[3]||(C[3]=st(z=>n("show-comentarios"),["stop"])),title:"Comentarios"},{default:y(()=>[h(r(Kt),{class:"h-3 w-3"}),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(g(),D("span",Va,N(e.entregable.comentarios_count),1)):k("",!0)]),_:1}),h(r(j),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:C[4]||(C[4]=st(z=>n("show-actividad"),["stop"])),title:"Actividad"},{default:y(()=>[h(r(wt),{class:"h-3 w-3"})]),_:1})])):k("",!0),e.expanded&&e.variant!=="kanban"?(g(),D("div",za,[e.entregable.descripcion?(g(),D("p",Ua,N(e.entregable.descripcion),1)):k("",!0),E("div",La,[E("div",Ya,[h(r(Wt),{class:"h-4 w-4"}),E("span",null,N(r(s)(e.entregable.fecha_inicio))+" - "+N(r(s)(e.entregable.fecha_fin)),1)]),e.entregable.responsable?(g(),D("div",ja,[h(r(mt),{class:"h-4 w-4"}),E("span",null,N(e.entregable.responsable.name),1)])):k("",!0),f.value?(g(),D("div",{key:1,class:Z(["flex items-center gap-1",{"text-red-600":w.value}])},[h(r(Pe),{class:"h-4 w-4"}),E("span",null,N(f.value),1)],2)):k("",!0)]),e.entregable.usuarios&&e.entregable.usuarios.length>0?(g(),D("div",Xa,[h(r(va),{class:"h-4 w-4 text-muted-foreground"}),E("div",Ga,[(g(!0),D(J,null,de(e.entregable.usuarios,z=>(g(),O(r(ye),{key:z.id,variant:"secondary",class:"text-xs"},{default:y(()=>[A(N(z.name),1)]),_:2},1024))),128))])])):k("",!0),u.value?(g(),D("div",Wa,[e.entregable.completado_at?(g(),D("div",qa,[h(r(Pe),{class:"h-3 w-3"}),E("span",null,"Completado: "+N(r(c)(e.entregable.completado_at)),1)])):k("",!0),e.entregable.completado_por_usuario?(g(),D("div",Ka,[h(r(mt),{class:"h-3 w-3"}),E("span",null,"Por: "+N(e.entregable.completado_por_usuario.name),1)])):k("",!0),e.entregable.observaciones_estado?(g(),D("p",Qa,' "'+N(e.entregable.observaciones_estado)+'" ',1)):k("",!0)])):k("",!0)])):k("",!0),e.variant==="default"&&(e.canEdit||e.canDelete||e.canComplete)?(g(),D("div",Za,[!u.value&&!x.value?(g(),D(J,{key:0},[e.canComplete?(g(),O(r(j),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:C[5]||(C[5]=z=>n("complete"))},{default:y(()=>[h(r(nt),{class:"h-3 w-3 mr-1"}),C[14]||(C[14]=A(" Completar ",-1))]),_:1})):k("",!0),e.canEdit&&e.entregable.estado==="pendiente"?(g(),O(r(j),{key:1,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:C[6]||(C[6]=z=>n("change-status","en_progreso"))},{default:y(()=>[h(r(Pe),{class:"h-3 w-3 mr-1"}),C[15]||(C[15]=A(" En progreso ",-1))]),_:1})):k("",!0)],64)):u.value?(g(),D(J,{key:1},[e.canEdit?(g(),O(r(j),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:C[7]||(C[7]=z=>n("change-status","pendiente"))},{default:y(()=>[h(r(tt),{class:"h-3 w-3 mr-1"}),C[16]||(C[16]=A(" Reabrir ",-1))]),_:1})):k("",!0)],64)):k("",!0),e.canEdit?(g(),O(r(j),{key:2,variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:C[8]||(C[8]=z=>n("edit"))},{default:y(()=>[h(r(qt),{class:"h-3 w-3 mr-1"}),C[17]||(C[17]=A(" Editar ",-1))]),_:1})):k("",!0),h(r(j),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:C[9]||(C[9]=z=>n("show-comentarios"))},{default:y(()=>[h(r(Kt),{class:"h-3 w-3 mr-1"}),C[18]||(C[18]=A(" Comentarios ",-1)),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(g(),O(r(ye),{key:0,variant:"secondary",class:"ml-1 text-xs"},{default:y(()=>[A(N(e.entregable.comentarios_count),1)]),_:1})):k("",!0)]),_:1}),h(r(j),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:C[10]||(C[10]=z=>n("show-actividad"))},{default:y(()=>[h(r(wt),{class:"h-3 w-3 mr-1"}),C[19]||(C[19]=A(" Actividad ",-1))]),_:1}),e.canDelete?(g(),O(r(j),{key:3,variant:"ghost",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50",onClick:C[11]||(C[11]=z=>n("delete"))},{default:y(()=>[h(r(Pn),{class:"h-3 w-3 mr-1"}),C[20]||(C[20]=A(" Eliminar ",-1))]),_:1})):k("",!0)])):k("",!0)]),_:1},8,["class"])]),_:1},8,["class","data-id","data-estado"]))}}),Ja={class:"space-y-6"},eo={key:0},to={class:"font-semibold mb-3 flex items-center gap-2"},no={class:"space-y-2"},ao={key:0,class:"text-center py-8"},oo=_e({__name:"HitosEntregablesList",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const a=e,n=t,o=St(a,"entregables"),{entregablesAgrupados:l}=at(o),i=U(new Set),s=_=>{i.value.has(_)?i.value.delete(_):i.value.add(_)},c=_=>i.value.has(_),d=_=>{n("complete",_)},m=(_,f)=>{n("change-status",_,f)},p=[{key:"pendientes",icon:tt,iconClass:"text-yellow-600",label:"Pendientes"},{key:"en_progreso",icon:Pe,iconClass:"text-blue-600",label:"En Progreso"},{key:"completados",icon:nt,iconClass:"text-green-600",label:"Completados"},{key:"cancelados",icon:kt,iconClass:"text-red-600",label:"Cancelados"}];return(_,f)=>(g(),D("div",Ja,[(g(),D(J,null,de(p,w=>(g(),D(J,{key:w.key},[r(l)[w.key].length>0?(g(),D("div",eo,[E("h3",to,[(g(),O(Ue(w.icon),{class:Z(["h-5 w-5",w.iconClass])},null,8,["class"])),A(" "+N(w.label)+" ("+N(r(l)[w.key].length)+") ",1)]),E("div",no,[(g(!0),D(J,null,de(r(l)[w.key],u=>(g(),O(nn,{key:u.id,entregable:u,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:c(u.id),variant:"default",onToggleExpand:x=>s(u.id),onEdit:x=>n("edit",u),onDelete:x=>n("delete",u),onComplete:x=>d(u),onChangeStatus:x=>m(u,x),onShowComentarios:x=>n("show-comentarios",u),onShowActividad:x=>n("show-actividad",u)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])])):k("",!0)],64))),64)),e.entregables.length===0?(g(),D("div",ao,[h(r(ba),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),f[0]||(f[0]=E("p",{class:"text-muted-foreground"},"No hay entregables asignados",-1))])):k("",!0)]))}}),lo={class:"hidden sm:inline text-xs"},io={key:0,class:"space-y-2"},ro={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},so={class:"text-muted-foreground text-sm"},co=_e({__name:"HitosEntregablesTabs",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const a=e,n=t,o=St(a,"entregables"),{entregablesAgrupados:l}=at(o),i=U(new Set),s=U("pendiente"),c=w=>{i.value.has(w)?i.value.delete(w):i.value.add(w)},d=w=>i.value.has(w),m={pendiente:{icon:tt,iconClass:"text-yellow-600",label:"Pendientes",key:"pendientes"},en_progreso:{icon:Pe,iconClass:"text-blue-600",label:"En Progreso",key:"en_progreso"},completado:{icon:nt,iconClass:"text-green-600",label:"Completados",key:"completados"},cancelado:{icon:kt,iconClass:"text-red-600",label:"Cancelados",key:"cancelados"}},p=w=>{n("complete",w)},_=(w,u)=>{n("change-status",w,u)},f=w=>{const u=m[w];return l.value[u.key]};return(w,u)=>(g(),O(r(ya),{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=x=>s.value=x),class:"w-full"},{default:y(()=>[h(r(wa),{class:"w-full grid grid-cols-4 h-auto"},{default:y(()=>[(g(!0),D(J,null,de(r(Qt),x=>(g(),O(r(xa),{key:x,value:x,class:"gap-1.5 py-2 px-2 data-[state=active]:bg-background"},{default:y(()=>[(g(),O(Ue(m[x].icon),{class:Z(["h-4 w-4 flex-shrink-0",m[x].iconClass])},null,8,["class"])),E("span",lo,N(m[x].label),1),h(r(ye),{variant:"secondary",class:"ml-1 text-xs px-1.5 py-0"},{default:y(()=>[A(N(f(x).length),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),(g(!0),D(J,null,de(r(Qt),x=>(g(),O(r(Ea),{key:x,value:x,class:"mt-4"},{default:y(()=>[f(x).length>0?(g(),D("div",io,[(g(!0),D(J,null,de(f(x),V=>(g(),O(nn,{key:V.id,entregable:V,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:d(V.id),variant:"default",onToggleExpand:B=>c(V.id),onEdit:B=>n("edit",V),onDelete:B=>n("delete",V),onComplete:B=>p(V),onChangeStatus:B=>_(V,B),onShowComentarios:B=>n("show-comentarios",V),onShowActividad:B=>n("show-actividad",V)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])):(g(),D("div",ro,[(g(),O(Ue(m[x].icon),{class:Z(["h-10 w-10 mx-auto mb-3",m[x].iconClass+"/50"])},null,8,["class"])),E("p",so," No hay entregables "+N(m[x].label.toLowerCase()),1)]))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))}});/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function gn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),a.push.apply(a,n)}return a}function Ce(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?gn(Object(a),!0).forEach(function(n){uo(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gn(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}function ht(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ht=function(t){return typeof t}:ht=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(e)}function uo(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Te(){return Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Te.apply(this,arguments)}function fo(e,t){if(e==null)return{};var a={},n=Object.keys(e),o,l;for(l=0;l<n.length;l++)o=n[l],!(t.indexOf(o)>=0)&&(a[o]=e[o]);return a}function mo(e,t){if(e==null)return{};var a=fo(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var go="1.15.6";function ke(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var $e=ke(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ot=ke(/Edge/i),hn=ke(/firefox/i),Ke=ke(/safari/i)&&!ke(/chrome/i)&&!ke(/android/i),an=ke(/iP(ad|od|hone)/i),An=ke(/chrome/i)&&ke(/android/i),Nn={capture:!1,passive:!1};function H(e,t,a){e.addEventListener(t,a,!$e&&Nn)}function F(e,t,a){e.removeEventListener(t,a,!$e&&Nn)}function xt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function Mn(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function be(e,t,a,n){if(e){a=a||document;do{if(t!=null&&(t[0]===">"?e.parentNode===a&&xt(e,t):xt(e,t))||n&&e===a)return e;if(e===a)break}while(e=Mn(e))}return null}var pn=/\s+/g;function fe(e,t,a){if(e&&t)if(e.classList)e.classList[a?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(pn," ").replace(" "+t+" "," ");e.className=(n+(a?" "+t:"")).replace(pn," ")}}function $(e,t,a){var n=e&&e.style;if(n){if(a===void 0)return document.defaultView&&document.defaultView.getComputedStyle?a=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(a=e.currentStyle),t===void 0?a:a[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=a+(typeof a=="string"?"":"px")}}function ze(e,t){var a="";if(typeof e=="string")a=e;else do{var n=$(e,"transform");n&&n!=="none"&&(a=n+" "+a)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(a)}function Rn(e,t,a){if(e){var n=e.getElementsByTagName(t),o=0,l=n.length;if(a)for(;o<l;o++)a(n[o],o);return n}return[]}function Ee(){var e=document.scrollingElement;return e||document.documentElement}function K(e,t,a,n,o){if(!(!e.getBoundingClientRect&&e!==window)){var l,i,s,c,d,m,p;if(e!==window&&e.parentNode&&e!==Ee()?(l=e.getBoundingClientRect(),i=l.top,s=l.left,c=l.bottom,d=l.right,m=l.height,p=l.width):(i=0,s=0,c=window.innerHeight,d=window.innerWidth,m=window.innerHeight,p=window.innerWidth),(t||a)&&e!==window&&(o=o||e.parentNode,!$e))do if(o&&o.getBoundingClientRect&&($(o,"transform")!=="none"||a&&$(o,"position")!=="static")){var _=o.getBoundingClientRect();i-=_.top+parseInt($(o,"border-top-width")),s-=_.left+parseInt($(o,"border-left-width")),c=i+l.height,d=s+l.width;break}while(o=o.parentNode);if(n&&e!==window){var f=ze(o||e),w=f&&f.a,u=f&&f.d;f&&(i/=u,s/=w,p/=w,m/=u,c=i+m,d=s+p)}return{top:i,left:s,bottom:c,right:d,width:p,height:m}}}function vn(e,t,a){for(var n=Ae(e,!0),o=K(e)[t];n;){var l=K(n)[a],i=void 0;if(i=o>=l,!i)return n;if(n===Ee())break;n=Ae(n,!1)}return!1}function Le(e,t,a,n){for(var o=0,l=0,i=e.children;l<i.length;){if(i[l].style.display!=="none"&&i[l]!==I.ghost&&(n||i[l]!==I.dragged)&&be(i[l],a.draggable,e,!1)){if(o===t)return i[l];o++}l++}return null}function on(e,t){for(var a=e.lastElementChild;a&&(a===I.ghost||$(a,"display")==="none"||t&&!xt(a,t));)a=a.previousElementSibling;return a||null}function he(e,t){var a=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==I.clone&&(!t||xt(e,t))&&a++;return a}function bn(e){var t=0,a=0,n=Ee();if(e)do{var o=ze(e),l=o.a,i=o.d;t+=e.scrollLeft*l,a+=e.scrollTop*i}while(e!==n&&(e=e.parentNode));return[t,a]}function ho(e,t){for(var a in e)if(e.hasOwnProperty(a)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[a][n])return Number(a)}return-1}function Ae(e,t){if(!e||!e.getBoundingClientRect)return Ee();var a=e,n=!1;do if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var o=$(a);if(a.clientWidth<a.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||a.clientHeight<a.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!a.getBoundingClientRect||a===document.body)return Ee();if(n||t)return a;n=!0}}while(a=a.parentNode);return Ee()}function po(e,t){if(e&&t)for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}function Rt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Qe;function Bn(e,t){return function(){if(!Qe){var a=arguments,n=this;a.length===1?e.call(n,a[0]):e.apply(n,a),Qe=setTimeout(function(){Qe=void 0},t)}}}function vo(){clearTimeout(Qe),Qe=void 0}function Fn(e,t,a){e.scrollLeft+=t,e.scrollTop+=a}function Hn(e){var t=window.Polymer,a=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):a?a(e).clone(!0)[0]:e.cloneNode(!0)}function Vn(e,t,a){var n={};return Array.from(e.children).forEach(function(o){var l,i,s,c;if(!(!be(o,t.draggable,e,!1)||o.animated||o===a)){var d=K(o);n.left=Math.min((l=n.left)!==null&&l!==void 0?l:1/0,d.left),n.top=Math.min((i=n.top)!==null&&i!==void 0?i:1/0,d.top),n.right=Math.max((s=n.right)!==null&&s!==void 0?s:-1/0,d.right),n.bottom=Math.max((c=n.bottom)!==null&&c!==void 0?c:-1/0,d.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var se="Sortable"+new Date().getTime();function bo(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(o){if(!($(o,"display")==="none"||o===I.ghost)){e.push({target:o,rect:K(o)});var l=Ce({},e[e.length-1].rect);if(o.thisAnimationDuration){var i=ze(o,!0);i&&(l.top-=i.f,l.left-=i.e)}o.fromRect=l}})}},addAnimationState:function(n){e.push(n)},removeAnimationState:function(n){e.splice(ho(e,{target:n}),1)},animateAll:function(n){var o=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var l=!1,i=0;e.forEach(function(s){var c=0,d=s.target,m=d.fromRect,p=K(d),_=d.prevFromRect,f=d.prevToRect,w=s.rect,u=ze(d,!0);u&&(p.top-=u.f,p.left-=u.e),d.toRect=p,d.thisAnimationDuration&&Rt(_,p)&&!Rt(m,p)&&(w.top-p.top)/(w.left-p.left)===(m.top-p.top)/(m.left-p.left)&&(c=wo(w,_,f,o.options)),Rt(p,m)||(d.prevFromRect=m,d.prevToRect=p,c||(c=o.options.animation),o.animate(d,w,p,c)),c&&(l=!0,i=Math.max(i,c),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},c),d.thisAnimationDuration=c)}),clearTimeout(t),l?t=setTimeout(function(){typeof n=="function"&&n()},i):typeof n=="function"&&n(),e=[]},animate:function(n,o,l,i){if(i){$(n,"transition",""),$(n,"transform","");var s=ze(this.el),c=s&&s.a,d=s&&s.d,m=(o.left-l.left)/(c||1),p=(o.top-l.top)/(d||1);n.animatingX=!!m,n.animatingY=!!p,$(n,"transform","translate3d("+m+"px,"+p+"px,0)"),this.forRepaintDummy=yo(n),$(n,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),$(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){$(n,"transition",""),$(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},i)}}}}function yo(e){return e.offsetWidth}function wo(e,t,a,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-a.top,2)+Math.pow(t.left-a.left,2))*n.animation}var Be=[],Bt={initializeByDefault:!0},lt={mount:function(t){for(var a in Bt)Bt.hasOwnProperty(a)&&!(a in t)&&(t[a]=Bt[a]);Be.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Be.push(t)},pluginEvent:function(t,a,n){var o=this;this.eventCanceled=!1,n.cancel=function(){o.eventCanceled=!0};var l=t+"Global";Be.forEach(function(i){a[i.pluginName]&&(a[i.pluginName][l]&&a[i.pluginName][l](Ce({sortable:a},n)),a.options[i.pluginName]&&a[i.pluginName][t]&&a[i.pluginName][t](Ce({sortable:a},n)))})},initializePlugins:function(t,a,n,o){Be.forEach(function(s){var c=s.pluginName;if(!(!t.options[c]&&!s.initializeByDefault)){var d=new s(t,a,t.options);d.sortable=t,d.options=t.options,t[c]=d,Te(n,d.defaults)}});for(var l in t.options)if(t.options.hasOwnProperty(l)){var i=this.modifyOption(t,l,t.options[l]);typeof i<"u"&&(t.options[l]=i)}},getEventProperties:function(t,a){var n={};return Be.forEach(function(o){typeof o.eventProperties=="function"&&Te(n,o.eventProperties.call(a[o.pluginName],t))}),n},modifyOption:function(t,a,n){var o;return Be.forEach(function(l){t[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[a]=="function"&&(o=l.optionListeners[a].call(t[l.pluginName],n))}),o}};function xo(e){var t=e.sortable,a=e.rootEl,n=e.name,o=e.targetEl,l=e.cloneEl,i=e.toEl,s=e.fromEl,c=e.oldIndex,d=e.newIndex,m=e.oldDraggableIndex,p=e.newDraggableIndex,_=e.originalEvent,f=e.putSortable,w=e.extraEventProperties;if(t=t||a&&a[se],!!t){var u,x=t.options,V="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!$e&&!ot?u=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(u=document.createEvent("Event"),u.initEvent(n,!0,!0)),u.to=i||a,u.from=s||a,u.item=o||a,u.clone=l,u.oldIndex=c,u.newIndex=d,u.oldDraggableIndex=m,u.newDraggableIndex=p,u.originalEvent=_,u.pullMode=f?f.lastPutMode:void 0;var B=Ce(Ce({},w),lt.getEventProperties(n,t));for(var L in B)u[L]=B[L];a&&a.dispatchEvent(u),x[V]&&x[V].call(t,u)}}var Eo=["evt"],re=function(t,a){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=n.evt,l=mo(n,Eo);lt.pluginEvent.bind(I)(t,a,Ce({dragEl:b,parentEl:W,ghostEl:M,rootEl:Y,nextEl:Re,lastDownEl:pt,cloneEl:X,cloneHidden:Oe,dragStarted:Xe,putSortable:te,activeSortable:I.active,originalEvent:o,oldIndex:Ve,oldDraggableIndex:Ze,newIndex:me,newDraggableIndex:Ie,hideGhostForTarget:Yn,unhideGhostForTarget:jn,cloneNowHidden:function(){Oe=!0},cloneNowShown:function(){Oe=!1},dispatchSortableEvent:function(s){ie({sortable:a,name:s,originalEvent:o})}},l))};function ie(e){xo(Ce({putSortable:te,cloneEl:X,targetEl:b,rootEl:Y,oldIndex:Ve,oldDraggableIndex:Ze,newIndex:me,newDraggableIndex:Ie},e))}var b,W,M,Y,Re,pt,X,Oe,Ve,me,Ze,Ie,dt,te,He=!1,Et=!1,Ct=[],Ne,ve,Ft,Ht,yn,wn,Xe,Fe,Je,et=!1,ct=!1,vt,le,Vt=[],Zt=!1,_t=[],Tt=typeof document<"u",ut=an,xn=ot||$e?"cssFloat":"float",Co=Tt&&!An&&!an&&"draggable"in document.createElement("div"),zn=(function(){if(Tt){if($e)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),Un=function(t,a){var n=$(t),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),l=Le(t,0,a),i=Le(t,1,a),s=l&&$(l),c=i&&$(i),d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+K(l).width,m=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+K(i).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&s.float&&s.float!=="none"){var p=s.float==="left"?"left":"right";return i&&(c.clear==="both"||c.clear===p)?"vertical":"horizontal"}return l&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||d>=o&&n[xn]==="none"||i&&n[xn]==="none"&&d+m>o)?"vertical":"horizontal"},_o=function(t,a,n){var o=n?t.left:t.top,l=n?t.right:t.bottom,i=n?t.width:t.height,s=n?a.left:a.top,c=n?a.right:a.bottom,d=n?a.width:a.height;return o===s||l===c||o+i/2===s+d/2},Do=function(t,a){var n;return Ct.some(function(o){var l=o[se].options.emptyInsertThreshold;if(!(!l||on(o))){var i=K(o),s=t>=i.left-l&&t<=i.right+l,c=a>=i.top-l&&a<=i.bottom+l;if(s&&c)return n=o}}),n},Ln=function(t){function a(l,i){return function(s,c,d,m){var p=s.options.group.name&&c.options.group.name&&s.options.group.name===c.options.group.name;if(l==null&&(i||p))return!0;if(l==null||l===!1)return!1;if(i&&l==="clone")return l;if(typeof l=="function")return a(l(s,c,d,m),i)(s,c,d,m);var _=(i?s:c).options.group.name;return l===!0||typeof l=="string"&&l===_||l.join&&l.indexOf(_)>-1}}var n={},o=t.group;(!o||ht(o)!="object")&&(o={name:o}),n.name=o.name,n.checkPull=a(o.pull,!0),n.checkPut=a(o.put),n.revertClone=o.revertClone,t.group=n},Yn=function(){!zn&&M&&$(M,"display","none")},jn=function(){!zn&&M&&$(M,"display","")};Tt&&!An&&document.addEventListener("click",function(e){if(Et)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Et=!1,!1},!0);var Me=function(t){if(b){t=t.touches?t.touches[0]:t;var a=Do(t.clientX,t.clientY);if(a){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);n.target=n.rootEl=a,n.preventDefault=void 0,n.stopPropagation=void 0,a[se]._onDragOver(n)}}},So=function(t){b&&b.parentNode[se]._isOutsideThisEl(t.target)};function I(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Te({},t),e[se]=this;var a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Un(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(i,s){i.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:I.supportPointer!==!1&&"PointerEvent"in window&&(!Ke||an),emptyInsertThreshold:5};lt.initializePlugins(this,e,a);for(var n in a)!(n in t)&&(t[n]=a[n]);Ln(t);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=t.forceFallback?!1:Co,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?H(e,"pointerdown",this._onTapStart):(H(e,"mousedown",this._onTapStart),H(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(H(e,"dragover",this),H(e,"dragenter",this)),Ct.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Te(this,bo())}I.prototype={constructor:I,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Fe=null)},_getDirection:function(t,a){return typeof this.options.direction=="function"?this.options.direction.call(this,t,a,b):this.options.direction},_onTapStart:function(t){if(t.cancelable){var a=this,n=this.el,o=this.options,l=o.preventOnFilter,i=t.type,s=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,c=(s||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||c,m=o.filter;if(No(n),!b&&!(/mousedown|pointerdown/.test(i)&&t.button!==0||o.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Ke&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=be(c,o.draggable,n,!1),!(c&&c.animated)&&pt!==c)){if(Ve=he(c),Ze=he(c,o.draggable),typeof m=="function"){if(m.call(this,t,c,this)){ie({sortable:a,rootEl:d,name:"filter",targetEl:c,toEl:n,fromEl:n}),re("filter",a,{evt:t}),l&&t.preventDefault();return}}else if(m&&(m=m.split(",").some(function(p){if(p=be(d,p.trim(),n,!1),p)return ie({sortable:a,rootEl:p,name:"filter",targetEl:c,fromEl:n,toEl:n}),re("filter",a,{evt:t}),!0}),m)){l&&t.preventDefault();return}o.handle&&!be(d,o.handle,n,!1)||this._prepareDragStart(t,s,c)}}},_prepareDragStart:function(t,a,n){var o=this,l=o.el,i=o.options,s=l.ownerDocument,c;if(n&&!b&&n.parentNode===l){var d=K(n);if(Y=l,b=n,W=b.parentNode,Re=b.nextSibling,pt=n,dt=i.group,I.dragged=b,Ne={target:b,clientX:(a||t).clientX,clientY:(a||t).clientY},yn=Ne.clientX-d.left,wn=Ne.clientY-d.top,this._lastX=(a||t).clientX,this._lastY=(a||t).clientY,b.style["will-change"]="all",c=function(){if(re("delayEnded",o,{evt:t}),I.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!hn&&o.nativeDraggable&&(b.draggable=!0),o._triggerDragStart(t,a),ie({sortable:o,name:"choose",originalEvent:t}),fe(b,i.chosenClass,!0)},i.ignore.split(",").forEach(function(m){Rn(b,m.trim(),zt)}),H(s,"dragover",Me),H(s,"mousemove",Me),H(s,"touchmove",Me),i.supportPointer?(H(s,"pointerup",o._onDrop),!this.nativeDraggable&&H(s,"pointercancel",o._onDrop)):(H(s,"mouseup",o._onDrop),H(s,"touchend",o._onDrop),H(s,"touchcancel",o._onDrop)),hn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,b.draggable=!0),re("delayStart",this,{evt:t}),i.delay&&(!i.delayOnTouchOnly||a)&&(!this.nativeDraggable||!(ot||$e))){if(I.eventCanceled){this._onDrop();return}i.supportPointer?(H(s,"pointerup",o._disableDelayedDrag),H(s,"pointercancel",o._disableDelayedDrag)):(H(s,"mouseup",o._disableDelayedDrag),H(s,"touchend",o._disableDelayedDrag),H(s,"touchcancel",o._disableDelayedDrag)),H(s,"mousemove",o._delayedDragTouchMoveHandler),H(s,"touchmove",o._delayedDragTouchMoveHandler),i.supportPointer&&H(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(c,i.delay)}else c()}},_delayedDragTouchMoveHandler:function(t){var a=t.touches?t.touches[0]:t;Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){b&&zt(b),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;F(t,"mouseup",this._disableDelayedDrag),F(t,"touchend",this._disableDelayedDrag),F(t,"touchcancel",this._disableDelayedDrag),F(t,"pointerup",this._disableDelayedDrag),F(t,"pointercancel",this._disableDelayedDrag),F(t,"mousemove",this._delayedDragTouchMoveHandler),F(t,"touchmove",this._delayedDragTouchMoveHandler),F(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,a){a=a||t.pointerType=="touch"&&t,!this.nativeDraggable||a?this.options.supportPointer?H(document,"pointermove",this._onTouchMove):a?H(document,"touchmove",this._onTouchMove):H(document,"mousemove",this._onTouchMove):(H(b,"dragend",this),H(Y,"dragstart",this._onDragStart));try{document.selection?bt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,a){if(He=!1,Y&&b){re("dragStarted",this,{evt:a}),this.nativeDraggable&&H(document,"dragover",So);var n=this.options;!t&&fe(b,n.dragClass,!1),fe(b,n.ghostClass,!0),I.active=this,t&&this._appendGhost(),ie({sortable:this,name:"start",originalEvent:a})}else this._nulling()},_emulateDragOver:function(){if(ve){this._lastX=ve.clientX,this._lastY=ve.clientY,Yn();for(var t=document.elementFromPoint(ve.clientX,ve.clientY),a=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ve.clientX,ve.clientY),t!==a);)a=t;if(b.parentNode[se]._isOutsideThisEl(t),a)do{if(a[se]){var n=void 0;if(n=a[se]._onDragOver({clientX:ve.clientX,clientY:ve.clientY,target:t,rootEl:a}),n&&!this.options.dragoverBubble)break}t=a}while(a=Mn(a));jn()}},_onTouchMove:function(t){if(Ne){var a=this.options,n=a.fallbackTolerance,o=a.fallbackOffset,l=t.touches?t.touches[0]:t,i=M&&ze(M,!0),s=M&&i&&i.a,c=M&&i&&i.d,d=ut&&le&&bn(le),m=(l.clientX-Ne.clientX+o.x)/(s||1)+(d?d[0]-Vt[0]:0)/(s||1),p=(l.clientY-Ne.clientY+o.y)/(c||1)+(d?d[1]-Vt[1]:0)/(c||1);if(!I.active&&!He){if(n&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(M){i?(i.e+=m-(Ft||0),i.f+=p-(Ht||0)):i={a:1,b:0,c:0,d:1,e:m,f:p};var _="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");$(M,"webkitTransform",_),$(M,"mozTransform",_),$(M,"msTransform",_),$(M,"transform",_),Ft=m,Ht=p,ve=l}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!M){var t=this.options.fallbackOnBody?document.body:Y,a=K(b,!0,ut,!0,t),n=this.options;if(ut){for(le=t;$(le,"position")==="static"&&$(le,"transform")==="none"&&le!==document;)le=le.parentNode;le!==document.body&&le!==document.documentElement?(le===document&&(le=Ee()),a.top+=le.scrollTop,a.left+=le.scrollLeft):le=Ee(),Vt=bn(le)}M=b.cloneNode(!0),fe(M,n.ghostClass,!1),fe(M,n.fallbackClass,!0),fe(M,n.dragClass,!0),$(M,"transition",""),$(M,"transform",""),$(M,"box-sizing","border-box"),$(M,"margin",0),$(M,"top",a.top),$(M,"left",a.left),$(M,"width",a.width),$(M,"height",a.height),$(M,"opacity","0.8"),$(M,"position",ut?"absolute":"fixed"),$(M,"zIndex","100000"),$(M,"pointerEvents","none"),I.ghost=M,t.appendChild(M),$(M,"transform-origin",yn/parseInt(M.style.width)*100+"% "+wn/parseInt(M.style.height)*100+"%")}},_onDragStart:function(t,a){var n=this,o=t.dataTransfer,l=n.options;if(re("dragStart",this,{evt:t}),I.eventCanceled){this._onDrop();return}re("setupClone",this),I.eventCanceled||(X=Hn(b),X.removeAttribute("id"),X.draggable=!1,X.style["will-change"]="",this._hideClone(),fe(X,this.options.chosenClass,!1),I.clone=X),n.cloneId=bt(function(){re("clone",n),!I.eventCanceled&&(n.options.removeCloneOnHide||Y.insertBefore(X,b),n._hideClone(),ie({sortable:n,name:"clone"}))}),!a&&fe(b,l.dragClass,!0),a?(Et=!0,n._loopId=setInterval(n._emulateDragOver,50)):(F(document,"mouseup",n._onDrop),F(document,"touchend",n._onDrop),F(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",l.setData&&l.setData.call(n,o,b)),H(document,"drop",n),$(b,"transform","translateZ(0)")),He=!0,n._dragStartId=bt(n._dragStarted.bind(n,a,t)),H(document,"selectstart",n),Xe=!0,window.getSelection().removeAllRanges(),Ke&&$(document.body,"user-select","none")},_onDragOver:function(t){var a=this.el,n=t.target,o,l,i,s=this.options,c=s.group,d=I.active,m=dt===c,p=s.sort,_=te||d,f,w=this,u=!1;if(Zt)return;function x(we,it){re(we,w,Ce({evt:t,isOwner:m,axis:f?"vertical":"horizontal",revert:i,dragRect:o,targetRect:l,canSort:p,fromSortable:_,target:n,completed:B,onMove:function(v,ee){return ft(Y,a,b,o,v,K(v),t,ee)},changed:L},it))}function V(){x("dragOverAnimationCapture"),w.captureAnimationState(),w!==_&&_.captureAnimationState()}function B(we){return x("dragOverCompleted",{insertion:we}),we&&(m?d._hideClone():d._showClone(w),w!==_&&(fe(b,te?te.options.ghostClass:d.options.ghostClass,!1),fe(b,s.ghostClass,!0)),te!==w&&w!==I.active?te=w:w===I.active&&te&&(te=null),_===w&&(w._ignoreWhileAnimating=n),w.animateAll(function(){x("dragOverAnimationComplete"),w._ignoreWhileAnimating=null}),w!==_&&(_.animateAll(),_._ignoreWhileAnimating=null)),(n===b&&!b.animated||n===a&&!n.animated)&&(Fe=null),!s.dragoverBubble&&!t.rootEl&&n!==document&&(b.parentNode[se]._isOutsideThisEl(t.target),!we&&Me(t)),!s.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),u=!0}function L(){me=he(b),Ie=he(b,s.draggable),ie({sortable:w,name:"change",toEl:a,newIndex:me,newDraggableIndex:Ie,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=be(n,s.draggable,a,!0),x("dragOver"),I.eventCanceled)return u;if(b.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||w._ignoreWhileAnimating===n)return B(!1);if(Et=!1,d&&!s.disabled&&(m?p||(i=W!==Y):te===this||(this.lastPutMode=dt.checkPull(this,d,b,t))&&c.checkPut(this,d,b,t))){if(f=this._getDirection(t,n)==="vertical",o=K(b),x("dragOverValid"),I.eventCanceled)return u;if(i)return W=Y,V(),this._hideClone(),x("revert"),I.eventCanceled||(Re?Y.insertBefore(b,Re):Y.appendChild(b)),B(!0);var C=on(a,s.draggable);if(!C||Io(t,f,this)&&!C.animated){if(C===b)return B(!1);if(C&&a===t.target&&(n=C),n&&(l=K(n)),ft(Y,a,b,o,n,l,t,!!n)!==!1)return V(),C&&C.nextSibling?a.insertBefore(b,C.nextSibling):a.appendChild(b),W=a,L(),B(!0)}else if(C&&$o(t,f,this)){var z=Le(a,0,s,!0);if(z===b)return B(!1);if(n=z,l=K(n),ft(Y,a,b,o,n,l,t,!1)!==!1)return V(),a.insertBefore(b,z),W=a,L(),B(!0)}else if(n.parentNode===a){l=K(n);var ae=0,ce,De=b.parentNode!==a,Q=!_o(b.animated&&b.toRect||o,n.animated&&n.toRect||l,f),pe=f?"top":"left",ge=vn(n,"top","top")||vn(b,"top","top"),Se=ge?ge.scrollTop:void 0;Fe!==n&&(ce=l[pe],et=!1,ct=!Q&&s.invertSwap||De),ae=Oo(t,n,l,f,Q?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,ct,Fe===n);var T;if(ae!==0){var R=he(b);do R-=ae,T=W.children[R];while(T&&($(T,"display")==="none"||T===M))}if(ae===0||T===n)return B(!1);Fe=n,Je=ae;var ue=n.nextElementSibling,oe=!1;oe=ae===1;var G=ft(Y,a,b,o,n,l,t,oe);if(G!==!1)return(G===1||G===-1)&&(oe=G===1),Zt=!0,setTimeout(To,30),V(),oe&&!ue?a.appendChild(b):n.parentNode.insertBefore(b,oe?ue:n),ge&&Fn(ge,0,Se-ge.scrollTop),W=b.parentNode,ce!==void 0&&!ct&&(vt=Math.abs(ce-K(n)[pe])),L(),B(!0)}if(a.contains(b))return B(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){F(document,"mousemove",this._onTouchMove),F(document,"touchmove",this._onTouchMove),F(document,"pointermove",this._onTouchMove),F(document,"dragover",Me),F(document,"mousemove",Me),F(document,"touchmove",Me)},_offUpEvents:function(){var t=this.el.ownerDocument;F(t,"mouseup",this._onDrop),F(t,"touchend",this._onDrop),F(t,"pointerup",this._onDrop),F(t,"pointercancel",this._onDrop),F(t,"touchcancel",this._onDrop),F(document,"selectstart",this)},_onDrop:function(t){var a=this.el,n=this.options;if(me=he(b),Ie=he(b,n.draggable),re("drop",this,{evt:t}),W=b&&b.parentNode,me=he(b),Ie=he(b,n.draggable),I.eventCanceled){this._nulling();return}He=!1,ct=!1,et=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Jt(this.cloneId),Jt(this._dragStartId),this.nativeDraggable&&(F(document,"drop",this),F(a,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ke&&$(document.body,"user-select",""),$(b,"transform",""),t&&(Xe&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),M&&M.parentNode&&M.parentNode.removeChild(M),(Y===W||te&&te.lastPutMode!=="clone")&&X&&X.parentNode&&X.parentNode.removeChild(X),b&&(this.nativeDraggable&&F(b,"dragend",this),zt(b),b.style["will-change"]="",Xe&&!He&&fe(b,te?te.options.ghostClass:this.options.ghostClass,!1),fe(b,this.options.chosenClass,!1),ie({sortable:this,name:"unchoose",toEl:W,newIndex:null,newDraggableIndex:null,originalEvent:t}),Y!==W?(me>=0&&(ie({rootEl:W,name:"add",toEl:W,fromEl:Y,originalEvent:t}),ie({sortable:this,name:"remove",toEl:W,originalEvent:t}),ie({rootEl:W,name:"sort",toEl:W,fromEl:Y,originalEvent:t}),ie({sortable:this,name:"sort",toEl:W,originalEvent:t})),te&&te.save()):me!==Ve&&me>=0&&(ie({sortable:this,name:"update",toEl:W,originalEvent:t}),ie({sortable:this,name:"sort",toEl:W,originalEvent:t})),I.active&&((me==null||me===-1)&&(me=Ve,Ie=Ze),ie({sortable:this,name:"end",toEl:W,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){re("nulling",this),Y=b=W=M=Re=X=pt=Oe=Ne=ve=Xe=me=Ie=Ve=Ze=Fe=Je=te=dt=I.dragged=I.ghost=I.clone=I.active=null,_t.forEach(function(t){t.checked=!0}),_t.length=Ft=Ht=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":b&&(this._onDragOver(t),ko(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],a,n=this.el.children,o=0,l=n.length,i=this.options;o<l;o++)a=n[o],be(a,i.draggable,this.el,!1)&&t.push(a.getAttribute(i.dataIdAttr)||Ao(a));return t},sort:function(t,a){var n={},o=this.el;this.toArray().forEach(function(l,i){var s=o.children[i];be(s,this.options.draggable,o,!1)&&(n[l]=s)},this),a&&this.captureAnimationState(),t.forEach(function(l){n[l]&&(o.removeChild(n[l]),o.appendChild(n[l]))}),a&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,a){return be(t,a||this.options.draggable,this.el,!1)},option:function(t,a){var n=this.options;if(a===void 0)return n[t];var o=lt.modifyOption(this,t,a);typeof o<"u"?n[t]=o:n[t]=a,t==="group"&&Ln(n)},destroy:function(){re("destroy",this);var t=this.el;t[se]=null,F(t,"mousedown",this._onTapStart),F(t,"touchstart",this._onTapStart),F(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(F(t,"dragover",this),F(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ct.splice(Ct.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!Oe){if(re("hideClone",this),I.eventCanceled)return;$(X,"display","none"),this.options.removeCloneOnHide&&X.parentNode&&X.parentNode.removeChild(X),Oe=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(Oe){if(re("showClone",this),I.eventCanceled)return;b.parentNode==Y&&!this.options.group.revertClone?Y.insertBefore(X,b):Re?Y.insertBefore(X,Re):Y.appendChild(X),this.options.group.revertClone&&this.animate(b,X),$(X,"display",""),Oe=!1}}};function ko(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function ft(e,t,a,n,o,l,i,s){var c,d=e[se],m=d.options.onMove,p;return window.CustomEvent&&!$e&&!ot?c=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(c=document.createEvent("Event"),c.initEvent("move",!0,!0)),c.to=t,c.from=e,c.dragged=a,c.draggedRect=n,c.related=o||t,c.relatedRect=l||K(t),c.willInsertAfter=s,c.originalEvent=i,e.dispatchEvent(c),m&&(p=m.call(d,c,i)),p}function zt(e){e.draggable=!1}function To(){Zt=!1}function $o(e,t,a){var n=K(Le(a.el,0,a.options,!0)),o=Vn(a.el,a.options,M),l=10;return t?e.clientX<o.left-l||e.clientY<n.top&&e.clientX<n.right:e.clientY<o.top-l||e.clientY<n.bottom&&e.clientX<n.left}function Io(e,t,a){var n=K(on(a.el,a.options.draggable)),o=Vn(a.el,a.options,M),l=10;return t?e.clientX>o.right+l||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>o.bottom+l||e.clientX>n.right&&e.clientY>n.top}function Oo(e,t,a,n,o,l,i,s){var c=n?e.clientY:e.clientX,d=n?a.height:a.width,m=n?a.top:a.left,p=n?a.bottom:a.right,_=!1;if(!i){if(s&&vt<d*o){if(!et&&(Je===1?c>m+d*l/2:c<p-d*l/2)&&(et=!0),et)_=!0;else if(Je===1?c<m+vt:c>p-vt)return-Je}else if(c>m+d*(1-o)/2&&c<p-d*(1-o)/2)return Po(t)}return _=_||i,_&&(c<m+d*l/2||c>p-d*l/2)?c>m+d/2?1:-1:0}function Po(e){return he(b)<he(e)?1:-1}function Ao(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,a=t.length,n=0;a--;)n+=t.charCodeAt(a);return n.toString(36)}function No(e){_t.length=0;for(var t=e.getElementsByTagName("input"),a=t.length;a--;){var n=t[a];n.checked&&_t.push(n)}}function bt(e){return setTimeout(e,0)}function Jt(e){return clearTimeout(e)}Tt&&H(document,"touchmove",function(e){(I.active||He)&&e.cancelable&&e.preventDefault()});I.utils={on:H,off:F,css:$,find:Rn,is:function(t,a){return!!be(t,a,t,!1)},extend:po,throttle:Bn,closest:be,toggleClass:fe,clone:Hn,index:he,nextTick:bt,cancelNextTick:Jt,detectDirection:Un,getChild:Le,expando:se};I.get=function(e){return e[se]};I.mount=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(I.utils=Ce(Ce({},I.utils),n.utils)),lt.mount(n)})};I.create=function(e,t){return new I(e,t)};I.version=go;var q=[],Ge,en,tn=!1,Ut,Lt,Dt,We;function Mo(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(a){var n=a.originalEvent;this.sortable.nativeDraggable?H(document,"dragover",this._handleAutoScroll):this.options.supportPointer?H(document,"pointermove",this._handleFallbackAutoScroll):n.touches?H(document,"touchmove",this._handleFallbackAutoScroll):H(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(a){var n=a.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?F(document,"dragover",this._handleAutoScroll):(F(document,"pointermove",this._handleFallbackAutoScroll),F(document,"touchmove",this._handleFallbackAutoScroll),F(document,"mousemove",this._handleFallbackAutoScroll)),En(),yt(),vo()},nulling:function(){Dt=en=Ge=tn=We=Ut=Lt=null,q.length=0},_handleFallbackAutoScroll:function(a){this._handleAutoScroll(a,!0)},_handleAutoScroll:function(a,n){var o=this,l=(a.touches?a.touches[0]:a).clientX,i=(a.touches?a.touches[0]:a).clientY,s=document.elementFromPoint(l,i);if(Dt=a,n||this.options.forceAutoScrollFallback||ot||$e||Ke){Yt(a,this.options,s,n);var c=Ae(s,!0);tn&&(!We||l!==Ut||i!==Lt)&&(We&&En(),We=setInterval(function(){var d=Ae(document.elementFromPoint(l,i),!0);d!==c&&(c=d,yt()),Yt(a,o.options,d,n)},10),Ut=l,Lt=i)}else{if(!this.options.bubbleScroll||Ae(s,!0)===Ee()){yt();return}Yt(a,this.options,Ae(s,!1),!1)}}},Te(e,{pluginName:"scroll",initializeByDefault:!0})}function yt(){q.forEach(function(e){clearInterval(e.pid)}),q=[]}function En(){clearInterval(We)}var Yt=Bn(function(e,t,a,n){if(t.scroll){var o=(e.touches?e.touches[0]:e).clientX,l=(e.touches?e.touches[0]:e).clientY,i=t.scrollSensitivity,s=t.scrollSpeed,c=Ee(),d=!1,m;en!==a&&(en=a,yt(),Ge=t.scroll,m=t.scrollFn,Ge===!0&&(Ge=Ae(a,!0)));var p=0,_=Ge;do{var f=_,w=K(f),u=w.top,x=w.bottom,V=w.left,B=w.right,L=w.width,C=w.height,z=void 0,ae=void 0,ce=f.scrollWidth,De=f.scrollHeight,Q=$(f),pe=f.scrollLeft,ge=f.scrollTop;f===c?(z=L<ce&&(Q.overflowX==="auto"||Q.overflowX==="scroll"||Q.overflowX==="visible"),ae=C<De&&(Q.overflowY==="auto"||Q.overflowY==="scroll"||Q.overflowY==="visible")):(z=L<ce&&(Q.overflowX==="auto"||Q.overflowX==="scroll"),ae=C<De&&(Q.overflowY==="auto"||Q.overflowY==="scroll"));var Se=z&&(Math.abs(B-o)<=i&&pe+L<ce)-(Math.abs(V-o)<=i&&!!pe),T=ae&&(Math.abs(x-l)<=i&&ge+C<De)-(Math.abs(u-l)<=i&&!!ge);if(!q[p])for(var R=0;R<=p;R++)q[R]||(q[R]={});(q[p].vx!=Se||q[p].vy!=T||q[p].el!==f)&&(q[p].el=f,q[p].vx=Se,q[p].vy=T,clearInterval(q[p].pid),(Se!=0||T!=0)&&(d=!0,q[p].pid=setInterval((function(){n&&this.layer===0&&I.active._onTouchMove(Dt);var ue=q[this.layer].vy?q[this.layer].vy*s:0,oe=q[this.layer].vx?q[this.layer].vx*s:0;typeof m=="function"&&m.call(I.dragged.parentNode[se],oe,ue,e,Dt,q[this.layer].el)!=="continue"||Fn(q[this.layer].el,oe,ue)}).bind({layer:p}),24))),p++}while(t.bubbleScroll&&_!==c&&(_=Ae(_,!1)));tn=d}},30),Xn=function(t){var a=t.originalEvent,n=t.putSortable,o=t.dragEl,l=t.activeSortable,i=t.dispatchSortableEvent,s=t.hideGhostForTarget,c=t.unhideGhostForTarget;if(a){var d=n||l;s();var m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:a,p=document.elementFromPoint(m.clientX,m.clientY);c(),d&&!d.el.contains(p)&&(i("spill"),this.onSpill({dragEl:o,putSortable:n}))}};function ln(){}ln.prototype={startIndex:null,dragStart:function(t){var a=t.oldDraggableIndex;this.startIndex=a},onSpill:function(t){var a=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var o=Le(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(a,o):this.sortable.el.appendChild(a),this.sortable.animateAll(),n&&n.animateAll()},drop:Xn};Te(ln,{pluginName:"revertOnSpill"});function rn(){}rn.prototype={onSpill:function(t){var a=t.dragEl,n=t.putSortable,o=n||this.sortable;o.captureAnimationState(),a.parentNode&&a.parentNode.removeChild(a),o.animateAll()},drop:Xn};Te(rn,{pluginName:"removeOnSpill"});I.mount(new Mo);I.mount(rn,ln);const Ro=["data-estado"],Bo={class:"p-3 border-b bg-background/50 rounded-t-lg"},Fo={class:"flex items-center gap-2"},Ho={class:"font-medium text-sm"},Vo=["data-estado"],zo={key:0,class:"h-20 border-2 border-dashed border-muted-foreground/20 rounded-lg flex items-center justify-center text-sm text-muted-foreground"},Uo=_e({__name:"HitosKanbanColumn",props:{estado:{},entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},isDragOver:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const a=e,n=t,o=ne(()=>qe[a.estado]),l=ne(()=>{switch(a.estado){case"completado":return nt;case"en_progreso":return Pe;case"cancelado":return kt;default:return tt}}),i=ne(()=>{const s="flex flex-col rounded-lg border bg-muted/30 min-h-[300px] transition-colors duration-150",c=a.isDragOver?"border-primary border-dashed bg-primary/5":"border-border";return`${s} ${c}`});return(s,c)=>(g(),D("div",{class:Z(i.value),"data-estado":e.estado},[E("div",Bo,[E("div",Fo,[(g(),O(Ue(l.value),{class:Z(["h-4 w-4 flex-shrink-0",o.value.color])},null,8,["class"])),E("span",Ho,N(o.value.label),1),h(r(ye),{variant:"secondary",class:"ml-auto text-xs"},{default:y(()=>[A(N(e.entregables.length),1)]),_:1})])]),h(r(jt),{class:"flex-1 p-2"},{default:y(()=>[E("div",{class:"kanban-column-cards space-y-2 min-h-[200px]","data-estado":e.estado},[(g(!0),D(J,null,de(e.entregables,d=>(g(),O(nn,{key:d.id,entregable:d,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,draggable:e.canDrag,variant:"kanban",onView:m=>n("view",d),onEdit:m=>n("edit",d),onDelete:m=>n("delete",d),onComplete:m=>n("complete",d),onChangeStatus:m=>n("change-status",d,m),onShowComentarios:m=>n("show-comentarios",d),onShowActividad:m=>n("show-actividad",d)},null,8,["entregable","can-edit","can-delete","can-complete","draggable","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128)),e.entregables.length===0?(g(),D("div",zo," Sin entregables ")):k("",!0)],8,Vo)]),_:1})],10,Ro))}}),Lo={class:"kanban-container flex gap-4 overflow-x-auto snap-x snap-mandatory pb-4 px-1 min-w-0"},Yo=_e({__name:"HitosEntregablesKanban",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},confirmOnDrag:{type:Boolean,default:!0}},emits:["view","edit","delete","complete","change-status","drag-change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const a=e,n=t,o=St(a,"entregables"),{entregablesAgrupados:l}=at(o),i=U(null),s=U([]),c={pendiente:"pendientes",en_progreso:"en_progreso",completado:"completados",cancelado:"cancelados"},d=_=>l.value[c[_]],m=()=>{p(),a.canDrag&&sn(()=>{document.querySelectorAll(".kanban-column-cards").forEach(f=>{const w=I.create(f,{group:"entregables-kanban",animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",delay:100,delayOnTouchOnly:!0,touchStartThreshold:3,onStart:()=>{},onEnd:u=>{const x=parseInt(u.item.dataset.id||"0"),V=u.to.dataset.estado,B=u.from.dataset.estado;if(i.value=null,V===B)return;const L=a.entregables.find(C=>C.id===x);L&&n("drag-change-status",L,V)},onChange:u=>{const x=u.to.dataset.estado;x&&(i.value=x)}});s.value.push(w)})})},p=()=>{s.value.forEach(_=>{_.destroy()}),s.value=[]};return _n(()=>{m()}),qn(()=>{p()}),xe(()=>a.entregables,()=>{sn(()=>{m()})},{deep:!0}),(_,f)=>(g(),D("div",Lo,[(g(!0),D(J,null,de(r(Qt),w=>(g(),D("div",{key:w,class:"kanban-column flex-shrink-0 w-72 snap-center"},[h(Uo,{estado:w,entregables:d(w),"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canDrag,"is-drag-over":i.value===w,onView:f[0]||(f[0]=u=>n("view",u)),onEdit:f[1]||(f[1]=u=>n("edit",u)),onDelete:f[2]||(f[2]=u=>n("delete",u)),onComplete:f[3]||(f[3]=u=>n("complete",u)),onChangeStatus:f[4]||(f[4]=(u,x)=>n("change-status",u,x)),onShowComentarios:f[5]||(f[5]=u=>n("show-comentarios",u)),onShowActividad:f[6]||(f[6]=u=>n("show-actividad",u))},null,8,["estado","entregables","can-edit","can-delete","can-complete","can-drag","is-drag-over"])]))),128))]))}}),jo={class:"mt-6"},Gn=_e({__name:"ComentariosSheet",props:{open:{type:Boolean},commentableType:{},commentableId:{},canCreate:{type:Boolean,default:!0}},emits:["update:open"],setup(e,{emit:t}){const a=t;return(n,o)=>(g(),O(r($n),{open:e.open,"onUpdate:open":o[0]||(o[0]=l=>a("update:open",l))},{default:y(()=>[h(r(In),{side:"right",class:"sm:max-w-lg w-full overflow-y-auto"},{default:y(()=>[E("div",jo,[h(Ca,{"commentable-type":e.commentableType,"commentable-id":e.commentableId,"can-create":e.canCreate,embedded:""},null,8,["commentable-type","commentable-id","can-create"])])]),_:1})]),_:1},8,["open"]))}});function Xo(e,t){const a=U([]),n=U([]),o=U(!1),l=U(null);return{actividades:a,usuarios:n,loading:o,error:l,cargar:async()=>{var s,c;if(t.value){o.value=!0,l.value=null;try{const d=`/api/proyectos/${e}/${t.value}/actividades`,m=await Kn.get(d);a.value=m.data.actividades||[],n.value=m.data.usuarios||[]}catch(d){console.error("Error al cargar actividades:",d),l.value=((c=(s=d.response)==null?void 0:s.data)==null?void 0:c.message)||"Error al cargar actividades",a.value=[],n.value=[]}finally{o.value=!1}}}}}const Go={class:"mt-6"},Wo={class:"flex items-center justify-between mb-4"},qo={key:0,class:"space-y-4"},Ko={class:"flex-1 space-y-2"},Qo={key:1,class:"text-center py-8 text-destructive"},Wn=_e({__name:"ActividadSheet",props:{open:{type:Boolean},actividadType:{},actividadId:{}},emits:["update:open"],setup(e,{emit:t}){const a=e,n=t,o=U(a.actividadId),{actividades:l,loading:i,error:s,cargar:c}=Xo(a.actividadType,o);return xe(()=>a.open,d=>{d&&(o.value=a.actividadId,c())},{immediate:!0}),xe(()=>a.actividadId,d=>{a.open&&d!==o.value&&(o.value=d,c())}),(d,m)=>(g(),O(r($n),{open:e.open,"onUpdate:open":m[0]||(m[0]=p=>n("update:open",p))},{default:y(()=>[h(r(In),{side:"right",class:"sm:max-w-lg w-full overflow-y-auto"},{default:y(()=>[E("div",Go,[E("div",Wo,[E("div",null,[h(r(kn),{class:"flex items-center gap-2"},{default:y(()=>[h(r(wt),{class:"h-5 w-5"}),m[1]||(m[1]=A(" Actividad ",-1))]),_:1}),h(r(_a),null,{default:y(()=>[...m[2]||(m[2]=[A(" Historial de cambios y eventos ",-1)])]),_:1})]),h(r(j),{variant:"ghost",size:"sm",onClick:r(c),disabled:r(i),title:"Recargar"},{default:y(()=>[h(r(Sa),{class:Z(["h-4 w-4",{"animate-spin":r(i)}])},null,8,["class"])]),_:1},8,["onClick","disabled"])]),r(i)&&r(l).length===0?(g(),D("div",qo,[(g(),D(J,null,de(5,p=>E("div",{key:p,class:"flex gap-3"},[h(r(Nt),{class:"h-8 w-8 rounded-full flex-shrink-0"}),E("div",Ko,[h(r(Nt),{class:"h-4 w-3/4"}),h(r(Nt),{class:"h-3 w-1/2"})])])),64))])):r(s)?(g(),D("div",Qo,[E("p",null,N(r(s)),1),h(r(j),{variant:"outline",size:"sm",class:"mt-2",onClick:r(c)},{default:y(()=>[...m[3]||(m[3]=[A(" Reintentar ",-1)])]),_:1},8,["onClick"])])):(g(),O(Da,{key:2,activities:r(l),"show-card":!1,"empty-message":"No hay actividad registrada"},null,8,["activities"]))])]),_:1})]),_:1},8,["open"]))}}),Zo={class:"space-y-4 min-w-0"},Cn="entregables-confirm-drag",Jo=_e({__name:"HitosEntregablesPanel",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},initialComentariosEntregableId:{},initialActividadEntregableId:{}},emits:["view","edit","delete","complete","update-status","comentarios-open","comentarios-close","actividad-open","actividad-close"],setup(e,{emit:t}){const a=e,n=t,o=St(a,"entregables"),{viewMode:l}=at(o),s=U((()=>{const T=localStorage.getItem(Cn);return T===null?!0:T==="true"})()),c=T=>{s.value=T,localStorage.setItem(Cn,String(T))},d=U(!1),m=U(null),p=U("pendiente"),_=U(!1),f=U(!1),w=U(null),u=U(!1),x=U(null),V=U(!1),B=U(null),L=T=>{x.value=T,u.value=!0},C=T=>{B.value=T,V.value=!0};xe(u,T=>{T&&x.value?n("comentarios-open",x.value.id):T||n("comentarios-close")}),xe(V,T=>{T&&B.value?n("actividad-open",B.value.id):T||n("actividad-close")}),_n(()=>{if(a.initialComentariosEntregableId){const T=a.entregables.find(R=>R.id===a.initialComentariosEntregableId);T&&(x.value=T,u.value=!0)}if(a.initialActividadEntregableId){const T=a.entregables.find(R=>R.id===a.initialActividadEntregableId);T&&(B.value=T,V.value=!0)}});const z=T=>{n("view",T)},ae=T=>{n("edit",T)},ce=T=>{w.value=T,f.value=!0},De=()=>{w.value&&n("delete",w.value),f.value=!1,w.value=null},Q=T=>{m.value=T,p.value="completado",d.value=!0},pe=(T,R)=>{m.value=T,p.value=R,d.value=!0},ge=(T,R)=>{s.value?(m.value=T,p.value=R,d.value=!0):n("update-status",T,R,"",[])},Se=(T,R)=>{m.value&&(p.value==="completado"?n("complete",m.value,T,R):n("update-status",m.value,p.value,T,R),d.value=!1,m.value=null)};return(T,R)=>{var ue,oe;return g(),D("div",Zo,[h(Aa,{modelValue:r(l),"onUpdate:modelValue":R[0]||(R[0]=G=>Qn(l)?l.value=G:null),"confirm-on-drag":s.value,"onUpdate:confirmOnDrag":c},null,8,["modelValue","confirm-on-drag"]),r(l)==="list"?(g(),O(oo,{key:0,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onEdit:ae,onDelete:ce,onComplete:Q,onChangeStatus:pe,onShowComentarios:L,onShowActividad:C},null,8,["entregables","can-edit","can-delete","can-complete"])):r(l)==="tabs"?(g(),O(co,{key:1,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onEdit:ae,onDelete:ce,onComplete:Q,onChangeStatus:pe,onShowComentarios:L,onShowActividad:C},null,8,["entregables","can-edit","can-delete","can-complete"])):r(l)==="kanban"?(g(),O(Yo,{key:2,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canComplete,"confirm-on-drag":s.value,onView:z,onEdit:ae,onDelete:ce,onComplete:Q,onChangeStatus:pe,onDragChangeStatus:ge,onShowComentarios:L,onShowActividad:C},null,8,["entregables","can-edit","can-delete","can-complete","can-drag","confirm-on-drag"])):k("",!0),h(ca,{open:d.value,"onUpdate:open":R[1]||(R[1]=G=>d.value=G),"entregable-nombre":(ue=m.value)==null?void 0:ue.nombre,"estado-actual":(oe=m.value)==null?void 0:oe.estado,"nuevo-estado":p.value,loading:_.value,onConfirm:Se},null,8,["open","entregable-nombre","estado-actual","nuevo-estado","loading"]),h(r(na),{open:f.value,"onUpdate:open":R[2]||(R[2]=G=>f.value=G)},{default:y(()=>[h(r(aa),null,{default:y(()=>[h(r(oa),null,{default:y(()=>[h(r(la),null,{default:y(()=>[...R[5]||(R[5]=[A("¿Estás seguro?",-1)])]),_:1}),h(r(ia),null,{default:y(()=>{var G;return[A(' Esta acción no se puede deshacer. Se eliminará permanentemente el entregable "'+N((G=w.value)==null?void 0:G.nombre)+'". ',1)]}),_:1})]),_:1}),h(r(ra),null,{default:y(()=>[h(r(sa),null,{default:y(()=>[...R[6]||(R[6]=[A("Cancelar",-1)])]),_:1}),h(r(da),{class:"bg-red-600 hover:bg-red-700",onClick:De},{default:y(()=>[...R[7]||(R[7]=[A(" Eliminar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),x.value?(g(),O(Gn,{key:3,open:u.value,"onUpdate:open":R[3]||(R[3]=G=>u.value=G),"commentable-type":"entregables","commentable-id":x.value.id,"can-create":e.canEdit},null,8,["open","commentable-id","can-create"])):k("",!0),B.value?(g(),O(Wn,{key:4,open:V.value,"onUpdate:open":R[4]||(R[4]=G=>V.value=G),"actividad-type":"entregables","actividad-id":B.value.id},null,8,["open","actividad-id"])):k("",!0)])}}}),el={class:"flex flex-col md:flex-row h-full min-h-[500px] border rounded-lg overflow-hidden bg-background"},tl={class:"hidden md:flex md:w-72 lg:w-80 flex-col border-r bg-muted/30"},nl={class:"p-4 border-b bg-background"},al={class:"flex items-center justify-between"},ol={class:"font-semibold text-sm text-muted-foreground uppercase tracking-wide flex items-center gap-2"},ll={key:0,class:"mt-3"},il={class:"p-2 space-y-1"},rl={key:0,class:"p-4 text-center text-muted-foreground text-sm"},sl=["data-active","onClick"],dl={class:"flex items-center gap-2"},cl={class:"font-medium truncate flex-1"},ul={key:0,class:"mt-1 ml-4 text-xs text-muted-foreground truncate"},fl={class:"flex items-center gap-2 mt-2 ml-4 text-xs text-muted-foreground"},ml={class:"mt-2 ml-4"},gl={class:"flex-1 flex flex-col min-h-0 min-w-0"},hl={class:"md:hidden p-4 border-b bg-background sticky top-0 z-10 space-y-3"},pl={class:"flex items-center gap-2"},vl={class:"flex flex-col"},bl={key:0,class:"text-xs text-muted-foreground"},yl={class:"text-muted-foreground"},wl={key:0,class:"flex items-center justify-center h-full min-h-[400px]"},xl={class:"text-center space-y-3 max-w-sm p-6"},El={key:1,class:"p-4 md:p-6 space-y-6 overflow-x-hidden"},Cl={class:"flex items-start justify-between gap-4"},_l={class:"flex-1 min-w-0"},Dl={class:"flex items-center gap-2 mb-1"},Sl={key:0,class:"flex items-center gap-1.5 text-sm text-muted-foreground mt-1"},kl={key:1,class:"text-sm text-muted-foreground mt-2"},Tl={class:"space-y-2"},$l={class:"flex justify-between items-center text-sm"},Il={class:"font-medium"},Ol={class:"flex flex-wrap gap-4 text-sm"},Pl={key:0,class:"flex items-center gap-1.5 text-muted-foreground"},Al={key:1,class:"flex items-center gap-1.5 text-muted-foreground"},Nl={key:2,class:"flex items-center gap-1.5 text-muted-foreground"},Ml={class:"flex flex-wrap gap-2"},Rl={class:"space-y-4 min-w-0"},Bl={class:"flex items-center justify-between"},Fl={class:"font-semibold flex items-center gap-2"},Hl={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},ki=_e({__name:"HitosDashboard",props:{hitos:{},proyectoId:{},proyectos:{},selectedProyectoId:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},showViewDetail:{type:Boolean,default:!0},showProyectoInHito:{type:Boolean,default:!1},baseUrl:{default:"/admin/proyectos"}},emits:["select-hito","edit-hito","delete-hito","view-hito","add-entregable","view-entregable","complete-entregable","update-entregable-status","edit-entregable","delete-entregable","filter-proyecto"],setup(e,{emit:t}){var it;const a=e,n=t,o=U(((it=a.selectedProyectoId)==null?void 0:it.toString())||"_all"),l=ne(()=>{if(o.value==="_all")return a.hitos;const P=parseInt(o.value,10);return a.hitos.filter(v=>v.proyecto_id===P)}),i=P=>{o.value=P,m.value=null;const v=P!=="_all"?parseInt(P,10):null;n("filter-proyecto",v)};Zn("(max-width: 768px)");const s=()=>{const v=new URLSearchParams(window.location.search).get("hito");return v?parseInt(v,10):null},c=()=>{const v=new URLSearchParams(window.location.search).get("comentarios");return v?v==="hito"?{tipo:"hito"}:v.startsWith("entregable_")?{tipo:"entregable",id:parseInt(v.replace("entregable_",""),10)}:{tipo:null}:{tipo:null}},d=()=>{const v=new URLSearchParams(window.location.search).get("actividad");return v?v==="hito"?{tipo:"hito"}:v.startsWith("entregable_")?{tipo:"entregable",id:parseInt(v.replace("entregable_",""),10)}:{tipo:null}:{tipo:null}},m=U(s()),p=c(),_=d(),f=ne(()=>l.value.find(P=>P.id===m.value)??null),w=ne(()=>a.proyectoId?a.proyectoId:f.value?f.value.proyecto_id:null),u=ne(()=>w.value?`${a.baseUrl}/${w.value}/hitos`:null),x=ne(()=>!f.value||!w.value?null:`${a.baseUrl}/${w.value}/hitos/${f.value.id}/entregables`);xe(m,P=>{if(P){const v=window.location.pathname,ee=new URLSearchParams(window.location.search);ee.set("hito",String(P));const S=`${v}?${ee.toString()}`;$t.get(S,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]}),n("select-hito",P)}});const V=P=>{m.value=P},B=P=>{const v=parseInt(P,10);isNaN(v)||V(v)},L=P=>P?Xt(new Date(P),"dd MMM yyyy",{locale:Gt}):"Sin fecha",C=P=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[P]||"bg-gray-100 text-gray-800",z=P=>({pendiente:"bg-gray-400",en_progreso:"bg-blue-500 animate-pulse",completado:"bg-green-500",cancelado:"bg-red-500"})[P]||"bg-gray-400",ae=P=>{f.value&&n("view-entregable",P,f.value)},ce=(P,v,ee)=>{n("complete-entregable",P,v,ee)},De=(P,v,ee,S)=>{n("update-entregable-status",P,v,ee,S)},Q=P=>{f.value&&n("edit-entregable",P,f.value)},pe=P=>{f.value&&n("delete-entregable",P,f.value)},ge=()=>{f.value&&n("edit-hito",f.value)},Se=()=>{f.value&&n("delete-hito",f.value)},T=()=>{f.value&&n("add-entregable",f.value)},R=()=>{f.value&&n("view-hito",f.value)},ue=U(p.tipo==="hito"),oe=U(_.tipo==="hito"),G=(P,v)=>{const ee=window.location.pathname,S=new URLSearchParams(window.location.search);P==="hito"?S.set("comentarios","hito"):P==="entregable"&&v?S.set("comentarios",`entregable_${v}`):(S.delete("comentarios"),S.delete("pagina"));const rt=`${ee}?${S.toString()}`;$t.get(rt,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]})};xe(ue,P=>{P?G("hito"):new URLSearchParams(window.location.search).get("comentarios")==="hito"&&G(null)});const we=(P,v)=>{const ee=window.location.pathname,S=new URLSearchParams(window.location.search);P==="hito"?S.set("actividad","hito"):P==="entregable"&&v?S.set("actividad",`entregable_${v}`):S.delete("actividad");const rt=`${ee}?${S.toString()}`;$t.get(rt,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]})};return xe(oe,P=>{P?we("hito"):new URLSearchParams(window.location.search).get("actividad")==="hito"&&we(null)}),(P,v)=>{var ee;return g(),D("div",el,[E("aside",tl,[E("div",nl,[E("div",al,[E("h2",ol,[h(r(un),{class:"h-4 w-4"}),A(" Hitos ("+N(l.value.length)+") ",1)]),e.showViewDetail&&u.value?(g(),O(r(dn),{key:0,href:u.value},{default:y(()=>[h(r(j),{variant:"outline",size:"sm"},{default:y(()=>[h(r(fn),{class:"h-3.5 w-3.5 mr-1"}),v[8]||(v[8]=A(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):k("",!0)]),e.proyectos&&e.proyectos.length>0?(g(),D("div",ll,[h(r(It),{"model-value":o.value,"onUpdate:modelValue":i},{default:y(()=>[h(r(Ot),{class:"w-full h-9 text-sm"},{default:y(()=>[h(r(Pt),{placeholder:"Todos los proyectos"})]),_:1}),h(r(At),null,{default:y(()=>[h(r(Ye),{value:"_all"},{default:y(()=>[...v[9]||(v[9]=[A("Todos los proyectos",-1)])]),_:1}),(g(!0),D(J,null,de(e.proyectos,S=>(g(),O(r(Ye),{key:S.id,value:S.id.toString()},{default:y(()=>[A(N(S.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])])):k("",!0)]),h(r(jt),{class:"flex-1"},{default:y(()=>[E("div",il,[l.value.length===0?(g(),D("div",rl," No hay hitos definidos ")):k("",!0),(g(!0),D(J,null,de(l.value,S=>(g(),D("button",{key:S.id,"data-active":m.value===S.id,class:"w-full text-left p-3 rounded-lg transition-colors duration-150 hover:bg-accent hover:text-accent-foreground data-[active=true]:bg-primary/10 data-[active=true]:text-primary data-[active=true]:border-l-2 data-[active=true]:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",onClick:rt=>V(S.id)},[E("div",dl,[E("div",{class:Z([z(S.estado),"w-2 h-2 rounded-full flex-shrink-0"])},null,2),E("span",cl,N(S.nombre),1),m.value===S.id?(g(),O(r(On),{key:0,class:"h-4 w-4 flex-shrink-0 text-primary"})):k("",!0)]),e.showProyectoInHito&&S.proyecto?(g(),D("div",ul,N(S.proyecto.nombre),1)):k("",!0),E("div",fl,[h(r(ye),{class:Z([C(S.estado),"text-[10px] px-1.5 py-0"])},{default:y(()=>[A(N(S.estado_label||S.estado),1)]),_:2},1032,["class"]),E("span",null,N(S.porcentaje_completado)+"%",1)]),E("div",ml,[h(r(cn),{"model-value":S.porcentaje_completado,class:"h-1"},null,8,["model-value"])])],8,sl))),128))])]),_:1})]),E("main",gl,[E("div",hl,[e.proyectos&&e.proyectos.length>0?(g(),O(r(It),{key:0,"model-value":o.value,"onUpdate:modelValue":i},{default:y(()=>[h(r(Ot),{class:"w-full h-9 text-sm"},{default:y(()=>[h(r(Pt),{placeholder:"Todos los proyectos"})]),_:1}),h(r(At),null,{default:y(()=>[h(r(Ye),{value:"_all"},{default:y(()=>[...v[10]||(v[10]=[A("Todos los proyectos",-1)])]),_:1}),(g(!0),D(J,null,de(e.proyectos,S=>(g(),O(r(Ye),{key:S.id,value:S.id.toString()},{default:y(()=>[A(N(S.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])):k("",!0),h(r(It),{"model-value":((ee=m.value)==null?void 0:ee.toString())||"","onUpdate:modelValue":B},{default:y(()=>[h(r(Ot),{class:"w-full"},{default:y(()=>[h(r(Pt),{placeholder:"Selecciona un hito"})]),_:1}),h(r(At),null,{default:y(()=>[(g(!0),D(J,null,de(l.value,S=>(g(),O(r(Ye),{key:S.id,value:S.id.toString()},{default:y(()=>[E("div",pl,[E("div",{class:Z([z(S.estado),"w-2 h-2 rounded-full"])},null,2),E("div",vl,[E("span",null,N(S.nombre),1),e.showProyectoInHito&&S.proyecto?(g(),D("span",bl,N(S.proyecto.nombre),1)):k("",!0)]),E("span",yl,"("+N(S.porcentaje_completado)+"%)",1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),h(r(jt),{class:"flex-1"},{default:y(()=>[f.value?(g(),D("div",El,[h(r(Dn),null,{default:y(()=>[h(r(Jn),{class:"pb-3"},{default:y(()=>[E("div",Cl,[E("div",_l,[E("div",Dl,[E("div",{class:Z([z(f.value.estado),"w-2.5 h-2.5 rounded-full"])},null,2),h(r(kn),{class:"text-xl truncate"},{default:y(()=>[A(N(f.value.nombre),1)]),_:1})]),e.showProyectoInHito&&f.value.proyecto?(g(),D("div",Sl,[h(r(ka),{class:"h-4 w-4"}),E("span",null,N(f.value.proyecto.nombre),1)])):k("",!0),f.value.descripcion?(g(),D("p",kl,N(f.value.descripcion),1)):k("",!0)]),h(r(ye),{class:Z(C(f.value.estado))},{default:y(()=>[A(N(f.value.estado_label||f.value.estado),1)]),_:1},8,["class"])])]),_:1}),h(r(Sn),{class:"space-y-4"},{default:y(()=>[E("div",Tl,[E("div",$l,[v[13]||(v[13]=E("span",{class:"text-muted-foreground"},"Progreso",-1)),E("span",Il,N(f.value.porcentaje_completado)+"%",1)]),h(r(cn),{"model-value":f.value.porcentaje_completado,class:"h-2"},null,8,["model-value"])]),E("div",Ol,[f.value.fecha_inicio?(g(),D("div",Pl,[h(r(Wt),{class:"h-4 w-4"}),E("span",null,"Inicio: "+N(L(f.value.fecha_inicio)),1)])):k("",!0),f.value.fecha_fin?(g(),D("div",Al,[h(r(Pe),{class:"h-4 w-4"}),E("span",null,"Fin: "+N(L(f.value.fecha_fin)),1)])):k("",!0),f.value.responsable?(g(),D("div",Nl,[h(r(mt),{class:"h-4 w-4"}),E("span",null,N(f.value.responsable.name),1)])):k("",!0)]),h(r(ea)),E("div",Ml,[e.canEdit?(g(),O(r(j),{key:0,variant:"outline",size:"sm",onClick:ge},{default:y(()=>[h(r(qt),{class:"h-4 w-4 mr-1.5"}),v[14]||(v[14]=A(" Editar Hito ",-1))]),_:1})):k("",!0),e.canManageDeliverables?(g(),O(r(j),{key:1,variant:"outline",size:"sm",onClick:T},{default:y(()=>[h(r(mn),{class:"h-4 w-4 mr-1.5"}),v[15]||(v[15]=A(" Añadir Entregable ",-1))]),_:1})):k("",!0),e.showViewDetail?(g(),O(r(j),{key:2,variant:"ghost",size:"sm",onClick:R},{default:y(()=>[h(r(Mt),{class:"h-4 w-4 mr-1.5"}),v[16]||(v[16]=A(" Ver Detalle Completo ",-1))]),_:1})):k("",!0),h(r(j),{variant:"ghost",size:"sm",onClick:v[0]||(v[0]=S=>ue.value=!0)},{default:y(()=>[h(r(Kt),{class:"h-4 w-4 mr-1.5"}),v[17]||(v[17]=A(" Comentarios ",-1)),f.value.comentarios_count&&f.value.comentarios_count>0?(g(),O(r(ye),{key:0,variant:"secondary",class:"ml-1.5 text-xs"},{default:y(()=>[A(N(f.value.comentarios_count),1)]),_:1})):k("",!0)]),_:1}),h(r(j),{variant:"ghost",size:"sm",onClick:v[1]||(v[1]=S=>oe.value=!0)},{default:y(()=>[h(r(wt),{class:"h-4 w-4 mr-1.5"}),v[18]||(v[18]=A(" Actividad ",-1))]),_:1}),e.canDelete?(g(),O(r(j),{key:3,variant:"ghost",size:"sm",class:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:Se},{default:y(()=>[h(r(Pn),{class:"h-4 w-4 mr-1.5"}),v[19]||(v[19]=A(" Eliminar ",-1))]),_:1})):k("",!0)])]),_:1})]),_:1}),E("div",Rl,[E("div",Bl,[E("h3",Fl,[h(r(Mt),{class:"h-5 w-5"}),v[20]||(v[20]=A(" Entregables ",-1)),h(r(ye),{variant:"secondary",class:"ml-1"},{default:y(()=>{var S;return[A(N(((S=f.value.entregables)==null?void 0:S.length)||0),1)]}),_:1})]),e.showViewDetail&&x.value?(g(),O(r(dn),{key:0,href:x.value},{default:y(()=>[h(r(j),{variant:"outline",size:"sm"},{default:y(()=>[h(r(fn),{class:"h-3.5 w-3.5 mr-1"}),v[21]||(v[21]=A(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):k("",!0)]),f.value.entregables&&f.value.entregables.length>0?(g(),O(r(Jo),{key:0,entregables:f.value.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"initial-comentarios-entregable-id":r(p).tipo==="entregable"?r(p).id:void 0,"initial-actividad-entregable-id":r(_).tipo==="entregable"?r(_).id:void 0,onView:ae,onComplete:ce,onUpdateStatus:De,onEdit:Q,onDelete:pe,onComentariosOpen:v[2]||(v[2]=S=>G("entregable",S)),onComentariosClose:v[3]||(v[3]=()=>G(null)),onActividadOpen:v[4]||(v[4]=S=>we("entregable",S)),onActividadClose:v[5]||(v[5]=()=>we(null))},null,8,["entregables","can-edit","can-delete","can-complete","initial-comentarios-entregable-id","initial-actividad-entregable-id"])):(g(),D("div",Hl,[h(r(Mt),{class:"h-10 w-10 mx-auto text-muted-foreground/50 mb-3"}),v[23]||(v[23]=E("p",{class:"text-muted-foreground text-sm"},"No hay entregables en este hito",-1)),e.canManageDeliverables?(g(),O(r(j),{key:0,variant:"outline",size:"sm",class:"mt-4",onClick:T},{default:y(()=>[h(r(mn),{class:"h-4 w-4 mr-1.5"}),v[22]||(v[22]=A(" Crear primer entregable ",-1))]),_:1})):k("",!0)]))])])):(g(),D("div",wl,[E("div",xl,[h(r(un),{class:"h-16 w-16 mx-auto text-muted-foreground/50"}),v[11]||(v[11]=E("h3",{class:"font-medium text-lg"},"Selecciona un hito",-1)),v[12]||(v[12]=E("p",{class:"text-sm text-muted-foreground"}," Elige un hito de la lista para ver sus detalles y entregables ",-1))])]))]),_:1})]),f.value?(g(),O(Gn,{key:0,open:ue.value,"onUpdate:open":v[6]||(v[6]=S=>ue.value=S),"commentable-type":"hitos","commentable-id":f.value.id,"can-create":e.canEdit},null,8,["open","commentable-id","can-create"])):k("",!0),f.value?(g(),O(Wn,{key:1,open:oe.value,"onUpdate:open":v[7]||(v[7]=S=>oe.value=S),"actividad-type":"hitos","actividad-id":f.value.id},null,8,["open","actividad-id"])):k("",!0)])}}});export{ki as _};
