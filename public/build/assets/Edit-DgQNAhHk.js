import{d as De,u as Ue,r as g,c as V,p as H,o as je,B as Ie,I as Ne,b as _,w as r,e as a,g as i,f as t,q as Re,h as c,t as p,i as u,j as w,m as n,l as Te,F as X,k as J,x as ze,a4 as de,s as K}from"./app-BEXZv9D4.js";import{_ as Oe}from"./UserLayout.vue_vue_type_script_setup_true_lang-3nsGdcc9.js";import{_ as j,a as I,b as N,c as R}from"./CardTitle.vue_vue_type_script_setup_true_lang-Ci6kjuRH.js";import{_ as Q}from"./CardDescription.vue_vue_type_script_setup_true_lang-Cl9iNlXd.js";import{_ as f}from"./createLucideIcon-JdLteBhk.js";import{_ as Y}from"./Label.vue_vue_type_script_setup_true_lang-B0OhtbTA.js";import{_ as Ge}from"./Textarea.vue_vue_type_script_setup_true_lang-DgzmZt76.js";import{_ as ce,a as ue,b as ve,c as me,d as pe}from"./SelectValue.vue_vue_type_script_setup_true_lang-CHJCqoG6.js";import{_ as Le}from"./FileUploadField.vue_vue_type_script_setup_true_lang-B152wNd1.js";import{_ as qe}from"./EntregableSelector.vue_vue_type_script_setup_true_lang-DFp2UgBM.js";import{u as Pe}from"./useAutoSave-DsU7sKQV.js";import{u as We}from"./useFileUpload-C_t2RKUz.js";import{t as h}from"./index-SnReKwv1.js";import{F as Z}from"./file-text-D7o3rFAC.js";import{M as fe}from"./music-DqabqLyF.js";import{V as T}from"./video-C3FY1qs9.js";import{I as He}from"./image-D67ftp1p.js";import{A as Xe}from"./arrow-left-Bhl3eCZa.js";import{C as ge}from"./clock-BNolIuU1.js";import{C as _e}from"./circle-check-big-CH3sTIq1.js";import{C as Je}from"./circle-alert-BPPRs1OY.js";import{X as he}from"./x-MjRAM-mT.js";import{C as be}from"./camera-D3KUncmt.js";import{M as ee}from"./mic--ZYXwGpW.js";import{S as Ke}from"./save-itMS_e6I.js";import{U as Qe}from"./upload-D18DwDfo.js";import"./useFlashMessages-BQWSMemQ.js";import"./index-DcePN18A.js";import"./floating-ui.vue-DGmmF0XI.js";import"./Input.vue_vue_type_script_setup_true_lang-Btxc7TBU.js";import"./index-DJqslkHs.js";import"./index-Dc32wMFW.js";import"./shield-DSsoQyNN.js";import"./user-CO02PkBz.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DeF5hJ4Q.js";import"./chevron-right-q4mBAWz9.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CnoKE1DK.js";import"./VisuallyHidden-CGUyYIjj.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-02x5QTXs.js";import"./map-pin-DCkJGui3.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BRdnVbyR.js";import"./ellipsis-DRhVkhgs.js";import"./usePermissions-70kuUEDz.js";import"./square-check-big-BAeHuxbt.js";import"./users-BfW56zi5.js";import"./folder-open-Bm8bYSgZ.js";import"./milestone-BKPI_d06.js";import"./index-DrTK4xQW.js";import"./check-tU5Ba87G.js";import"./file-DVW9bZsC.js";import"./eye-CW9ybKMl.js";import"./download-kBFSWtnZ.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CFv3f79-.js";import"./index-CKyiPBXR.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-CNoGHsIN.js";import"./search-CY_5nLNI.js";import"./rotate-ccw-C5JiKqi5.js";import"./calendar-BWZ081O_.js";import"./debounce-CqhPE8HE.js";const Ye={class:"space-y-6"},Ze={class:"flex justify-between items-start"},et={class:"text-muted-foreground"},tt={class:"flex items-center gap-2"},ot={key:0,class:"flex items-center text-sm text-muted-foreground"},at={key:1,class:"flex items-center text-sm text-green-600"},it={key:2,class:"flex items-center text-sm text-red-600"},st={class:"grid gap-6 lg:grid-cols-3"},rt={class:"lg:col-span-2 space-y-6"},lt={class:"space-y-4"},nt={key:0,class:"p-3 bg-muted/30 rounded-lg"},dt={class:"text-sm text-muted-foreground"},ct={key:0,class:"space-y-4"},ut={class:"relative bg-muted/30 rounded-lg p-4"},vt={key:0,class:"text-center"},mt=["src"],pt={key:1,class:"text-center"},ft=["src"],gt={key:2,class:"flex flex-col items-center gap-4"},_t=["src"],ht={key:3,class:"flex items-center justify-center gap-4 py-8"},bt={class:"text-center"},xt={class:"font-medium"},yt={class:"text-sm text-muted-foreground text-center"},wt={key:1,class:"space-y-4"},kt={class:"grid grid-cols-3 gap-3"},Ct={class:"space-y-6"},$t={class:"text-sm"},Et={class:"text-sm"},St={class:"text-sm"},Vt={key:0},At={class:"text-sm font-medium text-muted-foreground"},Bt={class:"space-y-1"},Ft={key:0,class:"fixed bottom-0 left-0 right-0 bg-background border-t border-border shadow-lg z-50"},Mt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Dt={class:"flex items-center justify-between py-4"},Ut={class:"flex items-center gap-4"},jt={key:0,class:"flex items-center text-sm text-muted-foreground"},It={key:1,class:"flex items-center text-sm text-green-600"},Nt={class:"flex items-center gap-3"},Rt={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50"},Tt={class:"bg-background rounded-lg p-6 max-w-2xl w-full mx-4"},zt={class:"flex items-center justify-between mb-4"},Ot={class:"text-lg font-semibold"},Gt={class:"space-y-4"},Lt={key:0,class:"relative"},qt={key:1,class:"flex items-center justify-center gap-2 text-red-600"},Pt={class:"font-mono"},Wt={class:"flex justify-center gap-3"},Zo=De({__name:"Edit",props:{contrato:{},evidencia:{},obligaciones:{},entregables:{},tiposEvidencia:{}},setup(b){var ne;const d=b,xe=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Contratos",href:"/miembro/mis-contratos"},{title:d.contrato.nombre,href:`/miembro/mis-contratos/${d.contrato.id}`},{title:"Evidencias",href:`/miembro/mis-contratos/${d.contrato.id}/evidencias`},{title:"Editar Evidencia",href:"#"}],{uploadFiles:ye}=We(),o=Ue({obligacion_id:d.evidencia.obligacion_id,tipo_evidencia:d.evidencia.tipo_evidencia,archivo_path:d.evidencia.archivo_path,archivo_nombre:d.evidencia.archivo_nombre,archivos_paths:d.evidencia.archivos_paths||(d.evidencia.archivo_path?[d.evidencia.archivo_path]:[]),archivos_nombres:d.evidencia.archivos_nombres||(d.evidencia.archivo_nombre?[d.evidencia.archivo_nombre]:[]),descripcion:d.evidencia.descripcion||"",entregable_ids:((ne=d.evidencia.entregables)==null?void 0:ne.map(s=>s.id))||[],metadata:d.evidencia.metadata||null}),$=g(d.evidencia.archivos_paths||(d.evidencia.archivo_path?[d.evidencia.archivo_path]:[])),te=g(!1),k=g("idle"),B=g(!1),F=g(null),E=g(null),z=g(!1),v=g("photo");let C=null,S=null;const O=g([]),x=g(!1),M=g(0);let D=null;const G=V(()=>d.obligaciones.find(s=>s.id===o.obligacion_id));V(()=>d.entregables.filter(s=>s.estado!=="completado"));const L=V(()=>d.entregables.filter(s=>o.entregable_ids.includes(s.id))),oe=V(()=>o.obligacion_id&&o.tipo_evidencia&&!o.processing),we=V(()=>({imagen:He,video:T,audio:fe,documento:Z})[o.tipo_evidencia||"documento"]||Z),U=V(()=>E.value?URL.createObjectURL(E.value):d.evidencia.archivo_url),ke=V(()=>o.data()),{startAutoSave:Ce,stopAutoSave:ae}=Pe(ke,s=>K.post(route("user.mis-contratos.evidencias.autosave",d.contrato.id),s,{preserveScroll:!0,preserveState:!0,only:[]}));H(()=>o.data(),()=>{B.value=o.isDirty},{deep:!0}),H(()=>o.tipo_evidencia,(s,e)=>{if(e&&s&&s!==e){if((o.archivos_paths.length>0||o.archivo_path||F.value||E.value||$.value.length>0)&&!confirm(`¿Estás seguro de cambiar el tipo de evidencia? Se perderán los archivos seleccionados para "${e}".`)){o.tipo_evidencia=e;return}o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,F.value=null,E.value=null,$.value=[],h.info(`Tipo de evidencia cambiado a "${s}". Archivos limpiados.`)}});const $e=()=>{te.value=B.value||o.processing},Ee=async s=>{if(s.length>0){const e=o.archivos_paths.length,y=s.length;if(e+y>10){h.error(`No puedes subir más de 10 archivos. Actualmente tienes ${e} archivo(s).`);return}if(!o.tipo_evidencia){const l=s[0];l.type.startsWith("image/")?o.tipo_evidencia="imagen":l.type.startsWith("video/")?o.tipo_evidencia="video":l.type.startsWith("audio/")?o.tipo_evidencia="audio":o.tipo_evidencia="documento"}try{h.info(`Subiendo ${s.length} archivo(s)...`);const l=await ye(s,{module:"evidencias",fieldId:o.tipo_evidencia||"archivo",onProgress:(m,P)=>{}});if(l.length>0){const m=[...o.archivos_paths,...l.map(W=>W.path)],P=[...o.archivos_nombres,...l.map(W=>W.name)];o.archivos_paths=m,o.archivos_nombres=P,!o.archivo_path&&m.length>0&&(o.archivo_path=m[0],o.archivo_nombre=P[0],o.metadata=l[0].metadata),$.value=m,h.success(`${l.length} archivo(s) subido(s) exitosamente. Total: ${m.length}/10`)}}catch(l){console.error("Error al subir archivos:",l),h.error("Error al subir archivos")}}else F.value=null,o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,$.value=[]},Se=()=>{F.value=null,E.value=null,o.archivo_path=null,o.archivo_nombre=null,o.archivos_paths=[],o.archivos_nombres=[],o.metadata=null,$.value=[]},q=s=>{v.value=s,z.value=!0,Ve()},Ve=async()=>{try{const s={video:v.value==="photo"||v.value==="video",audio:v.value==="video"||v.value==="audio"};if(S=await navigator.mediaDevices.getUserMedia(s),v.value==="photo"||v.value==="video"){const e=document.getElementById("captureVideo");e&&(e.srcObject=S)}}catch(s){console.error("Error accessing media devices:",s),h.error("No se pudo acceder a la cámara/micrófono"),A()}},Ae=()=>{const s=document.getElementById("captureVideo"),e=document.createElement("canvas");e.width=s.videoWidth,e.height=s.videoHeight;const y=e.getContext("2d");y&&(y.drawImage(s,0,0),e.toBlob(l=>{l&&(E.value=l,o.archivo_nombre=`foto_${Date.now()}.jpg`,o.tipo_evidencia="imagen",A())},"image/jpeg",.8))},ie=()=>{S&&(O.value=[],C=new MediaRecorder(S),C.ondataavailable=s=>{s.data.size>0&&O.value.push(s.data)},C.onstop=()=>{const s=new Blob(O.value,{type:v.value==="video"?"video/webm":"audio/webm"});E.value=s;const e=(v.value==="video","webm");o.archivo_nombre=`${v.value}_${Date.now()}.${e}`,o.tipo_evidencia=v.value,re(),A()},C.start(),x.value=!0,Be())},se=()=>{C&&x.value&&(C.stop(),x.value=!1)},Be=()=>{M.value=0,D=setInterval(()=>{M.value+=1},1e3)},re=()=>{D&&(clearInterval(D),D=null),M.value=0},A=()=>{z.value=!1,S&&(S.getTracks().forEach(s=>s.stop()),S=null),C&&(C=null),re(),x.value=!1},Fe=s=>{const e=Math.floor(s/60),y=s%60;return`${e.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`},le=async()=>{if(oe.value){if(o.archivos_paths.length===0&&!o.archivo_path){h.error("Por favor seleccione o capture al menos un archivo");return}o.put(route("user.mis-contratos.evidencias.update",[d.contrato.id,d.evidencia.id]),{onSuccess:()=>{h.success(`Evidencia actualizada exitosamente con ${o.archivos_paths.length} archivo(s)`),B.value=!1,ae()},onError:s=>{console.error("Errores:",s),h.error("Error al actualizar la evidencia")}})}},Me=()=>{K.post(route("user.mis-contratos.evidencias.autosave",d.contrato.id),o.data(),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{h.success("Borrador guardado"),k.value="saved",setTimeout(()=>{k.value="idle"},2e3)},onError:()=>{h.error("Error al guardar borrador"),k.value="error"}})};return je(()=>{H(()=>B.value,$e,{immediate:!0}),Ce()}),Ie(()=>{ae(),A()}),(s,e)=>{const y=Ne("Link");return n(),_(Oe,{breadcrumbs:xe},{default:r(()=>[a(t(Re),{title:"Editar Evidencia"}),i("div",Ye,[i("div",Ze,[i("div",null,[a(y,{href:s.route("user.mis-contratos.evidencias.show",[b.contrato.id,b.evidencia.id]),class:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-2"},{default:r(()=>[a(t(Xe),{class:"w-4 h-4 mr-2"}),e[9]||(e[9]=c(" Volver a Ver Evidencia ",-1))]),_:1},8,["href"]),e[11]||(e[11]=i("h2",{class:"text-3xl font-bold tracking-tight"},"Editar Evidencia",-1)),i("p",et,[e[10]||(e[10]=c(" Modificar evidencia para: ",-1)),i("strong",null,p(b.contrato.nombre),1)])]),i("div",tt,[k.value==="saving"?(n(),u("div",ot,[a(t(ge),{class:"w-4 h-4 mr-1 animate-spin"}),e[12]||(e[12]=c(" Guardando... ",-1))])):k.value==="saved"?(n(),u("div",at,[a(t(_e),{class:"w-4 h-4 mr-1"}),e[13]||(e[13]=c(" Guardado ",-1))])):k.value==="error"?(n(),u("div",it,[a(t(Je),{class:"w-4 h-4 mr-1"}),e[14]||(e[14]=c(" Error al guardar ",-1))])):w("",!0)])]),i("form",{onSubmit:Te(le,["prevent"]),class:"space-y-6"},[i("div",st,[i("div",rt,[a(t(j),null,{default:r(()=>[a(t(I),null,{default:r(()=>[a(t(N),null,{default:r(()=>[...e[15]||(e[15]=[c("Obligación Contractual",-1)])]),_:1}),a(t(Q),null,{default:r(()=>[...e[16]||(e[16]=[c(" Selecciona la obligación a la que corresponde esta evidencia ",-1)])]),_:1})]),_:1}),a(t(R),null,{default:r(()=>{var l;return[i("div",lt,[i("div",null,[a(t(Y),{for:"obligacion_id"},{default:r(()=>[...e[17]||(e[17]=[c("Obligación *",-1)])]),_:1}),a(t(ce),{modelValue:t(o).obligacion_id,"onUpdate:modelValue":e[0]||(e[0]=m=>t(o).obligacion_id=m),required:""},{default:r(()=>[a(t(ue),null,{default:r(()=>[a(t(ve),{placeholder:"Seleccionar obligación..."})]),_:1}),a(t(me),null,{default:r(()=>[(n(!0),u(X,null,J(b.obligaciones,m=>(n(),_(t(pe),{key:m.id,value:m.id},{default:r(()=>[c(p(m.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),(l=G.value)!=null&&l.descripcion?(n(),u("div",nt,[i("p",dt,p(G.value.descripcion),1)])):w("",!0)])]}),_:1})]),_:1}),a(t(j),null,{default:r(()=>[a(t(I),null,{default:r(()=>[a(t(N),{class:"flex items-center gap-2"},{default:r(()=>[(n(),_(ze(we.value),{class:"w-5 h-5"})),e[18]||(e[18]=c(" Archivo de Evidencia ",-1))]),_:1}),a(t(Q),null,{default:r(()=>[...e[19]||(e[19]=[c(" Sube un archivo o captura directamente desde tu dispositivo ",-1)])]),_:1})]),_:1}),a(t(R),{class:"space-y-6"},{default:r(()=>[i("div",null,[a(t(Y),{for:"tipo_evidencia"},{default:r(()=>[...e[20]||(e[20]=[c("Tipo de Evidencia *",-1)])]),_:1}),a(t(ce),{modelValue:t(o).tipo_evidencia,"onUpdate:modelValue":e[1]||(e[1]=l=>t(o).tipo_evidencia=l),required:""},{default:r(()=>[a(t(ue),null,{default:r(()=>[a(t(ve),{placeholder:"Seleccionar tipo..."})]),_:1}),a(t(me),null,{default:r(()=>[(n(!0),u(X,null,J(b.tiposEvidencia,l=>(n(),_(t(pe),{key:l.value,value:l.value},{default:r(()=>[c(p(l.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),U.value?(n(),u("div",ct,[i("div",ut,[t(o).tipo_evidencia==="imagen"?(n(),u("div",vt,[i("img",{src:U.value,alt:"Vista previa",class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"},null,8,mt)])):t(o).tipo_evidencia==="video"?(n(),u("div",pt,[i("video",{src:U.value,controls:"",class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}," Tu navegador no soporta la reproducción de video. ",8,ft)])):t(o).tipo_evidencia==="audio"?(n(),u("div",gt,[a(t(fe),{class:"w-12 h-12 text-muted-foreground"}),i("audio",{src:U.value,controls:"",class:"w-full max-w-md"}," Tu navegador no soporta la reproducción de audio. ",8,_t)])):(n(),u("div",ht,[a(t(Z),{class:"w-12 h-12 text-muted-foreground"}),i("div",bt,[i("p",xt,p(t(o).archivo_nombre),1),e[21]||(e[21]=i("p",{class:"text-sm text-muted-foreground"},"Documento",-1))])])),a(t(f),{type:"button",onClick:Se,variant:"destructive",size:"sm",class:"absolute top-2 right-2"},{default:r(()=>[a(t(he),{class:"w-4 h-4"})]),_:1})]),i("p",yt,p(t(o).archivo_nombre),1)])):(n(),u("div",wt,[a(Le,{modelValue:$.value,"onUpdate:modelValue":e[2]||(e[2]=l=>$.value=l),onFilesSelected:Ee,label:"",description:`Selecciona archivos desde tu dispositivo (${t(o).archivos_paths.length}/10 archivos)`,accept:t(o).tipo_evidencia?`${t(o).tipo_evidencia}/*`:"*/*","max-file-size":50,multiple:!0,"max-files":10,disabled:t(o).processing,module:"evidencias","field-id":t(o).tipo_evidencia||"archivo","auto-upload":!1},null,8,["modelValue","description","accept","disabled","field-id"]),e[25]||(e[25]=i("div",{class:"text-center"},[i("div",{class:"relative"},[i("div",{class:"absolute inset-0 flex items-center"},[i("span",{class:"w-full border-t"})]),i("div",{class:"relative flex justify-center text-xs uppercase"},[i("span",{class:"bg-background px-2 text-muted-foreground"},"O capturar directamente")])])],-1)),i("div",kt,[a(t(f),{type:"button",onClick:e[3]||(e[3]=l=>q("photo")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:r(()=>[a(t(be),{class:"w-6 h-6"}),e[22]||(e[22]=i("span",{class:"text-xs"},"Foto",-1))]),_:1}),a(t(f),{type:"button",onClick:e[4]||(e[4]=l=>q("video")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:r(()=>[a(t(T),{class:"w-6 h-6"}),e[23]||(e[23]=i("span",{class:"text-xs"},"Video",-1))]),_:1}),a(t(f),{type:"button",onClick:e[5]||(e[5]=l=>q("audio")),variant:"outline",class:"flex flex-col items-center gap-2 h-auto py-4"},{default:r(()=>[a(t(ee),{class:"w-6 h-6"}),e[24]||(e[24]=i("span",{class:"text-xs"},"Audio",-1))]),_:1})])])),i("div",null,[a(t(Y),{for:"descripcion"},{default:r(()=>[...e[26]||(e[26]=[c("Descripción",-1)])]),_:1}),a(t(Ge),{modelValue:t(o).descripcion,"onUpdate:modelValue":e[6]||(e[6]=l=>t(o).descripcion=l),placeholder:"Describe brevemente esta evidencia...",rows:"3"},null,8,["modelValue"])])]),_:1})]),_:1})]),i("div",Ct,[a(t(j),null,{default:r(()=>[a(t(I),null,{default:r(()=>[a(t(N),null,{default:r(()=>[...e[27]||(e[27]=[c("Entregables Asociados",-1)])]),_:1}),a(t(Q),null,{default:r(()=>[...e[28]||(e[28]=[c(" Opcional: Asocia esta evidencia con entregables específicos ",-1)])]),_:1})]),_:1}),a(t(R),null,{default:r(()=>[a(qe,{modelValue:t(o).entregable_ids,"onUpdate:modelValue":e[7]||(e[7]=l=>t(o).entregable_ids=l),entregables:b.entregables,label:"",description:"",height:"12rem",disabled:t(o).processing},null,8,["modelValue","entregables","disabled"])]),_:1})]),_:1}),a(t(j),null,{default:r(()=>[a(t(I),null,{default:r(()=>[a(t(N),null,{default:r(()=>[...e[29]||(e[29]=[c("Resumen",-1)])]),_:1})]),_:1}),a(t(R),{class:"space-y-3"},{default:r(()=>{var l;return[i("div",null,[e[30]||(e[30]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Obligación",-1)),i("p",$t,p(((l=G.value)==null?void 0:l.nombre)||"No seleccionada"),1)]),i("div",null,[e[31]||(e[31]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Tipo",-1)),i("p",Et,p(t(o).tipo_evidencia||"No seleccionado"),1)]),i("div",null,[e[32]||(e[32]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Archivo",-1)),i("p",St,p(t(o).archivo_nombre||"Ninguno"),1)]),L.value.length>0?(n(),u("div",Vt,[i("p",At,"Entregables ("+p(L.value.length)+")",1),i("div",Bt,[(n(!0),u(X,null,J(L.value,m=>(n(),u("p",{key:m.id,class:"text-xs text-muted-foreground"},p(m.nombre),1))),128))])])):w("",!0)]}),_:1})]),_:1})])])],32)]),(n(),_(de,{to:"body"},[te.value?(n(),u("div",Ft,[i("div",Mt,[i("div",Dt,[i("div",Ut,[a(t(f),{type:"button",onClick:Me,variant:"outline",disabled:t(o).processing},{default:r(()=>[a(t(Ke),{class:"w-4 h-4 mr-2"}),e[33]||(e[33]=c(" Guardar Borrador ",-1))]),_:1},8,["disabled"]),k.value==="saving"?(n(),u("div",jt,[a(t(ge),{class:"w-4 h-4 mr-1 animate-spin"}),e[34]||(e[34]=c(" Autoguardando... ",-1))])):k.value==="saved"?(n(),u("div",It,[a(t(_e),{class:"w-4 h-4 mr-1"}),e[35]||(e[35]=c(" Autoguardado ",-1))])):w("",!0)]),i("div",Nt,[a(t(f),{type:"button",onClick:e[8]||(e[8]=l=>t(K).visit(s.route("user.mis-contratos.evidencias.show",[b.contrato.id,b.evidencia.id]))),variant:"outline"},{default:r(()=>[...e[36]||(e[36]=[c(" Cancelar ",-1)])]),_:1}),a(t(f),{type:"button",onClick:le,disabled:!oe.value,loading:t(o).processing},{default:r(()=>[a(t(Qe),{class:"w-4 h-4 mr-2"}),e[37]||(e[37]=c(" Actualizar Evidencia ",-1))]),_:1},8,["disabled","loading"])])])])])):w("",!0)])),(n(),_(de,{to:"body"},[z.value?(n(),u("div",Rt,[i("div",Tt,[i("div",zt,[i("h3",Ot," Capturar "+p(v.value==="photo"?"Foto":v.value==="video"?"Video":"Audio"),1),a(t(f),{onClick:A,variant:"outline",size:"sm"},{default:r(()=>[a(t(he),{class:"w-4 h-4"})]),_:1})]),i("div",Gt,[v.value==="photo"||v.value==="video"?(n(),u("div",Lt,[...e[38]||(e[38]=[i("video",{id:"captureVideo",autoplay:"",muted:"",class:"w-full rounded-lg bg-black"},null,-1)])])):w("",!0),x.value?(n(),u("div",qt,[e[39]||(e[39]=i("div",{class:"w-3 h-3 bg-red-600 rounded-full animate-pulse"},null,-1)),i("span",Pt,p(Fe(M.value)),1)])):w("",!0),i("div",Wt,[v.value==="photo"?(n(),_(t(f),{key:0,onClick:Ae,class:"flex items-center gap-2"},{default:r(()=>[a(t(be),{class:"w-4 h-4"}),e[40]||(e[40]=c(" Tomar Foto ",-1))]),_:1})):v.value==="video"&&!x.value?(n(),_(t(f),{key:1,onClick:ie,class:"flex items-center gap-2"},{default:r(()=>[a(t(T),{class:"w-4 h-4"}),e[41]||(e[41]=c(" Iniciar Grabación ",-1))]),_:1})):v.value==="video"&&x.value?(n(),_(t(f),{key:2,onClick:se,variant:"destructive",class:"flex items-center gap-2"},{default:r(()=>[a(t(T),{class:"w-4 h-4"}),e[42]||(e[42]=c(" Detener Grabación ",-1))]),_:1})):v.value==="audio"&&!x.value?(n(),_(t(f),{key:3,onClick:ie,class:"flex items-center gap-2"},{default:r(()=>[a(t(ee),{class:"w-4 h-4"}),e[43]||(e[43]=c(" Iniciar Grabación ",-1))]),_:1})):v.value==="audio"&&x.value?(n(),_(t(f),{key:4,onClick:se,variant:"destructive",class:"flex items-center gap-2"},{default:r(()=>[a(t(ee),{class:"w-4 h-4"}),e[44]||(e[44]=c(" Detener Grabación ",-1))]),_:1})):w("",!0)])])])])):w("",!0)]))]),_:1})}}});export{Zo as default};
