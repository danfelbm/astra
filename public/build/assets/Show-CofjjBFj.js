import{j as f,_ as h,a as A,b as P,c as S,C as ce,M as fe,U as _e,d as R,e as W,f as O,g as X,h as U,k as ve,F as ge,l as be,m as ye,n as xe,o as ke,p as we,q as $e,i as Ce}from"./AppLayout.vue_vue_type_script_setup_true_lang-C59gz0Yk.js";import{c as K,_ as w}from"./AppLogo.vue_vue_type_script_setup_true_lang-ZW9hWR24.js";import{_ as he}from"./CardDescription.vue_vue_type_script_setup_true_lang-DxfD0a4m.js";import{_ as Ae,a as Pe,b as L,c as F,d as Se,e as C}from"./TableHeader.vue_vue_type_script_setup_true_lang-j7CCI6EU.js";import{_ as Ue,C as Fe}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-Byor1x8b.js";import{_ as G}from"./Checkbox.vue_vue_type_script_setup_true_lang-D1b1aGuI.js";import{d as qe,k as y,c as Me,p as je,a as v,o as d,b as t,u as e,m as Ve,e as s,f as o,j as _,i as x,t as r,n as Q,g as i,F as H,r as J,q as Ne,W as q}from"./app-gzqSbCbx.js";import{A as ze}from"./arrow-left-BEx8XMuh.js";import{S as Be}from"./square-pen-6W0wAJon.js";import{C as Te}from"./clock-Dc3D0_jx.js";import{C as Ee}from"./circle-check-big-BAe45ZVh.js";import{C as De}from"./circle-x-BKlwbgHG.js";import{f as Le,e as Qe}from"./es-DfN3vIXC.js";import"./Label.vue_vue_type_script_setup_true_lang-h_Er4x2c.js";import"./index-BKD8hVBb.js";import"./VisuallyHidden-88zd2gRf.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-C6Hl2ZfU.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-C1SPSlWG.js";import"./trash-2-qf81oQ62.js";import"./plus-DtOXhY4_.js";import"./search-BIfl_KnW.js";import"./history-Bi_wBAl5.js";import"./save-ByRbI5R_.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=K("UserMinusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=K("UserPlusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Re={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},We={class:"flex items-center justify-between"},Oe={class:"text-3xl font-bold"},Xe={class:"mt-2 flex items-center gap-2"},Ge={class:"flex gap-2"},Je={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Ke={class:"space-y-2"},Ye={class:"flex items-center gap-2 text-sm"},Ze={class:"flex items-center gap-2 text-sm"},ea={class:"text-sm font-medium"},aa={class:"space-y-2"},ta={class:"flex items-center gap-2 text-sm"},sa={class:"text-sm text-muted-foreground"},la={class:"space-y-2"},ia={class:"flex items-center gap-2"},na={class:"text-2xl font-bold"},oa={class:"text-sm"},ra={class:"flex items-center justify-between"},da={class:"flex gap-2"},ua={key:0,class:"mb-4"},pa={key:1,class:"flex justify-center py-8"},ma={key:0,class:"flex items-center gap-2"},ca={key:0,class:"text-green-600"},fa={key:1,class:"text-gray-400"},_a={key:1},va={class:"flex justify-end gap-2"},ga={key:3,class:"flex items-center justify-between mt-4"},ba={class:"text-sm text-muted-foreground"},ya={class:"flex items-center space-x-2"},xa={class:"text-sm"},ka=["href"],wa={class:"space-y-4"},$a={class:"max-h-96 overflow-y-auto border rounded-lg p-4"},Ca=["for"],ha={key:0,class:"text-center text-muted-foreground"},Ga=qe({__name:"Show",props:{asamblea:{},puede_gestionar_participantes:{type:Boolean},filterFieldsConfig:{}},setup(Y){const g=Y,Z=[{title:"Admin",href:"/admin/dashboard"},{title:"Asambleas",href:"/admin/asambleas"},{title:g.asamblea.nombre,href:"#"}],{route:k}=window,$=y([]),m=y({current_page:1,last_page:1,per_page:20,total:0,from:0,to:0}),T=y(!1),V=y({}),ee={fields:g.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por nombre o email...",quickSearchFields:["name","email"],maxNestingLevel:1,allowSaveFilters:!1,debounceTime:500,autoApply:!1},M=y(!1),E=y([]),b=y([]),N=y("asistente"),D=y(null),ae=l=>l?Le(new Date(l),"PPPpp",{locale:Qe}):"",te=l=>{switch(l){case"moderador":return"bg-purple-100 text-purple-800";case"secretario":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},z=Me(()=>{const l=$.value.filter(p=>{var c;return((c=p.pivot)==null?void 0:c.tipo_participacion)==="moderador"}).length,a=$.value.filter(p=>{var c;return((c=p.pivot)==null?void 0:c.tipo_participacion)==="secretario"}).length,n=$.value.filter(p=>{var c;return((c=p.pivot)==null?void 0:c.tipo_participacion)==="asistente"}).length,u=$.value.filter(p=>{var c;return((c=p.pivot)==null?void 0:c.asistio)===!0}).length;return{moderadores:l,secretarios:a,asistentes:n,presentes:u,total:m.value.total||0}}),j=async(l=1,a={})=>{T.value=!0;try{const n={page:l,...a},u=await Ne.get(k("admin.asambleas.participantes-list",g.asamblea.id),{params:n});$.value=u.data.participantes.data,m.value={current_page:u.data.participantes.current_page,last_page:u.data.participantes.last_page,per_page:u.data.participantes.per_page,total:u.data.participantes.total,from:u.data.participantes.from,to:u.data.participantes.to}}catch(n){console.error("Error cargando participantes:",n)}finally{T.value=!1}},I=l=>{j(l,V.value)},se=l=>{V.value=l,j(1,l)},le=()=>{V.value={},j(1,{})},ie=async()=>{try{const a=await(await fetch(k("admin.asambleas.manage-participantes",g.asamblea.id))).json();E.value=a.participantes_disponibles,M.value=!0}catch(l){console.error("Error cargando participantes:",l)}},B=()=>{j(m.value.current_page,V.value)},ne=()=>{b.value.length!==0&&q.post(k("admin.asambleas.manage-participantes",g.asamblea.id),{participante_ids:b.value,tipo_participacion:N.value},{preserveScroll:!0,onSuccess:()=>{M.value=!1,b.value=[],N.value="asistente",B()}})},oe=l=>{confirm("¿Estás seguro de remover este participante?")&&q.delete(k("admin.asambleas.manage-participantes",g.asamblea.id),{data:{participante_id:l},preserveScroll:!0,onSuccess:()=>{B()}})},re=(l,a)=>{q.put(k("admin.asambleas.manage-participantes",g.asamblea.id),{participante_id:l,tipo_participacion:a},{preserveScroll:!0,onSuccess:()=>{B()}})},de=(l,a)=>{D.value=l,q.put(k("admin.asambleas.manage-participantes",g.asamblea.id),{participante_id:l,asistio:a},{preserveScroll:!0,onFinish:()=>{D.value=null,B()}})},ue=()=>{q.visit(k("admin.asambleas.edit",g.asamblea.id))},pe=()=>{q.visit(k("admin.asambleas.index"))};return je(()=>{j()}),(l,a)=>(d(),v(H,null,[t(e(Ve),{title:`Asamblea: ${l.asamblea.nombre}`},null,8,["title"]),t(Ce,{breadcrumbs:Z},{default:s(()=>[o("div",Re,[o("div",We,[o("div",null,[o("h1",Oe,r(l.asamblea.nombre),1),o("div",Xe,[t(e(f),{class:Q(l.asamblea.estado_color)},{default:s(()=>[i(r(l.asamblea.estado_label),1)]),_:1},8,["class"]),t(e(f),{class:Q(l.asamblea.tipo==="ordinaria"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800")},{default:s(()=>[i(r(l.asamblea.tipo_label),1)]),_:1},8,["class"]),l.asamblea.activo?(d(),_(e(f),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>a[5]||(a[5]=[i(" Activa ")])),_:1})):(d(),_(e(f),{key:1,class:"bg-red-100 text-red-800"},{default:s(()=>a[6]||(a[6]=[i(" Inactiva ")])),_:1}))])]),o("div",Ge,[t(e(w),{variant:"outline",onClick:pe},{default:s(()=>[t(e(ze),{class:"mr-2 h-4 w-4"}),a[7]||(a[7]=i(" Volver "))]),_:1}),t(e(w),{onClick:ue},{default:s(()=>[t(e(Be),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=i(" Editar "))]),_:1})])]),o("div",Je,[t(e(h),null,{default:s(()=>[t(e(A),{class:"pb-3"},{default:s(()=>[t(e(P),{class:"text-sm font-medium"},{default:s(()=>a[9]||(a[9]=[i("Fechas")])),_:1})]),_:1}),t(e(S),null,{default:s(()=>[o("div",Ke,[o("div",Ye,[t(e(ce),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,r(l.asamblea.rango_fechas),1)]),o("div",Ze,[t(e(Te),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,"Duración: "+r(l.asamblea.duracion),1)]),o("p",ea,r(l.asamblea.tiempo_restante),1)])]),_:1})]),_:1}),t(e(h),null,{default:s(()=>[t(e(A),{class:"pb-3"},{default:s(()=>[t(e(P),{class:"text-sm font-medium"},{default:s(()=>a[10]||(a[10]=[i("Ubicación")])),_:1})]),_:1}),t(e(S),null,{default:s(()=>[o("div",aa,[o("div",ta,[t(e(fe),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,r(l.asamblea.lugar||"No especificado"),1)]),o("p",sa,r(l.asamblea.ubicacion_completa),1)])]),_:1})]),_:1}),t(e(h),null,{default:s(()=>[t(e(A),{class:"pb-3"},{default:s(()=>[t(e(P),{class:"text-sm font-medium"},{default:s(()=>a[11]||(a[11]=[i("Quórum")])),_:1})]),_:1}),t(e(S),null,{default:s(()=>[o("div",la,[o("div",ia,[t(e(_e),{class:"h-4 w-4 text-muted-foreground"}),o("span",na,r(l.asamblea.asistentes_count)+" / "+r(l.asamblea.quorum_minimo||"∞"),1)]),l.asamblea.alcanza_quorum?(d(),_(e(f),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[t(e(Ee),{class:"mr-1 h-3 w-3"}),a[12]||(a[12]=i(" Quórum alcanzado "))]),_:1})):l.asamblea.quorum_minimo?(d(),_(e(f),{key:1,class:"bg-yellow-100 text-yellow-800"},{default:s(()=>[t(e(De),{class:"mr-1 h-3 w-3"}),a[13]||(a[13]=i(" Quórum no alcanzado "))]),_:1})):x("",!0)])]),_:1})]),_:1})]),l.asamblea.descripcion?(d(),_(e(h),{key:0},{default:s(()=>[t(e(A),null,{default:s(()=>[t(e(P),null,{default:s(()=>a[14]||(a[14]=[i("Descripción")])),_:1})]),_:1}),t(e(S),null,{default:s(()=>[o("p",oa,r(l.asamblea.descripcion),1)]),_:1})]),_:1})):x("",!0),t(Ue,{config:ee,onApply:se,onClear:le}),t(e(h),null,{default:s(()=>[t(e(A),null,{default:s(()=>[o("div",ra,[o("div",null,[t(e(P),null,{default:s(()=>a[15]||(a[15]=[i("Participantes")])),_:1}),t(e(he),null,{default:s(()=>[i(r(m.value.total)+" participantes registrados ",1)]),_:1})]),o("div",da,[t(e(f),{variant:"outline"},{default:s(()=>[i(" Moderadores: "+r(z.value.moderadores),1)]),_:1}),t(e(f),{variant:"outline"},{default:s(()=>[i(" Secretarios: "+r(z.value.secretarios),1)]),_:1}),t(e(f),{variant:"outline"},{default:s(()=>[i(" Asistentes: "+r(z.value.asistentes),1)]),_:1}),t(e(f),{variant:"outline"},{default:s(()=>[i(" Presentes: "+r(z.value.presentes),1)]),_:1})])])]),_:1}),t(e(S),null,{default:s(()=>[l.puede_gestionar_participantes?(d(),v("div",ua,[t(e(w),{onClick:ie},{default:s(()=>[t(e(Ie),{class:"mr-2 h-4 w-4"}),a[16]||(a[16]=i(" Añadir Participantes "))]),_:1})])):x("",!0),T.value?(d(),v("div",pa,a[17]||(a[17]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):(d(),_(e(Ae),{key:2},{default:s(()=>[t(e(Pe),null,{default:s(()=>[t(e(L),null,{default:s(()=>[t(e(F),null,{default:s(()=>a[18]||(a[18]=[i("Nombre")])),_:1}),t(e(F),null,{default:s(()=>a[19]||(a[19]=[i("Email")])),_:1}),t(e(F),null,{default:s(()=>a[20]||(a[20]=[i("Tipo de Participación")])),_:1}),t(e(F),null,{default:s(()=>a[21]||(a[21]=[i("Asistencia")])),_:1}),t(e(F),null,{default:s(()=>a[22]||(a[22]=[i("Hora de Registro")])),_:1}),l.puede_gestionar_participantes?(d(),_(e(F),{key:0,class:"text-right"},{default:s(()=>a[23]||(a[23]=[i("Acciones")])),_:1})):x("",!0)]),_:1})]),_:1}),t(e(Se),null,{default:s(()=>[(d(!0),v(H,null,J($.value,n=>(d(),_(e(L),{key:n.id},{default:s(()=>[t(e(C),{class:"font-medium"},{default:s(()=>[i(r(n.name),1)]),_:2},1024),t(e(C),null,{default:s(()=>[i(r(n.email),1)]),_:2},1024),t(e(C),null,{default:s(()=>{var u;return[t(e(f),{class:Q(te(((u=n.pivot)==null?void 0:u.tipo_participacion)||"asistente"))},{default:s(()=>{var p;return[i(r(((p=n.pivot)==null?void 0:p.tipo_participacion)||"asistente"),1)]}),_:2},1032,["class"])]}),_:2},1024),t(e(C),null,{default:s(()=>{var u,p,c;return[l.puede_gestionar_participantes&&l.asamblea.estado==="en_curso"?(d(),v("div",ma,[t(e(G),{checked:((u=n.pivot)==null?void 0:u.asistio)||!1,disabled:D.value===n.id,"onUpdate:checked":me=>de(n.id,me)},null,8,["checked","disabled","onUpdate:checked"]),(p=n.pivot)!=null&&p.asistio?(d(),v("span",ca,"Presente")):(d(),v("span",fa,"Ausente"))])):(d(),v("div",_a,[(c=n.pivot)!=null&&c.asistio?(d(),_(e(f),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>a[24]||(a[24]=[i(" Presente ")])),_:1})):(d(),_(e(f),{key:1,variant:"outline"},{default:s(()=>a[25]||(a[25]=[i(" Ausente ")])),_:1}))]))]}),_:2},1024),t(e(C),null,{default:s(()=>{var u;return[i(r((u=n.pivot)!=null&&u.hora_registro?ae(n.pivot.hora_registro):"-"),1)]}),_:2},1024),l.puede_gestionar_participantes?(d(),_(e(C),{key:0,class:"text-right"},{default:s(()=>{var u;return[o("div",va,[t(e(R),{"model-value":((u=n.pivot)==null?void 0:u.tipo_participacion)||"asistente","onUpdate:modelValue":p=>re(n.id,p)},{default:s(()=>[t(e(W),{class:"w-32"},{default:s(()=>[t(e(O))]),_:1}),t(e(X),null,{default:s(()=>[t(e(U),{value:"asistente"},{default:s(()=>a[26]||(a[26]=[i("Asistente")])),_:1}),t(e(U),{value:"moderador"},{default:s(()=>a[27]||(a[27]=[i("Moderador")])),_:1}),t(e(U),{value:"secretario"},{default:s(()=>a[28]||(a[28]=[i("Secretario")])),_:1})]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"]),t(e(w),{variant:"ghost",size:"sm",onClick:p=>oe(n.id)},{default:s(()=>[t(e(He),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])]}),_:2},1024)):x("",!0)]),_:2},1024))),128)),$.value.length===0?(d(),_(e(L),{key:0},{default:s(()=>[t(e(C),{colspan:"6",class:"text-center py-8"},{default:s(()=>a[29]||(a[29]=[o("p",{class:"text-muted-foreground"},"No hay participantes registrados",-1)])),_:1})]),_:1})):x("",!0)]),_:1})]),_:1})),m.value.last_page>1?(d(),v("div",ga,[o("div",ba," Mostrando "+r(m.value.from)+" a "+r(m.value.to)+" de "+r(m.value.total)+" resultados ",1),o("div",ya,[t(e(w),{variant:"outline",size:"sm",disabled:m.value.current_page===1,onClick:a[0]||(a[0]=n=>I(m.value.current_page-1))},{default:s(()=>[t(e(Fe),{class:"h-4 w-4"}),a[30]||(a[30]=i(" Anterior "))]),_:1},8,["disabled"]),o("div",xa," Página "+r(m.value.current_page)+" de "+r(m.value.last_page),1),t(e(w),{variant:"outline",size:"sm",disabled:m.value.current_page===m.value.last_page,onClick:a[1]||(a[1]=n=>I(m.value.current_page+1))},{default:s(()=>[a[31]||(a[31]=i(" Siguiente ")),t(e(ve),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])):x("",!0)]),_:1})]),_:1}),l.asamblea.acta_url?(d(),_(e(h),{key:1},{default:s(()=>[t(e(A),null,{default:s(()=>[t(e(P),null,{default:s(()=>a[32]||(a[32]=[i("Acta de la Asamblea")])),_:1})]),_:1}),t(e(S),null,{default:s(()=>[o("a",{href:l.asamblea.acta_url,target:"_blank",class:"flex items-center gap-2 text-blue-600 hover:underline"},[t(e(ge),{class:"h-4 w-4"}),a[33]||(a[33]=i(" Ver Acta "))],8,ka)]),_:1})]),_:1})):x("",!0)]),t(e(be),{open:M.value,"onUpdate:open":a[4]||(a[4]=n=>M.value=n)},{default:s(()=>[t(e(ye),{class:"max-w-2xl"},{default:s(()=>[t(e(xe),null,{default:s(()=>[t(e(ke),null,{default:s(()=>a[34]||(a[34]=[i("Añadir Participantes")])),_:1}),t(e(we),null,{default:s(()=>a[35]||(a[35]=[i(" Selecciona los usuarios que deseas añadir como participantes de la asamblea ")])),_:1})]),_:1}),o("div",wa,[o("div",null,[a[39]||(a[39]=o("label",{class:"text-sm font-medium"},"Tipo de Participación",-1)),t(e(R),{modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=n=>N.value=n)},{default:s(()=>[t(e(W),null,{default:s(()=>[t(e(O))]),_:1}),t(e(X),null,{default:s(()=>[t(e(U),{value:"asistente"},{default:s(()=>a[36]||(a[36]=[i("Asistente")])),_:1}),t(e(U),{value:"moderador"},{default:s(()=>a[37]||(a[37]=[i("Moderador")])),_:1}),t(e(U),{value:"secretario"},{default:s(()=>a[38]||(a[38]=[i("Secretario")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",$a,[(d(!0),v(H,null,J(E.value,n=>(d(),v("div",{key:n.id,class:"flex items-center space-x-2 py-2"},[t(e(G),{id:`usuario-${n.id}`,checked:b.value.includes(n.id),"onUpdate:checked":u=>{if(u)b.value.push(n.id);else{const p=b.value.indexOf(n.id);p>-1&&b.value.splice(p,1)}}},null,8,["id","checked","onUpdate:checked"]),o("label",{for:`usuario-${n.id}`,class:"flex-1 cursor-pointer text-sm"},r(n.name)+" ("+r(n.email)+") ",9,Ca)]))),128)),E.value.length===0?(d(),v("p",ha," No hay usuarios disponibles para añadir ")):x("",!0)])]),t(e($e),null,{default:s(()=>[t(e(w),{variant:"outline",onClick:a[3]||(a[3]=n=>M.value=!1)},{default:s(()=>a[40]||(a[40]=[i(" Cancelar ")])),_:1}),t(e(w),{onClick:ne,disabled:b.value.length===0},{default:s(()=>[i(" Añadir "+r(b.value.length)+" Participante(s) ",1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{Ga as default};
