import{d as et,G as lt,r as j,c as st,W as S,m as ot,b as v,e as d,w as l,g as i,f as e,i as T,j as g,h as o,t as n,u as t,P as b,F as U,k as G,n as A}from"./app-D8b1iyhG.js";import{_ as at}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CNKKI51X.js";import{_ as y,a as k,b as V,c as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-CpubZFQk.js";import{_ as E}from"./createLucideIcon-BzCZ4Ux9.js";import{_ as rt}from"./Input.vue_vue_type_script_setup_true_lang-DEoN5cyd.js";import{_ as z}from"./index-BFz4Rjr1.js";import{_ as it,a as nt,b as B,c as _,d as dt,e as p}from"./TableHeader.vue_vue_type_script_setup_true_lang-Bmp4aWmy.js";import{_ as I,a as O,b as W,c as R,d as u}from"./SelectValue.vue_vue_type_script_setup_true_lang-BW9QKckn.js";import{_ as ut,a as ft,b as mt,d as pt,e as N,c as F}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Clw7uZZX.js";import{u as vt}from"./useToast-aZwvyph_.js";import{l as _t}from"./lodash-B2thv3E7.js";import{D as ct}from"./download-oSgoMRdn.js";import{P as xt}from"./plus-uXDWVO4e.js";import{F as q}from"./file-text-D-NxJb2x.js";import{C as D}from"./circle-alert-BAiY2yAu.js";import{D as gt}from"./dollar-sign-B2KbMwIi.js";import{S as bt}from"./search-CjcS3wba.js";import{E as yt}from"./ellipsis-C1mmiU54.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DfKxWH3N.js";import"./index-9EknitmW.js";import"./floating-ui.vue-D_44iLrk.js";import"./x-Di3hRZd2.js";import"./index-yOcDiT7U.js";import"./shield-CrMFR-sA.js";import"./user-DoEsQuJB.js";import"./chevron-right-C1p0_YAD.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D5C9pVNC.js";import"./VisuallyHidden-D42UHKy9.js";import"./index-_HrGOJG6.js";import"./Label.vue_vue_type_script_setup_true_lang-DXnOW2ZY.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CPkoHE-3.js";import"./index-DFpoRNc9.js";import"./map-pin-DH233x2C.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-D6e-kB5n.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CphnuyJe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-C6uCeRcr.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cl6UTNVG.js";import"./tag-DOh8ybwv.js";import"./users-bMGn_vPW.js";import"./target-9B9VxhTw.js";import"./vote-BNngkYIu.js";import"./folder-open-DzYKMiH4.js";import"./send-BGQbBVWn.js";import"./briefcase-CLa5E6pc.js";import"./calendar-C2mN7fi8.js";import"./megaphone-DB_W2_ij.js";import"./user-check-CENHsehh.js";import"./clipboard-list-CkSM2h9J.js";import"./mail-C9q7NsOX.js";import"./message-square-C_xQNDn7.js";import"./external-link-CoSv1yei.js";import"./panel-left-CtA1CDY4.js";import"./check-DAlbwhOo.js";import"./index-BPeLIox3.js";import"./nullish-CHIgUVhi.js";const wt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},$t={class:"flex justify-between items-center"},Ct={class:"text-3xl font-bold"},kt={key:0,class:"text-sm text-gray-600"},Vt={class:"flex gap-2"},Et={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},Ft={class:"text-2xl font-bold"},St={class:"text-2xl font-bold text-green-600"},Tt={class:"text-2xl font-bold text-red-600"},zt={class:"text-2xl font-bold text-yellow-600"},Dt={class:"text-2xl font-bold"},jt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},At={class:"relative"},Bt={class:"flex gap-2 mt-4"},Nt={class:"flex items-center gap-2"},Pt={key:0,class:"flex items-center justify-between"},Lt={class:"text-sm text-gray-600"},Mt={class:"flex gap-2"},Ie=et({__name:"Index",props:{contratos:{},filters:{},proyecto:{},estadisticas:{}},setup(H){const c=H,J=[{title:"Admin",href:"/admin/dashboard"},{title:"Contratos",href:"/admin/contratos"}];lt();const $=vt(),x=j(c.filters.search||""),f=j(c.filters.estado||"all"),m=j(c.filters.tipo||"all"),K=st(()=>x.value||f.value&&f.value!=="all"||m.value&&m.value!=="all"||c.filters.vencidos||c.filters.proximos_vencer),Q=a=>({borrador:"bg-gray-100 text-gray-800",activo:"bg-green-100 text-green-800",finalizado:"bg-blue-100 text-blue-800",cancelado:"bg-red-100 text-red-800"})[a]||"bg-gray-100 text-gray-800",X=a=>({servicio:"bg-purple-100 text-purple-800",obra:"bg-orange-100 text-orange-800",suministro:"bg-indigo-100 text-indigo-800",consultoria:"bg-pink-100 text-pink-800",otro:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800",P=a=>a?new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"-",L=_t.debounce(()=>{var a;S.get(route("admin.contratos.index"),{search:x.value||void 0,estado:f.value==="all"?void 0:f.value,tipo:m.value==="all"?void 0:m.value,proyecto_id:(a=c.proyecto)==null?void 0:a.id,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})},300);ot([x,f,m],()=>{L()});const Y=()=>{x.value="",f.value="all",m.value="all",L()},Z=a=>{confirm(`¿Está seguro de eliminar el contrato "${a.nombre}"?`)&&S.delete(route("admin.contratos.destroy",a.id),{onSuccess:()=>{$.success("Contrato eliminado exitosamente")},onError:()=>{$.error("Error al eliminar el contrato")}})},M=(a,s)=>{S.post(route("admin.contratos.cambiar-estado",a.id),{estado:s},{onSuccess:()=>{$.success("Estado actualizado exitosamente")},onError:()=>{$.error("Error al cambiar el estado")}})},h=a=>{confirm(`¿Desea duplicar el contrato "${a.nombre}"?`)&&S.post(route("admin.contratos.duplicar",a.id),{},{onSuccess:()=>{$.success("Contrato duplicado exitosamente")},onError:()=>{$.error("Error al duplicar el contrato")}})},tt=()=>{window.location.href=route("admin.contratos.export",{search:x.value||void 0,estado:f.value==="all"?void 0:f.value,tipo:m.value==="all"?void 0:m.value})};return(a,s)=>(d(),v(at,{breadcrumbs:J},{default:l(()=>[i("div",wt,[i("div",$t,[i("div",null,[i("h1",Ct,[s[3]||(s[3]=o(" Contratos ",-1)),a.proyecto?(d(),T("span",kt," del proyecto: "+n(a.proyecto.nombre),1)):g("",!0)]),s[4]||(s[4]=i("p",{class:"text-gray-600 mt-1"},"Gestiona los contratos de los proyectos",-1))]),i("div",Vt,[e(t(E),{variant:"outline",onClick:tt},{default:l(()=>[e(t(ct),{class:"h-4 w-4 mr-2"}),s[5]||(s[5]=o(" Exportar ",-1))]),_:1}),e(t(b),{href:a.proyecto?a.route("admin.proyectos.contratos.create",a.proyecto.id):a.route("admin.contratos.create")},{default:l(()=>[e(t(E),null,{default:l(()=>[e(t(xt),{class:"h-4 w-4 mr-2"}),s[6]||(s[6]=o(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])])]),i("div",Et,[e(t(y),null,{default:l(()=>[e(t(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(V),{class:"text-sm font-medium"},{default:l(()=>[...s[7]||(s[7]=[o("Total",-1)])]),_:1}),e(t(q),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),e(t(w),null,{default:l(()=>[i("div",Ft,n(a.estadisticas.total),1)]),_:1})]),_:1}),e(t(y),null,{default:l(()=>[e(t(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(V),{class:"text-sm font-medium"},{default:l(()=>[...s[8]||(s[8]=[o("Activos",-1)])]),_:1}),e(t(q),{class:"h-4 w-4 text-green-600"})]),_:1}),e(t(w),null,{default:l(()=>[i("div",St,n(a.estadisticas.activos),1)]),_:1})]),_:1}),e(t(y),null,{default:l(()=>[e(t(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(V),{class:"text-sm font-medium"},{default:l(()=>[...s[9]||(s[9]=[o("Vencidos",-1)])]),_:1}),e(t(D),{class:"h-4 w-4 text-red-600"})]),_:1}),e(t(w),null,{default:l(()=>[i("div",Tt,n(a.estadisticas.vencidos),1)]),_:1})]),_:1}),e(t(y),null,{default:l(()=>[e(t(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(V),{class:"text-sm font-medium"},{default:l(()=>[...s[10]||(s[10]=[o("Próximos a Vencer",-1)])]),_:1}),e(t(D),{class:"h-4 w-4 text-yellow-600"})]),_:1}),e(t(w),null,{default:l(()=>[i("div",zt,n(a.estadisticas.proximos_vencer),1)]),_:1})]),_:1}),e(t(y),null,{default:l(()=>[e(t(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(V),{class:"text-sm font-medium"},{default:l(()=>[...s[11]||(s[11]=[o("Monto Total",-1)])]),_:1}),e(t(gt),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),e(t(w),null,{default:l(()=>[i("div",Dt,n(a.estadisticas.monto_total),1)]),_:1})]),_:1})]),e(t(y),null,{default:l(()=>[e(t(k),null,{default:l(()=>[e(t(V),{class:"text-lg"},{default:l(()=>[...s[12]||(s[12]=[o("Filtros",-1)])]),_:1})]),_:1}),e(t(w),null,{default:l(()=>[i("div",jt,[i("div",null,[i("div",At,[e(t(bt),{class:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e(t(rt),{modelValue:x.value,"onUpdate:modelValue":s[0]||(s[0]=r=>x.value=r),placeholder:"Buscar contratos...",class:"pl-10"},null,8,["modelValue"])])]),e(t(I),{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=r=>f.value=r)},{default:l(()=>[e(t(O),null,{default:l(()=>[e(t(W),{placeholder:"Todos los estados"})]),_:1}),e(t(R),null,{default:l(()=>[e(t(u),{value:"all"},{default:l(()=>[...s[13]||(s[13]=[o("Todos los estados",-1)])]),_:1}),e(t(u),{value:"borrador"},{default:l(()=>[...s[14]||(s[14]=[o("Borrador",-1)])]),_:1}),e(t(u),{value:"activo"},{default:l(()=>[...s[15]||(s[15]=[o("Activo",-1)])]),_:1}),e(t(u),{value:"finalizado"},{default:l(()=>[...s[16]||(s[16]=[o("Finalizado",-1)])]),_:1}),e(t(u),{value:"cancelado"},{default:l(()=>[...s[17]||(s[17]=[o("Cancelado",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(t(I),{modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=r=>m.value=r)},{default:l(()=>[e(t(O),null,{default:l(()=>[e(t(W),{placeholder:"Todos los tipos"})]),_:1}),e(t(R),null,{default:l(()=>[e(t(u),{value:"all"},{default:l(()=>[...s[18]||(s[18]=[o("Todos los tipos",-1)])]),_:1}),e(t(u),{value:"servicio"},{default:l(()=>[...s[19]||(s[19]=[o("Servicio",-1)])]),_:1}),e(t(u),{value:"obra"},{default:l(()=>[...s[20]||(s[20]=[o("Obra",-1)])]),_:1}),e(t(u),{value:"suministro"},{default:l(()=>[...s[21]||(s[21]=[o("Suministro",-1)])]),_:1}),e(t(u),{value:"consultoria"},{default:l(()=>[...s[22]||(s[22]=[o("Consultoría",-1)])]),_:1}),e(t(u),{value:"otro"},{default:l(()=>[...s[23]||(s[23]=[o("Otro",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),K.value?(d(),v(t(E),{key:0,variant:"outline",onClick:Y},{default:l(()=>[...s[24]||(s[24]=[o(" Limpiar Filtros ",-1)])]),_:1})):g("",!0)]),i("div",Bt,[e(t(b),{href:a.route("admin.contratos.vencidos")},{default:l(()=>[e(t(E),{variant:"outline",size:"sm"},{default:l(()=>[e(t(D),{class:"h-4 w-4 mr-2 text-red-600"}),s[25]||(s[25]=o(" Ver Vencidos ",-1))]),_:1})]),_:1},8,["href"]),e(t(b),{href:a.route("admin.contratos.proximos-vencer")},{default:l(()=>[e(t(E),{variant:"outline",size:"sm"},{default:l(()=>[e(t(D),{class:"h-4 w-4 mr-2 text-yellow-600"}),s[26]||(s[26]=o(" Próximos a Vencer ",-1))]),_:1})]),_:1},8,["href"])])]),_:1})]),_:1}),e(t(y),null,{default:l(()=>[e(t(w),{class:"p-0"},{default:l(()=>[e(t(it),null,{default:l(()=>[e(t(nt),null,{default:l(()=>[e(t(B),null,{default:l(()=>[e(t(_),null,{default:l(()=>[...s[27]||(s[27]=[o("Nombre",-1)])]),_:1}),e(t(_),null,{default:l(()=>[...s[28]||(s[28]=[o("Proyecto",-1)])]),_:1}),e(t(_),null,{default:l(()=>[...s[29]||(s[29]=[o("Estado",-1)])]),_:1}),e(t(_),null,{default:l(()=>[...s[30]||(s[30]=[o("Tipo",-1)])]),_:1}),e(t(_),null,{default:l(()=>[...s[31]||(s[31]=[o("Fecha Inicio",-1)])]),_:1}),e(t(_),null,{default:l(()=>[...s[32]||(s[32]=[o("Fecha Fin",-1)])]),_:1}),e(t(_),null,{default:l(()=>[...s[33]||(s[33]=[o("Monto",-1)])]),_:1}),e(t(_),null,{default:l(()=>[...s[34]||(s[34]=[o("Responsable",-1)])]),_:1}),e(t(_),{class:"text-right"},{default:l(()=>[...s[35]||(s[35]=[o("Acciones",-1)])]),_:1})]),_:1})]),_:1}),e(t(dt),null,{default:l(()=>[(d(!0),T(U,null,G(a.contratos.data,r=>(d(),v(t(B),{key:r.id},{default:l(()=>[e(t(p),{class:"font-medium"},{default:l(()=>[i("div",Nt,[o(n(r.nombre)+" ",1),r.esta_vencido?(d(),v(t(z),{key:0,variant:"destructive",class:"text-xs"},{default:l(()=>[...s[36]||(s[36]=[o(" Vencido ",-1)])]),_:1})):r.esta_proximo_vencer?(d(),v(t(z),{key:1,variant:"outline",class:"text-xs text-yellow-600 border-yellow-600"},{default:l(()=>[o(n(r.dias_restantes)+" días ",1)]),_:2},1024)):g("",!0)])]),_:2},1024),e(t(p),null,{default:l(()=>[e(t(b),{href:a.route("admin.proyectos.show",r.proyecto.id),class:"text-blue-600 hover:underline"},{default:l(()=>[o(n(r.proyecto.nombre),1)]),_:2},1032,["href"])]),_:2},1024),e(t(p),null,{default:l(()=>[e(t(z),{class:A(Q(r.estado))},{default:l(()=>[o(n(r.estado),1)]),_:2},1032,["class"])]),_:2},1024),e(t(p),null,{default:l(()=>[e(t(z),{class:A(X(r.tipo))},{default:l(()=>[o(n(r.tipo),1)]),_:2},1032,["class"])]),_:2},1024),e(t(p),null,{default:l(()=>[o(n(P(r.fecha_inicio)),1)]),_:2},1024),e(t(p),null,{default:l(()=>[o(n(P(r.fecha_fin)),1)]),_:2},1024),e(t(p),null,{default:l(()=>[o(n(r.monto_formateado||"-"),1)]),_:2},1024),e(t(p),null,{default:l(()=>{var C;return[o(n(((C=r.responsable)==null?void 0:C.name)||"-"),1)]}),_:2},1024),e(t(p),{class:"text-right"},{default:l(()=>[e(t(ut),null,{default:l(()=>[e(t(ft),{asChild:""},{default:l(()=>[e(t(E),{variant:"ghost",size:"sm"},{default:l(()=>[e(t(yt),{class:"h-4 w-4"})]),_:1})]),_:1}),e(t(mt),{align:"end"},{default:l(()=>[e(t(pt),null,{default:l(()=>[...s[37]||(s[37]=[o("Acciones",-1)])]),_:1}),e(t(N)),e(t(b),{href:a.route("admin.contratos.show",r.id)},{default:l(()=>[e(t(F),null,{default:l(()=>[...s[38]||(s[38]=[o("Ver detalles",-1)])]),_:1})]),_:2},1032,["href"]),e(t(b),{href:a.route("admin.contratos.edit",r.id)},{default:l(()=>[e(t(F),null,{default:l(()=>[...s[39]||(s[39]=[o("Editar",-1)])]),_:1})]),_:2},1032,["href"]),e(t(N)),r.estado==="borrador"?(d(),v(t(F),{key:0,onClick:C=>M(r,"activo")},{default:l(()=>[...s[40]||(s[40]=[o(" Activar ",-1)])]),_:2},1032,["onClick"])):g("",!0),r.estado==="activo"?(d(),v(t(F),{key:1,onClick:C=>M(r,"finalizado")},{default:l(()=>[...s[41]||(s[41]=[o(" Finalizar ",-1)])]),_:2},1032,["onClick"])):g("",!0),e(t(F),{onClick:C=>h(r)},{default:l(()=>[...s[42]||(s[42]=[o(" Duplicar ",-1)])]),_:2},1032,["onClick"]),e(t(N)),e(t(F),{class:"text-red-600",onClick:C=>Z(r)},{default:l(()=>[...s[43]||(s[43]=[o(" Eliminar ",-1)])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),a.contratos.data.length===0?(d(),v(t(B),{key:0},{default:l(()=>[e(t(p),{colspan:"9",class:"text-center py-8 text-gray-500"},{default:l(()=>[...s[44]||(s[44]=[o(" No se encontraron contratos ",-1)])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),a.contratos.last_page>1?(d(),T("div",Pt,[i("p",Lt," Mostrando "+n(a.contratos.from)+" - "+n(a.contratos.to)+" de "+n(a.contratos.total)+" contratos ",1),i("div",Mt,[(d(!0),T(U,null,G(a.contratos.last_page,r=>(d(),v(t(b),{key:r,href:a.route("admin.contratos.index",{...c.filters,page:r}),class:A(["px-3 py-1 rounded text-sm",r===a.contratos.current_page?"bg-primary text-white":"bg-gray-100 hover:bg-gray-200"])},{default:l(()=>[o(n(r),1)]),_:2},1032,["href","class"]))),128))])])):g("",!0)])]),_:1}))}});export{Ie as default};
