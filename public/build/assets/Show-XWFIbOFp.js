import{_ as L}from"./index-BF1JDgfE.js";import{c as ke,_ as P}from"./createLucideIcon-tZKQ8FV-.js";import{a as B,b as H,c as q,_ as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-By0rrIVN.js";import{_ as Te,a as Me,b as se,c as de}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-BN4vYSdw.js";import{_ as Oe}from"./AdminLayout.vue_vue_type_script_setup_true_lang-a0Yimc9j.js";import{_ as re}from"./Progress.vue_vue_type_script_setup_true_lang-CazEhGy4.js";import{E as ue}from"./eye-pgBp_Zgj.js";import{C as ge}from"./circle-alert-B3cw7wFG.js";import{C as Xe}from"./chart-column-CcIuHeC5.js";import{M as le}from"./mail-DplI3j6U.js";import{M as oe}from"./message-square-BfcC0tAy.js";import{U as te}from"./users-CymRd8l_.js";import{M as Ie}from"./minus-BAeDjnBw.js";import{T as Ge}from"./trending-up-BAhvKGZv.js";import{d as he,c as X,i as v,g as t,j as x,e as a,w as s,f as e,h as d,n as K,t as o,b as g,x as ve,F as W,m as l,r as I,o as Se,k as ee,A as Ke,p as Je,s as ce,B as Qe,q as Ye,v as Fe}from"./app-BFqKuHja.js";import{C as Ze}from"./circle-check-6QBAtU4n.js";import{C as _e}from"./clock-CCWUE1Ut.js";import{C as De}from"./circle-x-BXqORzek.js";import{_ as Be,a as He,b as xe,c as J,d as qe,e as G}from"./TableHeader.vue_vue_type_script_setup_true_lang-DVyMhRir.js";import{_ as Ce,a as Ae}from"./index-C01_JZa5.js";import{_ as et,a as tt,b as at,c as st,e as lt}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DWo8uhvu.js";import{R as $e}from"./refresh-cw-BqbLQJ8a.js";import{C as ot}from"./circle-check-big-8EJmJICF.js";import{_ as Ee}from"./Input.vue_vue_type_script_setup_true_lang-BV39iPGt.js";import{_ as pe}from"./Label.vue_vue_type_script_setup_true_lang-Dqhxdf2C.js";import{_ as Le,a as Pe,b as ze,c as Ve,d as we,C as it}from"./SelectValue.vue_vue_type_script_setup_true_lang-Rq0QpW8I.js";import{S as nt}from"./search-Bo0C7ovi.js";import{X as rt}from"./x-Bmm2Newm.js";import{F as dt}from"./filter-C9Q57QdD.js";import{C as ut}from"./chevron-right-Cw5c0nod.js";import{t as V}from"./index-D11OkfIY.js";import{C as ct}from"./calendar-TQY1ssum.js";import{A as mt}from"./arrow-left-CIWApkUE.js";import{S as ft}from"./square-pen-B3ZyptEi.js";import{P as We,a as pt}from"./play-DWBJbx92.js";import{D as vt}from"./download-DZp9zUYc.js";import{S as _t}from"./send-B8eSg7eS.js";import"./index-F5rpf4iw.js";import"./VisuallyHidden-DP9KERvz.js";import"./RovingFocusItem-Dus7TRHC.js";import"./utils-Bif_DOLm.js";import"./useFlashMessages-Rq45FhUU.js";import"./index-C8QA5EYi.js";import"./floating-ui.vue-BMPmqikX.js";import"./index-BgOZXF3v.js";import"./shield-97w7M3te.js";import"./user-BAyKQNNj.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-FLlUFPmJ.js";import"./house-ChRKKXPV.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BEi-RCnv.js";import"./map-pin-C_udGJei.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-_5gfTs1o.js";import"./chevrons-up-down-BeNxFT55.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CG0Gldao.js";import"./target-BJiaG4BP.js";import"./vote-Xnz8P6lY.js";import"./folder-open-BYgWiTs_.js";import"./file-text-BGYDQgob.js";import"./briefcase-BxbIIMmV.js";import"./megaphone-i8HADNBc.js";import"./user-check-D1WCGWxM.js";import"./clipboard-list-DmGkpb4E.js";import"./external-link-e9aSyS64.js";import"./panel-left-DIEiSQw2.js";import"./check-C0Px08fC.js";import"./index-BY2HrsFe.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=ke("LinkIcon",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=ke("MousePointerIcon",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=ke("PercentIcon",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=ke("TrendingDownIcon",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),ht={class:"space-y-4"},yt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},wt={class:"flex items-center gap-2 mt-1"},$t={class:"text-xs text-muted-foreground"},kt={class:"text-xs text-muted-foreground mt-2"},bt={class:"flex items-center gap-2 mt-1"},Et={class:"text-xs text-muted-foreground"},Ct={class:"text-xs text-muted-foreground mt-2"},At={class:"flex items-center gap-2 mt-1"},jt={class:"text-xs text-muted-foreground"},Tt={class:"text-xs text-muted-foreground mt-2"},Mt={class:"text-2xl font-bold text-purple-600"},St={key:0,class:"grid gap-4 md:grid-cols-2"},Dt={class:"flex items-center justify-between"},Rt={class:"space-y-2"},It={class:"flex justify-between text-sm"},Ft={class:"font-medium"},Lt={class:"space-y-2"},Pt={class:"flex justify-between text-sm"},zt={class:"font-medium"},Vt={class:"grid grid-cols-2 gap-4 pt-2 border-t"},Wt={class:"text-lg font-semibold"},Ut={class:"text-lg font-semibold"},Nt={key:0,class:"pt-2 border-t"},Gt={class:"text-sm font-medium"},Bt={class:"flex items-center justify-between"},Ht={class:"space-y-2"},qt={class:"flex justify-between text-sm"},Ot={class:"font-medium"},Xt={class:"space-y-2"},Kt={class:"flex justify-between text-sm"},Jt={class:"font-medium text-red-600"},Qt={class:"pt-2 border-t"},Yt={class:"flex items-center justify-between"},Zt={class:"space-y-2"},ea={class:"flex justify-between text-sm"},ta={class:"font-medium"},aa={class:"space-y-2"},sa={class:"flex justify-between text-sm"},la={class:"font-medium text-red-600"},oa={class:"space-y-2"},ia={class:"flex justify-between text-sm"},na={class:"font-medium"},ra={class:"space-y-2"},da={class:"flex justify-between text-sm"},ua={class:"font-medium text-red-600"},ca={class:"pt-2 border-t"},ma={class:"flex items-center justify-between"},fa=he({__name:"CampanaMetrics",props:{metrics:{},comparison:{},showDetails:{type:Boolean,default:!0},tipo:{default:"ambos"},whatsappMode:{default:"individual"}},setup(u){const E=u,i=X(()=>E.tipo!=="email"&&["grupos","mixto"].includes(E.whatsappMode||"individual")),h=(r,n)=>{if(!n)return{icon:Ie,color:"text-gray-400",text:"--"};const k=r-n,b=Math.abs(k/n*100).toFixed(1);return Math.abs(k)<.5?{icon:Ie,color:"text-gray-400",text:"0%"}:k>0?{icon:Ge,color:"text-green-600",text:`+${b}%`}:{icon:gt,color:"text-red-600",text:`-${b}%`}},F=(r,n)=>{const b={apertura:{excellent:25,good:20,warning:15,poor:10},click:{excellent:10,good:5,warning:3,poor:2},rebote:{excellent:2,good:5,warning:10,poor:15},entrega:{excellent:98,good:95,warning:90,poor:85}}[n];return n==="rebote"?r<=b.excellent?"text-green-700":r<=b.good?"text-green-600":r<=b.warning?"text-yellow-600":"text-red-600":r>=b.excellent?"text-green-700":r>=b.good?"text-green-600":r>=b.warning?"text-yellow-600":r>=b.poor?"text-orange-600":"text-red-600"},M=X(()=>{const r=E.metrics;return{tasaEntrega:((r==null?void 0:r.total_enviados)||0)>0?(((r==null?void 0:r.total_enviados)||0)-((r==null?void 0:r.total_fallidos)||0))/((r==null?void 0:r.total_enviados)||1)*100:0,engagementRate:((r==null?void 0:r.emails_enviados)||0)>0?(((r==null?void 0:r.emails_abiertos)||0)+((r==null?void 0:r.emails_con_click)||0))/(((r==null?void 0:r.emails_enviados)||1)*2)*100:0,ctr:((r==null?void 0:r.emails_abiertos)||0)>0?((r==null?void 0:r.emails_con_click)||0)/((r==null?void 0:r.emails_abiertos)||1)*100:0,clicksPorUsuario:((r==null?void 0:r.emails_con_click)||0)>0?((r==null?void 0:r.total_clicks)||0)/((r==null?void 0:r.emails_con_click)||1):0,tasaExitoWhatsApp:((r==null?void 0:r.whatsapp_enviados)||0)>0?((r==null?void 0:r.whatsapp_entregados)||0)/((r==null?void 0:r.whatsapp_enviados)||1)*100:0}}),m=r=>r>=1e6?`${(r/1e6).toFixed(1)}M`:r>=1e3?`${(r/1e3).toFixed(1)}K`:r.toString();return(r,n)=>(l(),v("div",ht,[t("div",yt,[a(e(O),null,{default:s(()=>[a(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[a(e(H),{class:"text-sm font-medium"},{default:s(()=>[...n[0]||(n[0]=[d("Tasa de Apertura",-1)])]),_:1}),a(e(ue),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(e(q),null,{default:s(()=>{var k,b,C,A,S,T,D,w,_,$;return[t("div",{class:K(["text-2xl font-bold",F(((k=u.metrics)==null?void 0:k.tasa_apertura)||0,"apertura")])},o((((b=u.metrics)==null?void 0:b.tasa_apertura)||0).toFixed(1))+"% ",3),t("div",wt,[(l(),g(ve(h(((C=u.metrics)==null?void 0:C.tasa_apertura)||0,(A=u.comparison)==null?void 0:A.tasa_apertura_prev).icon),{class:K(["h-3 w-3",h(((S=u.metrics)==null?void 0:S.tasa_apertura)||0,(T=u.comparison)==null?void 0:T.tasa_apertura_prev).color])},null,8,["class"])),t("span",$t,o(h(((D=u.metrics)==null?void 0:D.tasa_apertura)||0,(w=u.comparison)==null?void 0:w.tasa_apertura_prev).text),1)]),t("p",kt,o(m(((_=u.metrics)==null?void 0:_.emails_abiertos)||0))+" de "+o(m((($=u.metrics)==null?void 0:$.emails_enviados)||0)),1)]}),_:1})]),_:1}),a(e(O),null,{default:s(()=>[a(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[a(e(H),{class:"text-sm font-medium"},{default:s(()=>[...n[1]||(n[1]=[d("Tasa de Clicks",-1)])]),_:1}),a(e(je),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(e(q),null,{default:s(()=>{var k,b,C,A,S,T,D,w,_;return[t("div",{class:K(["text-2xl font-bold",F(((k=u.metrics)==null?void 0:k.tasa_click)||0,"click")])},o((((b=u.metrics)==null?void 0:b.tasa_click)||0).toFixed(1))+"% ",3),t("div",bt,[(l(),g(ve(h(((C=u.metrics)==null?void 0:C.tasa_click)||0,(A=u.comparison)==null?void 0:A.tasa_click_prev).icon),{class:K(["h-3 w-3",h(((S=u.metrics)==null?void 0:S.tasa_click)||0,(T=u.comparison)==null?void 0:T.tasa_click_prev).color])},null,8,["class"])),t("span",Et,o(h(((D=u.metrics)==null?void 0:D.tasa_click)||0,(w=u.comparison)==null?void 0:w.tasa_click_prev).text),1)]),t("p",Ct,o(m(((_=u.metrics)==null?void 0:_.emails_con_click)||0))+" usuarios ",1)]}),_:1})]),_:1}),a(e(O),null,{default:s(()=>[a(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[a(e(H),{class:"text-sm font-medium"},{default:s(()=>[...n[2]||(n[2]=[d("Tasa de Rebote",-1)])]),_:1}),a(e(ge),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(e(q),null,{default:s(()=>{var k,b,C,A,S,T,D,w,_;return[t("div",{class:K(["text-2xl font-bold",F(((k=u.metrics)==null?void 0:k.tasa_rebote)||0,"rebote")])},o((((b=u.metrics)==null?void 0:b.tasa_rebote)||0).toFixed(1))+"% ",3),t("div",At,[(l(),g(ve(h(((C=u.metrics)==null?void 0:C.tasa_rebote)||0,(A=u.comparison)==null?void 0:A.tasa_rebote_prev).icon),{class:K(["h-3 w-3",h(((S=u.metrics)==null?void 0:S.tasa_rebote)||0,(T=u.comparison)==null?void 0:T.tasa_rebote_prev).color])},null,8,["class"])),t("span",jt,o(h(((D=u.metrics)==null?void 0:D.tasa_rebote)||0,(w=u.comparison)==null?void 0:w.tasa_rebote_prev).text),1)]),t("p",Tt,o(m(((_=u.metrics)==null?void 0:_.emails_rebotados)||0))+" rebotes ",1)]}),_:1})]),_:1}),a(e(O),null,{default:s(()=>[a(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[a(e(H),{class:"text-sm font-medium"},{default:s(()=>[...n[3]||(n[3]=[d("Engagement",-1)])]),_:1}),a(e(Xe),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(e(q),null,{default:s(()=>[t("div",Mt,o(M.value.engagementRate.toFixed(1))+"% ",1),n[4]||(n[4]=t("p",{class:"text-xs text-muted-foreground mt-3"}," Interacción general ",-1))]),_:1})]),_:1})]),u.showDetails?(l(),v("div",St,[a(e(O),null,{default:s(()=>[a(e(B),null,{default:s(()=>[t("div",Dt,[a(e(H),{class:"text-base flex items-center gap-2"},{default:s(()=>[a(e(le),{class:"h-4 w-4"}),n[5]||(n[5]=d(" Email ",-1))]),_:1}),a(e(L),{variant:"outline"},{default:s(()=>{var k;return[d(o(m(((k=u.metrics)==null?void 0:k.emails_enviados)||0))+" enviados ",1)]}),_:1})])]),_:1}),a(e(q),{class:"space-y-3"},{default:s(()=>{var k,b,C,A,S,T,D;return[t("div",Rt,[t("div",It,[n[6]||(n[6]=t("span",{class:"text-muted-foreground"},"Abiertos",-1)),t("span",Ft,o(m(((k=u.metrics)==null?void 0:k.emails_abiertos)||0)),1)]),a(e(re),{"model-value":((b=u.metrics)==null?void 0:b.tasa_apertura)||0,class:"h-2"},null,8,["model-value"])]),t("div",Lt,[t("div",Pt,[n[7]||(n[7]=t("span",{class:"text-muted-foreground"},"Con clicks",-1)),t("span",zt,o(m(((C=u.metrics)==null?void 0:C.emails_con_click)||0)),1)]),a(e(re),{"model-value":((A=u.metrics)==null?void 0:A.tasa_click)||0,class:"h-2"},null,8,["model-value"])]),t("div",Vt,[t("div",null,[n[8]||(n[8]=t("p",{class:"text-xs text-muted-foreground"},"Total clicks",-1)),t("p",Wt,o(m(((S=u.metrics)==null?void 0:S.total_clicks)||0)),1)]),t("div",null,[n[9]||(n[9]=t("p",{class:"text-xs text-muted-foreground"},"Clicks/usuario",-1)),t("p",Ut,o(M.value.clicksPorUsuario.toFixed(1)),1)])]),(((T=u.metrics)==null?void 0:T.tiempo_promedio_apertura)||0)>0?(l(),v("div",Nt,[n[10]||(n[10]=t("p",{class:"text-xs text-muted-foreground"},"Tiempo promedio hasta apertura",-1)),t("p",Gt,o((((D=u.metrics)==null?void 0:D.tiempo_promedio_apertura)||0).toFixed(0))+" min",1)])):x("",!0)]}),_:1})]),_:1}),a(e(O),null,{default:s(()=>[a(e(B),null,{default:s(()=>[t("div",Bt,[a(e(H),{class:"text-base flex items-center gap-2"},{default:s(()=>[a(e(oe),{class:"h-4 w-4"}),n[11]||(n[11]=d(" WhatsApp ",-1))]),_:1}),a(e(L),{variant:"outline"},{default:s(()=>{var k;return[d(o(m(((k=u.metrics)==null?void 0:k.whatsapp_enviados)||0))+" enviados ",1)]}),_:1})])]),_:1}),a(e(q),{class:"space-y-3"},{default:s(()=>{var k,b,C,A,S;return[i.value?(l(),g(e(Te),{key:0,"default-value":"contactos",class:"w-full"},{default:s(()=>[a(e(Me),{class:"grid w-full grid-cols-2 mb-4"},{default:s(()=>[a(e(se),{value:"contactos",class:"text-xs"},{default:s(()=>[a(e(oe),{class:"h-3 w-3 mr-1"}),n[12]||(n[12]=d(" Contactos ",-1))]),_:1}),a(e(se),{value:"grupos",class:"text-xs"},{default:s(()=>[a(e(te),{class:"h-3 w-3 mr-1"}),n[13]||(n[13]=d(" Grupos ",-1))]),_:1})]),_:1}),a(e(de),{value:"contactos",class:"space-y-3 mt-0"},{default:s(()=>{var T,D,w;return[t("div",Ht,[t("div",qt,[n[14]||(n[14]=t("span",{class:"text-muted-foreground"},"Entregados",-1)),t("span",Ot,o(m(((T=u.metrics)==null?void 0:T.whatsapp_individual_enviados)||((D=u.metrics)==null?void 0:D.whatsapp_entregados)||0)),1)]),a(e(re),{"model-value":M.value.tasaExitoWhatsApp,class:"h-2"},null,8,["model-value"])]),t("div",Xt,[t("div",Kt,[n[15]||(n[15]=t("span",{class:"text-muted-foreground"},"Fallidos",-1)),t("span",Jt,o(m(((w=u.metrics)==null?void 0:w.whatsapp_individual_fallidos)||0)),1)])]),t("div",Qt,[t("div",Yt,[n[16]||(n[16]=t("span",{class:"text-sm text-muted-foreground"},"Tasa de éxito",-1)),t("span",{class:K(["text-lg font-semibold",F(M.value.tasaExitoWhatsApp,"entrega")])},o(M.value.tasaExitoWhatsApp.toFixed(1))+"% ",3)])])]}),_:1}),a(e(de),{value:"grupos",class:"space-y-3 mt-0"},{default:s(()=>{var T,D,w,_,$;return[t("div",Zt,[t("div",ea,[n[17]||(n[17]=t("span",{class:"text-muted-foreground"},"Grupos enviados",-1)),t("span",ta,o(m(((T=u.metrics)==null?void 0:T.whatsapp_grupos_enviados)||0)),1)]),a(e(re),{"model-value":(((D=u.metrics)==null?void 0:D.whatsapp_grupos_total)||0)>0?(((w=u.metrics)==null?void 0:w.whatsapp_grupos_enviados)||0)/(((_=u.metrics)==null?void 0:_.whatsapp_grupos_total)||1)*100:0,class:"h-2"},null,8,["model-value"])]),t("div",aa,[t("div",sa,[n[18]||(n[18]=t("span",{class:"text-muted-foreground"},"Fallidos",-1)),t("span",la,o(m((($=u.metrics)==null?void 0:$.whatsapp_grupos_fallidos)||0)),1)])]),n[19]||(n[19]=t("div",{class:"pt-2 border-t text-xs text-muted-foreground"}," Los mensajes a grupos no tienen tracking individual de entrega. ",-1))]}),_:1})]),_:1})):(l(),v(W,{key:1},[t("div",oa,[t("div",ia,[n[20]||(n[20]=t("span",{class:"text-muted-foreground"},"Entregados",-1)),t("span",na,o(m(((k=u.metrics)==null?void 0:k.whatsapp_entregados)||0)),1)]),a(e(re),{"model-value":M.value.tasaExitoWhatsApp,class:"h-2"},null,8,["model-value"])]),t("div",ra,[t("div",da,[n[21]||(n[21]=t("span",{class:"text-muted-foreground"},"Fallidos",-1)),t("span",ua,o(m(((b=u.metrics)==null?void 0:b.whatsapp_fallidos)||0)),1)]),a(e(re),{"model-value":(((C=u.metrics)==null?void 0:C.whatsapp_enviados)||0)>0?(((A=u.metrics)==null?void 0:A.whatsapp_fallidos)||0)/(((S=u.metrics)==null?void 0:S.whatsapp_enviados)||1)*100:0,class:"h-2"},null,8,["model-value"])]),t("div",ca,[t("div",ma,[n[22]||(n[22]=t("span",{class:"text-sm text-muted-foreground"},"Tasa de éxito",-1)),t("span",{class:K(["text-lg font-semibold",F(M.value.tasaExitoWhatsApp,"entrega")])},o(M.value.tasaExitoWhatsApp.toFixed(1))+"% ",3)])])],64))]}),_:1})]),_:1})])):x("",!0)]))}}),pa={class:"flex justify-between items-center"},va={class:"space-y-2"},_a={class:"flex justify-between text-sm"},xa={class:"font-medium"},ga={class:"flex justify-between text-xs text-muted-foreground"},ha={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4"},ya={class:"space-y-1"},wa={class:"flex items-center gap-2"},$a={class:"text-2xl font-bold"},ka={class:"space-y-1"},ba={class:"flex items-center gap-2"},Ea={class:"text-2xl font-bold"},Ca={class:"text-xs text-muted-foreground"},Aa={class:"space-y-1"},ja={class:"flex items-center gap-2"},Ta={class:"text-2xl font-bold"},Ma={class:"space-y-1"},Sa={class:"flex items-center gap-2"},Da={class:"text-2xl font-bold"},Ra={class:"text-xs text-muted-foreground"},Ia={class:"space-y-1"},Fa={class:"flex items-center gap-2"},La={class:"text-2xl font-bold"},Pa={class:"space-y-1"},za={class:"flex items-center gap-2"},Va={class:"text-2xl font-bold"},Wa={key:0,class:"pt-2 border-t"},Ua={class:"flex justify-between items-center text-sm"},Na={key:0},Ga={class:"ml-2"},Ba={key:1},Ha={class:"ml-2 font-medium"},qa={key:1,class:"p-3 bg-red-50 border border-red-200 rounded-md"},Oa={class:"flex items-center gap-2"},Xa={class:"text-sm text-red-800"},Ka=he({__name:"CampanaProgress",props:{progreso:{},total:{},enviados:{},pendientes:{},fallidos:{},estado:{},velocidad:{},tiempoRestante:{},fechaInicio:{}},setup(u){const E=u,i=X(()=>{let r=0;if(E.progreso!==void 0)r=E.progreso;else{if(E.total===0)return 0;r=Math.round(E.enviados/E.total*100)}return Math.max(0,Math.min(r,100))}),h=X(()=>E.total===0?0:Math.round(E.fallidos/E.total*100)),F=X(()=>E.enviados===0?0:(E.enviados-E.fallidos)/E.enviados*100),M=r=>{if(!r)return"--";if(r<60)return`${Math.round(r)} min`;const n=Math.floor(r/60),k=Math.round(r%60);if(n<24)return`${n}h ${k}m`;const b=Math.floor(n/24),C=n%24;return`${b}d ${C}h`},m=r=>({iniciando:{variant:"default",text:"Iniciando"},enviando:{variant:"default",text:"Enviando"},pausada:{variant:"warning",text:"Pausada"},completada:{variant:"success",text:"Completada"},cancelada:{variant:"destructive",text:"Cancelada"},fallida:{variant:"destructive",text:"Fallida"}})[r]||{variant:"secondary",text:r};return(r,n)=>(l(),g(e(O),null,{default:s(()=>[a(e(B),null,{default:s(()=>[t("div",pa,[a(e(H),{class:"text-base"},{default:s(()=>[...n[0]||(n[0]=[d("Progreso de Envío",-1)])]),_:1}),a(e(L),{variant:m(u.estado).variant},{default:s(()=>[d(o(m(u.estado).text),1)]),_:1},8,["variant"])])]),_:1}),a(e(q),{class:"space-y-4"},{default:s(()=>[t("div",va,[t("div",_a,[n[1]||(n[1]=t("span",{class:"text-muted-foreground"},"Progreso total",-1)),t("span",xa,o(i.value)+"%",1)]),a(e(re),{"model-value":i.value,class:"h-3"},null,8,["model-value"]),t("div",ga,[t("span",null,o(u.enviados)+" enviados",1),t("span",null,o(u.total)+" total",1)])]),t("div",ha,[t("div",ya,[t("div",wa,[a(e(te),{class:"w-4 h-4 text-blue-600"}),n[2]||(n[2]=t("span",{class:"text-sm font-medium"},"Destinatarios",-1))]),t("p",$a,o(u.total.toLocaleString()),1),n[3]||(n[3]=t("p",{class:"text-xs text-muted-foreground"}," Total ",-1))]),t("div",ka,[t("div",ba,[a(e(Ze),{class:"w-4 h-4 text-green-600"}),n[4]||(n[4]=t("span",{class:"text-sm font-medium"},"Enviados",-1))]),t("p",Ea,o(u.enviados.toLocaleString()),1),t("p",Ca,o(i.value)+"% completado ",1)]),t("div",Aa,[t("div",ja,[a(e(_e),{class:"w-4 h-4 text-yellow-600"}),n[5]||(n[5]=t("span",{class:"text-sm font-medium"},"Pendientes",-1))]),t("p",Ta,o(u.pendientes.toLocaleString()),1),n[6]||(n[6]=t("p",{class:"text-xs text-muted-foreground"}," Por enviar ",-1))]),t("div",Ma,[t("div",Sa,[a(e(De),{class:"w-4 h-4 text-red-600"}),n[7]||(n[7]=t("span",{class:"text-sm font-medium"},"Fallidos",-1))]),t("p",Da,o(u.fallidos.toLocaleString()),1),t("p",Ra,o(h.value)+"% del total ",1)]),t("div",Ia,[t("div",Fa,[a(e(Ge),{class:"w-4 h-4 text-purple-600"}),n[8]||(n[8]=t("span",{class:"text-sm font-medium"},"Velocidad",-1))]),t("p",La,o(u.velocidad?u.velocidad.toFixed(1):"--"),1),n[9]||(n[9]=t("p",{class:"text-xs text-muted-foreground"}," envíos/min ",-1))]),t("div",Pa,[t("div",za,[a(e(xt),{class:"w-4 h-4 text-emerald-600"}),n[10]||(n[10]=t("span",{class:"text-sm font-medium"},"Tasa Entrega",-1))]),t("p",Va,o(F.value.toFixed(1))+"%",1),n[11]||(n[11]=t("p",{class:"text-xs text-muted-foreground"}," Éxito ",-1))])]),u.tiempoRestante||u.fechaInicio?(l(),v("div",Wa,[t("div",Ua,[u.fechaInicio?(l(),v("div",Na,[n[12]||(n[12]=t("span",{class:"text-muted-foreground"},"Iniciado:",-1)),t("span",Ga,o(new Date(u.fechaInicio).toLocaleString("es-CO")),1)])):x("",!0),u.tiempoRestante?(l(),v("div",Ba,[n[13]||(n[13]=t("span",{class:"text-muted-foreground"},"Tiempo restante:",-1)),t("span",Ha,o(M(u.tiempoRestante)),1)])):x("",!0)])])):x("",!0),h.value>10?(l(),v("div",qa,[t("div",Oa,[a(e(ge),{class:"w-4 h-4 text-red-600"}),t("span",Xa," Alta tasa de fallos ("+o(h.value)+"%). Revisa la configuración de envío. ",1)])])):x("",!0)]),_:1})]),_:1}))}}),Ja={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Qa={class:"text-sm text-muted-foreground mt-1"},Ya={class:"flex flex-wrap gap-2"},Za={key:1,class:"text-center py-8 text-muted-foreground"},es={key:2,class:"text-center py-8 text-muted-foreground"},ts={key:3,class:"overflow-x-auto"},as={key:0,class:"truncate"},ss={class:"font-medium text-green-700"},ls={class:"text-xs text-muted-foreground"},os=["title"],is={key:0,class:"space-y-4"},ns={class:"grid grid-cols-2 gap-4"},rs={class:"font-mono text-sm"},ds={class:"text-sm"},us={key:0,class:"p-3 bg-green-50 dark:bg-green-950 rounded-lg"},cs={class:"grid grid-cols-2 gap-2 text-sm"},ms={class:"ml-2 font-medium"},fs={class:"ml-2 font-medium"},ps={key:1},vs={class:"font-mono text-xs bg-muted p-2 rounded"},_s={key:2},xs={key:3},gs={class:"bg-muted p-3 rounded text-xs overflow-auto max-h-[200px]"},hs=he({__name:"CampanaLogs",props:{campanaId:{},tipo:{}},setup(u){const E=u,i=I([]),h=I("todos"),F=I(!1),M=I(null),m=I(null),r=I(!1),n=X(()=>h.value==="todos"?i.value:i.value.filter(w=>w.servicio===h.value)),k=X(()=>({email:i.value.filter(w=>w.servicio==="resend").length,waIndividual:i.value.filter(w=>w.servicio==="evolution_individual").length,waGrupo:i.value.filter(w=>w.servicio==="evolution_group").length})),b=X(()=>{const w=i.value.length,_=i.value.filter(Z=>["enviado","abierto","click"].includes(Z.estado)).length,$=i.value.filter(Z=>Z.estado==="fallido").length,Q=i.value.filter(Z=>["pendiente","enviando"].includes(Z.estado)).length;return{total:w,exitosos:_,fallidos:$,pendientes:Q}}),C=async()=>{F.value=!0,M.value=null;try{const w=await fetch(`/admin/envio-campanas/${E.campanaId}/logs`);if(!w.ok)throw new Error("Error al cargar logs");i.value=await w.json()}catch(w){M.value=w.message||"Error desconocido"}finally{F.value=!1}},A=w=>({pendiente:"secondary",enviando:"outline",enviado:"default",abierto:"default",click:"default",fallido:"destructive"})[w]||"secondary",S=w=>({pendiente:_e,enviando:_e,enviado:ot,abierto:ue,click:ue,fallido:De})[w]||_e,T=w=>{if(!w)return"-";try{return new Date(w).toLocaleString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return w}},D=w=>{m.value=w,r.value=!0};return Se(C),(w,_)=>(l(),v(W,null,[a(e(O),null,{default:s(()=>[a(e(B),null,{default:s(()=>[t("div",Ja,[t("div",null,[a(e(H),null,{default:s(()=>[..._[4]||(_[4]=[d("Logs de Envío",-1)])]),_:1}),t("p",Qa,o(b.value.total)+" registros | "+o(b.value.exitosos)+" exitosos | "+o(b.value.fallidos)+" fallidos ",1)]),t("div",Ya,[u.tipo!=="whatsapp"?(l(),g(e(P),{key:0,variant:h.value==="resend"?"default":"outline",size:"sm",onClick:_[0]||(_[0]=$=>h.value=h.value==="resend"?"todos":"resend")},{default:s(()=>[a(e(le),{class:"w-4 h-4 mr-1"}),_[5]||(_[5]=d(" Email ",-1)),k.value.email>0?(l(),g(e(L),{key:0,variant:"secondary",class:"ml-1 text-xs"},{default:s(()=>[d(o(k.value.email),1)]),_:1})):x("",!0)]),_:1},8,["variant"])):x("",!0),u.tipo!=="email"?(l(),g(e(P),{key:1,variant:h.value==="evolution_individual"?"default":"outline",size:"sm",onClick:_[1]||(_[1]=$=>h.value=h.value==="evolution_individual"?"todos":"evolution_individual")},{default:s(()=>[a(e(oe),{class:"w-4 h-4 mr-1"}),_[6]||(_[6]=d(" WA Individual ",-1)),k.value.waIndividual>0?(l(),g(e(L),{key:0,variant:"secondary",class:"ml-1 text-xs"},{default:s(()=>[d(o(k.value.waIndividual),1)]),_:1})):x("",!0)]),_:1},8,["variant"])):x("",!0),u.tipo!=="email"?(l(),g(e(P),{key:2,variant:h.value==="evolution_group"?"default":"outline",size:"sm",onClick:_[2]||(_[2]=$=>h.value=h.value==="evolution_group"?"todos":"evolution_group")},{default:s(()=>[a(e(te),{class:"w-4 h-4 mr-1"}),_[7]||(_[7]=d(" WA Grupos ",-1)),k.value.waGrupo>0?(l(),g(e(L),{key:0,variant:"secondary",class:"ml-1 text-xs"},{default:s(()=>[d(o(k.value.waGrupo),1)]),_:1})):x("",!0)]),_:1},8,["variant"])):x("",!0),a(e(P),{variant:"ghost",size:"sm",onClick:C,disabled:F.value},{default:s(()=>[a(e($e),{class:K(["w-4 h-4",{"animate-spin":F.value}])},null,8,["class"])]),_:1},8,["disabled"])])])]),_:1}),a(e(q),null,{default:s(()=>[M.value?(l(),g(e(Ce),{key:0,variant:"destructive",class:"mb-4"},{default:s(()=>[a(e(ge),{class:"h-4 w-4"}),a(e(Ae),null,{default:s(()=>[d(o(M.value),1)]),_:1})]),_:1})):x("",!0),F.value&&i.value.length===0?(l(),v("div",Za," Cargando logs... ")):n.value.length===0?(l(),v("div",es," No hay logs de envío disponibles ")):(l(),v("div",ts,[a(e(Be),null,{default:s(()=>[a(e(He),null,{default:s(()=>[a(e(xe),null,{default:s(()=>[a(e(J),{class:"w-[100px]"},{default:s(()=>[..._[8]||(_[8]=[d("Servicio",-1)])]),_:1}),a(e(J),null,{default:s(()=>[..._[9]||(_[9]=[d("Destinatario",-1)])]),_:1}),a(e(J),{class:"w-[100px]"},{default:s(()=>[..._[10]||(_[10]=[d("Estado",-1)])]),_:1}),a(e(J),null,{default:s(()=>[..._[11]||(_[11]=[d("Fecha",-1)])]),_:1}),a(e(J),null,{default:s(()=>[..._[12]||(_[12]=[d("ID Mensaje",-1)])]),_:1}),a(e(J),{class:"w-[80px]"},{default:s(()=>[..._[13]||(_[13]=[d("Acciones",-1)])]),_:1})]),_:1})]),_:1}),a(e(qe),null,{default:s(()=>[(l(!0),v(W,null,ee(n.value,$=>(l(),g(e(xe),{key:$.id},{default:s(()=>[a(e(G),null,{default:s(()=>[a(e(L),{variant:$.servicio==="resend"?"default":"secondary"},{default:s(()=>[$.servicio==="resend"?(l(),g(e(le),{key:0,class:"w-3 h-3 mr-1"})):$.servicio==="evolution_group"?(l(),g(e(te),{key:1,class:"w-3 h-3 mr-1"})):(l(),g(e(oe),{key:2,class:"w-3 h-3 mr-1"})),d(" "+o($.servicio==="resend"?"Email":$.servicio==="evolution_group"?"Grupo":"WA"),1)]),_:2},1032,["variant"])]),_:2},1024),a(e(G),{class:"max-w-[200px]"},{default:s(()=>{var Q;return[(Q=$.grupo)!=null&&Q.nombre?(l(),v("div",as,[t("div",ss,o($.grupo.nombre),1),t("div",ls,o($.grupo.participantes)+" participantes ",1)])):(l(),v("div",{key:1,class:"truncate",title:$.destinatario},o($.destinatario),9,os))]}),_:2},1024),a(e(G),null,{default:s(()=>[a(e(L),{variant:A($.estado)},{default:s(()=>[(l(),g(ve(S($.estado)),{class:"w-3 h-3 mr-1"})),d(" "+o($.estado),1)]),_:2},1032,["variant"])]),_:2},1024),a(e(G),{class:"text-sm"},{default:s(()=>[d(o(T($.fecha)),1)]),_:2},1024),a(e(G),{class:"font-mono text-xs max-w-[150px] truncate",title:$.mensaje_id||""},{default:s(()=>[d(o($.mensaje_id||"-"),1)]),_:2},1032,["title"]),a(e(G),null,{default:s(()=>[a(e(P),{variant:"ghost",size:"sm",onClick:Q=>D($)},{default:s(()=>[a(e(ue),{class:"w-4 h-4"})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1})]),_:1}),a(e(lt),{open:r.value,"onUpdate:open":_[3]||(_[3]=$=>r.value=$)},{default:s(()=>[a(e(et),{class:"max-w-2xl"},{default:s(()=>{var $;return[a(e(tt),null,{default:s(()=>[a(e(at),null,{default:s(()=>[..._[14]||(_[14]=[d("Detalles del Envío",-1)])]),_:1}),a(e(st),null,{default:s(()=>[..._[15]||(_[15]=[d(" Información completa del registro de envío ",-1)])]),_:1})]),_:1}),m.value?(l(),v("div",is,[t("div",ns,[t("div",null,[_[16]||(_[16]=t("p",{class:"text-sm text-muted-foreground"},"Servicio",-1)),a(e(L),{variant:m.value.servicio==="resend"?"default":"secondary"},{default:s(()=>[m.value.servicio==="resend"?(l(),g(e(le),{key:0,class:"w-3 h-3 mr-1"})):m.value.servicio==="evolution_group"?(l(),g(e(te),{key:1,class:"w-3 h-3 mr-1"})):(l(),g(e(oe),{key:2,class:"w-3 h-3 mr-1"})),d(" "+o(m.value.servicio==="resend"?"Email (Resend)":m.value.servicio==="evolution_group"?"WA Grupo":"WA Individual"),1)]),_:1},8,["variant"])]),t("div",null,[_[17]||(_[17]=t("p",{class:"text-sm text-muted-foreground"},"Estado",-1)),a(e(L),{variant:A(m.value.estado)},{default:s(()=>[d(o(m.value.estado),1)]),_:1},8,["variant"])]),t("div",null,[_[18]||(_[18]=t("p",{class:"text-sm text-muted-foreground"},"Destinatario",-1)),t("p",rs,o(m.value.destinatario),1)]),t("div",null,[_[19]||(_[19]=t("p",{class:"text-sm text-muted-foreground"},"Fecha de Envío",-1)),t("p",ds,o(T(m.value.fecha)),1)])]),($=m.value.grupo)!=null&&$.nombre?(l(),v("div",us,[_[22]||(_[22]=t("p",{class:"text-sm text-muted-foreground mb-2"},"Información del Grupo",-1)),t("div",cs,[t("div",null,[_[20]||(_[20]=t("span",{class:"text-muted-foreground"},"Nombre:",-1)),t("span",ms,o(m.value.grupo.nombre),1)]),t("div",null,[_[21]||(_[21]=t("span",{class:"text-muted-foreground"},"Participantes:",-1)),t("span",fs,o(m.value.grupo.participantes),1)])])])):x("",!0),m.value.mensaje_id?(l(),v("div",ps,[_[23]||(_[23]=t("p",{class:"text-sm text-muted-foreground"},"ID del Mensaje",-1)),t("p",vs,o(m.value.mensaje_id),1)])):x("",!0),m.value.error?(l(),v("div",_s,[_[24]||(_[24]=t("p",{class:"text-sm text-muted-foreground"},"Error",-1)),a(e(Ce),{variant:"destructive"},{default:s(()=>[a(e(ge),{class:"h-4 w-4"}),a(e(Ae),null,{default:s(()=>[d(o(m.value.error),1)]),_:1})]),_:1})])):x("",!0),m.value.metadata&&Object.keys(m.value.metadata).length>0?(l(),v("div",xs,[_[25]||(_[25]=t("p",{class:"text-sm text-muted-foreground mb-2"},"Metadata",-1)),t("pre",gs,o(JSON.stringify(m.value.metadata,null,2)),1)])):x("",!0)])):x("",!0)]}),_:1})]),_:1},8,["open"])],64))}}),ys={class:"flex flex-col gap-4"},ws={class:"flex justify-between items-center"},$s={class:"flex items-center gap-2"},ks={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-3 p-4 bg-muted/50 rounded-lg"},bs={class:"lg:col-span-2"},Es={class:"relative"},Cs={class:"lg:col-span-6 flex justify-end gap-2 pt-2 border-t mt-2"},As={key:1,class:"text-center py-8 text-muted-foreground"},js={key:2,class:"text-center py-8 text-muted-foreground"},Ts={key:3,class:"space-y-4"},Ms={class:"flex items-center gap-2"},Ss={key:2},Ds={class:"font-medium"},Rs={class:"text-sm text-muted-foreground"},Is={key:3,class:"flex items-center gap-2"},Fs={class:"font-medium text-green-700"},Ls={class:"text-sm text-muted-foreground"},Ps={key:4},zs={class:"font-medium text-muted-foreground"},Vs={key:0,class:"flex items-center gap-1"},Ws={key:1,class:"text-muted-foreground"},Us={key:1,class:"text-muted-foreground text-xs"},Ns={key:0,class:"flex items-center gap-1"},Gs={key:1,class:"text-muted-foreground"},Bs={key:1,class:"text-muted-foreground text-xs"},Hs={class:"bg-muted/30 p-4"},qs={key:0,class:"space-y-2"},Os={class:"text-muted-foreground text-xs"},Xs={key:1,class:"text-sm text-muted-foreground"},Ks={key:0,class:"space-y-2"},Js={key:0},Qs={class:"flex items-center gap-2 text-sm"},Ys={class:"font-medium"},Zs={class:"text-xs text-muted-foreground ml-5"},el={class:"truncate"},tl={key:0},al={key:1},sl={class:"flex items-center gap-2 text-sm"},ll={class:"font-medium"},ol={class:"text-xs text-muted-foreground ml-5"},il={class:"truncate"},nl={key:1,class:"text-sm text-muted-foreground"},rl={key:1,class:"space-y-3"},dl={class:"grid grid-cols-2 gap-4 text-sm"},ul={class:"ml-2 font-medium"},cl={class:"ml-2 font-medium"},ml={class:"col-span-2"},fl={class:"ml-2 text-xs bg-muted px-2 py-1 rounded"},pl={key:2,class:"space-y-3"},vl={class:"grid grid-cols-2 gap-4 text-sm"},_l={class:"ml-2 font-medium"},xl={class:"ml-2 font-medium"},gl={key:0,class:"text-sm text-destructive"},hl={class:"flex flex-col sm:flex-row items-center justify-between gap-4"},yl={class:"text-sm text-muted-foreground"},wl={key:0,class:"flex items-center gap-2"},$l=["innerHTML"],kl=he({__name:"ActividadReciente",props:{campanaId:{},tipo:{}},setup(u){const E=u,i=I(null),h=I(!1),F=I(null),M=I([]),m=I({tipo:"__all__",estado:"__all__",search:"",fecha_desde:"",fecha_hasta:""}),r=I(1),n=X(()=>E.tipo==="email"?[{value:"email",label:"Email"}]:E.tipo==="whatsapp"?[{value:"whatsapp",label:"WhatsApp"},{value:"whatsapp_group",label:"Grupo WhatsApp"}]:[{value:"email",label:"Email"},{value:"whatsapp",label:"WhatsApp"},{value:"whatsapp_group",label:"Grupo WhatsApp"}]),k=[{value:"pendiente",label:"Pendiente"},{value:"enviando",label:"Enviando"},{value:"enviado",label:"Enviado"},{value:"abierto",label:"Abierto"},{value:"click",label:"Con Click"},{value:"fallido",label:"Fallido"}],b=X(()=>m.value.tipo!=="__all__"&&m.value.tipo!==""||m.value.estado!=="__all__"&&m.value.estado!==""||m.value.search!==""||m.value.fecha_desde!==""||m.value.fecha_hasta!==""),C=X(()=>{let y=0;return m.value.tipo&&m.value.tipo!=="__all__"&&y++,m.value.estado&&m.value.estado!=="__all__"&&y++,m.value.search&&y++,m.value.fecha_desde&&y++,m.value.fecha_hasta&&y++,y}),A=()=>{const y=new URLSearchParams;return y.append("page",r.value.toString()),m.value.tipo&&m.value.tipo!=="__all__"&&y.append("tipo",m.value.tipo),m.value.estado&&m.value.estado!=="__all__"&&y.append("estado",m.value.estado),m.value.search&&y.append("search",m.value.search),m.value.fecha_desde&&y.append("fecha_desde",m.value.fecha_desde),m.value.fecha_hasta&&y.append("fecha_hasta",m.value.fecha_hasta),`/admin/envio-campanas/${E.campanaId}/envios?${y.toString()}`},S=async()=>{h.value=!0,F.value=null;try{const y=await fetch(A(),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!y.ok)throw new Error("Error al cargar actividad");const f=await y.json();if(f.success)i.value=f.envios;else throw new Error(f.message||"Error desconocido")}catch(y){F.value=y.message||"Error desconocido"}finally{h.value=!1}},T=()=>{r.value=1,S()},D=()=>{m.value={tipo:"__all__",estado:"__all__",search:"",fecha_desde:"",fecha_hasta:""},r.value=1,S()},w=y=>{if(!y)return;const p=new URL(y,window.location.origin).searchParams.get("page");p&&(r.value=parseInt(p),S())},_=y=>{const f=M.value.indexOf(y);f>-1?M.value.splice(f,1):M.value.push(y)},$=y=>{if(!y)return"-";try{return new Date(y).toLocaleString("es-ES")}catch{return y}},Q=y=>{if(!y)return"-";try{return new Date(y).toLocaleTimeString("es-ES")}catch{return y}},Z=y=>["enviado","abierto","click"].includes(y)?"default":y==="fallido"?"destructive":"secondary",ie=X(()=>E.tipo==="email"||E.tipo==="ambos");return Se(S),(y,f)=>(l(),g(e(O),null,{default:s(()=>[a(e(B),null,{default:s(()=>{var p;return[t("div",ys,[t("div",ws,[t("div",$s,[a(e(H),null,{default:s(()=>[...f[5]||(f[5]=[d("Actividad Reciente",-1)])]),_:1}),(p=i.value)!=null&&p.total?(l(),g(e(L),{key:0,variant:"secondary"},{default:s(()=>[d(o(i.value.total)+" envíos ",1)]),_:1})):x("",!0)]),a(e(P),{onClick:S,variant:"outline",size:"sm",disabled:h.value},{default:s(()=>[a(e($e),{class:K(["w-4 h-4",{"animate-spin":h.value}])},null,8,["class"])]),_:1},8,["disabled"])]),t("div",ks,[t("div",bs,[a(e(pe),{class:"text-xs text-muted-foreground"},{default:s(()=>[...f[6]||(f[6]=[d("Buscar destinatario",-1)])]),_:1}),t("div",Es,[a(e(nt),{class:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a(e(Ee),{modelValue:m.value.search,"onUpdate:modelValue":f[0]||(f[0]=j=>m.value.search=j),placeholder:"Email, teléfono, nombre...",class:"pl-8",onKeyup:Ke(T,["enter"])},null,8,["modelValue"])])]),t("div",null,[a(e(pe),{class:"text-xs text-muted-foreground"},{default:s(()=>[...f[7]||(f[7]=[d("Tipo",-1)])]),_:1}),a(e(Le),{modelValue:m.value.tipo,"onUpdate:modelValue":f[1]||(f[1]=j=>m.value.tipo=j)},{default:s(()=>[a(e(Pe),null,{default:s(()=>[a(e(ze),{placeholder:"Todos"})]),_:1}),a(e(Ve),null,{default:s(()=>[a(e(we),{value:"__all__"},{default:s(()=>[...f[8]||(f[8]=[d("Todos",-1)])]),_:1}),(l(!0),v(W,null,ee(n.value,j=>(l(),g(e(we),{key:j.value,value:j.value},{default:s(()=>[d(o(j.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),t("div",null,[a(e(pe),{class:"text-xs text-muted-foreground"},{default:s(()=>[...f[9]||(f[9]=[d("Estado",-1)])]),_:1}),a(e(Le),{modelValue:m.value.estado,"onUpdate:modelValue":f[2]||(f[2]=j=>m.value.estado=j)},{default:s(()=>[a(e(Pe),null,{default:s(()=>[a(e(ze),{placeholder:"Todos"})]),_:1}),a(e(Ve),null,{default:s(()=>[a(e(we),{value:"__all__"},{default:s(()=>[...f[10]||(f[10]=[d("Todos",-1)])]),_:1}),(l(),v(W,null,ee(k,j=>a(e(we),{key:j.value,value:j.value},{default:s(()=>[d(o(j.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),t("div",null,[a(e(pe),{class:"text-xs text-muted-foreground"},{default:s(()=>[...f[11]||(f[11]=[d("Desde",-1)])]),_:1}),a(e(Ee),{modelValue:m.value.fecha_desde,"onUpdate:modelValue":f[3]||(f[3]=j=>m.value.fecha_desde=j),type:"date"},null,8,["modelValue"])]),t("div",null,[a(e(pe),{class:"text-xs text-muted-foreground"},{default:s(()=>[...f[12]||(f[12]=[d("Hasta",-1)])]),_:1}),a(e(Ee),{modelValue:m.value.fecha_hasta,"onUpdate:modelValue":f[4]||(f[4]=j=>m.value.fecha_hasta=j),type:"date"},null,8,["modelValue"])]),t("div",Cs,[b.value?(l(),g(e(P),{key:0,variant:"ghost",size:"sm",onClick:D},{default:s(()=>[a(e(rt),{class:"w-4 h-4 mr-1"}),f[13]||(f[13]=d(" Limpiar ",-1))]),_:1})):x("",!0),a(e(P),{variant:"default",size:"sm",onClick:T,disabled:h.value},{default:s(()=>[a(e(dt),{class:"w-4 h-4 mr-1"}),f[14]||(f[14]=d(" Aplicar filtros ",-1)),C.value>0?(l(),g(e(L),{key:0,variant:"secondary",class:"ml-1"},{default:s(()=>[d(o(C.value),1)]),_:1})):x("",!0)]),_:1},8,["disabled"])])])])]}),_:1}),a(e(q),null,{default:s(()=>[F.value?(l(),g(e(Ce),{key:0,variant:"destructive",class:"mb-4"},{default:s(()=>[a(e(ge),{class:"h-4 w-4"}),a(e(Ae),null,{default:s(()=>[d(o(F.value),1)]),_:1})]),_:1})):x("",!0),h.value&&!i.value?(l(),v("div",As,[a(e($e),{class:"w-6 h-6 animate-spin mx-auto mb-2"}),f[15]||(f[15]=d(" Cargando actividad... ",-1))])):i.value&&i.value.data.length===0?(l(),v("div",js,[a(e(le),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),f[16]||(f[16]=d(" No hay envíos que mostrar ",-1))])):i.value?(l(),v("div",Ts,[a(e(Be),null,{default:s(()=>[a(e(He),null,{default:s(()=>[a(e(xe),null,{default:s(()=>[a(e(J),{class:"w-[100px]"},{default:s(()=>[...f[17]||(f[17]=[d("Tipo",-1)])]),_:1}),a(e(J),null,{default:s(()=>[...f[18]||(f[18]=[d("Destinatario",-1)])]),_:1}),a(e(J),null,{default:s(()=>[...f[19]||(f[19]=[d("Estado",-1)])]),_:1}),a(e(J),null,{default:s(()=>[...f[20]||(f[20]=[d("Fecha Envío",-1)])]),_:1}),ie.value?(l(),g(e(J),{key:0},{default:s(()=>[...f[21]||(f[21]=[d("Apertura",-1)])]),_:1})):x("",!0),ie.value?(l(),g(e(J),{key:1},{default:s(()=>[...f[22]||(f[22]=[d("Clicks",-1)])]),_:1})):x("",!0)]),_:1})]),_:1}),a(e(qe),null,{default:s(()=>[(l(!0),v(W,null,ee(i.value.data,p=>(l(),v(W,{key:p.id},[a(e(xe),{onClick:j=>_(p.id),class:"cursor-pointer hover:bg-muted/50 transition-colors"},{default:s(()=>[a(e(G),null,{default:s(()=>[a(e(L),{variant:p.tipo==="email"?"default":"secondary",class:"text-xs"},{default:s(()=>[p.tipo==="email"?(l(),g(e(le),{key:0,class:"w-3 h-3 mr-1"})):p.tipo==="whatsapp_group"?(l(),g(e(te),{key:1,class:"w-3 h-3 mr-1"})):(l(),g(e(oe),{key:2,class:"w-3 h-3 mr-1"})),d(" "+o(p.tipo==="email"?"Email":p.tipo==="whatsapp_group"?"Grupo":"WA"),1)]),_:2},1032,["variant"])]),_:2},1024),a(e(G),null,{default:s(()=>[t("div",Ms,[M.value.includes(p.id)?(l(),g(e(it),{key:1,class:"w-4 h-4 flex-shrink-0"})):(l(),g(e(ut),{key:0,class:"w-4 h-4 flex-shrink-0"})),p.user?(l(),v("div",Ss,[t("div",Ds,o(p.user.nombre),1),t("div",Rs,o(p.user.email||p.destinatario),1)])):p.grupo?(l(),v("div",Is,[t("div",null,[t("div",Fs,o(p.grupo.nombre),1),t("div",Ls,o(p.grupo.participantes)+" participantes ",1)])])):(l(),v("div",Ps,[t("div",zs,o(p.destinatario),1)]))])]),_:2},1024),a(e(G),null,{default:s(()=>[a(e(L),{variant:Z(p.estado)},{default:s(()=>[d(o(p.estado),1)]),_:2},1032,["variant"])]),_:2},1024),a(e(G),null,{default:s(()=>[d(o($(p.fecha_enviado)),1)]),_:2},1024),ie.value?(l(),g(e(G),{key:0},{default:s(()=>[p.tipo==="email"?(l(),v(W,{key:0},[p.fecha_abierto?(l(),v("div",Vs,[a(e(ue),{class:"w-3 h-3"}),d(" "+o(Q(p.fecha_abierto))+" ",1),p.aperturas_count&&p.aperturas_count>1?(l(),g(e(L),{key:0,variant:"secondary",class:"ml-1"},{default:s(()=>[d(o(p.aperturas_count),1)]),_:2},1024)):x("",!0)])):(l(),v("span",Ws,"-"))],64)):(l(),v("span",Us,"N/A"))]),_:2},1024)):x("",!0),ie.value?(l(),g(e(G),{key:1},{default:s(()=>[p.tipo==="email"?(l(),v(W,{key:0},[p.fecha_primer_click?(l(),v("div",Ns,[a(e(je),{class:"w-3 h-3"}),d(" "+o(Q(p.fecha_primer_click))+" ",1),p.clicks_count&&p.clicks_count>1?(l(),g(e(L),{key:0,variant:"secondary",class:"ml-1"},{default:s(()=>[d(o(p.clicks_count),1)]),_:2},1024)):x("",!0)])):(l(),v("span",Gs,"-"))],64)):(l(),v("span",Bs,"N/A"))]),_:2},1024)):x("",!0)]),_:2},1032,["onClick"]),M.value.includes(p.id)?(l(),g(e(xe),{key:0},{default:s(()=>[a(e(G),{colspan:ie.value?6:4,class:"p-0"},{default:s(()=>{var j,ae,ye,R;return[t("div",Hs,[p.tipo==="email"?(l(),g(e(Te),{key:0,"default-value":"aperturas",class:"w-full"},{default:s(()=>[a(e(Me),{class:"grid w-full max-w-md grid-cols-2"},{default:s(()=>[a(e(se),{value:"aperturas"},{default:s(()=>[a(e(ue),{class:"w-4 h-4 mr-2"}),d(" Aperturas "+o(p.aperturas_count?`(${p.aperturas_count})`:""),1)]),_:2},1024),a(e(se),{value:"clics"},{default:s(()=>[a(e(je),{class:"w-4 h-4 mr-2"}),d(" Clics "+o(p.clicks_count?`(${p.clicks_count})`:""),1)]),_:2},1024)]),_:2},1024),a(e(de),{value:"aperturas",class:"mt-4"},{default:s(()=>{var c,U;return[(U=(c=p.metadata)==null?void 0:c.aperturas)!=null&&U.length?(l(),v("div",qs,[f[23]||(f[23]=t("div",{class:"text-sm font-medium mb-2"},"Historial de aperturas:",-1)),(l(!0),v(W,null,ee(p.metadata.aperturas,(N,z)=>(l(),v("div",{key:z,class:"flex items-center gap-2 text-sm p-2 bg-background rounded"},[a(e(ue),{class:"w-3 h-3 text-muted-foreground"}),t("span",null,o($(N.timestamp)),1),t("span",Os,o(N.ip),1)]))),128))])):(l(),v("div",Xs," No hay registros de apertura "))]}),_:2},1024),a(e(de),{value:"clics",class:"mt-4"},{default:s(()=>{var c,U,N,z,Y,me,fe,Re;return[(U=(c=p.metadata)==null?void 0:c.clicks)!=null&&U.length||(z=(N=p.metadata)==null?void 0:N.clicks_detail)!=null&&z.length?(l(),v("div",Ks,[f[24]||(f[24]=t("div",{class:"text-sm font-medium mb-2"},"Historial de clics:",-1)),(me=(Y=p.metadata)==null?void 0:Y.clicks_detail)!=null&&me.length?(l(),v("div",Js,[(l(!0),v(W,null,ee(p.metadata.clicks_detail,(ne,be)=>(l(),v("div",{key:`click-${be}`,class:"p-2 bg-background rounded space-y-1"},[t("div",Qs,[a(e(Ue),{class:"w-3 h-3 text-muted-foreground"}),t("span",Ys,o($(ne.clicked_at)),1)]),t("div",Zs,[t("div",el,"URL: "+o(ne.url),1),ne.ip?(l(),v("div",tl,"IP: "+o(ne.ip),1)):x("",!0)])]))),128))])):(Re=(fe=p.metadata)==null?void 0:fe.clicks)!=null&&Re.length?(l(),v("div",al,[(l(!0),v(W,null,ee(p.metadata.clicks,(ne,be)=>(l(),v("div",{key:`click-${be}`,class:"p-2 bg-background rounded space-y-1"},[t("div",sl,[a(e(Ue),{class:"w-3 h-3 text-muted-foreground"}),t("span",ll,o($(ne.timestamp)),1)]),t("div",ol,[t("div",il,"URL: "+o(ne.url),1)])]))),128))])):x("",!0)])):(l(),v("div",nl," No hay registros de clics "))]}),_:2},1024)]),_:2},1024)):p.tipo==="whatsapp_group"?(l(),v("div",rl,[f[28]||(f[28]=t("div",{class:"text-sm font-medium"},"Información del Grupo",-1)),t("div",dl,[t("div",null,[f[25]||(f[25]=t("span",{class:"text-muted-foreground"},"Nombre:",-1)),t("span",ul,o(((j=p.grupo)==null?void 0:j.nombre)||((ae=p.metadata)==null?void 0:ae.group_nombre)||"N/A"),1)]),t("div",null,[f[26]||(f[26]=t("span",{class:"text-muted-foreground"},"Participantes:",-1)),t("span",cl,o(((ye=p.grupo)==null?void 0:ye.participantes)||((R=p.metadata)==null?void 0:R.group_participantes)||"N/A"),1)]),t("div",ml,[f[27]||(f[27]=t("span",{class:"text-muted-foreground"},"JID:",-1)),t("code",fl,o(p.destinatario),1)])]),f[29]||(f[29]=t("div",{class:"text-xs text-muted-foreground mt-2"}," WhatsApp no soporta tracking de aperturas ni clics para grupos. ",-1))])):(l(),v("div",pl,[f[32]||(f[32]=t("div",{class:"text-sm font-medium"},"Información del Envío",-1)),t("div",vl,[t("div",null,[f[30]||(f[30]=t("span",{class:"text-muted-foreground"},"Destinatario:",-1)),t("span",_l,o(p.destinatario),1)]),t("div",null,[f[31]||(f[31]=t("span",{class:"text-muted-foreground"},"Estado:",-1)),t("span",xl,o(p.estado),1)])]),p.error?(l(),v("div",gl," Error: "+o(p.error),1)):x("",!0),f[33]||(f[33]=t("div",{class:"text-xs text-muted-foreground mt-2"}," WhatsApp no soporta tracking de aperturas ni clics. ",-1))]))])]}),_:2},1032,["colspan"])]),_:2},1024)):x("",!0)],64))),128))]),_:1})]),_:1}),t("div",hl,[t("div",yl," Mostrando "+o(i.value.from||0)+" a "+o(i.value.to||0)+" de "+o(i.value.total)+" resultados ",1),i.value.links&&i.value.links.length>3?(l(),v("div",wl,[(l(!0),v(W,null,ee(i.value.links,p=>(l(),v(W,{key:p.label},[p.url?(l(),g(e(P),{key:0,variant:p.active?"default":"outline",size:"sm",onClick:j=>w(p.url),innerHTML:p.label.replace("« Previous","← Anterior").replace("Next »","Siguiente →")},null,8,["variant","onClick","innerHTML"])):(l(),v("span",{key:1,class:"px-3 py-1 text-sm text-muted-foreground cursor-not-allowed",innerHTML:p.label.replace("« Previous","← Anterior").replace("Next »","Siguiente →")},null,8,$l))],64))),128))])):x("",!0)])])):x("",!0)]),_:1})]),_:1}))}}),bl={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},El={class:"flex justify-between items-start"},Cl={class:"flex items-center gap-3"},Al={class:"text-3xl font-bold"},jl={key:0,class:"flex items-center gap-1 text-xs"},Tl={key:0,class:"text-muted-foreground mt-1"},Ml={class:"flex items-center gap-4 mt-2 text-sm text-muted-foreground flex-wrap"},Sl={class:"flex items-center gap-1"},Dl={class:"capitalize"},Rl={key:0,class:"flex items-center gap-1"},Il={key:1,class:"flex items-center gap-1"},Fl={key:2,class:"flex items-center gap-1"},Ll={key:3,class:"flex items-center gap-1"},Pl={class:"flex items-center gap-1 text-xs"},zl={class:"flex gap-2"},Vl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wl={class:"flex justify-between"},Ul={class:"flex justify-between"},Nl={key:0,class:"flex justify-between"},Gl={key:1,class:"flex justify-between"},Bl={key:2,class:"flex justify-between"},Hl={key:0},ql={class:"flex items-center gap-2 mb-1"},Ol={class:"pl-6 text-sm"},Xl={class:"text-muted-foreground"},Kl={key:1},Jl={class:"flex items-center gap-2 mb-1"},Ql={class:"pl-6 text-sm"},Yl={class:"flex items-center justify-between"},Zl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},eo={class:"flex items-center gap-2"},to={class:"font-medium truncate"},ao={class:"mt-3 pt-3 border-t text-sm text-muted-foreground"},so={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},lo={key:0},oo={class:"font-medium"},io={key:1},no={class:"font-medium"},ro={key:2},uo={class:"font-medium"},co={key:3},mo={class:"font-medium"},Ne=3,Ei=he({__name:"Show",props:{campana:{},metricas:{},comparacion:{},tendencias:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canPause:{type:Boolean},canResume:{type:Boolean},canCancel:{type:Boolean}},setup(u){const E=u,i=I(E.campana),h=I(E.metricas),F=I(E.comparacion),M=I(E.tendencias),m=[{title:"Admin",href:"/admin/dashboard"},{title:"Campañas",href:"/admin/envio-campanas"},{title:i.value.nombre,href:"#"}],r=["resumen","actividad","logs","tendencias"],k=I((()=>{const c=new URLSearchParams(window.location.search).get("tab");return c&&r.includes(c)?c:"resumen"})());Je(k,R=>{const c=`/admin/envio-campanas/${i.value.id}?tab=${R}`;ce.get(c,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]})});const b=I(!1);let C=null;const A=I(!0),S=I(5e3),T=I(new Date),D=X(()=>{const R=h.value.total_destinatarios||1,c=h.value.total_enviados||0,U=Math.round(c/R*100);return Math.min(U,100)}),w=R=>({borrador:"secondary",programada:"outline",enviando:"default",completada:"default",pausada:"warning",cancelada:"destructive"})[R]||"secondary",_=R=>R==="email"?le:R==="whatsapp"?oe:_t,$=()=>{ce.post(`/admin/envio-campanas/${i.value.id}/send`,{},{onSuccess:()=>{V.success("Campaña iniciada exitosamente"),i.value.estado="enviando",j(),y()},onError:()=>{V.error("Error al iniciar la campaña")}})},Q=()=>{ce.post(`/admin/envio-campanas/${i.value.id}/pause`,{},{onSuccess:()=>{V.success("Campaña pausada"),i.value.estado="pausada",y()},onError:()=>{V.error("Error al pausar la campaña")}})},Z=()=>{ce.post(`/admin/envio-campanas/${i.value.id}/resume`,{},{onSuccess:()=>{V.success("Campaña reanudada"),i.value.estado="enviando",j(),y()},onError:()=>{V.error("Error al reanudar la campaña")}})},ie=()=>{confirm("¿Estás seguro de cancelar esta campaña? Esta acción no se puede deshacer.")&&ce.post(`/admin/envio-campanas/${i.value.id}/cancel`,{},{onSuccess:()=>{V.success("Campaña cancelada"),i.value.estado="cancelada",ae(),y()},onError:()=>{V.error("Error al cancelar la campaña")}})},y=async()=>{if(!b.value){b.value=!0;try{const R=await fetch(`/admin/envio-campanas/${i.value.id}/metrics`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const c=await R.json();if(c.success){c.metricas&&(h.value={...h.value,...c.metricas}),c.estado&&(i.value.estado=c.estado),c.progreso,T.value=new Date;const U=c.estado==="completada"&&h.value.total_enviados>=h.value.total_destinatarios,N=c.estado==="cancelada";U||N?(ae(),U?V.success("¡Campaña completada exitosamente! 🎉"):N&&V.info("Campaña cancelada. Auto-actualización detenida.")):c.estado==="completada"&&D.value<100&&console.warn("[CampanaMetrics] Estado completada pero progreso incompleto, continuando actualización...")}}catch(R){console.error("Error refreshing metrics:",R),A.value||V.error("Error al actualizar métricas")}finally{b.value=!1}}},f=()=>{ce.post(`/admin/envio-campanas/${i.value.id}/export`,{formato:"excel",incluir_detalles:!0},{onSuccess:()=>{V.success("Reporte exportado exitosamente")},onError:()=>{V.error("Error al exportar el reporte")}})};let p=0;const j=()=>{C&&clearInterval(C);let R=S.value;i.value.estado==="enviando"?R=2e3:i.value.estado==="programada"&&(R=5e3),C=setInterval(()=>{A.value&&y().catch(c=>{p++,console.error("[AutoRefresh] Error consecutivo",p,"de",Ne),p>=Ne&&(console.error("[AutoRefresh] Demasiados errores consecutivos, deteniendo auto-refresh"),ae(),V.error('Auto-actualización detenida por errores. Haz clic en "Auto OFF" para reactivar.'))}).then(()=>{p>0&&(p=0)})},R),A.value=!0,p=0},ae=()=>{C&&(clearInterval(C),C=null),A.value=!1,p=0},ye=()=>{A.value?(ae(),V.info("Auto-actualización detenida")):(j(),V.success("Auto-actualización activada"),y())};return Se(()=>{["enviando","programada","pausada"].includes(i.value.estado)&&j(),setTimeout(()=>{y()},1e3)}),Qe(()=>{ae()}),(R,c)=>(l(),g(Oe,{breadcrumbs:m},{default:s(()=>{var U;return[a(e(Ye),{title:`Campaña: ${i.value.nombre}`},null,8,["title"]),t("div",bl,[t("div",El,[t("div",null,[t("div",Cl,[t("h1",Al,o(i.value.nombre),1),a(e(L),{variant:w(i.value.estado),class:"text-sm"},{default:s(()=>[d(o(i.value.estado),1)]),_:1},8,["variant"]),A.value?(l(),v("div",jl,[...c[1]||(c[1]=[t("div",{class:"w-2 h-2 bg-green-500 rounded-full animate-pulse"},null,-1),t("span",{class:"text-muted-foreground"},"Actualizando...",-1)])])):x("",!0)]),i.value.descripcion?(l(),v("p",Tl,o(i.value.descripcion),1)):x("",!0),t("div",Ml,[t("div",Sl,[(l(),g(ve(_(i.value.tipo)),{class:"w-4 h-4"})),t("span",Dl,o(i.value.tipo),1)]),i.value.tipo!=="email"&&i.value.whatsapp_mode?(l(),v("div",Rl,[a(e(L),{variant:"outline",class:"text-xs"},{default:s(()=>[d(o(i.value.whatsapp_mode==="grupos"?"Solo Grupos":i.value.whatsapp_mode==="mixto"?"Mixto":"Individual"),1)]),_:1})])):x("",!0),(U=i.value.whatsapp_groups)!=null&&U.length?(l(),v("div",Il,[a(e(te),{class:"w-4 h-4 text-green-600"}),t("span",null,o(i.value.whatsapp_groups.length)+" grupo(s)",1)])):x("",!0),i.value.segment?(l(),v("div",Fl,[a(e(te),{class:"w-4 h-4"}),t("span",null,o(i.value.segment.name),1)])):x("",!0),i.value.fecha_programada?(l(),v("div",Ll,[a(e(ct),{class:"w-4 h-4"}),t("span",null,o(i.value.fecha_programada?new Date(i.value.fecha_programada).toLocaleString("es-ES"):"-"),1)])):x("",!0),t("div",Pl,[a(e(_e),{class:"w-3 h-3"}),t("span",null,"Actualizado: "+o(T.value.toLocaleTimeString("es-ES")),1)])])]),t("div",zl,[a(e(Fe),{href:"/admin/envio-campanas"},{default:s(()=>[a(e(P),{variant:"outline"},{default:s(()=>[a(e(mt),{class:"w-4 h-4 mr-2"}),c[2]||(c[2]=d(" Volver ",-1))]),_:1})]),_:1}),a(e(P),{onClick:ye,variant:"outline",class:K({"border-green-500":A.value})},{default:s(()=>[a(e($e),{class:K(["w-4 h-4 mr-2",{"animate-spin":b.value}])},null,8,["class"]),d(" "+o(A.value?"Auto ON":"Auto OFF"),1)]),_:1},8,["class"]),u.canEdit&&i.value.estado==="borrador"?(l(),g(e(Fe),{key:0,href:`/admin/envio-campanas/${i.value.id}/edit`},{default:s(()=>[a(e(P),{variant:"outline"},{default:s(()=>[a(e(ft),{class:"w-4 h-4 mr-2"}),c[3]||(c[3]=d(" Editar ",-1))]),_:1})]),_:1},8,["href"])):x("",!0),i.value.estado==="borrador"?(l(),g(e(P),{key:1,onClick:$,variant:"default"},{default:s(()=>[a(e(We),{class:"w-4 h-4 mr-2"}),c[4]||(c[4]=d(" Iniciar Envío ",-1))]),_:1})):x("",!0),u.canPause&&i.value.estado==="enviando"?(l(),g(e(P),{key:2,onClick:Q,variant:"warning"},{default:s(()=>[a(e(pt),{class:"w-4 h-4 mr-2"}),c[5]||(c[5]=d(" Pausar ",-1))]),_:1})):x("",!0),u.canResume&&i.value.estado==="pausada"?(l(),g(e(P),{key:3,onClick:Z,variant:"default"},{default:s(()=>[a(e(We),{class:"w-4 h-4 mr-2"}),c[6]||(c[6]=d(" Reanudar ",-1))]),_:1})):x("",!0),u.canCancel&&["borrador","programada","pausada"].includes(i.value.estado)?(l(),g(e(P),{key:4,onClick:ie,variant:"destructive"},{default:s(()=>[a(e(De),{class:"w-4 h-4 mr-2"}),c[7]||(c[7]=d(" Cancelar ",-1))]),_:1})):x("",!0),a(e(P),{onClick:f,variant:"outline"},{default:s(()=>[a(e(vt),{class:"w-4 h-4 mr-2"}),c[8]||(c[8]=d(" Exportar ",-1))]),_:1})])]),a(e(Te),{modelValue:k.value,"onUpdate:modelValue":c[0]||(c[0]=N=>k.value=N)},{default:s(()=>[a(e(Me),null,{default:s(()=>[a(e(se),{value:"resumen"},{default:s(()=>[...c[9]||(c[9]=[d("Resumen",-1)])]),_:1}),a(e(se),{value:"actividad"},{default:s(()=>[...c[10]||(c[10]=[d("Actividad Reciente",-1)])]),_:1}),a(e(se),{value:"logs"},{default:s(()=>[...c[11]||(c[11]=[d("Logs",-1)])]),_:1}),M.value&&M.value.length>0?(l(),g(e(se),{key:0,value:"tendencias"},{default:s(()=>[...c[12]||(c[12]=[d(" Tendencias ",-1)])]),_:1})):x("",!0)]),_:1}),a(e(de),{value:"resumen",class:"space-y-4"},{default:s(()=>{var N;return[["enviando","completada","pausada"].includes(i.value.estado)?(l(),g(Ka,{key:0,progreso:D.value,total:h.value.total_destinatarios,enviados:h.value.total_enviados,pendientes:h.value.total_pendientes,fallidos:h.value.total_fallidos,estado:i.value.estado,"fecha-inicio":i.value.fecha_inicio},null,8,["progreso","total","enviados","pendientes","fallidos","estado","fecha-inicio"])):x("",!0),a(fa,{metrics:h.value,comparison:F.value,tipo:i.value.tipo,"whatsapp-mode":i.value.whatsapp_mode},null,8,["metrics","comparison","tipo","whatsapp-mode"]),t("div",Vl,[a(e(O),null,{default:s(()=>[a(e(B),null,{default:s(()=>[a(e(H),null,{default:s(()=>[...c[13]||(c[13]=[d("Información de la Campaña",-1)])]),_:1})]),_:1}),a(e(q),{class:"space-y-3"},{default:s(()=>{var z,Y;return[t("div",Wl,[c[14]||(c[14]=t("span",{class:"text-muted-foreground"},"Creada por:",-1)),t("span",null,o(((z=i.value.created_by)==null?void 0:z.nombre)||((Y=i.value.created_by)==null?void 0:Y.name)||"Sistema"),1)]),t("div",Ul,[c[15]||(c[15]=t("span",{class:"text-muted-foreground"},"Fecha creación:",-1)),t("span",null,o(new Date(i.value.created_at).toLocaleDateString("es-ES")),1)]),i.value.fecha_inicio?(l(),v("div",Nl,[c[16]||(c[16]=t("span",{class:"text-muted-foreground"},"Inicio envío:",-1)),t("span",null,o(i.value.fecha_inicio?new Date(i.value.fecha_inicio).toLocaleString("es-ES"):"-"),1)])):x("",!0),i.value.fecha_fin?(l(),v("div",Gl,[c[17]||(c[17]=t("span",{class:"text-muted-foreground"},"Fin envío:",-1)),t("span",null,o(i.value.fecha_fin?new Date(i.value.fecha_fin).toLocaleString("es-ES"):"-"),1)])):x("",!0),h.value.tiempo_promedio_envio?(l(),v("div",Bl,[c[18]||(c[18]=t("span",{class:"text-muted-foreground"},"Tiempo promedio:",-1)),t("span",null,o(h.value.tiempo_promedio_envio)+"s por envío",1)])):x("",!0)]}),_:1})]),_:1}),a(e(O),null,{default:s(()=>[a(e(B),null,{default:s(()=>[a(e(H),null,{default:s(()=>[...c[19]||(c[19]=[d("Plantillas Utilizadas",-1)])]),_:1})]),_:1}),a(e(q),{class:"space-y-3"},{default:s(()=>[i.value.plantilla_email?(l(),v("div",Hl,[t("div",ql,[a(e(le),{class:"w-4 h-4 text-muted-foreground"}),c[20]||(c[20]=t("span",{class:"font-medium"},"Email:",-1))]),t("div",Ol,[t("div",null,o(i.value.plantilla_email.nombre),1),t("div",Xl," Asunto: "+o(i.value.plantilla_email.asunto),1)])])):x("",!0),i.value.plantilla_whats_app?(l(),v("div",Kl,[t("div",Jl,[a(e(oe),{class:"w-4 h-4 text-muted-foreground"}),c[21]||(c[21]=t("span",{class:"font-medium"},"WhatsApp:",-1))]),t("div",Ql,o(i.value.plantilla_whats_app.nombre),1)])):x("",!0)]),_:1})]),_:1}),(N=i.value.whatsapp_groups)!=null&&N.length?(l(),g(e(O),{key:0,class:"md:col-span-2"},{default:s(()=>[a(e(B),null,{default:s(()=>[t("div",Yl,[a(e(H),null,{default:s(()=>[...c[22]||(c[22]=[d("Grupos de WhatsApp",-1)])]),_:1}),a(e(L),{variant:"outline"},{default:s(()=>[d(" Modo: "+o(i.value.whatsapp_mode==="grupos"?"Solo Grupos":i.value.whatsapp_mode==="mixto"?"Mixto":"Individual"),1)]),_:1})])]),_:1}),a(e(q),null,{default:s(()=>[t("div",Zl,[(l(!0),v(W,null,ee(i.value.whatsapp_groups,z=>(l(),v("div",{key:z.id,class:"flex items-center justify-between p-3 bg-muted/50 rounded-lg"},[t("div",eo,[a(e(te),{class:"w-4 h-4 text-green-600 flex-shrink-0"}),t("span",to,o(z.nombre),1)]),a(e(L),{variant:"secondary",class:"flex-shrink-0"},{default:s(()=>[d(o(z.participantes_count)+" participantes ",1)]),_:2},1024)]))),128))]),t("div",ao," Total: "+o(i.value.whatsapp_groups.length)+" grupo(s) • "+o(i.value.whatsapp_groups.reduce((z,Y)=>z+(Y.participantes_count||0),0))+" participantes ",1)]),_:1})]),_:1})):x("",!0)]),i.value.configuracion?(l(),g(e(O),{key:1},{default:s(()=>[a(e(B),null,{default:s(()=>[a(e(H),null,{default:s(()=>[...c[23]||(c[23]=[d("Configuración de Envío",-1)])]),_:1})]),_:1}),a(e(q),null,{default:s(()=>{var z,Y,me,fe;return[t("div",so,[(z=i.value.configuracion)!=null&&z.batch_size_email?(l(),v("div",lo,[c[24]||(c[24]=t("div",{class:"text-sm text-muted-foreground"},"Tamaño de lote (Email)",-1)),t("div",oo,o(i.value.configuracion.batch_size_email)+" emails/lote",1)])):x("",!0),(Y=i.value.configuracion)!=null&&Y.batch_size_whatsapp?(l(),v("div",io,[c[25]||(c[25]=t("div",{class:"text-sm text-muted-foreground"},"Tamaño de lote (WhatsApp)",-1)),t("div",no,o(i.value.configuracion.batch_size_whatsapp)+" mensajes/lote",1)])):x("",!0),((me=i.value.configuracion)==null?void 0:me.enable_pixel_tracking)!==void 0?(l(),v("div",ro,[c[26]||(c[26]=t("div",{class:"text-sm text-muted-foreground"},"Tracking de apertura",-1)),t("div",uo,o(i.value.configuracion.enable_pixel_tracking?"Habilitado":"Deshabilitado"),1)])):x("",!0),((fe=i.value.configuracion)==null?void 0:fe.enable_click_tracking)!==void 0?(l(),v("div",co,[c[27]||(c[27]=t("div",{class:"text-sm text-muted-foreground"},"Tracking de clicks",-1)),t("div",mo,o(i.value.configuracion.enable_click_tracking?"Habilitado":"Deshabilitado"),1)])):x("",!0)])]}),_:1})]),_:1})):x("",!0)]}),_:1}),a(e(de),{value:"actividad"},{default:s(()=>[a(kl,{"campana-id":i.value.id,tipo:i.value.tipo},null,8,["campana-id","tipo"])]),_:1}),a(e(de),{value:"logs"},{default:s(()=>[a(hs,{"campana-id":i.value.id,tipo:i.value.tipo},null,8,["campana-id","tipo"])]),_:1})]),_:1},8,["modelValue"])])]}),_:1}))}});export{Ei as default};
