import{d as Z,u as ee,r as C,c as E,i as c,l as se,e as a,b as y,j as u,f as e,w as r,h as d,g as f,n as h,t as m,F as R,k as F,m as i}from"./app-_uW1dugG.js";import{_ as U,a as B,b as I,c as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-BPO4jmee.js";import{_ as x}from"./createLucideIcon-Cgfvt99-.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-DN97Gps1.js";import{_ as oe}from"./Textarea.vue_vue_type_script_setup_true_lang-DWYMKOMu.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-zswzwbwY.js";import{a as ae,_ as re}from"./index-BS7bgA2L.js";import{_ as j,a as D,b as N,c as T,d as A}from"./SelectValue.vue_vue_type_script_setup_true_lang-Bh_XafA_.js";import{_ as te}from"./CamposPersonalizadosForm.vue_vue_type_script_setup_true_lang-DkH8EH3l.js";import{E as le}from"./EtiquetaSelector-Bi7Z3Man.js";import{_ as ie}from"./GestoresManager.vue_vue_type_script_setup_true_lang-CSph2BdA.js";import{_ as ne}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-CGtIWgvZ.js";import{t as M}from"./index-B6xDyQoH.js";import{X as G}from"./x-DpMkz8bM.js";import{U as de}from"./user-plus-C4TKYTjh.js";import{T as ue}from"./tag-ChJj5ULy.js";import{C as ce}from"./circle-alert-BmkZpFMv.js";import{S as me}from"./save-Isl7F08c.js";const pe={key:0,class:"mt-1 text-sm text-red-600"},fe={key:0,class:"mt-1 text-sm text-red-600"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},be={key:0,class:"mt-1 text-sm text-red-600"},ye={key:0,class:"mt-1 text-sm text-red-600"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={key:0,class:"mt-1 text-sm text-red-600"},he={key:0,class:"mt-1 text-sm text-red-600"},xe={key:0},Ve={class:"space-y-2"},ke={key:0,class:"p-3 bg-muted rounded-lg flex items-center justify-between"},Ce={class:"font-medium"},Ue={class:"text-sm text-muted-foreground"},$e={key:0,class:"mt-1 text-sm text-red-600"},we={key:1},Se={key:0,class:"mt-1 text-sm text-red-600"},He=Z({__name:"ProyectoFormFields",props:{proyecto:{},camposPersonalizados:{},valoresCampos:{},categorias:{},gestores:{},submitUrl:{},cancelUrl:{},showResponsable:{type:Boolean,default:!1},showGestores:{type:Boolean,default:!1},searchUsersEndpoint:{},estados:{default:()=>({})},prioridades:{default:()=>({})}},emits:["cancel","success"],setup(p,{emit:L}){var q,z;const n=p,S=L,P=l=>l?l.split(" ")[0]:"",V={};n.valoresCampos&&n.camposPersonalizados.forEach(l=>{V[l.id]=n.valoresCampos[l.id]||n.valoresCampos[l.slug]||""});const o=ee({nombre:n.proyecto.nombre,descripcion:n.proyecto.descripcion||"",fecha_inicio:P(n.proyecto.fecha_inicio),fecha_fin:P(n.proyecto.fecha_fin),estado:n.proyecto.estado,prioridad:n.proyecto.prioridad,responsable_id:n.proyecto.responsable_id||null,etiquetas:((q=n.proyecto.etiquetas)==null?void 0:q.map(l=>l.id))||[],gestores:((z=n.gestores)==null?void 0:z.map(l=>l.id))||[],campos_personalizados:V}),g=C(!1),k=C(!1),b=C(n.proyecto.responsable||null),O={planificacion:"Planificación",en_progreso:"En Progreso",pausado:"Pausado",completado:"Completado",cancelado:"Cancelado"},X={baja:"Baja",media:"Media",alta:"Alta",critica:"Crítica"},H=E(()=>Object.keys(n.estados).length>0?n.estados:O),J=E(()=>Object.keys(n.prioridades).length>0?n.prioridades:X),K=()=>{g.value=!0,o.put(n.submitUrl,{preserveScroll:!0,onSuccess:()=>{M.success("Proyecto actualizado exitosamente"),S("success")},onError:l=>{M.error("Error al actualizar el proyecto"),console.error(l)},onFinish:()=>{g.value=!1}})},Q=()=>{S("cancel")},W=l=>{o.campos_personalizados=l},Y=l=>{l.userIds.length>0&&(o.responsable_id=l.userIds[0],l.users&&l.users.length>0&&(b.value=l.users[0]))};return(l,s)=>(i(),c("form",{onSubmit:se(K,["prevent"]),class:"space-y-6"},[a(e(U),null,{default:r(()=>[a(e(B),null,{default:r(()=>[a(e(I),null,{default:r(()=>[...s[11]||(s[11]=[d("Información Básica",-1)])]),_:1})]),_:1}),a(e($),{class:"space-y-4"},{default:r(()=>[f("div",null,[a(e(_),{for:"nombre"},{default:r(()=>[...s[12]||(s[12]=[d("Nombre del Proyecto *",-1)])]),_:1}),a(e(w),{id:"nombre",modelValue:e(o).nombre,"onUpdate:modelValue":s[0]||(s[0]=t=>e(o).nombre=t),type:"text",placeholder:"Ingrese el nombre del proyecto",class:h({"border-red-500":e(o).errors.nombre}),required:""},null,8,["modelValue","class"]),e(o).errors.nombre?(i(),c("p",pe,m(e(o).errors.nombre),1)):u("",!0)]),f("div",null,[a(e(_),{for:"descripcion"},{default:r(()=>[...s[13]||(s[13]=[d("Descripción",-1)])]),_:1}),a(e(oe),{id:"descripcion",modelValue:e(o).descripcion,"onUpdate:modelValue":s[1]||(s[1]=t=>e(o).descripcion=t),placeholder:"Ingrese una descripción del proyecto",rows:"4",class:h({"border-red-500":e(o).errors.descripcion})},null,8,["modelValue","class"]),e(o).errors.descripcion?(i(),c("p",fe,m(e(o).errors.descripcion),1)):u("",!0)]),f("div",_e,[f("div",null,[a(e(_),{for:"fecha_inicio"},{default:r(()=>[...s[14]||(s[14]=[d("Fecha de Inicio *",-1)])]),_:1}),a(e(w),{id:"fecha_inicio",modelValue:e(o).fecha_inicio,"onUpdate:modelValue":s[2]||(s[2]=t=>e(o).fecha_inicio=t),type:"date",class:h({"border-red-500":e(o).errors.fecha_inicio}),required:""},null,8,["modelValue","class"]),e(o).errors.fecha_inicio?(i(),c("p",be,m(e(o).errors.fecha_inicio),1)):u("",!0)]),f("div",null,[a(e(_),{for:"fecha_fin"},{default:r(()=>[...s[15]||(s[15]=[d("Fecha de Fin",-1)])]),_:1}),a(e(w),{id:"fecha_fin",modelValue:e(o).fecha_fin,"onUpdate:modelValue":s[3]||(s[3]=t=>e(o).fecha_fin=t),type:"date",min:e(o).fecha_inicio,class:h({"border-red-500":e(o).errors.fecha_fin})},null,8,["modelValue","min","class"]),e(o).errors.fecha_fin?(i(),c("p",ye,m(e(o).errors.fecha_fin),1)):u("",!0)])])]),_:1})]),_:1}),a(e(U),null,{default:r(()=>[a(e(B),null,{default:r(()=>[a(e(I),null,{default:r(()=>[...s[16]||(s[16]=[d("Configuración del Proyecto",-1)])]),_:1})]),_:1}),a(e($),{class:"space-y-4"},{default:r(()=>[f("div",ge,[f("div",null,[a(e(_),{for:"estado"},{default:r(()=>[...s[17]||(s[17]=[d("Estado *",-1)])]),_:1}),a(e(j),{modelValue:e(o).estado,"onUpdate:modelValue":s[4]||(s[4]=t=>e(o).estado=t)},{default:r(()=>[a(e(D),null,{default:r(()=>[a(e(N),{placeholder:"Seleccione el estado"})]),_:1}),a(e(T),null,{default:r(()=>[(i(!0),c(R,null,F(H.value,(t,v)=>(i(),y(e(A),{key:v,value:v},{default:r(()=>[d(m(t),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(o).errors.estado?(i(),c("p",ve,m(e(o).errors.estado),1)):u("",!0)]),f("div",null,[a(e(_),{for:"prioridad"},{default:r(()=>[...s[18]||(s[18]=[d("Prioridad *",-1)])]),_:1}),a(e(j),{modelValue:e(o).prioridad,"onUpdate:modelValue":s[5]||(s[5]=t=>e(o).prioridad=t)},{default:r(()=>[a(e(D),null,{default:r(()=>[a(e(N),{placeholder:"Seleccione la prioridad"})]),_:1}),a(e(T),null,{default:r(()=>[(i(!0),c(R,null,F(J.value,(t,v)=>(i(),y(e(A),{key:v,value:v},{default:r(()=>[d(m(t),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(o).errors.prioridad?(i(),c("p",he,m(e(o).errors.prioridad),1)):u("",!0)])]),p.showResponsable?(i(),c("div",xe,[a(e(_),{for:"responsable_id"},{default:r(()=>[...s[19]||(s[19]=[d("Responsable",-1)])]),_:1}),f("div",Ve,[b.value?(i(),c("div",ke,[f("div",null,[f("p",Ce,m(b.value.name),1),f("p",Ue,m(b.value.email),1)]),a(e(x),{type:"button",variant:"ghost",size:"sm",onClick:s[6]||(s[6]=t=>{e(o).responsable_id=null,b.value=null})},{default:r(()=>[a(e(G),{class:"h-4 w-4"})]),_:1})])):u("",!0),a(e(x),{type:"button",variant:"outline",onClick:s[7]||(s[7]=t=>k.value=!0),class:"w-full"},{default:r(()=>[a(e(de),{class:"h-4 w-4 mr-2"}),d(" "+m(b.value?"Cambiar Responsable":"Seleccionar Responsable"),1)]),_:1})]),e(o).errors.responsable_id?(i(),c("p",$e,m(e(o).errors.responsable_id),1)):u("",!0)])):u("",!0),p.categorias&&p.categorias.length>0?(i(),c("div",we,[a(e(_),{class:"flex items-center gap-2 mb-2"},{default:r(()=>[a(e(ue),{class:"h-4 w-4"}),s[20]||(s[20]=d(" Etiquetas ",-1))]),_:1}),a(le,{modelValue:e(o).etiquetas,"onUpdate:modelValue":s[8]||(s[8]=t=>e(o).etiquetas=t),categorias:p.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas para el proyecto...",description:"Puedes asignar hasta 10 etiquetas para categorizar este proyecto"},null,8,["modelValue","categorias"]),e(o).errors.etiquetas?(i(),c("p",Se,m(e(o).errors.etiquetas),1)):u("",!0)])):u("",!0)]),_:1})]),_:1}),p.showGestores?(i(),y(ie,{key:0,modelValue:e(o).gestores,"onUpdate:modelValue":s[9]||(s[9]=t=>e(o).gestores=t),gestores:p.gestores},null,8,["modelValue","gestores"])):u("",!0),p.camposPersonalizados.length>0?(i(),y(te,{key:1,campos:p.camposPersonalizados,valores:V,errors:e(o).errors,onUpdate:W},null,8,["campos","errors"])):u("",!0),p.showResponsable?u("",!0):(i(),y(e(re),{key:2},{default:r(()=>[a(e(ce),{class:"h-4 w-4"}),a(e(ae),null,{default:r(()=>[...s[21]||(s[21]=[d(" Los cambios se guardarán inmediatamente. Si necesitas cambiar el responsable del proyecto, contacta con un administrador. ",-1)])]),_:1})]),_:1})),a(e(U),null,{default:r(()=>[a(e($),{class:"flex justify-end gap-4 pt-6"},{default:r(()=>[a(e(x),{type:"button",variant:"outline",onClick:Q,disabled:g.value},{default:r(()=>[a(e(G),{class:"mr-2 h-4 w-4"}),s[22]||(s[22]=d(" Cancelar ",-1))]),_:1},8,["disabled"]),a(e(x),{type:"submit",disabled:g.value||e(o).processing},{default:r(()=>[a(e(me),{class:"mr-2 h-4 w-4"}),d(" "+m(g.value?"Actualizando...":"Actualizar Proyecto"),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),p.showResponsable&&p.searchUsersEndpoint?(i(),y(ne,{key:3,modelValue:k.value,"onUpdate:modelValue":s[10]||(s[10]=t=>k.value=t),title:"Seleccionar Responsable",description:"Selecciona el usuario que será responsable de este proyecto","search-endpoint":p.searchUsersEndpoint,"excluded-ids":e(o).responsable_id?[e(o).responsable_id]:[],"max-selection":1,"submit-button-text":"Seleccionar Responsable","search-placeholder":"Buscar por nombre, email, documento o teléfono...",onSubmit:Y},null,8,["modelValue","search-endpoint","excluded-ids"])):u("",!0)],32))}});export{He as _};
