import{d as ee,c as V,C as oe,r as ae,m as F,i as n,e as p,f as s,u as e,p as se,w as l,g as r,t as c,h as d,l as le,j as v,n as y,F as C,k as w,b as te,W as re}from"./app-CNcf-zdV.js";import{_ as ie}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DTy3l80b.js";import{_ as z,a as I,b as R,c as k}from"./CardTitle.vue_vue_type_script_setup_true_lang-DhL5ChM3.js";import{_ as $}from"./createLucideIcon-DgLLtpTc.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-CXr4ucc6.js";import{_ as de}from"./Textarea.vue_vue_type_script_setup_true_lang-BLahoW9V.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-BFduy937.js";import{_ as W}from"./Switch.vue_vue_type_script_setup_true_lang-CROETeuV.js";import{_ as pe,a as ne}from"./index-BXNWrcHO.js";import{_ as me,a as ue,b as ce,c as fe,d as _e}from"./SelectValue.vue_vue_type_script_setup_true_lang-Bt0xndJV.js";import{t as q}from"./index-UZehIf0x.js";import{C as ve}from"./circle-alert-BWYDLxj9.js";import{T as xe}from"./trash-2-BaR4XxZx.js";import{P as be}from"./plus-B0xw1qKM.js";import{X as ge}from"./x-arLKReWz.js";import{S as ye}from"./save-Bvcpe2E0.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-D8koaehi.js";import"./index-C53AKuaZ.js";import"./floating-ui.vue-g3wBdaGy.js";import"./index-DoUjDw3v.js";import"./shield-Ds2U7D9u.js";import"./user-DzTPpMzP.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BBJrNP3L.js";import"./chevron-right-CoIj8tGl.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CS3Y7RjP.js";import"./VisuallyHidden-BMJ7uEAj.js";import"./index-BfcJxwg-.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-D-RM_gVc.js";import"./map-pin-CODmF8A6.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-CPZLV3U1.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CQwxGvmo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-Co9lmALi.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Bowse19S.js";import"./target-Bzh15SE9.js";import"./users-BCniY5Uo.js";import"./vote-DWrrItDX.js";import"./folder-open-Bl1zn-Xz.js";import"./send-Cs3Svvwv.js";import"./file-text-VjUXoo3d.js";import"./briefcase-BxQurTMk.js";import"./calendar-DAAYlVnm.js";import"./megaphone-DSquqsX_.js";import"./user-check-t0y4Vuir.js";import"./mail-CzyXkW1x.js";import"./message-square-vVP8zyj_.js";import"./external-link-DknYr06I.js";import"./panel-left-C37rxO5h.js";import"./index-s_YMJFqv.js";import"./check-N9bkD0I5.js";import"./index-DraxJDKZ.js";import"./VisuallyHiddenInput-DQv9Xmp3.js";import"./nullish-CHIgUVhi.js";const Ve={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Ce={class:"flex items-center justify-between"},$e={class:"text-2xl font-bold text-gray-900 dark:text-white"},he={key:0,class:"mt-1 text-sm text-red-600"},we={key:0,class:"mt-1 text-sm text-red-600"},ze={key:0,class:"mt-1 text-sm text-red-600"},ke={key:0,class:"mt-1 text-sm text-red-600"},qe={key:0,class:"mt-1 text-xs text-gray-500"},Ue={key:1,class:"mt-1 text-sm text-red-600"},Pe={key:0},Ee={class:"space-y-2"},je={key:0,class:"mt-1 text-sm text-red-600"},Se={class:"space-y-2"},Te=["id","value","checked","onChange"],Ae={key:0,class:"mt-1 text-sm text-red-600"},Ne={key:0,class:"mt-1 text-sm text-red-600"},Oe={class:"space-y-4"},De={class:"flex items-center justify-between"},Le={class:"space-y-0.5"},Be={class:"flex items-center justify-between"},Fe={class:"space-y-0.5"},Io=ee({__name:"Form",props:{campo:{},tiposCampo:{},tipos:{},entidadesDisponibles:{}},setup(G){var P,E,j,S,T,A,N,O,D,L,B;const i=G,f=V(()=>!!i.campo),M=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:"Campos Personalizados",href:"/admin/campos-personalizados"},{title:f.value?`Editar: ${(P=i.campo)==null?void 0:P.nombre}`:"Nuevo Campo",href:"#"}],a=oe({nombre:((E=i.campo)==null?void 0:E.nombre)||"",slug:((j=i.campo)==null?void 0:j.slug)||"",tipo:((S=i.campo)==null?void 0:S.tipo)||"text",opciones:((T=i.campo)==null?void 0:T.opciones)||[],es_requerido:((A=i.campo)==null?void 0:A.es_requerido)!==void 0?i.campo.es_requerido:!1,activo:((N=i.campo)==null?void 0:N.activo)!==void 0?i.campo.activo:!0,descripcion:((O=i.campo)==null?void 0:O.descripcion)||"",placeholder:((D=i.campo)==null?void 0:D.placeholder)||"",validacion:((L=i.campo)==null?void 0:L.validacion)||"",aplicar_para:((B=i.campo)==null?void 0:B.aplicar_para)||["proyectos"]}),X=V(()=>i.tiposCampo||i.tipos||{}),H=V(()=>i.entidadesDisponibles||{proyectos:"Proyectos",contratos:"Contratos"}),b=ae(!1);F(()=>a.nombre,u=>{!f.value&&u&&(a.slug=u.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""))});const h=V(()=>["select","radio"].includes(a.tipo)),U=()=>{a.opciones.push({value:"",label:""})},J=u=>{a.opciones.splice(u,1)};F(()=>a.tipo,(u,o)=>{!h.value&&a.opciones.length>0?a.opciones=[]:h.value&&a.opciones.length===0&&U()});const K=u=>{const o=a.aplicar_para.indexOf(u);o===-1?a.aplicar_para.push(u):a.aplicar_para.splice(o,1),a.aplicar_para.length===0&&(a.aplicar_para=["proyectos"],q.warning('Debe seleccionar al menos una entidad. Se ha seleccionado "Proyectos" por defecto.'))},Q=()=>{var t;b.value=!0;const u=f.value?`/admin/campos-personalizados/${(t=i.campo)==null?void 0:t.id}`:"/admin/campos-personalizados",o=f.value?"put":"post";a[o](u,{preserveScroll:!0,onSuccess:()=>{q.success(f.value?"Campo actualizado exitosamente":"Campo creado exitosamente")},onError:m=>{q.error("Error al guardar el campo"),console.error(m)},onFinish:()=>{b.value=!1}})},Y=()=>{re.visit("/admin/campos-personalizados")},Z=u=>({text:"min:3|max:255|alpha_dash",number:"numeric|min:0|max:1000",date:"date|after:today|before:2030-12-31",textarea:"min:10|max:5000",file:"mimes:pdf,doc,docx|max:10240"})[u]||"";return(u,o)=>(p(),n(C,null,[s(e(se),{title:f.value?"Editar Campo Personalizado":"Nuevo Campo Personalizado"},null,8,["title"]),s(ie,{breadcrumbs:M},{default:l(()=>[r("div",Ve,[r("div",Ce,[r("h1",$e,c(f.value?"Editar Campo Personalizado":"Nuevo Campo Personalizado"),1)]),s(e(pe),null,{default:l(()=>[s(e(ve),{class:"h-4 w-4"}),s(e(ne),null,{default:l(()=>[...o[8]||(o[8]=[d(" Los campos personalizados permiten agregar información adicional a los proyectos. Una vez creado, el campo estará disponible en todos los formularios de proyectos. ",-1)])]),_:1})]),_:1}),r("form",{onSubmit:le(Q,["prevent"]),class:"space-y-6"},[s(e(z),null,{default:l(()=>[s(e(I),null,{default:l(()=>[s(e(R),null,{default:l(()=>[...o[9]||(o[9]=[d("Información del Campo",-1)])]),_:1})]),_:1}),s(e(k),{class:"space-y-4"},{default:l(()=>[r("div",null,[s(e(_),{for:"nombre"},{default:l(()=>[...o[10]||(o[10]=[d("Nombre del Campo *",-1)])]),_:1}),s(e(x),{id:"nombre",modelValue:e(a).nombre,"onUpdate:modelValue":o[0]||(o[0]=t=>e(a).nombre=t),type:"text",placeholder:"Ej: Presupuesto estimado",class:y({"border-red-500":e(a).errors.nombre}),required:""},null,8,["modelValue","class"]),e(a).errors.nombre?(p(),n("p",he,c(e(a).errors.nombre),1)):v("",!0)]),r("div",null,[s(e(_),{for:"slug"},{default:l(()=>[...o[11]||(o[11]=[d("Identificador (slug) *",-1)])]),_:1}),s(e(x),{id:"slug",modelValue:e(a).slug,"onUpdate:modelValue":o[1]||(o[1]=t=>e(a).slug=t),type:"text",placeholder:"presupuesto_estimado",class:y({"border-red-500":e(a).errors.slug}),disabled:f.value,required:""},null,8,["modelValue","class","disabled"]),o[12]||(o[12]=r("p",{class:"mt-1 text-xs text-gray-500"}," Identificador único del campo. Solo letras minúsculas, números y guiones bajos. ",-1)),e(a).errors.slug?(p(),n("p",we,c(e(a).errors.slug),1)):v("",!0)]),r("div",null,[s(e(_),{for:"descripcion"},{default:l(()=>[...o[13]||(o[13]=[d("Descripción",-1)])]),_:1}),s(e(de),{id:"descripcion",modelValue:e(a).descripcion,"onUpdate:modelValue":o[2]||(o[2]=t=>e(a).descripcion=t),placeholder:"Texto de ayuda para el usuario",rows:"2",class:y({"border-red-500":e(a).errors.descripcion})},null,8,["modelValue","class"]),e(a).errors.descripcion?(p(),n("p",ze,c(e(a).errors.descripcion),1)):v("",!0)]),r("div",null,[s(e(_),{for:"placeholder"},{default:l(()=>[...o[14]||(o[14]=[d("Texto de Placeholder",-1)])]),_:1}),s(e(x),{id:"placeholder",modelValue:e(a).placeholder,"onUpdate:modelValue":o[3]||(o[3]=t=>e(a).placeholder=t),type:"text",placeholder:"Texto que aparece cuando el campo está vacío",class:y({"border-red-500":e(a).errors.placeholder})},null,8,["modelValue","class"]),e(a).errors.placeholder?(p(),n("p",ke,c(e(a).errors.placeholder),1)):v("",!0)])]),_:1})]),_:1}),s(e(z),null,{default:l(()=>[s(e(I),null,{default:l(()=>[s(e(R),null,{default:l(()=>[...o[15]||(o[15]=[d("Configuración",-1)])]),_:1})]),_:1}),s(e(k),{class:"space-y-4"},{default:l(()=>[r("div",null,[s(e(_),{for:"tipo"},{default:l(()=>[...o[16]||(o[16]=[d("Tipo de Campo *",-1)])]),_:1}),s(e(me),{modelValue:e(a).tipo,"onUpdate:modelValue":o[4]||(o[4]=t=>e(a).tipo=t),disabled:f.value},{default:l(()=>[s(e(ue),null,{default:l(()=>[s(e(ce),{placeholder:"Seleccione el tipo"})]),_:1}),s(e(fe),null,{default:l(()=>[(p(!0),n(C,null,w(X.value,(t,m)=>(p(),te(e(_e),{key:m,value:m},{default:l(()=>[d(c(t),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),f.value?(p(),n("p",qe," El tipo no puede ser modificado después de crear el campo. ")):v("",!0),e(a).errors.tipo?(p(),n("p",Ue,c(e(a).errors.tipo),1)):v("",!0)]),h.value?(p(),n("div",Pe,[s(e(_),null,{default:l(()=>[...o[17]||(o[17]=[d("Opciones *",-1)])]),_:1}),r("div",Ee,[(p(!0),n(C,null,w(e(a).opciones,(t,m)=>(p(),n("div",{key:m,class:"flex gap-2"},[s(e(x),{modelValue:t.value,"onUpdate:modelValue":g=>t.value=g,placeholder:"Valor",class:"w-1/3",required:""},null,8,["modelValue","onUpdate:modelValue"]),s(e(x),{modelValue:t.label,"onUpdate:modelValue":g=>t.label=g,placeholder:"Etiqueta",class:"flex-1",required:""},null,8,["modelValue","onUpdate:modelValue"]),s(e($),{type:"button",variant:"destructive",size:"sm",onClick:g=>J(m),disabled:e(a).opciones.length===1},{default:l(()=>[s(e(xe),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"])]))),128)),s(e($),{type:"button",variant:"outline",size:"sm",onClick:U},{default:l(()=>[s(e(be),{class:"mr-2 h-4 w-4"}),o[18]||(o[18]=d(" Agregar Opción ",-1))]),_:1})]),e(a).errors.opciones?(p(),n("p",je,c(e(a).errors.opciones),1)):v("",!0)])):v("",!0),r("div",null,[s(e(_),null,{default:l(()=>[...o[19]||(o[19]=[d("Aplicar a:",-1)])]),_:1}),r("div",Se,[(p(!0),n(C,null,w(H.value,(t,m)=>(p(),n("div",{key:m,class:"flex items-center space-x-2"},[r("input",{type:"checkbox",id:`aplicar_${m}`,value:m,checked:e(a).aplicar_para.includes(m),onChange:g=>K(m),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Te),s(e(_),{for:`aplicar_${m}`,class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},{default:l(()=>[d(c(t),1)]),_:2},1032,["for"])]))),128))]),o[20]||(o[20]=r("p",{class:"mt-1 text-xs text-gray-500"}," Seleccione dónde estará disponible este campo personalizado. ",-1)),e(a).errors.aplicar_para?(p(),n("p",Ae,c(e(a).errors.aplicar_para),1)):v("",!0)]),r("div",null,[s(e(_),{for:"validacion"},{default:l(()=>[...o[21]||(o[21]=[d("Reglas de Validación (Laravel)",-1)])]),_:1}),s(e(x),{id:"validacion",modelValue:e(a).validacion,"onUpdate:modelValue":o[5]||(o[5]=t=>e(a).validacion=t),type:"text",placeholder:Z(e(a).tipo),class:y({"border-red-500":e(a).errors.validacion})},null,8,["modelValue","placeholder","class"]),o[22]||(o[22]=r("p",{class:"mt-1 text-xs text-gray-500"}," Opcional. Usa sintaxis de Laravel. Ej: min:3|max:255 ",-1)),e(a).errors.validacion?(p(),n("p",Ne,c(e(a).errors.validacion),1)):v("",!0)]),r("div",Oe,[r("div",De,[r("div",Le,[s(e(_),{for:"es_requerido"},{default:l(()=>[...o[23]||(o[23]=[d("Campo Requerido",-1)])]),_:1}),o[24]||(o[24]=r("p",{class:"text-xs text-gray-500"}," Los usuarios deberán completar este campo obligatoriamente ",-1))]),s(e(W),{id:"es_requerido",modelValue:e(a).es_requerido,"onUpdate:modelValue":o[6]||(o[6]=t=>e(a).es_requerido=t)},null,8,["modelValue"])]),r("div",Be,[r("div",Fe,[s(e(_),{for:"activo"},{default:l(()=>[...o[25]||(o[25]=[d("Campo Activo",-1)])]),_:1}),o[26]||(o[26]=r("p",{class:"text-xs text-gray-500"}," Solo los campos activos se muestran en los formularios ",-1))]),s(e(W),{id:"activo",modelValue:e(a).activo,"onUpdate:modelValue":o[7]||(o[7]=t=>e(a).activo=t)},null,8,["modelValue"])])])]),_:1})]),_:1}),s(e(z),null,{default:l(()=>[s(e(k),{class:"flex justify-end gap-4 pt-6"},{default:l(()=>[s(e($),{type:"button",variant:"outline",onClick:Y,disabled:b.value},{default:l(()=>[s(e(ge),{class:"mr-2 h-4 w-4"}),o[27]||(o[27]=d(" Cancelar ",-1))]),_:1},8,["disabled"]),s(e($),{type:"submit",disabled:b.value||e(a).processing},{default:l(()=>[s(e(ye),{class:"mr-2 h-4 w-4"}),d(" "+c(b.value?"Guardando...":f.value?"Actualizar Campo":"Crear Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})],32)])]),_:1})],64))}});export{Io as default};
