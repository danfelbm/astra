import{d as j,r as R,c as k,i as x,F,b as g,j as v,e as o,f as e,w as l,k as B,g as a,m as d,t as n,h as m,v as L,l as U,n as D,x as q}from"./app-y4isNqXm.js";import{c as E,_ as I,a as N,b as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dadbzwfh.js";import{_ as $}from"./index-DRJ3k44r.js";import{c as M,_ as P}from"./createLucideIcon-mCVR8rL0.js";import{_ as H,a as G,b as V,c as p,d as O,e as b}from"./TableHeader.vue_vue_type_script_setup_true_lang-C2fd16d3.js";import{_ as J,b as K,c as Q,d as W,e as X}from"./EvidenciasTable.vue_vue_type_script_setup_true_lang-Cqj6D_eZ.js";import{_ as Y}from"./EvidenciaAccionesEstado.vue_vue_type_script_setup_true_lang-BaRiZrKQ.js";import{I as S}from"./image-COS_Wzkl.js";import{F as Z}from"./file-text-D6v7F4kd.js";import{E as tt}from"./external-link-CByLedJd.js";import{E as et}from"./eye-BFD7WhEX.js";import{D as at}from"./download-rGrR-Gcc.js";import{_ as st}from"./Progress.vue_vue_type_script_setup_true_lang-XR50aG_U.js";import{C as ot}from"./circle-check-big-DJnT-ptJ.js";import{C as lt}from"./circle-play-CaAc1NN5.js";import{T as rt}from"./target-Cwu941VC.js";import{C as nt}from"./circle-alert-Ddoyjw3_.js";import{F as it}from"./flag-Ubg9DDrE.js";import{C as T}from"./calendar-VmbXhbGS.js";import{C as dt}from"./clock-CGn_bZQ6.js";import{U as ct}from"./user-C_FJcT-g.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=M("BanIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=M("CirclePauseIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),ft={key:1,class:"mt-4"},gt={class:"flex items-center justify-between w-full pr-4"},yt={class:"flex items-center gap-3"},xt={class:"text-left"},_t={class:"font-semibold"},vt={class:"text-sm text-gray-500"},pt={class:"flex items-center gap-3"},bt={class:"text-sm text-gray-600"},ht={class:"text-sm"},kt={class:"flex items-center justify-end gap-2"},$t=["href"],wt={class:"text-center"},Ct={class:"text-center"},pe=j({__name:"EvidenciasDisplay",props:{contratos:{default:()=>[]},proyectoId:{},modo:{},puedeGestionarEstado:{type:Boolean,default:!1},formatDate:{}},setup(r){const y=r,c=R({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null}),f=k(()=>{const s=[];return y.contratos&&y.contratos.forEach(t=>{t.obligaciones&&t.obligaciones.forEach(u=>{u.evidencias&&u.evidencias.forEach(i=>{s.push({...i,contrato_id:t.id,contrato_numero:t.numero_contrato,contrato_nombre:t.nombre,obligacion_titulo:u.titulo,_contrato:t})})})}),s}),h=k(()=>{let s=f.value;return c.value.contrato_id&&(s=s.filter(t=>t.contrato_id===c.value.contrato_id)),c.value.tipo&&(s=s.filter(t=>t.tipo_evidencia===c.value.tipo)),c.value.estado&&(s=s.filter(t=>t.estado===c.value.estado)),c.value.usuario_id&&(s=s.filter(t=>{var u;return((u=t.usuario)==null?void 0:u.id)===c.value.usuario_id})),(c.value.fecha_inicio||c.value.fecha_fin)&&(s=s.filter(t=>{const u=new Date(t.created_at);if(c.value.fecha_inicio){const i=new Date(c.value.fecha_inicio);if(u<i)return!1}if(c.value.fecha_fin){const i=new Date(c.value.fecha_fin);if(i.setHours(23,59,59,999),u>i)return!1}return!0})),s}),w=k(()=>{const s={};return h.value.forEach(t=>{s[t.contrato_id]||(s[t.contrato_id]={contrato:t._contrato,evidencias:[]}),s[t.contrato_id].evidencias.push(t)}),Object.values(s)}),C=s=>y.modo==="admin"?`/admin/contratos/${s}`:`/miembro/mis-contratos/${s}`,_=(s,t)=>y.modo==="admin"?`/admin/contratos/${s}/evidencias/${t}`:`/miembro/mis-contratos/${s}/evidencias/${t}`;return(s,t)=>(d(),x(F,null,[f.value.length>0?(d(),g(J,{key:0,modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=u=>c.value=u),contratos:r.contratos||[],evidencias:f.value},null,8,["modelValue","contratos","evidencias"])):v("",!0),w.value.length>0?(d(),x("div",ft,[o(e(K),{type:"multiple",class:"space-y-4",collapsible:""},{default:l(()=>[(d(!0),x(F,null,B(w.value,u=>(d(),g(e(Q),{key:u.contrato.id,value:`contrato-${u.contrato.id}`,class:"border rounded-lg bg-card"},{default:l(()=>[o(e(W),{class:"px-4 py-3 hover:no-underline hover:bg-gray-50 dark:hover:bg-gray-800 rounded-t-lg"},{default:l(()=>[a("div",gt,[a("div",yt,[o(e(Z),{class:"h-5 w-5 text-gray-500"}),a("div",xt,[a("div",_t,n(u.contrato.nombre),1),a("div",vt,n(u.contrato.numero_contrato||"Sin número"),1)])]),a("div",pt,[o(e($),{variant:"secondary"},{default:l(()=>[m(n(u.evidencias.length)+" evidencia(s) ",1)]),_:2},1024),o(e(L),{href:C(u.contrato.id),onClick:t[1]||(t[1]=U(()=>{},["stop"])),class:"text-blue-600 hover:text-blue-800 flex items-center gap-1"},{default:l(()=>[t[2]||(t[2]=m(" Ver contrato ",-1)),o(e(tt),{class:"h-3 w-3"})]),_:1},8,["href"])])])]),_:2},1024),o(e(X),{class:"px-4 pb-4"},{default:l(()=>[o(e(H),null,{default:l(()=>[o(e(G),null,{default:l(()=>[o(e(V),null,{default:l(()=>[o(e(p),null,{default:l(()=>[...t[3]||(t[3]=[m("Tipo",-1)])]),_:1}),o(e(p),null,{default:l(()=>[...t[4]||(t[4]=[m("Obligación",-1)])]),_:1}),o(e(p),null,{default:l(()=>[...t[5]||(t[5]=[m("Descripción",-1)])]),_:1}),r.modo==="admin"?(d(),g(e(p),{key:0},{default:l(()=>[...t[6]||(t[6]=[m("Usuario",-1)])]),_:1})):v("",!0),o(e(p),null,{default:l(()=>[...t[7]||(t[7]=[m("Estado",-1)])]),_:1}),o(e(p),null,{default:l(()=>[...t[8]||(t[8]=[m("Fecha",-1)])]),_:1}),o(e(p),{class:"text-right"},{default:l(()=>[...t[9]||(t[9]=[m("Acciones",-1)])]),_:1})]),_:1})]),_:1}),o(e(O),null,{default:l(()=>[(d(!0),x(F,null,B(u.evidencias,i=>(d(),g(e(V),{key:i.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},{default:l(()=>[o(e(b),null,{default:l(()=>[o(e($),{variant:"outline"},{default:l(()=>[m(n(i.tipo_evidencia),1)]),_:2},1024)]),_:2},1024),o(e(b),null,{default:l(()=>[m(n(i.obligacion_titulo),1)]),_:2},1024),o(e(b),null,{default:l(()=>[a("span",bt,n(i.descripcion||"-"),1)]),_:2},1024),r.modo==="admin"?(d(),g(e(b),{key:0},{default:l(()=>{var A;return[a("span",ht,n(((A=i.usuario)==null?void 0:A.name)||"-"),1)]}),_:2},1024)):v("",!0),o(e(b),null,{default:l(()=>[o(e($),{class:D({"bg-yellow-100 text-yellow-800":i.estado==="pendiente","bg-green-100 text-green-800":i.estado==="aprobada","bg-red-100 text-red-800":i.estado==="rechazada"})},{default:l(()=>[m(n(i.estado),1)]),_:2},1032,["class"])]),_:2},1024),o(e(b),null,{default:l(()=>[m(n(r.formatDate(i.created_at)),1)]),_:2},1024),o(e(b),{class:"text-right"},{default:l(()=>[a("div",kt,[o(e(P),{variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:l(()=>[o(e(L),{href:_(i.contrato_id,i.id)},{default:l(()=>[o(e(et),{class:"h-4 w-4"}),t[10]||(t[10]=a("span",{class:"ml-1"},"Ver",-1))]),_:1},8,["href"])]),_:2},1024),i.archivo_url?(d(),g(e(P),{key:0,variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:l(()=>[a("a",{href:i.archivo_url,target:"_blank"},[o(e(at),{class:"h-4 w-4"}),t[11]||(t[11]=a("span",{class:"ml-1"},"Descargar",-1))],8,$t)]),_:2},1024)):v("",!0),r.modo==="admin"||r.modo==="user"&&r.puedeGestionarEstado?(d(),g(Y,{key:1,evidencia:i,"proyecto-id":r.proyectoId,"estado-actual":i.estado},null,8,["evidencia","proyecto-id","estado-actual"])):v("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})])):f.value.length===0?(d(),g(e(I),{key:2,class:"mt-4"},{default:l(()=>[o(e(E),{class:"py-8"},{default:l(()=>[a("div",wt,[o(e(S),{class:"mx-auto h-12 w-12 text-gray-400"}),t[12]||(t[12]=a("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias cargadas",-1)),t[13]||(t[13]=a("p",{class:"text-xs text-gray-500 mt-1"},"Las evidencias se cargan desde los contratos",-1))])]),_:1})]),_:1})):(d(),g(e(I),{key:3,class:"mt-4"},{default:l(()=>[o(e(E),{class:"py-8"},{default:l(()=>[a("div",Ct,[o(e(S),{class:"mx-auto h-12 w-12 text-gray-400"}),t[14]||(t[14]=a("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias que coincidan con los filtros",-1)),t[15]||(t[15]=a("p",{class:"text-xs text-gray-500 mt-1"},"Intenta ajustar los criterios de búsqueda",-1))])]),_:1})]),_:1}))],64))}}),Dt={class:"flex items-center justify-between"},Et={class:"flex items-center gap-3"},It={class:"flex items-center gap-3"},Ft={class:"space-y-2"},jt={class:"flex justify-between text-sm"},At={class:"font-medium"},Bt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2"},Lt={class:"flex items-start gap-3"},Pt={class:"font-medium"},Vt={class:"text-xs text-gray-500"},St={key:0,class:"flex items-start gap-3"},Tt={class:"font-medium"},Nt={class:"text-xs text-gray-500"},zt={key:0,class:"flex items-center gap-3 pt-2"},Mt={class:"font-medium ml-2"},be=j({__name:"ProyectoEstadoCard",props:{estado:{},estadoLabel:{},prioridad:{},prioridadLabel:{},porcentajeCompletado:{},fechaInicio:{},fechaFin:{},duracionDias:{}},setup(r){const y=r,c=k(()=>({planificacion:rt,en_progreso:lt,pausado:mt,completado:ot,cancelado:ut})[y.estado]||nt),f=k(()=>({planificacion:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",en_progreso:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",pausado:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",completado:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",cancelado:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"})[y.estado]||"bg-gray-100 text-gray-800"),h=k(()=>({baja:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",media:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",alta:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",critica:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"})[y.prioridad]||"bg-gray-100 text-gray-800"),w=_=>new Date(_).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),C=_=>{const s=Math.floor((new Date(_).getTime()-new Date().getTime())/864e5);return s===0?"Hoy":s===1?"Mañana":s===-1?"Ayer":s>0?`En ${s} días`:`Hace ${Math.abs(s)} días`};return(_,s)=>(d(),g(e(I),null,{default:l(()=>[o(e(N),null,{default:l(()=>[o(e(z),null,{default:l(()=>[...s[0]||(s[0]=[m("Estado del Proyecto",-1)])]),_:1})]),_:1}),o(e(E),{class:"space-y-4"},{default:l(()=>[a("div",Dt,[a("div",Et,[(d(),g(q(c.value),{class:"h-5 w-5 text-gray-500"})),s[1]||(s[1]=a("span",{class:"font-medium"},"Estado:",-1)),o(e($),{class:D(f.value)},{default:l(()=>[m(n(r.estadoLabel),1)]),_:1},8,["class"])]),a("div",It,[o(e(it),{class:"h-5 w-5 text-gray-500"}),s[2]||(s[2]=a("span",{class:"font-medium"},"Prioridad:",-1)),o(e($),{class:D(h.value)},{default:l(()=>[m(n(r.prioridadLabel),1)]),_:1},8,["class"])])]),a("div",Ft,[a("div",jt,[s[3]||(s[3]=a("span",{class:"text-gray-600 dark:text-gray-400"},"Progreso",-1)),a("span",At,n(r.porcentajeCompletado)+"%",1)]),o(e(st),{"model-value":r.porcentajeCompletado,class:"h-2"},null,8,["model-value"])]),a("div",Bt,[a("div",Lt,[o(e(T),{class:"h-5 w-5 text-gray-500 mt-0.5"}),a("div",null,[s[4]||(s[4]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de inicio",-1)),a("p",Pt,n(w(r.fechaInicio)),1),a("p",Vt,n(C(r.fechaInicio)),1)])]),r.fechaFin?(d(),x("div",St,[o(e(T),{class:"h-5 w-5 text-gray-500 mt-0.5"}),a("div",null,[s[5]||(s[5]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de fin",-1)),a("p",Tt,n(w(r.fechaFin)),1),a("p",Nt,n(C(r.fechaFin)),1)])])):v("",!0)]),r.duracionDias?(d(),x("div",zt,[o(e(dt),{class:"h-5 w-5 text-gray-500"}),a("div",null,[s[6]||(s[6]=a("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Duración total:",-1)),a("span",Mt,n(r.duracionDias)+" días",1)])])):v("",!0)]),_:1})]),_:1}))}}),Rt={key:0},Ut={class:"font-mono"},qt={key:1},Ht={key:0,class:"flex items-center gap-3"},Gt={class:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Ot={class:"font-medium"},Jt={class:"text-sm text-gray-500"},Kt={key:1,class:"text-gray-500"},Qt={class:"font-medium"},Wt={class:"text-xs text-gray-500"},Xt={class:"text-sm"},he=j({__name:"ProyectoInfoCard",props:{proyectoId:{},activo:{type:Boolean},responsable:{},creador:{},createdAt:{},updatedAt:{},titulo:{default:"Información del Proyecto"},showId:{type:Boolean,default:!1},showActivo:{type:Boolean,default:!1}},setup(r){const y=c=>new Date(c).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"});return(c,f)=>(d(),g(e(I),null,{default:l(()=>[o(e(N),null,{default:l(()=>[o(e(z),null,{default:l(()=>[m(n(r.titulo),1)]),_:1})]),_:1}),o(e(E),{class:"space-y-4"},{default:l(()=>{var h;return[r.showId&&r.proyectoId?(d(),x("div",Rt,[f[0]||(f[0]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"ID del Proyecto",-1)),a("p",Ut,"#"+n(r.proyectoId),1)])):v("",!0),r.showActivo&&r.activo!==void 0?(d(),x("div",qt,[f[1]||(f[1]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado",-1)),o(e($),{class:D(r.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},{default:l(()=>[m(n(r.activo?"Activo":"Inactivo"),1)]),_:1},8,["class"])])):v("",!0),a("div",null,[f[2]||(f[2]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"},"Responsable",-1)),r.responsable?(d(),x("div",Ht,[a("div",Gt,[o(e(ct),{class:"h-5 w-5 text-gray-500"})]),a("div",null,[a("p",Ot,n(r.responsable.name),1),a("p",Jt,n(r.responsable.email),1)])])):(d(),x("p",Kt,"Sin asignar"))]),a("div",null,[f[3]||(f[3]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Creado por",-1)),a("p",Qt,n(((h=r.creador)==null?void 0:h.name)||"Sistema"),1),a("p",Wt,n(y(r.createdAt)),1)]),a("div",null,[f[4]||(f[4]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Última actualización",-1)),a("p",Xt,n(y(r.updatedAt)),1)])]}),_:1})]),_:1}))}});export{he as _,be as a,pe as b};
