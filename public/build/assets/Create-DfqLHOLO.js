import{d as q,C as L,k as M,j as V,o as m,e as l,b as t,f as a,u as e,m as R,P as S,g as o,h,a as _,F as k,r as F,t as f}from"./app-C80QO8j-.js";import{T as z,S as B,_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-CttZpOXF.js";import{_ as u}from"./createLucideIcon-Bl_5ZrL0.js";import{_ as g,a as c,b as v,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-BFxu__RC.js";import{_ as x}from"./CardDescription.vue_vue_type_script_setup_true_lang-9z8aPOd0.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-eRxB8rl2.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-CVM3UWYT.js";import{_ as G}from"./Textarea.vue_vue_type_script_setup_true_lang-DXtU8xp1.js";import{_ as E,a as O,b as Q,c as H,d as I}from"./SelectValue.vue_vue_type_script_setup_true_lang-CeqFhs2T.js";import{_ as J}from"./Switch.vue_vue_type_script_setup_true_lang-lkqPXz2t.js";import{_ as K}from"./Checkbox.vue_vue_type_script_setup_true_lang-BOiu9-J_.js";import{_ as W}from"./index-3SchajKl.js";import{_ as X,a as Y,b,c as $}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-Bz-NA1I3.js";import{F as Z,_ as ee}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-KRust7fM.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang-BXqj3S99.js";import{A as se}from"./arrow-left-C2HlR0i0.js";import{U as te}from"./users-D9EIFmnR.js";import{S as le}from"./save-Ca0AhjI9.js";import"./index-Dffjhihw.js";import"./check-CqiAWBud.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CB51cKpi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CBz26OSj.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CGs0U8X4.js";import"./VisuallyHidden-Db7U7oqZ.js";import"./index-Bs936T5a.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CrysrfG8.js";import"./index-hcL9d2Ws.js";import"./briefcase-DuixDvK1.js";import"./calendar-D9mWqiwA.js";import"./circle-alert-CfgUoHm6.js";import"./map-pin-CFTta8Zy.js";import"./VisuallyHiddenInput-CTTxKWEU.js";import"./RovingFocusItem-MozmipVU.js";import"./utils-DD1mcrYQ.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-Mp-89UH-.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BqK9iV4w.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-gEXCetET.js";import"./loader-circle-DV70MI8w.js";import"./trash-2-Co-qzEWM.js";import"./plus-CsOmElfz.js";import"./search-C8TfLauY.js";import"./history-D0q5y27L.js";const oe={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ie={class:"flex items-center justify-between"},ae={class:"space-y-2"},ne={class:"space-y-2"},re={class:"space-y-2"},de={class:"flex items-center justify-between"},me={class:"space-y-0.5"},ue={class:"flex items-center space-x-2"},fe={class:"space-y-2"},pe={class:"grid grid-cols-2 gap-2"},_e={class:"flex items-center px-3 py-2 bg-muted rounded-md"},ge={class:"text-sm text-muted-foreground"},ce={class:"grid grid-cols-2 gap-2 mt-2"},ve={key:0,class:"space-y-3"},ye={class:"flex-1"},xe={class:"text-xs text-muted-foreground mt-1"},be={key:1,class:"text-center py-8 text-muted-foreground"},$e={class:"flex justify-end gap-4"},ps=q({__name:"Create",props:{roles:{},filterFieldsConfig:{},modelTypes:{}},setup(Ce){const U=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Segmentos",href:"/admin/segments"},{title:"Crear Segmento",href:"#"}],i=L({name:"",description:"",model_type:"App\\Models\\User",filters:{},is_dynamic:!0,cache_duration:300,role_ids:[]}),D=M(null),N=r=>{const s=i.role_ids.indexOf(r);s>-1?i.role_ids.splice(s,1):i.role_ids.push(r)},A=r=>{i.filters=r},T=()=>{i.post("/admin/segments",{preserveScroll:!0,onSuccess:()=>{}})},j=r=>r<60?`${r} segundos`:r<3600?`${Math.floor(r/60)} minutos`:`${Math.floor(r/3600)} horas`;return(r,s)=>(m(),V(P,{breadcrumbs:U},{default:l(()=>[t(e(R),{title:"Crear Segmento"}),a("div",oe,[a("div",ie,[s[10]||(s[10]=a("div",null,[a("h2",{class:"text-2xl font-bold tracking-tight"},"Crear Nuevo Segmento"),a("p",{class:"text-muted-foreground"}," Define un segmento de usuarios basado en filtros dinámicos ")],-1)),t(e(S),{href:r.route("admin.segments.index")},{default:l(()=>[t(e(u),{variant:"outline"},{default:l(()=>[t(e(se),{class:"mr-2 h-4 w-4"}),s[9]||(s[9]=o(" Volver "))]),_:1})]),_:1},8,["href"])]),a("form",{onSubmit:h(T,["prevent"]),class:"space-y-6"},[t(e(X),{defaultValue:"general",class:"space-y-4"},{default:l(()=>[t(e(Y),{class:"grid w-full grid-cols-4"},{default:l(()=>[t(e(b),{value:"general"},{default:l(()=>[t(e(z),{class:"mr-2 h-4 w-4"}),s[11]||(s[11]=o(" General "))]),_:1}),t(e(b),{value:"filters"},{default:l(()=>[t(e(Z),{class:"mr-2 h-4 w-4"}),s[12]||(s[12]=o(" Filtros "))]),_:1}),t(e(b),{value:"settings"},{default:l(()=>[t(e(B),{class:"mr-2 h-4 w-4"}),s[13]||(s[13]=o(" Configuración "))]),_:1}),t(e(b),{value:"roles"},{default:l(()=>[t(e(te),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=o(" Roles "))]),_:1})]),_:1}),t(e($),{value:"general"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[15]||(s[15]=[o("Información General")])),_:1}),t(e(x),null,{default:l(()=>s[16]||(s[16]=[o(" Define el nombre y descripción del segmento ")])),_:1})]),_:1}),t(e(y),{class:"space-y-4"},{default:l(()=>[a("div",ae,[t(e(d),{htmlFor:"name"},{default:l(()=>s[17]||(s[17]=[o("Nombre del Segmento")])),_:1}),t(e(w),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":s[0]||(s[0]=n=>e(i).name=n),placeholder:"Usuarios por Región Norte"},null,8,["modelValue"]),t(p,{message:e(i).errors.name},null,8,["message"])]),a("div",ne,[t(e(d),{htmlFor:"description"},{default:l(()=>s[18]||(s[18]=[o("Descripción")])),_:1}),t(e(G),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":s[1]||(s[1]=n=>e(i).description=n),placeholder:"Describe el propósito y criterios de este segmento...",rows:"4"},null,8,["modelValue"]),t(p,{message:e(i).errors.description},null,8,["message"])]),a("div",re,[t(e(d),{htmlFor:"model_type"},{default:l(()=>s[19]||(s[19]=[o("Tipo de Modelo")])),_:1}),t(e(E),{modelValue:e(i).model_type,"onUpdate:modelValue":s[2]||(s[2]=n=>e(i).model_type=n)},{default:l(()=>[t(e(O),null,{default:l(()=>[t(e(Q),{placeholder:"Selecciona el tipo de modelo"})]),_:1}),t(e(H),null,{default:l(()=>[(m(!0),_(k,null,F(r.modelTypes,(n,C)=>(m(),V(e(I),{key:C,value:C},{default:l(()=>[o(f(n),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),s[20]||(s[20]=a("p",{class:"text-xs text-muted-foreground"}," Selecciona el modelo de datos sobre el que aplicar el segmento ",-1)),t(p,{message:e(i).errors.model_type},null,8,["message"])])]),_:1})]),_:1})]),_:1}),t(e($),{value:"filters"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[21]||(s[21]=[o("Criterios de Filtrado")])),_:1}),t(e(x),null,{default:l(()=>s[22]||(s[22]=[o(" Define los filtros que determinarán qué usuarios pertenecen a este segmento ")])),_:1})]),_:1}),t(e(y),null,{default:l(()=>[t(ee,{ref_key:"advancedFiltersRef",ref:D,config:{fields:r.filterFieldsConfig,showQuickSearch:!1},route:"",onApply:A},null,8,["config"]),t(p,{message:e(i).errors.filters},null,8,["message"]),s[23]||(s[23]=a("div",{class:"mt-4 p-4 bg-muted/50 rounded-lg"},[a("p",{class:"text-sm text-muted-foreground"},[a("strong",null,"Nota:"),o(" Los filtros definidos aquí serán aplicados dinámicamente para determinar qué usuarios pertenecen a este segmento. Los segmentos dinámicos se recalculan automáticamente según los criterios establecidos. ")])],-1))]),_:1})]),_:1})]),_:1}),t(e($),{value:"settings"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[24]||(s[24]=[o("Configuración del Segmento")])),_:1}),t(e(x),null,{default:l(()=>s[25]||(s[25]=[o(" Ajusta el comportamiento y cache del segmento ")])),_:1})]),_:1}),t(e(y),{class:"space-y-6"},{default:l(()=>[a("div",de,[a("div",me,[t(e(d),null,{default:l(()=>s[26]||(s[26]=[o("Tipo de Segmento")])),_:1}),s[27]||(s[27]=a("p",{class:"text-sm text-muted-foreground"}," Los segmentos dinámicos se recalculan en tiempo real ",-1))]),a("div",ue,[t(e(d),{htmlFor:"is_dynamic",class:"text-sm"},{default:l(()=>s[28]||(s[28]=[o("Dinámico")])),_:1}),t(e(J),{id:"is_dynamic",modelValue:e(i).is_dynamic,"onUpdate:modelValue":s[3]||(s[3]=n=>e(i).is_dynamic=n)},null,8,["modelValue"])])]),a("div",fe,[t(e(d),{htmlFor:"cache_duration"},{default:l(()=>s[29]||(s[29]=[o("Duración del Cache (segundos)")])),_:1}),a("div",pe,[t(e(w),{id:"cache_duration",modelValue:e(i).cache_duration,"onUpdate:modelValue":s[4]||(s[4]=n=>e(i).cache_duration=n),modelModifiers:{number:!0},type:"number",min:"0",max:"86400"},null,8,["modelValue"]),a("div",_e,[a("span",ge,f(j(e(i).cache_duration)),1)])]),s[30]||(s[30]=a("p",{class:"text-xs text-muted-foreground"}," Tiempo que se mantendrán en cache los resultados del segmento (0 = sin cache) ",-1)),t(p,{message:e(i).errors.cache_duration},null,8,["message"])]),a("div",null,[t(e(d),{class:"text-sm font-medium"},{default:l(()=>s[31]||(s[31]=[o("Valores Predefinidos")])),_:1}),a("div",ce,[t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[5]||(s[5]=n=>e(i).cache_duration=60)},{default:l(()=>s[32]||(s[32]=[o(" 1 minuto ")])),_:1}),t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[6]||(s[6]=n=>e(i).cache_duration=300)},{default:l(()=>s[33]||(s[33]=[o(" 5 minutos ")])),_:1}),t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[7]||(s[7]=n=>e(i).cache_duration=1800)},{default:l(()=>s[34]||(s[34]=[o(" 30 minutos ")])),_:1}),t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[8]||(s[8]=n=>e(i).cache_duration=3600)},{default:l(()=>s[35]||(s[35]=[o(" 1 hora ")])),_:1})])])]),_:1})]),_:1})]),_:1}),t(e($),{value:"roles"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[36]||(s[36]=[o("Roles Asociados")])),_:1}),t(e(x),null,{default:l(()=>s[37]||(s[37]=[o(" Vincula este segmento con roles específicos para delimitar el alcance de datos ")])),_:1})]),_:1}),t(e(y),null,{default:l(()=>[r.roles.length>0?(m(),_("div",ve,[(m(!0),_(k,null,F(r.roles,n=>(m(),_("div",{key:n.id,class:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-muted/50"},[t(e(K),{checked:e(i).role_ids.includes(n.id),"onUpdate:checked":C=>N(n.id),class:"mt-1"},null,8,["checked","onUpdate:checked"]),a("div",ye,[t(e(d),{class:"text-sm font-medium cursor-pointer"},{default:l(()=>[o(f(n.display_name),1)]),_:2},1024),a("p",xe,f(n.description||"Sin descripción"),1),t(e(W),{variant:"outline",class:"mt-2"},{default:l(()=>[o(f(n.name),1)]),_:2},1024)])]))),128))])):(m(),_("div",be," No hay roles disponibles ")),t(p,{message:e(i).errors.role_ids},null,8,["message"])]),_:1})]),_:1})]),_:1})]),_:1}),a("div",$e,[t(e(S),{href:r.route("admin.segments.index")},{default:l(()=>[t(e(u),{type:"button",variant:"outline"},{default:l(()=>s[38]||(s[38]=[o(" Cancelar ")])),_:1})]),_:1},8,["href"]),t(e(u),{type:"submit",disabled:e(i).processing},{default:l(()=>[t(e(le),{class:"mr-2 h-4 w-4"}),o(" "+f(e(i).processing?"Creando...":"Crear Segmento"),1)]),_:1},8,["disabled"])])],32)])]),_:1}))}});export{ps as default};
