import{d as Q,c as D,i as p,e as n,j as b,g as o,t as u,F as P,k as K,b as h,w as t,f as a,u as e,n as W,h as d,q as ie,r as A,T as Ge,G as Je,H as Xe,C as te,p as Ke,W as fe,s as Ze,I as re,a as ge}from"./app-B7JHmzZ3.js";import{_ as U}from"./index-rxln-YzF.js";import{c as Z,_ as k}from"./createLucideIcon-fGeWyvG_.js";import{c as N,_ as R,a as B,b as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-xUjjE8IK.js";import{_ as j}from"./Label.vue_vue_type_script_setup_true_lang-fFAFaom6.js";import{_ as Qe}from"./Checkbox.vue_vue_type_script_setup_true_lang-CxiXySuR.js";import{_ as ve,a as be}from"./index-B33DXrho.js";import{R as oe}from"./RichTextEditor-CBH1zeQ2.js";import{_ as Ye}from"./HistorialCandidatura.vue_vue_type_script_setup_true_lang-B4EsRJXF.js";import{_ as _e}from"./Textarea.vue_vue_type_script_setup_true_lang-zaOr10O0.js";import{F as je}from"./file-text-C_id9aKI.js";import{E as ea}from"./eye-Ge36MGmw.js";import{D as aa}from"./download-BEGX5OK2.js";import{E as ta}from"./external-link-CNccGiTj.js";import{U as ra}from"./users-gG9q0EaO.js";import{U as le}from"./user-DJF4-usS.js";import{P as oa}from"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-ySvG0ZHb.js";import{M as Ee}from"./mail-FEyEUa_K.js";import{C as de}from"./calendar-CwCHh7g1.js";import{H as sa}from"./hash-DUvHA4t_.js";import{B as na}from"./briefcase-CbxQO1b8.js";import{e as ye,_ as he,a as ke,b as xe,c as we,d as Ce}from"./DialogTitle.vue_vue_type_script_setup_true_lang-ViHLnL4d.js";import{C as Ve}from"./clock-DQhl_-hl.js";import{C as G}from"./circle-check-big-BX-XUIuW.js";import{C as J}from"./circle-x-z0MJ42qm.js";import{M as X}from"./message-square-DGOIulqV.js";import{P as Te}from"./plus-EszbJR6u.js";import{_ as la}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as ia}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Cn8W63cg.js";import{A as da}from"./arrow-left-C14FsogT.js";import{L as $e}from"./loader-circle-DSjk3Wn9.js";import{T as ua,a as ca}from"./toggle-right-Rp_OEXL6.js";import{T as Ae}from"./triangle-alert-BWpdpPy8.js";import{S as ma}from"./square-check-big-BONr3KdB.js";import{C as pa}from"./circle-check-COKf5rzv.js";import{H as Se}from"./history-DApgiyil.js";import"./index-CBze1Ugy.js";import"./Input.vue_vue_type_script_setup_true_lang-B6w5yMA0.js";import"./index-BQ475Ea3.js";import"./floating-ui.vue-BEmTabXm.js";import"./check-BGitBu-W.js";import"./index-WrrQQGqk.js";import"./italic-Cu1dP45Q.js";import"./list-CfuNi0YP.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-DjPpLf6Z.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-DwYM0u2-.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-CnXUKbSY.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-lnv0J55m.js";import"./VisuallyHidden-C5pU9xhK.js";import"./nullish-CHIgUVhi.js";import"./chevron-right-CaXva2pS.js";import"./x-FK84Jhx-.js";import"./index-BmRuyn_S.js";import"./shield-Dtwt_JCC.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CNoi2SIi.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CpNLwog-.js";import"./index-B0ovTKfR.js";import"./circle-alert-C_k_uumx.js";import"./map-pin-DCQWz_w1.js";import"./chevrons-up-down-AJnR2RTL.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CLZMVAKW.js";import"./tag-BljZmyPM.js";import"./target-2T0QWYoE.js";import"./vote-BcsUe5tH.js";import"./folder-open-B8-1f72n.js";import"./send-eowq9Jg7.js";import"./megaphone-BftmrAse.js";import"./user-check-BP067pt8.js";import"./clipboard-list-BRLYPA3i.js";import"./panel-left-CbCUXSX9.js";import"./index-UQLhyimN.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=Z("MessageCircleIcon",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=Z("MessageSquareOffIcon",[["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M3.6 3.6c-.4.3-.6.8-.6 1.4v16l4-4h10",key:"pwpm4a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Z("RotateCcwIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=Z("StickyNoteIcon",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=Z("Undo2Icon",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=Z("WrenchIcon",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),ya={class:"space-y-2"},ha={key:0},ka={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},xa={key:1,class:"text-sm text-muted-foreground italic"},wa={key:2,class:"space-y-2"},Ca={class:"flex items-center justify-between"},$a={class:"flex items-center space-x-3 flex-1 min-w-0"},Aa={class:"flex-shrink-0"},Sa={class:"flex-1 min-w-0"},za={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},ja={class:"flex items-center space-x-1 flex-shrink-0"},se=Q({__name:"FileFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1}},setup(q){const v=q,_=D(()=>{if(!v.value)return[];if(Array.isArray(v.value))return v.value.map((s,f)=>{const y=E(s);return{id:`file_${f}`,name:y,path:s,url:s.startsWith("http")?s:`/storage/${s}`,extension:S(y)}});if(typeof v.value=="string"){const s=E(v.value);return[{id:"file_0",name:s,path:v.value,url:v.value.startsWith("http")?v.value:`/storage/${v.value}`,extension:S(s)}]}return[]}),E=s=>{if(!s)return"archivo";const f=s.split("/");return f[f.length-1]||"archivo"},S=s=>{const f=s.split(".");return f.length>1?f[f.length-1].toLowerCase():""},V=s=>{switch(s){case"pdf":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"doc":case"docx":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"xls":case"xlsx":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"jpg":case"jpeg":case"png":case"gif":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},x=s=>{window.open(s,"_blank")},c=(s,f)=>{const y=document.createElement("a");y.href=s+"?download=true",y.download=f,y.target="_blank",document.body.appendChild(y),y.click(),document.body.removeChild(y)};return(s,f)=>(n(),p("div",ya,[s.showLabel&&s.label?(n(),p("div",ha,[o("label",ka,u(s.label),1)])):b("",!0),_.value.length===0?(n(),p("div",xa," No hay archivos adjuntos ")):(n(),p("div",wa,[(n(!0),p(P,null,K(_.value,y=>(n(),h(e(R),{key:y.id,class:"hover:shadow-md transition-shadow duration-200"},{default:t(()=>[a(e(N),{class:"p-3"},{default:t(()=>[o("div",Ca,[o("div",$a,[o("div",Aa,[a(e(je),{class:"h-8 w-8 text-red-500"})]),o("div",Sa,[o("p",za,u(y.name),1),a(e(U),{class:W([V(y.extension),"mt-1"])},{default:t(()=>[d(u(y.extension.toUpperCase()),1)]),_:2},1032,["class"])])]),o("div",ja,[a(e(k),{variant:"ghost",size:"sm",onClick:L=>x(y.url),class:"hover:bg-blue-50 dark:hover:bg-blue-900",title:"Ver archivo"},{default:t(()=>[a(e(ea),{class:"h-4 w-4"}),f[0]||(f[0]=o("span",{class:"ml-1 hidden sm:inline"},"Ver",-1))]),_:2},1032,["onClick"]),a(e(k),{variant:"ghost",size:"sm",onClick:L=>c(y.url,y.name),class:"hover:bg-green-50 dark:hover:bg-green-900",title:"Descargar archivo"},{default:t(()=>[a(e(aa),{class:"h-4 w-4"}),f[1]||(f[1]=o("span",{class:"ml-1 hidden sm:inline"},"Descargar",-1))]),_:2},1032,["onClick"]),a(e(k),{variant:"ghost",size:"sm",onClick:L=>x(y.url),class:"hover:bg-purple-50 dark:hover:bg-purple-900",title:"Abrir en nueva pestaña"},{default:t(()=>[a(e(ta),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))]))]))}}),Ea={class:"space-y-2"},Va={key:0,class:"flex items-center gap-2"},Ta={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Fa={key:1,class:"text-sm text-muted-foreground italic"},La={key:2,class:"space-y-3"},Na={class:"flex items-center justify-between"},Ra={class:"flex items-center gap-2"},Da={class:"flex items-center gap-2 min-w-[140px]"},Ma={class:"flex-1"},Ia={key:0,class:"text-sm text-muted-foreground italic"},ne=Q({__name:"RepeaterFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1},fields:{},itemName:{default:"Elemento"}},setup(q){const v=q,_=D(()=>v.value?Array.isArray(v.value)?v.value.map((c,s)=>c.id&&c.data?c:{id:`item_${s}`,data:c}):[]:[]),E=(c,s)=>{if(c==null||c==="")return"No especificado";if(Array.isArray(c))return c.join(", ");if(s&&(s.includes("fecha")||s.includes("date")))try{return new Date(c).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return c.toString()}return typeof c=="boolean"?c?"Sí":"No":c.toString()},S=c=>{if(v.fields&&v.fields.length>0){const s=v.fields.find(f=>f.id===c);if(s)return s.title}return c.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()).replace(/Id$/i,"").replace(/Contacto$/i,"").trim()},V=c=>{const s=c.toLowerCase();return s.includes("nombre")||s.includes("name")?le:s.includes("telefono")||s.includes("phone")||s.includes("celular")?oa:s.includes("email")||s.includes("correo")?Ee:s.includes("fecha")||s.includes("date")?de:s.includes("numero")||s.includes("cantidad")?sa:s.includes("documento")||s.includes("cedula")?je:s.includes("cargo")||s.includes("empresa")||s.includes("trabajo")?na:null},x=c=>["nombre","name","titulo","title","cargo","empresa"].some(f=>c.toLowerCase().includes(f));return(c,s)=>(n(),p("div",Ea,[c.showLabel&&c.label?(n(),p("div",Va,[a(e(ra),{class:"h-4 w-4 text-muted-foreground"}),o("label",Ta,u(c.label),1),a(e(U),{variant:"secondary",class:"ml-2"},{default:t(()=>[d(u(_.value.length)+" "+u(_.value.length===1?c.itemName:`${c.itemName}s`),1)]),_:1})])):b("",!0),_.value.length===0?(n(),p("div",Fa," No hay "+u(c.itemName.toLowerCase())+"s registrados ",1)):(n(),p("div",La,[(n(!0),p(P,null,K(_.value,(f,y)=>(n(),h(e(R),{key:f.id,class:"hover:shadow-md transition-all duration-200"},{default:t(()=>[a(e(B),{class:"pb-3"},{default:t(()=>[o("div",Na,[o("div",Ra,[a(e(U),{variant:"outline",class:"font-normal"},{default:t(()=>[d(u(c.itemName)+" "+u(y+1),1)]),_:2},1024)])])]),_:2},1024),a(e(N),{class:"space-y-3"},{default:t(()=>[(n(!0),p(P,null,K(f.data,(L,T)=>(n(),p("div",{key:T,class:"flex flex-col sm:flex-row sm:items-start gap-2"},[o("div",Da,[V(String(T))?(n(),h(ie(V(String(T))),{key:0,class:"h-4 w-4 text-muted-foreground flex-shrink-0"})):b("",!0),a(e(j),{class:W(["text-sm",x(String(T))?"font-semibold":"font-medium text-muted-foreground"])},{default:t(()=>[d(u(S(String(T)))+": ",1)]),_:2},1032,["class"])]),o("div",Ma,[o("p",{class:W(["text-sm",x(String(T))?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"])},u(E(L,String(T))),3)])]))),128)),Object.keys(f.data).length===0?(n(),p("div",Ia," Sin información disponible ")):b("",!0)]),_:2},1024)]),_:2},1024))),128))]))]))}}),Ba={class:"border rounded-lg p-4 space-y-3"},qa={class:"flex items-start justify-between"},Ha={class:"flex-1"},Oa={class:"font-medium text-sm"},Ua={key:0,class:"mt-2"},Pa={key:1,class:"mt-2"},Wa={key:2,class:"text-sm text-muted-foreground mt-1"},Ga={class:"flex items-center gap-2"},Ja={key:0,class:"pt-2 border-t"},Xa={class:"flex items-start gap-2 text-xs text-muted-foreground"},Ka={class:"flex-1"},Za={class:"font-medium"},Qa={key:0,class:"flex items-center gap-1 mt-0.5"},Ya={key:0,class:"mt-2 p-2 bg-muted rounded text-xs"},et={class:"flex items-start gap-1"},at={class:"flex-1"},tt={key:1,class:"flex gap-2 pt-2"},rt={class:"space-y-4 py-4"},ot={key:0,class:"mt-2 p-2 bg-muted rounded"},st={key:1,class:"mt-2 p-2 bg-muted rounded"},nt={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},lt={class:"space-y-4 py-4"},it={key:0,class:"mt-2 p-2 bg-muted rounded"},dt={key:1,class:"mt-2 p-2 bg-muted rounded"},ut={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},ct=Q({__name:"AprobacionCampo",props:{candidaturaId:{},campoId:{},campoTitle:{},valor:{},aprobacion:{},puedeAprobar:{type:Boolean},readonly:{type:Boolean}},emits:["campo-actualizado"],setup(q,{emit:v}){const _=q,E=v,S=A(!1),V=A(!1),x=A(""),c=A(!1),s=D(()=>_.aprobacion?_.aprobacion.aprobado?"aprobado":"rechazado":"pendiente"),f=D(()=>_.aprobacion?_.aprobacion.aprobado?"bg-green-100 text-green-800":"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),y=D(()=>_.aprobacion?_.aprobacion.aprobado?"Aprobado":"Rechazado":"Pendiente"),L=D(()=>_.aprobacion?_.aprobacion.aprobado?G:J:Ve),T=async()=>{var i;c.value=!0;try{const m=await fetch(`/admin/candidaturas/${_.candidaturaId}/campos/${_.campoId}/aprobar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({comentario:x.value||null})}),C=await m.json();m.ok&&C.success?(E("campo-actualizado",C.aprobacion),S.value=!1,x.value=""):console.error("Error al aprobar campo:",C)}catch(m){console.error("Error al aprobar campo:",m)}finally{c.value=!1}},M=async()=>{var i;if(x.value.trim()){c.value=!0;try{const m=await fetch(`/admin/candidaturas/${_.candidaturaId}/campos/${_.campoId}/rechazar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({comentario:x.value})}),C=await m.json();m.ok&&C.success?(E("campo-actualizado",C.aprobacion),V.value=!1,x.value=""):console.error("Error al rechazar campo:",C)}catch(m){console.error("Error al rechazar campo:",m)}finally{c.value=!1}}},z=D(()=>{if(Array.isArray(_.valor)&&_.valor.length>0){const i=_.valor[0];if(typeof i=="string"&&(i.includes("uploads/")||i.includes(".pdf")||i.includes(".doc")||i.includes(".jpg")||i.includes(".png")))return!0}return!1}),w=D(()=>{if(Array.isArray(_.valor)&&_.valor.length>0){const i=_.valor[0];if(typeof i=="object"&&i!==null)return i.hasOwnProperty("id")&&i.hasOwnProperty("data")||typeof i=="object"&&!Array.isArray(i)}return!1}),F=D(()=>typeof _.valor=="object"&&_.valor!==null&&!Array.isArray(_.valor)?_.valor.hasOwnProperty("accepted")&&_.valor.hasOwnProperty("timestamp"):!1),H=i=>{if(z.value||w.value)return"";if(F.value&&typeof i=="object"&&i!==null)if(i.accepted===!0)try{return`✅ Aceptado el ${new Date(i.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return Array.isArray(i)?i.join(", "):typeof i=="object"&&i!==null?JSON.stringify(i):(i==null?void 0:i.toString())||"Sin valor"};return(i,m)=>{var C;return n(),p(P,null,[o("div",Ba,[o("div",qa,[o("div",Ha,[o("h4",Oa,u(i.campoTitle),1),z.value?(n(),p("div",Ua,[a(se,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):w.value?(n(),p("div",Pa,[a(ne,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):(n(),p("p",Wa,u(H(i.valor)),1))]),o("div",Ga,[a(e(U),{class:W([f.value,"flex items-center gap-1"])},{default:t(()=>[(n(),h(ie(L.value),{class:"h-3 w-3"})),d(" "+u(y.value),1)]),_:1},8,["class"])])]),(C=i.aprobacion)!=null&&C.aprobado_por?(n(),p("div",Ja,[o("div",Xa,[a(e(le),{class:"h-3 w-3 mt-0.5"}),o("div",Ka,[o("p",null,[d(u(i.aprobacion.aprobado?"Aprobado":"Rechazado")+" por ",1),o("span",Za,u(i.aprobacion.aprobado_por.name),1)]),i.aprobacion.fecha_aprobacion?(n(),p("p",Qa,[a(e(de),{class:"h-3 w-3"}),d(" "+u(i.aprobacion.fecha_aprobacion),1)])):b("",!0)])]),i.aprobacion.comentario?(n(),p("div",Ya,[o("div",et,[a(e(X),{class:"h-3 w-3 mt-0.5 text-muted-foreground"}),o("p",at,u(i.aprobacion.comentario),1)])])):b("",!0)])):b("",!0),i.puedeAprobar&&!i.readonly?(n(),p("div",tt,[s.value!=="aprobado"?(n(),h(e(k),{key:0,size:"sm",variant:"outline",class:"text-green-700 border-green-300 hover:bg-green-50",onClick:m[0]||(m[0]=$=>S.value=!0)},{default:t(()=>[a(e(G),{class:"h-3 w-3 mr-1"}),m[8]||(m[8]=d(" Aprobar ",-1))]),_:1})):b("",!0),s.value!=="rechazado"?(n(),h(e(k),{key:1,size:"sm",variant:"outline",class:"text-red-700 border-red-300 hover:bg-red-50",onClick:m[1]||(m[1]=$=>V.value=!0)},{default:t(()=>[a(e(J),{class:"h-3 w-3 mr-1"}),m[9]||(m[9]=d(" Rechazar ",-1))]),_:1})):b("",!0)])):b("",!0)]),a(e(ye),{open:S.value,"onUpdate:open":m[4]||(m[4]=$=>S.value=$)},{default:t(()=>[a(e(he),null,{default:t(()=>[a(e(ke),null,{default:t(()=>[a(e(xe),null,{default:t(()=>[...m[10]||(m[10]=[d("Aprobar Campo",-1)])]),_:1}),a(e(we),null,{default:t(()=>[d(' Estás aprobando el campo "'+u(i.campoTitle)+'". Puedes agregar un comentario opcional. ',1)]),_:1})]),_:1}),o("div",rt,[o("div",null,[a(e(j),null,{default:t(()=>[...m[11]||(m[11]=[d("Valor actual del campo",-1)])]),_:1}),z.value?(n(),p("div",ot,[a(se,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):w.value?(n(),p("div",st,[a(ne,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):(n(),p("p",nt,u(H(i.valor)),1))]),o("div",null,[a(e(j),{for:"comentario-aprobacion"},{default:t(()=>[...m[12]||(m[12]=[d(" Comentario (opcional) ",-1)])]),_:1}),a(e(_e),{id:"comentario-aprobacion",modelValue:x.value,"onUpdate:modelValue":m[2]||(m[2]=$=>x.value=$),placeholder:"Agregar comentario...",rows:"3"},null,8,["modelValue"])])]),a(e(Ce),null,{default:t(()=>[a(e(k),{variant:"outline",onClick:m[3]||(m[3]=$=>S.value=!1),disabled:c.value},{default:t(()=>[...m[13]||(m[13]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:T,disabled:c.value,class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[a(e(G),{class:"h-4 w-4 mr-2"}),d(" "+u(c.value?"Aprobando...":"Aprobar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),a(e(ye),{open:V.value,"onUpdate:open":m[7]||(m[7]=$=>V.value=$)},{default:t(()=>[a(e(he),null,{default:t(()=>[a(e(ke),null,{default:t(()=>[a(e(xe),null,{default:t(()=>[...m[14]||(m[14]=[d("Rechazar Campo",-1)])]),_:1}),a(e(we),null,{default:t(()=>[d(' Estás rechazando el campo "'+u(i.campoTitle)+'". Por favor, indica el motivo del rechazo. ',1)]),_:1})]),_:1}),o("div",lt,[o("div",null,[a(e(j),null,{default:t(()=>[...m[15]||(m[15]=[d("Valor actual del campo",-1)])]),_:1}),z.value?(n(),p("div",it,[a(se,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):w.value?(n(),p("div",dt,[a(ne,{value:i.valor,label:i.campoTitle},null,8,["value","label"])])):(n(),p("p",ut,u(H(i.valor)),1))]),o("div",null,[a(e(j),{for:"comentario-rechazo"},{default:t(()=>[...m[16]||(m[16]=[d(" Motivo del rechazo * ",-1)])]),_:1}),a(e(_e),{id:"comentario-rechazo",modelValue:x.value,"onUpdate:modelValue":m[5]||(m[5]=$=>x.value=$),placeholder:"Explica qué debe corregir el usuario...",rows:"4",required:""},null,8,["modelValue"])])]),a(e(Ce),null,{default:t(()=>[a(e(k),{variant:"outline",onClick:m[6]||(m[6]=$=>V.value=!1),disabled:c.value},{default:t(()=>[...m[17]||(m[17]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{variant:"destructive",onClick:M,disabled:!x.value.trim()||c.value},{default:t(()=>[a(e(J),{class:"h-4 w-4 mr-2"}),d(" "+u(c.value?"Rechazando...":"Rechazar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),mt={class:"space-y-4"},pt={class:"flex items-center justify-between mb-4"},ft={class:"text-lg font-medium text-gray-900 dark:text-gray-100 flex items-center gap-2"},gt={key:0,class:"space-y-3"},vt={key:0,class:"absolute left-5 top-10 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700"},bt={class:"flex gap-3"},_t={class:"relative z-10 flex-shrink-0"},yt={class:"flex-1 pb-4"},ht={class:"flex items-start justify-between mb-3"},kt={class:"flex items-center gap-2 mb-1"},xt={class:"font-medium text-sm"},wt={class:"flex items-center gap-2 text-xs text-muted-foreground"},Ct={key:0,class:"flex items-center gap-1"},$t=["innerHTML"],At={key:1,class:"text-center py-8"},St=Q({__name:"ComentariosHistorial",props:{comentarios:{},puedeAgregar:{type:Boolean,default:!1}},emits:["agregar-comentario"],setup(q){const v=q,_=D(()=>v.comentarios),E=c=>({"message-circle":fa,"check-circle":G,"x-circle":J,"rotate-ccw":va,"sticky-note":ba,"message-square":X})[c]||X,S=c=>{const s={general:"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",aprobacion:"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400",rechazo:"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400",borrador:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400",nota_admin:"bg-gray-100 text-gray-600 dark:bg-gray-900/30 dark:text-gray-400"};return s[c]||s.general},V=c=>({general:"default",aprobacion:"default",rechazo:"destructive",borrador:"secondary",nota_admin:"outline"})[c]||"default",x=c=>{const s=new Date(c);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(s)};return(c,s)=>(n(),p("div",mt,[o("div",pt,[o("h3",ft,[a(e(X),{class:"h-5 w-5"}),s[1]||(s[1]=d(" Historial de Comentarios ",-1)),a(e(U),{variant:"secondary"},{default:t(()=>[d(u(c.comentarios.length),1)]),_:1})]),c.puedeAgregar?(n(),h(e(k),{key:0,onClick:s[0]||(s[0]=f=>c.$emit("agregar-comentario")),size:"sm",variant:"outline"},{default:t(()=>[a(e(Te),{class:"h-4 w-4 mr-2"}),s[2]||(s[2]=d(" Agregar comentario ",-1))]),_:1})):b("",!0)]),c.comentarios.length>0?(n(),p("div",gt,[a(Ge,{name:"fade"},{default:t(()=>[(n(!0),p(P,null,K(_.value,f=>(n(),p("div",{key:f.id,class:"relative"},[_.value.indexOf(f)<_.value.length-1?(n(),p("div",vt)):b("",!0),o("div",bt,[o("div",_t,[o("div",{class:W(["w-10 h-10 rounded-full flex items-center justify-center",S(f.tipo)])},[(n(),h(ie(E(f.tipo_icon)),{class:"h-5 w-5"}))],2)]),o("div",yt,[a(e(R),null,{default:t(()=>[a(e(N),{class:"pt-4"},{default:t(()=>{var y;return[o("div",ht,[o("div",null,[o("div",kt,[o("span",xt,u(((y=f.created_by)==null?void 0:y.name)||"Sistema"),1),a(e(U),{variant:V(f.tipo)},{default:t(()=>[d(u(f.tipo_label),1)]),_:2},1032,["variant"]),f.version_candidatura?(n(),h(e(U),{key:0,variant:"outline"},{default:t(()=>[d(" v"+u(f.version_candidatura),1)]),_:2},1024)):b("",!0)]),o("div",wt,[a(e(de),{class:"h-3 w-3"}),o("span",null,u(x(f.fecha)),1),s[5]||(s[5]=o("span",null,"•",-1)),o("span",null,u(f.fecha_relativa),1),f.enviado_por_email?(n(),p("span",Ct,[s[3]||(s[3]=o("span",null,"•",-1)),a(e(Ee),{class:"h-3 w-3"}),s[4]||(s[4]=o("span",null,"Notificado",-1))])):b("",!0)])])]),o("div",{class:"prose prose-sm max-w-none dark:prose-invert",innerHTML:f.comentario},null,8,$t)]}),_:2},1024)]),_:2},1024)])])]))),128))]),_:1})])):(n(),p("div",At,[a(e(ga),{class:"h-12 w-12 text-gray-400 mx-auto mb-3"}),s[6]||(s[6]=o("p",{class:"text-sm text-muted-foreground"}," No hay comentarios históricos ",-1))]))]))}}),zt=la(St,[["__scopeId","data-v-e630c3bf"]]),jt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Et={class:"flex items-center justify-between"},Vt={class:"text-3xl font-bold"},Tt={class:"text-muted-foreground"},Ft={class:"flex items-center justify-between"},Lt={class:"flex items-center gap-4"},Nt={class:"flex items-center gap-2"},Rt={class:"text-sm text-muted-foreground"},Dt={key:0,class:"flex items-center gap-2 text-sm"},Mt={class:"text-muted-foreground"},It={key:0,class:"flex gap-2"},Bt={class:"flex justify-end gap-2"},qt={key:0,class:"text-sm text-destructive mt-1"},Ht={class:"flex justify-end gap-2"},Ot={class:"p-4 bg-orange-100 dark:bg-orange-900/30 rounded-lg"},Ut={class:"flex items-start gap-3"},Pt={key:0,class:"text-sm text-destructive mt-1"},Wt={class:"flex justify-end gap-2"},Gt={class:"grid gap-4 md:grid-cols-2"},Jt={class:"text-muted-foreground"},Xt={class:"text-muted-foreground"},Kt={class:"text-muted-foreground"},Zt={class:"text-muted-foreground"},Qt={class:"flex items-center gap-2"},Yt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},er={class:"text-center"},ar={class:"text-2xl font-bold"},tr={class:"text-center"},rr={class:"text-2xl font-bold text-green-600"},or={class:"text-center"},sr={class:"text-2xl font-bold text-red-600"},nr={class:"text-center"},lr={class:"text-2xl font-bold text-yellow-600"},ir={class:"mt-4"},dr={class:"flex justify-between text-sm mb-1"},ur={class:"w-full bg-gray-200 rounded-full h-2"},cr=["innerHTML"],mr={key:0,class:"mt-4 pt-4 border-t border-blue-200 dark:border-blue-700"},pr={class:"flex items-center space-x-3"},fr={class:"flex justify-end gap-2"},gr={key:0,class:"text-center py-8"},vr={key:1,class:"space-y-6"},br={key:0},_r={key:0,class:"text-red-500"},yr={key:0,class:"text-xs text-muted-foreground mb-2"},hr={class:"mt-2"},kr={key:2,class:"text-muted-foreground"},xr={key:1,class:"space-y-4"},qo=Q({__name:"Show",props:{candidatura:{},configuracion_campos:{},campo_aprobaciones:{},resumen_aprobaciones:{},puede_aprobar_campos:{type:Boolean},puede_comentar:{type:Boolean},comentarios:{}},setup(q){var pe;const v=q,E=((pe=Je().props.auth)==null?void 0:pe.user)||null,S=Xe(v.campo_aprobaciones||{}),V=l=>{S[l.campo_id]=l,fe.reload({only:["resumen_aprobaciones"]})},x=A(!1),c=[{title:"Admin",href:"/admin/dashboard"},{title:"Candidaturas",href:"/admin/candidaturas"},{title:v.candidatura.usuario.name,href:"#"}],s=A(!1),f=A(!1),y=A(!1),L=A(v.candidatura.subsanar),T=A(!1),M=A(""),z=te({comentarios:""}),w=te({comentarios:""}),F=te({motivo:""}),H=A(!1),i=A(v.comentarios||[]),m=A(!1),C=A(!1),$=A(""),I=te({comentario:"",tipo:"general",enviar_email:!1}),Fe=D(()=>v.candidatura.estado==="pendiente"&&!ue(v.candidatura.formulario_data)),Le=D(()=>v.candidatura.estado==="pendiente"),Ne=D(()=>v.candidatura.estado==="aprobado"||v.candidatura.estado==="rechazado"||v.candidatura.estado==="pendiente"),ue=l=>!l||Object.keys(l).length===0,Re=()=>{z.post(`/admin/candidaturas/${v.candidatura.id}/aprobar`,{onSuccess:()=>{if(s.value=!1,z.comentarios){const l=Y(z.comentarios,"aprobacion");i.value.unshift(l),v.candidatura.comentarios_admin=z.comentarios,m.value=!0}}})},De=()=>{w.comentarios.trim()&&w.post(`/admin/candidaturas/${v.candidatura.id}/rechazar`,{onSuccess:()=>{f.value=!1;const l=Y(w.comentarios,"rechazo");i.value.unshift(l),v.candidatura.comentarios_admin=w.comentarios,m.value=!0}})},Me=()=>{z.reset(),s.value=!1},Ie=()=>{w.reset(),f.value=!1},Be=()=>{F.post(`/admin/candidaturas/${v.candidatura.id}/volver-borrador`,{onSuccess:()=>{if(y.value=!1,L.value=!0,F.motivo){const l=Y(F.motivo,"borrador");i.value.unshift(l),v.candidatura.comentarios_admin=F.motivo,m.value=!0}M.value="Candidatura devuelta a borrador con subsanación habilitada",setTimeout(()=>{M.value=""},3e3)}})},qe=()=>{F.reset(),y.value=!1},Y=(l,r)=>{const g=new Date,ee={general:"Comentario General",aprobacion:"Aprobación",rechazo:"Rechazo",borrador:"Vuelta a Borrador",nota_admin:"Nota Administrativa"},ae={general:"bg-blue-100 text-blue-800",aprobacion:"bg-green-100 text-green-800",rechazo:"bg-red-100 text-red-800",borrador:"bg-yellow-100 text-yellow-800",nota_admin:"bg-gray-100 text-gray-800"},We={general:"message-circle",aprobacion:"check-circle",rechazo:"x-circle",borrador:"rotate-ccw",nota_admin:"sticky-note"};return{id:Date.now(),comentario:l,tipo:r,tipo_label:ee[r]||"Desconocido",tipo_color:ae[r]||"bg-gray-100 text-gray-800",tipo_icon:We[r]||"message-square",version_candidatura:v.candidatura.version,enviado_por_email:!0,created_by:E?{id:E.id,name:E.name,email:E.email}:void 0,fecha:g.toISOString(),fecha_formateada:g.toLocaleDateString("es-ES")+" "+g.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),fecha_relativa:"hace unos segundos"}},He=async()=>{if(I.comentario.trim()){C.value=!0;try{const l=await ge.post(`/admin/candidaturas/${v.candidatura.id}/comentarios`,{comentario:I.comentario,tipo:I.tipo,enviar_email:I.enviar_email});l.data.success&&(i.value.unshift(l.data.comentario),v.candidatura.comentarios_admin=l.data.comentario.comentario,I.reset(),H.value=!1,m.value=!0,$.value=l.data.message||"Comentario agregado exitosamente",setTimeout(()=>{$.value=""},5e3),setTimeout(()=>{const r=document.querySelector("#historial-comentarios");r&&r.scrollIntoView({behavior:"smooth",block:"nearest"})},100))}catch(l){console.error("Error al agregar comentario:",l)}finally{C.value=!1}}},Oe=()=>{I.reset(),H.value=!1},Ue=async()=>{T.value=!0,M.value="";try{const l=await ge.post(`/admin/candidaturas/${v.candidatura.id}/toggle-subsanar`);if(l.data.success){L.value=l.data.subsanar,M.value=l.data.message;const r=l.data.subsanar?"Se habilitó la subsanación para esta candidatura":"Se deshabilitó la subsanación para esta candidatura",g=Y(r,"nota_admin");i.value.unshift(g),setTimeout(()=>{M.value=""},3e3)}}catch(l){console.error("Error al cambiar estado de subsanación:",l),M.value="Error al cambiar el estado de subsanación",setTimeout(()=>{M.value=""},3e3)}finally{T.value=!1}},ce=()=>{H.value=!0,setTimeout(()=>{const l=document.querySelector("#formulario-comentario");l&&l.scrollIntoView({behavior:"smooth",block:"center"})},100)},Pe=(l,r)=>{if(!r)return"No especificado";switch(l.type){case"checkbox":return Array.isArray(r)?r.join(", "):r;case"date":case"datepicker":try{return new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return r}case"disclaimer":if(typeof r=="object"&&r!==null)if(r.accepted===!0)try{return`✅ Aceptado el ${new Date(r.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return r;case"file":return null;case"repeater":return null;case"textarea":return r;default:return r}},me=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(l,r)=>(n(),p(P,null,[a(e(Ke),{title:`Candidatura - ${l.candidatura.usuario.name}`},null,8,["title"]),a(ia,{breadcrumbs:c},{default:t(()=>[o("div",jt,[o("div",Et,[o("div",null,[o("h1",Vt,u(l.candidatura.usuario.name),1),o("p",Tt," Candidatura "+u(l.candidatura.estado_label)+" - Versión "+u(l.candidatura.version),1)]),a(e(k),{variant:"outline",onClick:r[0]||(r[0]=g=>e(fe).visit("/admin/candidaturas"))},{default:t(()=>[a(e(da),{class:"mr-2 h-4 w-4"}),r[11]||(r[11]=d(" Volver a Lista ",-1))]),_:1})]),a(e(R),null,{default:t(()=>[a(e(N),{class:"p-6"},{default:t(()=>[o("div",Ft,[o("div",Lt,[o("div",Nt,[a(e(U),{class:W([l.candidatura.estado_color,"text-sm"])},{default:t(()=>[d(u(l.candidatura.estado_label),1)]),_:1},8,["class"]),o("span",Rt," Versión "+u(l.candidatura.version),1)]),l.candidatura.aprobado_por?(n(),p("div",Dt,[a(e(le),{class:"h-4 w-4"}),o("span",null,u(l.candidatura.aprobado_por.name),1),o("span",Mt,"- "+u(l.candidatura.fecha_aprobacion),1)])):b("",!0)]),!s.value&&!f.value&&!y.value&&!H.value?(n(),p("div",It,[Fe.value?(n(),h(e(k),{key:0,onClick:r[1]||(r[1]=g=>s.value=!0),class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[a(e(G),{class:"mr-2 h-4 w-4"}),r[12]||(r[12]=d(" Aprobar ",-1))]),_:1})):b("",!0),Le.value?(n(),h(e(k),{key:1,variant:"destructive",onClick:r[2]||(r[2]=g=>f.value=!0)},{default:t(()=>[a(e(J),{class:"mr-2 h-4 w-4"}),r[13]||(r[13]=d(" Rechazar ",-1))]),_:1})):b("",!0),Ne.value?(n(),h(e(k),{key:2,variant:"outline",onClick:r[3]||(r[3]=g=>y.value=!0),class:"border-orange-300 text-orange-700 hover:bg-orange-50"},{default:t(()=>[a(e(ze),{class:"mr-2 h-4 w-4"}),r[14]||(r[14]=d(" Volver a Borrador ",-1))]),_:1})):b("",!0),l.candidatura.estado==="borrador"?(n(),h(e(k),{key:3,onClick:Ue,disabled:T.value,variant:L.value?"default":"outline",class:W(L.value?"bg-blue-600 hover:bg-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50")},{default:t(()=>[T.value?(n(),h(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(n(),h(ie(L.value?e(ua):e(ca)),{key:1,class:"mr-2 h-4 w-4"})),d(" "+u(L.value?"Subsanación Habilitada":"Habilitar Subsanación"),1)]),_:1},8,["disabled","variant","class"])):b("",!0),l.puede_comentar?(n(),h(e(k),{key:4,variant:"outline",onClick:ce,class:"border-indigo-300 text-indigo-600 hover:bg-indigo-50"},{default:t(()=>[a(e(X),{class:"mr-2 h-4 w-4"}),r[15]||(r[15]=d(" Agregar Comentario ",-1))]),_:1})):b("",!0)])):b("",!0)])]),_:1})]),_:1}),s.value?(n(),h(e(R),{key:0,class:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"text-green-800 dark:text-green-200 flex items-center gap-2"},{default:t(()=>[a(e(G),{class:"h-5 w-5"}),r[16]||(r[16]=d(" Aprobar Candidatura ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[o("div",null,[a(e(j),{for:"approval_comments"},{default:t(()=>[...r[17]||(r[17]=[d("Comentarios (opcional)",-1)])]),_:1}),a(oe,{modelValue:e(z).comentarios,"onUpdate:modelValue":r[4]||(r[4]=g=>e(z).comentarios=g),placeholder:"Comentarios adicionales para el usuario...",rows:3},null,8,["modelValue"])]),o("div",Bt,[a(e(k),{variant:"outline",onClick:Me,disabled:e(z).processing},{default:t(()=>[...r[18]||(r[18]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:Re,disabled:e(z).processing,class:"bg-green-600 hover:bg-green-700"},{default:t(()=>[d(u(e(z).processing?"Aprobando...":"Confirmar Aprobación"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),f.value?(n(),h(e(R),{key:1,class:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/20"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"text-red-800 dark:text-red-200 flex items-center gap-2"},{default:t(()=>[a(e(J),{class:"h-5 w-5"}),r[19]||(r[19]=d(" Rechazar Candidatura ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[o("div",null,[a(e(j),{for:"rejection_comments"},{default:t(()=>[...r[20]||(r[20]=[d("Motivo del rechazo *",-1)])]),_:1}),a(oe,{modelValue:e(w).comentarios,"onUpdate:modelValue":r[5]||(r[5]=g=>e(w).comentarios=g),placeholder:"Explica al usuario qué debe corregir...",rows:4},null,8,["modelValue"]),e(w).errors.comentarios?(n(),p("p",qt,u(e(w).errors.comentarios),1)):b("",!0)]),o("div",Ht,[a(e(k),{variant:"outline",onClick:Ie,disabled:e(w).processing},{default:t(()=>[...r[21]||(r[21]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{variant:"destructive",onClick:De,disabled:!e(w).comentarios.trim()||e(w).processing},{default:t(()=>[d(u(e(w).processing?"Rechazando...":"Confirmar Rechazo"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),y.value?(n(),h(e(R),{key:2,class:"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-950/20"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"text-orange-800 dark:text-orange-200 flex items-center gap-2"},{default:t(()=>[a(e(ze),{class:"h-5 w-5"}),r[22]||(r[22]=d(" Volver Candidatura a Borrador ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[o("div",Ot,[o("div",Ut,[a(e(Ae),{class:"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5"}),r[23]||(r[23]=o("div",{class:"text-sm text-orange-800 dark:text-orange-200"},[o("p",{class:"font-medium"},'Esta acción volverá la candidatura al estado "Borrador"'),o("p",{class:"mt-1"},"El usuario podrá editar su candidatura nuevamente y deberá ser revisada otra vez.")],-1))])]),o("div",null,[a(e(j),{for:"revert_reason"},{default:t(()=>[...r[24]||(r[24]=[d("Motivo (opcional)",-1)])]),_:1}),a(oe,{modelValue:e(F).motivo,"onUpdate:modelValue":r[6]||(r[6]=g=>e(F).motivo=g),placeholder:"Explica al usuario por qué su candidatura volvió a borrador...",rows:3},null,8,["modelValue"]),e(F).errors.motivo?(n(),p("p",Pt,u(e(F).errors.motivo),1)):b("",!0)]),o("div",Wt,[a(e(k),{variant:"outline",onClick:qe,disabled:e(F).processing},{default:t(()=>[...r[25]||(r[25]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:Be,disabled:e(F).processing,class:"bg-orange-600 hover:bg-orange-700"},{default:t(()=>[d(u(e(F).processing?"Procesando...":"Confirmar"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),a(e(R),null,{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"flex items-center gap-2"},{default:t(()=>[a(e(le),{class:"h-5 w-5"}),r[26]||(r[26]=d(" Información del Usuario ",-1))]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[o("div",Gt,[o("div",null,[a(e(j),{class:"text-sm font-medium"},{default:t(()=>[...r[27]||(r[27]=[d("Nombre",-1)])]),_:1}),o("p",Jt,u(l.candidatura.usuario.name),1)]),o("div",null,[a(e(j),{class:"text-sm font-medium"},{default:t(()=>[...r[28]||(r[28]=[d("Email",-1)])]),_:1}),o("p",Xt,u(l.candidatura.usuario.email),1)]),o("div",null,[a(e(j),{class:"text-sm font-medium"},{default:t(()=>[...r[29]||(r[29]=[d("Fecha de creación",-1)])]),_:1}),o("p",Kt,u(me(l.candidatura.created_at)),1)]),o("div",null,[a(e(j),{class:"text-sm font-medium"},{default:t(()=>[...r[30]||(r[30]=[d("Última actualización",-1)])]),_:1}),o("p",Zt,u(me(l.candidatura.updated_at)),1)])])]),_:1})]),_:1}),l.resumen_aprobaciones&&l.puede_aprobar_campos?(n(),h(e(R),{key:3,class:"border-indigo-200 dark:border-indigo-800"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"flex items-center justify-between"},{default:t(()=>[o("span",Qt,[a(e(ma),{class:"h-5 w-5"}),r[31]||(r[31]=d(" Aprobación de Campos ",-1))]),a(e(k),{variant:"outline",size:"sm",onClick:r[7]||(r[7]=g=>x.value=!x.value)},{default:t(()=>[d(u(x.value?"Ocultar Aprobaciones":"Mostrar Aprobaciones"),1)]),_:1})]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[o("div",Yt,[o("div",er,[o("p",ar,u(l.resumen_aprobaciones.total),1),r[32]||(r[32]=o("p",{class:"text-xs text-muted-foreground"},"Total Campos",-1))]),o("div",tr,[o("p",rr,u(l.resumen_aprobaciones.aprobados),1),r[33]||(r[33]=o("p",{class:"text-xs text-muted-foreground"},"Aprobados",-1))]),o("div",or,[o("p",sr,u(l.resumen_aprobaciones.rechazados),1),r[34]||(r[34]=o("p",{class:"text-xs text-muted-foreground"},"Rechazados",-1))]),o("div",nr,[o("p",lr,u(l.resumen_aprobaciones.pendientes),1),r[35]||(r[35]=o("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))])]),o("div",ir,[o("div",dr,[r[36]||(r[36]=o("span",null,"Progreso de Aprobación",-1)),o("span",null,u(l.resumen_aprobaciones.porcentaje_aprobado)+"%",1)]),o("div",ur,[o("div",{class:"bg-green-600 h-2 rounded-full transition-all",style:Ze({width:`${l.resumen_aprobaciones.porcentaje_aprobado}%`})},null,4)])])]),_:1})]),_:1})):b("",!0),a(re,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:t(()=>[$.value?(n(),h(e(ve),{key:0,class:"border-green-200 bg-green-50 dark:bg-green-950/20"},{default:t(()=>[a(e(pa),{class:"h-4 w-4 text-green-600"}),a(e(be),{class:"text-green-800 dark:text-green-200"},{default:t(()=>[d(u($.value),1)]),_:1})]),_:1})):b("",!0)]),_:1}),a(re,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:t(()=>[M.value?(n(),h(e(ve),{key:0,class:"border-blue-200 bg-blue-50 dark:bg-blue-950/20"},{default:t(()=>[a(e(_a),{class:"h-4 w-4 text-blue-600"}),a(e(be),{class:"text-blue-800 dark:text-blue-200"},{default:t(()=>[d(u(M.value),1)]),_:1})]),_:1})):b("",!0)]),_:1}),l.candidatura.comentarios_admin?(n(),h(e(R),{key:4,class:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"text-blue-800 dark:text-blue-200 flex items-center gap-2"},{default:t(()=>[a(e(X),{class:"h-5 w-5"}),r[37]||(r[37]=d(" Comentarios de la comisión (actual) ",-1)),a(re,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"transform opacity-0 scale-75","enter-to-class":"transform opacity-100 scale-100"},{default:t(()=>[i.value.length>1?(n(),h(e(U),{variant:"secondary",key:i.value.length},{default:t(()=>[d(" +"+u(i.value.length-1)+" históricos ",1)]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[o("div",{class:"text-blue-700 dark:text-blue-300 prose prose-sm max-w-none",innerHTML:l.candidatura.comentarios_admin},null,8,cr),i.value.length>0?(n(),p("div",mr,[a(e(k),{onClick:r[8]||(r[8]=g=>m.value=!m.value),variant:"ghost",size:"sm",class:"text-blue-600 hover:text-blue-700"},{default:t(()=>[a(e(Se),{class:"h-4 w-4 mr-2"}),d(" "+u(m.value?"Ocultar":"Ver")+" historial de comentarios ",1)]),_:1})])):b("",!0)]),_:1})]),_:1})):b("",!0),H.value&&l.puede_comentar?(n(),h(e(R),{key:5,id:"formulario-comentario",class:"border-indigo-200 dark:border-indigo-800 bg-indigo-50 dark:bg-indigo-950/20"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"text-indigo-800 dark:text-indigo-200 flex items-center gap-2"},{default:t(()=>[a(e(Te),{class:"h-5 w-5"}),r[38]||(r[38]=d(" Agregar Comentario ",-1))]),_:1})]),_:1}),a(e(N),{class:"space-y-4"},{default:t(()=>[o("div",null,[a(e(j),{for:"nuevo_comentario"},{default:t(()=>[...r[39]||(r[39]=[d("Comentario *",-1)])]),_:1}),a(oe,{modelValue:e(I).comentario,"onUpdate:modelValue":r[9]||(r[9]=g=>e(I).comentario=g),placeholder:"Escribe tu comentario aquí...",rows:4},null,8,["modelValue"])]),o("div",pr,[a(e(Qe),{id:"enviar-email",checked:e(I).enviar_email,"onUpdate:checked":r[10]||(r[10]=g=>e(I).enviar_email=g)},null,8,["checked"]),a(e(j),{for:"enviar-email",class:"cursor-pointer"},{default:t(()=>[...r[40]||(r[40]=[d(" Notificar al usuario por correo electrónico ",-1)])]),_:1})]),o("div",fr,[a(e(k),{variant:"outline",onClick:Oe,disabled:C.value},{default:t(()=>[...r[41]||(r[41]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(e(k),{onClick:He,disabled:!e(I).comentario.trim()||C.value,class:"bg-indigo-600 hover:bg-indigo-700"},{default:t(()=>[C.value?(n(),h(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):b("",!0),d(" "+u(C.value?"Guardando...":"Guardar comentario"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):b("",!0),a(re,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 translate-y-4","enter-to-class":"transform opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 translate-y-0","leave-to-class":"transform opacity-0 translate-y-4"},{default:t(()=>[m.value&&i.value.length>0?(n(),h(e(R),{key:0,id:"historial-comentarios"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"flex items-center gap-2"},{default:t(()=>[a(e(Se),{class:"h-5 w-5"}),r[42]||(r[42]=d(" Historial de Comentarios ",-1))]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[a(zt,{comentarios:i.value,"puede-agregar":!0,onAgregarComentario:ce},null,8,["comentarios"])]),_:1})]),_:1})):b("",!0)]),_:1}),a(e(R),null,{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(O),{class:"flex items-center gap-2"},{default:t(()=>[a(e(Ve),{class:"h-5 w-5"}),r[43]||(r[43]=d(" Datos de la Candidatura ",-1))]),_:1})]),_:1}),a(e(N),null,{default:t(()=>[ue(l.candidatura.formulario_data)?(n(),p("div",gr,[a(e(Ae),{class:"mx-auto h-12 w-12 text-yellow-500"}),r[44]||(r[44]=o("h3",{class:"mt-4 text-lg font-medium"},"Candidatura vacía",-1)),r[45]||(r[45]=o("p",{class:"text-muted-foreground"},"El usuario aún no ha completado su perfil de candidatura.",-1))])):(n(),p("div",vr,[x.value?(n(),p("div",xr,[(n(!0),p(P,null,K(l.configuracion_campos,g=>(n(),h(ct,{key:g.id,"candidatura-id":l.candidatura.id,"campo-id":g.id,"campo-title":g.title,valor:l.candidatura.formulario_data[g.id],aprobacion:S[g.id],"puede-aprobar":l.puede_aprobar_campos,readonly:l.candidatura.estado==="aprobado",onCampoActualizado:V},null,8,["candidatura-id","campo-id","campo-title","valor","aprobacion","puede-aprobar","readonly"]))),128))])):(n(),p("div",br,[(n(!0),p(P,null,K(l.configuracion_campos,g=>{var ee,ae;return n(),p("div",{key:g.id,class:"border-b pb-4 last:border-b-0"},[a(e(j),{class:"text-sm font-medium flex items-center gap-1"},{default:t(()=>[d(u(g.title)+" ",1),g.required?(n(),p("span",_r,"*")):b("",!0)]),_:2},1024),g.description?(n(),p("p",yr,u(g.description),1)):b("",!0),o("div",hr,[g.type==="file"?(n(),h(se,{key:0,value:l.candidatura.formulario_data[g.id],label:g.title},null,8,["value","label"])):g.type==="repeater"?(n(),h(ne,{key:1,value:l.candidatura.formulario_data[g.id],label:g.title,fields:(ee=g.repeaterConfig)==null?void 0:ee.fields,"item-name":((ae=g.repeaterConfig)==null?void 0:ae.itemName)||"Elemento"},null,8,["value","label","fields","item-name"])):(n(),p("p",kr,u(Pe(g,l.candidatura.formulario_data[g.id])),1))])])}),128))]))]))]),_:1})]),_:1}),a(Ye,{"candidatura-id":l.candidatura.id,"version-actual":l.candidatura.version,"is-admin":!0},null,8,["candidatura-id","version-actual"])])]),_:1})],64))}});export{qo as default};
