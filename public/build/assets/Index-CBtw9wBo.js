import{_ as M}from"./index-BfnsDWvv.js";import{_}from"./createLucideIcon-DxtpjfGn.js";import{_ as g,c as x,a as F,b as P}from"./CardTitle.vue_vue_type_script_setup_true_lang-C7IOa7Ms.js";import{_ as q}from"./Input.vue_vue_type_script_setup_true_lang-DvCw7eEi.js";import{_ as O,a as X,b as J,c as K,d as Q}from"./SelectValue.vue_vue_type_script_setup_true_lang-BEteQu3B.js";import{_ as W,a as Y,b as S,c as m,d as Z,e as c}from"./TableHeader.vue_vue_type_script_setup_true_lang-DbCXP5Gb.js";import{_ as tt}from"./AdminLayout.vue_vue_type_script_setup_true_lang-_n2LO1UI.js";import{d as et,r as B,i as f,e,f as t,q as st,w as s,g as o,t as d,b as p,j as h,m as u,h as r,F as y,k as w,n as lt,x as at,y as ot,s as b}from"./app-Bm0zddHy.js";import{P as it}from"./plus-Bq3GpmTl.js";import{A as T}from"./arrow-left-BRoV5exk.js";import{F as A}from"./file-text-DWBwUy-u.js";import{C as E}from"./circle-check-big-BpMQ4cH9.js";import{C}from"./clock-Ba46vVtA.js";import{C as N}from"./circle-x-BhduOHTg.js";import{S as rt}from"./search-Cen4orNT.js";import{E as nt}from"./eye-Lrft5DxZ.js";import"./index-CjeZtQaE.js";import"./VisuallyHidden-SpKqNdm8.js";import"./check-Bgy2BvBz.js";import"./floating-ui.vue-DGr7A5yr.js";import"./useFlashMessages-D8h4LnKR.js";import"./index-QZMnO351.js";import"./x-CG4kNj6H.js";import"./index-owJja9AZ.js";import"./shield-kj79LTBi.js";import"./user-CdyH_Ihh.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BzlUZel9.js";import"./chevron-right-21GWq4il.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DhXAbrNZ.js";import"./Label.vue_vue_type_script_setup_true_lang-DVWxdLT3.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BjSiNVQs.js";import"./index-CGlGA4Sh.js";import"./circle-alert-XMbe1svA.js";import"./map-pin-BstPhaLn.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-0IVPPTKP.js";import"./chevrons-up-down-Bq7v30Y5.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CW7Js4wW.js";import"./tag-nVcGCD5C.js";import"./users-ZLIj--Dr.js";import"./target-XP67quly.js";import"./vote-Dnp20OG0.js";import"./folder-open-CSy_ZVNl.js";import"./send-BwlBoeFi.js";import"./briefcase-3TG4x5-C.js";import"./calendar-B9ei12_H.js";import"./megaphone-DNDdvONg.js";import"./user-check-CDxIvvGo.js";import"./clipboard-list-D5LXPQE8.js";import"./mail-PWyxIr74.js";import"./message-square-DSFmlFZ8.js";import"./external-link-x9aPFz1b.js";import"./panel-left-DIiuBb4I.js";import"./index-DsyuWqHK.js";const dt={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ut={class:"flex items-center justify-between"},mt={class:"text-3xl font-bold"},ct={class:"text-muted-foreground"},ft={class:"flex gap-2"},pt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},_t={class:"flex items-center space-x-2"},gt={class:"text-2xl font-bold"},xt={class:"flex items-center space-x-2"},vt={class:"text-2xl font-bold text-green-600"},bt={class:"flex items-center space-x-2"},ht={class:"text-2xl font-bold text-blue-600"},yt={class:"flex items-center space-x-2"},$t={class:"text-2xl font-bold text-red-600"},wt={class:"flex gap-4"},Ct={class:"flex-1"},kt={class:"relative"},Vt={class:"w-48"},It={key:0,class:"text-center py-8 text-muted-foreground"},Gt={key:0},Ft={key:1},Pt={class:"flex items-center gap-2"},St={class:"w-20 bg-gray-200 rounded-full h-2"},Bt={class:"text-xs text-muted-foreground"},Tt={class:"text-sm"},At={key:2,class:"mt-4 flex justify-center"},Et={class:"flex gap-2"},Ee=et({__name:"Index",props:{votacion:{},imports:{},isGeneral:{type:Boolean}},setup(i){const v=i,k=B(""),V=B("all"),U=v.isGeneral?[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Importaciones",href:"#"}]:[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:v.votacion.titulo,href:`/admin/votaciones/${v.votacion.id}/edit`},{title:"Historial de Importaciones",href:"#"}],j=[{value:"all",label:"Todos"},{value:"pending",label:"Pendientes"},{value:"processing",label:"Procesando"},{value:"completed",label:"Completadas"},{value:"failed",label:"Fallidas"}],$=n=>{switch(n){case"pending":return{icon:C,label:"Pendiente",class:"bg-yellow-100 text-yellow-800 border-yellow-300"};case"processing":return{icon:C,label:"Procesando",class:"bg-blue-100 text-blue-800 border-blue-300"};case"completed":return{icon:E,label:"Completada",class:"bg-green-100 text-green-800 border-green-300"};case"failed":return{icon:N,label:"Fallida",class:"bg-red-100 text-red-800 border-red-300"}}},I=()=>{v.votacion&&b.get(`/admin/votaciones/${v.votacion.id}/edit`)},z=()=>{b.get("/admin/usuarios")},G=()=>{b.get("/admin/imports/create")},D=n=>{b.get(`/admin/imports/${n}`)},H=n=>new Date(n).toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=n=>{if(n.status==="pending")return"En cola";if(n.status==="processing")return`${n.processed_rows}/${n.total_rows} procesados`;if(n.status==="failed")return"Falló durante procesamiento";const l=[];return n.successful_rows>0&&l.push(`${n.successful_rows} exitosos`),n.failed_rows>0&&l.push(`${n.failed_rows} errores`),l.join(", ")||"Sin datos"};return(n,l)=>(u(),f(y,null,[e(t(st),{title:i.isGeneral?"Importaciones de Usuarios":"Historial de Importaciones"},null,8,["title"]),e(tt,{breadcrumbs:t(U)},{default:s(()=>[o("div",dt,[o("div",ut,[o("div",null,[o("h1",mt,d(i.isGeneral?"Importaciones de Usuarios":"Historial de Importaciones"),1),o("p",ct,d(i.isGeneral?"Gestiona las importaciones CSV de usuarios":`Votación: ${i.votacion.titulo}`),1)]),o("div",ft,[i.isGeneral?(u(),p(t(_),{key:0,onClick:G},{default:s(()=>[e(t(it),{class:"mr-2 h-4 w-4"}),l[3]||(l[3]=r(" Nueva Importación ",-1))]),_:1})):h("",!0),i.isGeneral?(u(),p(t(_),{key:1,variant:"outline",onClick:z},{default:s(()=>[e(t(T),{class:"mr-2 h-4 w-4"}),l[4]||(l[4]=r(" Volver a Usuarios ",-1))]),_:1})):h("",!0),i.isGeneral?h("",!0):(u(),p(t(_),{key:2,variant:"outline",onClick:I},{default:s(()=>[e(t(T),{class:"mr-2 h-4 w-4"}),l[5]||(l[5]=r(" Volver a Votación ",-1))]),_:1}))])]),o("div",pt,[e(t(g),null,{default:s(()=>[e(t(x),{class:"pt-6"},{default:s(()=>[o("div",_t,[e(t(A),{class:"h-5 w-5 text-muted-foreground"}),o("div",null,[o("p",gt,d(i.imports.total),1),l[6]||(l[6]=o("p",{class:"text-xs text-muted-foreground"},"Total Importaciones",-1))])])]),_:1})]),_:1}),e(t(g),null,{default:s(()=>[e(t(x),{class:"pt-6"},{default:s(()=>[o("div",xt,[e(t(E),{class:"h-5 w-5 text-green-600"}),o("div",null,[o("p",vt,d(i.imports.data.filter(a=>a.status==="completed").length),1),l[7]||(l[7]=o("p",{class:"text-xs text-muted-foreground"},"Completadas",-1))])])]),_:1})]),_:1}),e(t(g),null,{default:s(()=>[e(t(x),{class:"pt-6"},{default:s(()=>[o("div",bt,[e(t(C),{class:"h-5 w-5 text-blue-600"}),o("div",null,[o("p",ht,d(i.imports.data.filter(a=>["pending","processing"].includes(a.status)).length),1),l[8]||(l[8]=o("p",{class:"text-xs text-muted-foreground"},"Activas",-1))])])]),_:1})]),_:1}),e(t(g),null,{default:s(()=>[e(t(x),{class:"pt-6"},{default:s(()=>[o("div",yt,[e(t(N),{class:"h-5 w-5 text-red-600"}),o("div",null,[o("p",$t,d(i.imports.data.filter(a=>a.status==="failed").length),1),l[9]||(l[9]=o("p",{class:"text-xs text-muted-foreground"},"Fallidas",-1))])])]),_:1})]),_:1})]),e(t(g),null,{default:s(()=>[e(t(F),null,{default:s(()=>[e(t(P),null,{default:s(()=>[...l[10]||(l[10]=[r("Filtros",-1)])]),_:1})]),_:1}),e(t(x),null,{default:s(()=>[o("div",wt,[o("div",Ct,[o("div",kt,[e(t(rt),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e(t(q),{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=a=>k.value=a),placeholder:"Buscar por nombre de archivo...",class:"pl-9"},null,8,["modelValue"])])]),o("div",Vt,[e(t(O),{modelValue:V.value,"onUpdate:modelValue":l[1]||(l[1]=a=>V.value=a)},{default:s(()=>[e(t(X),null,{default:s(()=>[e(t(J),{placeholder:"Estado"})]),_:1}),e(t(K),null,{default:s(()=>[(u(),f(y,null,w(j,a=>e(t(Q),{key:a.value,value:a.value},{default:s(()=>[r(d(a.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1}),e(t(g),null,{default:s(()=>[e(t(F),null,{default:s(()=>[e(t(P),null,{default:s(()=>[r("Importaciones ("+d(i.imports.total)+")",1)]),_:1})]),_:1}),e(t(x),null,{default:s(()=>[i.imports.data.length===0?(u(),f("div",It,[e(t(A),{class:"mx-auto h-12 w-12 mb-4"}),i.isGeneral?(u(),f("p",Gt,"No hay importaciones de usuarios registradas")):(u(),f("p",Ft,"No hay importaciones registradas para esta votación")),e(t(_),{variant:"outline",class:"mt-4",onClick:l[2]||(l[2]=a=>i.isGeneral?G():I())},{default:s(()=>[r(d(i.isGeneral?"Crear Primera Importación":"Realizar Primera Importación"),1)]),_:1})])):(u(),p(t(W),{key:1},{default:s(()=>[e(t(Y),null,{default:s(()=>[e(t(S),null,{default:s(()=>[e(t(m),null,{default:s(()=>[...l[11]||(l[11]=[r("Archivo",-1)])]),_:1}),e(t(m),null,{default:s(()=>[...l[12]||(l[12]=[r("Estado",-1)])]),_:1}),e(t(m),null,{default:s(()=>[...l[13]||(l[13]=[r("Progreso",-1)])]),_:1}),e(t(m),null,{default:s(()=>[...l[14]||(l[14]=[r("Resultados",-1)])]),_:1}),e(t(m),null,{default:s(()=>[...l[15]||(l[15]=[r("Creado por",-1)])]),_:1}),e(t(m),null,{default:s(()=>[...l[16]||(l[16]=[r("Fecha",-1)])]),_:1}),e(t(m),null,{default:s(()=>[...l[17]||(l[17]=[r("Duración",-1)])]),_:1}),e(t(m),{class:"text-right"},{default:s(()=>[...l[18]||(l[18]=[r("Acciones",-1)])]),_:1})]),_:1})]),_:1}),e(t(Z),null,{default:s(()=>[(u(!0),f(y,null,w(i.imports.data,a=>(u(),p(t(S),{key:a.id},{default:s(()=>[e(t(c),{class:"font-medium"},{default:s(()=>[r(d(a.original_filename),1)]),_:2},1024),e(t(c),null,{default:s(()=>[e(t(M),{class:lt($(a.status).class)},{default:s(()=>[(u(),p(at($(a.status).icon),{class:"mr-1 h-3 w-3"})),r(" "+d($(a.status).label),1)]),_:2},1032,["class"])]),_:2},1024),e(t(c),null,{default:s(()=>[o("div",Pt,[o("div",St,[o("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:ot({width:`${a.progress_percentage}%`})},null,4)]),o("span",Bt,d(a.progress_percentage)+"% ",1)])]),_:2},1024),e(t(c),null,{default:s(()=>[o("div",Tt,d(L(a)),1)]),_:2},1024),e(t(c),null,{default:s(()=>[r(d(a.created_by.name),1)]),_:2},1024),e(t(c),null,{default:s(()=>[r(d(H(a.created_at)),1)]),_:2},1024),e(t(c),null,{default:s(()=>[r(d(a.duration||"-"),1)]),_:2},1024),e(t(c),{class:"text-right"},{default:s(()=>[e(t(_),{variant:"ghost",size:"sm",onClick:R=>D(a.id)},{default:s(()=>[e(t(nt),{class:"h-4 w-4"})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})),i.imports.last_page>1?(u(),f("div",At,[o("div",Et,[(u(!0),f(y,null,w(i.imports.links,a=>(u(),p(t(_),{key:a.label,variant:a.active?"default":"outline",size:"sm",disabled:!a.url,onClick:R=>a.url&&t(b).get(a.url),innerHTML:a.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):h("",!0)]),_:1})]),_:1})])]),_:1},8,["breadcrumbs"])],64))}});export{Ee as default};
