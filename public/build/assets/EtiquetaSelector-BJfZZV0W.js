import{_ as E}from"./createLucideIcon-DpqMcHcs.js";import{_ as U}from"./index-Bv2D6OQs.js";import{_ as j}from"./Label.vue_vue_type_script_setup_true_lang-CTFOyKy8.js";import{_ as D,a as G,b as z}from"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BfwY53vC.js";import{_ as A,a as Z,b as M,c as Q,d as X,e as J}from"./index-DML-TSey.js";import{C as K}from"./chevrons-up-down-DnobICLq.js";import{P as O}from"./plus-DafQFHWU.js";import{C as R}from"./check-COi2Akip.js";import{X as W}from"./x-BtC0hBQf.js";import{G as Y,L as ee,B as ae,P as te,Z as se,H as oe,S as le,F as re,a as ne}from"./zap-w8N3d7cs.js";import{F as ie,T as ue,a as $}from"./target-PRmdjiaM.js";import{T as de}from"./trending-up-1khf_RXT.js";import{A as ce}from"./award-xKikvbvv.js";import{H as fe}from"./hash-QSQRCUjq.js";import{d as me,r as q,c as w,i as c,e as r,j as m,f as n,g as v,u as o,w as i,h as _,t as d,b as p,F as k,k as C,n as pe,q as S}from"./app-CR-2XB3C.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const he={class:"space-y-2"},ge={key:0,class:"flex justify-between items-center"},ve={class:"text-xs text-muted-foreground"},be={class:"text-left truncate"},ye={class:"p-2 text-sm"},we={key:1,class:"ml-auto text-xs text-muted-foreground"},ke={key:1,class:"flex flex-wrap gap-1.5"},Ce=["onClick","disabled"],xe={key:2,class:"text-sm text-muted-foreground"},Ve=me({__name:"EtiquetaSelector",props:{modelValue:{},categorias:{},maxEtiquetas:{default:10},placeholder:{default:"Seleccionar etiquetas..."},disabled:{type:Boolean,default:!1},allowCreate:{type:Boolean,default:!1},label:{default:""},description:{default:""}},emits:["update:modelValue","create"],setup(B,{emit:F}){const l=B,b=F,h=q(!1),u=q(""),x=`etiqueta-selector-${Math.random().toString(36).substr(2,9)}`,L=w(()=>{if(!u.value)return l.categorias;const a=u.value.toLowerCase();return l.categorias.map(t=>{var e;return{...t,etiquetas:((e=t.etiquetas)==null?void 0:e.filter(s=>{var g;return s.nombre.toLowerCase().includes(a)||((g=s.descripcion)==null?void 0:g.toLowerCase().includes(a))}))||[]}}).filter(t=>t.etiquetas.length>0)}),f=w(()=>{const a=[];return l.categorias.forEach(t=>{var e;(e=t.etiquetas)==null||e.forEach(s=>{l.modelValue.includes(s.id)&&a.push({...s,categoria:t})})}),a});function y(a){return l.modelValue.includes(a)}function N(a){return l.disabled?!1:y(a.id)?!0:l.modelValue.length<l.maxEtiquetas}function T(a){const t=a.id;let e=[...l.modelValue];if(y(t))e=e.filter(s=>s!==t);else if(e.length<l.maxEtiquetas)e.push(t);else return;b("update:modelValue",e)}function I(a){const t=l.modelValue.filter(e=>e!==a);b("update:modelValue",t)}function H(){var t;if(!l.allowCreate||!u.value)return;const a=(t=l.categorias[0])==null?void 0:t.id;a&&(b("create",u.value,a),u.value="",h.value=!1)}function V(a){return{Tag:$,Hash:fe,Bookmark:ne,Flag:re,Star:le,Heart:oe,Zap:se,Target:ue,Award:ce,TrendingUp:de,Folder:ie,Package:te,Box:ae,Layers:ee,Grid:Y}[a]||$}const P=w(()=>f.value.length===0?l.placeholder:f.value.length===1?f.value[0].nombre:`${f.value.length} etiquetas seleccionadas`);return(a,t)=>(r(),c("div",he,[a.label?(r(),c("div",ge,[n(o(j),{for:x},{default:i(()=>[_(d(a.label),1)]),_:1}),v("span",ve,d(f.value.length)+" / "+d(a.maxEtiquetas)+" seleccionadas ",1)])):m("",!0),n(o(D),{open:h.value,"onUpdate:open":t[1]||(t[1]=e=>h.value=e)},{default:i(()=>[n(o(G),{asChild:""},{default:i(()=>[n(o(E),{id:x,variant:"outline",role:"combobox","aria-expanded":h.value,disabled:a.disabled,class:"w-full justify-between"},{default:i(()=>[v("span",be,d(P.value),1),n(o(K),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:1},8,["aria-expanded","disabled"])]),_:1}),n(o(z),{class:"w-full p-0",align:"start"},{default:i(()=>[n(o(A),null,{default:i(()=>[n(o(Z),{placeholder:"Buscar etiqueta...",modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e)},null,8,["modelValue"]),n(o(M),null,{default:i(()=>[v("div",ye,[t[2]||(t[2]=_(" No se encontraron etiquetas. ",-1)),a.allowCreate&&u.value.length>2?(r(),p(o(E),{key:0,onClick:H,variant:"ghost",size:"sm",class:"w-full mt-1"},{default:i(()=>[n(o(O),{class:"mr-2 h-3 w-3"}),_(' Crear "'+d(u.value)+'" ',1)]),_:1})):m("",!0)])]),_:1}),n(o(Q),null,{default:i(()=>[(r(!0),c(k,null,C(L.value,e=>(r(),p(o(X),{key:e.id,heading:e.nombre},{default:i(()=>[(r(!0),c(k,null,C(e.etiquetas,s=>(r(),p(o(J),{key:s.id,value:s,onSelect:g=>T(s),disabled:!N(s),class:"cursor-pointer"},{default:i(()=>[n(o(R),{class:pe(["mr-2 h-4 w-4",y(s.id)?"opacity-100":"opacity-0"])},null,8,["class"]),e.icono?(r(),p(S(V(e.icono)),{key:0,class:"mr-2 h-3 w-3 opacity-60"})):m("",!0),_(" "+d(s.nombre)+" ",1),s.descripcion?(r(),c("span",we,d(s.descripcion),1)):m("",!0)]),_:2},1032,["value","onSelect","disabled"]))),128))]),_:2},1032,["heading"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),f.value.length>0?(r(),c("div",ke,[(r(!0),c(k,null,C(f.value,e=>(r(),p(o(U),{key:e.id,variant:"secondary",class:"pr-1"},{default:i(()=>{var s;return[(s=e.categoria)!=null&&s.icono?(r(),p(S(V(e.categoria.icono)),{key:0,class:"mr-1 h-3 w-3"})):m("",!0),_(" "+d(e.nombre)+" ",1),v("button",{onClick:g=>I(e.id),disabled:a.disabled,class:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[n(o(W),{class:"h-3 w-3 hover:opacity-80"})],8,Ce)]}),_:2},1024))),128))])):m("",!0),a.description?(r(),c("p",xe,d(a.description),1)):m("",!0)]))}}),ze=_e(Ve,[["__scopeId","data-v-96effc55"]]);export{ze as E};
