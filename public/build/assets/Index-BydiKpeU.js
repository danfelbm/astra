import{d as Q,c as q,r as V,i as d,e as n,f as s,u as o,p as U,w as i,g as a,j as w,b as v,t as p,P as H,h as m,n as h,x as G,F as E,k as P,s as O,at as R,W as f}from"./app-Dt2sukkq.js";import{_ as X}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BAX2dDyG.js";import{_ as x,c as b}from"./CardTitle.vue_vue_type_script_setup_true_lang-D3D16Ztn.js";import{c as Y,_ as u}from"./createLucideIcon-ADYiFz1p.js";import{_ as Z}from"./Input.vue_vue_type_script_setup_true_lang-B3JXaiF3.js";import{_ as ee}from"./index-DZUQ23bj.js";import{H as I}from"./HitoCard-C1Cg-TkP.js";import{t as D}from"./index-CTkeagVR.js";import{A as te}from"./arrow-left-CcnTTf_x.js";import{P as J}from"./plus-C-zod1mM.js";import{S as oe}from"./search-BkHaPo1l.js";import{L as se}from"./list-CoVgyVD2.js";import{T as re}from"./target-BlHWusLl.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-Dk5ovgNn.js";import"./index-DYtBqwXi.js";import"./floating-ui.vue-DhUnkJfc.js";import"./x-BpcUsJXn.js";import"./index-C_zthh-d.js";import"./shield-Cyievtug.js";import"./user-Ca0ja34E.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Ch_KWbnG.js";import"./chevron-right-CkT1ue1I.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-V01rVzxA.js";import"./VisuallyHidden-H3fpmsLx.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-XTf0O-lR.js";import"./index-YHYyGAco.js";import"./check-DzU-qwfx.js";import"./nullish-CHIgUVhi.js";import"./Label.vue_vue_type_script_setup_true_lang-DCZhrf2e.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CwNj20AO.js";import"./circle-alert-Bny28mZr.js";import"./map-pin-D1rtVCPc.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-TmplCPgM.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BlnKZeFr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-CLsbi7q1.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BcP5joWp.js";import"./tag-euMStffd.js";import"./users-ARKz5o5z.js";import"./vote-D-ho2Upj.js";import"./folder-open-BwpEZUDw.js";import"./send-D6GePUDU.js";import"./file-text-CrhgvIVS.js";import"./briefcase-CdnBkwVO.js";import"./calendar-CJYt0g6k.js";import"./megaphone-BWKT3hAA.js";import"./user-check-Cjdi1Rn1.js";import"./clipboard-list-DeVxPgd5.js";import"./mail-Cjqn3QRK.js";import"./message-square-CtTij58U.js";import"./external-link-GRGCmSzE.js";import"./panel-left-CvMlf3oX.js";import"./index-C5GM-A1h.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-AkMiQd1j.js";import"./Progress.vue_vue_type_script_setup_true_lang-DLCooW4I.js";import"./ellipsis-CYCkV2Pa.js";import"./pen-D-dBw5cv.js";import"./copy-YTl1p__t.js";import"./trash-2-Dt0_aFzc.js";import"./calendar-days-CQTKQq8C.js";import"./clock-CqEtmu8F.js";import"./eye-DWAsRPjV.js";import"./es-BDPlFIsO.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=Y("NetworkIcon",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),ae={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},le={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ne={class:"text-sm text-muted-foreground mt-1"},de={class:"flex items-center gap-2"},pe={key:0,class:"grid grid-cols-2 md:grid-cols-5 gap-4"},me={class:"text-2xl font-bold"},ue={class:"text-2xl font-bold text-gray-500"},ce={class:"text-2xl font-bold text-blue-500"},fe={class:"text-2xl font-bold text-green-500"},ye={class:"flex flex-col sm:flex-row gap-2"},ve={class:"flex-1"},ge={class:"relative"},he={class:"flex gap-2"},xe={key:1},be={key:0,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},_e={key:1,class:"space-y-3"},$e={class:"rounded-full bg-muted p-3 mb-4"},ke={class:"text-muted-foreground text-center mb-4"},we={key:3,class:"flex justify-center gap-2 mt-4"},Bt=Q({__name:"Index",props:{proyecto:{},hitos:{},filters:{},estadisticas:{},timeline:{},canCreate:{type:Boolean},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageDeliverables:{type:Boolean}},setup(F){var L,j;const l=F,c=q(()=>Array.isArray(l.hitos)?{data:l.hitos,current_page:1,last_page:1,per_page:l.hitos.length,total:l.hitos.length}:l.hitos),_=V(((L=l.filters)==null?void 0:L.search)||""),g=V(((j=l.filters)==null?void 0:j.estado)||""),y=V(!1),K=q(()=>{if(!y.value)return c.value.data;const t=c.value.data.filter(r=>!r.parent_id),e=(r,C=0)=>c.value.data.filter(k=>k.parent_id===r).flatMap(k=>[{...k,_nivel:C},...e(k.id,C+1)]);return t.flatMap(r=>[{...r,_nivel:0},...e(r.id,1)])}),W=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:l.proyecto.nombre,href:`/admin/proyectos/${l.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${l.proyecto.id}/hitos`}],z=t=>{f.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${t.id}`)},M=t=>{f.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${t.id}/edit`)},A=t=>{confirm(`¿Estás seguro de eliminar el hito "${t.nombre}"?`)&&f.delete(`/admin/proyectos/${l.proyecto.id}/hitos/${t.id}`,{onSuccess:()=>{D.success("Hito eliminado exitosamente")},onError:()=>{D.error("Error al eliminar el hito")}})},B=t=>{f.post(`/admin/proyectos/${l.proyecto.id}/hitos/${t.id}/duplicar`,{},{onSuccess:()=>{D.success("Hito duplicado exitosamente")},onError:()=>{D.error("Error al duplicar el hito")}})},N=t=>{f.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${t.id}/entregables/create`)},S=t=>{f.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${t.id}/entregables`)},T=()=>{f.get(`/admin/proyectos/${l.proyecto.id}/hitos`,{search:_.value,estado:g.value},{preserveState:!0,preserveScroll:!0})},$=t=>{g.value=t,T()};return(t,e)=>(n(),d(E,null,[s(o(U),{title:`Hitos - ${t.proyecto.nombre}`},null,8,["title"]),s(X,{breadcrumbs:W},{default:i(()=>[a("div",ae,[a("div",le,[a("div",null,[e[6]||(e[6]=a("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Hitos del Proyecto ",-1)),a("p",ne,p(t.proyecto.nombre),1)]),a("div",de,[s(o(H),{href:`/admin/proyectos/${t.proyecto.id}`},{default:i(()=>[s(o(u),{variant:"outline",size:"sm"},{default:i(()=>[s(o(te),{class:"h-4 w-4 mr-2"}),e[7]||(e[7]=m(" Volver al Proyecto ",-1))]),_:1})]),_:1},8,["href"]),t.canCreate?(n(),v(o(H),{key:0,href:`/admin/proyectos/${t.proyecto.id}/hitos/create`},{default:i(()=>[s(o(u),{size:"sm"},{default:i(()=>[s(o(J),{class:"h-4 w-4 mr-2"}),e[8]||(e[8]=m(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):w("",!0)])]),t.estadisticas?(n(),d("div",pe,[s(o(x),null,{default:i(()=>[s(o(b),{class:"p-4"},{default:i(()=>[a("p",me,p(t.estadisticas.total),1),e[9]||(e[9]=a("p",{class:"text-xs text-muted-foreground"},"Total",-1))]),_:1})]),_:1}),s(o(x),null,{default:i(()=>[s(o(b),{class:"p-4"},{default:i(()=>[a("p",ue,p(t.estadisticas.pendientes),1),e[10]||(e[10]=a("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),_:1})]),_:1}),s(o(x),null,{default:i(()=>[s(o(b),{class:"p-4"},{default:i(()=>[a("p",ce,p(t.estadisticas.en_progreso),1),e[11]||(e[11]=a("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),_:1})]),_:1}),s(o(x),null,{default:i(()=>[s(o(b),{class:"p-4"},{default:i(()=>[a("p",fe,p(t.estadisticas.completados),1),e[12]||(e[12]=a("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),_:1})]),_:1}),s(o(x),null,{default:i(()=>[s(o(b),{class:"p-4"},{default:i(()=>[a("p",{class:h(["text-2xl font-bold",{"text-red-500":t.estadisticas.vencidos>0}])},p(t.estadisticas.vencidos),3),e[13]||(e[13]=a("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))]),_:1})]),_:1})])):w("",!0),a("div",ye,[a("div",ve,[a("div",ge,[s(o(oe),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s(o(Z),{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=r=>_.value=r),placeholder:"Buscar hitos...",class:"pl-9",onKeyup:G(T,["enter"])},null,8,["modelValue"])])]),a("div",he,[s(o(u),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":y.value}),onClick:e[1]||(e[1]=r=>y.value=!y.value),title:"Cambiar vista"},{default:i(()=>[y.value?(n(),v(o(ie),{key:0,class:"h-4 w-4 mr-2"})):(n(),v(o(se),{key:1,class:"h-4 w-4 mr-2"})),m(" "+p(y.value?"Jerárquica":"Plana"),1)]),_:1},8,["class"]),s(o(u),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":g.value===""}),onClick:e[2]||(e[2]=r=>$(""))},{default:i(()=>[...e[14]||(e[14]=[m(" Todos ",-1)])]),_:1},8,["class"]),s(o(u),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":g.value==="pendiente"}),onClick:e[3]||(e[3]=r=>$("pendiente"))},{default:i(()=>[...e[15]||(e[15]=[m(" Pendientes ",-1)])]),_:1},8,["class"]),s(o(u),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":g.value==="en_progreso"}),onClick:e[4]||(e[4]=r=>$("en_progreso"))},{default:i(()=>[...e[16]||(e[16]=[m(" En Progreso ",-1)])]),_:1},8,["class"]),s(o(u),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":g.value==="completado"}),onClick:e[5]||(e[5]=r=>$("completado"))},{default:i(()=>[...e[17]||(e[17]=[m(" Completados ",-1)])]),_:1},8,["class"])])]),c.value.data.length>0?(n(),d("div",xe,[y.value?(n(),d("div",_e,[(n(!0),d(E,null,P(K.value,r=>(n(),d("div",{key:r.id,style:O({marginLeft:`${(r._nivel||0)*2}rem`}),class:"transition-all"},[s(I,{hito:r,"proyecto-id":t.proyecto.id,canEdit:t.canEdit,canDelete:t.canDelete,canManageDeliverables:t.canManageDeliverables,showActions:!0,onView:z,onEdit:M,onDelete:A,onDuplicate:B,onAddEntregable:N,onViewEntregables:S},R({_:2},[r._nivel>0?{name:"prepend",fn:i(()=>[s(o(ee),{variant:"outline",class:"mr-2"},{default:i(()=>[m(" Nivel "+p(r._nivel),1)]),_:2},1024)]),key:"0"}:void 0]),1032,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"])],4))),128))])):(n(),d("div",be,[(n(!0),d(E,null,P(c.value.data,r=>(n(),v(I,{key:r.id,hito:r,"proyecto-id":t.proyecto.id,canEdit:t.canEdit,canDelete:t.canDelete,canManageDeliverables:t.canManageDeliverables,showActions:!0,onView:z,onEdit:M,onDelete:A,onDuplicate:B,onAddEntregable:N,onViewEntregables:S},null,8,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"]))),128))]))])):(n(),v(o(x),{key:2},{default:i(()=>[s(o(b),{class:"flex flex-col items-center justify-center py-12"},{default:i(()=>[a("div",$e,[s(o(re),{class:"h-8 w-8 text-muted-foreground"})]),e[19]||(e[19]=a("h3",{class:"text-lg font-semibold mb-2"},"No hay hitos",-1)),a("p",ke,p(_.value?"No se encontraron hitos con los filtros aplicados":"Comienza creando el primer hito del proyecto"),1),t.canCreate&&!_.value?(n(),v(o(H),{key:0,href:`/admin/proyectos/${t.proyecto.id}/hitos/create`},{default:i(()=>[s(o(u),null,{default:i(()=>[s(o(J),{class:"h-4 w-4 mr-2"}),e[18]||(e[18]=m(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):w("",!0)]),_:1})]),_:1})),c.value.last_page>1?(n(),d("div",we,[(n(!0),d(E,null,P(c.value.last_page,r=>(n(),v(o(u),{key:r,variant:r===c.value.current_page?"default":"outline",size:"sm",onClick:C=>o(f).visit(`/admin/proyectos/${t.proyecto.id}/hitos?page=${r}`)},{default:i(()=>[m(p(r),1)]),_:2},1032,["variant","onClick"]))),128))])):w("",!0)])]),_:1})],64))}});export{Bt as default};
