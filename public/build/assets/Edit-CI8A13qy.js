import{d as B,C as D,r as g,i as f,e as p,f as t,u as e,p as F,w as r,g as i,P as x,h as m,t as n,l as N,j as c,F as V,k as q,b as A}from"./app-D8b1iyhG.js";import{_ as L}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CNKKI51X.js";import{_ as $,a as w,b as k,c as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-CpubZFQk.js";import{_ as E}from"./CardDescription.vue_vue_type_script_setup_true_lang-kW7TGVkd.js";import{_ as h}from"./createLucideIcon-BzCZ4Ux9.js";import{_ as y}from"./Input.vue_vue_type_script_setup_true_lang-DEoN5cyd.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-DXnOW2ZY.js";import{_ as O}from"./Textarea.vue_vue_type_script_setup_true_lang-4luaEOZk.js";import{_ as G,a as T,b as X,c as J,d as K}from"./SelectValue.vue_vue_type_script_setup_true_lang-BW9QKckn.js";import{_ as Q}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-DasgLx0W.js";import{t as C}from"./index-DFpoRNc9.js";import{A as W}from"./arrow-left-DAvFF-xx.js";import{X as Y}from"./x-Di3hRZd2.js";import{U as Z}from"./user-plus-BjgaSPMW.js";import{S as ee}from"./save-DTwqsIAl.js";import{f as U,e as M}from"./es-BDPlFIsO.js";import{p as H}from"./parseISO-DFjB8F03.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DfKxWH3N.js";import"./index-9EknitmW.js";import"./floating-ui.vue-D_44iLrk.js";import"./index-yOcDiT7U.js";import"./shield-CrMFR-sA.js";import"./user-DoEsQuJB.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Clw7uZZX.js";import"./chevron-right-C1p0_YAD.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D5C9pVNC.js";import"./VisuallyHidden-D42UHKy9.js";import"./index-_HrGOJG6.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CPkoHE-3.js";import"./circle-alert-BAiY2yAu.js";import"./map-pin-DH233x2C.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-D6e-kB5n.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CphnuyJe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-C6uCeRcr.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cl6UTNVG.js";import"./tag-DOh8ybwv.js";import"./users-bMGn_vPW.js";import"./target-9B9VxhTw.js";import"./vote-BNngkYIu.js";import"./folder-open-DzYKMiH4.js";import"./send-BGQbBVWn.js";import"./file-text-D-NxJb2x.js";import"./briefcase-CLa5E6pc.js";import"./calendar-C2mN7fi8.js";import"./megaphone-DB_W2_ij.js";import"./user-check-CENHsehh.js";import"./clipboard-list-CkSM2h9J.js";import"./mail-C9q7NsOX.js";import"./message-square-C_xQNDn7.js";import"./external-link-CoSv1yei.js";import"./panel-left-CtA1CDY4.js";import"./index-BFz4Rjr1.js";import"./check-DAlbwhOo.js";import"./index-BPeLIox3.js";import"./nullish-CHIgUVhi.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-Sq6Kq3jt.js";import"./search-CjcS3wba.js";import"./loader-circle-DMbkXxu9.js";import"./chevron-left-7Lb0TR5E.js";const oe={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},se={class:"flex items-center justify-between"},te={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ie={class:"font-semibold"},re={class:"font-semibold"},le={class:"font-semibold"},ae={class:"font-semibold"},de={class:"space-y-2"},ne={key:0,class:"text-sm text-red-500"},me={class:"space-y-2"},pe={key:0,class:"text-sm text-red-500"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe={class:"space-y-2"},ce={key:0,class:"text-sm text-red-500"},_e={class:"space-y-2"},be={key:0,class:"text-sm text-red-500"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye={class:"space-y-2"},ve={key:0,class:"text-sm text-red-500"},ge={class:"space-y-2"},xe={class:"space-y-2"},Ve={key:0,class:"p-3 bg-muted rounded-lg flex items-center justify-between"},$e={class:"font-medium"},we={class:"text-sm text-muted-foreground"},ke={key:0,class:"text-sm text-red-500"},Se={class:"space-y-2"},Ee={key:0,class:"text-sm text-red-500"},Ce={class:"flex justify-end gap-2 pt-4"},Po=B({__name:"Edit",props:{hito:{},proyecto:{},responsables:{},estados:{}},setup(j){const d=j,z=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:d.proyecto.nombre,href:`/admin/proyectos/${d.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${d.proyecto.id}/hitos`},{title:"Editar Hito",href:"#"}],s=D({nombre:d.hito.nombre||"",descripcion:d.hito.descripcion||"",fecha_inicio:d.hito.fecha_inicio||"",fecha_fin:d.hito.fecha_fin||"",estado:d.hito.estado||"pendiente",responsable_id:d.hito.responsable_id||null,orden:d.hito.orden||0}),v=g(!1),{route:I}=window,u=g(null),b=g(new Map);if(d.responsables.forEach(a=>b.value.set(a.id,a)),d.hito.responsable)u.value=d.hito.responsable,b.value.set(d.hito.responsable.id,d.hito.responsable);else if(s.responsable_id){const a=d.responsables.find(o=>o.id===s.responsable_id);a&&(u.value=a)}const R=a=>{if(a.userIds.length>0){const o=a.userIds[0];s.responsable_id=o,b.value.has(o)?u.value=b.value.get(o)||null:(u.value={id:o,name:`Usuario seleccionado (ID: ${o})`,email:"Se actualizará al guardar"},b.value.set(o,u.value))}},P=()=>{const a={...s.data()};s.transform(()=>a).put(`/admin/proyectos/${d.proyecto.id}/hitos/${d.hito.id}`,{onSuccess:()=>{C.success("Hito actualizado exitosamente")},onError:()=>{C.error("Error al actualizar el hito")}})};return(a,o)=>(p(),f(V,null,[t(e(F),{title:`Editar Hito - ${a.hito.nombre}`},null,8,["title"]),t(L,{breadcrumbs:z},{default:r(()=>[i("div",oe,[i("div",se,[o[10]||(o[10]=i("h1",{class:"text-2xl font-bold"},"Editar Hito",-1)),t(e(x),{href:`/admin/proyectos/${a.proyecto.id}/hitos`},{default:r(()=>[t(e(h),{variant:"outline",size:"sm"},{default:r(()=>[t(e(W),{class:"h-4 w-4 mr-2"}),o[9]||(o[9]=m(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),t(e($),{class:"mb-4"},{default:r(()=>[t(e(w),null,{default:r(()=>[t(e(k),null,{default:r(()=>[m(n(a.hito.nombre),1)]),_:1}),t(e(E),null,{default:r(()=>[m(" Editando hito del proyecto: "+n(a.proyecto.nombre),1)]),_:1})]),_:1}),t(e(S),null,{default:r(()=>{var l;return[i("div",te,[i("div",null,[o[11]||(o[11]=i("p",{class:"text-muted-foreground"},"Progreso",-1)),i("p",ie,n(a.hito.porcentaje_completado||0)+"%",1)]),i("div",null,[o[12]||(o[12]=i("p",{class:"text-muted-foreground"},"Entregables",-1)),i("p",re,n(((l=a.hito.entregables)==null?void 0:l.length)||0),1)]),i("div",null,[o[13]||(o[13]=i("p",{class:"text-muted-foreground"},"Creado",-1)),i("p",le,n(e(U)(e(H)(a.hito.created_at),"dd/MM/yyyy",{locale:e(M)})),1)]),i("div",null,[o[14]||(o[14]=i("p",{class:"text-muted-foreground"},"Última actualización",-1)),i("p",ae,n(e(U)(e(H)(a.hito.updated_at),"dd/MM/yyyy",{locale:e(M)})),1)])])]}),_:1})]),_:1}),t(e($),null,{default:r(()=>[t(e(w),null,{default:r(()=>[t(e(k),null,{default:r(()=>[...o[15]||(o[15]=[m("Información del Hito",-1)])]),_:1}),t(e(E),null,{default:r(()=>[...o[16]||(o[16]=[m(" Modifica los detalles del hito ",-1)])]),_:1})]),_:1}),t(e(S),null,{default:r(()=>[i("form",{onSubmit:N(P,["prevent"]),class:"space-y-6"},[i("div",de,[t(e(_),{for:"nombre",required:""},{default:r(()=>[...o[17]||(o[17]=[m("Nombre del Hito",-1)])]),_:1}),t(e(y),{id:"nombre",modelValue:e(s).nombre,"onUpdate:modelValue":o[0]||(o[0]=l=>e(s).nombre=l),type:"text",placeholder:"Ej: Pre-producción",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.nombre?(p(),f("span",ne,n(e(s).errors.nombre),1)):c("",!0)]),i("div",me,[t(e(_),{for:"descripcion"},{default:r(()=>[...o[18]||(o[18]=[m("Descripción",-1)])]),_:1}),t(e(O),{id:"descripcion",modelValue:e(s).descripcion,"onUpdate:modelValue":o[1]||(o[1]=l=>e(s).descripcion=l),placeholder:"Describe el objetivo y alcance del hito...",disabled:e(s).processing,rows:"3"},null,8,["modelValue","disabled"]),e(s).errors.descripcion?(p(),f("span",pe,n(e(s).errors.descripcion),1)):c("",!0)]),i("div",ue,[i("div",fe,[t(e(_),{for:"fecha_inicio"},{default:r(()=>[...o[19]||(o[19]=[m("Fecha de Inicio",-1)])]),_:1}),t(e(y),{id:"fecha_inicio",modelValue:e(s).fecha_inicio,"onUpdate:modelValue":o[2]||(o[2]=l=>e(s).fecha_inicio=l),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_inicio?(p(),f("span",ce,n(e(s).errors.fecha_inicio),1)):c("",!0)]),i("div",_e,[t(e(_),{for:"fecha_fin"},{default:r(()=>[...o[20]||(o[20]=[m("Fecha de Fin",-1)])]),_:1}),t(e(y),{id:"fecha_fin",modelValue:e(s).fecha_fin,"onUpdate:modelValue":o[3]||(o[3]=l=>e(s).fecha_fin=l),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_fin?(p(),f("span",be,n(e(s).errors.fecha_fin),1)):c("",!0)])]),i("div",he,[i("div",ye,[t(e(_),{for:"estado"},{default:r(()=>[...o[21]||(o[21]=[m("Estado",-1)])]),_:1}),t(e(G),{modelValue:e(s).estado,"onUpdate:modelValue":o[4]||(o[4]=l=>e(s).estado=l)},{default:r(()=>[t(e(T),null,{default:r(()=>[t(e(X),{placeholder:"Seleccionar estado"})]),_:1}),t(e(J),null,{default:r(()=>[(p(!0),f(V,null,q(a.estados,l=>(p(),A(e(K),{key:l.value,value:l.value},{default:r(()=>[m(n(l.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(s).errors.estado?(p(),f("span",ve,n(e(s).errors.estado),1)):c("",!0)]),i("div",ge,[t(e(_),{for:"responsable_id"},{default:r(()=>[...o[22]||(o[22]=[m("Responsable",-1)])]),_:1}),i("div",xe,[u.value?(p(),f("div",Ve,[i("div",null,[i("p",$e,n(u.value.name),1),i("p",we,n(u.value.email),1)]),t(e(h),{type:"button",variant:"ghost",size:"sm",onClick:o[5]||(o[5]=l=>{e(s).responsable_id=null,u.value=null})},{default:r(()=>[t(e(Y),{class:"h-4 w-4"})]),_:1})])):c("",!0),t(e(h),{type:"button",variant:"outline",onClick:o[6]||(o[6]=l=>v.value=!0),class:"w-full"},{default:r(()=>[t(e(Z),{class:"h-4 w-4 mr-2"}),m(" "+n(u.value?"Cambiar Responsable":"Seleccionar Responsable"),1)]),_:1})]),e(s).errors.responsable_id?(p(),f("span",ke,n(e(s).errors.responsable_id),1)):c("",!0)])]),i("div",Se,[t(e(_),{for:"orden"},{default:r(()=>[...o[23]||(o[23]=[m("Orden de visualización",-1)])]),_:1}),t(e(y),{id:"orden",modelValue:e(s).orden,"onUpdate:modelValue":o[7]||(o[7]=l=>e(s).orden=l),modelModifiers:{number:!0},type:"number",min:"0",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.orden?(p(),f("span",Ee,n(e(s).errors.orden),1)):c("",!0),o[24]||(o[24]=i("p",{class:"text-sm text-muted-foreground"}," Define el orden en que aparece este hito en la lista ",-1))]),i("div",Ce,[t(e(x),{href:`/admin/proyectos/${a.proyecto.id}/hitos`},{default:r(()=>[t(e(h),{type:"button",variant:"outline"},{default:r(()=>[...o[25]||(o[25]=[m(" Cancelar ",-1)])]),_:1})]),_:1},8,["href"]),t(e(h),{type:"submit",disabled:e(s).processing},{default:r(()=>[t(e(ee),{class:"h-4 w-4 mr-2"}),o[26]||(o[26]=m(" Guardar Cambios ",-1))]),_:1},8,["disabled"])])],32)]),_:1})]),_:1})]),t(Q,{modelValue:v.value,"onUpdate:modelValue":o[8]||(o[8]=l=>v.value=l),title:"Seleccionar Responsable del Hito",description:"Selecciona el usuario que ser\\u00e1 responsable de este hito","search-endpoint":e(I)("admin.proyectos.search-users"),"excluded-ids":e(s).responsable_id?[e(s).responsable_id]:[],"max-selection":1,"submit-button-text":"Seleccionar Responsable","search-placeholder":"Buscar por nombre, email, documento o tel\\u00e9fono...",onSubmit:R},null,8,["modelValue","search-endpoint","excluded-ids"])]),_:1})],64))}});export{Po as default};
