import{_ as N}from"./index-eGtaRp1p.js";import{_ as v}from"./createLucideIcon-5T-I5pMy.js";import{_ as J,c as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-CQSbQHaD.js";import{_ as Q}from"./Switch.vue_vue_type_script_setup_true_lang-C9F3bD2D.js";import{_ as R,a as K,b,c as p,d as X,e as c}from"./TableHeader.vue_vue_type_script_setup_true_lang-dvqzRRiR.js";import{_ as $,a as k,b as y,c as C,d as w,e as z,f as S,g as F}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DFaiYoGu.js";import{_ as V}from"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-BUgN1gUS.js";import{C as Y,_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-CjYNsLcC.js";import{d as ee,c as te,a as f,o as i,b as t,u as e,m as ae,e as a,f as n,P as T,g as o,i as m,j as g,F as E,r as D,t as r,W as x}from"./app-BtB2J7YA.js";import{_ as se}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-COGvgb6S.js";import{P as le}from"./plus-DTA5s97-.js";import{U as oe}from"./users-DQ2IcoSS.js";import{F as re}from"./index-Cp_ooq9d.js";import{S as ie}from"./square-pen-9ov20NHg.js";import{T as ne}from"./trash-2-DISCnXzP.js";import"./index-E4tAellK.js";import"./VisuallyHidden-rX-KhyFF.js";import"./Input.vue_vue_type_script_setup_true_lang-BgOljXl6.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CiCnucVk.js";import"./check-1_08Q_Fp.js";import"./VisuallyHiddenInput-CaYcziDi.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DrnoAbDy.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-2eKfYfTw.js";import"./index-Bm8GA0Az.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-C6phXvlg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-D2k75qBl.js";import"./Label.vue_vue_type_script_setup_true_lang-BXH-28fo.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CBvxYJLa.js";import"./briefcase-K6PEhXhu.js";import"./calendar-Df_jsOqU.js";import"./circle-alert-BcVLiJHw.js";import"./map-pin-BZyjIZ-q.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-1ybzw0Nu.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BH2a6or8.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-PdhKKxrM.js";import"./loader-circle-CsxJ1JTr.js";import"./search-CWjxY_c_.js";import"./history-B_8D0vzF.js";import"./save-DLWU4QLS.js";const de={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ue={class:"flex items-center justify-between"},fe={class:"relative min-h-[50vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},ce={class:"rounded-md border"},me={class:"font-medium"},_e={key:0,class:"text-sm text-muted-foreground"},pe={class:"flex items-center gap-3"},ve={key:0,class:"flex items-center gap-2"},ge={key:0},xe={key:1},he={class:"text-xs text-muted-foreground"},be={key:1,class:"ml-2"},$e={key:2,class:"text-xs text-muted-foreground"},ke={class:"flex items-center gap-1"},ye={class:"flex justify-end gap-2"},Ce={key:0,class:"flex items-center justify-between mt-4"},we={class:"text-sm text-muted-foreground"},ze={class:"flex gap-2"},_t=ee({__name:"Index",props:{votaciones:{},categorias:{},filters:{},filterFieldsConfig:{}},setup(q){const u=q,B=[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"}],P={fields:u.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por título o descripción...",quickSearchFields:["titulo","descripcion"],maxNestingLevel:2,allowSaveFilters:!0,debounceTime:500,autoApply:!1},j=d=>{x.get(`/admin/votaciones/${d}/imports`)},I=d=>{x.get(`/votaciones/${d}/resultados`)},{route:h}=window,M=te(()=>({quickSearch:u.filters.search,rootGroup:u.filters.advanced_filters?JSON.parse(u.filters.advanced_filters):void 0})),G=d=>{x.delete(`/admin/votaciones/${d}`,{onSuccess:()=>{}})},H=d=>{const s=d.estado==="borrador"?"activa":"borrador";x.post(`/admin/votaciones/${d.id}/toggle-status`,{estado:s},{preserveScroll:!0,onSuccess:()=>{},onError:l=>{console.error("Error toggling status:",l)}})},U=d=>{x.post(`/admin/votaciones/${d.id}/toggle-status`,{estado:"finalizada"},{preserveScroll:!0,onSuccess:()=>{},onError:s=>{console.error("Error finalizando votación:",s)}})},W=d=>{switch(d){case"borrador":return"secondary";case"activa":return"default";case"finalizada":return"outline";default:return"secondary"}},A=d=>new Date(d).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(d,s)=>(i(),f(E,null,[t(e(ae),{title:"Gestión de Votaciones"}),t(Z,{breadcrumbs:B},{default:a(()=>[n("div",de,[n("div",ue,[s[1]||(s[1]=n("div",null,[n("h1",{class:"text-3xl font-bold"},"Gestión de Votaciones"),n("p",{class:"text-muted-foreground"}," Administra todas las votaciones del sistema ")],-1)),t(e(v),{"as-child":""},{default:a(()=>[t(e(T),{href:e(h)("admin.votaciones.create")},{default:a(()=>[t(e(le),{class:"mr-2 h-4 w-4"}),s[0]||(s[0]=o(" Nueva Votación "))]),_:1},8,["href"])]),_:1})]),t(se,{config:P,route:e(h)("admin.votaciones.index"),"initial-filters":M.value},null,8,["route","initial-filters"]),n("div",fe,[t(e(J),{class:"border-0 shadow-none h-full"},{default:a(()=>[t(e(O),{class:"pt-6"},{default:a(()=>[n("div",ce,[t(e(R),null,{default:a(()=>[t(e(K),null,{default:a(()=>[t(e(b),null,{default:a(()=>[t(e(p),null,{default:a(()=>s[2]||(s[2]=[o("Título")])),_:1}),t(e(p),null,{default:a(()=>s[3]||(s[3]=[o("Categoría")])),_:1}),t(e(p),null,{default:a(()=>s[4]||(s[4]=[o("Estado")])),_:1}),t(e(p),null,{default:a(()=>s[5]||(s[5]=[o("Activar/Desactivar")])),_:1}),t(e(p),null,{default:a(()=>s[6]||(s[6]=[o("Fecha Inicio")])),_:1}),t(e(p),null,{default:a(()=>s[7]||(s[7]=[o("Fecha Fin")])),_:1}),t(e(p),null,{default:a(()=>s[8]||(s[8]=[o("Votantes")])),_:1}),t(e(p),{class:"text-right"},{default:a(()=>s[9]||(s[9]=[o("Acciones")])),_:1})]),_:1})]),_:1}),t(e(X),null,{default:a(()=>[u.votaciones.data.length===0?(i(),g(e(b),{key:0},{default:a(()=>[t(e(c),{colspan:8,class:"text-center py-8 text-muted-foreground"},{default:a(()=>s[10]||(s[10]=[o(" No se encontraron votaciones ")])),_:1})]),_:1})):m("",!0),(i(!0),f(E,null,D(u.votaciones.data,l=>(i(),g(e(b),{key:l.id},{default:a(()=>[t(e(c),null,{default:a(()=>{var _,L;return[n("div",null,[n("p",me,r(l.titulo),1),l.descripcion?(i(),f("p",_e,r((_=l.descripcion)==null?void 0:_.substring(0,60))+r(((L=l.descripcion)==null?void 0:L.length)>60?"...":""),1)):m("",!0)])]}),_:2},1024),t(e(c),null,{default:a(()=>[t(e(N),{variant:"outline"},{default:a(()=>[o(r(l.categoria.nombre),1)]),_:2},1024)]),_:2},1024),t(e(c),null,{default:a(()=>[t(e(N),{variant:W(l.estado)},{default:a(()=>[o(r(l.estado),1)]),_:2},1032,["variant"])]),_:2},1024),t(e(c),null,{default:a(()=>[n("div",pe,[l.estado!=="finalizada"?(i(),f("div",ve,[t(e($),null,{default:a(()=>[t(e(V),{"as-child":""},{default:a(()=>[t(e(Q),{checked:l.estado==="activa",disabled:!1},null,8,["checked"])]),_:2},1024),t(e(k),null,{default:a(()=>[t(e(y),null,{default:a(()=>[t(e(C),null,{default:a(()=>[o(r(l.estado==="activa"?"Desactivar votación":"Activar votación"),1)]),_:2},1024),t(e(w),null,{default:a(()=>[l.estado==="activa"?(i(),f("span",ge,' La votación "'+r(l.titulo)+'" será desactivada y volverá al estado borrador. Los votantes no podrán acceder hasta que la actives nuevamente. ',1)):(i(),f("span",xe,' La votación "'+r(l.titulo)+'" será activada y los votantes podrán empezar a votar. Asegúrate de que la configuración esté completa. ',1))]),_:2},1024)]),_:2},1024),t(e(z),null,{default:a(()=>[t(e(S),null,{default:a(()=>s[11]||(s[11]=[o("Cancelar")])),_:1}),t(e(F),{onClick:_=>H(l)},{default:a(()=>[o(r(l.estado==="activa"?"Desactivar":"Activar"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),n("span",he,r(l.estado==="activa"?"Activa":"Inactiva"),1)])):m("",!0),l.estado==="activa"?(i(),f("div",be,[t(e($),null,{default:a(()=>[t(e(V),{"as-child":""},{default:a(()=>[t(e(v),{variant:"outline",size:"sm",class:"text-orange-600 hover:text-orange-700"},{default:a(()=>s[12]||(s[12]=[o(" Finalizar ")])),_:1})]),_:1}),t(e(k),null,{default:a(()=>[t(e(y),null,{default:a(()=>[t(e(C),null,{default:a(()=>s[13]||(s[13]=[o("Finalizar votación")])),_:1}),t(e(w),null,{default:a(()=>[o(' La votación "'+r(l.titulo)+'" será finalizada permanentemente. Esta acción no se puede deshacer y los votantes ya no podrán votar. ',1)]),_:2},1024)]),_:2},1024),t(e(z),null,{default:a(()=>[t(e(S),null,{default:a(()=>s[14]||(s[14]=[o("Cancelar")])),_:1}),t(e(F),{onClick:_=>U(l),class:"bg-orange-600 text-white hover:bg-orange-700"},{default:a(()=>s[15]||(s[15]=[o(" Finalizar ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])):m("",!0),l.estado==="finalizada"?(i(),f("div",$e," Finalizada ")):m("",!0)])]),_:2},1024),t(e(c),null,{default:a(()=>[o(r(A(l.fecha_inicio)),1)]),_:2},1024),t(e(c),null,{default:a(()=>[o(r(A(l.fecha_fin)),1)]),_:2},1024),t(e(c),null,{default:a(()=>[n("div",ke,[t(e(oe),{class:"h-4 w-4 text-muted-foreground"}),n("span",null,r(l.votantes_count||0),1)])]),_:2},1024),t(e(c),{class:"text-right"},{default:a(()=>[n("div",ye,[t(e(v),{variant:"ghost",size:"sm",onClick:_=>j(l.id),title:"Ver historial de importaciones"},{default:a(()=>[t(e(re),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),l.resultados_publicos?(i(),g(e(v),{key:0,variant:"ghost",size:"sm",onClick:_=>I(l.id),title:"Ver resultados",class:"text-blue-600 hover:text-blue-700"},{default:a(()=>[t(e(Y),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):m("",!0),l.estado==="borrador"?(i(),g(e(v),{key:1,variant:"ghost",size:"sm","as-child":""},{default:a(()=>[t(e(T),{href:e(h)("admin.votaciones.edit",l.id)},{default:a(()=>[t(e(ie),{class:"h-4 w-4"})]),_:2},1032,["href"])]),_:2},1024)):m("",!0),l.estado==="borrador"?(i(),g(e($),{key:2},{default:a(()=>[t(e(V),{"as-child":""},{default:a(()=>[t(e(v),{variant:"ghost",size:"sm"},{default:a(()=>[t(e(ne),{class:"h-4 w-4 text-destructive"})]),_:1})]),_:1}),t(e(k),null,{default:a(()=>[t(e(y),null,{default:a(()=>[t(e(C),null,{default:a(()=>s[16]||(s[16]=[o("¿Eliminar votación?")])),_:1}),t(e(w),null,{default:a(()=>[o(' Esta acción no se puede deshacer. Se eliminará permanentemente la votación "'+r(l.titulo)+'" y todos sus datos asociados. ',1)]),_:2},1024)]),_:2},1024),t(e(z),null,{default:a(()=>[t(e(S),null,{default:a(()=>s[17]||(s[17]=[o("Cancelar")])),_:1}),t(e(F),{onClick:_=>G(l.id),class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:a(()=>s[18]||(s[18]=[o(" Eliminar ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):m("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),u.votaciones.last_page>1?(i(),f("div",Ce,[n("p",we," Mostrando "+r((u.votaciones.current_page-1)*u.votaciones.per_page+1)+" a "+r(Math.min(u.votaciones.current_page*u.votaciones.per_page,u.votaciones.total))+" de "+r(u.votaciones.total)+" resultados ",1),n("div",ze,[(i(!0),f(E,null,D(u.votaciones.links,l=>(i(),g(e(v),{key:l.label,variant:l.active?"default":"outline",disabled:!l.url,size:"sm",onClick:_=>l.url&&e(x).get(l.url),innerHTML:l.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):m("",!0)]),_:1})]),_:1})])])]),_:1})],64))}});export{_t as default};
