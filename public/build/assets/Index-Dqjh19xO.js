import{d as Q,r as W,s as k,p as Y,i as f,e as s,f as e,q as Z,w as a,g as o,h as i,t as n,j as v,m as u,F as E,k as q,b as C}from"./app-D3uL80DL.js";import{_ as tt}from"./AdminLayout.vue_vue_type_script_setup_true_lang-5b8sApI_.js";import{_ as g,c as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-qn2XrUlO.js";import{_ as h}from"./createLucideIcon-BrIWJaVK.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-uaeWT7ys.js";import{_ as F}from"./index-oixONa7Y.js";import{_ as et,a as st,b as R,c as p,d as at,e as _}from"./TableHeader.vue_vue_type_script_setup_true_lang-B9n_iXov.js";import{_ as U,a as B,b as D,c as M,d as x}from"./SelectValue.vue_vue_type_script_setup_true_lang-BOihT4Gi.js";import{_ as lt,a as ot,b as it,e as S}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-oX-V50Fz.js";import{t as b}from"./index-B0qEHdwE.js";import{l as rt}from"./lodash-BMuXw0rk.js";import{D as nt}from"./download-BGT3MxGT.js";import{U as dt}from"./users-DQdQrWqw.js";import{C as ut}from"./clock-j5gzA8iu.js";import{C as mt}from"./circle-check-big-DAa-ZeGI.js";import{X as P}from"./x-BzM2ne4W.js";import{S as ft}from"./search-BXL9qeIH.js";import{F as ct}from"./file-text-DcJUgIfz.js";import{E as pt}from"./ellipsis-vertical-D61GfGR2.js";import{E as _t}from"./eye-CtABHz_g.js";import{C as vt}from"./check-BgfrpJ3m.js";import{C as xt}from"./chevron-left-CHTG65PF.js";import{C as gt}from"./chevron-right-Dr7PM1oh.js";import{f as wt,e as bt}from"./es-BDPlFIsO.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BznyTpGx.js";import"./index-TDmGTbds.js";import"./floating-ui.vue-BNjM7QfA.js";import"./index-bPeRYsmi.js";import"./shield-B6xROWvg.js";import"./user-CWm-7GfG.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BH87WPyf.js";import"./VisuallyHidden-C1r3Vs3T.js";import"./index-Co0N6nza.js";import"./Label.vue_vue_type_script_setup_true_lang-gGRu1ZPZ.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CMVjCFVi.js";import"./circle-alert-k0Ae0_nD.js";import"./map-pin-D30VnEkT.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-D6KXfYdF.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Di9ublVQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-MvU5-ZU8.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C247yu8_.js";import"./tag-BE3jt4iA.js";import"./target-oXTbk5NL.js";import"./vote-BVQT8UmH.js";import"./folder-open-8K0iuanW.js";import"./send-DuzmAr6j.js";import"./briefcase-BEuFNtLg.js";import"./calendar-CDRuCcQt.js";import"./megaphone-NaazjYw7.js";import"./user-check-DUScA6Vz.js";import"./clipboard-list-DWwYfDFn.js";import"./mail-TC-dEBUZ.js";import"./message-square-C2LYB39K.js";import"./external-link-fPhA16MY.js";import"./panel-left-uN3Ol8Pl.js";import"./index-dOclHMU_.js";const yt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},kt={class:"flex items-center justify-between"},ht={class:"flex gap-2"},Ct={class:"grid gap-4 md:grid-cols-4"},$t={class:"flex flex-row items-center justify-between space-y-0"},St={class:"text-2xl font-bold"},Vt={class:"flex flex-row items-center justify-between space-y-0"},zt={class:"text-2xl font-bold text-yellow-600"},jt={class:"flex flex-row items-center justify-between space-y-0"},At={class:"text-2xl font-bold text-green-600"},Et={class:"flex flex-row items-center justify-between space-y-0"},Ft={class:"text-2xl font-bold text-red-600"},Rt={class:"grid gap-4 md:grid-cols-5"},Ut={class:"mt-4"},Bt={key:0,class:"text-center py-8"},Dt={key:1,class:"rounded-md border"},Mt={class:"font-semibold"},Pt={class:"text-sm text-muted-foreground"},Tt={class:"space-y-1"},Nt={key:0,class:"text-sm"},Lt={key:1,class:"text-sm"},Ht={key:2,class:"text-sm"},Gt={key:3,class:"text-sm text-muted-foreground"},It={key:1,class:"text-sm text-muted-foreground"},Ot={class:"text-sm"},Xt={key:0,class:"text-sm"},Jt={key:1,class:"text-sm text-muted-foreground"},Kt={key:2,class:"flex items-center justify-between mt-4"},Qt={class:"text-sm text-muted-foreground"},Wt={class:"flex items-center space-x-2"},Yt={class:"text-sm"},es=Q({__name:"Index",props:{requests:{},stats:{},filters:{}},setup(d){const V=window.route,y=d,T=[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Solicitudes de Actualizaci贸n",href:"/admin/solicitudes-actualizacion"}],m=W({status:y.filters.status||"all",has_documents:y.filters.has_documents||"all",date_from:y.filters.date_from||"",date_to:y.filters.date_to||"",search:y.filters.search||""}),z=()=>Object.entries(m.value).reduce((r,[t,l])=>(l&&l!=="all"&&(r[t]=l),r),{}),N=rt.debounce(()=>{const r=z();k.get("/admin/solicitudes-actualizacion",{...r,page:1},{preserveState:!0,preserveScroll:!0})},300);Y(()=>m.value,()=>{N()},{deep:!0});const L=()=>{m.value={status:"all",has_documents:"all",date_from:"",date_to:"",search:""}},j=r=>{const t=z();k.get("/admin/solicitudes-actualizacion",{...t,page:r},{preserveState:!0,preserveScroll:!0})},H=r=>{k.visit(`/admin/solicitudes-actualizacion/${r}`)},G=r=>{confirm("驴Aprobar esta solicitud de actualizaci贸n?")&&k.post(V("admin.update-requests.approve",{updateRequest:r}),{notes:"Aprobado desde lista"},{preserveScroll:!0,onSuccess:t=>{const l=t.props.flash;l!=null&&l.success?b.success(l.success):b.success("Solicitud aprobada correctamente")},onError:t=>{console.error("Error:",t);const l=(t==null?void 0:t.message)||"Error al aprobar la solicitud";b.error(l)},onFinish:t=>{const l=t.props.flash;l!=null&&l.error&&b.error(l.error)}})},I=r=>{const t=prompt("Motivo del rechazo:");t&&k.post(V("admin.update-requests.reject",{updateRequest:r}),{notes:t},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{b.success("Solicitud rechazada")},onError:l=>{console.error("Error:",l),b.error("Error al rechazar la solicitud")}})},O=()=>{window.location.href="/admin/solicitudes-actualizacion/export/csv?"+new URLSearchParams(m.value).toString()},X=r=>r?wt(new Date(r),"dd MMM yyyy HH:mm",{locale:bt}):"-",J=r=>{switch(r){case"pending":return"warning";case"approved":return"success";case"rejected":return"destructive";default:return"secondary"}},K=r=>{switch(r){case"pending":return"Pendiente";case"approved":return"Aprobada";case"rejected":return"Rechazada";default:return r}};return(r,t)=>(u(),f(E,null,[s(e(Z),{title:"Solicitudes de Actualizaci贸n"}),s(tt,{breadcrumbs:T},{default:a(()=>[o("div",yt,[o("div",kt,[t[8]||(t[8]=o("div",null,[o("h1",{class:"text-3xl font-bold tracking-tight"},"Solicitudes de Actualizaci贸n"),o("p",{class:"text-muted-foreground"}," Gestiona las solicitudes de actualizaci贸n de datos de usuarios ")],-1)),o("div",ht,[s(e(h),{onClick:O,variant:"outline"},{default:a(()=>[s(e(nt),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=i(" Exportar CSV ",-1))]),_:1})])]),o("div",Ct,[s(e(g),null,{default:a(()=>[s(e(w),{class:"pt-6"},{default:a(()=>[o("div",$t,[o("div",null,[t[9]||(t[9]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Total Solicitudes",-1)),o("p",St,n(d.stats.total),1)]),s(e(dt),{class:"h-4 w-4 text-muted-foreground"})])]),_:1})]),_:1}),s(e(g),null,{default:a(()=>[s(e(w),{class:"pt-6"},{default:a(()=>[o("div",Vt,[o("div",null,[t[10]||(t[10]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Pendientes",-1)),o("p",zt,n(d.stats.pending),1)]),s(e(ut),{class:"h-4 w-4 text-yellow-500"})])]),_:1})]),_:1}),s(e(g),null,{default:a(()=>[s(e(w),{class:"pt-6"},{default:a(()=>[o("div",jt,[o("div",null,[t[11]||(t[11]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Aprobadas",-1)),o("p",At,n(d.stats.approved),1)]),s(e(mt),{class:"h-4 w-4 text-green-500"})])]),_:1})]),_:1}),s(e(g),null,{default:a(()=>[s(e(w),{class:"pt-6"},{default:a(()=>[o("div",Et,[o("div",null,[t[12]||(t[12]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Rechazadas",-1)),o("p",Ft,n(d.stats.rejected),1)]),s(e(P),{class:"h-4 w-4 text-red-500"})])]),_:1})]),_:1})]),s(e(g),null,{default:a(()=>[s(e(w),{class:"pt-6"},{default:a(()=>[o("div",Rt,[o("div",null,[s(e($),{modelValue:m.value.search,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value.search=l),placeholder:"Buscar por nombre/documento...",class:"w-full"},{prefix:a(()=>[s(e(ft),{class:"h-4 w-4 text-muted-foreground"})]),_:1},8,["modelValue"])]),s(e(U),{modelValue:m.value.status,"onUpdate:modelValue":t[1]||(t[1]=l=>m.value.status=l)},{default:a(()=>[s(e(B),null,{default:a(()=>[s(e(D),{placeholder:"Estado"})]),_:1}),s(e(M),null,{default:a(()=>[s(e(x),{value:"all"},{default:a(()=>[...t[13]||(t[13]=[i("Todos",-1)])]),_:1}),s(e(x),{value:"pending"},{default:a(()=>[...t[14]||(t[14]=[i("Pendiente",-1)])]),_:1}),s(e(x),{value:"approved"},{default:a(()=>[...t[15]||(t[15]=[i("Aprobada",-1)])]),_:1}),s(e(x),{value:"rejected"},{default:a(()=>[...t[16]||(t[16]=[i("Rechazada",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(e(U),{modelValue:m.value.has_documents,"onUpdate:modelValue":t[2]||(t[2]=l=>m.value.has_documents=l)},{default:a(()=>[s(e(B),null,{default:a(()=>[s(e(D),{placeholder:"Documentos"})]),_:1}),s(e(M),null,{default:a(()=>[s(e(x),{value:"all"},{default:a(()=>[...t[17]||(t[17]=[i("Todos",-1)])]),_:1}),s(e(x),{value:"true"},{default:a(()=>[...t[18]||(t[18]=[i("Con documentos",-1)])]),_:1}),s(e(x),{value:"false"},{default:a(()=>[...t[19]||(t[19]=[i("Sin documentos",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(e($),{modelValue:m.value.date_from,"onUpdate:modelValue":t[3]||(t[3]=l=>m.value.date_from=l),type:"date",placeholder:"Fecha desde"},null,8,["modelValue"]),s(e($),{modelValue:m.value.date_to,"onUpdate:modelValue":t[4]||(t[4]=l=>m.value.date_to=l),type:"date",placeholder:"Fecha hasta"},null,8,["modelValue"])]),o("div",Ut,[s(e(h),{onClick:L,variant:"outline",size:"sm"},{default:a(()=>[...t[20]||(t[20]=[i(" Limpiar filtros ",-1)])]),_:1})])]),_:1})]),_:1}),s(e(g),null,{default:a(()=>[s(e(w),{class:"pt-6"},{default:a(()=>[d.requests.data.length===0?(u(),f("div",Bt,[...t[21]||(t[21]=[o("p",{class:"text-muted-foreground"},"No se encontraron solicitudes",-1)])])):(u(),f("div",Dt,[s(e(et),null,{default:a(()=>[s(e(st),null,{default:a(()=>[s(e(R),null,{default:a(()=>[s(e(p),null,{default:a(()=>[...t[22]||(t[22]=[i("#",-1)])]),_:1}),s(e(p),null,{default:a(()=>[...t[23]||(t[23]=[i("Usuario",-1)])]),_:1}),s(e(p),null,{default:a(()=>[...t[24]||(t[24]=[i("Cambios",-1)])]),_:1}),s(e(p),null,{default:a(()=>[...t[25]||(t[25]=[i("Documentos",-1)])]),_:1}),s(e(p),null,{default:a(()=>[...t[26]||(t[26]=[i("Estado",-1)])]),_:1}),s(e(p),null,{default:a(()=>[...t[27]||(t[27]=[i("Fecha",-1)])]),_:1}),s(e(p),null,{default:a(()=>[...t[28]||(t[28]=[i("Admin",-1)])]),_:1}),s(e(p),{class:"text-right"},{default:a(()=>[...t[29]||(t[29]=[i("Acciones",-1)])]),_:1})]),_:1})]),_:1}),s(e(at),null,{default:a(()=>[(u(!0),f(E,null,q(d.requests.data,l=>(u(),C(e(R),{key:l.id},{default:a(()=>[s(e(_),{class:"font-medium"},{default:a(()=>[i(n(l.id),1)]),_:2},1024),s(e(_),null,{default:a(()=>[o("div",null,[o("p",Mt,n(l.user.name),1),o("p",Pt,n(l.user.documento_identidad),1)])]),_:2},1024),s(e(_),null,{default:a(()=>{var c,A;return[o("div",Tt,[l.new_email?(u(),f("div",Nt,"  "+n(l.new_email),1)):v("",!0),l.new_telefono?(u(),f("div",Lt,"  "+n(l.new_telefono),1)):v("",!0),l.new_municipio?(u(),f("div",Ht,"  "+n([(c=l.new_departamento)==null?void 0:c.nombre,(A=l.new_municipio)==null?void 0:A.nombre].filter(Boolean).join(", ")),1)):v("",!0),!l.new_email&&!l.new_telefono&&!l.new_municipio?(u(),f("div",Gt," Sin cambios ")):v("",!0)])]}),_:2},1024),s(e(_),null,{default:a(()=>{var c;return[((c=l.documentos_soporte)==null?void 0:c.length)>0?(u(),C(e(F),{key:0},{default:a(()=>[s(e(ct),{class:"mr-1 h-3 w-3"}),i(" "+n(l.documentos_soporte.length),1)]),_:2},1024)):(u(),f("span",It,"-"))]}),_:2},1024),s(e(_),null,{default:a(()=>[s(e(F),{variant:J(l.status)},{default:a(()=>[i(n(K(l.status)),1)]),_:2},1032,["variant"])]),_:2},1024),s(e(_),null,{default:a(()=>[o("span",Ot,n(X(l.created_at)),1)]),_:2},1024),s(e(_),null,{default:a(()=>[l.admin?(u(),f("span",Xt,n(l.admin.name),1)):(u(),f("span",Jt,"-"))]),_:2},1024),s(e(_),{class:"text-right"},{default:a(()=>[s(e(lt),null,{default:a(()=>[s(e(ot),{"as-child":""},{default:a(()=>[s(e(h),{variant:"ghost",size:"icon"},{default:a(()=>[s(e(pt),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(it),{align:"end"},{default:a(()=>[s(e(S),{onClick:c=>H(l.id)},{default:a(()=>[s(e(_t),{class:"mr-2 h-4 w-4"}),t[30]||(t[30]=i(" Ver detalle ",-1))]),_:1},8,["onClick"]),l.status==="pending"?(u(),C(e(S),{key:0,onClick:c=>G(l.id),class:"text-green-600"},{default:a(()=>[s(e(vt),{class:"mr-2 h-4 w-4"}),t[31]||(t[31]=i(" Aprobar ",-1))]),_:1},8,["onClick"])):v("",!0),l.status==="pending"?(u(),C(e(S),{key:1,onClick:c=>I(l.id),class:"text-red-600"},{default:a(()=>[s(e(P),{class:"mr-2 h-4 w-4"}),t[32]||(t[32]=i(" Rechazar ",-1))]),_:1},8,["onClick"])):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])),d.requests.last_page>1?(u(),f("div",Kt,[o("div",Qt," Mostrando "+n(d.requests.from||0)+" a "+n(d.requests.to||0)+" de "+n(d.requests.total)+" resultados ",1),o("div",Wt,[s(e(h),{onClick:t[5]||(t[5]=l=>j(d.requests.current_page-1)),disabled:d.requests.current_page===1,variant:"outline",size:"sm"},{default:a(()=>[s(e(xt),{class:"h-4 w-4"}),t[33]||(t[33]=i(" Anterior ",-1))]),_:1},8,["disabled"]),o("div",Yt," P谩gina "+n(d.requests.current_page)+" de "+n(d.requests.last_page),1),s(e(h),{onClick:t[6]||(t[6]=l=>j(d.requests.current_page+1)),disabled:d.requests.current_page===d.requests.last_page,variant:"outline",size:"sm"},{default:a(()=>[t[34]||(t[34]=i(" Siguiente ",-1)),s(e(gt),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])):v("",!0)]),_:1})]),_:1})])]),_:1})],64))}});export{es as default};
