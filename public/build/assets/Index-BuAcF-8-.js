import{_ as M}from"./index-C9GdhwZn.js";import{_ as p}from"./createLucideIcon-BG919Rtc.js";import{_,c as g,a as G,b as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-BZnDIsbq.js";import{_ as W}from"./Input.vue_vue_type_script_setup_true_lang-CIE9aHh6.js";import{_ as q,a as O,b as X,c as J,d as K}from"./SelectValue.vue_vue_type_script_setup_true_lang-DNb18nEz.js";import{_ as Q,a as Y,b as P,c as u,d as Z,e as m}from"./TableHeader.vue_vue_type_script_setup_true_lang-Ywuf4scH.js";import{_ as ee}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B5AmSGvv.js";import{d as te,r as S,i as f,e as d,f as t,u as e,p as se,w as s,g as r,t as n,b as c,j as x,h as i,F as h,k as $,n as le,q as ae,s as oe,W as b}from"./app-CNsNbJaU.js";import{P as re}from"./plus-DV1H89bY.js";import{A as B}from"./arrow-left-CB_1v_Qf.js";import{F as T}from"./file-text-ChTe-w0O.js";import{C as A}from"./circle-check-big-Co5bwIN2.js";import{C as w}from"./clock-BgJsSDJK.js";import{C as E}from"./circle-x-CcIIXr3e.js";import{S as ie}from"./search-BqPjSriO.js";import{E as ne}from"./eye-Dp-DTTpt.js";import"./index-DokoqITK.js";import"./VisuallyHidden-L6ik1lx4.js";import"./check-CFzf2JYc.js";import"./floating-ui.vue-ClLQHvu2.js";import"./nullish-CHIgUVhi.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DQMYh5Gv.js";import"./index-D5O-6KMg.js";import"./x-CH24zYz2.js";import"./index-BQvcUEPK.js";import"./shield-D-rurmJa.js";import"./user-1QV52cLG.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DxRb9IyH.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CJLkPl9b.js";import"./Label.vue_vue_type_script_setup_true_lang-Vr_4JsSA.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BlN2t4SW.js";import"./index-DDFssNIK.js";import"./circle-alert-DyX8jyra.js";import"./map-pin-BYO7IqQm.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-C5NUUFrZ.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-PEBE5d0i.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-BCkt__jB.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-jb7cBVQn.js";import"./users-DVfvVv5k.js";import"./vote-D2Rn5EGX.js";import"./send-DmP45aay.js";import"./briefcase-DRGEhwkF.js";import"./calendar-A9Ja9lbB.js";import"./megaphone--fqq65Q3.js";import"./user-check-AWjRCIrv.js";import"./mail-LPaIvF_v.js";import"./message-square-CNHF0QTF.js";import"./external-link-DsmjA91c.js";import"./panel-left-C4whrYPC.js";import"./index-B3OyOhdr.js";const de={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ue={class:"flex items-center justify-between"},me={class:"text-3xl font-bold"},fe={class:"text-muted-foreground"},ce={class:"flex gap-2"},pe={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},_e={class:"flex items-center space-x-2"},ge={class:"text-2xl font-bold"},ve={class:"flex items-center space-x-2"},be={class:"text-2xl font-bold text-green-600"},xe={class:"flex items-center space-x-2"},he={class:"text-2xl font-bold text-blue-600"},ye={class:"flex items-center space-x-2"},$e={class:"text-2xl font-bold text-red-600"},we={class:"flex gap-4"},Ce={class:"flex-1"},ke={class:"relative"},Ve={class:"w-48"},Ie={key:0,class:"text-center py-8 text-muted-foreground"},Ge={key:0},Fe={key:1},Pe={class:"flex items-center gap-2"},Se={class:"w-20 bg-gray-200 rounded-full h-2"},Be={class:"text-xs text-muted-foreground"},Te={class:"text-sm"},Ae={key:2,class:"mt-4 flex justify-center"},Ee={class:"flex gap-2"},Tt=te({__name:"Index",props:{votacion:{},imports:{},isGeneral:{type:Boolean}},setup(N){const v=N,C=S(""),k=S("all"),U=v.isGeneral?[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Importaciones",href:"#"}]:[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:v.votacion.titulo,href:`/admin/votaciones/${v.votacion.id}/edit`},{title:"Historial de Importaciones",href:"#"}],j=[{value:"all",label:"Todos"},{value:"pending",label:"Pendientes"},{value:"processing",label:"Procesando"},{value:"completed",label:"Completadas"},{value:"failed",label:"Fallidas"}],y=a=>{switch(a){case"pending":return{icon:w,label:"Pendiente",class:"bg-yellow-100 text-yellow-800 border-yellow-300"};case"processing":return{icon:w,label:"Procesando",class:"bg-blue-100 text-blue-800 border-blue-300"};case"completed":return{icon:A,label:"Completada",class:"bg-green-100 text-green-800 border-green-300"};case"failed":return{icon:E,label:"Fallida",class:"bg-red-100 text-red-800 border-red-300"}}},V=()=>{v.votacion&&b.get(`/admin/votaciones/${v.votacion.id}/edit`)},z=()=>{b.get("/admin/usuarios")},I=()=>{b.get("/admin/imports/create")},D=a=>{b.get(`/admin/imports/${a}`)},H=a=>new Date(a).toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=a=>{if(a.status==="pending")return"En cola";if(a.status==="processing")return`${a.processed_rows}/${a.total_rows} procesados`;if(a.status==="failed")return"Falló durante procesamiento";const l=[];return a.successful_rows>0&&l.push(`${a.successful_rows} exitosos`),a.failed_rows>0&&l.push(`${a.failed_rows} errores`),l.join(", ")||"Sin datos"};return(a,l)=>(d(),f(h,null,[t(e(se),{title:a.isGeneral?"Importaciones de Usuarios":"Historial de Importaciones"},null,8,["title"]),t(ee,{breadcrumbs:e(U)},{default:s(()=>[r("div",de,[r("div",ue,[r("div",null,[r("h1",me,n(a.isGeneral?"Importaciones de Usuarios":"Historial de Importaciones"),1),r("p",fe,n(a.isGeneral?"Gestiona las importaciones CSV de usuarios":`Votación: ${a.votacion.titulo}`),1)]),r("div",ce,[a.isGeneral?(d(),c(e(p),{key:0,onClick:I},{default:s(()=>[t(e(re),{class:"mr-2 h-4 w-4"}),l[3]||(l[3]=i(" Nueva Importación ",-1))]),_:1})):x("",!0),a.isGeneral?(d(),c(e(p),{key:1,variant:"outline",onClick:z},{default:s(()=>[t(e(B),{class:"mr-2 h-4 w-4"}),l[4]||(l[4]=i(" Volver a Usuarios ",-1))]),_:1})):x("",!0),a.isGeneral?x("",!0):(d(),c(e(p),{key:2,variant:"outline",onClick:V},{default:s(()=>[t(e(B),{class:"mr-2 h-4 w-4"}),l[5]||(l[5]=i(" Volver a Votación ",-1))]),_:1}))])]),r("div",pe,[t(e(_),null,{default:s(()=>[t(e(g),{class:"pt-6"},{default:s(()=>[r("div",_e,[t(e(T),{class:"h-5 w-5 text-muted-foreground"}),r("div",null,[r("p",ge,n(a.imports.total),1),l[6]||(l[6]=r("p",{class:"text-xs text-muted-foreground"},"Total Importaciones",-1))])])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[t(e(g),{class:"pt-6"},{default:s(()=>[r("div",ve,[t(e(A),{class:"h-5 w-5 text-green-600"}),r("div",null,[r("p",be,n(a.imports.data.filter(o=>o.status==="completed").length),1),l[7]||(l[7]=r("p",{class:"text-xs text-muted-foreground"},"Completadas",-1))])])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[t(e(g),{class:"pt-6"},{default:s(()=>[r("div",xe,[t(e(w),{class:"h-5 w-5 text-blue-600"}),r("div",null,[r("p",he,n(a.imports.data.filter(o=>["pending","processing"].includes(o.status)).length),1),l[8]||(l[8]=r("p",{class:"text-xs text-muted-foreground"},"Activas",-1))])])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[t(e(g),{class:"pt-6"},{default:s(()=>[r("div",ye,[t(e(E),{class:"h-5 w-5 text-red-600"}),r("div",null,[r("p",$e,n(a.imports.data.filter(o=>o.status==="failed").length),1),l[9]||(l[9]=r("p",{class:"text-xs text-muted-foreground"},"Fallidas",-1))])])]),_:1})]),_:1})]),t(e(_),null,{default:s(()=>[t(e(G),null,{default:s(()=>[t(e(F),null,{default:s(()=>[...l[10]||(l[10]=[i("Filtros",-1)])]),_:1})]),_:1}),t(e(g),null,{default:s(()=>[r("div",we,[r("div",Ce,[r("div",ke,[t(e(ie),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t(e(W),{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=o=>C.value=o),placeholder:"Buscar por nombre de archivo...",class:"pl-9"},null,8,["modelValue"])])]),r("div",Ve,[t(e(q),{modelValue:k.value,"onUpdate:modelValue":l[1]||(l[1]=o=>k.value=o)},{default:s(()=>[t(e(O),null,{default:s(()=>[t(e(X),{placeholder:"Estado"})]),_:1}),t(e(J),null,{default:s(()=>[(d(),f(h,null,$(j,o=>t(e(K),{key:o.value,value:o.value},{default:s(()=>[i(n(o.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[t(e(G),null,{default:s(()=>[t(e(F),null,{default:s(()=>[i("Importaciones ("+n(a.imports.total)+")",1)]),_:1})]),_:1}),t(e(g),null,{default:s(()=>[a.imports.data.length===0?(d(),f("div",Ie,[t(e(T),{class:"mx-auto h-12 w-12 mb-4"}),a.isGeneral?(d(),f("p",Ge,"No hay importaciones de usuarios registradas")):(d(),f("p",Fe,"No hay importaciones registradas para esta votación")),t(e(p),{variant:"outline",class:"mt-4",onClick:l[2]||(l[2]=o=>a.isGeneral?I():V())},{default:s(()=>[i(n(a.isGeneral?"Crear Primera Importación":"Realizar Primera Importación"),1)]),_:1})])):(d(),c(e(Q),{key:1},{default:s(()=>[t(e(Y),null,{default:s(()=>[t(e(P),null,{default:s(()=>[t(e(u),null,{default:s(()=>[...l[11]||(l[11]=[i("Archivo",-1)])]),_:1}),t(e(u),null,{default:s(()=>[...l[12]||(l[12]=[i("Estado",-1)])]),_:1}),t(e(u),null,{default:s(()=>[...l[13]||(l[13]=[i("Progreso",-1)])]),_:1}),t(e(u),null,{default:s(()=>[...l[14]||(l[14]=[i("Resultados",-1)])]),_:1}),t(e(u),null,{default:s(()=>[...l[15]||(l[15]=[i("Creado por",-1)])]),_:1}),t(e(u),null,{default:s(()=>[...l[16]||(l[16]=[i("Fecha",-1)])]),_:1}),t(e(u),null,{default:s(()=>[...l[17]||(l[17]=[i("Duración",-1)])]),_:1}),t(e(u),{class:"text-right"},{default:s(()=>[...l[18]||(l[18]=[i("Acciones",-1)])]),_:1})]),_:1})]),_:1}),t(e(Z),null,{default:s(()=>[(d(!0),f(h,null,$(a.imports.data,o=>(d(),c(e(P),{key:o.id},{default:s(()=>[t(e(m),{class:"font-medium"},{default:s(()=>[i(n(o.original_filename),1)]),_:2},1024),t(e(m),null,{default:s(()=>[t(e(M),{class:le(y(o.status).class)},{default:s(()=>[(d(),c(ae(y(o.status).icon),{class:"mr-1 h-3 w-3"})),i(" "+n(y(o.status).label),1)]),_:2},1032,["class"])]),_:2},1024),t(e(m),null,{default:s(()=>[r("div",Pe,[r("div",Se,[r("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:oe({width:`${o.progress_percentage}%`})},null,4)]),r("span",Be,n(o.progress_percentage)+"% ",1)])]),_:2},1024),t(e(m),null,{default:s(()=>[r("div",Te,n(L(o)),1)]),_:2},1024),t(e(m),null,{default:s(()=>[i(n(o.created_by.name),1)]),_:2},1024),t(e(m),null,{default:s(()=>[i(n(H(o.created_at)),1)]),_:2},1024),t(e(m),null,{default:s(()=>[i(n(o.duration||"-"),1)]),_:2},1024),t(e(m),{class:"text-right"},{default:s(()=>[t(e(p),{variant:"ghost",size:"sm",onClick:R=>D(o.id)},{default:s(()=>[t(e(ne),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})),a.imports.last_page>1?(d(),f("div",Ae,[r("div",Ee,[(d(!0),f(h,null,$(a.imports.links,o=>(d(),c(e(p),{key:o.label,variant:o.active?"default":"outline",size:"sm",disabled:!o.url,onClick:R=>o.url&&e(b).get(o.url),innerHTML:o.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):x("",!0)]),_:1})]),_:1})])]),_:1},8,["breadcrumbs"])],64))}});export{Tt as default};
