import{P as te,c as qe,_ as O,a as oe}from"./createLucideIcon-DYCv6hRJ.js";import{_ as Z,c as ee,a as de,b as ue}from"./CardTitle.vue_vue_type_script_setup_true_lang-DfXdCOp6.js";import{q as Be,i as se,f as Ae,P as Fe,_ as P,a as j,b as L,c as N,d as M,C as re}from"./SelectValue.vue_vue_type_script_setup_true_lang-BUbIyXRi.js";import{a as Ve,u as Y,b as He,_ as _e}from"./Input.vue_vue_type_script_setup_true_lang-BOumzjFB.js";import{_ as S}from"./Label.vue_vue_type_script_setup_true_lang-DAYcABOY.js";import{X as Q}from"./x-D2_7tWf5.js";import{d as q,a3 as Ee,b as $,m as r,w as t,U,f as e,r as J,c as A,p as ce,Y as Re,o as Se,e as a,Q as ae,j as C,A as Oe,C as Ue,D as ze,g as _,h as f,i as k,F as T,k as F,n as X,t as g,v as W,l as Pe,s as me}from"./app-22iUgOMO.js";import{_ as Me}from"./CardDescription.vue_vue_type_script_setup_true_lang-cEQoqlpa.js";import{_ as K}from"./index-DBWcKyvi.js";import{_ as ve,a as ge,b as le,c as H,d as he,e as R}from"./TableHeader.vue_vue_type_script_setup_true_lang-Dc4MknNd.js";import{c as fe,a as je}from"./VisuallyHidden-DcJRYhOq.js";import{u as Le}from"./useArrowNavigation-B5rxJs06.js";import{t as Ne}from"./index-DgWfViSe.js";import{I as Ke}from"./image-ihLmO3uN.js";import{F as Ge}from"./file-text-Bj1XLIkZ.js";import{E as Qe}from"./external-link-BVkbLBEW.js";import{E as be}from"./eye-CSlvRdKS.js";import{D as ye}from"./download-Ca03T6ty.js";import{_ as Xe,a as Ye,b as Je}from"./PopoverTrigger.vue_vue_type_script_setup_true_lang-CtBYfj_I.js";import{F as xe}from"./filter-DvZVTXRY.js";import{C as We}from"./calendar-D_dMKb1F.js";import{f as De,e as Te}from"./es-SykclP7y.js";import{_ as ke,a as $e,b as we}from"./index-CZpN8iz_.js";import{A as Ce}from"./arrow-right-3Ff3Vfhq.js";import{p as Ze}from"./parseISO-D9CBQlQ_.js";function et(i,p){return Be(i)?!1:Array.isArray(i)?i.some(s=>se(s,p)):se(i,p)}const[Ie,tt]=fe("CollapsibleRoot");var at=q({__name:"CollapsibleRoot",props:{defaultOpen:{type:Boolean,required:!1,default:!1},open:{type:Boolean,required:!1,default:void 0},disabled:{type:Boolean,required:!1},unmountOnHide:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:open"],setup(i,{expose:p,emit:s}){const d=i,x=Ve(d,"open",s,{defaultValue:d.defaultOpen,passive:d.open===void 0}),{disabled:c,unmountOnHide:b}=Ee(d);return tt({contentId:"",disabled:c,open:x,unmountOnHide:b,onOpenToggle:()=>{c.value||(x.value=!x.value)}}),p({open:x}),Y(),(y,D)=>(r(),$(e(te),{as:y.as,"as-child":d.asChild,"data-state":e(x)?"open":"closed","data-disabled":e(c)?"":void 0},{default:t(()=>[U(y.$slots,"default",{open:e(x)})]),_:3},8,["as","as-child","data-state","data-disabled"]))}}),lt=at,st=q({inheritAttrs:!1,__name:"CollapsibleContent",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["contentFound"],setup(i,{emit:p}){const s=i,d=p,m=Ie();m.contentId||(m.contentId=Ae(void 0,"reka-collapsible-content"));const x=J(),{forwardRef:c,currentElement:b}=Y(),y=J(0),D=J(0),V=A(()=>m.open.value),I=J(V.value),h=J();ce(()=>{var u;return[V.value,(u=x.value)==null?void 0:u.present]},async()=>{await Re();const u=b.value;if(!u)return;h.value=h.value||{transitionDuration:u.style.transitionDuration,animationName:u.style.animationName},u.style.transitionDuration="0s",u.style.animationName="none";const n=u.getBoundingClientRect();D.value=n.height,y.value=n.width,I.value||(u.style.transitionDuration=h.value.transitionDuration,u.style.animationName=h.value.animationName)},{immediate:!0});const l=A(()=>I.value&&m.open.value);return Se(()=>{requestAnimationFrame(()=>{I.value=!1})}),He(b,"beforematch",u=>{requestAnimationFrame(()=>{m.onOpenToggle(),d("contentFound")})}),(u,n)=>(r(),$(e(Fe),{ref_key:"presentRef",ref:x,present:u.forceMount||e(m).open.value,"force-mount":!0},{default:t(({present:o})=>{var w;return[a(e(te),ae(u.$attrs,{id:e(m).contentId,ref:e(c),"as-child":s.asChild,as:u.as,hidden:o?void 0:e(m).unmountOnHide.value?"":"until-found","data-state":l.value?void 0:e(m).open.value?"open":"closed","data-disabled":(w=e(m).disabled)!=null&&w.value?"":void 0,style:{"--reka-collapsible-content-height":`${D.value}px`,"--reka-collapsible-content-width":`${y.value}px`}}),{default:t(()=>[!e(m).unmountOnHide.value||o?U(u.$slots,"default",{key:0}):C("v-if",!0)]),_:2},1040,["id","as-child","as","hidden","data-state","data-disabled","style"])]}),_:3},8,["present"]))}}),ot=st,nt=q({__name:"CollapsibleTrigger",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(i){const p=i;Y();const s=Ie();return(d,m)=>{var x,c;return r(),$(e(te),{type:d.as==="button"?"button":void 0,as:d.as,"as-child":p.asChild,"aria-controls":e(s).contentId,"aria-expanded":e(s).open.value,"data-state":e(s).open.value?"open":"closed","data-disabled":(x=e(s).disabled)!=null&&x.value?"":void 0,disabled:(c=e(s).disabled)==null?void 0:c.value,onClick:e(s).onOpenToggle},{default:t(()=>[U(d.$slots,"default")]),_:3},8,["type","as","as-child","aria-controls","aria-expanded","data-state","data-disabled","disabled","onClick"])}}}),rt=nt;function it({type:i,defaultValue:p,modelValue:s}){const d=s||p;return s!==void 0||p!==void 0?Array.isArray(d)?"multiple":"single":i??"single"}function dt({type:i,defaultValue:p,modelValue:s}){return i||it({type:i,defaultValue:p,modelValue:s})}function ut({type:i,defaultValue:p}){return p!==void 0?p:i==="single"?void 0:[]}function ct(i,p){const s=A(()=>dt(i)),d=Ve(i,"modelValue",p,{defaultValue:ut(i),passive:i.modelValue===void 0,deep:!0});function m(c){if(s.value==="single")d.value=se(c,d.value)?void 0:c;else{const b=Array.isArray(d.value)?[...d.value||[]]:[d.value].filter(Boolean);if(et(b,c)){const y=b.findIndex(D=>se(D,c));b.splice(y,1)}else b.push(c);d.value=b}}const x=A(()=>s.value==="single");return{modelValue:d,changeModelValue:m,isSingle:x}}const[ne,ft]=fe("AccordionRoot");var pt=q({__name:"AccordionRoot",props:{collapsible:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},dir:{type:String,required:!1},orientation:{type:String,required:!1,default:"vertical"},unmountOnHide:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},type:{type:String,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1}},emits:["update:modelValue"],setup(i,{emit:p}){const s=i,d=p,{dir:m,disabled:x,unmountOnHide:c}=Ee(s),b=je(m),{modelValue:y,changeModelValue:D,isSingle:V}=ct(s,d),{forwardRef:I,currentElement:h}=Y();return ft({disabled:x,direction:b,orientation:s.orientation,parentElement:h,isSingle:V,collapsible:s.collapsible,modelValue:y,changeModelValue:D,unmountOnHide:c}),(l,u)=>(r(),$(e(te),{ref:e(I),"as-child":l.asChild,as:l.as},{default:t(()=>[U(l.$slots,"default",{modelValue:e(y)})]),_:3},8,["as-child","as"]))}}),_t=pt,ie=(function(i){return i.Open="open",i.Closed="closed",i})(ie||{});const[pe,mt]=fe("AccordionItem");var vt=q({__name:"AccordionItem",props:{disabled:{type:Boolean,required:!1},value:{type:String,required:!0},unmountOnHide:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(i,{expose:p}){const s=i,d=ne(),m=A(()=>d.isSingle.value?s.value===d.modelValue.value:Array.isArray(d.modelValue.value)&&d.modelValue.value.includes(s.value)),x=A(()=>d.disabled.value||s.disabled),c=A(()=>x.value?"":void 0),b=A(()=>m.value?ie.Open:ie.Closed);p({open:m,dataDisabled:c});const{currentRef:y,currentElement:D}=Y();mt({open:m,dataState:b,disabled:x,dataDisabled:c,triggerId:"",currentRef:y,currentElement:D,value:A(()=>s.value)});function V(I){var n;const h=I.target;if(Array.from(((n=d.parentElement.value)==null?void 0:n.querySelectorAll("[data-reka-collection-item]"))??[]).findIndex(o=>o===h)===-1)return null;Le(I,h,d.parentElement.value,{arrowKeyOptions:d.orientation,dir:d.direction.value,focus:!0})}return(I,h)=>(r(),$(e(lt),{"data-orientation":e(d).orientation,"data-disabled":c.value,"data-state":b.value,disabled:x.value,open:m.value,as:s.as,"as-child":s.asChild,"unmount-on-hide":e(d).unmountOnHide.value,onKeydown:Oe(V,["up","down","left","right","home","end"])},{default:t(()=>[U(I.$slots,"default",{open:m.value})]),_:3},8,["data-orientation","data-disabled","data-state","disabled","open","as","as-child","unmount-on-hide"]))}}),gt=vt,ht=q({__name:"AccordionContent",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(i){const p=i,s=ne(),d=pe();return Y(),(m,x)=>(r(),$(e(ot),{role:"region","as-child":p.asChild,as:m.as,"force-mount":p.forceMount,"aria-labelledby":e(d).triggerId,"data-state":e(d).dataState.value,"data-disabled":e(d).dataDisabled.value,"data-orientation":e(s).orientation,style:{"--reka-accordion-content-width":"var(--reka-collapsible-content-width)","--reka-accordion-content-height":"var(--reka-collapsible-content-height)"},onContentFound:x[0]||(x[0]=c=>e(s).changeModelValue(e(d).value.value))},{default:t(()=>[U(m.$slots,"default")]),_:3},8,["as-child","as","force-mount","aria-labelledby","data-state","data-disabled","data-orientation"]))}}),bt=ht,yt=q({__name:"AccordionHeader",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h3"}},setup(i){const p=i,s=ne(),d=pe();return Y(),(m,x)=>(r(),$(e(te),{as:p.as,"as-child":p.asChild,"data-orientation":e(s).orientation,"data-state":e(d).dataState.value,"data-disabled":e(d).dataDisabled.value},{default:t(()=>[U(m.$slots,"default")]),_:3},8,["as","as-child","data-orientation","data-state","data-disabled"]))}}),xt=yt,kt=q({__name:"AccordionTrigger",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(i){const p=i,s=ne(),d=pe();d.triggerId||(d.triggerId=Ae(void 0,"reka-accordion-trigger"));function m(){const x=s.isSingle.value&&d.open.value&&!s.collapsible;d.disabled.value||x||s.changeModelValue(d.value.value)}return(x,c)=>(r(),$(e(rt),{id:e(d).triggerId,ref:e(d).currentRef,"data-reka-collection-item":"",as:p.as,"as-child":p.asChild,"aria-disabled":e(d).disabled.value||void 0,"aria-expanded":e(d).open.value||!1,"data-disabled":e(d).dataDisabled.value,"data-orientation":e(s).orientation,"data-state":e(d).dataState.value,disabled:e(d).disabled.value,onClick:m},{default:t(()=>[U(x.$slots,"default")]),_:3},8,["id","as","as-child","aria-disabled","aria-expanded","data-disabled","data-orientation","data-state","disabled"]))}}),$t=kt;/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=qe("ActivityIcon",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),wt={class:"space-y-4"},Ct={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4"},At={class:"space-y-2"},Vt={class:"space-y-2"},Et={class:"space-y-2"},Mt={class:"space-y-2"},Dt={class:"space-y-2"},Tt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},It={class:"space-y-2"},qt={key:0,class:"space-y-2"},Bt={key:1,class:"space-y-2"},Ft={class:"flex items-end lg:col-span-2"},kl=q({__name:"EvidenciaFilters",props:Ue({contratos:{},evidencias:{},entregables:{},hitos:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const p=i,s=ze(i,"modelValue"),d=(h=null)=>{let l=p.evidencias;return h!=="contrato"&&s.value.contrato_id&&(l=l.filter(u=>u.contrato_id===s.value.contrato_id)),h!=="tipo"&&s.value.tipo&&(l=l.filter(u=>u.tipo_evidencia===s.value.tipo)),h!=="estado"&&s.value.estado&&(l=l.filter(u=>u.estado===s.value.estado)),h!=="usuario"&&s.value.usuario_id&&(l=l.filter(u=>{var n;return((n=u.usuario)==null?void 0:n.id)===s.value.usuario_id})),h!=="hito"&&s.value.hito_id&&(l=l.filter(u=>!u.entregables||u.entregables.length===0?!1:u.entregables.some(n=>n.hito_id===s.value.hito_id))),h!=="entregable"&&s.value.entregable_id&&(l=l.filter(u=>!u.entregables||u.entregables.length===0?!1:u.entregables.some(n=>n.id===s.value.entregable_id))),(s.value.fecha_inicio||s.value.fecha_fin)&&(l=l.filter(u=>{const n=new Date(u.created_at);if(s.value.fecha_inicio){const o=new Date(s.value.fecha_inicio);if(n<o)return!1}if(s.value.fecha_fin){const o=new Date(s.value.fecha_fin);if(o.setHours(23,59,59,999),n>o)return!1}return!0})),l},m=A(()=>{const h=d("contrato"),l=new Set(h.map(u=>u.contrato_id));return p.contratos.filter(u=>l.has(u.id))}),x=A(()=>{const h=d("tipo"),l=new Set(h.map(u=>u.tipo_evidencia).filter(Boolean));return Array.from(l).map(u=>({value:u,label:u}))}),c=A(()=>{const h=d("estado"),l=new Set(h.map(u=>u.estado).filter(Boolean));return Array.from(l).map(u=>({value:u,label:u.charAt(0).toUpperCase()+u.slice(1)}))}),b=A(()=>{const h=d("usuario"),l=new Map;return h.forEach(u=>{var n;(n=u.usuario)!=null&&n.id&&l.set(u.usuario.id,u.usuario)}),Array.from(l.values()).map(u=>({value:u.id,label:u.name}))}),y=A(()=>{const h=d("hito"),l=new Set;if(h.forEach(n=>{n.entregables&&n.entregables.length>0&&n.entregables.forEach(o=>{o!=null&&o.hito_id&&l.add(o.hito_id)})}),p.hitos&&p.hitos.length>0)return p.hitos.filter(n=>l.has(n.id)).map(n=>({value:n.id,label:n.nombre}));const u=new Map;return h.forEach(n=>{n.entregables&&n.entregables.length>0&&n.entregables.forEach(o=>{var w;(w=o==null?void 0:o.hito)!=null&&w.id&&u.set(o.hito.id,o.hito)})}),Array.from(u.values()).map(n=>({value:n.id,label:n.nombre}))}),D=A(()=>{const h=d("entregable"),l=new Set;h.forEach(n=>{n.entregables&&n.entregables.length>0&&n.entregables.forEach(o=>{o!=null&&o.id&&l.add(o.id)})});let u=[];if(p.entregables&&p.entregables.length>0)u=p.entregables;else{const n=new Map;p.evidencias.forEach(o=>{o.entregables&&o.entregables.length>0&&o.entregables.forEach(w=>{w!=null&&w.id&&n.set(w.id,w)})}),u=Array.from(n.values())}return s.value.hito_id&&(u=u.filter(n=>n.hito_id===s.value.hito_id)),u=u.filter(n=>l.has(n.id)),u.map(n=>({value:n.id,label:n.nombre}))}),V=()=>{s.value={contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null,hito_id:null,entregable_id:null}},I=A(()=>Object.values(s.value).some(h=>h!==null&&h!==""));return ce(()=>s.value.hito_id,()=>{s.value.entregable_id=null}),(h,l)=>(r(),$(e(Z),null,{default:t(()=>[a(e(ee),{class:"p-4"},{default:t(()=>{var u,n;return[_("div",wt,[_("div",Ct,[_("div",At,[a(e(S),{for:"filter-contrato",class:"text-xs"},{default:t(()=>[...l[8]||(l[8]=[f("Contrato",-1)])]),_:1}),a(e(P),{modelValue:s.value.contrato_id,"onUpdate:modelValue":l[0]||(l[0]=o=>s.value.contrato_id=o),id:"filter-contrato"},{default:t(()=>[a(e(j),null,{default:t(()=>[a(e(L),{placeholder:"Todos los contratos"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:null},{default:t(()=>[...l[9]||(l[9]=[f("Todos los contratos",-1)])]),_:1}),(r(!0),k(T,null,F(m.value,o=>(r(),$(e(M),{key:o.id,value:o.id},{default:t(()=>[f(g(o.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_("div",Vt,[a(e(S),{for:"filter-fecha-inicio",class:"text-xs"},{default:t(()=>[...l[10]||(l[10]=[f("Fecha Desde",-1)])]),_:1}),a(e(_e),{modelValue:s.value.fecha_inicio,"onUpdate:modelValue":l[1]||(l[1]=o=>s.value.fecha_inicio=o),type:"date",id:"filter-fecha-inicio",class:"text-sm"},null,8,["modelValue"])]),_("div",Et,[a(e(S),{for:"filter-fecha-fin",class:"text-xs"},{default:t(()=>[...l[11]||(l[11]=[f("Fecha Hasta",-1)])]),_:1}),a(e(_e),{modelValue:s.value.fecha_fin,"onUpdate:modelValue":l[2]||(l[2]=o=>s.value.fecha_fin=o),type:"date",id:"filter-fecha-fin",class:"text-sm"},null,8,["modelValue"])]),_("div",Mt,[a(e(S),{for:"filter-tipo",class:"text-xs"},{default:t(()=>[...l[12]||(l[12]=[f("Tipo",-1)])]),_:1}),a(e(P),{modelValue:s.value.tipo,"onUpdate:modelValue":l[3]||(l[3]=o=>s.value.tipo=o),id:"filter-tipo"},{default:t(()=>[a(e(j),null,{default:t(()=>[a(e(L),{placeholder:"Todos los tipos"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:null},{default:t(()=>[...l[13]||(l[13]=[f("Todos los tipos",-1)])]),_:1}),(r(!0),k(T,null,F(x.value,o=>(r(),$(e(M),{key:o.value,value:o.value},{default:t(()=>[f(g(o.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_("div",Dt,[a(e(S),{for:"filter-estado",class:"text-xs"},{default:t(()=>[...l[14]||(l[14]=[f("Estado",-1)])]),_:1}),a(e(P),{modelValue:s.value.estado,"onUpdate:modelValue":l[4]||(l[4]=o=>s.value.estado=o),id:"filter-estado"},{default:t(()=>[a(e(j),null,{default:t(()=>[a(e(L),{placeholder:"Todos los estados"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:null},{default:t(()=>[...l[15]||(l[15]=[f("Todos los estados",-1)])]),_:1}),(r(!0),k(T,null,F(c.value,o=>(r(),$(e(M),{key:o.value,value:o.value},{default:t(()=>[f(g(o.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])]),_("div",Tt,[_("div",It,[a(e(S),{for:"filter-usuario",class:"text-xs"},{default:t(()=>[...l[16]||(l[16]=[f("Usuario",-1)])]),_:1}),a(e(P),{modelValue:s.value.usuario_id,"onUpdate:modelValue":l[5]||(l[5]=o=>s.value.usuario_id=o),id:"filter-usuario"},{default:t(()=>[a(e(j),null,{default:t(()=>[a(e(L),{placeholder:"Todos los usuarios"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:null},{default:t(()=>[...l[17]||(l[17]=[f("Todos los usuarios",-1)])]),_:1}),(r(!0),k(T,null,F(b.value,o=>(r(),$(e(M),{key:o.value,value:o.value},{default:t(()=>[f(g(o.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),y.value.length>0||(u=p.hitos)!=null&&u.length?(r(),k("div",qt,[a(e(S),{for:"filter-hito",class:"text-xs"},{default:t(()=>[...l[18]||(l[18]=[f("Hito",-1)])]),_:1}),a(e(P),{modelValue:s.value.hito_id,"onUpdate:modelValue":l[6]||(l[6]=o=>s.value.hito_id=o),id:"filter-hito"},{default:t(()=>[a(e(j),null,{default:t(()=>[a(e(L),{placeholder:"Todos los hitos"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:null},{default:t(()=>[...l[19]||(l[19]=[f("Todos los hitos",-1)])]),_:1}),(r(!0),k(T,null,F(y.value,o=>(r(),$(e(M),{key:o.value,value:o.value},{default:t(()=>[f(g(o.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])):C("",!0),y.value.length>0||(n=p.hitos)!=null&&n.length?(r(),k("div",Bt,[a(e(S),{for:"filter-entregable",class:"text-xs"},{default:t(()=>[...l[20]||(l[20]=[f("Entregable",-1)])]),_:1}),a(e(P),{modelValue:s.value.entregable_id,"onUpdate:modelValue":l[7]||(l[7]=o=>s.value.entregable_id=o),id:"filter-entregable",disabled:!s.value.hito_id},{default:t(()=>[a(e(j),{class:X({"opacity-60":!s.value.hito_id})},{default:t(()=>[a(e(L),{placeholder:s.value.hito_id?"Todos los entregables":"Elige primero un hito"},null,8,["placeholder"])]),_:1},8,["class"]),s.value.hito_id?(r(),$(e(N),{key:0},{default:t(()=>[a(e(M),{value:null},{default:t(()=>[...l[21]||(l[21]=[f("Todos los entregables",-1)])]),_:1}),(r(!0),k(T,null,F(D.value,o=>(r(),$(e(M),{key:o.value,value:o.value},{default:t(()=>[f(g(o.label),1)]),_:2},1032,["value"]))),128))]),_:1})):C("",!0)]),_:1},8,["modelValue","disabled"])])):C("",!0),_("div",Ft,[I.value?(r(),$(e(O),{key:0,variant:"outline",size:"sm",onClick:V,class:"w-full md:w-auto"},{default:t(()=>[a(e(Q),{class:"h-4 w-4 mr-2"}),l[22]||(l[22]=f(" Limpiar Filtros ",-1))]),_:1})):C("",!0)])])])]}),_:1})]),_:1}))}}),Ht=q({__name:"Accordion",props:{collapsible:{type:Boolean},disabled:{type:Boolean},dir:{},orientation:{},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{},type:{},modelValue:{},defaultValue:{},class:{}},setup(i){const p=i;return(s,d)=>(r(),$(e(_t),ae(p,{class:e(oe)("w-full",p.class)}),{default:t(()=>[U(s.$slots,"default")]),_:3},16,["class"]))}}),Rt=q({__name:"AccordionItem",props:{disabled:{type:Boolean},value:{},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(i){const p=i;return(s,d)=>(r(),$(e(gt),ae(p,{class:e(oe)("border-b",p.class)}),{default:t(()=>[U(s.$slots,"default")]),_:3},16,["class"]))}}),St=q({__name:"AccordionTrigger",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const p=i;return(s,d)=>(r(),$(e(xt),{class:"flex"},{default:t(()=>[a(e($t),ae(p,{class:e(oe)("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",p.class)}),{default:t(()=>[U(s.$slots,"default"),a(e(re),{class:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]),_:3},16,["class"])]),_:3}))}}),Ot={class:"pb-4 pt-0"},Ut=q({__name:"AccordionContent",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(i){const p=i;return(s,d)=>(r(),$(e(bt),ae(p,{class:e(oe)("overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",p.class)}),{default:t(()=>[_("div",Ot,[U(s.$slots,"default")])]),_:3},16,["class"]))}}),zt={key:0},Pt={class:"flex items-center justify-between w-full pr-4"},jt={class:"flex items-center gap-3"},Lt={class:"text-left"},Nt={class:"font-semibold"},Kt={class:"text-sm text-gray-500"},Gt={class:"flex items-center gap-3"},Qt={class:"text-sm text-gray-600"},Xt={class:"text-sm"},Yt={class:"flex items-center justify-end gap-2"},Jt=["href"],Wt={key:1},Zt={class:"text-sm text-gray-600"},ea={key:0,class:"flex flex-wrap gap-1"},ta={key:1,class:"text-sm text-gray-500"},aa={class:"text-sm"},la={class:"flex items-center justify-end gap-2"},sa=["href"],oa={class:"text-center"},na={class:"mt-2 text-sm text-gray-600"},ra={class:"text-xs text-gray-500 mt-1"},$l=q({__name:"EvidenciasTable",props:{mode:{},evidencias:{},evidenciasAgrupadas:{},contrato:{},formatDate:{},cardTitle:{default:"Evidencias Asociadas"},cardDescription:{default:"Evidencias cargadas para esta obligación"},modo:{default:"admin"},puedeGestionarEstado:{type:Boolean,default:!1},proyectoId:{}},setup(i){const p=i,s=x=>({"bg-yellow-100 text-yellow-800":x==="pendiente","bg-green-100 text-green-800":x==="aprobada","bg-red-100 text-red-800":x==="rechazada"}),d=A(()=>p.mode==="grouped"?p.evidenciasAgrupadas&&p.evidenciasAgrupadas.length>0:p.evidencias&&p.evidencias.length>0),m=(x,c)=>{if(c===x.estado||!p.proyectoId)return;const b=p.modo==="admin"?`/admin/proyectos/${p.proyectoId}/evidencias/${x.id}/cambiar-estado`:`/miembro/mis-proyectos/${p.proyectoId}/evidencias/${x.id}/cambiar-estado`;me.post(b,{estado:c,observaciones:null},{preserveScroll:!0,onSuccess:()=>{me.reload()},onError:y=>{Ne.error("Error al cambiar el estado"),console.error(y)}})};return(x,c)=>i.mode==="grouped"&&d.value?(r(),k("div",zt,[a(e(Ht),{type:"multiple",class:"space-y-4",collapsible:""},{default:t(()=>[(r(!0),k(T,null,F(i.evidenciasAgrupadas,b=>(r(),$(e(Rt),{key:b.contrato.id,value:`contrato-${b.contrato.id}`,class:"border rounded-lg bg-card"},{default:t(()=>[a(e(St),{class:"px-4 py-3 hover:no-underline hover:bg-gray-50 dark:hover:bg-gray-800 rounded-t-lg"},{default:t(()=>[_("div",Pt,[_("div",jt,[a(e(Ge),{class:"h-5 w-5 text-gray-500"}),_("div",Lt,[_("div",Nt,g(b.contrato.nombre),1),_("div",Kt," Contrato #"+g(b.contrato.id),1)])]),_("div",Gt,[a(e(K),{variant:"secondary"},{default:t(()=>[f(g(b.evidencias.length)+" evidencia(s) ",1)]),_:2},1024),a(e(W),{href:`/admin/contratos/${b.contrato.id}`,onClick:c[0]||(c[0]=Pe(()=>{},["stop"])),class:"text-blue-600 hover:text-blue-800 flex items-center gap-1"},{default:t(()=>[c[1]||(c[1]=f(" Ver contrato ",-1)),a(e(Qe),{class:"h-3 w-3"})]),_:1},8,["href"])])])]),_:2},1024),a(e(Ut),{class:"px-4 pb-4"},{default:t(()=>[a(e(ve),null,{default:t(()=>[a(e(ge),null,{default:t(()=>[a(e(le),null,{default:t(()=>[a(e(H),null,{default:t(()=>[...c[2]||(c[2]=[f("Tipo",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[3]||(c[3]=[f("Obligación",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[4]||(c[4]=[f("Descripción",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[5]||(c[5]=[f("Usuario",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[6]||(c[6]=[f("Estado",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[7]||(c[7]=[f("Fecha",-1)])]),_:1}),a(e(H),{class:"text-right"},{default:t(()=>[...c[8]||(c[8]=[f("Acciones",-1)])]),_:1})]),_:1})]),_:1}),a(e(he),null,{default:t(()=>[(r(!0),k(T,null,F(b.evidencias,y=>(r(),$(e(le),{key:y.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},{default:t(()=>[a(e(R),null,{default:t(()=>[a(e(K),{variant:"outline"},{default:t(()=>[f(g(y.tipo_evidencia),1)]),_:2},1024)]),_:2},1024),a(e(R),null,{default:t(()=>[f(g(y.obligacion_titulo),1)]),_:2},1024),a(e(R),null,{default:t(()=>[_("span",Qt,g(y.descripcion||"-"),1)]),_:2},1024),a(e(R),null,{default:t(()=>{var D;return[_("span",Xt,g(((D=y.usuario)==null?void 0:D.name)||"-"),1)]}),_:2},1024),a(e(R),null,{default:t(()=>[a(e(K),{class:X(s(y.estado))},{default:t(()=>[f(g(y.estado),1)]),_:2},1032,["class"])]),_:2},1024),a(e(R),null,{default:t(()=>[f(g(i.formatDate(y.created_at)),1)]),_:2},1024),a(e(R),{class:"text-right"},{default:t(()=>[_("div",Yt,[a(e(O),{variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:t(()=>[a(e(W),{href:`/admin/contratos/${b.contrato.id}/evidencias/${y.id}`},{default:t(()=>[a(e(be),{class:"h-4 w-4"}),c[9]||(c[9]=_("span",{class:"ml-1"},"Ver",-1))]),_:1},8,["href"])]),_:2},1024),y.archivo_url?(r(),$(e(O),{key:0,variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:t(()=>[_("a",{href:y.archivo_url,target:"_blank"},[a(e(ye),{class:"h-4 w-4"}),c[10]||(c[10]=_("span",{class:"ml-1"},"Descargar",-1))],8,Jt)]),_:2},1024)):C("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})])):i.mode==="simple"&&d.value?(r(),k("div",Wt,[a(e(Z),null,{default:t(()=>[a(e(de),null,{default:t(()=>[a(e(ue),null,{default:t(()=>[f(g(i.cardTitle),1)]),_:1}),a(e(Me),null,{default:t(()=>[f(g(i.cardDescription),1)]),_:1})]),_:1}),a(e(ee),null,{default:t(()=>[a(e(ve),null,{default:t(()=>[a(e(ge),null,{default:t(()=>[a(e(le),null,{default:t(()=>[a(e(H),null,{default:t(()=>[...c[11]||(c[11]=[f("Tipo",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[12]||(c[12]=[f("Descripción",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[13]||(c[13]=[f("Entregable",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[14]||(c[14]=[f("Usuario",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[15]||(c[15]=[f("Estado",-1)])]),_:1}),a(e(H),null,{default:t(()=>[...c[16]||(c[16]=[f("Fecha",-1)])]),_:1}),a(e(H),{class:"text-right"},{default:t(()=>[...c[17]||(c[17]=[f("Acciones",-1)])]),_:1})]),_:1})]),_:1}),a(e(he),null,{default:t(()=>[(r(!0),k(T,null,F(i.evidencias,b=>(r(),$(e(le),{key:b.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},{default:t(()=>[a(e(R),null,{default:t(()=>[a(e(K),{variant:"outline"},{default:t(()=>[f(g(b.tipo_evidencia),1)]),_:2},1024)]),_:2},1024),a(e(R),null,{default:t(()=>[_("span",Zt,g(b.descripcion||"-"),1)]),_:2},1024),a(e(R),null,{default:t(()=>[b.entregables&&b.entregables.length>0?(r(),k("div",ea,[(r(!0),k(T,null,F(b.entregables,y=>(r(),$(e(K),{key:y.id,variant:"secondary",class:"text-xs"},{default:t(()=>[f(g(y.nombre),1)]),_:2},1024))),128))])):(r(),k("span",ta,"-"))]),_:2},1024),a(e(R),null,{default:t(()=>{var y;return[_("span",aa,g(((y=b.usuario)==null?void 0:y.name)||"-"),1)]}),_:2},1024),a(e(R),null,{default:t(()=>[a(e(K),{class:X(s(b.estado))},{default:t(()=>[f(g(b.estado),1)]),_:2},1032,["class"])]),_:2},1024),a(e(R),null,{default:t(()=>[f(g(i.formatDate(b.created_at)),1)]),_:2},1024),a(e(R),{class:"text-right"},{default:t(()=>[_("div",la,[a(e(O),{variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:t(()=>{var y;return[a(e(W),{href:`/admin/contratos/${(y=i.contrato)==null?void 0:y.id}/evidencias/${b.id}`},{default:t(()=>[a(e(be),{class:"h-4 w-4"}),c[18]||(c[18]=_("span",{class:"ml-1"},"Ver",-1))]),_:1},8,["href"])]}),_:2},1024),b.archivo_url?(r(),$(e(O),{key:0,variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:t(()=>[_("a",{href:b.archivo_url,target:"_blank"},[a(e(ye),{class:"h-4 w-4"}),c[19]||(c[19]=_("span",{class:"ml-1"},"Descargar",-1))],8,sa)]),_:2},1024)):C("",!0),i.modo==="admin"&&i.proyectoId||i.modo==="user"&&i.puedeGestionarEstado&&i.proyectoId?(r(),$(e(P),{key:1,"model-value":b.estado,"onUpdate:modelValue":y=>m(b,y)},{default:t(()=>[a(e(j),{class:"h-8 w-32"},{default:t(()=>[a(e(L))]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:"pendiente"},{default:t(()=>[...c[20]||(c[20]=[_("span",{class:"text-yellow-600"},"Pendiente",-1)])]),_:1}),a(e(M),{value:"aprobada"},{default:t(()=>[...c[21]||(c[21]=[_("span",{class:"text-green-600"},"Aprobada",-1)])]),_:1}),a(e(M),{value:"rechazada"},{default:t(()=>[...c[22]||(c[22]=[_("span",{class:"text-red-600"},"Rechazada",-1)])]),_:1})]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])):C("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})])):d.value?C("",!0):(r(),$(e(Z),{key:2},{default:t(()=>[a(e(ee),{class:"py-8"},{default:t(()=>[_("div",oa,[a(e(Ke),{class:"mx-auto h-12 w-12 text-gray-400"}),_("p",na,g(i.mode==="grouped"?"No hay evidencias que coincidan con los filtros":"No hay evidencias asociadas"),1),_("p",ra,g(i.mode==="grouped"?"Intenta ajustar los criterios de búsqueda":"Las evidencias se cargan desde los contratos"),1)])]),_:1})]),_:1}))}}),ia={class:"flex items-center justify-between"},da={class:"flex items-center gap-2"},ua={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ca={key:0,class:"space-y-2"},fa={class:"flex gap-2"},pa={key:1,class:"space-y-2"},_a={class:"flex gap-2"},ma={class:"space-y-2"},va={class:"flex gap-2"},ga={class:"space-y-2"},ha={class:"flex gap-2"},ba={key:0,class:"text-sm"},ya={key:1,class:"text-muted-foreground"},xa={class:"p-3 space-y-2"},ka=["value"],$a=["value"],wa={key:1,class:"space-y-4"},Ca={class:"flex items-center justify-between"},Aa={class:"flex items-center gap-2"},wl=q({__name:"ActivityFilters",props:{modelValue:{},usuarios:{default:()=>[]},contextLevel:{default:"proyecto"},showCard:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(i,{emit:p}){const s=i,d=p,m=A({get:()=>s.modelValue,set:h=>d("update:modelValue",h)}),x=A(()=>{const h=[];return s.contextLevel==="proyecto"?h.push({value:"Modules\\Proyectos\\Models\\Proyecto",label:"Proyecto"},{value:"Modules\\Proyectos\\Models\\Hito",label:"Hito"},{value:"Modules\\Proyectos\\Models\\Entregable",label:"Entregable"}):s.contextLevel==="hito"?h.push({value:"Modules\\Proyectos\\Models\\Hito",label:"Hito"},{value:"Modules\\Proyectos\\Models\\Entregable",label:"Entregable"}):h.push({value:"Modules\\Proyectos\\Models\\Entregable",label:"Entregable"}),h}),c=[{value:"created",label:"Creado"},{value:"updated",label:"Actualizado"},{value:"deleted",label:"Eliminado"},{value:"restored",label:"Restaurado"},{value:"custom",label:"Acción personalizada"}],b=(h,l)=>{m.value={...m.value,[h]:l}},y=h=>{b(h,null)},D=()=>{m.value={usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null}},V=A(()=>Object.values(m.value).some(h=>h!=null)),I=h=>{if(!h)return"";try{return De(new Date(h),"d 'de' MMM yyyy",{locale:Te})}catch{return h}};return(h,l)=>i.showCard?(r(),$(e(Z),{key:0},{default:t(()=>[a(e(de),{class:"pb-3"},{default:t(()=>[_("div",ia,[_("div",da,[a(e(xe),{class:"h-4 w-4"}),a(e(ue),{class:"text-base"},{default:t(()=>[...l[9]||(l[9]=[f("Filtros de Actividad",-1)])]),_:1})]),V.value?(r(),$(e(O),{key:0,variant:"ghost",size:"sm",onClick:D},{default:t(()=>[a(e(Q),{class:"h-4 w-4 mr-1"}),l[10]||(l[10]=f(" Limpiar ",-1))]),_:1})):C("",!0)])]),_:1}),a(e(ee),null,{default:t(()=>{var u;return[_("div",ua,[i.usuarios.length>0?(r(),k("div",ca,[a(e(S),{for:"usuario"},{default:t(()=>[...l[11]||(l[11]=[f("Usuario",-1)])]),_:1}),_("div",fa,[a(e(P),{"model-value":(u=m.value.usuario_id)==null?void 0:u.toString(),"onUpdate:modelValue":l[0]||(l[0]=n=>b("usuario_id",n?parseInt(n):null))},{default:t(()=>[a(e(j),{id:"usuario"},{default:t(()=>[a(e(L),{placeholder:"Todos los usuarios"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:"null"},{default:t(()=>[...l[12]||(l[12]=[f("Todos los usuarios",-1)])]),_:1}),(r(!0),k(T,null,F(i.usuarios,n=>(r(),$(e(M),{key:n.id,value:n.id.toString()},{default:t(()=>[f(g(n.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"]),m.value.usuario_id?(r(),$(e(O),{key:0,variant:"ghost",size:"icon",onClick:l[1]||(l[1]=n=>y("usuario_id"))},{default:t(()=>[a(e(Q),{class:"h-4 w-4"})]),_:1})):C("",!0)])])):C("",!0),x.value.length>1?(r(),k("div",pa,[a(e(S),{for:"tipo-entidad"},{default:t(()=>[...l[13]||(l[13]=[f("Tipo de Entidad",-1)])]),_:1}),_("div",_a,[a(e(P),{"model-value":m.value.tipo_entidad||"null","onUpdate:modelValue":l[2]||(l[2]=n=>b("tipo_entidad",n==="null"?null:n))},{default:t(()=>[a(e(j),{id:"tipo-entidad"},{default:t(()=>[a(e(L),{placeholder:"Todas las entidades"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:"null"},{default:t(()=>[...l[14]||(l[14]=[f("Todas las entidades",-1)])]),_:1}),(r(!0),k(T,null,F(x.value,n=>(r(),$(e(M),{key:n.value,value:n.value},{default:t(()=>[f(g(n.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"]),m.value.tipo_entidad?(r(),$(e(O),{key:0,variant:"ghost",size:"icon",onClick:l[3]||(l[3]=n=>y("tipo_entidad"))},{default:t(()=>[a(e(Q),{class:"h-4 w-4"})]),_:1})):C("",!0)])])):C("",!0),_("div",ma,[a(e(S),{for:"tipo-accion"},{default:t(()=>[...l[15]||(l[15]=[f("Tipo de Acción",-1)])]),_:1}),_("div",va,[a(e(P),{"model-value":m.value.tipo_accion||"null","onUpdate:modelValue":l[4]||(l[4]=n=>b("tipo_accion",n==="null"?null:n))},{default:t(()=>[a(e(j),{id:"tipo-accion"},{default:t(()=>[a(e(L),{placeholder:"Todas las acciones"})]),_:1}),a(e(N),null,{default:t(()=>[a(e(M),{value:"null"},{default:t(()=>[...l[16]||(l[16]=[f("Todas las acciones",-1)])]),_:1}),(r(),k(T,null,F(c,n=>a(e(M),{key:n.value,value:n.value},{default:t(()=>[f(g(n.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value"]),m.value.tipo_accion?(r(),$(e(O),{key:0,variant:"ghost",size:"icon",onClick:l[5]||(l[5]=n=>y("tipo_accion"))},{default:t(()=>[a(e(Q),{class:"h-4 w-4"})]),_:1})):C("",!0)])]),_("div",ga,[a(e(S),null,{default:t(()=>[...l[17]||(l[17]=[f("Rango de Fechas",-1)])]),_:1}),_("div",ha,[a(e(Xe),null,{default:t(()=>[a(e(Ye),{"as-child":""},{default:t(()=>[a(e(O),{variant:"outline",class:"w-full justify-start text-left font-normal"},{default:t(()=>[a(e(We),{class:"mr-2 h-4 w-4"}),m.value.fecha_inicio||m.value.fecha_fin?(r(),k("span",ba,g(m.value.fecha_inicio?I(m.value.fecha_inicio):"...")+" - "+g(m.value.fecha_fin?I(m.value.fecha_fin):"..."),1)):(r(),k("span",ya,"Seleccionar rango"))]),_:1})]),_:1}),a(e(Je),{class:"w-auto p-0",align:"start"},{default:t(()=>[_("div",xa,[_("div",null,[a(e(S),{class:"text-xs"},{default:t(()=>[...l[18]||(l[18]=[f("Desde",-1)])]),_:1}),_("input",{type:"date",value:m.value.fecha_inicio||"",onInput:l[6]||(l[6]=n=>b("fecha_inicio",n.target.value)),class:"w-full mt-1 px-3 py-2 border rounded-md text-sm"},null,40,ka)]),_("div",null,[a(e(S),{class:"text-xs"},{default:t(()=>[...l[19]||(l[19]=[f("Hasta",-1)])]),_:1}),_("input",{type:"date",value:m.value.fecha_fin||"",onInput:l[7]||(l[7]=n=>b("fecha_fin",n.target.value)),class:"w-full mt-1 px-3 py-2 border rounded-md text-sm"},null,40,$a)])])]),_:1})]),_:1}),m.value.fecha_inicio||m.value.fecha_fin?(r(),$(e(O),{key:0,variant:"ghost",size:"icon",onClick:l[8]||(l[8]=n=>{y("fecha_inicio"),y("fecha_fin")})},{default:t(()=>[a(e(Q),{class:"h-4 w-4"})]),_:1})):C("",!0)])])])]}),_:1})]),_:1})):(r(),k("div",wa,[_("div",Ca,[_("div",Aa,[a(e(xe),{class:"h-4 w-4"}),l[20]||(l[20]=_("h3",{class:"text-sm font-medium"},"Filtros",-1))]),V.value?(r(),$(e(O),{key:0,variant:"ghost",size:"sm",onClick:D},{default:t(()=>[a(e(Q),{class:"h-4 w-4 mr-1"}),l[21]||(l[21]=f(" Limpiar ",-1))]),_:1})):C("",!0)]),l[22]||(l[22]=_("div",{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},null,-1))]))}}),Va={class:"flex items-center justify-between"},Ea={key:0,class:"text-xs text-muted-foreground"},Ma={key:0,class:"space-y-4"},Da={class:"flex-1 min-w-0"},Ta={class:"text-sm"},Ia={key:0,class:"inline-flex items-center gap-1.5 mt-1.5 flex-wrap"},qa={class:"flex items-center gap-2 mt-1"},Ba={class:"text-xs text-muted-foreground"},Fa={key:0,class:"text-xs text-muted-foreground"},Ha={key:0,class:"pt-2 text-center"},Ra={key:1,class:"text-center py-8"},Sa={class:"text-sm text-muted-foreground"},Oa={key:1},Ua={key:0,class:"space-y-4"},za={class:"flex-1 min-w-0"},Pa={class:"text-sm"},ja={key:0,class:"inline-flex items-center gap-1.5 mt-1.5 flex-wrap"},La={class:"flex items-center gap-2 mt-1"},Na={class:"text-xs text-muted-foreground"},Ka={key:0,class:"text-xs text-muted-foreground"},Ga={key:0,class:"pt-2 text-center"},Qa={key:1,class:"text-center py-8"},Xa={class:"text-sm text-muted-foreground"},Cl=q({__name:"ActivityLog",props:{activities:{},title:{default:"Historial de Actividad"},description:{default:"Registro completo de cambios y eventos"},emptyMessage:{default:"No hay actividad registrada"},showCard:{type:Boolean,default:!0},perPage:{default:20}},setup(i){const p=i,s=J(1),d=A(()=>{const w=s.value*p.perPage;return p.activities.slice(0,w)}),m=A(()=>d.value.length<p.activities.length),x=A(()=>p.activities.length),c=()=>{s.value++};ce(()=>p.activities,()=>{s.value=1},{deep:!0});const b=o=>{try{const w=Ze(o),z=new Date().getTime()-w.getTime(),B=Math.floor(z/6e4),E=Math.floor(z/36e5),G=Math.floor(z/864e5);return B<1?"Hace un momento":B<60?`Hace ${B} ${B===1?"minuto":"minutos"}`:E<24?`Hace ${E} ${E===1?"hora":"horas"}`:G<7?`Hace ${G} ${G===1?"día":"días"}`:De(w,"d 'de' MMMM 'de' yyyy 'a las' HH:mm",{locale:Te})}catch{return o}},y=o=>o?o.split(" ").map(w=>w[0]).join("").toUpperCase().slice(0,2):"SI",D=o=>{if(!o)return"";const w=o.split("\\");return w[w.length-1]},V=o=>{const w=o.description||"",v=o.properties;if(v!=null&&v.entidad_url&&(v!=null&&v.entidad_nombre)&&(v!=null&&v.entidad_tipo)){const z=new RegExp(`(.*)(en ${v.entidad_tipo} ')([^']+)('.*)`),B=w.match(z);if(B)return{before:B[1]+`en ${v.entidad_tipo} '`,linkText:B[3],linkUrl:v.entidad_url,after:B[4]}}return{text:w}},I=o=>{var w,v;return o.event==="state_changed"&&((w=o.properties)==null?void 0:w.old_value)&&((v=o.properties)==null?void 0:v.new_value)},h={planificacion:"Planificación",en_progreso:"En Progreso",pausado:"Pausado",completado:"Completado",cancelado:"Cancelado",pendiente:"Pendiente",aprobada:"Aprobada",rechazada:"Rechazada"},l={pendiente:"gray",planificacion:"blue",en_progreso:"yellow",pausado:"orange",completado:"green",cancelado:"red",aprobada:"green",rechazada:"red"},u=o=>h[o]||o,n=o=>{const w=l[o]||"gray",v={green:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",red:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",yellow:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",blue:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",gray:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400",orange:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400"};return v[w]||v.gray};return(o,w)=>i.showCard?(r(),$(e(Z),{key:0},{default:t(()=>[a(e(de),null,{default:t(()=>[_("div",Va,[_("div",null,[a(e(ue),null,{default:t(()=>[f(g(i.title),1)]),_:1}),a(e(Me),null,{default:t(()=>[f(g(i.description),1)]),_:1})]),x.value>0?(r(),k("span",Ea,g(d.value.length)+" de "+g(x.value),1)):C("",!0)])]),_:1}),a(e(ee),null,{default:t(()=>[i.activities&&i.activities.length>0?(r(),k("div",Ma,[(r(!0),k(T,null,F(d.value,v=>{var z,B;return r(),k("div",{key:v.id,class:"flex gap-3 pb-4 border-b last:border-0 dark:border-gray-700"},[a(e(ke),{class:"h-8 w-8 flex-shrink-0"},{default:t(()=>{var E;return[(E=v.causer)!=null&&E.avatar?(r(),$(e($e),{key:0,src:v.causer.avatar},null,8,["src"])):C("",!0),a(e(we),null,{default:t(()=>{var G;return[f(g(y(((G=v.causer)==null?void 0:G.name)||"Sistema")),1)]}),_:2},1024)]}),_:2},1024),_("div",Da,[_("p",Ta,[V(v).linkUrl?(r(),k(T,{key:0},[_("span",null,g(V(v).before),1),a(e(W),{href:V(v).linkUrl,class:"font-medium text-primary hover:underline"},{default:t(()=>[f(g(V(v).linkText),1)]),_:2},1032,["href"]),_("span",null,g(V(v).after),1)],64)):(r(),k(T,{key:1},[f(g(v.description),1)],64))]),I(v)?(r(),k("div",Ia,[a(e(K),{variant:"outline",class:X(["text-xs h-5 font-normal",n((z=v.properties)==null?void 0:z.old_value)])},{default:t(()=>{var E;return[f(g(u((E=v.properties)==null?void 0:E.old_value)),1)]}),_:2},1032,["class"]),a(e(Ce),{class:"h-3 w-3 text-muted-foreground flex-shrink-0"}),a(e(K),{variant:"outline",class:X(["text-xs h-5 font-medium",n((B=v.properties)==null?void 0:B.new_value)])},{default:t(()=>{var E;return[f(g(u((E=v.properties)==null?void 0:E.new_value)),1)]}),_:2},1032,["class"])])):C("",!0),_("div",qa,[_("p",Ba,g(b(v.created_at)),1),v.subject_type?(r(),k("span",Fa," • "+g(D(v.subject_type)),1)):C("",!0)])])])}),128)),m.value?(r(),k("div",Ha,[a(e(O),{variant:"ghost",size:"sm",onClick:c,class:"text-muted-foreground"},{default:t(()=>[a(e(re),{class:"h-4 w-4 mr-1"}),f(" Cargar más ("+g(x.value-d.value.length)+" restantes) ",1)]),_:1})])):C("",!0)])):(r(),k("div",Ra,[_("p",Sa,g(i.emptyMessage),1)]))]),_:1})]),_:1})):(r(),k("div",Oa,[i.activities&&i.activities.length>0?(r(),k("div",Ua,[(r(!0),k(T,null,F(d.value,v=>{var z,B;return r(),k("div",{key:v.id,class:"flex gap-3 pb-4 border-b last:border-0 dark:border-gray-700"},[a(e(ke),{class:"h-8 w-8 flex-shrink-0"},{default:t(()=>{var E;return[(E=v.causer)!=null&&E.avatar?(r(),$(e($e),{key:0,src:v.causer.avatar},null,8,["src"])):C("",!0),a(e(we),null,{default:t(()=>{var G;return[f(g(y(((G=v.causer)==null?void 0:G.name)||"Sistema")),1)]}),_:2},1024)]}),_:2},1024),_("div",za,[_("p",Pa,[V(v).linkUrl?(r(),k(T,{key:0},[_("span",null,g(V(v).before),1),a(e(W),{href:V(v).linkUrl,class:"font-medium text-primary hover:underline"},{default:t(()=>[f(g(V(v).linkText),1)]),_:2},1032,["href"]),_("span",null,g(V(v).after),1)],64)):(r(),k(T,{key:1},[f(g(v.description),1)],64))]),I(v)?(r(),k("div",ja,[a(e(K),{variant:"outline",class:X(["text-xs h-5 font-normal",n((z=v.properties)==null?void 0:z.old_value)])},{default:t(()=>{var E;return[f(g(u((E=v.properties)==null?void 0:E.old_value)),1)]}),_:2},1032,["class"]),a(e(Ce),{class:"h-3 w-3 text-muted-foreground flex-shrink-0"}),a(e(K),{variant:"outline",class:X(["text-xs h-5 font-medium",n((B=v.properties)==null?void 0:B.new_value)])},{default:t(()=>{var E;return[f(g(u((E=v.properties)==null?void 0:E.new_value)),1)]}),_:2},1032,["class"])])):C("",!0),_("div",La,[_("p",Na,g(b(v.created_at)),1),v.subject_type?(r(),k("span",Ka," • "+g(D(v.subject_type)),1)):C("",!0)])])])}),128)),m.value?(r(),k("div",Ga,[a(e(O),{variant:"ghost",size:"sm",onClick:c,class:"text-muted-foreground"},{default:t(()=>[a(e(re),{class:"h-4 w-4 mr-1"}),f(" Cargar más ("+g(x.value-d.value.length)+" restantes) ",1)]),_:1})])):C("",!0)])):(r(),k("div",Qa,[_("p",Xa,g(i.emptyMessage),1)]))]))}});export{xl as A,kl as _,$l as a,wl as b,Cl as c,Ht as d,Rt as e,St as f,Ut as g};
