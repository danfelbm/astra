import{_ as $}from"./index-Bm6-zcm0.js";import{c as Je,_ as h}from"./createLucideIcon-CdhR9dO9.js";import{a as U,b as I,c as F,_ as q}from"./CardTitle.vue_vue_type_script_setup_true_lang-0fTqTWJ6.js";import{_ as ve}from"./CardDescription.vue_vue_type_script_setup_true_lang-RpmezTum.js";import{_ as Ke,a as Ye,b as ne,c as T,d as Ze,e as j}from"./TableHeader.vue_vue_type_script_setup_true_lang-Cp_4metb.js";import{_ as ea}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-aNwyMBkG.js";import{_ as aa}from"./CsvImportWizard.vue_vue_type_script_setup_true_lang-Bg36dIPE.js";import{d as ze,r as v,o as Ee,b,e as n,w as l,f as t,u as a,g as o,j as _,h as r,t as d,i as c,F as J,k as ae,W as A,q as ta,n as M,c as sa,m as _e,p as la,a as G}from"./app-Cq1yjciB.js";import{H as de}from"./history-C0y4wBf-.js";import{F as Ve}from"./file-text-BhKliUKk.js";import{C as je}from"./circle-x-BFUUcaqk.js";import{C as ue}from"./circle-check-big-DTXmwlbz.js";import{C as ce}from"./clock-ghNiwpdg.js";import{e as ia,_ as oa,a as ra,b as na,c as da,d as ua}from"./DialogTitle.vue_vue_type_script_setup_true_lang-e8q2hI1M.js";import{_ as ge,a as be,b as ye,c as xe,d as Q}from"./SelectValue.vue_vue_type_script_setup_true_lang-DNRe4yfD.js";import{_ as ca}from"./Input.vue_vue_type_script_setup_true_lang-Djopat-c.js";import{_ as ke}from"./Checkbox.vue_vue_type_script_setup_true_lang-D9s4Y6Rx.js";import{_ as ma}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DExbpHhv.js";import{t as P}from"./index-CNOFl1x1.js";import{_ as we,a as $e}from"./index-brOmD9WI.js";import{_ as he}from"./AlertTitle.vue_vue_type_script_setup_true_lang-DwW7lMqX.js";import{_ as pa}from"./Progress.vue_vue_type_script_setup_true_lang-_GsKTrRq.js";import{A as fa}from"./arrow-left-BG8i7CiQ.js";import{S as Ce}from"./square-pen-GekBRDEd.js";import{C as va}from"./calendar-10DCyPsw.js";import{M as _a}from"./map-pin-lpBwF8Bm.js";import{U as ga}from"./users-DnAI58UF.js";import{U as ba}from"./user-plus-CecC6d9v.js";import{U as ya}from"./upload-C8NZLOqj.js";import{C as Pe}from"./chevron-left-Ckfz11bR.js";import{C as Se}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-ByoI8SMh.js";import{V as Ae}from"./vote-4dgEsZuc.js";import{L as xa}from"./loader-circle-DeRxHVZR.js";import{R as ka}from"./refresh-cw-CCZUTm0k.js";import{C as wa}from"./circle-alert-V9uGECp8.js";import{f as $a,e as ha}from"./es-BRx6Co7f.js";import"./index-b6qXbMEQ.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-BzJDFT6T.js";import"./index-2HnwpJAQ.js";import"./floating-ui.vue-CDIgi2Oy.js";import"./VisuallyHidden-DYlRSZ1-.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-CgxUf1Wh.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-eXjCEAnr.js";import"./x-Gbs0cNn3.js";import"./trash-2-CtRBpw7c.js";import"./plus-By6mYgZ2.js";import"./search-6K0ZdrtR.js";import"./filter-DsA3HfHr.js";import"./check-BmE0WgU0.js";import"./save-B4PAQEwM.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-D-5Tk0ij.js";import"./RovingFocusItem-DhyhAvPS.js";import"./utils-DXCZMETy.js";import"./Label.vue_vue_type_script_setup_true_lang-Czx3cDJk.js";import"./git-branch-NFLAmdOC.js";import"./nullish-CHIgUVhi.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C04MaYnJ.js";import"./index-mUs_VBs1.js";import"./shield-CFUAReMC.js";import"./user-Btko2wTn.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-j7MDdFgh.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-B0vpzwC6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-CMJWz7fg.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Da9QQks1.js";import"./briefcase-ByIc69UB.js";import"./megaphone-BzEtHhxV.js";import"./user-check-DhfUb5gv.js";import"./external-link-Ds9hb02A.js";import"./panel-left-BAj4wuiX.js";import"./index-C-0eZmuW.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=Je("UserMinusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Pa={class:"flex items-center gap-2"},Sa={key:0,class:"flex justify-center py-6"},Aa={key:1,class:"text-center py-6 text-muted-foreground"},za={key:2,class:"space-y-3"},Ea=["onClick"],Va={class:"flex items-center gap-3"},ja={class:"font-medium text-sm"},Ua={class:"text-xs text-muted-foreground"},Ia={class:"flex items-center gap-3"},Fa={class:"text-right text-sm"},qa={class:"text-xs text-muted-foreground mt-1"},Da={key:0},Ta={key:1},Ma={key:2},Na=ze({__name:"ImportHistory",props:{type:{},entityId:{},title:{default:"Historial de Importaciones"}},setup(te,{expose:w}){const z=te,C=v([]),x=v(!1),y=async()=>{if(z.entityId){x.value=!0;try{const k=z.type==="votacion"?`/admin/votaciones/${z.entityId}/imports/recent`:`/admin/asambleas/${z.entityId}/imports/recent`,f=await fetch(k);if(f.ok){const p=await f.json();C.value=p}}catch(k){console.error("Error loading recent imports:",k)}finally{x.value=!1}}},O=k=>{A.get(`/admin/imports/${k}`)},N=()=>{const k=z.type==="votacion"?`/admin/votaciones/${z.entityId}/imports`:`/admin/asambleas/${z.entityId}/imports`;A.get(k)},H=k=>{switch(k){case"pending":return{icon:ce,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:ce,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:ue,label:"Completada",class:"text-green-600"};case"failed":return{icon:je,label:"Fallida",class:"text-red-600"}}},E=k=>new Date(k).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return Ee(()=>{y()}),w({loadRecentImports:y}),(k,f)=>(n(),b(a(q),null,{default:l(()=>[t(a(U),null,{default:l(()=>[t(a(I),{class:"flex items-center justify-between"},{default:l(()=>[o("span",Pa,[t(a(de),{class:"h-5 w-5"}),r(" "+d(k.title),1)]),C.value.length>0?(n(),b(a(h),{key:0,variant:"outline",size:"sm",onClick:N},{default:l(()=>[...f[0]||(f[0]=[r(" Ver Todas ",-1)])]),_:1})):_("",!0)]),_:1})]),_:1}),t(a(F),null,{default:l(()=>[x.value?(n(),c("div",Sa,[...f[1]||(f[1]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):C.value.length===0?(n(),c("div",Aa,[t(a(de),{class:"mx-auto h-8 w-8 mb-2"}),f[2]||(f[2]=o("p",null,"No hay importaciones registradas",-1)),f[3]||(f[3]=o("p",{class:"text-sm"},"Las importaciones aparecerán aquí una vez que subas archivos CSV",-1))])):(n(),c("div",za,[(n(!0),c(J,null,ae(C.value,p=>(n(),c("div",{key:p.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:W=>O(p.id)},[o("div",Va,[(n(),b(ta(H(p.status).icon),{class:M(["h-4 w-4",H(p.status).class])},null,8,["class"])),o("div",null,[o("p",ja,d(p.name||p.original_filename),1),o("p",Ua,d(E(p.created_at))+" • Por "+d(p.created_by.name),1)])]),o("div",Ia,[o("div",Fa,[t(a($),{variant:"outline",class:M(H(p.status).class)},{default:l(()=>[r(d(H(p.status).label),1)]),_:2},1032,["class"]),o("p",qa,[p.status==="processing"?(n(),c("span",Da,d(p.progress_percentage)+"% ",1)):p.status==="completed"?(n(),c("span",Ta,d(p.successful_rows)+"/"+d(p.total_rows||p.successful_rows+p.failed_rows)+" registros ",1)):p.status==="failed"&&p.failed_rows>0?(n(),c("span",Ma,d(p.failed_rows)+" errores ",1)):_("",!0)])]),t(a(Ve),{class:"h-4 w-4 text-gray-400"})])],8,Ea))),128))]))]),_:1})]),_:1}))}}),Ha={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},La={class:"flex items-center justify-between"},Ra={class:"text-3xl font-bold"},Ba={class:"mt-2 flex items-center gap-2"},Qa={class:"flex gap-2"},Oa={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Wa={class:"space-y-2"},Xa={class:"flex items-center gap-2 text-sm"},Ga={class:"flex items-center gap-2 text-sm"},Ja={class:"text-sm font-medium"},Ka={class:"space-y-2"},Ya={class:"flex items-center gap-2 text-sm"},Za={class:"text-sm text-muted-foreground"},et={class:"space-y-2"},at={class:"flex items-center gap-2"},tt={class:"text-2xl font-bold"},st={class:"text-sm"},lt={class:"flex items-center justify-between"},it={key:0,class:"flex gap-2"},ot={key:0,class:"mb-4 flex gap-2"},rt={key:3,class:"flex justify-center py-8"},nt={key:0,class:"flex items-center gap-2"},dt={class:"relative"},ut={key:0,class:"absolute inset-0 flex items-center justify-center"},ct={key:0,class:"text-green-600 transition-all duration-300"},mt={key:1,class:"text-gray-400 transition-all duration-300"},pt={key:1},ft={key:0},vt={key:1},_t={class:"flex justify-end gap-2"},gt={key:5,class:"flex items-center justify-between mt-4"},bt={class:"text-sm text-muted-foreground"},yt={key:0,class:"flex items-center space-x-2"},xt={class:"text-sm"},kt={key:0,class:"flex justify-center py-8"},wt={key:1,class:"text-center py-8 text-gray-500"},$t={key:2,class:"space-y-4"},ht={class:"flex justify-between items-start"},Ct={class:"flex-1"},Pt={class:"font-semibold text-lg"},St={key:0,class:"text-sm text-gray-600 mt-1"},At={class:"flex gap-4 mt-2 text-sm text-gray-500"},zt={key:0,class:"space-y-2"},Et={class:"flex justify-between text-sm"},Vt=["href"],jt={class:"space-y-4"},Ut={class:"grid gap-4 md:grid-cols-2"},It={class:"max-h-96 overflow-y-auto border rounded-lg p-4"},Ft={key:0,class:"flex justify-center py-8"},qt={key:1},Dt=["for"],Tt={class:"text-sm font-medium"},Mt={class:"text-xs text-muted-foreground"},Nt={key:0},Ht={key:1},Lt={key:0,class:"mt-4 flex justify-center gap-2"},Rt={class:"flex items-center px-2 text-sm"},Bt={key:2,class:"text-center text-muted-foreground py-4"},Qt={class:"flex items-center justify-between w-full"},Ot={key:0,class:"text-sm text-muted-foreground"},Wt={class:"flex gap-2"},cl=ze({__name:"Show",props:{asamblea:{},puede_gestionar_participantes:{type:Boolean},filterFieldsConfig:{}},setup(te){const w=te,z=[{title:"Admin",href:"/admin/dashboard"},{title:"Asambleas",href:"/admin/asambleas"},{title:w.asamblea.nombre,href:"#"}],{route:C}=window,x=v([]),y=v({current_page:1,last_page:1,per_page:20,total:0,from:0,to:0}),O=v(!1),N=v({}),H={fields:w.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por nombre, email o documento...",quickSearchFields:["users.name","users.email","users.documento_identidad"],maxNestingLevel:1,allowSaveFilters:!1,debounceTime:500,autoApply:!1},E=v(!1),k=v([]),f=v(null),p=v([]),W=v("asistente"),L=v(""),se=v(!1),me=v(!1),R=v(null),K=v(!1),Y=v(!1),Ue=v([]),le=v(null),ie=v([]),oe=v(!1),V=v(null),S=v({}),D=v({}),Ie=i=>i?$a(new Date(i),"PPPpp",{locale:ha}):"",Fe=i=>{switch(i){case"moderador":return"bg-purple-100 text-purple-800";case"secretario":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Z=sa(()=>{const i=x.value.filter(m=>{var g;return((g=m.pivot)==null?void 0:g.tipo_participacion)==="moderador"}).length,e=x.value.filter(m=>{var g;return((g=m.pivot)==null?void 0:g.tipo_participacion)==="secretario"}).length,s=x.value.filter(m=>{var g;return((g=m.pivot)==null?void 0:g.tipo_participacion)==="asistente"}).length,u=x.value.filter(m=>{var g;return((g=m.pivot)==null?void 0:g.asistio)===!0}).length;return{moderadores:i,secretarios:e,asistentes:s,presentes:u,total:y.value.total||0}}),B=async(i=1,e={})=>{O.value=!0;try{const s={page:i,...e},u=await G.get(C("admin.asambleas.participantes-list",w.asamblea.id),{params:s});x.value=u.data.participantes.data.map(m=>({...m,pivot:{tenant_id:m.tenant_id,tipo_participacion:m.tipo_participacion||"asistente",asistio:m.asistio===1||m.asistio===!0||m.asistio==="1",hora_registro:m.hora_registro}})),y.value={current_page:u.data.participantes.current_page,last_page:u.data.participantes.last_page,per_page:u.data.participantes.per_page,total:u.data.participantes.total,from:u.data.participantes.from,to:u.data.participantes.to}}catch(s){console.error("Error cargando participantes:",s)}finally{O.value=!1}},pe=i=>{B(i,N.value)},qe=i=>{N.value=i,B(1,i)},De=()=>{N.value={},B(1,{})},ee=async(i=1)=>{se.value=!0;try{const e=await G.get(C("admin.asambleas.manage-participantes",w.asamblea.id),{params:{search:L.value,page:i}});e.data.participantes_disponibles.data?(k.value=e.data.participantes_disponibles.data,f.value={current_page:e.data.participantes_disponibles.current_page,last_page:e.data.participantes_disponibles.last_page,total:e.data.participantes_disponibles.total}):k.value=[]}catch(e){console.error("Error buscando participantes:",e),P.error("Error al buscar participantes",{description:"Por favor intenta nuevamente",duration:3e3}),k.value=[]}finally{se.value=!1}},Te=()=>{E.value=!0,me.value||(me.value=!0,ee())};let re=null;_e(L,()=>{re&&clearTimeout(re),re=setTimeout(()=>{E.value&&ee()},500)}),_e(E,i=>{i||(p.value=[],L.value="",W.value="asistente")});const Me=()=>{if(p.value.length===0)return;const i=p.value.length;A.post(C("admin.asambleas.manage-participantes",w.asamblea.id),{participante_ids:p.value,tipo_participacion:W.value},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{E.value=!1,P.success(`${i} participante(s) añadido(s) exitosamente`,{duration:2e3}),B(y.value.current_page,N.value)},onError:()=>{P.error("Error al añadir participantes",{description:"Por favor intenta nuevamente",duration:3e3})}})},Ne=i=>{const e=x.value.find(g=>g.id===i),s=(e==null?void 0:e.name)||"Participante";if(!confirm(`¿Estás seguro de remover a ${s} de la asamblea?`))return;const u=x.value.findIndex(g=>g.id===i),m=x.value[u];u!==-1&&(x.value.splice(u,1),y.value.total-=1),A.delete(C("admin.asambleas.manage-participantes",w.asamblea.id),{data:{participante_id:i},preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{P.success(`${s} removido de la asamblea`,{duration:2e3})},onError:()=>{m&&u!==-1&&(x.value.splice(u,0,m),y.value.total+=1),P.error("Error al remover participante",{duration:3e3})}})},He=(i,e)=>{var g;const s=x.value.find(X=>X.id===i),u=(s==null?void 0:s.name)||"Participante",m=(g=s==null?void 0:s.pivot)==null?void 0:g.tipo_participacion;s&&s.pivot&&(s.pivot.tipo_participacion=e),A.put(C("admin.asambleas.manage-participantes",w.asamblea.id),{participante_id:i,tipo_participacion:e},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{const X=e.charAt(0).toUpperCase()+e.slice(1);P.success(`${u} asignado como ${X}`,{duration:2e3})},onError:()=>{s&&s.pivot&&m&&(s.pivot.tipo_participacion=m),P.error("Error al actualizar el tipo de participación",{duration:3e3})}})},Le=(i,e)=>{if(R.value===i)return;R.value=i;const s=x.value.find(m=>m.id===i),u=(s==null?void 0:s.name)||"Participante";s&&s.pivot&&(s.pivot.asistio,s.pivot.asistio=e,e?s.pivot.hora_registro=new Date().toISOString():s.pivot.hora_registro=null),A.put(C("admin.asambleas.manage-participantes",w.asamblea.id),{participante_id:i,asistio:e},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{e?P.success(`${u} marcado como presente`,{duration:2e3}):P.info(`${u} marcado como ausente`,{duration:2e3})},onError:()=>{s&&s.pivot&&(s.pivot.asistio=!e,s.pivot.hora_registro=null),P.error("Error al actualizar la asistencia",{description:"Por favor intenta nuevamente",duration:3e3})},onFinish:()=>{R.value=null}})},Re=()=>{A.visit(C("admin.asambleas.edit",w.asamblea.id))},Be=()=>{A.visit(C("admin.asambleas.index"))},Qe=async()=>{var i;if((i=w.asamblea)!=null&&i.id)try{const e=await fetch(`/admin/asambleas/${w.asamblea.id}/imports/recent`);Ue.value=await e.json()}catch(e){console.error("Error cargando importaciones recientes:",e)}},Oe=i=>{K.value=!1,Qe(),B(),le.value&&le.value.loadRecentImports(),A.get(`/admin/imports/${i}`)},We=()=>{K.value=!1},fe=async()=>{oe.value=!0;try{const i=await G.get(`/admin/asambleas/${w.asamblea.id}/votaciones`);i.data.success&&(ie.value=i.data.data)}catch(i){console.error("Error cargando votaciones:",i),P.error("Error al cargar las votaciones")}finally{oe.value=!1}},Xe=async i=>{var e,s;if(!V.value){V.value=i,delete S.value[i];try{const u=await G.post(`/admin/asambleas/${w.asamblea.id}/votaciones/${i}/sync`);if(u.data.success){P.success("Sincronización iniciada");const m=u.data.job_id;Ge(i,m)}}catch(u){console.error("Error iniciando sincronización:",u),P.error(((s=(e=u.response)==null?void 0:e.data)==null?void 0:s.message)||"Error al iniciar la sincronización"),V.value=null}}},Ge=(i,e)=>{D.value[i]&&clearInterval(D.value[i]),D.value[i]=setInterval(async()=>{try{const s=await G.get(`/admin/sync-job/${e}/status`);if(s.data.success){const u=s.data.data;S.value[i]=u,(u.status==="completed"||u.status==="completed_with_errors"||u.status==="failed")&&(clearInterval(D.value[i]),delete D.value[i],V.value=null,setTimeout(()=>{fe()},2e3),setTimeout(()=>{delete S.value[i]},5e3))}}catch(s){console.error("Error obteniendo progreso:",s),clearInterval(D.value[i]),delete D.value[i],V.value=null}},2e3)};return Ee(()=>{B(),fe()}),(i,e)=>(n(),c(J,null,[t(a(la),{title:`Asamblea: ${i.asamblea.nombre}`},null,8,["title"]),t(ma,{breadcrumbs:z},{default:l(()=>[o("div",Ha,[o("div",La,[o("div",null,[o("h1",Ra,d(i.asamblea.nombre),1),o("div",Ba,[t(a($),{class:M(i.asamblea.estado_color)},{default:l(()=>[r(d(i.asamblea.estado_label),1)]),_:1},8,["class"]),t(a($),{class:M(i.asamblea.tipo==="ordinaria"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800")},{default:l(()=>[r(d(i.asamblea.tipo_label),1)]),_:1},8,["class"]),i.asamblea.activo?(n(),b(a($),{key:0,class:"bg-green-100 text-green-800"},{default:l(()=>[...e[11]||(e[11]=[r(" Activa ",-1)])]),_:1})):(n(),b(a($),{key:1,class:"bg-red-100 text-red-800"},{default:l(()=>[...e[12]||(e[12]=[r(" Inactiva ",-1)])]),_:1}))])]),o("div",Qa,[t(a(h),{variant:"outline",onClick:Be},{default:l(()=>[t(a(fa),{class:"mr-2 h-4 w-4"}),e[13]||(e[13]=r(" Volver ",-1))]),_:1}),t(a(h),{onClick:Re},{default:l(()=>[t(a(Ce),{class:"mr-2 h-4 w-4"}),e[14]||(e[14]=r(" Editar ",-1))]),_:1})])]),o("div",Oa,[t(a(q),null,{default:l(()=>[t(a(U),{class:"pb-3"},{default:l(()=>[t(a(I),{class:"text-sm font-medium"},{default:l(()=>[...e[15]||(e[15]=[r("Fechas",-1)])]),_:1})]),_:1}),t(a(F),null,{default:l(()=>[o("div",Wa,[o("div",Xa,[t(a(va),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.rango_fechas),1)]),o("div",Ga,[t(a(ce),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,"Duración: "+d(i.asamblea.duracion),1)]),o("p",Ja,d(i.asamblea.tiempo_restante),1)])]),_:1})]),_:1}),t(a(q),null,{default:l(()=>[t(a(U),{class:"pb-3"},{default:l(()=>[t(a(I),{class:"text-sm font-medium"},{default:l(()=>[...e[16]||(e[16]=[r("Ubicación",-1)])]),_:1})]),_:1}),t(a(F),null,{default:l(()=>[o("div",Ka,[o("div",Ya,[t(a(_a),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.lugar||"No especificado"),1)]),o("p",Za,d(i.asamblea.ubicacion_completa),1)])]),_:1})]),_:1}),t(a(q),null,{default:l(()=>[t(a(U),{class:"pb-3"},{default:l(()=>[t(a(I),{class:"text-sm font-medium"},{default:l(()=>[...e[17]||(e[17]=[r("Quórum",-1)])]),_:1})]),_:1}),t(a(F),null,{default:l(()=>[o("div",et,[o("div",at,[t(a(ga),{class:"h-4 w-4 text-muted-foreground"}),o("span",tt,d(i.asamblea.asistentes_count)+" / "+d(i.asamblea.quorum_minimo||"∞"),1)]),i.asamblea.alcanza_quorum?(n(),b(a($),{key:0,class:"bg-green-100 text-green-800"},{default:l(()=>[t(a(ue),{class:"mr-1 h-3 w-3"}),e[18]||(e[18]=r(" Quórum alcanzado ",-1))]),_:1})):i.asamblea.quorum_minimo?(n(),b(a($),{key:1,class:"bg-yellow-100 text-yellow-800"},{default:l(()=>[t(a(je),{class:"mr-1 h-3 w-3"}),e[19]||(e[19]=r(" Quórum no alcanzado ",-1))]),_:1})):_("",!0)])]),_:1})]),_:1})]),i.asamblea.descripcion?(n(),b(a(q),{key:0},{default:l(()=>[t(a(U),null,{default:l(()=>[t(a(I),null,{default:l(()=>[...e[20]||(e[20]=[r("Descripción",-1)])]),_:1})]),_:1}),t(a(F),null,{default:l(()=>[o("p",st,d(i.asamblea.descripcion),1)]),_:1})]),_:1})):_("",!0),t(ea,{config:H,onApply:qe,onClear:De}),t(a(q),null,{default:l(()=>[t(a(U),null,{default:l(()=>[o("div",lt,[o("div",null,[t(a(I),null,{default:l(()=>[...e[21]||(e[21]=[r("Participantes",-1)])]),_:1}),t(a(ve),null,{default:l(()=>[r(d(i.asamblea.participantes_count)+" participantes registrados ",1)]),_:1})]),x.value.length>0?(n(),c("div",it,[t(a($),{variant:"outline"},{default:l(()=>[r(" Moderadores: "+d(Z.value.moderadores),1)]),_:1}),t(a($),{variant:"outline"},{default:l(()=>[r(" Secretarios: "+d(Z.value.secretarios),1)]),_:1}),t(a($),{variant:"outline"},{default:l(()=>[r(" Asistentes: "+d(Z.value.asistentes),1)]),_:1}),t(a($),{variant:"outline"},{default:l(()=>[r(" Presentes: "+d(Z.value.presentes),1)]),_:1})])):_("",!0)])]),_:1}),t(a(F),null,{default:l(()=>[i.puede_gestionar_participantes?(n(),c("div",ot,[t(a(h),{onClick:Te},{default:l(()=>[t(a(ba),{class:"mr-2 h-4 w-4"}),e[22]||(e[22]=r(" Añadir Participantes ",-1))]),_:1}),t(a(h),{variant:"outline",onClick:e[0]||(e[0]=s=>K.value=!0)},{default:l(()=>[t(a(ya),{class:"mr-2 h-4 w-4"}),e[23]||(e[23]=r(" Importar CSV ",-1))]),_:1}),t(a(h),{variant:"outline",onClick:e[1]||(e[1]=s=>Y.value=!Y.value)},{default:l(()=>[t(a(de),{class:"mr-2 h-4 w-4"}),r(" "+d(Y.value?"Ocultar":"Ver")+" Historial ",1)]),_:1})])):_("",!0),K.value?(n(),b(aa,{key:1,mode:"asamblea","asamblea-id":i.asamblea.id,"asamblea-titulo":i.asamblea.nombre,"redirect-on-success":!0,onSuccess:Oe,onCancel:We,class:"mb-4"},null,8,["asamblea-id","asamblea-titulo"])):_("",!0),Y.value?(n(),b(Na,{key:2,ref_key:"importHistoryRef",ref:le,type:"asamblea","entity-id":i.asamblea.id,title:"Historial de Importaciones",class:"mb-4"},null,8,["entity-id"])):_("",!0),O.value?(n(),c("div",rt,[...e[24]||(e[24]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):(n(),b(a(Ke),{key:4},{default:l(()=>[t(a(Ye),null,{default:l(()=>[t(a(ne),null,{default:l(()=>[t(a(T),null,{default:l(()=>[...e[25]||(e[25]=[r("Nombre",-1)])]),_:1}),t(a(T),null,{default:l(()=>[...e[26]||(e[26]=[r("Email",-1)])]),_:1}),t(a(T),null,{default:l(()=>[...e[27]||(e[27]=[r("Tipo de Participación",-1)])]),_:1}),t(a(T),null,{default:l(()=>[...e[28]||(e[28]=[r("Asistencia",-1)])]),_:1}),t(a(T),null,{default:l(()=>[...e[29]||(e[29]=[r("Hora de Registro",-1)])]),_:1}),t(a(T),null,{default:l(()=>[...e[30]||(e[30]=[r("Registrado por",-1)])]),_:1}),i.puede_gestionar_participantes?(n(),b(a(T),{key:0,class:"text-right"},{default:l(()=>[...e[31]||(e[31]=[r("Acciones",-1)])]),_:1})):_("",!0)]),_:1})]),_:1}),t(a(Ze),null,{default:l(()=>[(n(!0),c(J,null,ae(x.value,s=>(n(),b(a(ne),{key:s.id},{default:l(()=>[t(a(j),{class:"font-medium"},{default:l(()=>[r(d(s.name),1)]),_:2},1024),t(a(j),null,{default:l(()=>[r(d(s.email),1)]),_:2},1024),t(a(j),null,{default:l(()=>{var u;return[t(a($),{class:M(Fe(((u=s.pivot)==null?void 0:u.tipo_participacion)||"asistente"))},{default:l(()=>{var m;return[r(d(((m=s.pivot)==null?void 0:m.tipo_participacion)||"asistente"),1)]}),_:2},1032,["class"])]}),_:2},1024),t(a(j),null,{default:l(()=>{var u,m,g;return[i.puede_gestionar_participantes&&i.asamblea.estado==="en_curso"?(n(),c("div",nt,[o("div",dt,[t(a(ke),{checked:((u=s.pivot)==null?void 0:u.asistio)||!1,disabled:R.value===s.id,"onUpdate:checked":X=>Le(s.id,X),class:M(R.value===s.id?"opacity-50":"")},null,8,["checked","disabled","onUpdate:checked","class"]),R.value===s.id?(n(),c("div",ut,[...e[32]||(e[32]=[o("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary"},null,-1)])])):_("",!0)]),(m=s.pivot)!=null&&m.asistio?(n(),c("span",ct," Presente ")):(n(),c("span",mt," Ausente "))])):(n(),c("div",pt,[(g=s.pivot)!=null&&g.asistio?(n(),b(a($),{key:0,class:"bg-green-100 text-green-800"},{default:l(()=>[...e[33]||(e[33]=[r(" Presente ",-1)])]),_:1})):(n(),b(a($),{key:1,variant:"outline"},{default:l(()=>[...e[34]||(e[34]=[r(" Ausente ",-1)])]),_:1}))]))]}),_:2},1024),t(a(j),null,{default:l(()=>{var u;return[r(d((u=s.pivot)!=null&&u.hora_registro?Ie(s.pivot.hora_registro):"-"),1)]}),_:2},1024),t(a(j),null,{default:l(()=>{var u;return[(u=s.pivot)!=null&&u.updated_by?(n(),c("span",ft,d(s.pivot.updated_by===s.id?"Auto-registro":s.pivot.updated_by_name||"Admin"),1)):(n(),c("span",vt,"-"))]}),_:2},1024),i.puede_gestionar_participantes?(n(),b(a(j),{key:0,class:"text-right"},{default:l(()=>{var u;return[o("div",_t,[t(a(ge),{"model-value":((u=s.pivot)==null?void 0:u.tipo_participacion)||"asistente","onUpdate:modelValue":m=>He(s.id,m)},{default:l(()=>[t(a(be),{class:"w-32"},{default:l(()=>[t(a(ye))]),_:1}),t(a(xe),null,{default:l(()=>[t(a(Q),{value:"asistente"},{default:l(()=>[...e[35]||(e[35]=[r("Asistente",-1)])]),_:1}),t(a(Q),{value:"moderador"},{default:l(()=>[...e[36]||(e[36]=[r("Moderador",-1)])]),_:1}),t(a(Q),{value:"secretario"},{default:l(()=>[...e[37]||(e[37]=[r("Secretario",-1)])]),_:1})]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"]),t(a(h),{variant:"ghost",size:"sm",onClick:m=>Ne(s.id)},{default:l(()=>[t(a(Ca),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])]}),_:2},1024)):_("",!0)]),_:2},1024))),128)),x.value.length===0?(n(),b(a(ne),{key:0},{default:l(()=>[t(a(j),{colspan:"6",class:"text-center py-8"},{default:l(()=>[...e[38]||(e[38]=[o("p",{class:"text-muted-foreground"},"No hay participantes registrados",-1)])]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})),y.value.total>0?(n(),c("div",gt,[o("div",bt," Mostrando "+d(y.value.from)+" a "+d(y.value.to)+" de "+d(y.value.total)+" resultados ",1),y.value.last_page>1?(n(),c("div",yt,[t(a(h),{variant:"outline",size:"sm",disabled:y.value.current_page===1,onClick:e[2]||(e[2]=s=>pe(y.value.current_page-1))},{default:l(()=>[t(a(Pe),{class:"h-4 w-4"}),e[39]||(e[39]=r(" Anterior ",-1))]),_:1},8,["disabled"]),o("div",xt," Página "+d(y.value.current_page)+" de "+d(y.value.last_page),1),t(a(h),{variant:"outline",size:"sm",disabled:y.value.current_page===y.value.last_page,onClick:e[3]||(e[3]=s=>pe(y.value.current_page+1))},{default:l(()=>[e[40]||(e[40]=r(" Siguiente ",-1)),t(a(Se),{class:"h-4 w-4"})]),_:1},8,["disabled"])])):_("",!0)])):_("",!0)]),_:1})]),_:1}),t(a(q),null,{default:l(()=>[t(a(U),null,{default:l(()=>[t(a(I),{class:"flex items-center gap-2"},{default:l(()=>[t(a(Ae),{class:"h-5 w-5"}),e[41]||(e[41]=r(" Votaciones Asociadas ",-1))]),_:1}),t(a(ve),null,{default:l(()=>[...e[42]||(e[42]=[r(" Votaciones vinculadas a esta asamblea y estado de sincronización de participantes ",-1)])]),_:1})]),_:1}),t(a(F),null,{default:l(()=>[oe.value?(n(),c("div",kt,[t(a(xa),{class:"h-8 w-8 animate-spin text-gray-400"})])):ie.value.length===0?(n(),c("div",wt,[t(a(Ae),{class:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e[44]||(e[44]=o("p",null,"No hay votaciones asociadas a esta asamblea",-1)),t(a(h),{variant:"outline",class:"mt-4",onClick:e[4]||(e[4]=()=>a(A).visit(`/admin/asambleas/${i.asamblea.id}/edit`))},{default:l(()=>[t(a(Ce),{class:"h-4 w-4 mr-2"}),e[43]||(e[43]=r(" Editar Asamblea para Agregar Votaciones ",-1))]),_:1})])):(n(),c("div",$t,[(n(!0),c(J,null,ae(ie.value,s=>(n(),c("div",{key:s.id,class:"border rounded-lg p-4 space-y-3"},[o("div",ht,[o("div",Ct,[o("h4",Pt,d(s.titulo),1),s.descripcion?(n(),c("p",St,d(s.descripcion),1)):_("",!0),o("div",At,[o("span",null,[e[45]||(e[45]=r("Estado: ",-1)),t(a($),{variant:s.estado==="activa"?"default":"secondary"},{default:l(()=>[r(d(s.estado),1)]),_:2},1032,["variant"])]),o("span",null,"Votantes: "+d(s.votantes_count),1),o("span",null,"Sincronizados desde asamblea: "+d(s.sincronizados_count),1)])]),s.puede_sincronizar&&i.puede_gestionar_participantes?(n(),b(a(h),{key:0,onClick:u=>Xe(s.id),disabled:V.value===s.id,variant:"outline"},{default:l(()=>[t(a(ka),{class:M(["h-4 w-4 mr-2",{"animate-spin":V.value===s.id}])},null,8,["class"]),r(" "+d(V.value===s.id?"Sincronizando...":"Sincronizar Participantes"),1)]),_:2},1032,["onClick","disabled"])):_("",!0)]),S.value[s.id]?(n(),c("div",zt,[o("div",Et,[o("span",null,d(S.value[s.id].message),1),o("span",null,d(Math.round(S.value[s.id].progress))+"%",1)]),t(a(pa),{"model-value":S.value[s.id].progress},null,8,["model-value"]),S.value[s.id].status==="completed"?(n(),b(a(we),{key:0,class:"mt-2"},{default:l(()=>[t(a(ue),{class:"h-4 w-4"}),t(a(he),null,{default:l(()=>[...e[46]||(e[46]=[r("Sincronización completada",-1)])]),_:1}),t(a($e),null,{default:l(()=>[r(d(S.value[s.id].message),1)]),_:2},1024)]),_:2},1024)):_("",!0),S.value[s.id].status==="failed"?(n(),b(a(we),{key:1,variant:"destructive",class:"mt-2"},{default:l(()=>[t(a(wa),{class:"h-4 w-4"}),t(a(he),null,{default:l(()=>[...e[47]||(e[47]=[r("Error en sincronización",-1)])]),_:1}),t(a($e),null,{default:l(()=>[r(d(S.value[s.id].message),1)]),_:2},1024)]),_:2},1024)):_("",!0)])):_("",!0)]))),128))]))]),_:1})]),_:1}),i.asamblea.acta_url?(n(),b(a(q),{key:1},{default:l(()=>[t(a(U),null,{default:l(()=>[t(a(I),null,{default:l(()=>[...e[48]||(e[48]=[r("Acta de la Asamblea",-1)])]),_:1})]),_:1}),t(a(F),null,{default:l(()=>[o("a",{href:i.asamblea.acta_url,target:"_blank",class:"flex items-center gap-2 text-blue-600 hover:underline"},[t(a(Ve),{class:"h-4 w-4"}),e[49]||(e[49]=r(" Ver Acta ",-1))],8,Vt)]),_:1})]),_:1})):_("",!0)]),t(a(ia),{open:E.value,"onUpdate:open":e[10]||(e[10]=s=>E.value=s)},{default:l(()=>[t(a(oa),{class:"max-w-2xl"},{default:l(()=>[t(a(ra),null,{default:l(()=>[t(a(na),null,{default:l(()=>[...e[50]||(e[50]=[r("Añadir Participantes",-1)])]),_:1}),t(a(da),null,{default:l(()=>[...e[51]||(e[51]=[r(" Selecciona los usuarios que deseas añadir como participantes de la asamblea ",-1)])]),_:1})]),_:1}),o("div",jt,[o("div",Ut,[o("div",null,[e[55]||(e[55]=o("label",{class:"text-sm font-medium"},"Tipo de Participación",-1)),t(a(ge),{modelValue:W.value,"onUpdate:modelValue":e[5]||(e[5]=s=>W.value=s)},{default:l(()=>[t(a(be),null,{default:l(()=>[t(a(ye))]),_:1}),t(a(xe),null,{default:l(()=>[t(a(Q),{value:"asistente"},{default:l(()=>[...e[52]||(e[52]=[r("Asistente",-1)])]),_:1}),t(a(Q),{value:"moderador"},{default:l(()=>[...e[53]||(e[53]=[r("Moderador",-1)])]),_:1}),t(a(Q),{value:"secretario"},{default:l(()=>[...e[54]||(e[54]=[r("Secretario",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",null,[e[56]||(e[56]=o("label",{class:"text-sm font-medium"},"Buscar Usuarios",-1)),t(a(ca),{modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=s=>L.value=s),placeholder:"Buscar por nombre, email, documento o teléfono...",type:"text"},null,8,["modelValue"])])]),o("div",It,[se.value?(n(),c("div",Ft,[...e[57]||(e[57]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):k.value.length>0?(n(),c("div",qt,[(n(!0),c(J,null,ae(k.value,s=>(n(),c("div",{key:s.id,class:"flex items-center space-x-2 py-2"},[t(a(ke),{id:`usuario-${s.id}`,checked:p.value.includes(s.id),"onUpdate:checked":u=>{if(u)p.value.push(s.id);else{const m=p.value.indexOf(s.id);m>-1&&p.value.splice(m,1)}}},null,8,["id","checked","onUpdate:checked"]),o("label",{for:`usuario-${s.id}`,class:"flex-1 cursor-pointer"},[o("div",Tt,d(s.name),1),o("div",Mt,[r(d(s.email)+" ",1),s.documento_identidad?(n(),c("span",Nt," • Doc: "+d(s.documento_identidad),1)):_("",!0),s.telefono?(n(),c("span",Ht," • Tel: "+d(s.telefono),1)):_("",!0)])],8,Dt)]))),128)),f.value&&f.value.last_page>1?(n(),c("div",Lt,[t(a(h),{variant:"outline",size:"sm",disabled:f.value.current_page===1,onClick:e[7]||(e[7]=s=>ee(f.value.current_page-1))},{default:l(()=>[t(a(Pe),{class:"h-4 w-4"})]),_:1},8,["disabled"]),o("span",Rt," Página "+d(f.value.current_page)+" de "+d(f.value.last_page),1),t(a(h),{variant:"outline",size:"sm",disabled:f.value.current_page===f.value.last_page,onClick:e[8]||(e[8]=s=>ee(f.value.current_page+1))},{default:l(()=>[t(a(Se),{class:"h-4 w-4"})]),_:1},8,["disabled"])])):_("",!0)])):(n(),c("p",Bt,d(L.value?"No se encontraron usuarios con esa búsqueda":"Escribe para buscar usuarios disponibles"),1))])]),t(a(ua),null,{default:l(()=>[o("div",Qt,[f.value?(n(),c("span",Ot,d(f.value.total)+" usuarios disponibles ",1)):_("",!0),o("div",Wt,[t(a(h),{variant:"outline",onClick:e[9]||(e[9]=s=>E.value=!1)},{default:l(()=>[...e[58]||(e[58]=[r(" Cancelar ",-1)])]),_:1}),t(a(h),{onClick:Me,disabled:p.value.length===0},{default:l(()=>[r(" Añadir "+d(p.value.length)+" Participante(s) ",1)]),_:1},8,["disabled"])])])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{cl as default};
