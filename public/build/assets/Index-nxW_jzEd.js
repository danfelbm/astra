import{d as U,c as I,r as H,i as m,e as o,f as t,q as G,w as a,g as r,j as D,b as g,t as c,v as z,h as u,m as d,n as h,A as O,F as C,k as A,y as R,ax as W,s as y}from"./app-b8_bfoa9.js";import{_ as X}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CeM4NcZk.js";import{_ as b,c as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-ChEDhgpu.js";import{c as Y,_ as p}from"./createLucideIcon-jMLPrHZq.js";import{_ as Z}from"./Input.vue_vue_type_script_setup_true_lang-D7NW1pkf.js";import{_ as ee}from"./index-Cl6Mk0dD.js";import{H as J}from"./HitoCard-BfpCN16x.js";import{t as _}from"./index-D0lNZ1Y3.js";import{A as te}from"./arrow-left-NLFSzuUf.js";import{P as F}from"./plus-DNQ6LeeA.js";import{S as oe}from"./search-CVNNuOcz.js";import{L as se}from"./list-s-_C_gJF.js";import{T as ae}from"./target-CjHS42D3.js";import"./useFlashMessages-Co-C9Fxp.js";import"./index-BShGxGH8.js";import"./floating-ui.vue-DHf3hBf9.js";import"./x-DygrjMee.js";import"./index-BX9ZO_bI.js";import"./shield-DhmbrWHL.js";import"./user-DNFTuXTN.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-PTnNV47i.js";import"./chevron-right-0CYeO5om.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-U4pP91Co.js";import"./VisuallyHidden-7ZQM_wZx.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-D7ECgYt-.js";import"./index-BdKmsfpb.js";import"./check-C8Dm3S8L.js";import"./Label.vue_vue_type_script_setup_true_lang-DReL3nOQ.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Bg5KjcOV.js";import"./circle-alert-BTKmsP7n.js";import"./map-pin-DEhkaLO3.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-jHTy4VXp.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Dl9W95NY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-ESmlLcg7.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BGH4Gs5x.js";import"./tag-YZh_43Ra.js";import"./users-Bi6hX7US.js";import"./vote-D5SBu1pS.js";import"./folder-open-BYsbd4v9.js";import"./send-BjX3cblf.js";import"./file-text-DR9j7dm-.js";import"./briefcase-BwWT7YmC.js";import"./calendar-CX82M-Gf.js";import"./megaphone-CquyAKOZ.js";import"./user-check-oc1qXpsA.js";import"./clipboard-list-CebMH2WS.js";import"./mail-COAfz4y7.js";import"./message-square-BcLVmZGx.js";import"./external-link-6Q0TeQXG.js";import"./panel-left-BwIJamea.js";import"./index-CcfiZCze.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-C-LHJ2QF.js";import"./Progress.vue_vue_type_script_setup_true_lang-CLT7X_RI.js";import"./ellipsis-DAZzGzvR.js";import"./pen-aJWscalj.js";import"./copy-DFGtkNE-.js";import"./trash-2-Bs3Aw1uS.js";import"./calendar-days-oA7eETgz.js";import"./clock-D-_0P1Dt.js";import"./eye-Dc5wk_Ma.js";import"./es-BDPlFIsO.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=Y("NetworkIcon",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),re={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},le={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ne={class:"text-sm text-muted-foreground mt-1"},de={class:"flex items-center gap-2"},me={key:0,class:"grid grid-cols-2 md:grid-cols-5 gap-4"},ce={class:"text-2xl font-bold"},ue={class:"text-2xl font-bold text-gray-500"},pe={class:"text-2xl font-bold text-blue-500"},fe={class:"text-2xl font-bold text-green-500"},ye={class:"flex flex-col sm:flex-row gap-2"},ve={class:"flex-1"},ge={class:"relative"},xe={class:"flex gap-2"},he={key:1},be={key:0,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},$e={key:1,class:"space-y-3"},ke={class:"rounded-full bg-muted p-3 mb-4"},we={class:"text-muted-foreground text-center mb-4"},Ee={key:3,class:"flex justify-center gap-2 mt-4"},Pt=U({__name:"Index",props:{proyecto:{},hitos:{},filters:{},estadisticas:{},timeline:{},canCreate:{type:Boolean},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageDeliverables:{type:Boolean}},setup(i){var j,q;const l=i,f=I(()=>Array.isArray(l.hitos)?{data:l.hitos,current_page:1,last_page:1,per_page:l.hitos.length,total:l.hitos.length}:l.hitos),k=H(((j=l.filters)==null?void 0:j.search)||""),x=H(((q=l.filters)==null?void 0:q.estado)||""),v=H(!1),K=I(()=>{if(!v.value)return f.value.data;const n=f.value.data.filter(s=>!s.parent_id),e=(s,V=0)=>f.value.data.filter(E=>E.parent_id===s).flatMap(E=>[{...E,_nivel:V},...e(E.id,V+1)]);return n.flatMap(s=>[{...s,_nivel:0},...e(s.id,1)])}),Q=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:l.proyecto.nombre,href:`/admin/proyectos/${l.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${l.proyecto.id}/hitos`}],M=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`)},P=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/edit`)},B=n=>{confirm(`¿Estás seguro de eliminar el hito "${n.nombre}"?`)&&y.delete(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`,{onSuccess:()=>{_.success("Hito eliminado exitosamente")},onError:()=>{_.error("Error al eliminar el hito")}})},N=n=>{y.post(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/duplicar`,{},{onSuccess:()=>{_.success("Hito duplicado exitosamente")},onError:()=>{_.error("Error al duplicar el hito")}})},S=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/entregables/create`)},T=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/entregables`)},L=()=>{y.get(`/admin/proyectos/${l.proyecto.id}/hitos`,{search:k.value,estado:x.value},{preserveState:!0,preserveScroll:!0})},w=n=>{x.value=n,L()};return(n,e)=>(d(),m(C,null,[o(t(G),{title:`Hitos - ${i.proyecto.nombre}`},null,8,["title"]),o(X,{breadcrumbs:Q},{default:a(()=>[r("div",re,[r("div",le,[r("div",null,[e[6]||(e[6]=r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Hitos del Proyecto ",-1)),r("p",ne,c(i.proyecto.nombre),1)]),r("div",de,[o(t(z),{href:`/admin/proyectos/${i.proyecto.id}`},{default:a(()=>[o(t(p),{variant:"outline",size:"sm"},{default:a(()=>[o(t(te),{class:"h-4 w-4 mr-2"}),e[7]||(e[7]=u(" Volver al Proyecto ",-1))]),_:1})]),_:1},8,["href"]),i.canCreate?(d(),g(t(z),{key:0,href:`/admin/proyectos/${i.proyecto.id}/hitos/create`},{default:a(()=>[o(t(p),{size:"sm"},{default:a(()=>[o(t(F),{class:"h-4 w-4 mr-2"}),e[8]||(e[8]=u(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):D("",!0)])]),i.estadisticas?(d(),m("div",me,[o(t(b),null,{default:a(()=>[o(t($),{class:"p-4"},{default:a(()=>[r("p",ce,c(i.estadisticas.total),1),e[9]||(e[9]=r("p",{class:"text-xs text-muted-foreground"},"Total",-1))]),_:1})]),_:1}),o(t(b),null,{default:a(()=>[o(t($),{class:"p-4"},{default:a(()=>[r("p",ue,c(i.estadisticas.pendientes),1),e[10]||(e[10]=r("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),_:1})]),_:1}),o(t(b),null,{default:a(()=>[o(t($),{class:"p-4"},{default:a(()=>[r("p",pe,c(i.estadisticas.en_progreso),1),e[11]||(e[11]=r("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),_:1})]),_:1}),o(t(b),null,{default:a(()=>[o(t($),{class:"p-4"},{default:a(()=>[r("p",fe,c(i.estadisticas.completados),1),e[12]||(e[12]=r("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),_:1})]),_:1}),o(t(b),null,{default:a(()=>[o(t($),{class:"p-4"},{default:a(()=>[r("p",{class:h(["text-2xl font-bold",{"text-red-500":i.estadisticas.vencidos>0}])},c(i.estadisticas.vencidos),3),e[13]||(e[13]=r("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))]),_:1})]),_:1})])):D("",!0),r("div",ye,[r("div",ve,[r("div",ge,[o(t(oe),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o(t(Z),{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=s=>k.value=s),placeholder:"Buscar hitos...",class:"pl-9",onKeyup:O(L,["enter"])},null,8,["modelValue"])])]),r("div",xe,[o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":v.value}),onClick:e[1]||(e[1]=s=>v.value=!v.value),title:"Cambiar vista"},{default:a(()=>[v.value?(d(),g(t(ie),{key:0,class:"h-4 w-4 mr-2"})):(d(),g(t(se),{key:1,class:"h-4 w-4 mr-2"})),u(" "+c(v.value?"Jerárquica":"Plana"),1)]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value===""}),onClick:e[2]||(e[2]=s=>w(""))},{default:a(()=>[...e[14]||(e[14]=[u(" Todos ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="pendiente"}),onClick:e[3]||(e[3]=s=>w("pendiente"))},{default:a(()=>[...e[15]||(e[15]=[u(" Pendientes ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="en_progreso"}),onClick:e[4]||(e[4]=s=>w("en_progreso"))},{default:a(()=>[...e[16]||(e[16]=[u(" En Progreso ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="completado"}),onClick:e[5]||(e[5]=s=>w("completado"))},{default:a(()=>[...e[17]||(e[17]=[u(" Completados ",-1)])]),_:1},8,["class"])])]),f.value.data.length>0?(d(),m("div",he,[v.value?(d(),m("div",$e,[(d(!0),m(C,null,A(K.value,s=>(d(),m("div",{key:s.id,style:R({marginLeft:`${(s._nivel||0)*2}rem`}),class:"transition-all"},[o(J,{hito:s,"proyecto-id":i.proyecto.id,canEdit:i.canEdit,canDelete:i.canDelete,canManageDeliverables:i.canManageDeliverables,showActions:!0,onView:M,onEdit:P,onDelete:B,onDuplicate:N,onAddEntregable:S,onViewEntregables:T},W({_:2},[s._nivel>0?{name:"prepend",fn:a(()=>[o(t(ee),{variant:"outline",class:"mr-2"},{default:a(()=>[u(" Nivel "+c(s._nivel),1)]),_:2},1024)]),key:"0"}:void 0]),1032,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"])],4))),128))])):(d(),m("div",be,[(d(!0),m(C,null,A(f.value.data,s=>(d(),g(J,{key:s.id,hito:s,"proyecto-id":i.proyecto.id,canEdit:i.canEdit,canDelete:i.canDelete,canManageDeliverables:i.canManageDeliverables,showActions:!0,onView:M,onEdit:P,onDelete:B,onDuplicate:N,onAddEntregable:S,onViewEntregables:T},null,8,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"]))),128))]))])):(d(),g(t(b),{key:2},{default:a(()=>[o(t($),{class:"flex flex-col items-center justify-center py-12"},{default:a(()=>[r("div",ke,[o(t(ae),{class:"h-8 w-8 text-muted-foreground"})]),e[19]||(e[19]=r("h3",{class:"text-lg font-semibold mb-2"},"No hay hitos",-1)),r("p",we,c(k.value?"No se encontraron hitos con los filtros aplicados":"Comienza creando el primer hito del proyecto"),1),i.canCreate&&!k.value?(d(),g(t(z),{key:0,href:`/admin/proyectos/${i.proyecto.id}/hitos/create`},{default:a(()=>[o(t(p),null,{default:a(()=>[o(t(F),{class:"h-4 w-4 mr-2"}),e[18]||(e[18]=u(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):D("",!0)]),_:1})]),_:1})),f.value.last_page>1?(d(),m("div",Ee,[(d(!0),m(C,null,A(f.value.last_page,s=>(d(),g(t(p),{key:s,variant:s===f.value.current_page?"default":"outline",size:"sm",onClick:V=>t(y).visit(`/admin/proyectos/${i.proyecto.id}/hitos?page=${s}`)},{default:a(()=>[u(c(s),1)]),_:2},1032,["variant","onClick"]))),128))])):D("",!0)])]),_:1})],64))}});export{Pt as default};
