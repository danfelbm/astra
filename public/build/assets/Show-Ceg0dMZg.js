import{_ as De}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DdJPECtB.js";import{d as ve,r as q,c as xe,i as f,j as c,e as t,g as l,h as d,f as e,t as r,F as N,k as I,w as s,b as g,m as i,n as P,q as ze,v as Me,y as Pe,s as B}from"./app-CC6H0n1q.js";import{c as _,_ as b,a as D,b as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-cEX4BYE9.js";import{_ as ce}from"./CardDescription.vue_vue_type_script_setup_true_lang-oS66W6XP.js";import{_ as E}from"./createLucideIcon-dYX5Zc3c.js";import{_ as $}from"./index-BF-_iLjl.js";import{_ as je}from"./Progress.vue_vue_type_script_setup_true_lang-CVhF82fX.js";import{_ as Ve,a as Se,b as te,c as se}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-CthgBOzu.js";import{_ as he,a as _e,b as be,c as $e,d as ke,e as we,f as Ce,g as Ee}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-qWxVTxsK.js";import{_ as Ne}from"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-DtoFKlaq.js";import{t as F}from"./index-BEudbUTF.js";import{_ as ae,a as le,b as oe,c as ie,d as R,e as M}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BQwV_Hph.js";import{C as me}from"./circle-alert-CdXWy-z_.js";import{C as U}from"./clock-UQ7ptsII.js";import{C as W}from"./circle-check-big-DLHWwQ0R.js";import{F as de}from"./file-text-m-9M3IAO.js";import{C as fe}from"./chevron-right-W6qPy3jE.js";import{C as ge}from"./SelectValue.vue_vue_type_script_setup_true_lang-2Hoc4pax.js";import{C as re}from"./calendar-Bem_9K7u.js";import{U as X}from"./user-BTw1JOop.js";import{U as Ae}from"./users-diRFbZaQ.js";import{E as ne}from"./ellipsis-Cn6RPF_b.js";import{S as ue}from"./square-pen-C6gUfDt0.js";import{T as Y}from"./trash-2-BoYCW7_4.js";import{f as Z,e as ee}from"./es-BDPlFIsO.js";import{_ as Te,a as He}from"./ActivityLog.vue_vue_type_script_setup_true_lang-B127ejxA.js";import{A as Be}from"./arrow-left-2z5OHtyZ.js";import{C as Fe}from"./copy-Da1-vjL9.js";import{T as Re}from"./target-DrkLGRcQ.js";import{T as Ue}from"./tag-NWJc8qg8.js";import{P as pe}from"./plus-Ds3Ob7OJ.js";import{p as ye}from"./parseISO-DFjB8F03.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C1PFtUZo.js";import"./index-B8bg8Nrt.js";import"./floating-ui.vue-DZrrCFxg.js";import"./x-Cqilunz3.js";import"./Input.vue_vue_type_script_setup_true_lang-S95rAL8g.js";import"./index-Dge68ev1.js";import"./index-Bsa4GyCh.js";import"./shield-DRPmygLT.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-mmg45jHQ.js";import"./VisuallyHidden-CyESNmVu.js";import"./Label.vue_vue_type_script_setup_true_lang-CI7Ki7bk.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BrhKiRkX.js";import"./map-pin-RkriYLtf.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-DFW1Td8_.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Cw57zajU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-aGUzHs0D.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DN1I8f-L.js";import"./vote-CarmRsxj.js";import"./folder-open-BYYpPfbm.js";import"./send-PI08Xgln.js";import"./briefcase-BEoSukY8.js";import"./megaphone-BJ_gUWIR.js";import"./user-check-Be6i_Nhu.js";import"./clipboard-list-o2S6DZJo.js";import"./mail-DAqRm0Xh.js";import"./message-square-B3HF2G6I.js";import"./external-link-D082l1yM.js";import"./panel-left-CLQkozqV.js";import"./check-Bqnp2acg.js";import"./index-g3trHRXx.js";import"./RovingFocusItem-YyKJZHMi.js";import"./utils-CPpBABdm.js";import"./DialogTrigger-D19cI6Ub.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DGTaIJmy.js";import"./filter-B8EqWTqg.js";const qe={class:"space-y-6"},Ie={key:0,class:"space-y-6"},Le={key:0},Oe={class:"font-semibold mb-3 flex items-center gap-2"},Ge={class:"space-y-2"},Je={class:"flex items-start justify-between"},Ke={class:"flex-1"},Qe={class:"flex items-center gap-2 mb-2"},We={class:"font-medium"},Xe={key:0,class:"ml-8 space-y-3"},Ye={key:0,class:"text-sm text-muted-foreground"},Ze={class:"flex flex-wrap gap-4 text-sm"},et={class:"flex items-center gap-1 text-muted-foreground"},tt={key:0,class:"flex items-center gap-1 text-muted-foreground"},st={key:1,class:"flex items-center gap-2"},at={class:"flex gap-1"},lt={key:1},ot={class:"font-semibold mb-3 flex items-center gap-2"},it={class:"space-y-2"},nt={class:"flex items-start justify-between"},dt={class:"flex-1"},rt={class:"flex items-center gap-2 mb-2"},ut={class:"font-medium"},ct={key:0,class:"ml-8 space-y-3"},mt={key:0,class:"text-sm text-muted-foreground"},ft={class:"flex flex-wrap gap-4 text-sm"},gt={class:"flex items-center gap-1 text-muted-foreground"},pt={key:0,class:"flex items-center gap-1 text-muted-foreground"},yt={key:2},vt={class:"font-semibold mb-3 flex items-center gap-2"},xt={class:"space-y-2"},ht={class:"flex items-start justify-between"},_t={class:"flex-1"},bt={class:"flex items-center gap-2 mb-2"},$t={class:"font-medium line-through text-muted-foreground"},kt={class:"ml-7 space-y-1 text-sm text-muted-foreground"},wt={key:0,class:"flex items-center gap-1"},Ct={key:1,class:"flex items-center gap-1"},Et={key:2,class:"italic mt-2"},Dt={key:3,class:"text-center py-8"},zt=ve({__name:"EntregablesList",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},viewMode:{default:"list"}},emits:["edit","delete","complete","update-status"],setup(o,{emit:v}){const A=o,j=v;q([]);const x=q([]),T=q(!1),V=q(null),k=xe(()=>({pendientes:A.entregables.filter(m=>m.estado==="pendiente"),en_progreso:A.entregables.filter(m=>m.estado==="en_progreso"),completados:A.entregables.filter(m=>m.estado==="completado"),cancelados:A.entregables.filter(m=>m.estado==="cancelado")})),G=m=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[m]||"bg-gray-100 text-gray-800",J=m=>({baja:"bg-gray-100 text-gray-600",media:"bg-yellow-100 text-yellow-800",alta:"bg-red-100 text-red-800"})[m]||"bg-gray-100 text-gray-600",L=m=>m?Z(new Date(m),"dd MMM yyyy",{locale:ee}):"Sin fecha",K=m=>m?Z(new Date(m),"dd MMM yyyy 'a las' HH:mm",{locale:ee}):"-",w=m=>{if(!m)return null;const u=Math.ceil((new Date(m).getTime()-new Date().getTime())/(1e3*60*60*24));return u<0?`Vencido hace ${Math.abs(u)} días`:u===0?"Vence hoy":u===1?"Vence mañana":`${u} días`},O=m=>{const u=x.value.indexOf(m);u===-1?x.value.push(m):x.value.splice(u,1)},H=m=>x.value.includes(m),Q=m=>{j("edit",m)},y=m=>{V.value=m,T.value=!0},a=()=>{V.value&&j("delete",V.value),T.value=!1,V.value=null},p=m=>{j("complete",m)},h=(m,u)=>{j("update-status",m,u)};return(m,u)=>(i(),f("div",qe,[o.viewMode==="list"?(i(),f("div",Ie,[k.value.pendientes.length>0?(i(),f("div",Le,[l("h3",Oe,[t(e(me),{class:"h-5 w-5 text-yellow-600"}),d(" Pendientes ("+r(k.value.pendientes.length)+") ",1)]),l("div",Ge,[(i(!0),f(N,null,I(k.value.pendientes,n=>(i(),g(e(b),{key:n.id},{default:s(()=>[t(e(_),{class:"p-4"},{default:s(()=>{var S;return[l("div",Je,[l("div",Ke,[l("div",Qe,[t(e(E),{onClick:C=>O(n.id),variant:"ghost",size:"sm",class:"h-6 w-6 p-0"},{default:s(()=>[H(n.id)?(i(),g(e(ge),{key:1,class:"h-4 w-4"})):(i(),g(e(fe),{key:0,class:"h-4 w-4"}))]),_:2},1032,["onClick"]),l("h4",We,r(n.nombre),1),t(e($),{class:P(J(n.prioridad)),variant:"outline"},{default:s(()=>[d(r(n.prioridad),1)]),_:2},1032,["class"]),t(e($),{class:P(G(n.estado))},{default:s(()=>[d(r(n.estado),1)]),_:2},1032,["class"])]),H(n.id)?(i(),f("div",Xe,[n.descripcion?(i(),f("p",Ye,r(n.descripcion),1)):c("",!0),l("div",Ze,[l("div",et,[t(e(re),{class:"h-4 w-4"}),l("span",null,r(L(n.fecha_inicio))+" - "+r(L(n.fecha_fin)),1)]),n.responsable?(i(),f("div",tt,[t(e(X),{class:"h-4 w-4"}),l("span",null,r(n.responsable.name),1)])):c("",!0),w(n.fecha_fin)?(i(),f("div",{key:1,class:P(["flex items-center gap-1",{"text-red-600":(S=w(n.fecha_fin))==null?void 0:S.includes("Vencido")}])},[t(e(U),{class:"h-4 w-4"}),l("span",null,r(w(n.fecha_fin)),1)],2)):c("",!0)]),n.usuarios&&n.usuarios.length>0?(i(),f("div",st,[t(e(Ae),{class:"h-4 w-4 text-muted-foreground"}),l("div",at,[(i(!0),f(N,null,I(n.usuarios,C=>(i(),g(e($),{key:C.id,variant:"secondary"},{default:s(()=>[d(r(C.name),1)]),_:2},1024))),128))])])):c("",!0)])):c("",!0)]),o.canEdit||o.canDelete||o.canComplete?(i(),g(e(ae),{key:0},{default:s(()=>[t(e(le),{asChild:""},{default:s(()=>[t(e(E),{variant:"ghost",size:"sm",class:"h-8 w-8 p-0"},{default:s(()=>[t(e(ne),{class:"h-4 w-4"})]),_:1})]),_:1}),t(e(oe),{align:"end"},{default:s(()=>[t(e(ie),null,{default:s(()=>[...u[1]||(u[1]=[d("Acciones",-1)])]),_:1}),t(e(R)),o.canComplete?(i(),g(e(M),{key:0,onClick:C=>p(n)},{default:s(()=>[t(e(W),{class:"h-4 w-4 mr-2"}),u[2]||(u[2]=d(" Marcar como completado ",-1))]),_:1},8,["onClick"])):c("",!0),o.canEdit?(i(),g(e(M),{key:1,onClick:C=>h(n,"en_progreso")},{default:s(()=>[t(e(U),{class:"h-4 w-4 mr-2"}),u[3]||(u[3]=d(" Marcar en progreso ",-1))]),_:1},8,["onClick"])):c("",!0),o.canEdit?(i(),g(e(M),{key:2,onClick:C=>Q(n)},{default:s(()=>[t(e(ue),{class:"h-4 w-4 mr-2"}),u[4]||(u[4]=d(" Editar ",-1))]),_:1},8,["onClick"])):c("",!0),o.canDelete?(i(),g(e(R),{key:3})):c("",!0),o.canDelete?(i(),g(e(M),{key:4,onClick:C=>y(n),class:"text-red-600"},{default:s(()=>[t(e(Y),{class:"h-4 w-4 mr-2"}),u[5]||(u[5]=d(" Eliminar ",-1))]),_:1},8,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)):c("",!0)])]}),_:2},1024)]),_:2},1024))),128))])])):c("",!0),k.value.en_progreso.length>0?(i(),f("div",lt,[l("h3",ot,[t(e(U),{class:"h-5 w-5 text-blue-600"}),d(" En Progreso ("+r(k.value.en_progreso.length)+") ",1)]),l("div",it,[(i(!0),f(N,null,I(k.value.en_progreso,n=>(i(),g(e(b),{key:n.id,class:"border-l-4 border-l-blue-500"},{default:s(()=>[t(e(_),{class:"p-4"},{default:s(()=>{var S;return[l("div",nt,[l("div",dt,[l("div",rt,[t(e(E),{onClick:C=>O(n.id),variant:"ghost",size:"sm",class:"h-6 w-6 p-0"},{default:s(()=>[H(n.id)?(i(),g(e(ge),{key:1,class:"h-4 w-4"})):(i(),g(e(fe),{key:0,class:"h-4 w-4"}))]),_:2},1032,["onClick"]),l("h4",ut,r(n.nombre),1),t(e($),{class:P(J(n.prioridad)),variant:"outline"},{default:s(()=>[d(r(n.prioridad),1)]),_:2},1032,["class"]),t(e($),{class:"bg-blue-100 text-blue-800"},{default:s(()=>[...u[6]||(u[6]=[d(" En Progreso ",-1)])]),_:1})]),H(n.id)?(i(),f("div",ct,[n.descripcion?(i(),f("p",mt,r(n.descripcion),1)):c("",!0),l("div",ft,[l("div",gt,[t(e(re),{class:"h-4 w-4"}),l("span",null,"Fecha límite: "+r(L(n.fecha_fin)),1)]),n.responsable?(i(),f("div",pt,[t(e(X),{class:"h-4 w-4"}),l("span",null,r(n.responsable.name),1)])):c("",!0),w(n.fecha_fin)?(i(),f("div",{key:1,class:P(["flex items-center gap-1",{"text-red-600":(S=w(n.fecha_fin))==null?void 0:S.includes("Vencido")}])},[t(e(U),{class:"h-4 w-4"}),l("span",null,r(w(n.fecha_fin)),1)],2)):c("",!0)])])):c("",!0)]),o.canEdit||o.canDelete||o.canComplete?(i(),g(e(ae),{key:0},{default:s(()=>[t(e(le),{asChild:""},{default:s(()=>[t(e(E),{variant:"ghost",size:"sm",class:"h-8 w-8 p-0"},{default:s(()=>[t(e(ne),{class:"h-4 w-4"})]),_:1})]),_:1}),t(e(oe),{align:"end"},{default:s(()=>[t(e(ie),null,{default:s(()=>[...u[7]||(u[7]=[d("Acciones",-1)])]),_:1}),t(e(R)),o.canComplete?(i(),g(e(M),{key:0,onClick:C=>p(n)},{default:s(()=>[t(e(W),{class:"h-4 w-4 mr-2"}),u[8]||(u[8]=d(" Marcar como completado ",-1))]),_:1},8,["onClick"])):c("",!0),o.canEdit?(i(),g(e(M),{key:1,onClick:C=>Q(n)},{default:s(()=>[t(e(ue),{class:"h-4 w-4 mr-2"}),u[9]||(u[9]=d(" Editar ",-1))]),_:1},8,["onClick"])):c("",!0),o.canDelete?(i(),g(e(R),{key:2})):c("",!0),o.canDelete?(i(),g(e(M),{key:3,onClick:C=>y(n),class:"text-red-600"},{default:s(()=>[t(e(Y),{class:"h-4 w-4 mr-2"}),u[10]||(u[10]=d(" Eliminar ",-1))]),_:1},8,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)):c("",!0)])]}),_:2},1024)]),_:2},1024))),128))])])):c("",!0),k.value.completados.length>0?(i(),f("div",yt,[l("h3",vt,[t(e(W),{class:"h-5 w-5 text-green-600"}),d(" Completados ("+r(k.value.completados.length)+") ",1)]),l("div",xt,[(i(!0),f(N,null,I(k.value.completados,n=>(i(),g(e(b),{key:n.id,class:"border-l-4 border-l-green-500 bg-green-50/30"},{default:s(()=>[t(e(_),{class:"p-4"},{default:s(()=>[l("div",ht,[l("div",_t,[l("div",bt,[t(e(W),{class:"h-5 w-5 text-green-600"}),l("h4",$t,r(n.nombre),1),t(e($),{class:"bg-green-100 text-green-800"},{default:s(()=>[...u[11]||(u[11]=[d(" Completado ",-1)])]),_:1})]),l("div",kt,[n.completado_at?(i(),f("div",wt,[t(e(U),{class:"h-3 w-3"}),l("span",null,"Completado: "+r(K(n.completado_at)),1)])):c("",!0),n.completado_por_usuario?(i(),f("div",Ct,[t(e(X),{class:"h-3 w-3"}),l("span",null,"Por: "+r(n.completado_por_usuario.name),1)])):c("",!0),n.notas_completado?(i(),f("p",Et,' "'+r(n.notas_completado)+'" ',1)):c("",!0)])]),o.canEdit||o.canDelete?(i(),g(e(ae),{key:0},{default:s(()=>[t(e(le),{asChild:""},{default:s(()=>[t(e(E),{variant:"ghost",size:"sm",class:"h-8 w-8 p-0"},{default:s(()=>[t(e(ne),{class:"h-4 w-4"})]),_:1})]),_:1}),t(e(oe),{align:"end"},{default:s(()=>[t(e(ie),null,{default:s(()=>[...u[12]||(u[12]=[d("Acciones",-1)])]),_:1}),t(e(R)),o.canEdit?(i(),g(e(M),{key:0,onClick:S=>h(n,"pendiente")},{default:s(()=>[t(e(me),{class:"h-4 w-4 mr-2"}),u[13]||(u[13]=d(" Reabrir ",-1))]),_:1},8,["onClick"])):c("",!0),o.canDelete?(i(),g(e(R),{key:1})):c("",!0),o.canDelete?(i(),g(e(M),{key:2,onClick:S=>y(n),class:"text-red-600"},{default:s(()=>[t(e(Y),{class:"h-4 w-4 mr-2"}),u[14]||(u[14]=d(" Eliminar ",-1))]),_:1},8,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)):c("",!0)])]),_:2},1024)]),_:2},1024))),128))])])):c("",!0),o.entregables.length===0?(i(),f("div",Dt,[t(e(de),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),u[15]||(u[15]=l("p",{class:"text-muted-foreground"},"No hay entregables asignados",-1))])):c("",!0)])):c("",!0),t(e(he),{open:T.value,"onUpdate:open":u[0]||(u[0]=n=>T.value=n)},{default:s(()=>[t(e(_e),null,{default:s(()=>[t(e(be),null,{default:s(()=>[t(e($e),null,{default:s(()=>[...u[16]||(u[16]=[d("¿Estás seguro?",-1)])]),_:1}),t(e(ke),null,{default:s(()=>{var n;return[d(' Esta acción no se puede deshacer. Se eliminará permanentemente el entregable "'+r((n=V.value)==null?void 0:n.nombre)+'". ',1)]}),_:1})]),_:1}),t(e(we),null,{default:s(()=>[t(e(Ce),null,{default:s(()=>[...u[17]||(u[17]=[d("Cancelar",-1)])]),_:1}),t(e(Ee),{onClick:a},{default:s(()=>[...u[18]||(u[18]=[d(" Eliminar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}}),Mt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Pt={class:"flex items-center justify-between"},jt={class:"text-2xl font-bold"},Vt={class:"text-muted-foreground"},St={class:"flex items-center gap-2"},Nt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-5"},At={class:"text-2xl font-bold"},Tt={class:"text-2xl font-bold"},Ht={class:"text-xs text-muted-foreground"},Bt={class:"text-sm font-medium"},Ft={class:"text-sm font-medium"},Rt={key:0,class:"text-xs text-muted-foreground"},Ut={key:0},qt={class:"text-sm text-muted-foreground whitespace-pre-wrap"},It={class:"grid gap-4 md:grid-cols-2"},Lt={class:"text-sm text-muted-foreground"},Ot={class:"text-sm text-muted-foreground"},Gt={class:"text-sm text-muted-foreground"},Jt={class:"space-y-2"},Kt={class:"flex items-center justify-between text-sm"},Qt={class:"flex items-center justify-between text-sm"},Wt={class:"flex items-center justify-between text-sm"},Xt={class:"flex items-center gap-2"},Yt={class:"flex flex-wrap gap-2"},Zt={class:"space-y-3"},es={key:0},ts={class:"text-sm text-muted-foreground"},ss={key:1},as={class:"grid gap-4 md:grid-cols-2"},ls={class:"font-semibold mb-1"},os={key:0,class:"text-red-500"},is={class:"text-sm text-muted-foreground"},ns={key:0,class:"text-xs text-muted-foreground mt-1"},ds={key:0,class:"text-center py-4"},rs={class:"grid gap-4 md:grid-cols-2 text-sm"},us={class:"font-medium"},cs={class:"font-medium"},ms={key:0},fs={class:"font-medium"},gs={key:1},ps={class:"font-medium"},ys={class:"flex justify-between items-center"},ja=ve({__name:"Show",props:{hito:{},proyecto:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageEntregables:{type:Boolean},estadisticas:{},actividades:{},usuariosActividades:{},camposPersonalizados:{},valoresCamposPersonalizados:{}},setup(o){const v=o,A=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:v.proyecto.nombre,href:`/admin/proyectos/${v.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${v.proyecto.id}/hitos`},{title:v.hito.nombre,href:"#"}],j=q("detalles"),x=q({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null}),T=()=>{B.visit(`/admin/proyectos/${v.proyecto.id}/hitos/${v.hito.id}/edit`)},V=()=>{B.delete(`/admin/proyectos/${v.proyecto.id}/hitos/${v.hito.id}`,{onSuccess:()=>{F.success("Hito eliminado exitosamente")},onError:()=>{F.error("Error al eliminar el hito")}})},k=()=>{B.post(`/admin/proyectos/${v.proyecto.id}/hitos/${v.hito.id}/duplicar`,{},{onSuccess:()=>{F.success("Hito duplicado exitosamente")},onError:()=>{F.error("Error al duplicar el hito")}})},G=()=>{B.visit(`/admin/proyectos/${v.proyecto.id}/hitos/${v.hito.id}/entregables/create`)},J=y=>{B.visit(`/admin/proyectos/${v.proyecto.id}/hitos/${v.hito.id}/entregables/${y.id}/edit`)},L=y=>{B.delete(`/admin/proyectos/${v.proyecto.id}/hitos/${v.hito.id}/entregables/${y.id}`,{onSuccess:()=>{F.success("Entregable eliminado exitosamente")},onError:()=>{F.error("Error al eliminar el entregable")}})},K=y=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[y]||"bg-gray-100 text-gray-800",w=y=>y?Z(ye(y),"dd MMM yyyy",{locale:ee}):"No definida",O=y=>y?Z(ye(y),"dd MMM yyyy 'a las' HH:mm",{locale:ee}):"No definida",H=(y,a)=>{var p;if(a==null||a==="")return"No especificado";switch(y.tipo){case"date":return w(a);case"checkbox":return a?"Sí":"No";case"select":case"radio":const h=(p=y.opciones)==null?void 0:p.find(m=>m.value===a);return(h==null?void 0:h.label)||a;default:return a}},Q=xe(()=>{let y=v.actividades||[];return x.value.usuario_id&&(y=y.filter(a=>{var p;return((p=a.causer)==null?void 0:p.id)===x.value.usuario_id})),x.value.tipo_entidad&&(y=y.filter(a=>a.subject_type===x.value.tipo_entidad)),x.value.tipo_accion&&(y=y.filter(a=>a.event===x.value.tipo_accion)),(x.value.fecha_inicio||x.value.fecha_fin)&&(y=y.filter(a=>{const p=new Date(a.created_at);if(x.value.fecha_inicio){const h=new Date(x.value.fecha_inicio);if(p<h)return!1}if(x.value.fecha_fin){const h=new Date(x.value.fecha_fin);if(h.setHours(23,59,59,999),p>h)return!1}return!0})),y});return(y,a)=>(i(),f(N,null,[t(e(ze),{title:`Hito: ${o.hito.nombre}`},null,8,["title"]),t(De,{breadcrumbs:A},{default:s(()=>[l("div",Mt,[l("div",Pt,[l("div",null,[l("h1",jt,r(o.hito.nombre),1),l("p",Vt,"Proyecto: "+r(o.proyecto.nombre),1)]),l("div",St,[t(e(Me),{href:`/admin/proyectos/${o.proyecto.id}/hitos`},{default:s(()=>[t(e(E),{variant:"outline",size:"sm"},{default:s(()=>[t(e(Be),{class:"h-4 w-4 mr-2"}),a[2]||(a[2]=d(" Volver ",-1))]),_:1})]),_:1},8,["href"]),o.canEdit?(i(),g(e(E),{key:0,onClick:T,size:"sm",variant:"outline"},{default:s(()=>[t(e(ue),{class:"h-4 w-4 mr-2"}),a[3]||(a[3]=d(" Editar ",-1))]),_:1})):c("",!0),t(e(E),{onClick:k,size:"sm",variant:"outline"},{default:s(()=>[t(e(Fe),{class:"h-4 w-4 mr-2"}),a[4]||(a[4]=d(" Duplicar ",-1))]),_:1}),o.canDelete?(i(),g(e(he),{key:1},{default:s(()=>[t(e(Ne),{asChild:""},{default:s(()=>[t(e(E),{variant:"destructive",size:"sm"},{default:s(()=>[t(e(Y),{class:"h-4 w-4 mr-2"}),a[5]||(a[5]=d(" Eliminar ",-1))]),_:1})]),_:1}),t(e(_e),null,{default:s(()=>[t(e(be),null,{default:s(()=>[t(e($e),null,{default:s(()=>[...a[6]||(a[6]=[d("¿Estás seguro?",-1)])]),_:1}),t(e(ke),null,{default:s(()=>[...a[7]||(a[7]=[d(" Esta acción no se puede deshacer. Se eliminará permanentemente el hito y todos sus entregables asociados. ",-1)])]),_:1})]),_:1}),t(e(we),null,{default:s(()=>[t(e(Ce),null,{default:s(()=>[...a[8]||(a[8]=[d("Cancelar",-1)])]),_:1}),t(e(Ee),{onClick:V},{default:s(()=>[...a[9]||(a[9]=[d(" Eliminar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})):c("",!0)])]),l("div",Nt,[t(e(b),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(z),{class:"text-sm font-medium"},{default:s(()=>[...a[10]||(a[10]=[d("Estado",-1)])]),_:1}),t(e(Re),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(_),null,{default:s(()=>[t(e($),{class:P([K(o.hito.estado),"mt-1"])},{default:s(()=>[d(r(o.hito.estado),1)]),_:1},8,["class"])]),_:1})]),_:1}),t(e(b),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(z),{class:"text-sm font-medium"},{default:s(()=>[...a[11]||(a[11]=[d("Progreso",-1)])]),_:1}),t(e(U),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(_),null,{default:s(()=>[l("div",At,r(o.hito.porcentaje_completado)+"%",1),t(e(je),{value:o.hito.porcentaje_completado,class:"mt-2 h-1"},null,8,["value"])]),_:1})]),_:1}),t(e(b),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(z),{class:"text-sm font-medium"},{default:s(()=>[...a[12]||(a[12]=[d("Entregables",-1)])]),_:1}),t(e(de),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(_),null,{default:s(()=>[l("div",Tt,r(o.estadisticas.total_entregables),1),l("p",Ht,r(o.estadisticas.entregables_completados)+" completados ",1)]),_:1})]),_:1}),t(e(b),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(z),{class:"text-sm font-medium"},{default:s(()=>[...a[13]||(a[13]=[d("Fecha Fin",-1)])]),_:1}),t(e(re),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(_),null,{default:s(()=>[l("div",Bt,r(w(o.hito.fecha_fin)),1),o.estadisticas.dias_restantes!==null?(i(),f("p",{key:0,class:P(["text-xs",o.estadisticas.esta_vencido?"text-red-600":"text-muted-foreground"])},r(o.estadisticas.esta_vencido?`Vencido hace ${Math.abs(o.estadisticas.dias_restantes)} días`:`${o.estadisticas.dias_restantes} días restantes`),3)):c("",!0)]),_:1})]),_:1}),t(e(b),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(z),{class:"text-sm font-medium"},{default:s(()=>[...a[14]||(a[14]=[d("Responsable",-1)])]),_:1}),t(e(X),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(_),null,{default:s(()=>{var p;return[l("div",Ft,r(((p=o.hito.responsable)==null?void 0:p.name)||"Sin asignar"),1),o.hito.responsable?(i(),f("p",Rt,r(o.hito.responsable.email),1)):c("",!0)]}),_:1})]),_:1})]),t(e(Ve),{modelValue:j.value,"onUpdate:modelValue":a[1]||(a[1]=p=>j.value=p),class:"flex-1"},{default:s(()=>[t(e(Se),null,{default:s(()=>[t(e(te),{value:"detalles"},{default:s(()=>[...a[15]||(a[15]=[d("Detalles",-1)])]),_:1}),t(e(te),{value:"entregables"},{default:s(()=>[a[16]||(a[16]=d(" Entregables ",-1)),t(e($),{variant:"secondary",class:"ml-2"},{default:s(()=>[d(r(o.estadisticas.total_entregables),1)]),_:1})]),_:1}),t(e(te),{value:"actividad"},{default:s(()=>[...a[17]||(a[17]=[d("Actividad",-1)])]),_:1})]),_:1}),t(e(se),{value:"detalles",class:"space-y-4"},{default:s(()=>[t(e(b),null,{default:s(()=>[t(e(D),null,{default:s(()=>[t(e(z),null,{default:s(()=>[...a[18]||(a[18]=[d("Información General",-1)])]),_:1})]),_:1}),t(e(_),{class:"space-y-4"},{default:s(()=>[o.hito.descripcion?(i(),f("div",Ut,[a[19]||(a[19]=l("h3",{class:"font-semibold mb-2"},"Descripción",-1)),l("p",qt,r(o.hito.descripcion),1)])):c("",!0),l("div",It,[l("div",null,[a[20]||(a[20]=l("h3",{class:"font-semibold mb-2"},"Fecha de Inicio",-1)),l("p",Lt,r(w(o.hito.fecha_inicio)),1)]),l("div",null,[a[21]||(a[21]=l("h3",{class:"font-semibold mb-2"},"Fecha de Fin",-1)),l("p",Ot,r(w(o.hito.fecha_fin)),1)]),l("div",null,[a[22]||(a[22]=l("h3",{class:"font-semibold mb-2"},"Orden",-1)),l("p",Gt,r(o.hito.orden),1)]),l("div",null,[a[23]||(a[23]=l("h3",{class:"font-semibold mb-2"},"Estado",-1)),t(e($),{class:P(K(o.hito.estado))},{default:s(()=>[d(r(o.hito.estado),1)]),_:1},8,["class"])])]),l("div",null,[a[27]||(a[27]=l("h3",{class:"font-semibold mb-2"},"Resumen de Entregables",-1)),l("div",Jt,[l("div",Kt,[a[24]||(a[24]=l("span",{class:"text-muted-foreground"},"Pendientes",-1)),t(e($),{variant:"outline"},{default:s(()=>[d(r(o.estadisticas.entregables_pendientes),1)]),_:1})]),l("div",Qt,[a[25]||(a[25]=l("span",{class:"text-muted-foreground"},"En Progreso",-1)),t(e($),{variant:"outline",class:"bg-blue-50"},{default:s(()=>[d(r(o.estadisticas.entregables_en_progreso),1)]),_:1})]),l("div",Wt,[a[26]||(a[26]=l("span",{class:"text-muted-foreground"},"Completados",-1)),t(e($),{variant:"outline",class:"bg-green-50"},{default:s(()=>[d(r(o.estadisticas.entregables_completados),1)]),_:1})])])])]),_:1})]),_:1}),o.hito.etiquetas&&o.hito.etiquetas.length>0?(i(),g(e(b),{key:0},{default:s(()=>[t(e(D),null,{default:s(()=>[l("div",Xt,[t(e(Ue),{class:"h-5 w-5"}),t(e(z),null,{default:s(()=>[...a[28]||(a[28]=[d("Etiquetas",-1)])]),_:1})]),t(e(ce),null,{default:s(()=>[...a[29]||(a[29]=[d(" Etiquetas asignadas a este hito para su organización y categorización ",-1)])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[l("div",Yt,[(i(!0),f(N,null,I(o.hito.etiquetas,p=>(i(),g(e($),{key:p.id,variant:"outline",class:"px-3 py-1.5",style:Pe({borderColor:p.color||"#94a3b8",color:p.color||"#64748b",backgroundColor:`${p.color}15`||"#f1f5f9"})},{default:s(()=>[d(r(p.nombre),1)]),_:2},1032,["style"]))),128))])]),_:1})]),_:1})):c("",!0),o.hito.parent_id||o.hito.ruta_completa?(i(),g(e(b),{key:1},{default:s(()=>[t(e(D),null,{default:s(()=>[t(e(z),null,{default:s(()=>[...a[30]||(a[30]=[d("Jerarquía",-1)])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[l("div",Zt,[o.hito.ruta_completa?(i(),f("div",es,[a[31]||(a[31]=l("h3",{class:"font-semibold mb-2"},"Ruta Completa",-1)),l("p",ts,r(o.hito.ruta_completa),1)])):c("",!0),o.hito.nivel!==void 0?(i(),f("div",ss,[a[32]||(a[32]=l("h3",{class:"font-semibold mb-2"},"Nivel",-1)),t(e($),{variant:"outline"},{default:s(()=>[d("Nivel "+r(o.hito.nivel),1)]),_:1})])):c("",!0)])]),_:1})]),_:1})):c("",!0),o.camposPersonalizados&&o.camposPersonalizados.length>0?(i(),g(e(b),{key:2},{default:s(()=>[t(e(D),null,{default:s(()=>[t(e(z),null,{default:s(()=>[...a[33]||(a[33]=[d("Campos Personalizados",-1)])]),_:1}),t(e(ce),null,{default:s(()=>[...a[34]||(a[34]=[d(" Información adicional específica del hito ",-1)])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[l("div",as,[(i(!0),f(N,null,I(o.camposPersonalizados,p=>{var h;return i(),f("div",{key:p.id},[l("h3",ls,[d(r(p.nombre)+" ",1),p.es_requerido?(i(),f("span",os,"*")):c("",!0)]),l("p",is,r(H(p,(h=o.valoresCamposPersonalizados)==null?void 0:h[p.id])),1),p.descripcion?(i(),f("p",ns,r(p.descripcion),1)):c("",!0)])}),128))]),!o.camposPersonalizados||o.camposPersonalizados.length===0?(i(),f("div",ds,[...a[35]||(a[35]=[l("p",{class:"text-sm text-muted-foreground"},"No hay campos personalizados configurados",-1)])])):c("",!0)]),_:1})]),_:1})):c("",!0),t(e(b),null,{default:s(()=>[t(e(D),null,{default:s(()=>[t(e(z),null,{default:s(()=>[...a[36]||(a[36]=[d("Información del Sistema",-1)])]),_:1})]),_:1}),t(e(_),null,{default:s(()=>[l("div",rs,[l("div",null,[a[37]||(a[37]=l("span",{class:"text-muted-foreground"},"Creado el:",-1)),l("p",us,r(O(o.hito.created_at)),1)]),l("div",null,[a[38]||(a[38]=l("span",{class:"text-muted-foreground"},"Última actualización:",-1)),l("p",cs,r(O(o.hito.updated_at)),1)]),o.hito.created_by_usuario?(i(),f("div",ms,[a[39]||(a[39]=l("span",{class:"text-muted-foreground"},"Creado por:",-1)),l("p",fs,r(o.hito.created_by_usuario.name),1)])):c("",!0),o.hito.updated_by_usuario?(i(),f("div",gs,[a[40]||(a[40]=l("span",{class:"text-muted-foreground"},"Actualizado por:",-1)),l("p",ps,r(o.hito.updated_by_usuario.name),1)])):c("",!0)])]),_:1})]),_:1})]),_:1}),t(e(se),{value:"entregables",class:"space-y-4"},{default:s(()=>[l("div",ys,[a[42]||(a[42]=l("h2",{class:"text-lg font-semibold"},"Lista de Entregables",-1)),o.canManageEntregables?(i(),g(e(E),{key:0,onClick:G,size:"sm"},{default:s(()=>[t(e(pe),{class:"h-4 w-4 mr-2"}),a[41]||(a[41]=d(" Nuevo Entregable ",-1))]),_:1})):c("",!0)]),t(zt,{entregables:o.hito.entregables||[],"can-edit":o.canManageEntregables,"can-delete":o.canManageEntregables,onEdit:J,onDelete:L},null,8,["entregables","can-edit","can-delete"]),!o.hito.entregables||o.hito.entregables.length===0?(i(),g(e(b),{key:0},{default:s(()=>[t(e(_),{class:"text-center py-8"},{default:s(()=>[t(e(de),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a[44]||(a[44]=l("p",{class:"text-muted-foreground mb-4"},"No hay entregables asignados a este hito",-1)),o.canManageEntregables?(i(),g(e(E),{key:0,onClick:G,variant:"outline"},{default:s(()=>[t(e(pe),{class:"h-4 w-4 mr-2"}),a[43]||(a[43]=d(" Crear Primer Entregable ",-1))]),_:1})):c("",!0)]),_:1})]),_:1})):c("",!0)]),_:1}),t(e(se),{value:"actividad",class:"space-y-4"},{default:s(()=>[o.actividades&&o.actividades.length>0?(i(),g(Te,{key:0,modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=p=>x.value=p),usuarios:o.usuariosActividades,"context-level":"hito"},null,8,["modelValue","usuarios"])):c("",!0),t(He,{activities:Q.value,title:"Historial de Actividad",description:"Registro de cambios y actividades del hito y sus entregables","empty-message":"No hay actividad registrada"},null,8,["activities"])]),_:1})]),_:1},8,["modelValue"])])]),_:1})],64))}});export{ja as default};
