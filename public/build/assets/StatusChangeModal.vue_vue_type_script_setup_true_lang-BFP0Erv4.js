import{e as N,_ as T,a as A,b as R,c as U,d as F}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BvOGWYox.js";import{_ as x}from"./createLucideIcon-D-eVYV0X.js";import{_ as M}from"./Switch.vue_vue_type_script_setup_true_lang-C96XcaL1.js";import{_ as j}from"./Label.vue_vue_type_script_setup_true_lang-BJwJYrXW.js";import{_ as D}from"./ComentarioContextoInput.vue_vue_type_script_setup_true_lang-C-IQ5DsZ.js";import{C as I}from"./circle-x-CE_9h50a.js";import{C as L}from"./circle-alert-d8VqH1J6.js";import{C as S}from"./clock-DN-ZQrgB.js";import{C as z}from"./circle-check-big-GKWDCEY_.js";import{L as P}from"./loader-circle-CD26v6tX.js";import{d as X,r as p,c as y,p as q,b as v,f as a,w as t,e as o,g as m,x as G,n as h,h as u,t as C,i as H,j as w,m as g}from"./app-D295TwpG.js";const J={class:"flex gap-3"},K={class:"flex-1"},O={class:"space-y-4 py-4"},Q={class:"flex items-center justify-between"},W={key:0,class:"space-y-2"},ce=X({__name:"StatusChangeModal",props:{open:{type:Boolean,default:!1},entregableNombre:{},estadoActual:{},nuevoEstado:{},loading:{type:Boolean,default:!1}},emits:["update:open","confirm","cancel"],setup(i,{emit:$}){const c=i,d=$,f=p(""),b=p([]),n=p(!1),_=p(null),l=y(()=>({completado:{icon:z,iconClass:"text-green-600",buttonClass:"bg-green-600 hover:bg-green-700",title:"¿Marcar como completado?",description:"El entregable se marcará como completado y se registrará la fecha y hora.",confirmText:"Completar",defaultComentario:!1},en_progreso:{icon:S,iconClass:"text-blue-600",buttonClass:"bg-blue-600 hover:bg-blue-700",title:"¿Marcar en progreso?",description:"El entregable se marcará como en progreso.",confirmText:"En Progreso",defaultComentario:!1},pendiente:{icon:L,iconClass:"text-yellow-600",buttonClass:"bg-yellow-600 hover:bg-yellow-700",title:"¿Reabrir entregable?",description:"El entregable volverá a estado pendiente.",confirmText:"Reabrir",defaultComentario:!1},cancelado:{icon:I,iconClass:"text-red-600",buttonClass:"bg-red-600 hover:bg-red-700",title:"¿Cancelar entregable?",description:"El entregable se marcará como cancelado.",confirmText:"Cancelar Entregable",defaultComentario:!0}})[c.nuevoEstado]),k=y(()=>c.entregableNombre?`${l.value.title.replace("?","")}: "${c.entregableNombre}"?`:l.value.title),E=()=>{var s;f.value="",b.value=[],(s=_.value)==null||s.clear()};q(()=>c.open,s=>{s?n.value=l.value.defaultComentario:(E(),n.value=!1)});const V=()=>{const s=n.value?f.value:"",e=n.value?b.value:[];d("confirm",s,e),c.loading||d("update:open",!1)},B=()=>{d("cancel"),d("update:open",!1)};return(s,e)=>(g(),v(a(N),{open:i.open,"onUpdate:open":e[3]||(e[3]=r=>d("update:open",r))},{default:t(()=>[o(a(T),{class:"sm:max-w-lg"},{default:t(()=>[o(a(A),null,{default:t(()=>[m("div",J,[(g(),v(G(l.value.icon),{class:h(["h-5 w-5 mt-0.5 flex-shrink-0",l.value.iconClass]),"aria-hidden":"true"},null,8,["class"])),m("div",K,[o(a(R),null,{default:t(()=>[u(C(k.value),1)]),_:1}),o(a(U),{class:"mt-2"},{default:t(()=>[u(C(l.value.description),1)]),_:1})])])]),_:1}),m("div",O,[m("div",Q,[o(a(j),{for:"agregar-comentario",class:"text-sm"},{default:t(()=>[...e[4]||(e[4]=[u(" Agregar comentario ",-1)])]),_:1}),o(a(M),{id:"agregar-comentario",modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r),disabled:i.loading},null,8,["modelValue","disabled"])]),n.value?(g(),H("div",W,[o(D,{ref_key:"comentarioInputRef",ref:_,modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=r=>f.value=r),placeholder:"Agrega un comentario sobre este cambio de estado...",rows:3,"show-file-upload":!0,"upload-module":"comentarios","upload-field-id":"entregable-comentario","onUpdate:archivos":e[2]||(e[2]=r=>b.value=r)},null,8,["modelValue"]),e[5]||(e[5]=m("p",{class:"text-xs text-muted-foreground"}," Este comentario aparecerá con el badge del nuevo estado. ",-1))])):w("",!0)]),o(a(F),{class:"gap-2 sm:gap-0"},{default:t(()=>[o(a(x),{variant:"outline",onClick:B,disabled:i.loading},{default:t(()=>[...e[6]||(e[6]=[u(" Cancelar ",-1)])]),_:1},8,["disabled"]),o(a(x),{onClick:V,class:h(l.value.buttonClass),disabled:i.loading},{default:t(()=>[i.loading?(g(),v(a(P),{key:0,class:"mr-2 h-4 w-4 animate-spin","aria-hidden":"true"})):w("",!0),u(" "+C(l.value.confirmText),1)]),_:1},8,["class","disabled"])]),_:1})]),_:1})]),_:1},8,["open"]))}});export{ce as _};
