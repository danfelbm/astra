import{d as L,r as U,c as k,i as _,F as j,b as x,j as v,e as s,f as e,w as o,k as B,g as a,m as f,t as d,h as m,v as P,l as q,n as E,x as H}from"./app-22iUgOMO.js";import{c as I,_ as F,a as z,b as M}from"./CardTitle.vue_vue_type_script_setup_true_lang-DfXdCOp6.js";import{_ as w}from"./index-DBWcKyvi.js";import{c as R,_ as V}from"./createLucideIcon-DYCv6hRJ.js";import{_ as G,a as O,b as S,c as p,d as J,e as h}from"./TableHeader.vue_vue_type_script_setup_true_lang-Dc4MknNd.js";import{_ as K,d as Q,e as W,f as X,g as Y}from"./ActivityLog.vue_vue_type_script_setup_true_lang-DAflfOjf.js";import{_ as Z}from"./EvidenciaAccionesEstado.vue_vue_type_script_setup_true_lang-56ZOlzN8.js";import{I as T}from"./image-ihLmO3uN.js";import{F as tt}from"./file-text-Bj1XLIkZ.js";import{E as et}from"./external-link-BVkbLBEW.js";import{E as at}from"./eye-CSlvRdKS.js";import{D as st}from"./download-Ca03T6ty.js";import{_ as ot}from"./Progress.vue_vue_type_script_setup_true_lang-B20xxmyS.js";import{C as lt}from"./circle-check-big-DQGkzza3.js";import{C as rt}from"./circle-play-GspT3p4N.js";import{T as nt}from"./target-nNhv35Ae.js";import{C as it}from"./circle-alert-PW6YN25K.js";import{F as dt}from"./zap-HY6QURU1.js";import{C as N}from"./calendar-D_dMKb1F.js";import{C as ct}from"./clock-9lhNKYFQ.js";import{U as ut}from"./user-Df4LagRd.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=R("BanIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=R("CirclePauseIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),gt={key:1,class:"mt-4"},yt={class:"flex items-center justify-between w-full pr-4"},xt={class:"flex items-center gap-3"},_t={class:"text-left"},bt={class:"font-semibold"},vt={class:"text-sm text-gray-500"},pt={class:"flex items-center gap-3"},ht={class:"text-sm text-gray-600"},kt={class:"text-sm"},$t={class:"flex items-center justify-end gap-2"},wt=["href"],Ct={class:"text-center"},Dt={class:"text-center"},pe=L({__name:"EvidenciasDisplay",props:{contratos:{default:()=>[]},hitos:{default:()=>[]},proyectoId:{},modo:{},puedeGestionarEstado:{type:Boolean,default:!1},formatDate:{}},setup(l){const y=l,n=U({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null,hito_id:null,entregable_id:null}),g=k(()=>{const r=[];return y.contratos&&y.contratos.forEach(t=>{t.obligaciones&&t.obligaciones.forEach(i=>{i.evidencias&&i.evidencias.forEach(u=>{r.push({...u,contrato_id:t.id,contrato_numero:t.numero_contrato,contrato_nombre:t.nombre,obligacion_titulo:i.titulo,_contrato:t})})})}),r}),$=k(()=>{let r=g.value;return n.value.contrato_id&&(r=r.filter(t=>t.contrato_id===n.value.contrato_id)),n.value.tipo&&(r=r.filter(t=>t.tipo_evidencia===n.value.tipo)),n.value.estado&&(r=r.filter(t=>t.estado===n.value.estado)),n.value.usuario_id&&(r=r.filter(t=>{var i;return((i=t.usuario)==null?void 0:i.id)===n.value.usuario_id})),n.value.hito_id&&(r=r.filter(t=>!t.entregables||t.entregables.length===0?!1:t.entregables.some(i=>i.hito_id===n.value.hito_id))),n.value.entregable_id&&(r=r.filter(t=>!t.entregables||t.entregables.length===0?!1:t.entregables.some(i=>i.id===n.value.entregable_id))),(n.value.fecha_inicio||n.value.fecha_fin)&&(r=r.filter(t=>{const i=new Date(t.created_at);if(n.value.fecha_inicio){const u=new Date(n.value.fecha_inicio);if(i<u)return!1}if(n.value.fecha_fin){const u=new Date(n.value.fecha_fin);if(u.setHours(23,59,59,999),i>u)return!1}return!0})),r}),C=k(()=>{const r={};return $.value.forEach(t=>{r[t.contrato_id]||(r[t.contrato_id]={contrato:t._contrato,evidencias:[]}),r[t.contrato_id].evidencias.push(t)}),Object.values(r)}),D=k(()=>{const r=[];return y.hitos&&y.hitos.forEach(t=>{t.entregables&&t.entregables.forEach(i=>{r.push({...i,hito_id:t.id,hito_nombre:t.nombre})})}),r}),b=r=>y.modo==="admin"?`/admin/contratos/${r}`:`/miembro/mis-contratos/${r}`,c=(r,t)=>y.modo==="admin"?`/admin/contratos/${r}/evidencias/${t}`:`/miembro/mis-contratos/${r}/evidencias/${t}`;return(r,t)=>(f(),_(j,null,[g.value.length>0?(f(),x(K,{key:0,modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),contratos:l.contratos||[],evidencias:g.value,hitos:l.hitos||[],entregables:D.value},null,8,["modelValue","contratos","evidencias","hitos","entregables"])):v("",!0),C.value.length>0?(f(),_("div",gt,[s(e(Q),{type:"multiple",class:"space-y-4",collapsible:""},{default:o(()=>[(f(!0),_(j,null,B(C.value,i=>(f(),x(e(W),{key:i.contrato.id,value:`contrato-${i.contrato.id}`,class:"border rounded-lg bg-card"},{default:o(()=>[s(e(X),{class:"px-4 py-3 hover:no-underline hover:bg-gray-50 dark:hover:bg-gray-800 rounded-t-lg"},{default:o(()=>[a("div",yt,[a("div",xt,[s(e(tt),{class:"h-5 w-5 text-gray-500"}),a("div",_t,[a("div",bt,d(i.contrato.nombre),1),a("div",vt,d(i.contrato.numero_contrato||"Sin número"),1)])]),a("div",pt,[s(e(w),{variant:"secondary"},{default:o(()=>[m(d(i.evidencias.length)+" evidencia(s) ",1)]),_:2},1024),s(e(P),{href:b(i.contrato.id),onClick:t[1]||(t[1]=q(()=>{},["stop"])),class:"text-blue-600 hover:text-blue-800 flex items-center gap-1"},{default:o(()=>[t[2]||(t[2]=m(" Ver contrato ",-1)),s(e(et),{class:"h-3 w-3"})]),_:1},8,["href"])])])]),_:2},1024),s(e(Y),{class:"px-4 pb-4"},{default:o(()=>[s(e(G),null,{default:o(()=>[s(e(O),null,{default:o(()=>[s(e(S),null,{default:o(()=>[s(e(p),null,{default:o(()=>[...t[3]||(t[3]=[m("Tipo",-1)])]),_:1}),s(e(p),null,{default:o(()=>[...t[4]||(t[4]=[m("Obligación",-1)])]),_:1}),s(e(p),null,{default:o(()=>[...t[5]||(t[5]=[m("Descripción",-1)])]),_:1}),l.modo==="admin"?(f(),x(e(p),{key:0},{default:o(()=>[...t[6]||(t[6]=[m("Usuario",-1)])]),_:1})):v("",!0),s(e(p),null,{default:o(()=>[...t[7]||(t[7]=[m("Estado",-1)])]),_:1}),s(e(p),null,{default:o(()=>[...t[8]||(t[8]=[m("Fecha",-1)])]),_:1}),s(e(p),{class:"text-right"},{default:o(()=>[...t[9]||(t[9]=[m("Acciones",-1)])]),_:1})]),_:1})]),_:1}),s(e(J),null,{default:o(()=>[(f(!0),_(j,null,B(i.evidencias,u=>(f(),x(e(S),{key:u.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800"},{default:o(()=>[s(e(h),null,{default:o(()=>[s(e(w),{variant:"outline"},{default:o(()=>[m(d(u.tipo_evidencia),1)]),_:2},1024)]),_:2},1024),s(e(h),null,{default:o(()=>[m(d(u.obligacion_titulo),1)]),_:2},1024),s(e(h),null,{default:o(()=>[a("span",ht,d(u.descripcion||"-"),1)]),_:2},1024),l.modo==="admin"?(f(),x(e(h),{key:0},{default:o(()=>{var A;return[a("span",kt,d(((A=u.usuario)==null?void 0:A.name)||"-"),1)]}),_:2},1024)):v("",!0),s(e(h),null,{default:o(()=>[s(e(w),{class:E({"bg-yellow-100 text-yellow-800":u.estado==="pendiente","bg-green-100 text-green-800":u.estado==="aprobada","bg-red-100 text-red-800":u.estado==="rechazada"})},{default:o(()=>[m(d(u.estado),1)]),_:2},1032,["class"])]),_:2},1024),s(e(h),null,{default:o(()=>[m(d(l.formatDate(u.created_at)),1)]),_:2},1024),s(e(h),{class:"text-right"},{default:o(()=>[a("div",$t,[s(e(V),{variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:o(()=>[s(e(P),{href:c(u.contrato_id,u.id)},{default:o(()=>[s(e(at),{class:"h-4 w-4"}),t[10]||(t[10]=a("span",{class:"ml-1"},"Ver",-1))]),_:1},8,["href"])]),_:2},1024),u.archivo_url?(f(),x(e(V),{key:0,variant:"ghost",size:"sm","as-child":"",class:"h-8 px-2"},{default:o(()=>[a("a",{href:u.archivo_url,target:"_blank"},[s(e(st),{class:"h-4 w-4"}),t[11]||(t[11]=a("span",{class:"ml-1"},"Descargar",-1))],8,wt)]),_:2},1024)):v("",!0),l.modo==="admin"||l.modo==="user"&&l.puedeGestionarEstado?(f(),x(Z,{key:1,evidencia:u,"proyecto-id":l.proyectoId,"estado-actual":u.estado},null,8,["evidencia","proyecto-id","estado-actual"])):v("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})])):g.value.length===0?(f(),x(e(F),{key:2,class:"mt-4"},{default:o(()=>[s(e(I),{class:"py-8"},{default:o(()=>[a("div",Ct,[s(e(T),{class:"mx-auto h-12 w-12 text-gray-400"}),t[12]||(t[12]=a("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias cargadas",-1)),t[13]||(t[13]=a("p",{class:"text-xs text-gray-500 mt-1"},"Las evidencias se cargan desde los contratos",-1))])]),_:1})]),_:1})):(f(),x(e(F),{key:3,class:"mt-4"},{default:o(()=>[s(e(I),{class:"py-8"},{default:o(()=>[a("div",Dt,[s(e(T),{class:"mx-auto h-12 w-12 text-gray-400"}),t[14]||(t[14]=a("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias que coincidan con los filtros",-1)),t[15]||(t[15]=a("p",{class:"text-xs text-gray-500 mt-1"},"Intenta ajustar los criterios de búsqueda",-1))])]),_:1})]),_:1}))],64))}}),Et={class:"flex items-center justify-between"},It={class:"flex items-center gap-3"},Ft={class:"flex items-center gap-3"},jt={class:"space-y-2"},Lt={class:"flex justify-between text-sm"},At={class:"font-medium"},Bt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2"},Pt={class:"flex items-start gap-3"},Vt={class:"font-medium"},St={class:"text-xs text-gray-500"},Tt={key:0,class:"flex items-start gap-3"},Nt={class:"font-medium"},zt={class:"text-xs text-gray-500"},Mt={key:0,class:"flex items-center gap-3 pt-2"},Rt={class:"font-medium ml-2"},he=L({__name:"ProyectoEstadoCard",props:{estado:{},estadoLabel:{},prioridad:{},prioridadLabel:{},porcentajeCompletado:{},fechaInicio:{},fechaFin:{},duracionDias:{}},setup(l){const y=l,n=k(()=>({planificacion:nt,en_progreso:rt,pausado:mt,completado:lt,cancelado:ft})[y.estado]||it),g=k(()=>({planificacion:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",en_progreso:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",pausado:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",completado:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",cancelado:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"})[y.estado]||"bg-gray-100 text-gray-800"),$=k(()=>({baja:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",media:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",alta:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",critica:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"})[y.prioridad]||"bg-gray-100 text-gray-800"),C=b=>new Date(b).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),D=b=>{const c=Math.floor((new Date(b).getTime()-new Date().getTime())/864e5);return c===0?"Hoy":c===1?"Mañana":c===-1?"Ayer":c>0?`En ${c} días`:`Hace ${Math.abs(c)} días`};return(b,c)=>(f(),x(e(F),null,{default:o(()=>[s(e(z),null,{default:o(()=>[s(e(M),null,{default:o(()=>[...c[0]||(c[0]=[m("Estado del Proyecto",-1)])]),_:1})]),_:1}),s(e(I),{class:"space-y-4"},{default:o(()=>[a("div",Et,[a("div",It,[(f(),x(H(n.value),{class:"h-5 w-5 text-gray-500"})),c[1]||(c[1]=a("span",{class:"font-medium"},"Estado:",-1)),s(e(w),{class:E(g.value)},{default:o(()=>[m(d(l.estadoLabel),1)]),_:1},8,["class"])]),a("div",Ft,[s(e(dt),{class:"h-5 w-5 text-gray-500"}),c[2]||(c[2]=a("span",{class:"font-medium"},"Prioridad:",-1)),s(e(w),{class:E($.value)},{default:o(()=>[m(d(l.prioridadLabel),1)]),_:1},8,["class"])])]),a("div",jt,[a("div",Lt,[c[3]||(c[3]=a("span",{class:"text-gray-600 dark:text-gray-400"},"Progreso",-1)),a("span",At,d(l.porcentajeCompletado)+"%",1)]),s(e(ot),{"model-value":l.porcentajeCompletado,class:"h-2"},null,8,["model-value"])]),a("div",Bt,[a("div",Pt,[s(e(N),{class:"h-5 w-5 text-gray-500 mt-0.5"}),a("div",null,[c[4]||(c[4]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de inicio",-1)),a("p",Vt,d(C(l.fechaInicio)),1),a("p",St,d(D(l.fechaInicio)),1)])]),l.fechaFin?(f(),_("div",Tt,[s(e(N),{class:"h-5 w-5 text-gray-500 mt-0.5"}),a("div",null,[c[5]||(c[5]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de fin",-1)),a("p",Nt,d(C(l.fechaFin)),1),a("p",zt,d(D(l.fechaFin)),1)])])):v("",!0)]),l.duracionDias?(f(),_("div",Mt,[s(e(ct),{class:"h-5 w-5 text-gray-500"}),a("div",null,[c[6]||(c[6]=a("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Duración total:",-1)),a("span",Rt,d(l.duracionDias)+" días",1)])])):v("",!0)]),_:1})]),_:1}))}}),Ut={key:0},qt={class:"font-mono"},Ht={key:1},Gt={key:0,class:"flex items-center gap-3"},Ot={class:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Jt={class:"font-medium"},Kt={class:"text-sm text-gray-500"},Qt={key:1,class:"text-gray-500"},Wt={class:"font-medium"},Xt={class:"text-xs text-gray-500"},Yt={class:"text-sm"},ke=L({__name:"ProyectoInfoCard",props:{proyectoId:{},activo:{type:Boolean},responsable:{},creador:{},createdAt:{},updatedAt:{},titulo:{default:"Información del Proyecto"},showId:{type:Boolean,default:!1},showActivo:{type:Boolean,default:!1}},setup(l){const y=n=>new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"});return(n,g)=>(f(),x(e(F),null,{default:o(()=>[s(e(z),null,{default:o(()=>[s(e(M),null,{default:o(()=>[m(d(l.titulo),1)]),_:1})]),_:1}),s(e(I),{class:"space-y-4"},{default:o(()=>{var $;return[l.showId&&l.proyectoId?(f(),_("div",Ut,[g[0]||(g[0]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"ID del Proyecto",-1)),a("p",qt,"#"+d(l.proyectoId),1)])):v("",!0),l.showActivo&&l.activo!==void 0?(f(),_("div",Ht,[g[1]||(g[1]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado",-1)),s(e(w),{class:E(l.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},{default:o(()=>[m(d(l.activo?"Activo":"Inactivo"),1)]),_:1},8,["class"])])):v("",!0),a("div",null,[g[2]||(g[2]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"},"Responsable",-1)),l.responsable?(f(),_("div",Gt,[a("div",Ot,[s(e(ut),{class:"h-5 w-5 text-gray-500"})]),a("div",null,[a("p",Jt,d(l.responsable.name),1),a("p",Kt,d(l.responsable.email),1)])])):(f(),_("p",Qt,"Sin asignar"))]),a("div",null,[g[3]||(g[3]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Creado por",-1)),a("p",Wt,d((($=l.creador)==null?void 0:$.name)||"Sistema"),1),a("p",Xt,d(y(l.createdAt)),1)]),a("div",null,[g[4]||(g[4]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Última actualización",-1)),a("p",Yt,d(y(l.updatedAt)),1)])]}),_:1})]),_:1}))}});export{ke as _,he as a,pe as b};
