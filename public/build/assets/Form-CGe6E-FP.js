import{d as ee,c as V,u as oe,r as ae,p as B,i as p,e as s,f as e,q as se,w as t,g as r,t as c,h as d,l as te,j as v,n as y,m as n,F as C,k as w,b as le,s as re}from"./app-Bwo8gItk.js";import{_ as ie}from"./AdminLayout.vue_vue_type_script_setup_true_lang-YCtVpAij.js";import{_ as z,a as I,b as R,c as k}from"./CardTitle.vue_vue_type_script_setup_true_lang-CCSG5iJV.js";import{_ as $}from"./createLucideIcon-CiWTV2sr.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-1axY5i_y.js";import{_ as de}from"./Textarea.vue_vue_type_script_setup_true_lang-C7vo1im6.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-CnYuL5N8.js";import{_ as G}from"./Switch.vue_vue_type_script_setup_true_lang-D7_7I7ew.js";import{_ as ne,a as pe}from"./index-Dp--4MWG.js";import{_ as me,a as ue,b as ce,c as fe,d as _e}from"./SelectValue.vue_vue_type_script_setup_true_lang-Cbbm024S.js";import{t as q}from"./index-CeoZ0Klu.js";import{C as ve}from"./circle-alert-BjQ4nvNB.js";import{T as xe}from"./trash-2-D8-Ilnre.js";import{P as be}from"./plus-Bflq7jJP.js";import{X as ge}from"./x-BLnECrCi.js";import{S as ye}from"./save-Bzr362ud.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-Clun62gV.js";import"./index-rDJfqaGK.js";import"./floating-ui.vue-0ZArUiY9.js";import"./index-CgVSfdqX.js";import"./shield-ByLQ2f9R.js";import"./user-C6TSB5_J.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DEG_Wv36.js";import"./chevron-right-BfbIuNo5.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-aDqgcxXL.js";import"./VisuallyHidden-D4hNOF66.js";import"./index-ymXBWjcf.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BKV7xEtz.js";import"./map-pin-Ppz-XqMb.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-DoGHpuwP.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BwGPK6gw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-d1_uBanv.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BREJC4p2.js";import"./tag-CW6t7i9-.js";import"./users-B58AUZuH.js";import"./target-B1zI-nHp.js";import"./vote-C1sfV5Q9.js";import"./folder-open-BO1Ubl99.js";import"./send-DKhPmQQO.js";import"./file-text-BE7lj9lG.js";import"./briefcase-UmhjC-Iz.js";import"./calendar-Np9EKWlU.js";import"./megaphone-lNFWg1ya.js";import"./user-check-DizkiFOQ.js";import"./clipboard-list-BWeBPmBd.js";import"./mail-Ch2yZ2HC.js";import"./message-square-D0aUt5mG.js";import"./external-link-DH3_urnm.js";import"./panel-left-C0kZvL6R.js";import"./index-WQ9DFilu.js";import"./check-Y8HDg3In.js";import"./index-D73sxKyv.js";import"./VisuallyHiddenInput-Co7O63ew.js";const Ve={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Ce={class:"flex items-center justify-between"},$e={class:"text-2xl font-bold text-gray-900 dark:text-white"},he={key:0,class:"mt-1 text-sm text-red-600"},we={key:0,class:"mt-1 text-sm text-red-600"},ze={key:0,class:"mt-1 text-sm text-red-600"},ke={key:0,class:"mt-1 text-sm text-red-600"},qe={key:0,class:"mt-1 text-xs text-gray-500"},Ue={key:1,class:"mt-1 text-sm text-red-600"},Ee={key:0},Pe={class:"space-y-2"},je={key:0,class:"mt-1 text-sm text-red-600"},Se={class:"space-y-2"},Te=["id","value","checked","onChange"],Ae={key:0,class:"mt-1 text-sm text-red-600"},Ne={key:0,class:"mt-1 text-sm text-red-600"},Oe={class:"space-y-4"},De={class:"flex items-center justify-between"},Le={class:"space-y-0.5"},Fe={class:"flex items-center justify-between"},Be={class:"space-y-0.5"},Ro=ee({__name:"Form",props:{campo:{},tiposCampo:{},tipos:{},entidadesDisponibles:{}},setup(H){var E,P,j,S,T,A,N,O,D,L,F;const i=H,f=V(()=>!!i.campo),M=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:"Campos Personalizados",href:"/admin/campos-personalizados"},{title:f.value?`Editar: ${(E=i.campo)==null?void 0:E.nombre}`:"Nuevo Campo",href:"#"}],a=oe({nombre:((P=i.campo)==null?void 0:P.nombre)||"",slug:((j=i.campo)==null?void 0:j.slug)||"",tipo:((S=i.campo)==null?void 0:S.tipo)||"text",opciones:((T=i.campo)==null?void 0:T.opciones)||[],es_requerido:((A=i.campo)==null?void 0:A.es_requerido)!==void 0?i.campo.es_requerido:!1,activo:((N=i.campo)==null?void 0:N.activo)!==void 0?i.campo.activo:!0,descripcion:((O=i.campo)==null?void 0:O.descripcion)||"",placeholder:((D=i.campo)==null?void 0:D.placeholder)||"",validacion:((L=i.campo)==null?void 0:L.validacion)||"",aplicar_para:((F=i.campo)==null?void 0:F.aplicar_para)||["proyectos"]}),X=V(()=>i.tiposCampo||i.tipos||{}),J=V(()=>i.entidadesDisponibles||{proyectos:"Proyectos",contratos:"Contratos",hitos:"Hitos",entregables:"Entregables"}),b=ae(!1);B(()=>a.nombre,u=>{!f.value&&u&&(a.slug=u.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""))});const h=V(()=>["select","radio"].includes(a.tipo)),U=()=>{a.opciones.push({value:"",label:""})},K=u=>{a.opciones.splice(u,1)};B(()=>a.tipo,(u,o)=>{!h.value&&a.opciones.length>0?a.opciones=[]:h.value&&a.opciones.length===0&&U()});const Q=u=>{const o=a.aplicar_para.indexOf(u);o===-1?a.aplicar_para.push(u):a.aplicar_para.splice(o,1),a.aplicar_para.length===0&&(a.aplicar_para=["proyectos"],q.warning('Debe seleccionar al menos una entidad. Se ha seleccionado "Proyectos" por defecto.'))},W=()=>{var l;b.value=!0;const u=f.value?`/admin/campos-personalizados/${(l=i.campo)==null?void 0:l.id}`:"/admin/campos-personalizados",o=f.value?"put":"post";a[o](u,{preserveScroll:!0,onSuccess:()=>{q.success(f.value?"Campo actualizado exitosamente":"Campo creado exitosamente")},onError:m=>{q.error("Error al guardar el campo"),console.error(m)},onFinish:()=>{b.value=!1}})},Y=()=>{re.visit("/admin/campos-personalizados")},Z=u=>({text:"min:3|max:255|alpha_dash",number:"numeric|min:0|max:1000",date:"date|after:today|before:2030-12-31",textarea:"min:10|max:5000",file:"mimes:pdf,doc,docx|max:10240"})[u]||"";return(u,o)=>(n(),p(C,null,[s(e(se),{title:f.value?"Editar Campo Personalizado":"Nuevo Campo Personalizado"},null,8,["title"]),s(ie,{breadcrumbs:M},{default:t(()=>[r("div",Ve,[r("div",Ce,[r("h1",$e,c(f.value?"Editar Campo Personalizado":"Nuevo Campo Personalizado"),1)]),s(e(ne),null,{default:t(()=>[s(e(ve),{class:"h-4 w-4"}),s(e(pe),null,{default:t(()=>[...o[8]||(o[8]=[d(" Los campos personalizados permiten agregar información adicional a los proyectos. Una vez creado, el campo estará disponible en todos los formularios de proyectos. ",-1)])]),_:1})]),_:1}),r("form",{onSubmit:te(W,["prevent"]),class:"space-y-6"},[s(e(z),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(R),null,{default:t(()=>[...o[9]||(o[9]=[d("Información del Campo",-1)])]),_:1})]),_:1}),s(e(k),{class:"space-y-4"},{default:t(()=>[r("div",null,[s(e(_),{for:"nombre"},{default:t(()=>[...o[10]||(o[10]=[d("Nombre del Campo *",-1)])]),_:1}),s(e(x),{id:"nombre",modelValue:e(a).nombre,"onUpdate:modelValue":o[0]||(o[0]=l=>e(a).nombre=l),type:"text",placeholder:"Ej: Presupuesto estimado",class:y({"border-red-500":e(a).errors.nombre}),required:""},null,8,["modelValue","class"]),e(a).errors.nombre?(n(),p("p",he,c(e(a).errors.nombre),1)):v("",!0)]),r("div",null,[s(e(_),{for:"slug"},{default:t(()=>[...o[11]||(o[11]=[d("Identificador (slug) *",-1)])]),_:1}),s(e(x),{id:"slug",modelValue:e(a).slug,"onUpdate:modelValue":o[1]||(o[1]=l=>e(a).slug=l),type:"text",placeholder:"presupuesto_estimado",class:y({"border-red-500":e(a).errors.slug}),disabled:f.value,required:""},null,8,["modelValue","class","disabled"]),o[12]||(o[12]=r("p",{class:"mt-1 text-xs text-gray-500"}," Identificador único del campo. Solo letras minúsculas, números y guiones bajos. ",-1)),e(a).errors.slug?(n(),p("p",we,c(e(a).errors.slug),1)):v("",!0)]),r("div",null,[s(e(_),{for:"descripcion"},{default:t(()=>[...o[13]||(o[13]=[d("Descripción",-1)])]),_:1}),s(e(de),{id:"descripcion",modelValue:e(a).descripcion,"onUpdate:modelValue":o[2]||(o[2]=l=>e(a).descripcion=l),placeholder:"Texto de ayuda para el usuario",rows:"2",class:y({"border-red-500":e(a).errors.descripcion})},null,8,["modelValue","class"]),e(a).errors.descripcion?(n(),p("p",ze,c(e(a).errors.descripcion),1)):v("",!0)]),r("div",null,[s(e(_),{for:"placeholder"},{default:t(()=>[...o[14]||(o[14]=[d("Texto de Placeholder",-1)])]),_:1}),s(e(x),{id:"placeholder",modelValue:e(a).placeholder,"onUpdate:modelValue":o[3]||(o[3]=l=>e(a).placeholder=l),type:"text",placeholder:"Texto que aparece cuando el campo está vacío",class:y({"border-red-500":e(a).errors.placeholder})},null,8,["modelValue","class"]),e(a).errors.placeholder?(n(),p("p",ke,c(e(a).errors.placeholder),1)):v("",!0)])]),_:1})]),_:1}),s(e(z),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(R),null,{default:t(()=>[...o[15]||(o[15]=[d("Configuración",-1)])]),_:1})]),_:1}),s(e(k),{class:"space-y-4"},{default:t(()=>[r("div",null,[s(e(_),{for:"tipo"},{default:t(()=>[...o[16]||(o[16]=[d("Tipo de Campo *",-1)])]),_:1}),s(e(me),{modelValue:e(a).tipo,"onUpdate:modelValue":o[4]||(o[4]=l=>e(a).tipo=l),disabled:f.value},{default:t(()=>[s(e(ue),null,{default:t(()=>[s(e(ce),{placeholder:"Seleccione el tipo"})]),_:1}),s(e(fe),null,{default:t(()=>[(n(!0),p(C,null,w(X.value,(l,m)=>(n(),le(e(_e),{key:m,value:m},{default:t(()=>[d(c(l),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),f.value?(n(),p("p",qe," El tipo no puede ser modificado después de crear el campo. ")):v("",!0),e(a).errors.tipo?(n(),p("p",Ue,c(e(a).errors.tipo),1)):v("",!0)]),h.value?(n(),p("div",Ee,[s(e(_),null,{default:t(()=>[...o[17]||(o[17]=[d("Opciones *",-1)])]),_:1}),r("div",Pe,[(n(!0),p(C,null,w(e(a).opciones,(l,m)=>(n(),p("div",{key:m,class:"flex gap-2"},[s(e(x),{modelValue:l.value,"onUpdate:modelValue":g=>l.value=g,placeholder:"Valor",class:"w-1/3",required:""},null,8,["modelValue","onUpdate:modelValue"]),s(e(x),{modelValue:l.label,"onUpdate:modelValue":g=>l.label=g,placeholder:"Etiqueta",class:"flex-1",required:""},null,8,["modelValue","onUpdate:modelValue"]),s(e($),{type:"button",variant:"destructive",size:"sm",onClick:g=>K(m),disabled:e(a).opciones.length===1},{default:t(()=>[s(e(xe),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])]))),128)),s(e($),{type:"button",variant:"outline",size:"sm",onClick:U},{default:t(()=>[s(e(be),{class:"mr-2 h-4 w-4"}),o[18]||(o[18]=d(" Agregar Opción ",-1))]),_:1})]),e(a).errors.opciones?(n(),p("p",je,c(e(a).errors.opciones),1)):v("",!0)])):v("",!0),r("div",null,[s(e(_),null,{default:t(()=>[...o[19]||(o[19]=[d("Aplicar a:",-1)])]),_:1}),r("div",Se,[(n(!0),p(C,null,w(J.value,(l,m)=>(n(),p("div",{key:m,class:"flex items-center space-x-2"},[r("input",{type:"checkbox",id:`aplicar_${m}`,value:m,checked:e(a).aplicar_para.includes(m),onChange:g=>Q(m),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Te),s(e(_),{for:`aplicar_${m}`,class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},{default:t(()=>[d(c(l),1)]),_:2},1032,["for"])]))),128))]),o[20]||(o[20]=r("p",{class:"mt-1 text-xs text-gray-500"}," Seleccione dónde estará disponible este campo personalizado. ",-1)),e(a).errors.aplicar_para?(n(),p("p",Ae,c(e(a).errors.aplicar_para),1)):v("",!0)]),r("div",null,[s(e(_),{for:"validacion"},{default:t(()=>[...o[21]||(o[21]=[d("Reglas de Validación (Laravel)",-1)])]),_:1}),s(e(x),{id:"validacion",modelValue:e(a).validacion,"onUpdate:modelValue":o[5]||(o[5]=l=>e(a).validacion=l),type:"text",placeholder:Z(e(a).tipo),class:y({"border-red-500":e(a).errors.validacion})},null,8,["modelValue","placeholder","class"]),o[22]||(o[22]=r("p",{class:"mt-1 text-xs text-gray-500"}," Opcional. Usa sintaxis de Laravel. Ej: min:3|max:255 ",-1)),e(a).errors.validacion?(n(),p("p",Ne,c(e(a).errors.validacion),1)):v("",!0)]),r("div",Oe,[r("div",De,[r("div",Le,[s(e(_),{for:"es_requerido"},{default:t(()=>[...o[23]||(o[23]=[d("Campo Requerido",-1)])]),_:1}),o[24]||(o[24]=r("p",{class:"text-xs text-gray-500"}," Los usuarios deberán completar este campo obligatoriamente ",-1))]),s(e(G),{id:"es_requerido",modelValue:e(a).es_requerido,"onUpdate:modelValue":o[6]||(o[6]=l=>e(a).es_requerido=l)},null,8,["modelValue"])]),r("div",Fe,[r("div",Be,[s(e(_),{for:"activo"},{default:t(()=>[...o[25]||(o[25]=[d("Campo Activo",-1)])]),_:1}),o[26]||(o[26]=r("p",{class:"text-xs text-gray-500"}," Solo los campos activos se muestran en los formularios ",-1))]),s(e(G),{id:"activo",modelValue:e(a).activo,"onUpdate:modelValue":o[7]||(o[7]=l=>e(a).activo=l)},null,8,["modelValue"])])])]),_:1})]),_:1}),s(e(z),null,{default:t(()=>[s(e(k),{class:"flex justify-end gap-4 pt-6"},{default:t(()=>[s(e($),{type:"button",variant:"outline",onClick:Y,disabled:b.value},{default:t(()=>[s(e(ge),{class:"mr-2 h-4 w-4"}),o[27]||(o[27]=d(" Cancelar ",-1))]),_:1},8,["disabled"]),s(e($),{type:"submit",disabled:b.value||e(a).processing},{default:t(()=>[s(e(ye),{class:"mr-2 h-4 w-4"}),d(" "+c(b.value?"Guardando...":f.value?"Actualizar Campo":"Crear Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})],32)])]),_:1})],64))}});export{Ro as default};
