import{_ as $}from"./index-BTN_CKnm.js";import{c as qe,_ as C}from"./createLucideIcon-BfVy0SFr.js";import{a as V,b as j,c as z,_ as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-CfXCxct6.js";import{_ as De}from"./CardDescription.vue_vue_type_script_setup_true_lang-R8khDAHy.js";import{_ as He,a as Me,b as ae,c as E,d as Ne,e as U}from"./TableHeader.vue_vue_type_script_setup_true_lang-jYPOFVXR.js";import{_ as Te,C as ne}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-BC33EdiF.js";import{_ as Be}from"./CsvImportWizard.vue_vue_type_script_setup_true_lang-C22gBzSt.js";import{d as _e,k as y,p as ge,j as k,o as r,e as s,b as t,u as a,f as o,i as x,g as n,t as d,a as p,F as J,r as te,W as I,l as Le,n as B,c as Re,w as re,m as Qe,q as de}from"./app-DDSU5uN7.js";import{H as se}from"./history-BSPldOny.js";import{F as be,t as P}from"./index-DlY_kZJS.js";import{C as ye}from"./circle-x-CjVX7zYh.js";import{C as xe}from"./circle-check-big-Yv2DJF0V.js";import{C as le}from"./clock-DFrTRM55.js";import{U as Oe,_ as We,a as Xe,b as Ge,c as Je,d as Ke,e as Ye}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CtnWlOEt.js";import{_ as ue,a as ce,b as me,c as pe,d as T}from"./SelectValue.vue_vue_type_script_setup_true_lang-DhdtXOhv.js";import{_ as Ze}from"./Input.vue_vue_type_script_setup_true_lang-DloUOX4w.js";import{_ as fe}from"./Checkbox.vue_vue_type_script_setup_true_lang-B1pi0cAi.js";import{_ as ea}from"./AppLayout.vue_vue_type_script_setup_true_lang-C7XcGlX4.js";import{A as aa}from"./arrow-left-BDJyv-QG.js";import{S as ta}from"./square-pen-hslCxcmZ.js";import{C as sa}from"./calendar-BerL1z25.js";import{M as la}from"./map-pin-4Kefx8iA.js";import{U as ia}from"./user-plus-CU9l0lsw.js";import{U as oa}from"./upload-BJYzk81a.js";import{C as ve}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BUWx5DM7.js";import{f as na,e as ra}from"./es-DfN3vIXC.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-Cno_7lac.js";import"./VisuallyHidden-bGJF1x_r.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-B-fQpJwR.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-CLuZ5cny.js";import"./loader-circle-DsF-i-yL.js";import"./trash-2-D_0HhvER.js";import"./plus-C2GsDtN_.js";import"./search-D6-CBIl5.js";import"./check-Cnad2drU.js";import"./save-D7KdBMYf.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-CnGQ_xel.js";import"./RovingFocusItem-BFrOkdA9.js";import"./utils-DesyTqqv.js";import"./Label.vue_vue_type_script_setup_true_lang-B6qLE2NP.js";import"./index-BaCJCCFv.js";import"./git-branch-BTI-jgEr.js";import"./index-APndk64q.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-B-HIcCfq.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-D_RAhnKd.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=qe("UserMinusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ua={class:"flex items-center gap-2"},ca={key:0,class:"flex justify-center py-6"},ma={key:1,class:"text-center py-6 text-muted-foreground"},pa={key:2,class:"space-y-3"},fa=["onClick"],va={class:"flex items-center gap-3"},_a={class:"font-medium text-sm"},ga={class:"text-xs text-muted-foreground"},ba={class:"flex items-center gap-3"},ya={class:"text-right text-sm"},xa={class:"text-xs text-muted-foreground mt-1"},ka={key:0},$a={key:1},ha={key:2},wa=_e({__name:"ImportHistory",props:{type:{},entityId:{},title:{default:"Historial de Importaciones"}},setup(K,{expose:h}){const S=K,w=y([]),g=y(!1),_=async()=>{if(S.entityId){g.value=!0;try{const b=S.type==="votacion"?`/admin/votaciones/${S.entityId}/imports/recent`:`/admin/asambleas/${S.entityId}/imports/recent`,f=await fetch(b);if(f.ok){const m=await f.json();w.value=m}}catch(b){console.error("Error loading recent imports:",b)}finally{g.value=!1}}},L=b=>{I.get(`/admin/imports/${b}`)},q=()=>{const b=S.type==="votacion"?`/admin/votaciones/${S.entityId}/imports`:`/admin/asambleas/${S.entityId}/imports`;I.get(b)},D=b=>{switch(b){case"pending":return{icon:le,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:le,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:xe,label:"Completada",class:"text-green-600"};case"failed":return{icon:ye,label:"Fallida",class:"text-red-600"}}},A=b=>new Date(b).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return ge(()=>{_()}),h({loadRecentImports:_}),(b,f)=>(r(),k(a(F),null,{default:s(()=>[t(a(V),null,{default:s(()=>[t(a(j),{class:"flex items-center justify-between"},{default:s(()=>[o("span",ua,[t(a(se),{class:"h-5 w-5"}),n(" "+d(b.title),1)]),w.value.length>0?(r(),k(a(C),{key:0,variant:"outline",size:"sm",onClick:q},{default:s(()=>f[0]||(f[0]=[n(" Ver Todas ")])),_:1})):x("",!0)]),_:1})]),_:1}),t(a(z),null,{default:s(()=>[g.value?(r(),p("div",ca,f[1]||(f[1]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):w.value.length===0?(r(),p("div",ma,[t(a(se),{class:"mx-auto h-8 w-8 mb-2"}),f[2]||(f[2]=o("p",null,"No hay importaciones registradas",-1)),f[3]||(f[3]=o("p",{class:"text-sm"},"Las importaciones aparecerán aquí una vez que subas archivos CSV",-1))])):(r(),p("div",pa,[(r(!0),p(J,null,te(w.value,m=>(r(),p("div",{key:m.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:R=>L(m.id)},[o("div",va,[(r(),k(Le(D(m.status).icon),{class:B(["h-4 w-4",D(m.status).class])},null,8,["class"])),o("div",null,[o("p",_a,d(m.name||m.original_filename),1),o("p",ga,d(A(m.created_at))+" • Por "+d(m.created_by.name),1)])]),o("div",ba,[o("div",ya,[t(a($),{variant:"outline",class:B(D(m.status).class)},{default:s(()=>[n(d(D(m.status).label),1)]),_:2},1032,["class"]),o("p",xa,[m.status==="processing"?(r(),p("span",ka,d(m.progress_percentage)+"% ",1)):m.status==="completed"?(r(),p("span",$a,d(m.successful_rows)+"/"+d(m.total_rows||m.successful_rows+m.failed_rows)+" registros ",1)):m.status==="failed"&&m.failed_rows>0?(r(),p("span",ha,d(m.failed_rows)+" errores ",1)):x("",!0)])]),t(a(be),{class:"h-4 w-4 text-gray-400"})])],8,fa))),128))]))]),_:1})]),_:1}))}}),Ca={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Pa={class:"flex items-center justify-between"},Sa={class:"text-3xl font-bold"},Aa={class:"mt-2 flex items-center gap-2"},Ia={class:"flex gap-2"},Ua={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Ea={class:"space-y-2"},Va={class:"flex items-center gap-2 text-sm"},ja={class:"flex items-center gap-2 text-sm"},za={class:"text-sm font-medium"},Fa={class:"space-y-2"},qa={class:"flex items-center gap-2 text-sm"},Da={class:"text-sm text-muted-foreground"},Ha={class:"space-y-2"},Ma={class:"flex items-center gap-2"},Na={class:"text-2xl font-bold"},Ta={class:"text-sm"},Ba={class:"flex items-center justify-between"},La={key:0,class:"flex gap-2"},Ra={key:0,class:"mb-4 flex gap-2"},Qa={key:3,class:"flex justify-center py-8"},Oa={key:0,class:"flex items-center gap-2"},Wa={class:"relative"},Xa={key:0,class:"absolute inset-0 flex items-center justify-center"},Ga={key:0,class:"text-green-600 transition-all duration-300"},Ja={key:1,class:"text-gray-400 transition-all duration-300"},Ka={key:1},Ya={key:0},Za={key:1},et={class:"flex justify-end gap-2"},at={key:5,class:"flex items-center justify-between mt-4"},tt={class:"text-sm text-muted-foreground"},st={key:0,class:"flex items-center space-x-2"},lt={class:"text-sm"},it=["href"],ot={class:"space-y-4"},nt={class:"grid gap-4 md:grid-cols-2"},rt={class:"max-h-96 overflow-y-auto border rounded-lg p-4"},dt={key:0,class:"flex justify-center py-8"},ut={key:1},ct=["for"],mt={class:"text-sm font-medium"},pt={class:"text-xs text-muted-foreground"},ft={key:0},vt={key:1},_t={key:0,class:"mt-4 flex justify-center gap-2"},gt={class:"flex items-center px-2 text-sm"},bt={key:2,class:"text-center text-muted-foreground py-4"},yt={class:"flex items-center justify-between w-full"},xt={key:0,class:"text-sm text-muted-foreground"},kt={class:"flex gap-2"},fs=_e({__name:"Show",props:{asamblea:{},puede_gestionar_participantes:{type:Boolean},filterFieldsConfig:{}},setup(K){const h=K,S=[{title:"Admin",href:"/admin/dashboard"},{title:"Asambleas",href:"/admin/asambleas"},{title:h.asamblea.nombre,href:"#"}],{route:w}=window,g=y([]),_=y({current_page:1,last_page:1,per_page:20,total:0,from:0,to:0}),L=y(!1),q=y({}),D={fields:h.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por nombre o email...",quickSearchFields:["users.name","users.email"],maxNestingLevel:1,allowSaveFilters:!1,debounceTime:500,autoApply:!1},A=y(!1),b=y([]),f=y(null),m=y([]),R=y("asistente"),H=y(""),Y=y(!1),ie=y(!1),M=y(null),O=y(!1),W=y(!1),ke=y([]),Z=y(null),$e=i=>i?na(new Date(i),"PPPpp",{locale:ra}):"",he=i=>{switch(i){case"moderador":return"bg-purple-100 text-purple-800";case"secretario":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},X=Re(()=>{const i=g.value.filter(c=>{var v;return((v=c.pivot)==null?void 0:v.tipo_participacion)==="moderador"}).length,e=g.value.filter(c=>{var v;return((v=c.pivot)==null?void 0:v.tipo_participacion)==="secretario"}).length,l=g.value.filter(c=>{var v;return((v=c.pivot)==null?void 0:v.tipo_participacion)==="asistente"}).length,u=g.value.filter(c=>{var v;return((v=c.pivot)==null?void 0:v.asistio)===!0}).length;return{moderadores:i,secretarios:e,asistentes:l,presentes:u,total:_.value.total||0}}),N=async(i=1,e={})=>{L.value=!0;try{const l={page:i,...e},u=await de.get(w("admin.asambleas.participantes-list",h.asamblea.id),{params:l});g.value=u.data.participantes.data.map(c=>({...c,pivot:{tenant_id:c.tenant_id,tipo_participacion:c.tipo_participacion||"asistente",asistio:c.asistio===1||c.asistio===!0||c.asistio==="1",hora_registro:c.hora_registro}})),_.value={current_page:u.data.participantes.current_page,last_page:u.data.participantes.last_page,per_page:u.data.participantes.per_page,total:u.data.participantes.total,from:u.data.participantes.from,to:u.data.participantes.to}}catch(l){console.error("Error cargando participantes:",l)}finally{L.value=!1}},oe=i=>{N(i,q.value)},we=i=>{q.value=i,N(1,i)},Ce=()=>{q.value={},N(1,{})},G=async(i=1)=>{Y.value=!0;try{const e=await de.get(w("admin.asambleas.manage-participantes",h.asamblea.id),{params:{search:H.value,page:i}});e.data.participantes_disponibles.data?(b.value=e.data.participantes_disponibles.data,f.value={current_page:e.data.participantes_disponibles.current_page,last_page:e.data.participantes_disponibles.last_page,total:e.data.participantes_disponibles.total}):b.value=[]}catch(e){console.error("Error buscando participantes:",e),P.error("Error al buscar participantes",{description:"Por favor intenta nuevamente",duration:3e3}),b.value=[]}finally{Y.value=!1}},Pe=()=>{A.value=!0,ie.value||(ie.value=!0,G())};let ee=null;re(H,()=>{ee&&clearTimeout(ee),ee=setTimeout(()=>{A.value&&G()},500)}),re(A,i=>{i||(m.value=[],H.value="",R.value="asistente")});const Se=()=>{if(m.value.length===0)return;const i=m.value.length;I.post(w("admin.asambleas.manage-participantes",h.asamblea.id),{participante_ids:m.value,tipo_participacion:R.value},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{A.value=!1,P.success(`${i} participante(s) añadido(s) exitosamente`,{duration:2e3}),N(_.value.current_page,q.value)},onError:()=>{P.error("Error al añadir participantes",{description:"Por favor intenta nuevamente",duration:3e3})}})},Ae=i=>{const e=g.value.find(v=>v.id===i),l=(e==null?void 0:e.name)||"Participante";if(!confirm(`¿Estás seguro de remover a ${l} de la asamblea?`))return;const u=g.value.findIndex(v=>v.id===i),c=g.value[u];u!==-1&&(g.value.splice(u,1),_.value.total-=1),I.delete(w("admin.asambleas.manage-participantes",h.asamblea.id),{data:{participante_id:i},preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{P.success(`${l} removido de la asamblea`,{duration:2e3})},onError:()=>{c&&u!==-1&&(g.value.splice(u,0,c),_.value.total+=1),P.error("Error al remover participante",{duration:3e3})}})},Ie=(i,e)=>{var v;const l=g.value.find(Q=>Q.id===i),u=(l==null?void 0:l.name)||"Participante",c=(v=l==null?void 0:l.pivot)==null?void 0:v.tipo_participacion;l&&l.pivot&&(l.pivot.tipo_participacion=e),I.put(w("admin.asambleas.manage-participantes",h.asamblea.id),{participante_id:i,tipo_participacion:e},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{const Q=e.charAt(0).toUpperCase()+e.slice(1);P.success(`${u} asignado como ${Q}`,{duration:2e3})},onError:()=>{l&&l.pivot&&c&&(l.pivot.tipo_participacion=c),P.error("Error al actualizar el tipo de participación",{duration:3e3})}})},Ue=(i,e)=>{if(M.value===i)return;M.value=i;const l=g.value.find(c=>c.id===i),u=(l==null?void 0:l.name)||"Participante";l&&l.pivot&&(l.pivot.asistio,l.pivot.asistio=e,e?l.pivot.hora_registro=new Date().toISOString():l.pivot.hora_registro=null),I.put(w("admin.asambleas.manage-participantes",h.asamblea.id),{participante_id:i,asistio:e},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{e?P.success(`${u} marcado como presente`,{duration:2e3}):P.info(`${u} marcado como ausente`,{duration:2e3})},onError:()=>{l&&l.pivot&&(l.pivot.asistio=!e,l.pivot.hora_registro=null),P.error("Error al actualizar la asistencia",{description:"Por favor intenta nuevamente",duration:3e3})},onFinish:()=>{M.value=null}})},Ee=()=>{I.visit(w("admin.asambleas.edit",h.asamblea.id))},Ve=()=>{I.visit(w("admin.asambleas.index"))},je=async()=>{var i;if((i=h.asamblea)!=null&&i.id)try{const e=await fetch(`/admin/asambleas/${h.asamblea.id}/imports/recent`);ke.value=await e.json()}catch(e){console.error("Error cargando importaciones recientes:",e)}},ze=i=>{O.value=!1,je(),N(),Z.value&&Z.value.loadRecentImports(),I.get(`/admin/imports/${i}`)},Fe=()=>{O.value=!1};return ge(()=>{N()}),(i,e)=>(r(),p(J,null,[t(a(Qe),{title:`Asamblea: ${i.asamblea.nombre}`},null,8,["title"]),t(ea,{breadcrumbs:S},{default:s(()=>[o("div",Ca,[o("div",Pa,[o("div",null,[o("h1",Sa,d(i.asamblea.nombre),1),o("div",Aa,[t(a($),{class:B(i.asamblea.estado_color)},{default:s(()=>[n(d(i.asamblea.estado_label),1)]),_:1},8,["class"]),t(a($),{class:B(i.asamblea.tipo==="ordinaria"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800")},{default:s(()=>[n(d(i.asamblea.tipo_label),1)]),_:1},8,["class"]),i.asamblea.activo?(r(),k(a($),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>e[10]||(e[10]=[n(" Activa ")])),_:1})):(r(),k(a($),{key:1,class:"bg-red-100 text-red-800"},{default:s(()=>e[11]||(e[11]=[n(" Inactiva ")])),_:1}))])]),o("div",Ia,[t(a(C),{variant:"outline",onClick:Ve},{default:s(()=>[t(a(aa),{class:"mr-2 h-4 w-4"}),e[12]||(e[12]=n(" Volver "))]),_:1}),t(a(C),{onClick:Ee},{default:s(()=>[t(a(ta),{class:"mr-2 h-4 w-4"}),e[13]||(e[13]=n(" Editar "))]),_:1})])]),o("div",Ua,[t(a(F),null,{default:s(()=>[t(a(V),{class:"pb-3"},{default:s(()=>[t(a(j),{class:"text-sm font-medium"},{default:s(()=>e[14]||(e[14]=[n("Fechas")])),_:1})]),_:1}),t(a(z),null,{default:s(()=>[o("div",Ea,[o("div",Va,[t(a(sa),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.rango_fechas),1)]),o("div",ja,[t(a(le),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,"Duración: "+d(i.asamblea.duracion),1)]),o("p",za,d(i.asamblea.tiempo_restante),1)])]),_:1})]),_:1}),t(a(F),null,{default:s(()=>[t(a(V),{class:"pb-3"},{default:s(()=>[t(a(j),{class:"text-sm font-medium"},{default:s(()=>e[15]||(e[15]=[n("Ubicación")])),_:1})]),_:1}),t(a(z),null,{default:s(()=>[o("div",Fa,[o("div",qa,[t(a(la),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.lugar||"No especificado"),1)]),o("p",Da,d(i.asamblea.ubicacion_completa),1)])]),_:1})]),_:1}),t(a(F),null,{default:s(()=>[t(a(V),{class:"pb-3"},{default:s(()=>[t(a(j),{class:"text-sm font-medium"},{default:s(()=>e[16]||(e[16]=[n("Quórum")])),_:1})]),_:1}),t(a(z),null,{default:s(()=>[o("div",Ha,[o("div",Ma,[t(a(Oe),{class:"h-4 w-4 text-muted-foreground"}),o("span",Na,d(i.asamblea.asistentes_count)+" / "+d(i.asamblea.quorum_minimo||"∞"),1)]),i.asamblea.alcanza_quorum?(r(),k(a($),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[t(a(xe),{class:"mr-1 h-3 w-3"}),e[17]||(e[17]=n(" Quórum alcanzado "))]),_:1})):i.asamblea.quorum_minimo?(r(),k(a($),{key:1,class:"bg-yellow-100 text-yellow-800"},{default:s(()=>[t(a(ye),{class:"mr-1 h-3 w-3"}),e[18]||(e[18]=n(" Quórum no alcanzado "))]),_:1})):x("",!0)])]),_:1})]),_:1})]),i.asamblea.descripcion?(r(),k(a(F),{key:0},{default:s(()=>[t(a(V),null,{default:s(()=>[t(a(j),null,{default:s(()=>e[19]||(e[19]=[n("Descripción")])),_:1})]),_:1}),t(a(z),null,{default:s(()=>[o("p",Ta,d(i.asamblea.descripcion),1)]),_:1})]),_:1})):x("",!0),t(Te,{config:D,onApply:we,onClear:Ce}),t(a(F),null,{default:s(()=>[t(a(V),null,{default:s(()=>[o("div",Ba,[o("div",null,[t(a(j),null,{default:s(()=>e[20]||(e[20]=[n("Participantes")])),_:1}),t(a(De),null,{default:s(()=>[n(d(i.asamblea.participantes_count)+" participantes registrados ",1)]),_:1})]),g.value.length>0?(r(),p("div",La,[t(a($),{variant:"outline"},{default:s(()=>[n(" Moderadores: "+d(X.value.moderadores),1)]),_:1}),t(a($),{variant:"outline"},{default:s(()=>[n(" Secretarios: "+d(X.value.secretarios),1)]),_:1}),t(a($),{variant:"outline"},{default:s(()=>[n(" Asistentes: "+d(X.value.asistentes),1)]),_:1}),t(a($),{variant:"outline"},{default:s(()=>[n(" Presentes: "+d(X.value.presentes),1)]),_:1})])):x("",!0)])]),_:1}),t(a(z),null,{default:s(()=>[i.puede_gestionar_participantes?(r(),p("div",Ra,[t(a(C),{onClick:Pe},{default:s(()=>[t(a(ia),{class:"mr-2 h-4 w-4"}),e[21]||(e[21]=n(" Añadir Participantes "))]),_:1}),t(a(C),{variant:"outline",onClick:e[0]||(e[0]=l=>O.value=!0)},{default:s(()=>[t(a(oa),{class:"mr-2 h-4 w-4"}),e[22]||(e[22]=n(" Importar CSV "))]),_:1}),t(a(C),{variant:"outline",onClick:e[1]||(e[1]=l=>W.value=!W.value)},{default:s(()=>[t(a(se),{class:"mr-2 h-4 w-4"}),n(" "+d(W.value?"Ocultar":"Ver")+" Historial ",1)]),_:1})])):x("",!0),O.value?(r(),k(Be,{key:1,mode:"asamblea","asamblea-id":i.asamblea.id,"asamblea-titulo":i.asamblea.nombre,"redirect-on-success":!0,onSuccess:ze,onCancel:Fe,class:"mb-4"},null,8,["asamblea-id","asamblea-titulo"])):x("",!0),W.value?(r(),k(wa,{key:2,ref_key:"importHistoryRef",ref:Z,type:"asamblea","entity-id":i.asamblea.id,title:"Historial de Importaciones",class:"mb-4"},null,8,["entity-id"])):x("",!0),L.value?(r(),p("div",Qa,e[23]||(e[23]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):(r(),k(a(He),{key:4},{default:s(()=>[t(a(Me),null,{default:s(()=>[t(a(ae),null,{default:s(()=>[t(a(E),null,{default:s(()=>e[24]||(e[24]=[n("Nombre")])),_:1}),t(a(E),null,{default:s(()=>e[25]||(e[25]=[n("Email")])),_:1}),t(a(E),null,{default:s(()=>e[26]||(e[26]=[n("Tipo de Participación")])),_:1}),t(a(E),null,{default:s(()=>e[27]||(e[27]=[n("Asistencia")])),_:1}),t(a(E),null,{default:s(()=>e[28]||(e[28]=[n("Hora de Registro")])),_:1}),t(a(E),null,{default:s(()=>e[29]||(e[29]=[n("Registrado por")])),_:1}),i.puede_gestionar_participantes?(r(),k(a(E),{key:0,class:"text-right"},{default:s(()=>e[30]||(e[30]=[n("Acciones")])),_:1})):x("",!0)]),_:1})]),_:1}),t(a(Ne),null,{default:s(()=>[(r(!0),p(J,null,te(g.value,l=>(r(),k(a(ae),{key:l.id},{default:s(()=>[t(a(U),{class:"font-medium"},{default:s(()=>[n(d(l.name),1)]),_:2},1024),t(a(U),null,{default:s(()=>[n(d(l.email),1)]),_:2},1024),t(a(U),null,{default:s(()=>{var u;return[t(a($),{class:B(he(((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente"))},{default:s(()=>{var c;return[n(d(((c=l.pivot)==null?void 0:c.tipo_participacion)||"asistente"),1)]}),_:2},1032,["class"])]}),_:2},1024),t(a(U),null,{default:s(()=>{var u,c,v;return[i.puede_gestionar_participantes&&i.asamblea.estado==="en_curso"?(r(),p("div",Oa,[o("div",Wa,[t(a(fe),{checked:((u=l.pivot)==null?void 0:u.asistio)||!1,disabled:M.value===l.id,"onUpdate:checked":Q=>Ue(l.id,Q),class:B(M.value===l.id?"opacity-50":"")},null,8,["checked","disabled","onUpdate:checked","class"]),M.value===l.id?(r(),p("div",Xa,e[31]||(e[31]=[o("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary"},null,-1)]))):x("",!0)]),(c=l.pivot)!=null&&c.asistio?(r(),p("span",Ga," Presente ")):(r(),p("span",Ja," Ausente "))])):(r(),p("div",Ka,[(v=l.pivot)!=null&&v.asistio?(r(),k(a($),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>e[32]||(e[32]=[n(" Presente ")])),_:1})):(r(),k(a($),{key:1,variant:"outline"},{default:s(()=>e[33]||(e[33]=[n(" Ausente ")])),_:1}))]))]}),_:2},1024),t(a(U),null,{default:s(()=>{var u;return[n(d((u=l.pivot)!=null&&u.hora_registro?$e(l.pivot.hora_registro):"-"),1)]}),_:2},1024),t(a(U),null,{default:s(()=>{var u;return[(u=l.pivot)!=null&&u.updated_by?(r(),p("span",Ya,d(l.pivot.updated_by===l.id?"Auto-registro":l.pivot.updated_by_name||"Admin"),1)):(r(),p("span",Za,"-"))]}),_:2},1024),i.puede_gestionar_participantes?(r(),k(a(U),{key:0,class:"text-right"},{default:s(()=>{var u;return[o("div",et,[t(a(ue),{"model-value":((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente","onUpdate:modelValue":c=>Ie(l.id,c)},{default:s(()=>[t(a(ce),{class:"w-32"},{default:s(()=>[t(a(me))]),_:1}),t(a(pe),null,{default:s(()=>[t(a(T),{value:"asistente"},{default:s(()=>e[34]||(e[34]=[n("Asistente")])),_:1}),t(a(T),{value:"moderador"},{default:s(()=>e[35]||(e[35]=[n("Moderador")])),_:1}),t(a(T),{value:"secretario"},{default:s(()=>e[36]||(e[36]=[n("Secretario")])),_:1})]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"]),t(a(C),{variant:"ghost",size:"sm",onClick:c=>Ae(l.id)},{default:s(()=>[t(a(da),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])]}),_:2},1024)):x("",!0)]),_:2},1024))),128)),g.value.length===0?(r(),k(a(ae),{key:0},{default:s(()=>[t(a(U),{colspan:"6",class:"text-center py-8"},{default:s(()=>e[37]||(e[37]=[o("p",{class:"text-muted-foreground"},"No hay participantes registrados",-1)])),_:1})]),_:1})):x("",!0)]),_:1})]),_:1})),_.value.total>0?(r(),p("div",at,[o("div",tt," Mostrando "+d(_.value.from)+" a "+d(_.value.to)+" de "+d(_.value.total)+" resultados ",1),_.value.last_page>1?(r(),p("div",st,[t(a(C),{variant:"outline",size:"sm",disabled:_.value.current_page===1,onClick:e[2]||(e[2]=l=>oe(_.value.current_page-1))},{default:s(()=>[t(a(ne),{class:"h-4 w-4"}),e[38]||(e[38]=n(" Anterior "))]),_:1},8,["disabled"]),o("div",lt," Página "+d(_.value.current_page)+" de "+d(_.value.last_page),1),t(a(C),{variant:"outline",size:"sm",disabled:_.value.current_page===_.value.last_page,onClick:e[3]||(e[3]=l=>oe(_.value.current_page+1))},{default:s(()=>[e[39]||(e[39]=n(" Siguiente ")),t(a(ve),{class:"h-4 w-4"})]),_:1},8,["disabled"])])):x("",!0)])):x("",!0)]),_:1})]),_:1}),i.asamblea.acta_url?(r(),k(a(F),{key:1},{default:s(()=>[t(a(V),null,{default:s(()=>[t(a(j),null,{default:s(()=>e[40]||(e[40]=[n("Acta de la Asamblea")])),_:1})]),_:1}),t(a(z),null,{default:s(()=>[o("a",{href:i.asamblea.acta_url,target:"_blank",class:"flex items-center gap-2 text-blue-600 hover:underline"},[t(a(be),{class:"h-4 w-4"}),e[41]||(e[41]=n(" Ver Acta "))],8,it)]),_:1})]),_:1})):x("",!0)]),t(a(We),{open:A.value,"onUpdate:open":e[9]||(e[9]=l=>A.value=l)},{default:s(()=>[t(a(Xe),{class:"max-w-2xl"},{default:s(()=>[t(a(Ge),null,{default:s(()=>[t(a(Je),null,{default:s(()=>e[42]||(e[42]=[n("Añadir Participantes")])),_:1}),t(a(Ke),null,{default:s(()=>e[43]||(e[43]=[n(" Selecciona los usuarios que deseas añadir como participantes de la asamblea ")])),_:1})]),_:1}),o("div",ot,[o("div",nt,[o("div",null,[e[47]||(e[47]=o("label",{class:"text-sm font-medium"},"Tipo de Participación",-1)),t(a(ue),{modelValue:R.value,"onUpdate:modelValue":e[4]||(e[4]=l=>R.value=l)},{default:s(()=>[t(a(ce),null,{default:s(()=>[t(a(me))]),_:1}),t(a(pe),null,{default:s(()=>[t(a(T),{value:"asistente"},{default:s(()=>e[44]||(e[44]=[n("Asistente")])),_:1}),t(a(T),{value:"moderador"},{default:s(()=>e[45]||(e[45]=[n("Moderador")])),_:1}),t(a(T),{value:"secretario"},{default:s(()=>e[46]||(e[46]=[n("Secretario")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",null,[e[48]||(e[48]=o("label",{class:"text-sm font-medium"},"Buscar Usuarios",-1)),t(a(Ze),{modelValue:H.value,"onUpdate:modelValue":e[5]||(e[5]=l=>H.value=l),placeholder:"Buscar por nombre, email, documento o teléfono...",type:"text"},null,8,["modelValue"])])]),o("div",rt,[Y.value?(r(),p("div",dt,e[49]||(e[49]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):b.value.length>0?(r(),p("div",ut,[(r(!0),p(J,null,te(b.value,l=>(r(),p("div",{key:l.id,class:"flex items-center space-x-2 py-2"},[t(a(fe),{id:`usuario-${l.id}`,checked:m.value.includes(l.id),"onUpdate:checked":u=>{if(u)m.value.push(l.id);else{const c=m.value.indexOf(l.id);c>-1&&m.value.splice(c,1)}}},null,8,["id","checked","onUpdate:checked"]),o("label",{for:`usuario-${l.id}`,class:"flex-1 cursor-pointer"},[o("div",mt,d(l.name),1),o("div",pt,[n(d(l.email)+" ",1),l.documento_identidad?(r(),p("span",ft," • Doc: "+d(l.documento_identidad),1)):x("",!0),l.telefono?(r(),p("span",vt," • Tel: "+d(l.telefono),1)):x("",!0)])],8,ct)]))),128)),f.value&&f.value.last_page>1?(r(),p("div",_t,[t(a(C),{variant:"outline",size:"sm",disabled:f.value.current_page===1,onClick:e[6]||(e[6]=l=>G(f.value.current_page-1))},{default:s(()=>[t(a(ne),{class:"h-4 w-4"})]),_:1},8,["disabled"]),o("span",gt," Página "+d(f.value.current_page)+" de "+d(f.value.last_page),1),t(a(C),{variant:"outline",size:"sm",disabled:f.value.current_page===f.value.last_page,onClick:e[7]||(e[7]=l=>G(f.value.current_page+1))},{default:s(()=>[t(a(ve),{class:"h-4 w-4"})]),_:1},8,["disabled"])])):x("",!0)])):(r(),p("p",bt,d(H.value?"No se encontraron usuarios con esa búsqueda":"Escribe para buscar usuarios disponibles"),1))])]),t(a(Ye),null,{default:s(()=>[o("div",yt,[f.value?(r(),p("span",xt,d(f.value.total)+" usuarios disponibles ",1)):x("",!0),o("div",kt,[t(a(C),{variant:"outline",onClick:e[8]||(e[8]=l=>A.value=!1)},{default:s(()=>e[50]||(e[50]=[n(" Cancelar ")])),_:1}),t(a(C),{onClick:Se,disabled:m.value.length===0},{default:s(()=>[n(" Añadir "+d(m.value.length)+" Participante(s) ",1)]),_:1},8,["disabled"])])])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{fs as default};
