import{_ as k}from"./index-B6TYaX6R.js";import{c as qe,_ as S}from"./createLucideIcon-D-pKcP9Q.js";import{a as I,b as j,c as F,_ as U}from"./CardTitle.vue_vue_type_script_setup_true_lang-Bxwe7tUF.js";import{_ as ne}from"./CardDescription.vue_vue_type_script_setup_true_lang-BVAAswS5.js";import{_ as Me,a as Ne,b as ee,c as N,d as He,e as V}from"./TableHeader.vue_vue_type_script_setup_true_lang-CIdicxZL.js";import{_ as Le}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-CHA-M2K0.js";import{_ as Re}from"./CsvImportWizard.vue_vue_type_script_setup_true_lang-LHjJ7wK_.js";import{d as ve,r as y,o as _e,b as v,e as n,w as s,f as t,u as e,g as o,j as g,h as r,t as d,i as p,F as G,k as te,W as A,q as Te,n as H,c as ue,m as Be,p as De,a as X}from"./app-CjO7v5GQ.js";import{H as se}from"./history-BBqkzhox.js";import{F as ge}from"./file-text-Bp8iI4wb.js";import{C as be}from"./circle-x-cLCk-tEp.js";import{C as le}from"./circle-check-big-DRgxsGpy.js";import{C as ie}from"./clock-C92hTTBb.js";import{_ as Qe}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-DfmiIFHc.js";import{_ as We,a as Oe,b as Xe,c as Ge,d as ae}from"./SelectValue.vue_vue_type_script_setup_true_lang-BtUYWEab.js";import{_ as Je}from"./Checkbox.vue_vue_type_script_setup_true_lang-CWJT2xjP.js";import{_ as Ke}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BYpIZ_fq.js";import{t as C}from"./index-DtuMGbOf.js";import{_ as de,a as ce}from"./index-BRaYMiZy.js";import{_ as me}from"./AlertTitle.vue_vue_type_script_setup_true_lang-CFYvDT5y.js";import{_ as Ye}from"./Progress.vue_vue_type_script_setup_true_lang-BtQTpm2p.js";import{A as Ze}from"./arrow-left-BVrvljyo.js";import{S as pe}from"./square-pen-BqdV-S1U.js";import{C as ea}from"./calendar-DDBvtQmm.js";import{M as aa}from"./map-pin-DgRtAv6q.js";import{U as ta}from"./users-BKGB3LXs.js";import{U as sa}from"./user-plus-CoxmBSVT.js";import{U as la}from"./upload-X1YIQhEY.js";import{C as ia}from"./chevron-left-48vlw3IX.js";import{C as ra}from"./chevron-right-Cu7pv3nH.js";import{V as fe}from"./vote-B3S3fO6K.js";import{L as oa}from"./loader-circle-fzSEXKwB.js";import{R as na}from"./refresh-cw-D27ZKmsi.js";import{C as ua}from"./circle-alert-CCRajIhM.js";import{f as da,e as ca}from"./es-BDPlFIsO.js";import"./index-Cqupi6zH.js";import"./Input.vue_vue_type_script_setup_true_lang-B_nvdHN5.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-BGEkPemt.js";import"./index-DIHigTtG.js";import"./floating-ui.vue-DIPIQFyz.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CeaU-cJS.js";import"./VisuallyHidden-CTbTB84I.js";import"./x-BH92W00E.js";import"./DialogTrigger-RqoFjCa-.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-2xSyQjeV.js";import"./useKbd-kRIii9yh.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DvoN6Qah.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-BEwreD-w.js";import"./trash-2-BK1MxCnw.js";import"./plus-D1KzxJf-.js";import"./search-Bh9Nvbzy.js";import"./filter-DIx40dwQ.js";import"./check-DGuODqTO.js";import"./save-CEix0_Ke.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-CMy3ejRe.js";import"./RovingFocusItem-CbOTHXIy.js";import"./utils-Dx0mzWBR.js";import"./Label.vue_vue_type_script_setup_true_lang-BW8_6eap.js";import"./git-branch-B-kY3_wU.js";import"./nullish-CHIgUVhi.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BVMU7bwV.js";import"./index-VE8OALNU.js";import"./shield-BQEaDxqE.js";import"./user-Co3VyLMP.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CBVCH0rS.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-ArNvpFXc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-DYGIKuiv.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CfhopTWT.js";import"./tag-sxC7-sSh.js";import"./target-Ok6GTNsy.js";import"./folder-open-thq0c_kP.js";import"./send-BCIIWnZp.js";import"./briefcase-CJBZbF6d.js";import"./megaphone-CIaTHaNl.js";import"./user-check-DC7m7x8J.js";import"./clipboard-list-CqMWKead.js";import"./mail-DPbCVbB_.js";import"./message-square-CaRueYKC.js";import"./external-link-l4IeB4ym.js";import"./panel-left-CyQdjetZ.js";import"./index-CaapDUxs.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=qe("UserMinusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),pa={class:"flex items-center gap-2"},fa={key:0,class:"flex justify-center py-6"},va={key:1,class:"text-center py-6 text-muted-foreground"},_a={key:2,class:"space-y-3"},ga=["onClick"],ba={class:"flex items-center gap-3"},ya={class:"font-medium text-sm"},xa={class:"text-xs text-muted-foreground"},ha={class:"flex items-center gap-3"},ka={class:"text-right text-sm"},wa={class:"text-xs text-muted-foreground mt-1"},$a={key:0},Ca={key:1},Pa={key:2},Sa=ve({__name:"ImportHistory",props:{type:{},entityId:{},title:{default:"Historial de Importaciones"}},setup(J,{expose:h}){const z=J,w=y([]),b=y(!1),_=async()=>{if(z.entityId){b.value=!0;try{const x=z.type==="votacion"?`/admin/votaciones/${z.entityId}/imports/recent`:`/admin/asambleas/${z.entityId}/imports/recent`,$=await fetch(x);if($.ok){const m=await $.json();w.value=m}}catch(x){console.error("Error loading recent imports:",x)}finally{b.value=!1}}},B=x=>{A.get(`/admin/imports/${x}`)},L=()=>{const x=z.type==="votacion"?`/admin/votaciones/${z.entityId}/imports`:`/admin/asambleas/${z.entityId}/imports`;A.get(x)},R=x=>{switch(x){case"pending":return{icon:ie,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:ie,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:le,label:"Completada",class:"text-green-600"};case"failed":return{icon:be,label:"Fallida",class:"text-red-600"}}},q=x=>new Date(x).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return _e(()=>{_()}),h({loadRecentImports:_}),(x,$)=>(n(),v(e(U),null,{default:s(()=>[t(e(I),null,{default:s(()=>[t(e(j),{class:"flex items-center justify-between"},{default:s(()=>[o("span",pa,[t(e(se),{class:"h-5 w-5"}),r(" "+d(x.title),1)]),w.value.length>0?(n(),v(e(S),{key:0,variant:"outline",size:"sm",onClick:L},{default:s(()=>[...$[0]||($[0]=[r(" Ver Todas ",-1)])]),_:1})):g("",!0)]),_:1})]),_:1}),t(e(F),null,{default:s(()=>[b.value?(n(),p("div",fa,[...$[1]||($[1]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):w.value.length===0?(n(),p("div",va,[t(e(se),{class:"mx-auto h-8 w-8 mb-2"}),$[2]||($[2]=o("p",null,"No hay importaciones registradas",-1)),$[3]||($[3]=o("p",{class:"text-sm"},"Las importaciones aparecerán aquí una vez que subas archivos CSV",-1))])):(n(),p("div",_a,[(n(!0),p(G,null,te(w.value,m=>(n(),p("div",{key:m.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:D=>B(m.id)},[o("div",ba,[(n(),v(Te(R(m.status).icon),{class:H(["h-4 w-4",R(m.status).class])},null,8,["class"])),o("div",null,[o("p",ya,d(m.name||m.original_filename),1),o("p",xa,d(q(m.created_at))+" • Por "+d(m.created_by.name),1)])]),o("div",ha,[o("div",ka,[t(e(k),{variant:"outline",class:H(R(m.status).class)},{default:s(()=>[r(d(R(m.status).label),1)]),_:2},1032,["class"]),o("p",wa,[m.status==="processing"?(n(),p("span",$a,d(m.progress_percentage)+"% ",1)):m.status==="completed"?(n(),p("span",Ca,d(m.successful_rows)+"/"+d(m.total_rows||m.successful_rows+m.failed_rows)+" registros ",1)):m.status==="failed"&&m.failed_rows>0?(n(),p("span",Pa,d(m.failed_rows)+" errores ",1)):g("",!0)])]),t(e(ge),{class:"h-4 w-4 text-gray-400"})])],8,ga))),128))]))]),_:1})]),_:1}))}}),Aa={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},za={class:"flex items-center justify-between"},Ea={class:"text-3xl font-bold"},Va={class:"mt-2 flex items-center gap-2"},Ia={class:"flex gap-2"},ja={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Fa={class:"space-y-2"},Ua={class:"flex items-center gap-2 text-sm"},qa={class:"flex items-center gap-2 text-sm"},Ma={class:"text-sm font-medium"},Na={class:"space-y-2"},Ha={class:"flex items-center gap-2 text-sm"},La={class:"text-sm text-muted-foreground"},Ra={class:"space-y-2"},Ta={class:"flex items-center gap-2"},Ba={class:"text-2xl font-bold"},Da={class:"text-sm"},Qa={class:"flex items-center justify-between"},Wa={key:0,class:"flex gap-2"},Oa={key:0,class:"mb-4 flex gap-2"},Xa={key:3,class:"flex justify-center py-8"},Ga={key:0,class:"flex items-center gap-2"},Ja={class:"relative"},Ka={key:0,class:"absolute inset-0 flex items-center justify-center"},Ya={key:0,class:"text-green-600 transition-all duration-300"},Za={key:1,class:"text-gray-400 transition-all duration-300"},et={key:1},at={key:0},tt={key:1},st={class:"flex justify-end gap-2"},lt={key:5,class:"flex items-center justify-between mt-4"},it={class:"text-sm text-muted-foreground"},rt={key:0,class:"flex items-center space-x-2"},ot={class:"text-sm"},nt={key:0,class:"flex justify-center py-8"},ut={key:1,class:"text-center py-8 text-gray-500"},dt={key:2,class:"space-y-4"},ct={class:"flex justify-between items-start"},mt={class:"flex-1"},pt={class:"font-semibold text-lg"},ft={key:0,class:"text-sm text-gray-600 mt-1"},vt={class:"flex gap-4 mt-2 text-sm text-gray-500"},_t={key:0,class:"space-y-2"},gt={class:"flex justify-between text-sm"},bt=["href"],Os=ve({__name:"Show",props:{asamblea:{},puede_gestionar_participantes:{type:Boolean},filterFieldsConfig:{}},setup(J){const h=J,z=[{title:"Admin",href:"/admin/dashboard"},{title:"Asambleas",href:"/admin/asambleas"},{title:h.asamblea.nombre,href:"#"}],{route:w}=window,b=y([]),_=y({current_page:1,last_page:1,per_page:20,total:0,from:0,to:0}),B=y(!1),L=y({}),R={fields:h.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por nombre, email o documento...",quickSearchFields:["users.name","users.email","users.documento_identidad"],maxNestingLevel:1,allowSaveFilters:!1,debounceTime:500,autoApply:!1},q=y(!1),x=y("asistente"),$=ue(()=>[{name:"tipo_participacion",label:"Tipo de Participación",type:"select",options:[{value:"asistente",label:"Asistente"},{value:"moderador",label:"Moderador"},{value:"secretario",label:"Secretario"}],value:x.value,required:!1}]),m=y(null),D=y(!1),W=y(!1),ye=y([]),K=y(null),Y=y([]),Z=y(!1),E=y(null),P=y({}),M=y({}),xe=i=>i?da(new Date(i),"PPPpp",{locale:ca}):"",he=i=>{switch(i){case"moderador":return"bg-purple-100 text-purple-800";case"secretario":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},O=ue(()=>{const i=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.tipo_participacion)==="moderador"}).length,a=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.tipo_participacion)==="secretario"}).length,l=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.tipo_participacion)==="asistente"}).length,u=b.value.filter(c=>{var f;return((f=c.pivot)==null?void 0:f.asistio)===!0}).length;return{moderadores:i,secretarios:a,asistentes:l,presentes:u,total:_.value.total||0}}),T=async(i=1,a={})=>{B.value=!0;try{const l={page:i,...a},u=await X.get(w("admin.asambleas.participantes-list",h.asamblea.id),{params:l});b.value=u.data.participantes.data.map(c=>({...c,pivot:{tenant_id:c.tenant_id,tipo_participacion:c.tipo_participacion||"asistente",asistio:c.asistio===1||c.asistio===!0||c.asistio==="1",hora_registro:c.hora_registro}})),_.value={current_page:u.data.participantes.current_page,last_page:u.data.participantes.last_page,per_page:u.data.participantes.per_page,total:u.data.participantes.total,from:u.data.participantes.from,to:u.data.participantes.to}}catch(l){console.error("Error cargando participantes:",l)}finally{B.value=!1}},re=i=>{T(i,L.value)},ke=i=>{L.value=i,T(1,i)},we=()=>{L.value={},T(1,{})},$e=()=>{q.value=!0};Be(q,i=>{i||(x.value="asistente")});const Ce=i=>{if(!i.userIds||i.userIds.length===0)return;const a=i.userIds.length;A.post(w("admin.asambleas.manage-participantes",h.asamblea.id),{participante_ids:i.userIds,tipo_participacion:i.extraData.tipo_participacion||"asistente"},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{q.value=!1,C.success(`${a} participante(s) añadido(s) exitosamente`,{duration:2e3}),T(_.value.current_page,L.value)},onError:()=>{C.error("Error al añadir participantes",{description:"Por favor intenta nuevamente",duration:3e3})}})},Pe=i=>{const a=b.value.find(f=>f.id===i),l=(a==null?void 0:a.name)||"Participante";if(!confirm(`¿Estás seguro de remover a ${l} de la asamblea?`))return;const u=b.value.findIndex(f=>f.id===i),c=b.value[u];u!==-1&&(b.value.splice(u,1),_.value.total-=1),A.delete(w("admin.asambleas.manage-participantes",h.asamblea.id),{data:{participante_id:i},preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{C.success(`${l} removido de la asamblea`,{duration:2e3})},onError:()=>{c&&u!==-1&&(b.value.splice(u,0,c),_.value.total+=1),C.error("Error al remover participante",{duration:3e3})}})},Se=(i,a)=>{var f;const l=b.value.find(Q=>Q.id===i),u=(l==null?void 0:l.name)||"Participante",c=(f=l==null?void 0:l.pivot)==null?void 0:f.tipo_participacion;l&&l.pivot&&(l.pivot.tipo_participacion=a),A.put(w("admin.asambleas.manage-participantes",h.asamblea.id),{participante_id:i,tipo_participacion:a},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{const Q=a.charAt(0).toUpperCase()+a.slice(1);C.success(`${u} asignado como ${Q}`,{duration:2e3})},onError:()=>{l&&l.pivot&&c&&(l.pivot.tipo_participacion=c),C.error("Error al actualizar el tipo de participación",{duration:3e3})}})},Ae=(i,a)=>{if(m.value===i)return;m.value=i;const l=b.value.find(c=>c.id===i),u=(l==null?void 0:l.name)||"Participante";l&&l.pivot&&(l.pivot.asistio,l.pivot.asistio=a,a?l.pivot.hora_registro=new Date().toISOString():l.pivot.hora_registro=null),A.put(w("admin.asambleas.manage-participantes",h.asamblea.id),{participante_id:i,asistio:a},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{a?C.success(`${u} marcado como presente`,{duration:2e3}):C.info(`${u} marcado como ausente`,{duration:2e3})},onError:()=>{l&&l.pivot&&(l.pivot.asistio=!a,l.pivot.hora_registro=null),C.error("Error al actualizar la asistencia",{description:"Por favor intenta nuevamente",duration:3e3})},onFinish:()=>{m.value=null}})},ze=()=>{A.visit(w("admin.asambleas.edit",h.asamblea.id))},Ee=()=>{A.visit(w("admin.asambleas.index"))},Ve=async()=>{var i;if((i=h.asamblea)!=null&&i.id)try{const a=await fetch(`/admin/asambleas/${h.asamblea.id}/imports/recent`);ye.value=await a.json()}catch(a){console.error("Error cargando importaciones recientes:",a)}},Ie=i=>{D.value=!1,Ve(),T(),K.value&&K.value.loadRecentImports(),A.get(`/admin/imports/${i}`)},je=()=>{D.value=!1},oe=async()=>{Z.value=!0;try{const i=await X.get(`/admin/asambleas/${h.asamblea.id}/votaciones`);i.data.success&&(Y.value=i.data.data)}catch(i){console.error("Error cargando votaciones:",i),C.error("Error al cargar las votaciones")}finally{Z.value=!1}},Fe=async i=>{var a,l;if(!E.value){E.value=i,delete P.value[i];try{const u=await X.post(`/admin/asambleas/${h.asamblea.id}/votaciones/${i}/sync`);if(u.data.success){C.success("Sincronización iniciada");const c=u.data.job_id;Ue(i,c)}}catch(u){console.error("Error iniciando sincronización:",u),C.error(((l=(a=u.response)==null?void 0:a.data)==null?void 0:l.message)||"Error al iniciar la sincronización"),E.value=null}}},Ue=(i,a)=>{M.value[i]&&clearInterval(M.value[i]),M.value[i]=setInterval(async()=>{try{const l=await X.get(`/admin/sync-job/${a}/status`);if(l.data.success){const u=l.data.data;P.value[i]=u,(u.status==="completed"||u.status==="completed_with_errors"||u.status==="failed")&&(clearInterval(M.value[i]),delete M.value[i],E.value=null,setTimeout(()=>{oe()},2e3),setTimeout(()=>{delete P.value[i]},5e3))}}catch(l){console.error("Error obteniendo progreso:",l),clearInterval(M.value[i]),delete M.value[i],E.value=null}},2e3)};return _e(()=>{T(),oe()}),(i,a)=>(n(),p(G,null,[t(e(De),{title:`Asamblea: ${i.asamblea.nombre}`},null,8,["title"]),t(Ke,{breadcrumbs:z},{default:s(()=>[o("div",Aa,[o("div",za,[o("div",null,[o("h1",Ea,d(i.asamblea.nombre),1),o("div",Va,[t(e(k),{class:H(i.asamblea.estado_color)},{default:s(()=>[r(d(i.asamblea.estado_label),1)]),_:1},8,["class"]),t(e(k),{class:H(i.asamblea.tipo==="ordinaria"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800")},{default:s(()=>[r(d(i.asamblea.tipo_label),1)]),_:1},8,["class"]),i.asamblea.activo?(n(),v(e(k),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[...a[6]||(a[6]=[r(" Activa ",-1)])]),_:1})):(n(),v(e(k),{key:1,class:"bg-red-100 text-red-800"},{default:s(()=>[...a[7]||(a[7]=[r(" Inactiva ",-1)])]),_:1}))])]),o("div",Ia,[t(e(S),{variant:"outline",onClick:Ee},{default:s(()=>[t(e(Ze),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=r(" Volver ",-1))]),_:1}),t(e(S),{onClick:ze},{default:s(()=>[t(e(pe),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=r(" Editar ",-1))]),_:1})])]),o("div",ja,[t(e(U),null,{default:s(()=>[t(e(I),{class:"pb-3"},{default:s(()=>[t(e(j),{class:"text-sm font-medium"},{default:s(()=>[...a[10]||(a[10]=[r("Fechas",-1)])]),_:1})]),_:1}),t(e(F),null,{default:s(()=>[o("div",Fa,[o("div",Ua,[t(e(ea),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.rango_fechas),1)]),o("div",qa,[t(e(ie),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,"Duración: "+d(i.asamblea.duracion),1)]),o("p",Ma,d(i.asamblea.tiempo_restante),1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[t(e(I),{class:"pb-3"},{default:s(()=>[t(e(j),{class:"text-sm font-medium"},{default:s(()=>[...a[11]||(a[11]=[r("Ubicación",-1)])]),_:1})]),_:1}),t(e(F),null,{default:s(()=>[o("div",Na,[o("div",Ha,[t(e(aa),{class:"h-4 w-4 text-muted-foreground"}),o("span",null,d(i.asamblea.lugar||"No especificado"),1)]),o("p",La,d(i.asamblea.ubicacion_completa),1)])]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[t(e(I),{class:"pb-3"},{default:s(()=>[t(e(j),{class:"text-sm font-medium"},{default:s(()=>[...a[12]||(a[12]=[r("Quórum",-1)])]),_:1})]),_:1}),t(e(F),null,{default:s(()=>[o("div",Ra,[o("div",Ta,[t(e(ta),{class:"h-4 w-4 text-muted-foreground"}),o("span",Ba,d(i.asamblea.asistentes_count)+" / "+d(i.asamblea.quorum_minimo||"∞"),1)]),i.asamblea.alcanza_quorum?(n(),v(e(k),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[t(e(le),{class:"mr-1 h-3 w-3"}),a[13]||(a[13]=r(" Quórum alcanzado ",-1))]),_:1})):i.asamblea.quorum_minimo?(n(),v(e(k),{key:1,class:"bg-yellow-100 text-yellow-800"},{default:s(()=>[t(e(be),{class:"mr-1 h-3 w-3"}),a[14]||(a[14]=r(" Quórum no alcanzado ",-1))]),_:1})):g("",!0)])]),_:1})]),_:1})]),i.asamblea.descripcion?(n(),v(e(U),{key:0},{default:s(()=>[t(e(I),null,{default:s(()=>[t(e(j),null,{default:s(()=>[...a[15]||(a[15]=[r("Descripción",-1)])]),_:1})]),_:1}),t(e(F),null,{default:s(()=>[o("p",Da,d(i.asamblea.descripcion),1)]),_:1})]),_:1})):g("",!0),t(Le,{config:R,onApply:ke,onClear:we}),t(e(U),null,{default:s(()=>[t(e(I),null,{default:s(()=>[o("div",Qa,[o("div",null,[t(e(j),null,{default:s(()=>[...a[16]||(a[16]=[r("Participantes",-1)])]),_:1}),t(e(ne),null,{default:s(()=>[r(d(i.asamblea.participantes_count)+" participantes registrados ",1)]),_:1})]),b.value.length>0?(n(),p("div",Wa,[t(e(k),{variant:"outline"},{default:s(()=>[r(" Moderadores: "+d(O.value.moderadores),1)]),_:1}),t(e(k),{variant:"outline"},{default:s(()=>[r(" Secretarios: "+d(O.value.secretarios),1)]),_:1}),t(e(k),{variant:"outline"},{default:s(()=>[r(" Asistentes: "+d(O.value.asistentes),1)]),_:1}),t(e(k),{variant:"outline"},{default:s(()=>[r(" Presentes: "+d(O.value.presentes),1)]),_:1})])):g("",!0)])]),_:1}),t(e(F),null,{default:s(()=>[i.puede_gestionar_participantes?(n(),p("div",Oa,[t(e(S),{onClick:$e},{default:s(()=>[t(e(sa),{class:"mr-2 h-4 w-4"}),a[17]||(a[17]=r(" Añadir Participantes ",-1))]),_:1}),t(e(S),{variant:"outline",onClick:a[0]||(a[0]=l=>D.value=!0)},{default:s(()=>[t(e(la),{class:"mr-2 h-4 w-4"}),a[18]||(a[18]=r(" Importar CSV ",-1))]),_:1}),t(e(S),{variant:"outline",onClick:a[1]||(a[1]=l=>W.value=!W.value)},{default:s(()=>[t(e(se),{class:"mr-2 h-4 w-4"}),r(" "+d(W.value?"Ocultar":"Ver")+" Historial ",1)]),_:1})])):g("",!0),D.value?(n(),v(Re,{key:1,mode:"asamblea","asamblea-id":i.asamblea.id,"asamblea-titulo":i.asamblea.nombre,"redirect-on-success":!0,onSuccess:Ie,onCancel:je,class:"mb-4"},null,8,["asamblea-id","asamblea-titulo"])):g("",!0),W.value?(n(),v(Sa,{key:2,ref_key:"importHistoryRef",ref:K,type:"asamblea","entity-id":i.asamblea.id,title:"Historial de Importaciones",class:"mb-4"},null,8,["entity-id"])):g("",!0),B.value?(n(),p("div",Xa,[...a[19]||(a[19]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):(n(),v(e(Me),{key:4},{default:s(()=>[t(e(Ne),null,{default:s(()=>[t(e(ee),null,{default:s(()=>[t(e(N),null,{default:s(()=>[...a[20]||(a[20]=[r("Nombre",-1)])]),_:1}),t(e(N),null,{default:s(()=>[...a[21]||(a[21]=[r("Email",-1)])]),_:1}),t(e(N),null,{default:s(()=>[...a[22]||(a[22]=[r("Tipo de Participación",-1)])]),_:1}),t(e(N),null,{default:s(()=>[...a[23]||(a[23]=[r("Asistencia",-1)])]),_:1}),t(e(N),null,{default:s(()=>[...a[24]||(a[24]=[r("Hora de Registro",-1)])]),_:1}),t(e(N),null,{default:s(()=>[...a[25]||(a[25]=[r("Registrado por",-1)])]),_:1}),i.puede_gestionar_participantes?(n(),v(e(N),{key:0,class:"text-right"},{default:s(()=>[...a[26]||(a[26]=[r("Acciones",-1)])]),_:1})):g("",!0)]),_:1})]),_:1}),t(e(He),null,{default:s(()=>[(n(!0),p(G,null,te(b.value,l=>(n(),v(e(ee),{key:l.id},{default:s(()=>[t(e(V),{class:"font-medium"},{default:s(()=>[r(d(l.name),1)]),_:2},1024),t(e(V),null,{default:s(()=>[r(d(l.email),1)]),_:2},1024),t(e(V),null,{default:s(()=>{var u;return[t(e(k),{class:H(he(((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente"))},{default:s(()=>{var c;return[r(d(((c=l.pivot)==null?void 0:c.tipo_participacion)||"asistente"),1)]}),_:2},1032,["class"])]}),_:2},1024),t(e(V),null,{default:s(()=>{var u,c,f;return[i.puede_gestionar_participantes&&i.asamblea.estado==="en_curso"?(n(),p("div",Ga,[o("div",Ja,[t(e(Je),{checked:((u=l.pivot)==null?void 0:u.asistio)||!1,disabled:m.value===l.id,"onUpdate:checked":Q=>Ae(l.id,Q),class:H(m.value===l.id?"opacity-50":"")},null,8,["checked","disabled","onUpdate:checked","class"]),m.value===l.id?(n(),p("div",Ka,[...a[27]||(a[27]=[o("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary"},null,-1)])])):g("",!0)]),(c=l.pivot)!=null&&c.asistio?(n(),p("span",Ya," Presente ")):(n(),p("span",Za," Ausente "))])):(n(),p("div",et,[(f=l.pivot)!=null&&f.asistio?(n(),v(e(k),{key:0,class:"bg-green-100 text-green-800"},{default:s(()=>[...a[28]||(a[28]=[r(" Presente ",-1)])]),_:1})):(n(),v(e(k),{key:1,variant:"outline"},{default:s(()=>[...a[29]||(a[29]=[r(" Ausente ",-1)])]),_:1}))]))]}),_:2},1024),t(e(V),null,{default:s(()=>{var u;return[r(d((u=l.pivot)!=null&&u.hora_registro?xe(l.pivot.hora_registro):"-"),1)]}),_:2},1024),t(e(V),null,{default:s(()=>{var u;return[(u=l.pivot)!=null&&u.updated_by?(n(),p("span",at,d(l.pivot.updated_by===l.id?"Auto-registro":l.pivot.updated_by_name||"Admin"),1)):(n(),p("span",tt,"-"))]}),_:2},1024),i.puede_gestionar_participantes?(n(),v(e(V),{key:0,class:"text-right"},{default:s(()=>{var u;return[o("div",st,[t(e(We),{"model-value":((u=l.pivot)==null?void 0:u.tipo_participacion)||"asistente","onUpdate:modelValue":c=>Se(l.id,c)},{default:s(()=>[t(e(Oe),{class:"w-32"},{default:s(()=>[t(e(Xe))]),_:1}),t(e(Ge),null,{default:s(()=>[t(e(ae),{value:"asistente"},{default:s(()=>[...a[30]||(a[30]=[r("Asistente",-1)])]),_:1}),t(e(ae),{value:"moderador"},{default:s(()=>[...a[31]||(a[31]=[r("Moderador",-1)])]),_:1}),t(e(ae),{value:"secretario"},{default:s(()=>[...a[32]||(a[32]=[r("Secretario",-1)])]),_:1})]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"]),t(e(S),{variant:"ghost",size:"sm",onClick:c=>Pe(l.id)},{default:s(()=>[t(e(ma),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])]}),_:2},1024)):g("",!0)]),_:2},1024))),128)),b.value.length===0?(n(),v(e(ee),{key:0},{default:s(()=>[t(e(V),{colspan:"6",class:"text-center py-8"},{default:s(()=>[...a[33]||(a[33]=[o("p",{class:"text-muted-foreground"},"No hay participantes registrados",-1)])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})),_.value.total>0?(n(),p("div",lt,[o("div",it," Mostrando "+d(_.value.from)+" a "+d(_.value.to)+" de "+d(_.value.total)+" resultados ",1),_.value.last_page>1?(n(),p("div",rt,[t(e(S),{variant:"outline",size:"sm",disabled:_.value.current_page===1,onClick:a[2]||(a[2]=l=>re(_.value.current_page-1))},{default:s(()=>[t(e(ia),{class:"h-4 w-4"}),a[34]||(a[34]=r(" Anterior ",-1))]),_:1},8,["disabled"]),o("div",ot," Página "+d(_.value.current_page)+" de "+d(_.value.last_page),1),t(e(S),{variant:"outline",size:"sm",disabled:_.value.current_page===_.value.last_page,onClick:a[3]||(a[3]=l=>re(_.value.current_page+1))},{default:s(()=>[a[35]||(a[35]=r(" Siguiente ",-1)),t(e(ra),{class:"h-4 w-4"})]),_:1},8,["disabled"])])):g("",!0)])):g("",!0)]),_:1})]),_:1}),t(e(U),null,{default:s(()=>[t(e(I),null,{default:s(()=>[t(e(j),{class:"flex items-center gap-2"},{default:s(()=>[t(e(fe),{class:"h-5 w-5"}),a[36]||(a[36]=r(" Votaciones Asociadas ",-1))]),_:1}),t(e(ne),null,{default:s(()=>[...a[37]||(a[37]=[r(" Votaciones vinculadas a esta asamblea y estado de sincronización de participantes ",-1)])]),_:1})]),_:1}),t(e(F),null,{default:s(()=>[Z.value?(n(),p("div",nt,[t(e(oa),{class:"h-8 w-8 animate-spin text-gray-400"})])):Y.value.length===0?(n(),p("div",ut,[t(e(fe),{class:"h-12 w-12 mx-auto mb-3 text-gray-300"}),a[39]||(a[39]=o("p",null,"No hay votaciones asociadas a esta asamblea",-1)),t(e(S),{variant:"outline",class:"mt-4",onClick:a[4]||(a[4]=()=>e(A).visit(`/admin/asambleas/${i.asamblea.id}/edit`))},{default:s(()=>[t(e(pe),{class:"h-4 w-4 mr-2"}),a[38]||(a[38]=r(" Editar Asamblea para Agregar Votaciones ",-1))]),_:1})])):(n(),p("div",dt,[(n(!0),p(G,null,te(Y.value,l=>(n(),p("div",{key:l.id,class:"border rounded-lg p-4 space-y-3"},[o("div",ct,[o("div",mt,[o("h4",pt,d(l.titulo),1),l.descripcion?(n(),p("p",ft,d(l.descripcion),1)):g("",!0),o("div",vt,[o("span",null,[a[40]||(a[40]=r("Estado: ",-1)),t(e(k),{variant:l.estado==="activa"?"default":"secondary"},{default:s(()=>[r(d(l.estado),1)]),_:2},1032,["variant"])]),o("span",null,"Votantes: "+d(l.votantes_count),1),o("span",null,"Sincronizados desde asamblea: "+d(l.sincronizados_count),1)])]),l.puede_sincronizar&&i.puede_gestionar_participantes?(n(),v(e(S),{key:0,onClick:u=>Fe(l.id),disabled:E.value===l.id,variant:"outline"},{default:s(()=>[t(e(na),{class:H(["h-4 w-4 mr-2",{"animate-spin":E.value===l.id}])},null,8,["class"]),r(" "+d(E.value===l.id?"Sincronizando...":"Sincronizar Participantes"),1)]),_:2},1032,["onClick","disabled"])):g("",!0)]),P.value[l.id]?(n(),p("div",_t,[o("div",gt,[o("span",null,d(P.value[l.id].message),1),o("span",null,d(Math.round(P.value[l.id].progress))+"%",1)]),t(e(Ye),{"model-value":P.value[l.id].progress},null,8,["model-value"]),P.value[l.id].status==="completed"?(n(),v(e(de),{key:0,class:"mt-2"},{default:s(()=>[t(e(le),{class:"h-4 w-4"}),t(e(me),null,{default:s(()=>[...a[41]||(a[41]=[r("Sincronización completada",-1)])]),_:1}),t(e(ce),null,{default:s(()=>[r(d(P.value[l.id].message),1)]),_:2},1024)]),_:2},1024)):g("",!0),P.value[l.id].status==="failed"?(n(),v(e(de),{key:1,variant:"destructive",class:"mt-2"},{default:s(()=>[t(e(ua),{class:"h-4 w-4"}),t(e(me),null,{default:s(()=>[...a[42]||(a[42]=[r("Error en sincronización",-1)])]),_:1}),t(e(ce),null,{default:s(()=>[r(d(P.value[l.id].message),1)]),_:2},1024)]),_:2},1024)):g("",!0)])):g("",!0)]))),128))]))]),_:1})]),_:1}),i.asamblea.acta_url?(n(),v(e(U),{key:1},{default:s(()=>[t(e(I),null,{default:s(()=>[t(e(j),null,{default:s(()=>[...a[43]||(a[43]=[r("Acta de la Asamblea",-1)])]),_:1})]),_:1}),t(e(F),null,{default:s(()=>[o("a",{href:i.asamblea.acta_url,target:"_blank",class:"flex items-center gap-2 text-blue-600 hover:underline"},[t(e(ge),{class:"h-4 w-4"}),a[44]||(a[44]=r(" Ver Acta ",-1))],8,bt)]),_:1})]),_:1})):g("",!0)]),t(Qe,{modelValue:q.value,"onUpdate:modelValue":a[5]||(a[5]=l=>q.value=l),title:"Añadir Participantes",description:"Selecciona los usuarios que deseas añadir como participantes de la asamblea","search-endpoint":e(w)("admin.asambleas.manage-participantes",h.asamblea.id),"extra-fields":$.value,"search-placeholder":"Buscar por nombre, email, documento o teléfono...","submit-button-text":"Añadir Participantes","empty-message":"Escribe para buscar usuarios disponibles","no-results-message":"No se encontraron usuarios con esa búsqueda",onSubmit:Ce},null,8,["modelValue","search-endpoint","extra-fields"])]),_:1})],64))}});export{Os as default};
