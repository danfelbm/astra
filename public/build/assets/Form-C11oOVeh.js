import{_ as sa}from"./UserLayout.vue_vue_type_script_setup_true_lang-DOtomtA0.js";import{_ as z}from"./index-5Kpx2wY0.js";import{_ as S}from"./createLucideIcon-C7u-R01f.js";import{_ as k,c as h,a as x,b as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-BFumUwpC.js";import{_ as I}from"./CardDescription.vue_vue_type_script_setup_true_lang-DV49e1r_.js";import{_ as ra,a as ia,b as O,c as L}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-B9dxKNpq.js";import{D as da}from"./DynamicFormRenderer-Xag0Cwrs.js";import{d as na,k as N,c as C,C as la,a as u,o as d,b as s,u as e,m as ua,e as r,f as t,j as P,i as _,W as pa,g as p,t as n,n as b,l as W,F as G,r as ca}from"./app-CZw07Q93.js";import{A as ma}from"./arrow-left-BIH466NB.js";import{S as M}from"./save-CgAigu3l.js";import{S as X}from"./send-YeURIxXY.js";import{C as fa}from"./clock-B7XkIYej.js";import{C as H}from"./circle-check-big-EP3KWshb.js";import{C as J}from"./circle-x-xWgvaarK.js";import{C as V}from"./circle-alert-uWMA2z83.js";import{F as ba}from"./file-text-DpdPn_qr.js";import{U as va}from"./user-BLiZb0Cx.js";import{C as ga}from"./calendar-DaONdD9W.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BEVl8MTz.js";import"./index-4FPB8ZAX.js";import"./floating-ui.vue-DIqzyMHs.js";import"./x-yvp4rZIx.js";import"./Input.vue_vue_type_script_setup_true_lang-DCxWTU2m.js";import"./index-DbmmK8pQ.js";import"./index-ukOzJdgH.js";import"./shield-CGhRnhVe.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B3e8d-nF.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-C_0q6Kwy.js";import"./VisuallyHidden-C29Bi-F2.js";import"./PopperContent-iq8Pmmed.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-9rRU-lJQ.js";import"./check-BARXO5K0.js";import"./nullish-CHIgUVhi.js";import"./Label.vue_vue_type_script_setup_true_lang-BGrzXVeU.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-4RjFW4ce.js";import"./index-iaJQ5f3g.js";import"./map-pin-BagcXSc4.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-XREYgAdr.js";import"./square-check-big-Dp9aRsxB.js";import"./users-OPdRzPF7.js";import"./index-BdHS3Z4B.js";import"./RovingFocusItem-DeJaY9TY.js";import"./utils-DmWCIQ37.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-DRNQZJP3.js";import"./Textarea.vue_vue_type_script_setup_true_lang-AZwakrj6.js";import"./plus-BoqJaKrg.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-BeCMwEJx.js";import"./VisuallyHiddenInput-BlgdTmEt.js";import"./useConditionalFields-Cosq2SX8.js";import"./upload-BE30SclZ.js";import"./eye-C_RyQi4k.js";import"./download-BOs-U5a4.js";import"./grip-vertical-sHtoq3ZM.js";import"./trash-2-CN1WpPul.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const _a={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ya={class:"space-y-6"},ka={class:"flex items-center justify-between"},ha={class:"space-y-1"},Ca={class:"flex items-center gap-2"},wa={class:"text-3xl font-bold tracking-tight"},xa={class:"text-muted-foreground"},$a={class:"flex items-start justify-between"},Pa={class:"flex items-start gap-3"},Aa={class:"space-y-1"},Ea={class:"flex items-center gap-2"},Fa={class:"text-sm text-muted-foreground"},ja={key:0},za={key:1},Sa={key:2},Na={key:3},Va={key:4},Ba={key:5},Ra={class:"flex items-start gap-2"},Ta={class:"flex-1"},qa={class:"text-xs mt-2 opacity-75"},Da={key:0},Ua={key:1},Ia={key:2},Oa={class:"grid grid-cols-2 gap-4 text-sm"},La={class:"font-medium"},Wa={class:"font-medium"},Ga={class:"font-medium text-xs"},Ma={class:"font-medium"},Xa={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Ha={class:"flex items-start gap-2"},Ja={class:"text-sm text-red-800"},Ka={key:1,class:"flex justify-end gap-3"},Qa={class:"flex items-center justify-between"},Ya={class:"flex items-center justify-between"},Za={class:"text-muted-foreground"},ao={class:"font-medium text-right max-w-xs"},oo={class:"grid grid-cols-2 gap-4 text-sm"},eo={class:"font-medium"},to={class:"font-medium"},so={class:"font-medium"},ro={class:"font-medium"},ne=na({__name:"Form",props:{convocatoria:{},postulacion:{},candidatura_aprobada:{},canApply:{type:Boolean},canCreate:{type:Boolean},canEditOwn:{type:Boolean}},setup(K){var R,T,q,D,U;const i=K,Q=[{title:"Postulaciones",href:"/miembro/postulaciones"},{title:i.convocatoria.nombre,href:`/miembro/convocatorias/${i.convocatoria.id}`}],A=N(),Y=C(()=>i.candidatura_aprobada?[{id:i.candidatura_aprobada.id,version:i.candidatura_aprobada.version,fecha_aprobacion:i.candidatura_aprobada.fecha_aprobacion,resumen:`Perfil v${i.candidatura_aprobada.version} - Aprobado ${i.candidatura_aprobada.fecha_aprobacion}`}]:[]),f=la({formulario_data:((R=i.postulacion)==null?void 0:R.formulario_data)||{},candidatura_id:(T=i.postulacion)!=null&&T.candidatura_snapshot?(q=i.candidatura_aprobada)==null?void 0:q.id:null,enviar:!1}),w=N((D=i.postulacion)!=null&&D.candidatura_snapshot&&((U=i.candidatura_aprobada)==null?void 0:U.id)||null),E=C(()=>!!i.postulacion),B=C(()=>i.postulacion?i.postulacion.puede_editar:!0),j=C(()=>{var a;return!!((a=i.postulacion)!=null&&a.comentarios_admin)}),Z=a=>{switch(a){case"abierta":return H;case"futura":return ga;case"cerrada":return J;default:return V}},aa=()=>{f.enviar=!1,f.candidatura_id=w.value,f.post(`/miembro/convocatorias/${i.convocatoria.id}/postular`,{preserveScroll:!0})},v=N(null),oa=()=>{var a,o,l;if(v.value=null,!((a=A.value)!=null&&a.formularioCompleto)){const m=((o=A.value)==null?void 0:o.camposIncompletos)||[],c=(l=A.value)==null?void 0:l.perfilCandidaturaRequerido;m.length>0?v.value=`Formulario incompleto: Por favor completa todos los campos requeridos (${m.length} campos faltantes).`:c&&!w.value?v.value="Debes seleccionar tu perfil de candidatura aprobado para continuar.":v.value="Por favor completa todos los campos requeridos del formulario.";const g=document.querySelector('[role="tabpanel"]');g&&g.scrollIntoView({behavior:"smooth",block:"start"});return}f.enviar=!0,f.candidatura_id=w.value,f.post(`/miembro/convocatorias/${i.convocatoria.id}/postular`,{preserveScroll:!0,onError:m=>{const c=Object.values(m)[0];c?v.value=Array.isArray(c)?c[0]:c:v.value="Error al enviar la postulación. Por favor revisa los datos e intenta nuevamente."}})},ea=(a,o)=>{const l={};for(const[m,c]of Object.entries(a)){const g=o.find(F=>F.id===m);g&&(l[g.title]=Array.isArray(c)?c.join(", "):c)}return l},ta=C(()=>{var a;return(a=i.postulacion)!=null&&a.formulario_data?ea(i.postulacion.formulario_data,i.convocatoria.formulario_postulacion):{}}),y=C(()=>{var o,l,m,c,g,F;if(!((o=i.postulacion)!=null&&o.candidatura_snapshot))return null;const a=i.postulacion.candidatura_snapshot;return{usuario:((l=a.usuario)==null?void 0:l.name)||"N/A",version:((m=a.candidatura)==null?void 0:m.version_original)||"N/A",fecha_aprobacion:((c=a.candidatura)==null?void 0:c.fecha_aprobacion)||"N/A",aprobado_por:((F=(g=a.candidatura)==null?void 0:g.aprobado_por)==null?void 0:F.name)||"N/A"}});return(a,o)=>(d(),u(G,null,[s(e(ua),{title:`${E.value?"Editar":"Nueva"} Postulación - ${a.convocatoria.nombre}`},null,8,["title"]),s(sa,{breadcrumbs:Q},{default:r(()=>[t("div",_a,[t("div",ya,[t("div",ka,[t("div",ha,[t("div",Ca,[s(e(S),{variant:"ghost",size:"sm",onClick:o[0]||(o[0]=l=>e(pa).get("/miembro/postulaciones"))},{default:r(()=>[s(e(ma),{class:"h-4 w-4 mr-2"}),o[3]||(o[3]=p(" Volver ",-1))]),_:1})]),t("h1",wa,n(E.value?"Editar Postulación":"Nueva Postulación"),1),t("p",xa,n(a.convocatoria.nombre),1)]),s(e(z),{class:b(a.convocatoria.estado_temporal==="abierta"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800")},{default:r(()=>[(d(),P(W(Z(a.convocatoria.estado_temporal)),{class:"mr-1 h-3 w-3"})),p(" "+n(a.convocatoria.estado_temporal_label),1)]),_:1},8,["class"])]),a.postulacion?(d(),P(e(k),{key:0,class:b({"border-yellow-500":a.postulacion.estado==="borrador","border-blue-500":a.postulacion.estado==="enviada","border-purple-500":a.postulacion.estado==="en_revision","border-green-500":a.postulacion.estado==="aceptada","border-red-500":a.postulacion.estado==="rechazada"})},{default:r(()=>[s(e(h),{class:"pt-6"},{default:r(()=>[t("div",$a,[t("div",Pa,[t("div",{class:b([{"bg-yellow-100 text-yellow-600":a.postulacion.estado==="borrador","bg-blue-100 text-blue-600":a.postulacion.estado==="enviada","bg-purple-100 text-purple-600":a.postulacion.estado==="en_revision","bg-green-100 text-green-600":a.postulacion.estado==="aceptada","bg-red-100 text-red-600":a.postulacion.estado==="rechazada"},"rounded-full p-2"])},[(d(),P(W(a.postulacion.estado==="borrador"?e(M):a.postulacion.estado==="enviada"?e(X):a.postulacion.estado==="en_revision"?e(fa):a.postulacion.estado==="aceptada"?e(H):e(J)),{class:"h-5 w-5"}))],2),t("div",Aa,[t("div",Ea,[o[4]||(o[4]=t("h3",{class:"font-semibold"},"Estado actual:",-1)),s(e(z),{class:b(a.postulacion.estado==="borrador"?"bg-yellow-100 text-yellow-800":a.postulacion.estado==="enviada"?"bg-blue-100 text-blue-800":a.postulacion.estado==="en_revision"?"bg-purple-100 text-purple-800":a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},{default:r(()=>[p(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),t("p",Fa,[a.postulacion.estado==="borrador"&&j.value?(d(),u("span",ja," Tu postulación fue devuelta a borrador. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):a.postulacion.estado==="borrador"?(d(),u("span",za," Puedes editar y enviar tu postulación cuando esté completa. ")):a.postulacion.estado==="enviada"?(d(),u("span",Sa," Tu postulación ha sido enviada y está pendiente de revisión. ")):a.postulacion.estado==="en_revision"?(d(),u("span",Na," Tu postulación está siendo revisada por el administrador. ")):a.postulacion.estado==="aceptada"?(d(),u("span",Va," ¡Felicidades! Tu postulación ha sido aceptada. ")):a.postulacion.estado==="rechazada"?(d(),u("span",Ba," Tu postulación fue rechazada. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):_("",!0)])])])]),j.value?(d(),u("div",{key:0,class:b([{"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800":a.postulacion.estado==="rechazada","bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800":a.postulacion.estado==="borrador","bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800":a.postulacion.estado==="aceptada"},"mt-4 p-4 rounded-lg"])},[t("div",Ra,[s(e(V),{class:b([{"text-red-600 dark:text-red-400":a.postulacion.estado==="rechazada","text-amber-600 dark:text-amber-400":a.postulacion.estado==="borrador","text-blue-600 dark:text-blue-400":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-600 dark:text-green-400":a.postulacion.estado==="aceptada"},"h-5 w-5 mt-0.5 flex-shrink-0"])},null,8,["class"]),t("div",Ta,[t("p",{class:b(["font-semibold mb-1",{"text-red-900 dark:text-red-100":a.postulacion.estado==="rechazada","text-amber-900 dark:text-amber-100":a.postulacion.estado==="borrador","text-blue-900 dark:text-blue-100":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-900 dark:text-green-100":a.postulacion.estado==="aceptada"}])}," Comentarios de la comisión: ",2),t("p",{class:b(["text-sm whitespace-pre-wrap",{"text-red-800 dark:text-red-200":a.postulacion.estado==="rechazada","text-amber-800 dark:text-amber-200":a.postulacion.estado==="borrador","text-blue-800 dark:text-blue-200":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-800 dark:text-green-200":a.postulacion.estado==="aceptada"}])},n(a.postulacion.comentarios_admin),3),t("p",qa,[a.postulacion.estado==="rechazada"||a.postulacion.estado==="borrador"&&j.value?(d(),u("span",Da," Por favor, atiende estos comentarios antes de reenviar tu postulación. ")):a.postulacion.estado==="aceptada"?(d(),u("span",Ua," Tu postulación fue aceptada con estos comentarios. ")):(d(),u("span",Ia," Estos comentarios fueron agregados durante la revisión. "))])])])],2)):_("",!0)]),_:1})]),_:1},8,["class"])):_("",!0),s(e(k),null,{default:r(()=>[s(e(x),null,{default:r(()=>[s(e($),{class:"flex items-center gap-2"},{default:r(()=>[s(e(ba),{class:"h-5 w-5"}),o[5]||(o[5]=p(" Información de la Convocatoria ",-1))]),_:1}),s(e(I),null,{default:r(()=>[p(n(a.convocatoria.descripcion),1)]),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:r(()=>[t("div",Oa,[t("div",null,[o[6]||(o[6]=t("span",{class:"text-muted-foreground"},"Cargo:",-1)),t("p",La,n(a.convocatoria.cargo),1)]),t("div",null,[o[7]||(o[7]=t("span",{class:"text-muted-foreground"},"Periodo:",-1)),t("p",Wa,n(a.convocatoria.periodo),1)]),t("div",null,[o[8]||(o[8]=t("span",{class:"text-muted-foreground"},"Fechas:",-1)),t("p",Ga,n(a.convocatoria.rango_fechas),1)]),t("div",null,[o[9]||(o[9]=t("span",{class:"text-muted-foreground"},"Ubicación:",-1)),t("p",Ma,n(a.convocatoria.ubicacion),1)])])]),_:1})]),_:1}),s(e(ra),{"default-value":"formulario",class:"space-y-4"},{default:r(()=>[s(e(ia),{class:"grid w-full grid-cols-2"},{default:r(()=>[s(e(O),{value:"formulario"},{default:r(()=>[...o[10]||(o[10]=[p(" Formulario de Postulación ",-1)])]),_:1}),s(e(O),{value:"resumen",disabled:!E.value},{default:r(()=>[...o[11]||(o[11]=[p(" Resumen Actual ",-1)])]),_:1},8,["disabled"])]),_:1}),s(e(L),{value:"formulario",class:"space-y-6"},{default:r(()=>[s(e(k),null,{default:r(()=>[s(e(x),null,{default:r(()=>[s(e($),null,{default:r(()=>[...o[12]||(o[12]=[p("Completa tu Postulación",-1)])]),_:1}),s(e(I),null,{default:r(()=>[...o[13]||(o[13]=[p(" Completa todos los campos requeridos para enviar tu postulación. ",-1)])]),_:1})]),_:1}),s(e(h),null,{default:r(()=>[s(da,{ref_key:"formRenderer",ref:A,fields:a.convocatoria.formulario_postulacion,modelValue:e(f).formulario_data,"onUpdate:modelValue":o[1]||(o[1]=l=>e(f).formulario_data=l),"candidatura-seleccionada":w.value,"onUpdate:candidaturaSeleccionada":o[2]||(o[2]=l=>w.value=l),"candidaturas-aprobadas":Y.value,errors:e(f).errors,disabled:!B.value},null,8,["fields","modelValue","candidatura-seleccionada","candidaturas-aprobadas","errors","disabled"])]),_:1})]),_:1}),v.value?(d(),u("div",Xa,[t("div",Ha,[s(e(V),{class:"h-5 w-5 text-red-600 mt-0.5"}),t("p",Ja,n(v.value),1)])])):_("",!0),B.value?(d(),u("div",Ka,[s(e(S),{type:"button",variant:"outline",onClick:aa,disabled:e(f).processing},{default:r(()=>[s(e(M),{class:"mr-2 h-4 w-4"}),o[14]||(o[14]=p(" Guardar Borrador ",-1))]),_:1},8,["disabled"]),s(e(S),{type:"button",onClick:oa,disabled:e(f).processing},{default:r(()=>[s(e(X),{class:"mr-2 h-4 w-4"}),o[15]||(o[15]=p(" Enviar Postulación ",-1))]),_:1},8,["disabled"])])):_("",!0)]),_:1}),E.value?(d(),P(e(L),{key:0,value:"resumen",class:"space-y-4"},{default:r(()=>[s(e(k),null,{default:r(()=>[s(e(x),null,{default:r(()=>[s(e($),null,{default:r(()=>[...o[16]||(o[16]=[p("Estado de la Postulación",-1)])]),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:r(()=>[t("div",Qa,[o[17]||(o[17]=t("span",{class:"text-muted-foreground"},"Estado:",-1)),s(e(z),{class:b(a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":a.postulacion.estado==="rechazada"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800")},{default:r(()=>[p(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),t("div",Ya,[o[18]||(o[18]=t("span",{class:"text-muted-foreground"},"Perfil vinculado:",-1)),t("span",null,n(y.value?"Sí":"No"),1)])]),_:1})]),_:1}),s(e(k),null,{default:r(()=>[s(e(x),null,{default:r(()=>[s(e($),null,{default:r(()=>[...o[19]||(o[19]=[p("Respuestas del Formulario",-1)])]),_:1})]),_:1}),s(e(h),{class:"space-y-3"},{default:r(()=>[(d(!0),u(G,null,ca(ta.value,(l,m)=>(d(),u("div",{key:m,class:"flex justify-between"},[t("span",Za,n(m)+":",1),t("span",ao,n(l),1)]))),128))]),_:1})]),_:1}),y.value?(d(),P(e(k),{key:0},{default:r(()=>[s(e(x),null,{default:r(()=>[s(e($),{class:"flex items-center gap-2"},{default:r(()=>[s(e(va),{class:"h-5 w-5"}),o[20]||(o[20]=p(" Perfil de Candidatura Vinculado ",-1))]),_:1})]),_:1}),s(e(h),{class:"space-y-3"},{default:r(()=>[t("div",oo,[t("div",null,[o[21]||(o[21]=t("span",{class:"text-muted-foreground"},"Usuario:",-1)),t("p",eo,n(y.value.usuario),1)]),t("div",null,[o[22]||(o[22]=t("span",{class:"text-muted-foreground"},"Versión:",-1)),t("p",to,"v"+n(y.value.version),1)]),t("div",null,[o[23]||(o[23]=t("span",{class:"text-muted-foreground"},"Fecha aprobación:",-1)),t("p",so,n(y.value.fecha_aprobacion),1)]),t("div",null,[o[24]||(o[24]=t("span",{class:"text-muted-foreground"},"Aprobado por:",-1)),t("p",ro,n(y.value.aprobado_por),1)])])]),_:1})]),_:1})):_("",!0)]),_:1})):_("",!0)]),_:1})])])]),_:1})],64))}});export{ne as default};
