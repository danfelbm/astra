import{d as L,u as M,r as R,b as C,w as o,e as s,g as r,f as e,q as j,v as S,h as l,l as z,i as _,m,F,k as w,t as f}from"./app-CUy8bq-4.js";import{_ as B}from"./AdminLayout.vue_vue_type_script_setup_true_lang-D-e5Olcc.js";import{_ as u}from"./createLucideIcon-BVeAo22y.js";import{_ as c,a as v,b as y,c as x}from"./CardTitle.vue_vue_type_script_setup_true_lang-aQWwj-VV.js";import{_ as b}from"./CardDescription.vue_vue_type_script_setup_true_lang-D9Sm1XFf.js";import{_ as U}from"./Input.vue_vue_type_script_setup_true_lang-KDLmivUK.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-C8Yg27qk.js";import{_ as G}from"./Textarea.vue_vue_type_script_setup_true_lang-CqpmHJKc.js";import{_ as E,a as O,b as P,c as Q,d as H}from"./SelectValue.vue_vue_type_script_setup_true_lang-CDO9BPe3.js";import{_ as I}from"./Switch.vue_vue_type_script_setup_true_lang-DBZhfpBU.js";import{_ as J}from"./Checkbox.vue_vue_type_script_setup_true_lang-B6mVqWSK.js";import{_ as K}from"./index-nP7KVplh.js";import{_ as W,a as X,b as $,c as V}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-s0vkyhrt.js";import{_ as Y}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-BdDgyjqI.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang-CfagBRBO.js";import{A as Z}from"./arrow-left-Cs6eDjxO.js";import{T as ee}from"./target-BgLhoeBV.js";import{F as te}from"./filter-OXBrqNgh.js";import{S as se}from"./useFlashMessages-BSGtS98b.js";import{U as oe}from"./users-CtZ6ZZ1s.js";import{S as le}from"./save-DL-AUIB0.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-BAUdGpDo.js";import"./index-aYAdEGHe.js";import"./floating-ui.vue-BuhgbMW1.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-FYTrsXKF.js";import"./chevron-right-BN0pcRkC.js";import"./chevrons-up-down-CKHTIWfm.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CqolT--g.js";import"./tag-DkJT6krF.js";import"./shield-CM4rzlKb.js";import"./vote-CF4lBptY.js";import"./folder-open-Bt9R0Kno.js";import"./send-1hh2Ud6Y.js";import"./file-text-DLYSBMo_.js";import"./briefcase-GIKWN4Jb.js";import"./calendar-t9FerTPa.js";import"./megaphone-BY1r2WR-.js";import"./user-check-C8xKawhf.js";import"./clipboard-list-Cw3QyN8i.js";import"./mail-BMF7AYGX.js";import"./message-square-Bq3xsExI.js";import"./external-link-DoxxZ627.js";import"./panel-left--HMgbIFi.js";import"./check-cYkI6jVy.js";import"./index-BqMYO_2s.js";import"./index-B1IwCVKl.js";import"./index-Cp4rSUgH.js";import"./VisuallyHidden-W3a4-zje.js";import"./VisuallyHiddenInput-C2CTewFt.js";import"./RovingFocusItem-Bg0_Sxp8.js";import"./utils-CtJjMwls.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BlrYM9n8.js";import"./x-BIc-vpoP.js";import"./DialogTrigger-aEeM-cwD.js";import"./useKbd-kRIii9yh.js";import"./chevron-left-JPxuJsTY.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-C5os3aJ_.js";import"./es-BDPlFIsO.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-saxfTbiI.js";import"./loader-circle-UEOy2bgW.js";import"./trash-2-DTvY1Q0A.js";import"./plus-B5up38a9.js";import"./search-DlM7cAOV.js";import"./history-ApO7iiU-.js";import"./circle-alert-C27dg7Ep.js";import"./index-Cibtne3p.js";import"./user-BblbUKaH.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CLMRNulS.js";import"./map-pin-DnLb6Xc5.js";const ie={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},re={class:"flex items-center justify-between"},ae={class:"space-y-2"},ne={class:"space-y-2"},de={class:"space-y-2"},me={class:"flex items-center justify-between"},ue={class:"space-y-0.5"},fe={class:"flex items-center space-x-2"},pe={class:"space-y-2"},_e={class:"grid grid-cols-2 gap-2"},ge={class:"flex items-center px-3 py-2 bg-muted rounded-md"},ce={class:"text-sm text-muted-foreground"},ve={class:"grid grid-cols-2 gap-2 mt-2"},ye={key:0,class:"space-y-3"},xe={class:"flex-1"},be={class:"text-xs text-muted-foreground mt-1"},$e={key:1,class:"text-center py-8 text-muted-foreground"},Ve={class:"flex justify-end gap-4"},jt=L({__name:"Create",props:{roles:{},filterFieldsConfig:{},modelTypes:{}},setup(g){const D=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Segmentos",href:"/admin/segments"},{title:"Crear Segmento",href:"#"}],i=M({name:"",description:"",model_type:"App\\Models\\User",filters:{},is_dynamic:!0,cache_duration:300,role_ids:[]}),N=R(null),q=n=>{const t=i.role_ids.indexOf(n);t>-1?i.role_ids.splice(t,1):i.role_ids.push(n)},A=n=>{i.filters=n},T=()=>{i.post("/admin/segments",{preserveScroll:!0,onSuccess:()=>{}})},h=n=>n<60?`${n} segundos`:n<3600?`${Math.floor(n/60)} minutos`:`${Math.floor(n/3600)} horas`;return(n,t)=>(m(),C(B,{breadcrumbs:D},{default:o(()=>[s(e(j),{title:"Crear Segmento"}),r("div",ie,[r("div",re,[t[10]||(t[10]=r("div",null,[r("h2",{class:"text-2xl font-bold tracking-tight"},"Crear Nuevo Segmento"),r("p",{class:"text-muted-foreground"}," Define un segmento de usuarios basado en filtros dinámicos ")],-1)),s(e(S),{href:n.route("admin.segments.index")},{default:o(()=>[s(e(u),{variant:"outline"},{default:o(()=>[s(e(Z),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=l(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),r("form",{onSubmit:z(T,["prevent"]),class:"space-y-6"},[s(e(W),{defaultValue:"general",class:"space-y-4"},{default:o(()=>[s(e(X),{class:"grid w-full grid-cols-4"},{default:o(()=>[s(e($),{value:"general"},{default:o(()=>[s(e(ee),{class:"mr-2 h-4 w-4"}),t[11]||(t[11]=l(" General ",-1))]),_:1}),s(e($),{value:"filters"},{default:o(()=>[s(e(te),{class:"mr-2 h-4 w-4"}),t[12]||(t[12]=l(" Filtros ",-1))]),_:1}),s(e($),{value:"settings"},{default:o(()=>[s(e(se),{class:"mr-2 h-4 w-4"}),t[13]||(t[13]=l(" Configuración ",-1))]),_:1}),s(e($),{value:"roles"},{default:o(()=>[s(e(oe),{class:"mr-2 h-4 w-4"}),t[14]||(t[14]=l(" Roles ",-1))]),_:1})]),_:1}),s(e(V),{value:"general"},{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[s(e(y),null,{default:o(()=>[...t[15]||(t[15]=[l("Información General",-1)])]),_:1}),s(e(b),null,{default:o(()=>[...t[16]||(t[16]=[l(" Define el nombre y descripción del segmento ",-1)])]),_:1})]),_:1}),s(e(x),{class:"space-y-4"},{default:o(()=>[r("div",ae,[s(e(d),{htmlFor:"name"},{default:o(()=>[...t[17]||(t[17]=[l("Nombre del Segmento",-1)])]),_:1}),s(e(U),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(i).name=a),placeholder:"Usuarios por Región Norte"},null,8,["modelValue"]),s(p,{message:e(i).errors.name},null,8,["message"])]),r("div",ne,[s(e(d),{htmlFor:"description"},{default:o(()=>[...t[18]||(t[18]=[l("Descripción",-1)])]),_:1}),s(e(G),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":t[1]||(t[1]=a=>e(i).description=a),placeholder:"Describe el propósito y criterios de este segmento...",rows:"4"},null,8,["modelValue"]),s(p,{message:e(i).errors.description},null,8,["message"])]),r("div",de,[s(e(d),{htmlFor:"model_type"},{default:o(()=>[...t[19]||(t[19]=[l("Tipo de Modelo",-1)])]),_:1}),s(e(E),{modelValue:e(i).model_type,"onUpdate:modelValue":t[2]||(t[2]=a=>e(i).model_type=a)},{default:o(()=>[s(e(O),null,{default:o(()=>[s(e(P),{placeholder:"Selecciona el tipo de modelo"})]),_:1}),s(e(Q),null,{default:o(()=>[(m(!0),_(F,null,w(g.modelTypes,(a,k)=>(m(),C(e(H),{key:k,value:k},{default:o(()=>[l(f(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),t[20]||(t[20]=r("p",{class:"text-xs text-muted-foreground"}," Selecciona el modelo de datos sobre el que aplicar el segmento ",-1)),s(p,{message:e(i).errors.model_type},null,8,["message"])])]),_:1})]),_:1})]),_:1}),s(e(V),{value:"filters"},{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[s(e(y),null,{default:o(()=>[...t[21]||(t[21]=[l("Criterios de Filtrado",-1)])]),_:1}),s(e(b),null,{default:o(()=>[...t[22]||(t[22]=[l(" Define los filtros que determinarán qué usuarios pertenecen a este segmento ",-1)])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[s(Y,{ref_key:"advancedFiltersRef",ref:N,config:{fields:g.filterFieldsConfig,showQuickSearch:!1},route:"",onApply:A},null,8,["config"]),s(p,{message:e(i).errors.filters},null,8,["message"]),t[23]||(t[23]=r("div",{class:"mt-4 p-4 bg-muted/50 rounded-lg"},[r("p",{class:"text-sm text-muted-foreground"},[r("strong",null,"Nota:"),l(" Los filtros definidos aquí serán aplicados dinámicamente para determinar qué usuarios pertenecen a este segmento. Los segmentos dinámicos se recalculan automáticamente según los criterios establecidos. ")])],-1))]),_:1})]),_:1})]),_:1}),s(e(V),{value:"settings"},{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[s(e(y),null,{default:o(()=>[...t[24]||(t[24]=[l("Configuración del Segmento",-1)])]),_:1}),s(e(b),null,{default:o(()=>[...t[25]||(t[25]=[l(" Ajusta el comportamiento y cache del segmento ",-1)])]),_:1})]),_:1}),s(e(x),{class:"space-y-6"},{default:o(()=>[r("div",me,[r("div",ue,[s(e(d),null,{default:o(()=>[...t[26]||(t[26]=[l("Tipo de Segmento",-1)])]),_:1}),t[27]||(t[27]=r("p",{class:"text-sm text-muted-foreground"}," Los segmentos dinámicos se recalculan en tiempo real ",-1))]),r("div",fe,[s(e(d),{htmlFor:"is_dynamic",class:"text-sm"},{default:o(()=>[...t[28]||(t[28]=[l("Dinámico",-1)])]),_:1}),s(e(I),{id:"is_dynamic",modelValue:e(i).is_dynamic,"onUpdate:modelValue":t[3]||(t[3]=a=>e(i).is_dynamic=a)},null,8,["modelValue"])])]),r("div",pe,[s(e(d),{htmlFor:"cache_duration"},{default:o(()=>[...t[29]||(t[29]=[l("Duración del Cache (segundos)",-1)])]),_:1}),r("div",_e,[s(e(U),{id:"cache_duration",modelValue:e(i).cache_duration,"onUpdate:modelValue":t[4]||(t[4]=a=>e(i).cache_duration=a),modelModifiers:{number:!0},type:"number",min:"0",max:"86400"},null,8,["modelValue"]),r("div",ge,[r("span",ce,f(h(e(i).cache_duration)),1)])]),t[30]||(t[30]=r("p",{class:"text-xs text-muted-foreground"}," Tiempo que se mantendrán en cache los resultados del segmento (0 = sin cache) ",-1)),s(p,{message:e(i).errors.cache_duration},null,8,["message"])]),r("div",null,[s(e(d),{class:"text-sm font-medium"},{default:o(()=>[...t[31]||(t[31]=[l("Valores Predefinidos",-1)])]),_:1}),r("div",ve,[s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[5]||(t[5]=a=>e(i).cache_duration=60)},{default:o(()=>[...t[32]||(t[32]=[l(" 1 minuto ",-1)])]),_:1}),s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[6]||(t[6]=a=>e(i).cache_duration=300)},{default:o(()=>[...t[33]||(t[33]=[l(" 5 minutos ",-1)])]),_:1}),s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[7]||(t[7]=a=>e(i).cache_duration=1800)},{default:o(()=>[...t[34]||(t[34]=[l(" 30 minutos ",-1)])]),_:1}),s(e(u),{type:"button",variant:"outline",size:"sm",onClick:t[8]||(t[8]=a=>e(i).cache_duration=3600)},{default:o(()=>[...t[35]||(t[35]=[l(" 1 hora ",-1)])]),_:1})])])]),_:1})]),_:1})]),_:1}),s(e(V),{value:"roles"},{default:o(()=>[s(e(c),null,{default:o(()=>[s(e(v),null,{default:o(()=>[s(e(y),null,{default:o(()=>[...t[36]||(t[36]=[l("Roles Asociados",-1)])]),_:1}),s(e(b),null,{default:o(()=>[...t[37]||(t[37]=[l(" Vincula este segmento con roles específicos para delimitar el alcance de datos ",-1)])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[g.roles.length>0?(m(),_("div",ye,[(m(!0),_(F,null,w(g.roles,a=>(m(),_("div",{key:a.id,class:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-muted/50"},[s(e(J),{checked:e(i).role_ids.includes(a.id),"onUpdate:checked":k=>q(a.id),class:"mt-1"},null,8,["checked","onUpdate:checked"]),r("div",xe,[s(e(d),{class:"text-sm font-medium cursor-pointer"},{default:o(()=>[l(f(a.display_name),1)]),_:2},1024),r("p",be,f(a.description||"Sin descripción"),1),s(e(K),{variant:"outline",class:"mt-2"},{default:o(()=>[l(f(a.name),1)]),_:2},1024)])]))),128))])):(m(),_("div",$e," No hay roles disponibles ")),s(p,{message:e(i).errors.role_ids},null,8,["message"])]),_:1})]),_:1})]),_:1})]),_:1}),r("div",Ve,[s(e(S),{href:n.route("admin.segments.index")},{default:o(()=>[s(e(u),{type:"button",variant:"outline"},{default:o(()=>[...t[38]||(t[38]=[l(" Cancelar ",-1)])]),_:1})]),_:1},8,["href"]),s(e(u),{type:"submit",disabled:e(i).processing},{default:o(()=>[s(e(le),{class:"mr-2 h-4 w-4"}),l(" "+f(e(i).processing?"Creando...":"Crear Segmento"),1)]),_:1},8,["disabled"])])],32)])]),_:1}))}});export{jt as default};
