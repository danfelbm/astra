import{d as re,a as d,o as n,b as a,i as m,u as e,e as l,g as c,t as u,F as U,r as B,j as b,k as $,c as z,w as te,f as i,n as O,h as ve,C as _e,p as ge,m as xe,L as he,l as be,W as q}from"./app-adm4E9By.js";import{_ as fe}from"./index-RIp_-Vk5.js";import{c as ye,_ as k}from"./createLucideIcon-BZexDsQJ.js";import{_ as L,c as M,a as R,b as G}from"./CardTitle.vue_vue_type_script_setup_true_lang-ouwQQD5O.js";import{_ as ke}from"./Checkbox.vue_vue_type_script_setup_true_lang-JizJBHFY.js";import{_ as $e}from"./Input.vue_vue_type_script_setup_true_lang-DPeax23E.js";import{_ as S}from"./Label.vue_vue_type_script_setup_true_lang-U1PsHnlq.js";import{_ as ae,a as oe,b as se,c as le,d as ie}from"./SelectValue.vue_vue_type_script_setup_true_lang-COAsKRo-.js";import{_ as Ve,a as we,b as K,c as Y}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-91sUiwod.js";import{_ as Ce}from"./Textarea.vue_vue_type_script_setup_true_lang-BVFP9d73.js";import{_ as ee}from"./DateTimePicker.vue_vue_type_script_setup_true_lang-BquL-eJU.js";import{_ as Se}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DhCpEapD.js";import{L as Ue,a as Ee,_ as ze}from"./DynamicFormBuilder.vue_vue_type_script_setup_true_lang-BjTqj2SN.js";import{_ as Ae}from"./CsvImportWizard.vue_vue_type_script_setup_true_lang-Bq40tEuf.js";import{_ as Ie,a as je,b as Be,c as De,d as Fe,e as Le}from"./index-CGEnb3Wl.js";import{_ as Me,a as Ne,b as Pe}from"./PopoverTrigger.vue_vue_type_script_setup_true_lang-CfQmYURr.js";import{u as qe}from"./useDebounce-DJcXAjPD.js";import{C as Te}from"./chevrons-up-down-HPS1mOzq.js";import{L as ne}from"./loader-circle-VzOlCmBW.js";import{U as de}from"./user-9gw01jjs.js";import{U as He}from"./user-plus-BnNtGbpS.js";import{X as Re}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CUlOaAYK.js";import{M as Ge}from"./mail-UBizeoOQ.js";import{P as Oe}from"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-CwctApMP.js";import{C as We}from"./check-7dEyZjxo.js";import{C as Xe}from"./circle-alert-DH-tXgXk.js";import{U as ue}from"./upload-BmKGueyB.js";import{P as Ze}from"./plus-mxdiJDdT.js";import{H as ce}from"./history-hGl6O7xl.js";import{T as Qe}from"./trash-2-DB0L4lLl.js";import{C as Je}from"./circle-x-CsUMN6XK.js";import{C as Ke}from"./circle-check-big-CKKdqxik.js";import{C as me}from"./clock-DS0a750w.js";import"./index-BljgFSoA.js";import"./index-D_FvUGWk.js";import"./floating-ui.vue-CHVdCOHU.js";import"./VisuallyHidden-CHziw9t0.js";import"./RovingFocusItem-suCC6Iut.js";import"./utils-CHumlc8X.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-DJj5orOZ.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CUrUy-W4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Dt3CXXnZ.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-B2K2P9ZP.js";import"./users-DZL9w0oY.js";import"./shield-BA_mSgwr.js";import"./vote-tpsNvE_M.js";import"./file-text-8gYHGT8o.js";import"./calendar-W5yOTorW.js";import"./briefcase-CsGy18Yk.js";import"./megaphone-CGlNxhdi.js";import"./user-check-xz8sJqrM.js";import"./external-link-CDS4yhn-.js";import"./panel-left-s67SQ0O6.js";import"./index-DB-wCrKJ.js";import"./index-C3hFIBGF.js";import"./grip-vertical-C7iH4eI-.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-Bq7NmKO-.js";import"./eye-DpvTalqH.js";import"./git-branch-Di8ekFAU.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-DZJR0ydD.js";import"./index-CTSynztt.js";import"./search-Bc7_Mqt5.js";import"./VisuallyHiddenInput-DAllJD5K.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Dk5CULeb.js";import"./map-pin-BDFPWgVN.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ye("CreditCardIcon",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),et={key:0,class:"text-red-500"},tt={key:0,class:"text-sm text-destructive mt-1"},at={key:1,class:"text-xs text-muted-foreground mt-1"},ot=re({__name:"TimezoneSelector",props:{modelValue:{},disabled:{type:Boolean,default:!1},label:{default:"Zona Horaria"},placeholder:{default:"Seleccionar zona horaria"},description:{default:"Las fechas de apertura y cierre se aplicarán según esta zona horaria"},required:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(T,{emit:f}){const v=f,N=x=>{v("update:modelValue",x)};return(x,V)=>(n(),d("div",null,[a(e(S),null,{default:l(()=>[c(u(x.label)+" ",1),x.required?(n(),d("span",et,"*")):m("",!0)]),_:1}),a(e(ae),{"model-value":x.modelValue,"onUpdate:modelValue":N,disabled:x.disabled},{default:l(()=>[a(e(oe),null,{default:l(()=>[a(e(se),{placeholder:x.placeholder},null,8,["placeholder"])]),_:1}),a(e(le),null,{default:l(()=>[(n(!0),d(U,null,B(e(Ue),o=>(n(),b(e(ie),{key:o.value,value:o.value},{default:l(()=>[c(u(o.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),x.error?(n(),d("p",tt,u(x.error),1)):x.description?(n(),d("p",at,u(x.description),1)):m("",!0)]))}}),st={class:"space-y-3"},lt={key:0,class:"flex flex-wrap gap-2"},it={class:"text-xs"},rt={class:"flex gap-2"},nt={key:0,class:"py-6 text-center text-sm"},dt={class:"py-6 text-center text-sm"},ut={key:2,class:"py-6 text-center text-sm text-muted-foreground"},ct={key:0,class:"px-2 py-1.5 text-xs text-muted-foreground"},mt={class:"flex items-start justify-between w-full"},ft={class:"flex-1 min-w-0"},pt={class:"flex items-center gap-2"},vt={class:"font-medium truncate"},_t={class:"flex items-center gap-2 mt-1"},gt={class:"text-xs text-muted-foreground truncate"},xt={class:"flex items-center gap-4 mt-1"},ht={key:0,class:"flex items-center gap-1"},bt={class:"text-xs text-muted-foreground"},yt={key:1,class:"flex items-center gap-1"},kt={class:"text-xs text-muted-foreground"},$t={key:1,class:"p-2"},Vt={key:2,class:"p-2 text-center"},wt=re({__name:"UserMultiSelectCombobox",props:{votacionId:{},placeholder:{default:"Buscar usuarios..."},disabled:{type:Boolean,default:!1}},emits:["add-users"],setup(T,{emit:f}){const v=T,N=f,x=$(!1),V=$(""),o=$(!1),h=$([]),A=$(!1),D=$(1),_=$([]),w=$(0),{debounce:I}=qe(),C=z(()=>_.value.length===0?v.placeholder:`${_.value.length} usuario${_.value.length!==1?"s":""} seleccionado${_.value.length!==1?"s":""}`),E=z(()=>_.value.length>0),j=async(g,p=1)=>{if(g.length<2){h.value=[],w.value=0,A.value=!1;return}o.value=!0;try{const t=await(await fetch(`/admin/votaciones/${v.votacionId}/search-users?query=${encodeURIComponent(g)}&page=${p}`)).json();p===1?h.value=t.users||[]:h.value=[...h.value,...t.users||[]],A.value=t.has_more||!1,w.value=t.total||0,D.value=t.page||1}catch(s){console.error("Error buscando usuarios:",s),h.value=[],A.value=!1,w.value=0}finally{o.value=!1}},H=I(g=>{D.value=1,j(g,1)},300);te(V,g=>{H(g)});const P=g=>_.value.some(p=>p.id===g.id),W=g=>{P(g)?_.value=_.value.filter(p=>p.id!==g.id):_.value.push(g)},F=g=>{_.value=_.value.filter(p=>p.id!==g.id)},X=()=>{!A.value||o.value||j(V.value,D.value+1)},Z=()=>{_.value.length!==0&&(N("add-users",[..._.value]),_.value=[],V.value="",h.value=[],x.value=!1)},Q=()=>{_.value=[]},J=g=>g?g.length>4?`***${g.slice(-4)}`:"****":"";return(g,p)=>(n(),d("div",st,[_.value.length>0?(n(),d("div",lt,[(n(!0),d(U,null,B(_.value,s=>(n(),b(e(fe),{key:s.id,variant:"secondary",class:"pl-2 pr-1 py-1"},{default:l(()=>[i("span",it,u(s.name),1),a(e(k),{variant:"ghost",size:"sm",class:"h-4 w-4 p-0 ml-2 hover:bg-transparent",onClick:t=>F(s)},{default:l(()=>[a(e(Re),{class:"h-3 w-3"})]),_:2},1032,["onClick"])]),_:2},1024))),128)),_.value.length>0?(n(),b(e(k),{key:0,variant:"ghost",size:"sm",class:"h-6 px-2 text-xs",onClick:Q},{default:l(()=>p[2]||(p[2]=[c(" Limpiar todo ")])),_:1})):m("",!0)])):m("",!0),i("div",rt,[a(e(Me),{open:x.value,"onUpdate:open":p[1]||(p[1]=s=>x.value=s)},{default:l(()=>[a(e(Ne),{"as-child":""},{default:l(()=>[a(e(k),{variant:"outline",role:"combobox","aria-expanded":x.value,disabled:g.disabled,class:"flex-1 justify-between"},{default:l(()=>[i("span",{class:O(E.value?"":"text-muted-foreground")},u(C.value),3),a(e(Te),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:1},8,["aria-expanded","disabled"])]),_:1}),a(e(Pe),{class:"w-[400px] p-0",align:"start"},{default:l(()=>[a(e(Ie),null,{default:l(()=>[a(e(je),{modelValue:V.value,"onUpdate:modelValue":p[0]||(p[0]=s=>V.value=s),placeholder:"Buscar por nombre, email, cédula o teléfono...",class:"h-9"},null,8,["modelValue"]),a(e(Be),null,{default:l(()=>[o.value&&h.value.length===0?(n(),d("div",nt,[a(e(ne),{class:"h-4 w-4 animate-spin mx-auto mb-2"}),p[3]||(p[3]=i("p",null,"Buscando usuarios...",-1))])):V.value.length>=2&&h.value.length===0&&!o.value?(n(),b(e(De),{key:1},{default:l(()=>[i("div",dt,[a(e(de),{class:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),p[4]||(p[4]=i("p",null,"No se encontraron usuarios",-1)),p[5]||(p[5]=i("p",{class:"text-xs text-muted-foreground mt-1"}," Intenta con otro término de búsqueda ",-1))])]),_:1})):V.value.length<2?(n(),d("div",ut,p[6]||(p[6]=[i("p",null,"Escribe al menos 2 caracteres para buscar",-1)]))):(n(),b(e(Fe),{key:3},{default:l(()=>[w.value>0?(n(),d("div",ct,u(w.value)+" "+u(w.value===1?"resultado":"resultados"),1)):m("",!0),(n(!0),d(U,null,B(h.value,s=>(n(),b(e(Le),{key:s.id,value:s.id.toString(),onSelect:t=>W(s),class:O(["cursor-pointer",P(s)?"bg-accent":""])},{default:l(()=>[i("div",mt,[i("div",ft,[i("div",pt,[a(e(de),{class:"h-3 w-3 text-muted-foreground shrink-0"}),i("span",vt,u(s.name),1)]),i("div",_t,[a(e(Ge),{class:"h-3 w-3 text-muted-foreground shrink-0"}),i("span",gt,u(s.email),1)]),i("div",xt,[s.documento_identidad?(n(),d("div",ht,[a(e(Ye),{class:"h-3 w-3 text-muted-foreground shrink-0"}),i("span",bt,u(J(s.documento_identidad)),1)])):m("",!0),s.telefono?(n(),d("div",yt,[a(e(Oe),{class:"h-3 w-3 text-muted-foreground shrink-0"}),i("span",kt,u(s.telefono),1)])):m("",!0)])]),P(s)?(n(),b(e(We),{key:0,class:"h-4 w-4 text-primary shrink-0 ml-2"})):m("",!0)])]),_:2},1032,["value","onSelect","class"]))),128)),A.value&&!o.value?(n(),d("div",$t,[a(e(k),{variant:"ghost",size:"sm",class:"w-full",onClick:ve(X,["stop"])},{default:l(()=>p[7]||(p[7]=[c(" Cargar más resultados ")])),_:1})])):m("",!0),o.value&&h.value.length>0?(n(),d("div",Vt,[a(e(ne),{class:"h-4 w-4 animate-spin mx-auto"})])):m("",!0)]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(e(k),{onClick:Z,disabled:!E.value,variant:"default"},{default:l(()=>[a(e(He),{class:"mr-2 h-4 w-4"}),c(" Agregar "+u(_.value.length||""),1)]),_:1},8,["disabled"])])]))}}),Ct={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},St={class:"flex items-center justify-between"},Ut={class:"text-3xl font-bold"},Et={class:"text-muted-foreground"},zt={class:"relative min-h-[70vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},At={class:"grid gap-6 md:grid-cols-2"},It={class:"space-y-4"},jt={key:0,class:"text-sm text-destructive mt-1"},Bt={key:0,class:"text-sm text-destructive mt-1"},Dt={key:0,class:"text-sm text-destructive mt-1"},Ft={class:"space-y-4"},Lt={key:0,class:"text-sm text-destructive mt-1"},Mt={key:0,class:"text-sm text-destructive mt-1"},Nt={key:1,class:"text-sm text-destructive mt-1"},Pt={class:"flex items-center space-x-2"},qt={key:0,class:"space-y-2"},Tt={class:"flex justify-between"},Ht={class:"flex gap-2"},Rt={class:"flex justify-between"},Gt={class:"flex gap-2"},Ot={class:"flex items-center space-x-2 text-yellow-700"},Wt={class:"space-y-4"},Xt={class:"flex items-center gap-2"},Zt={key:0,class:"text-center py-6 text-muted-foreground"},Qt={key:1,class:"space-y-3"},Jt=["onClick"],Kt={class:"flex items-center gap-3"},Yt={class:"font-medium text-sm"},ea={class:"text-xs text-muted-foreground"},ta={class:"flex items-center gap-2"},aa={key:0,class:"text-xs text-muted-foreground"},oa={key:0},sa={key:1,class:"text-xs text-muted-foreground"},la={key:0,class:"text-center py-8 text-muted-foreground"},ia={key:1,class:"space-y-2"},ra={class:"font-medium"},na={class:"text-sm text-muted-foreground"},da={class:"flex justify-between"},$o=re({__name:"Form",props:{categorias:{},votacion:{},cargos:{},periodosElectorales:{},convocatorias:{},canManageVoters:{type:Boolean}},setup(T){var p;const f=T,v=z(()=>!!f.votacion),N=z(()=>{var s;return v.value&&((s=f.votacion)==null?void 0:s.estado)==="borrador"&&f.canManageVoters}),x=[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:v.value?"Editar":"Crear",href:"#"}],V=()=>{if(!f.votacion)return{titulo:"",descripcion:"",categoria_id:"",fecha_inicio:null,fecha_fin:null,estado:"borrador",resultados_publicos:!1,fecha_publicacion_resultados:null,formulario_config:[],timezone:"America/Bogota",territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[]};const s=f.votacion;return{titulo:s.titulo||"",descripcion:s.descripcion||"",categoria_id:s.categoria_id?String(s.categoria_id):"",fecha_inicio:s.fecha_inicio||null,fecha_fin:s.fecha_fin||null,estado:s.estado||"borrador",resultados_publicos:!!s.resultados_publicos,fecha_publicacion_resultados:s.fecha_publicacion_resultados||null,formulario_config:s.formulario_config||[],timezone:s.timezone||"America/Bogota",territorios_ids:s.territorios_ids||[],departamentos_ids:s.departamentos_ids||[],municipios_ids:s.municipios_ids||[],localidades_ids:s.localidades_ids||[]}},o=_e(V()),h=$("basicos"),A=[{value:"borrador",label:"Borrador"},{value:"activa",label:"Activa"},{value:"finalizada",label:"Finalizada"}],D=z({get:()=>({territorios_ids:o.territorios_ids||[],departamentos_ids:o.departamentos_ids||[],municipios_ids:o.municipios_ids||[],localidades_ids:o.localidades_ids||[]}),set:s=>{o.territorios_ids=s.territorios_ids,o.departamentos_ids=s.departamentos_ids,o.municipios_ids=s.municipios_ids,o.localidades_ids=s.localidades_ids}}),_=z(()=>!o.fecha_fin||!o.fecha_inicio?"":o.fecha_fin<=o.fecha_inicio?"La fecha de fin debe ser posterior a la fecha de inicio":""),w=()=>{if(!I.value){h.value="basicos",alert('Por favor completa todos los campos requeridos en la pestaña "Datos Básicos" antes de crear la votación.');return}if(o.formulario_config.length===0){alert("Por favor agrega al menos un campo al formulario antes de crear la votación.");return}v.value?o.put(`/admin/votaciones/${f.votacion.id}`,{onError:s=>{const t=Object.values(s)[0];t&&alert(`Error: ${Array.isArray(t)?t[0]:t}`)}}):o.post("/admin/votaciones",{onError:s=>{const t=Object.values(s)[0];t&&alert(`Error: ${Array.isArray(t)?t[0]:t}`)}})},I=z(()=>o.titulo&&o.categoria_id&&o.fecha_inicio&&o.fecha_fin&&o.timezone);z(()=>I.value&&o.formulario_config.length>0);const C=$(((p=f.votacion)==null?void 0:p.votantes)||[]),E=$(!1),j=$([]),H=async()=>{var s;if(!(!v.value||!((s=f.votacion)!=null&&s.id)))try{const t=await fetch(`/admin/votaciones/${f.votacion.id}/imports/recent`);if(t.ok){const r=await t.json();j.value=r}}catch(t){console.error("Error loading recent imports:",t)}},P=s=>{q.get(`/admin/imports/${s}`)},W=()=>{var s;(s=f.votacion)!=null&&s.id&&q.get(`/admin/votaciones/${f.votacion.id}/imports`)},F=s=>{switch(s){case"pending":return{icon:me,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:me,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:Ke,label:"Completada",class:"text-green-600"};case"failed":return{icon:Je,label:"Fallida",class:"text-red-600"}}},X=s=>new Date(s).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Z=s=>{var r;if(!s||s.length===0||!v.value||!((r=f.votacion)!=null&&r.id))return;const t=s.map(y=>y.id.toString());q.post(`/admin/votaciones/${f.votacion.id}/votantes`,{votante_ids:t},{preserveScroll:!0,onSuccess:()=>{s.forEach(y=>{C.value.some(pe=>pe.id===y.id)||C.value.push({id:y.id,name:y.name,email:y.email})})},onError:y=>{console.error("Error adding votantes:",y),alert("Error al agregar votantes")}})},Q=s=>{var t;!v.value||!((t=f.votacion)!=null&&t.id)||q.delete(`/admin/votaciones/${f.votacion.id}/votantes`,{data:{votante_id:s},preserveScroll:!0,onSuccess:()=>{C.value=C.value.filter(r=>r.id!==s)},onError:r=>{console.error("Error removing votante:",r),alert("Error al remover votante")}})},J=s=>{E.value=!1,H(),q.get(`/admin/imports/${s}`)},g=()=>{E.value=!1};return te(()=>f.votacion,s=>{if(s){const t=V();o.titulo=t.titulo,o.descripcion=t.descripcion,o.categoria_id=t.categoria_id,o.fecha_inicio=t.fecha_inicio,o.fecha_fin=t.fecha_fin,o.estado=t.estado,o.resultados_publicos=t.resultados_publicos,o.fecha_publicacion_resultados=t.fecha_publicacion_resultados,o.formulario_config=t.formulario_config,o.timezone=t.timezone,v.value&&H()}},{immediate:!0,deep:!0}),te(()=>o.resultados_publicos,s=>{console.log("resultados_publicos changed to:",s)},{immediate:!0}),ge(()=>{}),(s,t)=>(n(),d(U,null,[a(e(xe),{title:v.value?"Editar Votación":"Nueva Votación"},null,8,["title"]),a(Se,{breadcrumbs:x},{default:l(()=>[i("div",Ct,[i("div",St,[i("div",null,[i("h1",Ut,u(v.value?"Editar Votación":"Nueva Votación"),1),i("p",Et,u(v.value?"Modifica los datos de la votación":"Crea una nueva votación paso a paso"),1)])]),i("div",zt,[a(e(L),{class:"border-0 shadow-none h-full"},{default:l(()=>[a(e(M),{class:"p-6"},{default:l(()=>[a(e(Ve),{modelValue:h.value,"onUpdate:modelValue":t[16]||(t[16]=r=>h.value=r),class:"w-full"},{default:l(()=>[a(e(we),{class:"grid w-full grid-cols-3"},{default:l(()=>[a(e(K),{value:"basicos"},{default:l(()=>t[17]||(t[17]=[i("span",{class:"flex items-center gap-2"},[i("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"1"),c(" Datos Básicos ")],-1)])),_:1}),a(e(K),{value:"formulario",disabled:!v.value&&!I.value},{default:l(()=>t[18]||(t[18]=[i("span",{class:"flex items-center gap-2"},[i("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"2"),c(" Formulario ")],-1)])),_:1},8,["disabled"]),a(e(K),{value:"votantes",disabled:!v.value},{default:l(()=>t[19]||(t[19]=[i("span",{class:"flex items-center gap-2"},[i("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"3"),c(" Votantes ")],-1)])),_:1},8,["disabled"])]),_:1}),a(e(Y),{value:"basicos",class:"space-y-6"},{default:l(()=>[i("div",At,[i("div",It,[i("div",null,[a(e(S),{for:"titulo"},{default:l(()=>t[20]||(t[20]=[c("Título *")])),_:1}),a(e($e),{id:"titulo",modelValue:e(o).titulo,"onUpdate:modelValue":t[0]||(t[0]=r=>e(o).titulo=r),placeholder:"Nombre de la votación",error:e(o).errors.titulo},null,8,["modelValue","error"]),e(o).errors.titulo?(n(),d("p",jt,u(e(o).errors.titulo),1)):m("",!0)]),i("div",null,[a(e(S),{for:"descripcion"},{default:l(()=>t[21]||(t[21]=[c("Descripción")])),_:1}),a(e(Ce),{id:"descripcion",modelValue:e(o).descripcion,"onUpdate:modelValue":t[1]||(t[1]=r=>e(o).descripcion=r),placeholder:"Descripción detallada de la votación",rows:"4"},null,8,["modelValue"]),e(o).errors.descripcion?(n(),d("p",Bt,u(e(o).errors.descripcion),1)):m("",!0)]),i("div",null,[a(e(S),{for:"categoria"},{default:l(()=>t[22]||(t[22]=[c("Categoría *")])),_:1}),a(e(ae),{modelValue:e(o).categoria_id,"onUpdate:modelValue":t[2]||(t[2]=r=>e(o).categoria_id=r)},{default:l(()=>[a(e(oe),null,{default:l(()=>[a(e(se),{placeholder:"Seleccionar categoría"})]),_:1}),a(e(le),null,{default:l(()=>[(n(!0),d(U,null,B(s.categorias,r=>(n(),b(e(ie),{key:r.id,value:r.id.toString()},{default:l(()=>[c(u(r.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(o).errors.categoria_id?(n(),d("p",Dt,u(e(o).errors.categoria_id),1)):m("",!0)]),a(Ee,{modelValue:D.value,"onUpdate:modelValue":t[3]||(t[3]=r=>D.value=r)},null,8,["modelValue"])]),i("div",Ft,[i("div",null,[a(e(S),{for:"fecha_inicio"},{default:l(()=>t[23]||(t[23]=[c("Fecha y Hora de Inicio *")])),_:1}),a(e(ee),{modelValue:e(o).fecha_inicio,"onUpdate:modelValue":t[4]||(t[4]=r=>e(o).fecha_inicio=r),placeholder:"Seleccionar fecha y hora de inicio"},null,8,["modelValue"]),e(o).errors.fecha_inicio?(n(),d("p",Lt,u(e(o).errors.fecha_inicio),1)):m("",!0)]),i("div",null,[a(e(S),{for:"fecha_fin"},{default:l(()=>t[24]||(t[24]=[c("Fecha y Hora de Fin *")])),_:1}),a(e(ee),{modelValue:e(o).fecha_fin,"onUpdate:modelValue":t[5]||(t[5]=r=>e(o).fecha_fin=r),placeholder:"Seleccionar fecha y hora de fin"},null,8,["modelValue"]),_.value?(n(),d("p",Mt,u(_.value),1)):m("",!0),e(o).errors.fecha_fin?(n(),d("p",Nt,u(e(o).errors.fecha_fin),1)):m("",!0)]),i("div",null,[a(e(S),{for:"estado"},{default:l(()=>t[25]||(t[25]=[c("Estado")])),_:1}),a(e(ae),{modelValue:e(o).estado,"onUpdate:modelValue":t[6]||(t[6]=r=>e(o).estado=r)},{default:l(()=>[a(e(oe),null,{default:l(()=>[a(e(se))]),_:1}),a(e(le),null,{default:l(()=>[(n(),d(U,null,B(A,r=>a(e(ie),{key:r.value,value:r.value},{default:l(()=>[c(u(r.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),a(ot,{modelValue:e(o).timezone,"onUpdate:modelValue":t[7]||(t[7]=r=>e(o).timezone=r),required:"",error:e(o).errors.timezone},null,8,["modelValue","error"]),i("div",Pt,[a(e(ke),{id:"resultados_publicos",checked:e(o).resultados_publicos,"onUpdate:checked":t[8]||(t[8]=r=>e(o).resultados_publicos=r)},null,8,["checked"]),a(e(S),{for:"resultados_publicos"},{default:l(()=>t[26]||(t[26]=[c(" Resultados públicos ")])),_:1})]),a(he,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:l(()=>[e(o).resultados_publicos?(n(),d("div",qt,[a(e(S),{for:"fecha_publicacion_resultados"},{default:l(()=>t[27]||(t[27]=[c(" Fecha de publicación de resultados (opcional) ")])),_:1}),a(e(ee),{id:"fecha_publicacion_resultados",modelValue:e(o).fecha_publicacion_resultados,"onUpdate:modelValue":t[9]||(t[9]=r=>e(o).fecha_publicacion_resultados=r),placeholder:"Dejar vacío para publicar al finalizar la votación"},null,8,["modelValue"]),t[28]||(t[28]=i("p",{class:"text-xs text-muted-foreground"}," Si se especifica una fecha, los resultados serán visibles desde esa fecha. Si se deja vacío, los resultados solo serán visibles después de que termine la votación. ",-1))])):m("",!0)]),_:1})])]),i("div",Tt,[t[30]||(t[30]=i("div",null,null,-1)),i("div",Ht,[v.value?(n(),b(e(k),{key:0,onClick:w,disabled:e(o).processing||!I.value,variant:"default"},{default:l(()=>[c(u(e(o).processing?"Actualizando...":"Actualizar Votación"),1)]),_:1},8,["disabled"])):m("",!0),a(e(k),{onClick:t[10]||(t[10]=r=>h.value="formulario"),disabled:!I.value,variant:"outline"},{default:l(()=>t[29]||(t[29]=[c(" Siguiente: Configurar Formulario ")])),_:1},8,["disabled"])])])]),_:1}),a(e(Y),{value:"formulario",class:"space-y-6"},{default:l(()=>{var r;return[a(ze,{modelValue:e(o).formulario_config,"onUpdate:modelValue":t[11]||(t[11]=y=>e(o).formulario_config=y),title:"Constructor de Formulario",description:"Agrega los campos que aparecerán en la votación","show-perfil-candidatura-config":!0,"show-convocatoria-config":!0,cargos:((r=f.cargos)==null?void 0:r.filter(y=>y.es_cargo))||[],"periodos-electorales":f.periodosElectorales||[],convocatorias:f.convocatorias||[],context:"votacion"},null,8,["modelValue","cargos","periodos-electorales","convocatorias"]),i("div",Rt,[a(e(k),{variant:"outline",onClick:t[12]||(t[12]=y=>h.value="basicos")},{default:l(()=>t[31]||(t[31]=[c(" Anterior ")])),_:1}),i("div",Gt,[N.value&&f.canManageVoters?(n(),b(e(k),{key:0,variant:"outline",onClick:t[13]||(t[13]=y=>h.value="votantes"),disabled:e(o).formulario_config.length===0},{default:l(()=>t[32]||(t[32]=[c(" Siguiente: Gestionar Votantes ")])),_:1},8,["disabled"])):m("",!0),a(e(k),{onClick:w,disabled:e(o).processing||e(o).formulario_config.length===0},{default:l(()=>[c(u(e(o).processing?"Guardando...":v.value?"Actualizar":"Crear")+" Votación ",1)]),_:1},8,["disabled"])])])]}),_:1}),a(e(Y),{value:"votantes",class:"space-y-6"},{default:l(()=>[t[46]||(t[46]=i("div",null,[i("h3",{class:"text-lg font-semibold"},"Gestión de Votantes"),i("p",{class:"text-sm text-muted-foreground"}," Asigna los usuarios que podrán participar en esta votación ")],-1)),f.canManageVoters?m("",!0):(n(),b(e(L),{key:0,class:"border-yellow-200 bg-yellow-50"},{default:l(()=>[a(e(M),{class:"pt-6"},{default:l(()=>[i("div",Ot,[a(e(Xe),{class:"h-5 w-5"}),t[33]||(t[33]=i("p",{class:"font-semibold"},"Sin permisos para manejar censo electoral",-1))]),t[34]||(t[34]=i("p",{class:"mt-2 text-sm text-gray-600"}," No tienes los permisos necesarios para gestionar el censo electoral de esta votación. Contacta a un administrador si necesitas acceso a esta funcionalidad. ",-1))]),_:1})]),_:1})),f.canManageVoters?(n(),d(U,{key:1},[E.value?m("",!0):(n(),b(e(L),{key:0},{default:l(()=>[a(e(R),null,{default:l(()=>[a(e(G),{class:"flex items-center gap-2"},{default:l(()=>[a(e(ue),{class:"h-5 w-5"}),t[35]||(t[35]=c(" Importar Votantes "))]),_:1})]),_:1}),a(e(M),null,{default:l(()=>[i("div",Wt,[t[37]||(t[37]=i("p",{class:"text-sm text-muted-foreground"}," Importa votantes desde un archivo CSV con mapeo dinámico de campos. Los usuarios importados serán asignados automáticamente a esta votación. ",-1)),t[38]||(t[38]=i("p",{class:"text-sm text-blue-600"},[i("a",{href:"/ejemplo-usuarios.csv",download:"",class:"underline"}," 📥 Descargar plantilla CSV de ejemplo ")],-1)),a(e(k),{variant:"outline",onClick:t[14]||(t[14]=r=>E.value=!0)},{default:l(()=>[a(e(ue),{class:"mr-2 h-4 w-4"}),t[36]||(t[36]=c(" Iniciar Importación "))]),_:1})])]),_:1})]),_:1})),E.value&&v.value&&s.votacion?(n(),b(Ae,{key:1,mode:"votacion","votacion-id":s.votacion.id,"votacion-titulo":s.votacion.titulo,"redirect-on-success":!1,onSuccess:J,onCancel:g},null,8,["votacion-id","votacion-titulo"])):m("",!0),v.value?(n(),b(e(L),{key:2},{default:l(()=>[a(e(R),null,{default:l(()=>[a(e(G),{class:"flex items-center gap-2"},{default:l(()=>[a(e(Ze),{class:"h-5 w-5"}),t[39]||(t[39]=c(" Agregar Votantes "))]),_:1})]),_:1}),a(e(M),null,{default:l(()=>{var r;return[(r=f.votacion)!=null&&r.id?(n(),b(e(wt),{key:0,"votacion-id":f.votacion.id,placeholder:"Buscar usuarios por nombre, email, cédula o teléfono...",onAddUsers:Z},null,8,["votacion-id"])):m("",!0)]}),_:1})]),_:1})):m("",!0),v.value?(n(),b(e(L),{key:3},{default:l(()=>[a(e(R),null,{default:l(()=>[a(e(G),{class:"flex items-center justify-between"},{default:l(()=>[i("span",Xt,[a(e(ce),{class:"h-5 w-5"}),t[40]||(t[40]=c(" Historial de Importaciones "))]),j.value.length>0?(n(),b(e(k),{key:0,variant:"outline",size:"sm",onClick:W},{default:l(()=>t[41]||(t[41]=[c(" Ver Todas ")])),_:1})):m("",!0)]),_:1})]),_:1}),a(e(M),null,{default:l(()=>[j.value.length===0?(n(),d("div",Zt,[a(e(ce),{class:"mx-auto h-8 w-8 mb-2"}),t[42]||(t[42]=i("p",null,"No hay importaciones registradas",-1)),t[43]||(t[43]=i("p",{class:"text-sm"},"Las importaciones aparecerán aquí una vez que subas archivos CSV",-1))])):(n(),d("div",Qt,[(n(!0),d(U,null,B(j.value,r=>(n(),d("div",{key:r.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:y=>P(r.id)},[i("div",Kt,[(n(),b(be(F(r.status).icon),{class:O(["h-4 w-4",F(r.status).class])},null,8,["class"])),i("div",null,[i("p",Yt,u(r.original_filename),1),i("p",ea," Por "+u(r.created_by.name)+" • "+u(X(r.created_at)),1)])]),i("div",ta,[a(e(fe),{variant:"outline",class:O(F(r.status).class)},{default:l(()=>[c(u(F(r.status).label),1)]),_:2},1032,["class"]),r.status==="completed"?(n(),d("div",aa,[c(u(r.successful_rows)+" exitosos ",1),r.failed_rows>0?(n(),d("span",oa,", "+u(r.failed_rows)+" errores",1)):m("",!0)])):r.status==="processing"?(n(),d("div",sa,u(r.progress_percentage)+"% ",1)):m("",!0)])],8,Jt))),128))]))]),_:1})]),_:1})):m("",!0),a(e(L),null,{default:l(()=>[a(e(R),null,{default:l(()=>[a(e(G),null,{default:l(()=>[c("Votantes Asignados ("+u(C.value.length)+")",1)]),_:1})]),_:1}),a(e(M),null,{default:l(()=>[C.value.length===0?(n(),d("div",la,t[44]||(t[44]=[i("p",null,"No hay votantes asignados a esta votación",-1),i("p",{class:"text-sm"},"Importa un archivo CSV o agrega votantes manualmente",-1)]))):(n(),d("div",ia,[(n(!0),d(U,null,B(C.value,r=>(n(),d("div",{key:r.id,class:"flex items-center justify-between p-3 border rounded-lg"},[i("div",null,[i("p",ra,u(r.name),1),i("p",na,u(r.email),1)]),a(e(k),{variant:"ghost",size:"sm",onClick:y=>Q(r.id)},{default:l(()=>[a(e(Qe),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick"])]))),128))]))]),_:1})]),_:1}),i("div",da,[a(e(k),{variant:"outline",onClick:t[15]||(t[15]=r=>h.value="formulario")},{default:l(()=>t[45]||(t[45]=[c(" Anterior ")])),_:1}),a(e(k),{onClick:w,disabled:e(o).processing},{default:l(()=>[c(u(e(o).processing?"Guardando...":"Actualizar")+" Votación ",1)]),_:1},8,["disabled"])])],64)):m("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])])]),_:1})],64))}});export{$o as default};
