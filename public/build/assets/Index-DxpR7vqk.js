import{d as M,k,j as _,o as i,e as s,b as t,f as o,u as e,m as H,P as x,g as n,a as v,i as p,A as K,t as u,F as w,r as P,n as W,W as E}from"./app-DUwT5XjW.js";import{g as q,a as y,U as G,h as I,i as O,j as Q,k as b,_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-C-TXGeAC.js";import{_ as h}from"./AppLogo.vue_vue_type_script_setup_true_lang-TtBKHXHP.js";import{_ as T,a as V}from"./CardContent.vue_vue_type_script_setup_true_lang-5UaTZODP.js";import{_ as X}from"./CardDescription.vue_vue_type_script_setup_true_lang-DfN2mHkg.js";import{_ as F,a as R}from"./CardTitle.vue_vue_type_script_setup_true_lang-DawTe2K_.js";import{_ as Y,a as Z,b as C,c as m,d as ee,e as d}from"./TableHeader.vue_vue_type_script_setup_true_lang-DMfadDvK.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-Bavi-x6e.js";import{_ as se}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-CDxT1ogn.js";import{P as le}from"./plus-C_Zgpucy.js";import{E as ae}from"./ellipsis-CT-kI882.js";import{E as re}from"./eye-DOHKdpym.js";import{S as ne}from"./square-pen-CLP5keS7.js";import{T as oe}from"./trash-2-CF8unIwz.js";import"./index-lXub5hNN.js";import"./index-S1odQ9fv.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-bnGfnvpd.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-CStynK6i.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-B-gFw3mk.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-B7z30C33.js";import"./usePrimitiveElement-DXJMmht_.js";import"./createContext-BqTg7DGM.js";import"./Collection-C7Tlg6fc.js";import"./useForwardExpose-DCR6Fykl.js";import"./useNonce-CVR6C3wM.js";import"./chevron-up-mMt2Z1mV.js";import"./handleAndDispatchCustomEvent-CYpUamdb.js";import"./nullish-CHIgUVhi.js";import"./useFormControl-B3_kincx.js";import"./VisuallyHidden-BH4I_bjZ.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-BpsL9h74.js";import"./search-YHCQULjN.js";import"./history-DZb0-jTg.js";import"./save-HBhGoMFp.js";import"./circle-alert-BDYdSiMf.js";const ie={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ue={class:"flex items-center justify-between"},de={class:"flex gap-4"},me={class:"flex-1"},fe={key:0},_e={class:"flex items-center gap-2"},pe={class:"font-semibold"},ce={class:"text-xs text-muted-foreground"},ge={class:"text-sm text-muted-foreground max-w-xs truncate"},xe={class:"flex items-center gap-1"},ve={class:"text-sm"},he={key:0,class:"flex items-center justify-center space-x-2 mt-6"},$e={class:"flex gap-1"},at=M({__name:"Index",props:{roles:{},segments:{},filters:{},filterFieldsConfig:{},availablePermissions:{}},setup(B){const f=B,D=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Roles y Permisos",href:"/admin/roles"}],$=k(f.filters.search||""),c=k(!1),g=a=>["super_admin","admin","manager","user","end_customer"].includes(a.name),N=a=>!a||a.length===0?"Sin permisos":a.includes("*")?"Todos los permisos":`${a.length} permisos`,U=a=>!a||a.length===0?"Sin usuarios":`${a.length} usuario${a.length!==1?"s":""}`,j=a=>!a||a.length===0?"Sin segmentos":`${a.length} segmento${a.length!==1?"s":""}`,S=()=>{E.get("/admin/roles",{search:$.value},{preserveState:!0,preserveScroll:!0})},A=a=>{confirm(`¿Estás seguro de eliminar el rol "${a.display_name}"?`)&&E.delete(`/admin/roles/${a.id}`)},z=a=>!g(a),L=a=>!g(a)&&(!a.users||a.users.length===0);return(a,l)=>(i(),_(J,{breadcrumbs:D},{default:s(()=>[t(e(H),{title:"Roles y Permisos"}),o("div",ie,[o("div",ue,[l[3]||(l[3]=o("div",null,[o("h2",{class:"text-2xl font-bold tracking-tight"},"Roles y Permisos"),o("p",{class:"text-muted-foreground"}," Gestiona los roles y permisos del sistema ")],-1)),t(e(x),{href:a.route("admin.roles.create")},{default:s(()=>[t(e(h),null,{default:s(()=>[t(e(le),{class:"mr-2 h-4 w-4"}),l[2]||(l[2]=n(" Nuevo Rol "))]),_:1})]),_:1},8,["href"])]),t(e(T),null,{default:s(()=>[t(e(F),null,{default:s(()=>[t(e(R),{class:"text-base"},{default:s(()=>l[4]||(l[4]=[n("Filtros")])),_:1})]),_:1}),t(e(V),{class:"space-y-4"},{default:s(()=>[o("div",de,[o("div",me,[t(e(te),{modelValue:$.value,"onUpdate:modelValue":l[0]||(l[0]=r=>$.value=r),placeholder:"Buscar por nombre o descripción...",onKeyup:K(S,["enter"])},null,8,["modelValue"])]),t(e(h),{onClick:S,variant:"secondary"},{default:s(()=>l[5]||(l[5]=[n(" Buscar ")])),_:1}),t(e(h),{onClick:l[1]||(l[1]=r=>c.value=!c.value),variant:"outline"},{default:s(()=>[n(u(c.value?"Ocultar":"Mostrar")+" Filtros Avanzados ",1)]),_:1})]),c.value?(i(),v("div",fe,[t(se,{fieldsConfig:a.filterFieldsConfig,baseUrl:"/admin/roles"},null,8,["fieldsConfig"])])):p("",!0)]),_:1})]),_:1}),t(e(T),null,{default:s(()=>[t(e(F),null,{default:s(()=>[t(e(R),null,{default:s(()=>l[6]||(l[6]=[n("Roles del Sistema")])),_:1}),t(e(X),null,{default:s(()=>[n(" Total de "+u(f.roles.total)+" roles registrados ",1)]),_:1})]),_:1}),t(e(V),null,{default:s(()=>[t(e(Y),null,{default:s(()=>[t(e(Z),null,{default:s(()=>[t(e(C),null,{default:s(()=>[t(e(m),null,{default:s(()=>l[7]||(l[7]=[n("Rol")])),_:1}),t(e(m),null,{default:s(()=>l[8]||(l[8]=[n("Descripción")])),_:1}),t(e(m),null,{default:s(()=>l[9]||(l[9]=[n("Tipo")])),_:1}),t(e(m),null,{default:s(()=>l[10]||(l[10]=[n("Permisos")])),_:1}),t(e(m),null,{default:s(()=>l[11]||(l[11]=[n("Usuarios")])),_:1}),t(e(m),null,{default:s(()=>l[12]||(l[12]=[n("Segmentos")])),_:1}),t(e(m),{class:"text-right"},{default:s(()=>l[13]||(l[13]=[n("Acciones")])),_:1})]),_:1})]),_:1}),t(e(ee),null,{default:s(()=>[(i(!0),v(w,null,P(f.roles.data,r=>(i(),_(e(C),{key:r.id},{default:s(()=>[t(e(d),{class:"font-medium"},{default:s(()=>[o("div",_e,[t(e(q),{class:"h-4 w-4 text-muted-foreground"}),o("div",null,[o("p",pe,u(r.display_name),1),o("p",ce,u(r.name),1)])])]),_:2},1024),t(e(d),null,{default:s(()=>[o("p",ge,u(r.description||"Sin descripción"),1)]),_:2},1024),t(e(d),null,{default:s(()=>[t(e(y),{variant:g(r)?"default":"secondary"},{default:s(()=>[n(u(g(r)?"Sistema":"Personalizado"),1)]),_:2},1032,["variant"])]),_:2},1024),t(e(d),null,{default:s(()=>[t(e(y),{variant:"outline"},{default:s(()=>[n(u(N(r.permissions)),1)]),_:2},1024)]),_:2},1024),t(e(d),null,{default:s(()=>[o("div",xe,[t(e(G),{class:"h-4 w-4 text-muted-foreground"}),o("span",ve,u(U(r.users)),1)])]),_:2},1024),t(e(d),null,{default:s(()=>[t(e(y),{variant:"ghost"},{default:s(()=>[n(u(j(r.segments)),1)]),_:2},1024)]),_:2},1024),t(e(d),{class:"text-right"},{default:s(()=>[t(e(I),null,{default:s(()=>[t(e(O),{asChild:""},{default:s(()=>[t(e(h),{variant:"ghost",size:"icon"},{default:s(()=>[t(e(ae),{class:"h-4 w-4"})]),_:1})]),_:1}),t(e(Q),{align:"end"},{default:s(()=>[t(e(x),{href:`/admin/roles/${r.id}`},{default:s(()=>[t(e(b),null,{default:s(()=>[t(e(re),{class:"mr-2 h-4 w-4"}),l[14]||(l[14]=n(" Ver Detalles "))]),_:1})]),_:2},1032,["href"]),z(r)?(i(),_(e(x),{key:0,href:`/admin/roles/${r.id}/edit`},{default:s(()=>[t(e(b),null,{default:s(()=>[t(e(ne),{class:"mr-2 h-4 w-4"}),l[15]||(l[15]=n(" Editar "))]),_:1})]),_:2},1032,["href"])):p("",!0),L(r)?(i(),_(e(b),{key:1,onClick:ye=>A(r),class:"text-destructive"},{default:s(()=>[t(e(oe),{class:"mr-2 h-4 w-4"}),l[16]||(l[16]=n(" Eliminar "))]),_:2},1032,["onClick"])):p("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),f.roles.data.length===0?(i(),_(e(C),{key:0},{default:s(()=>[t(e(d),{colspan:"7",class:"text-center py-8 text-muted-foreground"},{default:s(()=>l[17]||(l[17]=[n(" No se encontraron roles ")])),_:1})]),_:1})):p("",!0)]),_:1})]),_:1}),f.roles.last_page>1?(i(),v("div",he,[o("nav",$e,[(i(!0),v(w,null,P(f.roles.links,r=>(i(),_(e(x),{key:r.label,href:r.url,class:W(["px-3 py-2 text-sm rounded-md",r.active?"bg-primary text-primary-foreground":"hover:bg-muted",!r.url&&"opacity-50 cursor-not-allowed"]),innerHTML:r.label,disabled:!r.url},null,8,["href","class","innerHTML","disabled"]))),128))])])):p("",!0)]),_:1})]),_:1})])]),_:1}))}});export{at as default};
