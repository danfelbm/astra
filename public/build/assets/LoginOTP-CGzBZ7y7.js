import{d as D,Z as ne,c as B,k as R,w as Y,j as M,o as n,e as w,E as j,b as C,u as e,A as O,p as ee,x as te,y as z,I as se,C as W,a as p,i as N,f as m,m as ie,g as f,t as k,h as Z,n as re,F as de,r as ue}from"./app-BKga0G81.js";import{_ as J}from"./InputError.vue_vue_type_script_setup_true_lang-D0YDM454.js";import{_ as ce}from"./TextLink.vue_vue_type_script_setup_true_lang-o5olimCG.js";import{P as K,a as U,_ as T}from"./createLucideIcon-C9mG6ZOc.js";import{h as pe,u as me,n as H,_ as Q,a as fe}from"./Label.vue_vue_type_script_setup_true_lang-BnF8UYrH.js";import{a as ve,c as ge,u as _e,g as he,d as ye,b as ae}from"./VisuallyHidden-DIFBjfe-.js";import{V as be}from"./VisuallyHiddenInput-lYOBDPM-.js";import{_ as xe}from"./AuthLayout.vue_vue_type_script_setup_true_lang-CntulVEp.js";import{M as ke}from"./mail-bGbhWR3k.js";import{L}from"./loader-circle-C4CTnOPp.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-iR2bQ3_P.js";const Ce=["INPUT","TEXTAREA"];function we(u,l,o,i={}){if(!l||i.enableIgnoredElement&&Ce.includes(l.nodeName))return null;const{arrowKeyOptions:d="both",attributeName:v="[data-reka-collection-item]",itemsArray:c=[],loop:g=!0,dir:_="ltr",preventScroll:x=!0,focus:y=!1}=i,[I,V,P,q,$,S]=[u.key==="ArrowRight",u.key==="ArrowLeft",u.key==="ArrowUp",u.key==="ArrowDown",u.key==="Home",u.key==="End"],E=P||q,s=I||V;if(!$&&!S&&(!E&&!s||d==="vertical"&&s||d==="horizontal"&&E))return null;const t=c;if(!t.length)return null;x&&u.preventDefault();let h=null;return s||E?h=oe(t,l,{goForward:E?q:_==="ltr"?I:V,loop:g}):$?h=t.at(0)||null:S&&(h=t.at(-1)||null),y&&(h==null||h.focus()),h}function oe(u,l,o,i=u.length){if(--i===0)return null;const d=u.indexOf(l),v=o.goForward?d+1:d-1;if(!o.loop&&(v<0||v>=u.length))return null;const c=(v+u.length)%u.length,g=u[c];return g?g.hasAttribute("disabled")&&g.getAttribute("disabled")!=="false"?oe(u,g,o,i):g:null}const[Ve,Ee]=ge("PinInputRoot");var Ie=D({inheritAttrs:!1,__name:"PinInputRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:Array,required:!1},placeholder:{type:String,required:!1,default:""},mask:{type:Boolean,required:!1},otp:{type:Boolean,required:!1},type:{type:null,required:!1,default:"text"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","complete"],setup(u,{emit:l}){const o=u,i=l,{mask:d,otp:v,placeholder:c,type:g,disabled:_,dir:x}=ne(o),{forwardRef:y}=pe(),I=ve(x),V=me(o,"modelValue",i,{defaultValue:o.defaultValue??[],passive:o.modelValue===void 0}),P=B(()=>Array.isArray(V.value)?[...V.value]:[]),q=R(new Set);function $(s){q.value.add(s)}const S=B(()=>o.type==="number"),E=B(()=>P.value.filter(t=>!!t||S.value&&t===0).length===q.value.size);return Y(V,()=>{E.value&&i("complete",V.value)},{deep:!0}),Ee({modelValue:V,currentModelValue:P,mask:d,otp:v,placeholder:c,type:g,dir:I,disabled:_,isCompleted:E,inputElements:q,onInputElementChange:$,isNumericMode:S}),(s,t)=>(n(),M(e(K),O(s.$attrs,{ref:e(y),dir:e(I),"data-complete":E.value?"":void 0,"data-disabled":e(_)?"":void 0}),{default:w(()=>[j(s.$slots,"default",{modelValue:e(V)}),C(be,{id:s.id,as:"input",feature:"focusable",tabindex:"-1",value:P.value.join(""),name:s.name??"",disabled:e(_),required:s.required,onFocus:t[0]||(t[0]=h=>{var a,r;return(r=(a=Array.from(q.value))==null?void 0:a[0])==null?void 0:r.focus()})},null,8,["id","value","name","disabled","required"])]),_:3},16,["dir","data-complete","data-disabled"]))}}),Pe=Ie,qe=D({__name:"PinInputInput",props:{index:{type:Number,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},setup(u){const l=u,o=Ve(),i=B(()=>Array.from(o.inputElements.value)),d=B(()=>o.currentModelValue.value[l.index]),v=B(()=>l.disabled||o.disabled.value),c=B(()=>o.otp.value),g=B(()=>o.mask.value),{primitiveElement:_,currentElement:x}=_e();function y(a){var A;const r=a.target;if((((A=a.data)==null?void 0:A.length)??0)>1){s(r.value);return}if(o.isNumericMode.value&&!/^\d*$/.test(r.value)){r.value=r.value.replace(/\D/g,"");return}r.value=a.data??"",h(l.index,r.value);const b=i.value[l.index+1];b&&b.focus()}function I(){const a=x.value;se(()=>{a&&!a.value&&(a.placeholder=o.placeholder.value)})}function V(a){we(a,he(),void 0,{itemsArray:i.value,focus:!0,loop:!1,arrowKeyOptions:"horizontal",dir:o.dir.value})}function P(a){if(a.preventDefault(),a.target.value)h(l.index,"");else{const A=i.value[l.index-1];A&&(A.focus(),h(l.index-1,""))}}function q(a){a.key==="Delete"&&(a.preventDefault(),h(l.index,""))}function $(a){const r=a.target;r.setSelectionRange(1,1),r.value||(r.placeholder="")}function S(a){I()}function E(a){a.preventDefault();const r=a.clipboardData;if(!r)return;const b=r.getData("text");s(b)}function s(a){var G;const r=[...o.currentModelValue.value],b=a.length>=i.value.length?0:l.index,A=Math.min(b+a.length,i.value.length);for(let F=b;F<A;F++){const le=i.value[F],X=a[F-b];o.isNumericMode.value&&!/^\d*$/.test(X)||(r[F]=X,le.focus())}o.modelValue.value=r,(G=i.value[A])==null||G.focus()}function t(a){let r=a.length-1;for(;r>=0&&a[r]==="";)a.pop(),r--;return a}function h(a,r){const b=[...o.currentModelValue.value];if(o.isNumericMode.value){const A=+r;r===""||isNaN(A)?delete b[a]:b[a]=A}else b[a]=r;o.modelValue.value=t(b)}return Y(d,()=>{d.value||I()}),ee(()=>{o.onInputElementChange(x.value)}),te(()=>{var a;(a=o.inputElements)==null||a.value.delete(x.value)}),(a,r)=>(n(),M(e(K),{ref_key:"primitiveElement",ref:_,autocapitalize:"none",as:a.as,"as-child":a.asChild,autocomplete:c.value?"one-time-code":"false",type:g.value?"password":"text",inputmode:e(o).isNumericMode.value?"numeric":"text",pattern:e(o).isNumericMode.value?"[0-9]*":void 0,placeholder:e(o).placeholder.value,value:d.value,disabled:v.value,"data-disabled":v.value?"":void 0,"data-complete":e(o).isCompleted.value?"":void 0,"aria-label":`pin input ${a.index+1} of ${i.value.length}`,onInput:r[0]||(r[0]=b=>y(b)),onKeydown:[z(V,["left","right","up","down","home","end"]),z(P,["backspace"]),z(q,["delete"])],onFocus:$,onBlur:S,onPaste:E},{default:w(()=>[j(a.$slots,"default")]),_:3},8,["as","as-child","autocomplete","type","inputmode","pattern","placeholder","value","disabled","data-disabled","data-complete","aria-label"]))}}),Ae=qe;const Be=D({__name:"PinInput",props:{modelValue:{default:()=>[]},defaultValue:{},placeholder:{},mask:{type:Boolean},otp:{type:Boolean},type:{},dir:{},disabled:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue","complete"],setup(u,{emit:l}){const o=u,i=l,d=H(o,"class"),v=ye(d,i);return(c,g)=>(n(),M(e(Pe),O({"data-slot":"pin-input"},e(v),{class:e(U)("flex items-center gap-2 has-disabled:opacity-50 disabled:cursor-not-allowed",o.class)}),{default:w(()=>[j(c.$slots,"default")]),_:3},16,["class"]))}}),Me=D({__name:"PinInputGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const l=u,o=H(l,"class"),i=ae(o);return(d,v)=>(n(),M(e(K),O({"data-slot":"pin-input-group"},e(i),{class:e(U)("flex items-center",l.class)}),{default:w(()=>[j(d.$slots,"default")]),_:3},16,["class"]))}}),Se=D({__name:"PinInputSlot",props:{index:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(u){const l=u,o=H(l,"class"),i=ae(o);return(d,v)=>(n(),M(e(Ae),O({"data-slot":"pin-input-slot"},e(i),{class:e(U)("border-input focus:border-ring focus:ring-ring/50 focus:aria-invalid:ring-destructive/20 dark:bg-input/30 dark:focus:aria-invalid:ring-destructive/40 aria-invalid:border-destructive focus:aria-invalid:border-destructive relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none text-center first:rounded-l-md first:border-l last:rounded-r-md focus:z-10 focus:ring-[3px]",l.class)}),null,16,["class"]))}}),$e={key:0,class:"mb-4 text-center text-muted-foreground"},Ne={key:0},Re={key:0},De={key:1},Fe={key:2},Te={key:3},je={key:1},Oe={key:1,class:"mb-4 text-center text-muted-foreground"},ze={key:0},We={key:1},Le={key:2},Ke={key:2,class:"mb-4 text-center text-sm font-medium text-green-600"},Ue={class:"grid gap-6"},He={class:"grid gap-2"},Ge={class:"relative"},Xe={class:"grid gap-6"},Ze={class:"text-center"},Je={class:"text-sm text-muted-foreground"},Qe={key:0},Ye={key:0},et={class:"font-medium"},tt={key:1},at={class:"font-medium"},ot={key:2},lt={class:"font-medium"},nt={key:1},st={key:0},it={class:"font-medium"},rt={key:1},dt={class:"font-medium"},ut={class:"font-medium"},ct={key:2},pt={class:"font-medium"},mt={class:"font-medium"},ft={class:"grid gap-2"},vt={class:"flex justify-center"},gt={class:"flex flex-col gap-3"},_t={class:"flex flex-col gap-2 text-center"},ht={key:5,class:"mt-6 text-center text-sm text-muted-foreground"},yt={class:"mt-6 text-center text-xs text-muted-foreground"},bt={key:0},xt={key:1},St=D({__name:"LoginOTP",props:{status:{},authConfig:{},censoredEmail:{},otpCredential:{},otpChannel:{},whatsappEnabled:{type:Boolean}},setup(u){const l=u,o=R(l.censoredEmail?"otp":"credential"),i=R(l.censoredEmail||""),d=B(()=>l.authConfig||{login_type:"email",input_type:"email",placeholder:"correo@ejemplo.com",pattern:null,label:"Correo Electrónico"}),v=W({credential:""}),c=W({credential:l.otpCredential||"",otp_code:[]}),g=W({credential:"",otp_code:""}),_=R(!1),x=R(0),y=R(null),I=B(()=>x.value===0),V=B(()=>x.value>0?`Reenviar en ${x.value}s`:"Reenviar código"),P=(s=60)=>{x.value=s,y.value&&clearInterval(y.value),y.value=window.setInterval(()=>{x.value--,x.value<=0&&(clearInterval(y.value),y.value=null)},1e3)},q=()=>{_.value=!0,v.post(route("auth.request-otp"),{onSuccess:s=>{s.props&&s.props.censoredEmail&&(i.value=s.props.censoredEmail),o.value="otp",c.credential=v.credential,c.clearErrors(),P(60)},onError:()=>{},onFinish:()=>{_.value=!1}})},$=()=>{const s=c.otp_code.join("");g.credential=c.credential,g.otp_code=s,g.post(route("auth.verify-otp"),{onSuccess:()=>{},onError:()=>{c.otp_code=[]}})},S=()=>{I.value&&(_.value=!0,c.post(route("auth.resend-otp"),{onSuccess:s=>{s.props&&s.props.censoredEmail&&(i.value=s.props.censoredEmail),P(60)},onFinish:()=>{_.value=!1}}))},E=()=>{o.value="credential",c.reset(),y.value&&(clearInterval(y.value),y.value=null),x.value=0};return ee(()=>{o.value==="otp"&&P(60)}),te(()=>{y.value&&clearInterval(y.value)}),(s,t)=>(n(),M(xe,{title:o.value==="credential"?"Iniciar Sesión":"Verificar Código"},{default:w(()=>[C(e(ie),{title:"Iniciar Sesión"}),o.value==="credential"?(n(),p("div",$e,[d.value.login_type==="documento"?(n(),p("p",Ne,[t[2]||(t[2]=f(" Ingresa tu documento de identidad para recibir el código de verificación ")),s.whatsappEnabled?l.otpChannel==="whatsapp"?(n(),p("strong",De,"vía WhatsApp")):l.otpChannel==="both"?(n(),p("strong",Fe,"vía correo electrónico y WhatsApp")):(n(),p("strong",Te,"vía correo electrónico")):(n(),p("strong",Re,"vía correo electrónico"))])):(n(),p("p",je," Ingresa tu "+k(d.value.label.toLowerCase())+" para recibir el código de verificación ",1))])):(n(),p("div",Oe,[l.otpChannel==="whatsapp"?(n(),p("p",ze,t[3]||(t[3]=[f(" Ingresa el código de 6 dígitos enviado a tu "),m("strong",null,"WhatsApp",-1)]))):l.otpChannel==="both"?(n(),p("p",We,t[4]||(t[4]=[f(" Ingresa el código de 6 dígitos enviado a tu "),m("strong",null,"correo y WhatsApp",-1)]))):(n(),p("p",Le,t[5]||(t[5]=[f(" Ingresa el código de 6 dígitos enviado a tu "),m("strong",null,"correo",-1)])))])),s.status?(n(),p("div",Ke,k(s.status),1)):N("",!0),o.value==="credential"?(n(),p("form",{key:3,onSubmit:Z(q,["prevent"]),class:"flex flex-col gap-6"},[m("div",Ue,[m("div",He,[C(e(Q),{for:"credential"},{default:w(()=>[f(k(d.value.label),1)]),_:1}),m("div",Ge,[d.value.login_type==="email"?(n(),M(e(ke),{key:0,class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"})):N("",!0),C(e(fe),{id:"credential",type:d.value.input_type,required:"",autofocus:"",tabindex:"1",autocomplete:d.value.login_type==="email"?"email":"off",inputmode:d.value.login_type==="documento"?"numeric":void 0,modelValue:e(v).credential,"onUpdate:modelValue":t[0]||(t[0]=h=>e(v).credential=h),placeholder:d.value.placeholder,pattern:d.value.pattern,class:re({"pl-10":d.value.login_type==="email"})},null,8,["type","autocomplete","inputmode","modelValue","placeholder","pattern","class"])]),C(J,{message:e(v).errors.credential},null,8,["message"])]),C(e(T),{type:"submit",class:"mt-4 w-full",tabindex:"2",disabled:e(v).processing||_.value},{default:w(()=>[e(v).processing||_.value?(n(),M(e(L),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):N("",!0),f(" "+k(e(v).processing||_.value?"Enviando...":"Enviar Código"),1)]),_:1},8,["disabled"])])],32)):(n(),p("form",{key:4,onSubmit:Z($,["prevent"]),class:"flex flex-col gap-6"},[m("div",Xe,[m("div",Ze,[m("p",Je,[d.value.login_type==="email"?(n(),p("span",Qe,[l.otpChannel==="whatsapp"?(n(),p("span",Ye,[t[6]||(t[6]=f(" Código enviado por WhatsApp al número asociado con ")),m("span",et,k(i.value||e(c).credential),1)])):l.otpChannel==="both"?(n(),p("span",tt,[t[7]||(t[7]=f(" Código enviado al email ")),m("span",at,k(i.value||e(c).credential),1),t[8]||(t[8]=f(" y WhatsApp "))])):(n(),p("span",ot,[t[9]||(t[9]=f(" Código enviado al email ")),m("span",lt,k(i.value||e(c).credential),1)]))])):(n(),p("span",nt,[l.otpChannel==="whatsapp"?(n(),p("span",st,[t[10]||(t[10]=f(" Código enviado por WhatsApp al número asociado con el documento ")),m("span",it,k(e(c).credential),1)])):l.otpChannel==="both"?(n(),p("span",rt,[t[11]||(t[11]=f(" Código enviado al email ")),m("span",dt,k(i.value),1),t[12]||(t[12]=f(" y WhatsApp asociados al documento ")),m("span",ut,k(e(c).credential),1)])):(n(),p("span",ct,[t[13]||(t[13]=f(" Código enviado al email ")),m("span",pt,k(i.value),1),t[14]||(t[14]=f(" asociado al documento ")),m("span",mt,k(e(c).credential),1)]))]))])]),m("div",ft,[C(e(Q),{class:"text-center"},{default:w(()=>t[15]||(t[15]=[f("Código de Verificación")])),_:1}),m("div",vt,[C(e(Be),{modelValue:e(c).otp_code,"onUpdate:modelValue":t[1]||(t[1]=h=>e(c).otp_code=h),length:6,type:"text",placeholder:"0",class:"gap-2"},{default:w(()=>[C(e(Me),null,{default:w(()=>[(n(),p(de,null,ue(6,(h,a)=>C(e(Se),{key:h,index:a,class:"h-12 w-12 text-lg font-medium",inputmode:"numeric"},null,8,["index"])),64))]),_:1})]),_:1},8,["modelValue"])]),C(J,{message:e(c).errors.otp_code},null,8,["message"])]),m("div",gt,[C(e(T),{type:"submit",class:"w-full",disabled:e(g).processing||e(c).otp_code.join("").length!==6},{default:w(()=>[e(g).processing?(n(),M(e(L),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):N("",!0),f(" "+k(e(g).processing?"Verificando...":"Verificar Código"),1)]),_:1},8,["disabled"]),m("div",_t,[C(e(T),{type:"button",variant:"ghost",size:"sm",onClick:S,disabled:!I.value||_.value},{default:w(()=>[_.value?(n(),M(e(L),{key:0,class:"mr-2 h-3 w-3 animate-spin"})):N("",!0),f(" "+k(_.value?"Enviando...":V.value),1)]),_:1},8,["disabled"]),C(e(T),{type:"button",variant:"ghost",size:"sm",onClick:E},{default:w(()=>[f(k(d.value.login_type==="email"?"Cambiar correo electrónico":"Cambiar documento"),1)]),_:1})])])])],32)),o.value==="credential"?(n(),p("div",ht,[t[17]||(t[17]=f(" ¿Deseas ser precandidato por la Colombia Humana pero no eres militante del partido? ")),C(ce,{href:s.route("register"),class:"underline underline-offset-4"},{default:w(()=>t[16]||(t[16]=[f("Regístrate aquí")])),_:1},8,["href"])])):N("",!0),m("div",yt,[o.value==="credential"?(n(),p("p",bt," Solo personas registradas como militantes pueden acceder al sistema. ")):(n(),p("p",xt," El código expira en 10 minutos. Si no lo recibes, verifica tu bandeja de spam. ")),t[18]||(t[18]=m("br",null,null,-1)),t[19]||(t[19]=m("p",null,[f(" Si necesitas ayuda escribe a "),m("b",null,"soporte@colombiahumana.co"),f(" para soporte sobre la plataforma. Para inquietudes jurídicas a "),m("b",null,"juridicoelectoral@colombiahumana.co")],-1))])]),_:1},8,["title"]))}});export{St as default};
