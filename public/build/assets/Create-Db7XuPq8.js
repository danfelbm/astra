import{d as q,C as L,k as M,j as V,o as m,e as l,b as t,f as a,u as e,m as R,P as S,g as o,h,a as _,F as k,r as F,t as f}from"./app-CRtAryep.js";import{T as z,S as B,U as P,a as G,_ as E}from"./AppLayout.vue_vue_type_script_setup_true_lang-C1azZtFX.js";import{_ as u}from"./AppLogo.vue_vue_type_script_setup_true_lang-CMxkBa9N.js";import{_ as g,a as c}from"./CardContent.vue_vue_type_script_setup_true_lang-D1WxX5UR.js";import{_ as v}from"./CardDescription.vue_vue_type_script_setup_true_lang-csrGK3C_.js";import{_ as y,a as x}from"./CardTitle.vue_vue_type_script_setup_true_lang-Bb-ZiE1h.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-BOw4iX8j.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-n3RPop8f.js";import{_ as O}from"./Textarea.vue_vue_type_script_setup_true_lang-BS6oNkoR.js";import{_ as Q,a as H,b as I,c as J,d as K}from"./SelectValue.vue_vue_type_script_setup_true_lang-DI0CF2k_.js";import{_ as W}from"./Switch.vue_vue_type_script_setup_true_lang-v1lcmAPx.js";import{_ as X}from"./Checkbox.vue_vue_type_script_setup_true_lang-DqaDya9H.js";import{_ as Y,a as Z,b,c as $}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-Cbz7I72a.js";import{F as ee,_ as se}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-COWL3Ke5.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang-OHDmMSaI.js";import{A as te}from"./arrow-left-w_RUmR7S.js";import{S as le}from"./save-CKrJb-2Y.js";import"./index-Bao1rBIx.js";import"./index-BlfSCicX.js";import"./useForwardExpose-Cy_Y8IhK.js";import"./usePrimitiveElement-DFL9PjmE.js";import"./createContext-BNT7pE5K.js";import"./Collection-BMy5PtiL.js";import"./useNonce-CnZ93Yqc.js";import"./chevron-up-CgrLcS-Z.js";import"./handleAndDispatchCustomEvent-CYpUamdb.js";import"./nullish-CHIgUVhi.js";import"./useFormControl-B5J9tLsa.js";import"./VisuallyHidden-QElwN1Sc.js";import"./VisuallyHiddenInput-DDMuMFnq.js";import"./RovingFocusItem-CjGgrzr_.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BY8AArZV.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-BE0KNl7c.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-lnvaXJkZ.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-CLlWDa9n.js";import"./trash-2-DCTPvolJ.js";import"./plus-C7MEAnba.js";import"./search-B7kepi1_.js";import"./history-CFHUEynY.js";import"./circle-alert-Cwp5HU_o.js";const oe={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ie={class:"flex items-center justify-between"},ae={class:"space-y-2"},ne={class:"space-y-2"},re={class:"space-y-2"},de={class:"flex items-center justify-between"},me={class:"space-y-0.5"},ue={class:"flex items-center space-x-2"},fe={class:"space-y-2"},pe={class:"grid grid-cols-2 gap-2"},_e={class:"flex items-center px-3 py-2 bg-muted rounded-md"},ge={class:"text-sm text-muted-foreground"},ce={class:"grid grid-cols-2 gap-2 mt-2"},ve={key:0,class:"space-y-3"},ye={class:"flex-1"},xe={class:"text-xs text-muted-foreground mt-1"},be={key:1,class:"text-center py-8 text-muted-foreground"},$e={class:"flex justify-end gap-4"},ms=q({__name:"Create",props:{roles:{},filterFieldsConfig:{},modelTypes:{}},setup(Ce){const U=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Segmentos",href:"/admin/segments"},{title:"Crear Segmento",href:"#"}],i=L({name:"",description:"",model_type:"App\\Models\\User",filters:{},is_dynamic:!0,cache_duration:300,role_ids:[]}),D=M(null),N=r=>{const s=i.role_ids.indexOf(r);s>-1?i.role_ids.splice(s,1):i.role_ids.push(r)},A=r=>{i.filters=r},T=()=>{i.post("/admin/segments",{preserveScroll:!0,onSuccess:()=>{}})},j=r=>r<60?`${r} segundos`:r<3600?`${Math.floor(r/60)} minutos`:`${Math.floor(r/3600)} horas`;return(r,s)=>(m(),V(E,{breadcrumbs:U},{default:l(()=>[t(e(R),{title:"Crear Segmento"}),a("div",oe,[a("div",ie,[s[10]||(s[10]=a("div",null,[a("h2",{class:"text-2xl font-bold tracking-tight"},"Crear Nuevo Segmento"),a("p",{class:"text-muted-foreground"}," Define un segmento de usuarios basado en filtros dinámicos ")],-1)),t(e(S),{href:r.route("admin.segments.index")},{default:l(()=>[t(e(u),{variant:"outline"},{default:l(()=>[t(e(te),{class:"mr-2 h-4 w-4"}),s[9]||(s[9]=o(" Volver "))]),_:1})]),_:1},8,["href"])]),a("form",{onSubmit:h(T,["prevent"]),class:"space-y-6"},[t(e(Y),{defaultValue:"general",class:"space-y-4"},{default:l(()=>[t(e(Z),{class:"grid w-full grid-cols-4"},{default:l(()=>[t(e(b),{value:"general"},{default:l(()=>[t(e(z),{class:"mr-2 h-4 w-4"}),s[11]||(s[11]=o(" General "))]),_:1}),t(e(b),{value:"filters"},{default:l(()=>[t(e(ee),{class:"mr-2 h-4 w-4"}),s[12]||(s[12]=o(" Filtros "))]),_:1}),t(e(b),{value:"settings"},{default:l(()=>[t(e(B),{class:"mr-2 h-4 w-4"}),s[13]||(s[13]=o(" Configuración "))]),_:1}),t(e(b),{value:"roles"},{default:l(()=>[t(e(P),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=o(" Roles "))]),_:1})]),_:1}),t(e($),{value:"general"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(y),null,{default:l(()=>[t(e(x),null,{default:l(()=>s[15]||(s[15]=[o("Información General")])),_:1}),t(e(v),null,{default:l(()=>s[16]||(s[16]=[o(" Define el nombre y descripción del segmento ")])),_:1})]),_:1}),t(e(c),{class:"space-y-4"},{default:l(()=>[a("div",ae,[t(e(d),{htmlFor:"name"},{default:l(()=>s[17]||(s[17]=[o("Nombre del Segmento")])),_:1}),t(e(w),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":s[0]||(s[0]=n=>e(i).name=n),placeholder:"Usuarios por Región Norte"},null,8,["modelValue"]),t(p,{message:e(i).errors.name},null,8,["message"])]),a("div",ne,[t(e(d),{htmlFor:"description"},{default:l(()=>s[18]||(s[18]=[o("Descripción")])),_:1}),t(e(O),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":s[1]||(s[1]=n=>e(i).description=n),placeholder:"Describe el propósito y criterios de este segmento...",rows:"4"},null,8,["modelValue"]),t(p,{message:e(i).errors.description},null,8,["message"])]),a("div",re,[t(e(d),{htmlFor:"model_type"},{default:l(()=>s[19]||(s[19]=[o("Tipo de Modelo")])),_:1}),t(e(Q),{modelValue:e(i).model_type,"onUpdate:modelValue":s[2]||(s[2]=n=>e(i).model_type=n)},{default:l(()=>[t(e(H),null,{default:l(()=>[t(e(I),{placeholder:"Selecciona el tipo de modelo"})]),_:1}),t(e(J),null,{default:l(()=>[(m(!0),_(k,null,F(r.modelTypes,(n,C)=>(m(),V(e(K),{key:C,value:C},{default:l(()=>[o(f(n),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),s[20]||(s[20]=a("p",{class:"text-xs text-muted-foreground"}," Selecciona el modelo de datos sobre el que aplicar el segmento ",-1)),t(p,{message:e(i).errors.model_type},null,8,["message"])])]),_:1})]),_:1})]),_:1}),t(e($),{value:"filters"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(y),null,{default:l(()=>[t(e(x),null,{default:l(()=>s[21]||(s[21]=[o("Criterios de Filtrado")])),_:1}),t(e(v),null,{default:l(()=>s[22]||(s[22]=[o(" Define los filtros que determinarán qué usuarios pertenecen a este segmento ")])),_:1})]),_:1}),t(e(c),null,{default:l(()=>[t(se,{ref_key:"advancedFiltersRef",ref:D,config:{fields:r.filterFieldsConfig,showQuickSearch:!1},route:"",onApply:A},null,8,["config"]),t(p,{message:e(i).errors.filters},null,8,["message"]),s[23]||(s[23]=a("div",{class:"mt-4 p-4 bg-muted/50 rounded-lg"},[a("p",{class:"text-sm text-muted-foreground"},[a("strong",null,"Nota:"),o(" Los filtros definidos aquí serán aplicados dinámicamente para determinar qué usuarios pertenecen a este segmento. Los segmentos dinámicos se recalculan automáticamente según los criterios establecidos. ")])],-1))]),_:1})]),_:1})]),_:1}),t(e($),{value:"settings"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(y),null,{default:l(()=>[t(e(x),null,{default:l(()=>s[24]||(s[24]=[o("Configuración del Segmento")])),_:1}),t(e(v),null,{default:l(()=>s[25]||(s[25]=[o(" Ajusta el comportamiento y cache del segmento ")])),_:1})]),_:1}),t(e(c),{class:"space-y-6"},{default:l(()=>[a("div",de,[a("div",me,[t(e(d),null,{default:l(()=>s[26]||(s[26]=[o("Tipo de Segmento")])),_:1}),s[27]||(s[27]=a("p",{class:"text-sm text-muted-foreground"}," Los segmentos dinámicos se recalculan en tiempo real ",-1))]),a("div",ue,[t(e(d),{htmlFor:"is_dynamic",class:"text-sm"},{default:l(()=>s[28]||(s[28]=[o("Dinámico")])),_:1}),t(e(W),{id:"is_dynamic",modelValue:e(i).is_dynamic,"onUpdate:modelValue":s[3]||(s[3]=n=>e(i).is_dynamic=n)},null,8,["modelValue"])])]),a("div",fe,[t(e(d),{htmlFor:"cache_duration"},{default:l(()=>s[29]||(s[29]=[o("Duración del Cache (segundos)")])),_:1}),a("div",pe,[t(e(w),{id:"cache_duration",modelValue:e(i).cache_duration,"onUpdate:modelValue":s[4]||(s[4]=n=>e(i).cache_duration=n),modelModifiers:{number:!0},type:"number",min:"0",max:"86400"},null,8,["modelValue"]),a("div",_e,[a("span",ge,f(j(e(i).cache_duration)),1)])]),s[30]||(s[30]=a("p",{class:"text-xs text-muted-foreground"}," Tiempo que se mantendrán en cache los resultados del segmento (0 = sin cache) ",-1)),t(p,{message:e(i).errors.cache_duration},null,8,["message"])]),a("div",null,[t(e(d),{class:"text-sm font-medium"},{default:l(()=>s[31]||(s[31]=[o("Valores Predefinidos")])),_:1}),a("div",ce,[t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[5]||(s[5]=n=>e(i).cache_duration=60)},{default:l(()=>s[32]||(s[32]=[o(" 1 minuto ")])),_:1}),t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[6]||(s[6]=n=>e(i).cache_duration=300)},{default:l(()=>s[33]||(s[33]=[o(" 5 minutos ")])),_:1}),t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[7]||(s[7]=n=>e(i).cache_duration=1800)},{default:l(()=>s[34]||(s[34]=[o(" 30 minutos ")])),_:1}),t(e(u),{type:"button",variant:"outline",size:"sm",onClick:s[8]||(s[8]=n=>e(i).cache_duration=3600)},{default:l(()=>s[35]||(s[35]=[o(" 1 hora ")])),_:1})])])]),_:1})]),_:1})]),_:1}),t(e($),{value:"roles"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(y),null,{default:l(()=>[t(e(x),null,{default:l(()=>s[36]||(s[36]=[o("Roles Asociados")])),_:1}),t(e(v),null,{default:l(()=>s[37]||(s[37]=[o(" Vincula este segmento con roles específicos para delimitar el alcance de datos ")])),_:1})]),_:1}),t(e(c),null,{default:l(()=>[r.roles.length>0?(m(),_("div",ve,[(m(!0),_(k,null,F(r.roles,n=>(m(),_("div",{key:n.id,class:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-muted/50"},[t(e(X),{checked:e(i).role_ids.includes(n.id),"onUpdate:checked":C=>N(n.id),class:"mt-1"},null,8,["checked","onUpdate:checked"]),a("div",ye,[t(e(d),{class:"text-sm font-medium cursor-pointer"},{default:l(()=>[o(f(n.display_name),1)]),_:2},1024),a("p",xe,f(n.description||"Sin descripción"),1),t(e(G),{variant:"outline",class:"mt-2"},{default:l(()=>[o(f(n.name),1)]),_:2},1024)])]))),128))])):(m(),_("div",be," No hay roles disponibles ")),t(p,{message:e(i).errors.role_ids},null,8,["message"])]),_:1})]),_:1})]),_:1})]),_:1}),a("div",$e,[t(e(S),{href:r.route("admin.segments.index")},{default:l(()=>[t(e(u),{type:"button",variant:"outline"},{default:l(()=>s[38]||(s[38]=[o(" Cancelar ")])),_:1})]),_:1},8,["href"]),t(e(u),{type:"submit",disabled:e(i).processing},{default:l(()=>[t(e(le),{class:"mr-2 h-4 w-4"}),o(" "+f(e(i).processing?"Creando...":"Crear Segmento"),1)]),_:1},8,["disabled"])])],32)])]),_:1}))}});export{ms as default};
