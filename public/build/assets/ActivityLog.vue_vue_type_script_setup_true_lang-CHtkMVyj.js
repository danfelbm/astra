import{d as I,r as P,c as w,p as R,b as $,i as a,f as r,w as c,e as l,g as n,j as h,h as _,t,F as x,k as N,m as s,v as U}from"./app-0nVG3A7n.js";import{_ as B,a as T,b as A}from"./index-DOr5YNZ0.js";import{_ as z,a as E,b as F,c as L}from"./CardTitle.vue_vue_type_script_setup_true_lang-BxuhlF8z.js";import{_ as O}from"./CardDescription.vue_vue_type_script_setup_true_lang-CSB2Wl3d.js";import{_ as S}from"./createLucideIcon-D6Za-Pze.js";import{C as V}from"./SelectValue.vue_vue_type_script_setup_true_lang-BVZfuZ-_.js";import{p as q}from"./parseISO-DFjB8F03.js";import{f as G,e as J}from"./es-BDPlFIsO.js";const K={class:"flex items-center justify-between"},Q={key:0,class:"text-xs text-muted-foreground"},W={key:0,class:"space-y-4"},X={class:"flex-1 min-w-0"},Y={class:"text-sm"},Z={class:"flex items-center gap-2 mt-1"},ee={class:"text-xs text-muted-foreground"},te={key:0,class:"text-xs text-muted-foreground"},se={key:0,class:"pt-2 text-center"},ae={key:1,class:"text-center py-8"},re={class:"text-sm text-muted-foreground"},ne={key:1},oe={key:0,class:"space-y-4"},le={class:"flex-1 min-w-0"},de={class:"text-sm"},ie={class:"flex items-center gap-2 mt-1"},ce={class:"text-xs text-muted-foreground"},ue={key:0,class:"text-xs text-muted-foreground"},fe={key:0,class:"pt-2 text-center"},me={key:1,class:"text-center py-8"},_e={class:"text-sm text-muted-foreground"},we=I({__name:"ActivityLog",props:{activities:{},title:{default:"Historial de Actividad"},description:{default:"Registro completo de cambios y eventos"},emptyMessage:{default:"No hay actividad registrada"},showCard:{type:Boolean,default:!0},perPage:{default:20}},setup(f){const g=f,v=P(1),p=w(()=>{const i=v.value*g.perPage;return g.activities.slice(0,i)}),M=w(()=>p.value.length<g.activities.length),k=w(()=>g.activities.length),C=()=>{v.value++};R(()=>g.activities,()=>{v.value=1},{deep:!0});const H=d=>{try{const i=q(d),u=new Date().getTime()-i.getTime(),o=Math.floor(u/6e4),b=Math.floor(u/36e5),y=Math.floor(u/864e5);return o<1?"Hace un momento":o<60?`Hace ${o} ${o===1?"minuto":"minutos"}`:b<24?`Hace ${b} ${b===1?"hora":"horas"}`:y<7?`Hace ${y} ${y===1?"día":"días"}`:G(i,"d 'de' MMMM 'de' yyyy 'a las' HH:mm",{locale:J})}catch{return d}},j=d=>d?d.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2):"SI",D=d=>{if(!d)return"";const i=d.split("\\");return i[i.length-1]},m=d=>{const i=d.description||"",e=d.properties;if(e!=null&&e.entidad_url&&(e!=null&&e.entidad_nombre)&&(e!=null&&e.entidad_tipo)){const u=new RegExp(`(.*)(en ${e.entidad_tipo} ')([^']+)('.*)`),o=i.match(u);if(o)return{before:o[1]+`en ${e.entidad_tipo} '`,linkText:o[3],linkUrl:e.entidad_url,after:o[4]}}return{text:i}};return(d,i)=>f.showCard?(s(),$(r(z),{key:0},{default:c(()=>[l(r(E),null,{default:c(()=>[n("div",K,[n("div",null,[l(r(F),null,{default:c(()=>[_(t(f.title),1)]),_:1}),l(r(O),null,{default:c(()=>[_(t(f.description),1)]),_:1})]),k.value>0?(s(),a("span",Q,t(p.value.length)+" de "+t(k.value),1)):h("",!0)])]),_:1}),l(r(L),null,{default:c(()=>[f.activities&&f.activities.length>0?(s(),a("div",W,[(s(!0),a(x,null,N(p.value,e=>(s(),a("div",{key:e.id,class:"flex gap-3 pb-4 border-b last:border-0 dark:border-gray-700"},[l(r(B),{class:"h-8 w-8 flex-shrink-0"},{default:c(()=>{var u;return[(u=e.causer)!=null&&u.avatar?(s(),$(r(T),{key:0,src:e.causer.avatar},null,8,["src"])):h("",!0),l(r(A),null,{default:c(()=>{var o;return[_(t(j(((o=e.causer)==null?void 0:o.name)||"Sistema")),1)]}),_:2},1024)]}),_:2},1024),n("div",X,[n("p",Y,[m(e).linkUrl?(s(),a(x,{key:0},[n("span",null,t(m(e).before),1),l(r(U),{href:m(e).linkUrl,class:"font-medium text-primary hover:underline"},{default:c(()=>[_(t(m(e).linkText),1)]),_:2},1032,["href"]),n("span",null,t(m(e).after),1)],64)):(s(),a(x,{key:1},[_(t(e.description),1)],64))]),n("div",Z,[n("p",ee,t(H(e.created_at)),1),e.subject_type?(s(),a("span",te," • "+t(D(e.subject_type)),1)):h("",!0)])])]))),128)),M.value?(s(),a("div",se,[l(r(S),{variant:"ghost",size:"sm",onClick:C,class:"text-muted-foreground"},{default:c(()=>[l(r(V),{class:"h-4 w-4 mr-1"}),_(" Cargar más ("+t(k.value-p.value.length)+" restantes) ",1)]),_:1})])):h("",!0)])):(s(),a("div",ae,[n("p",re,t(f.emptyMessage),1)]))]),_:1})]),_:1})):(s(),a("div",ne,[f.activities&&f.activities.length>0?(s(),a("div",oe,[(s(!0),a(x,null,N(p.value,e=>(s(),a("div",{key:e.id,class:"flex gap-3 pb-4 border-b last:border-0 dark:border-gray-700"},[l(r(B),{class:"h-8 w-8 flex-shrink-0"},{default:c(()=>{var u;return[(u=e.causer)!=null&&u.avatar?(s(),$(r(T),{key:0,src:e.causer.avatar},null,8,["src"])):h("",!0),l(r(A),null,{default:c(()=>{var o;return[_(t(j(((o=e.causer)==null?void 0:o.name)||"Sistema")),1)]}),_:2},1024)]}),_:2},1024),n("div",le,[n("p",de,[m(e).linkUrl?(s(),a(x,{key:0},[n("span",null,t(m(e).before),1),l(r(U),{href:m(e).linkUrl,class:"font-medium text-primary hover:underline"},{default:c(()=>[_(t(m(e).linkText),1)]),_:2},1032,["href"]),n("span",null,t(m(e).after),1)],64)):(s(),a(x,{key:1},[_(t(e.description),1)],64))]),n("div",ie,[n("p",ce,t(H(e.created_at)),1),e.subject_type?(s(),a("span",ue," • "+t(D(e.subject_type)),1)):h("",!0)])])]))),128)),M.value?(s(),a("div",fe,[l(r(S),{variant:"ghost",size:"sm",onClick:C,class:"text-muted-foreground"},{default:c(()=>[l(r(V),{class:"h-4 w-4 mr-1"}),_(" Cargar más ("+t(k.value-p.value.length)+" restantes) ",1)]),_:1})])):h("",!0)])):(s(),a("div",me,[n("p",_e,t(f.emptyMessage),1)]))]))}});export{we as _};
