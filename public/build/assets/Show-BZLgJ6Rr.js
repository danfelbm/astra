import{d as N,r as D,c as E,i as b,e as a,f as e,q,w as i,g as l,t as d,b as g,j as p,v as w,h as u,m as f,F as O,k as G,s as U}from"./app-CjFEq2BU.js";import{_ as J}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CHOSisVq.js";import{c as K,_ as A}from"./createLucideIcon-vAvq2H8c.js";import{_,a as h,b as y,c as x}from"./CardTitle.vue_vue_type_script_setup_true_lang-D3d3unQP.js";import{_ as Q}from"./CardDescription.vue_vue_type_script_setup_true_lang-BzjYo3R9.js";import{_ as B}from"./index-DsmsFoGX.js";import{_ as R}from"./Label.vue_vue_type_script_setup_true_lang-BV7kdJZK.js";import{_ as W,a as X,b as $,c as j}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-BpuZnGTC.js";import{_ as Y}from"./AccordionContent.vue_vue_type_script_setup_true_lang-CNKMeAue.js";import{_ as Z}from"./EvidenciasTable.vue_vue_type_script_setup_true_lang-Di7ZTg_q.js";import{O as tt}from"./ObligacionTree-_Oyt2XE7.js";import{u as et}from"./usePermissions-BNYKk_cj.js";import{A as at}from"./arrow-left-BGhFQoRL.js";import{P as it}from"./pencil-zotVmnWM.js";import{I as ot}from"./info-CQHgSthl.js";import{I as lt}from"./image-DAnLCFJy.js";import{P as nt}from"./paperclip-DmQd6liG.js";import{f as H,e as L}from"./es-BDPlFIsO.js";import{p as P}from"./parseISO-DFjB8F03.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-CfUbX_WD.js";import"./index-C2LCBIFh.js";import"./floating-ui.vue-Ia8t34A-.js";import"./x-CM7u_pGy.js";import"./Input.vue_vue_type_script_setup_true_lang-CTCJxXGV.js";import"./index-BpgdmhWf.js";import"./index-BRjMZQ1C.js";import"./shield-yVxjmj5r.js";import"./user-DMhth2NP.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DEAWQr4R.js";import"./chevron-right-DWpnWfCP.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BxFFARNM.js";import"./VisuallyHidden-CA4WkB-2.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-HIXjM73i.js";import"./check-XfMfJ3IX.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BZO_hM0p.js";import"./index-BZMkrMYo.js";import"./circle-alert-BNnDgz7u.js";import"./map-pin-BgWpz4o8.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-bubOQqGM.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BV2Sm7lL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-NqVsVnqd.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BKrizK-E.js";import"./tag-DF1RSJ7_.js";import"./users-CirEAGq9.js";import"./target-4dAH4eV-.js";import"./vote-CV99t7DL.js";import"./folder-open-etnSTGKu.js";import"./send-uyB-D0nK.js";import"./file-text-BtBnAiVa.js";import"./briefcase-BIsnv6vK.js";import"./calendar-B-11ozB3.js";import"./megaphone-DCFs_0DD.js";import"./user-check-BE9rk2RZ.js";import"./clipboard-list-CH4csswU.js";import"./mail-C3ivzYEZ.js";import"./message-square-BSb4v2Pv.js";import"./external-link-DOObJ68Z.js";import"./panel-left-OoIxv7dt.js";import"./index-Bo3e0yDf.js";import"./RovingFocusItem-M0d0QdR8.js";import"./utils-BG5WKndR.js";import"./useArrowNavigation-B5rxJs06.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-w3Tx4hDw.js";import"./download-m8WvJy36.js";import"./Separator.vue_vue_type_script_setup_true_lang-P67tUaMa.js";import"./TooltipProvider.vue_vue_type_script_setup_true_lang-M2lDfjVs.js";import"./circle-BMFhqWDi.js";import"./layers-CDbmUhup.js";import"./plus-BhV8Dsnd.js";import"./trash-2-CXg03iHQ.js";import"./loader-circle-BSZKnSQo.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=K("ListTreeIcon",[["path",{d:"M21 12h-8",key:"1bmf0i"}],["path",{d:"M21 6H8",key:"1pqkrb"}],["path",{d:"M21 18h-8",key:"1tm79t"}],["path",{d:"M3 6v4c0 1.1.9 2 2 2h3",key:"1ywdgy"}],["path",{d:"M3 10v6c0 1.1.9 2 2 2h3",key:"2wc746"}]]),rt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},dt={class:"flex items-center justify-between"},ut={class:"text-3xl font-bold"},mt={class:"text-muted-foreground mt-2"},ct={class:"flex gap-2"},ft={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},pt={class:"md:col-span-2 space-y-6"},gt={class:"mt-1"},vt={class:"space-y-6"},bt={class:"font-medium"},_t={class:"text-sm text-gray-600 mt-1"},ht={class:"space-y-2"},yt=["href"],xt={class:"text-xs text-gray-500"},kt={key:0},wt={class:"text-xs text-gray-500"},$t={key:1},jt={class:"text-xs text-gray-500"},Ge=N({__name:"Show",props:{obligacion:{},contrato:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canCreateChild:{type:Boolean}},setup(o){const M=o,{hasPermission:S}=et(),I=D("general"),s=D({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null,entregable_id:null}),T=[{title:"Admin",href:"/admin/dashboard"},{title:"Obligaciones",href:"/admin/obligaciones"},{title:M.obligacion.titulo}],v=E(()=>M.obligacion.evidencias||[]),z=E(()=>{let n=v.value;return s.value.tipo&&(n=n.filter(t=>t.tipo_evidencia===s.value.tipo)),s.value.estado&&(n=n.filter(t=>t.estado===s.value.estado)),s.value.usuario_id&&(n=n.filter(t=>{var m;return((m=t.usuario)==null?void 0:m.id)===s.value.usuario_id})),s.value.entregable_id&&(n=n.filter(t=>{var m;return(m=t.entregables)==null?void 0:m.some(r=>r.id===s.value.entregable_id)})),(s.value.fecha_inicio||s.value.fecha_fin)&&(n=n.filter(t=>{const m=new Date(t.created_at);if(s.value.fecha_inicio){const r=new Date(s.value.fecha_inicio);if(m<r)return!1}if(s.value.fecha_fin){const r=new Date(s.value.fecha_fin);if(r.setHours(23,59,59,999),m>r)return!1}return!0})),n}),k=n=>{if(!n)return"Sin fecha";try{return H(P(n),"dd MMM yyyy HH:mm",{locale:L})}catch{return n}},F=n=>{if(!n)return"-";try{return H(P(n),"d 'de' MMMM 'de' yyyy",{locale:L})}catch{return n}};return(n,t)=>(f(),b(O,null,[a(e(q),{title:`Obligación - ${o.obligacion.titulo}`},null,8,["title"]),a(J,{breadcrumbs:T},{default:i(()=>[l("div",rt,[l("div",dt,[l("div",null,[l("h1",ut,d(o.obligacion.titulo),1),l("p",mt," Contrato: "+d(o.contrato.nombre),1)]),l("div",ct,[a(e(w),{href:`/admin/contratos/${o.contrato.id}`},{default:i(()=>[a(e(A),{variant:"outline",size:"sm"},{default:i(()=>[a(e(at),{class:"h-4 w-4 mr-2"}),t[3]||(t[3]=u(" Ver Contrato ",-1))]),_:1})]),_:1},8,["href"]),o.canEdit?(f(),g(e(w),{key:0,href:n.route("admin.obligaciones.edit",o.obligacion.id)},{default:i(()=>[a(e(A),{variant:"outline",size:"sm"},{default:i(()=>[a(e(it),{class:"h-4 w-4 mr-2"}),t[4]||(t[4]=u(" Editar ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])]),a(e(W),{modelValue:I.value,"onUpdate:modelValue":t[2]||(t[2]=m=>I.value=m),class:"flex-1"},{default:i(()=>{var m;return[a(e(X),null,{default:i(()=>{var r;return[a(e($),{value:"general"},{default:i(()=>[a(e(ot),{class:"h-4 w-4 mr-2"}),t[5]||(t[5]=u(" General ",-1))]),_:1}),(r=o.obligacion.hijos)!=null&&r.length?(f(),g(e($),{key:0,value:"hijos"},{default:i(()=>{var c;return[a(e(st),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=u(" Obligaciones Hijas ",-1)),(c=o.obligacion.hijos)!=null&&c.length?(f(),g(e(B),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:i(()=>[u(d(o.obligacion.hijos.length),1)]),_:1})):p("",!0)]}),_:1})):p("",!0),a(e($),{value:"evidencias"},{default:i(()=>[a(e(lt),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=u(" Evidencias ",-1)),v.value.length>0?(f(),g(e(B),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:i(()=>[u(d(v.value.length),1)]),_:1})):p("",!0)]),_:1})]}),_:1}),a(e(j),{value:"general",class:"space-y-4 mt-6"},{default:i(()=>{var r;return[l("div",ft,[l("div",pt,[a(e(_),null,{default:i(()=>[a(e(h),null,{default:i(()=>[a(e(y),null,{default:i(()=>[...t[8]||(t[8]=[u("Información General",-1)])]),_:1})]),_:1}),a(e(x),{class:"space-y-4"},{default:i(()=>[l("div",null,[a(e(R),null,{default:i(()=>[...t[9]||(t[9]=[u("Descripción",-1)])]),_:1}),l("p",gt,d(o.obligacion.descripcion||"Sin descripción"),1)])]),_:1})]),_:1})]),l("div",vt,[a(e(_),null,{default:i(()=>[a(e(h),null,{default:i(()=>[a(e(y),null,{default:i(()=>[...t[10]||(t[10]=[u("Detalles del Contrato",-1)])]),_:1})]),_:1}),a(e(x),null,{default:i(()=>{var c;return[a(e(w),{href:n.route("admin.contratos.show",o.contrato.id),class:"hover:underline"},{default:i(()=>[l("h3",bt,d(o.contrato.nombre),1)]),_:1},8,["href"]),l("p",_t,d((c=o.contrato.proyecto)==null?void 0:c.nombre),1)]}),_:1})]),_:1}),(r=o.obligacion.archivos_adjuntos)!=null&&r.length?(f(),g(e(_),{key:0},{default:i(()=>[a(e(h),null,{default:i(()=>[a(e(y),null,{default:i(()=>[...t[11]||(t[11]=[u("Archivos Adjuntos",-1)])]),_:1})]),_:1}),a(e(x),null,{default:i(()=>[l("div",ht,[(f(!0),b(O,null,G(o.obligacion.archivos_adjuntos,c=>(f(),b("div",{key:c.ruta,class:"flex items-center gap-2"},[a(e(nt),{class:"h-4 w-4"}),l("a",{href:c.ruta,target:"_blank",class:"hover:underline text-sm"},d(c.nombre_original),9,yt)]))),128))])]),_:1})]),_:1})):p("",!0),a(e(_),null,{default:i(()=>[a(e(h),null,{default:i(()=>[a(e(y),null,{default:i(()=>[...t[12]||(t[12]=[u("Auditoría",-1)])]),_:1})]),_:1}),a(e(x),{class:"text-sm space-y-2"},{default:i(()=>{var c,V,C;return[l("div",null,[t[13]||(t[13]=l("span",{class:"text-gray-600"},"Creado por:",-1)),l("p",null,d(((c=o.obligacion.creador)==null?void 0:c.name)||"Sistema"),1),l("p",xt,d(k(o.obligacion.created_at)),1)]),o.obligacion.updated_at?(f(),b("div",kt,[t[14]||(t[14]=l("span",{class:"text-gray-600"},"Última actualización:",-1)),l("p",null,d(((V=o.obligacion.actualizador)==null?void 0:V.name)||"Sistema"),1),l("p",wt,d(k(o.obligacion.updated_at)),1)])):p("",!0),o.obligacion.cumplido_at?(f(),b("div",$t,[t[15]||(t[15]=l("span",{class:"text-gray-600"},"Cumplido por:",-1)),l("p",null,d(((C=o.obligacion.cumplido_por_usuario)==null?void 0:C.name)||"Sistema"),1),l("p",jt,d(k(o.obligacion.cumplido_at)),1)])):p("",!0)]}),_:1})]),_:1})])])]}),_:1}),(m=o.obligacion.hijos)!=null&&m.length?(f(),g(e(j),{key:0,value:"hijos",class:"space-y-4 mt-6"},{default:i(()=>[a(e(_),null,{default:i(()=>[a(e(h),null,{default:i(()=>[a(e(y),null,{default:i(()=>[...t[16]||(t[16]=[u("Obligaciones Hijas",-1)])]),_:1}),a(e(Q),null,{default:i(()=>[...t[17]||(t[17]=[u(" Sub-obligaciones derivadas de esta obligación principal ",-1)])]),_:1})]),_:1}),a(e(x),null,{default:i(()=>[a(tt,{obligaciones:o.obligacion.hijos,contratoId:o.obligacion.contrato_id,editable:e(S)("obligaciones.edit"),onEdit:t[0]||(t[0]=r=>e(U).visit(n.route("admin.obligaciones.edit",r.id)))},null,8,["obligaciones","contratoId","editable"])]),_:1})]),_:1})]),_:1})):p("",!0),a(e(j),{value:"evidencias",class:"space-y-4 mt-6"},{default:i(()=>[v.value.length>0?(f(),g(Y,{key:0,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=r=>s.value=r),contratos:[o.contrato],evidencias:v.value},null,8,["modelValue","contratos","evidencias"])):p("",!0),a(Z,{mode:"simple",evidencias:z.value,contrato:o.contrato,"format-date":F,"card-title":"Evidencias Asociadas","card-description":"Evidencias cargadas para esta obligación"},null,8,["evidencias","contrato"])]),_:1})]}),_:1},8,["modelValue"])])]),_:1})],64))}});export{Ge as default};
