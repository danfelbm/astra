import{r as G,p as Ce,c as Q,d as Me,i as E,g as f,j as x,F as Z,k as fe,e as l,f as o,w as r,h as _,b as O,m as c,x as lt,t as w,n as J,l as It,ai as dt,o as Wa,B as In,Y as Ia,a1 as Tn,a as qa,v as Bt,y as Ka,s as Ta}from"./app-B7PnGMAV.js";import{g as Pn}from"./Input.vue_vue_type_script_setup_true_lang-8PRhBqBe.js";import{_ as ve,c as he,a as Se,b as $e}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dn6Y_7jM.js";import{c as Qa,_ as q}from"./createLucideIcon-DI6U3gwA.js";import{_ as ne}from"./index-BTD9fiCJ.js";import{_ as Ht}from"./Progress.vue_vue_type_script_setup_true_lang-2o3N4wR2.js";import{_ as wt}from"./ScrollArea.vue_vue_type_script_setup_true_lang-XXBtXlUk.js";import{_ as An}from"./Separator.vue_vue_type_script_setup_true_lang-tF4a0FQj.js";import{C as xa,_ as Jt,a as ea,b as ta,c as aa,d as ut}from"./SelectValue.vue_vue_type_script_setup_true_lang-CIqxaMm-.js";import{_ as On,a as Mn,b as Nn,c as Rn,d as Vn,e as Fn,f as zn,g as Bn}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-4f_l857Q.js";import{f as Ye,e as Xe}from"./es-BDPlFIsO.js";import{b as Hn,_ as Un,a as jn}from"./EntregablesFilters.vue_vue_type_script_setup_true_lang-DjpKvvF0.js";import{_ as Ln}from"./Switch.vue_vue_type_script_setup_true_lang-BOdpIi2s.js";import{_ as Yn}from"./Label.vue_vue_type_script_setup_true_lang-DoPMf_am.js";import{L as Xn}from"./list-CP2SepB6.js";import{L as Gn,c as Za}from"./useFlashMessages-D8oQ7xAJ.js";import{C as st}from"./circle-alert-DiJEEPwx.js";import{C as Qt}from"./circle-x-BuGY1ft8.js";import{C as Pe}from"./clock-C6h25bnn.js";import{C as it}from"./circle-check-big-BKNqQUxA.js";import{C as Ja}from"./chevron-right-BJKzZMx4.js";import{F as en}from"./flag-BOhFd9-5.js";import{C as Ge}from"./calendar-C6eInWsE.js";import{U as tt}from"./user-Dmzg3JAl.js";import{E as Pa}from"./eye-D3-WG7cb.js";import{S as _t}from"./square-pen-DIFQNOp6.js";import{M as We}from"./message-square-DMKhvwiP.js";import{A as qe,_ as Wn,a as qn}from"./EvidenciasTable.vue_vue_type_script_setup_true_lang-MfQte96W.js";import{U as ma}from"./users-pLklPB45.js";import{T as tn}from"./trash-2-ufHImNLu.js";import{F as at}from"./file-text-CmH6cCEi.js";import{_ as wa,a as _a,b as Ie,c as Te}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-DvH9xjCG.js";import{e as an,_ as nn,a as on,b as Ut,c as jt,d as ln}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Caz8PVl-.js";import{_ as sn,a as rn}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BAQIV-m0.js";import{_ as Be}from"./Skeleton.vue_vue_type_script_setup_true_lang-DxMhrzj-.js";import{_ as dn,a as un}from"./ActivityLog.vue_vue_type_script_setup_true_lang-6G19QGpp.js";import{_ as cn}from"./CamposPersonalizadosDisplay.vue_vue_type_script_setup_true_lang-DieJhexJ.js";import{_ as fn}from"./ComentariosPanel.vue_vue_type_script_setup_true_lang-CJkkmuos.js";import{T as ga,a as mn}from"./target-CjPz38v3.js";import{R as gn}from"./refresh-cw-Bk50pH_N.js";import{E as Lt}from"./external-link-CjNpfxsJ.js";import{p as Yt}from"./parseISO-DFjB8F03.js";import{_ as Kn}from"./CardDescription.vue_vue_type_script_setup_true_lang-VOU9gGEk.js";import{_ as Aa,a as Oa,b as Ma}from"./index-Dy_wxwuH.js";import{_ as Qn,a as Zn}from"./index-DSZ-TYzn.js";import{I as na}from"./image-De4SlgHg.js";import{d as Jn}from"./differenceInDays-CDkc-BiT.js";import{F as eo}from"./folder-open-BhmZXeXX.js";import{P as Na}from"./plus-BQz4addL.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Qa("Columns3Icon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=Qa("ListTodoIcon",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),ct={VIEW_MODE:"entregables-view-mode",CONFIRM_ON_DRAG:"entregables-confirm-drag"},pt={pendiente:{label:"Pendiente",color:"text-gray-800",bgColor:"bg-gray-100",dotColor:"bg-gray-400"},en_progreso:{label:"En Progreso",color:"text-blue-800",bgColor:"bg-blue-100",dotColor:"bg-blue-500"},completado:{label:"Completado",color:"text-green-800",bgColor:"bg-green-100",dotColor:"bg-green-500"},cancelado:{label:"Cancelado",color:"text-red-800",bgColor:"bg-red-100",dotColor:"bg-red-500"}},Mt={baja:{label:"Baja",color:"text-gray-600",bgColor:"bg-gray-100"},media:{label:"Media",color:"text-yellow-800",bgColor:"bg-yellow-100"},alta:{label:"Alta",color:"text-red-800",bgColor:"bg-red-100"}},pa=["pendiente","en_progreso","completado","cancelado"];function Et(e,t={}){const{defaultViewMode:n="list",defaultConfirmOnDrag:a=!0}=t,i=G(localStorage.getItem(ct.VIEW_MODE)||n),s=G(localStorage.getItem(ct.CONFIRM_ON_DRAG)!==null?localStorage.getItem(ct.CONFIRM_ON_DRAG)==="true":a);Ce(i,h=>{localStorage.setItem(ct.VIEW_MODE,h)}),Ce(s,h=>{localStorage.setItem(ct.CONFIRM_ON_DRAG,String(h))});const u=Q(()=>({pendientes:e.value.filter(h=>h.estado==="pendiente"),en_progreso:e.value.filter(h=>h.estado==="en_progreso"),completados:e.value.filter(h=>h.estado==="completado"),cancelados:e.value.filter(h=>h.estado==="cancelado")}));return{viewMode:i,confirmOnDrag:s,entregablesAgrupados:u,getEstadoConfig:h=>pt[h]||pt.pendiente,getPrioridadConfig:h=>Mt[h]||Mt.baja,getEstadoColor:h=>{const P=pt[h];return P?`${P.bgColor} ${P.color}`:"bg-gray-100 text-gray-800"},getPrioridadColor:h=>{const P=Mt[h];return P?`${P.bgColor} ${P.color}`:"bg-gray-100 text-gray-600"},formatDate:h=>h?Ye(new Date(h),"dd MMM yyyy",{locale:Xe}):"Sin fecha",formatDateTime:h=>h?Ye(new Date(h),"dd MMM yyyy 'a las' HH:mm",{locale:Xe}):"-",getDiasRestantes:h=>{if(!h)return null;const P=Math.ceil((new Date(h).getTime()-new Date().getTime())/(1e3*60*60*24));return P<0?`Vencido hace ${Math.abs(P)} días`:P===0?"Vence hoy":P===1?"Vence mañana":`${P} días`},isVencido:(h,P)=>!h||P==="completado"||P==="cancelado"?!1:new Date(h)<new Date}}const ao={class:"flex items-center justify-between gap-4 flex-wrap"},no={class:"flex gap-1 bg-muted p-1 rounded-lg"},oo={class:"ml-1.5 hidden sm:inline text-xs"},lo={key:0,class:"flex items-center gap-2"},so=Me({__name:"HitosViewModeToggle",props:{modelValue:{},confirmOnDrag:{type:Boolean}},emits:["update:modelValue","update:confirmOnDrag"],setup(e,{emit:t}){const n=t,a=[{value:"list",icon:Xn,label:"Lista"},{value:"tabs",icon:Gn,label:"Tabs"},{value:"kanban",icon:to,label:"Kanban"}];return(i,s)=>(c(),E("div",ao,[f("div",no,[(c(),E(Z,null,fe(a,u=>l(o(q),{key:u.value,variant:e.modelValue===u.value?"default":"ghost",size:"sm",class:"h-8 px-3",title:u.label,onClick:g=>n("update:modelValue",u.value)},{default:r(()=>[(c(),O(lt(u.icon),{class:"h-4 w-4"})),f("span",oo,w(u.label),1)]),_:2},1032,["variant","title","onClick"])),64))]),e.modelValue==="kanban"?(c(),E("div",lo,[l(o(Ln),{id:"confirm-drag","model-value":e.confirmOnDrag,"onUpdate:modelValue":s[0]||(s[0]=u=>n("update:confirmOnDrag",u))},null,8,["model-value"]),l(o(Yn),{for:"confirm-drag",class:"text-sm text-muted-foreground cursor-pointer"},{default:r(()=>[...s[1]||(s[1]=[_(" Confirmar al arrastrar ",-1)])]),_:1})])):x("",!0)]))}}),io={class:"flex items-start gap-2"},ro={class:"flex-1 min-w-0"},uo={class:"flex items-center gap-2 flex-wrap"},co={key:0,class:"mt-1.5 flex items-center gap-2 text-xs text-muted-foreground"},fo={key:1,class:"flex items-center gap-1 truncate"},mo={key:0,class:"flex gap-1 mt-2 pt-2 border-t"},go={key:0,class:"ml-1"},po={key:1,class:"ml-8 mt-3 space-y-3"},vo={key:0,class:"text-sm text-muted-foreground"},ho={class:"flex flex-wrap gap-4 text-sm"},bo={class:"flex items-center gap-1 text-muted-foreground"},yo={key:0,class:"flex items-center gap-1 text-muted-foreground"},xo={key:1,class:"flex items-center gap-2"},wo={class:"flex gap-1 flex-wrap"},_o={key:2,class:"text-sm text-muted-foreground space-y-1"},Eo={key:0,class:"flex items-center gap-1"},Co={key:1,class:"flex items-center gap-1"},Do={key:2,class:"italic mt-2"},ko={key:2,class:"flex items-center gap-1 mt-3 pt-3 border-t"},Ea=Me({__name:"HitosEntregableCard",props:{entregable:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},expanded:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},variant:{default:"default"}},emits:["toggle-expand","view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=G([]),{getEstadoColor:s,getPrioridadColor:u,formatDate:g,formatDateTime:v,getDiasRestantes:m,isVencido:b}=Et(i),p=Q(()=>pt[n.entregable.estado]),S=Q(()=>Mt[n.entregable.prioridad]),C=Q(()=>m(n.entregable.fecha_fin)),d=Q(()=>b(n.entregable.fecha_fin,n.entregable.estado)),h=Q(()=>n.entregable.estado==="completado"),P=Q(()=>n.entregable.estado==="cancelado"),U=Q(()=>{switch(n.entregable.estado){case"completado":return it;case"en_progreso":return Pe;case"cancelado":return Qt;default:return st}}),j=Q(()=>{const K="transition-all duration-150",T={en_progreso:"border-l-4 border-l-blue-500",completado:"border-l-4 border-l-green-500 bg-green-50/30",cancelado:"border-l-4 border-l-red-500 bg-red-50/30"},Y=[K];return T[n.entregable.estado]&&Y.push(T[n.entregable.estado]),n.draggable&&Y.push("cursor-grab active:cursor-grabbing hover:shadow-md"),Y.join(" ")});return(K,T)=>(c(),O(o(ve),{class:J(j.value),"data-id":e.entregable.id,"data-estado":e.entregable.estado},{default:r(()=>[l(o(he),{class:J(e.variant==="kanban"?"p-3":"p-4")},{default:r(()=>[f("div",io,[e.variant!=="kanban"?(c(),O(o(q),{key:0,variant:"ghost",size:"sm",class:"h-6 w-6 p-0 flex-shrink-0",onClick:T[0]||(T[0]=Y=>a("toggle-expand"))},{default:r(()=>[e.expanded?(c(),O(o(xa),{key:1,class:"h-4 w-4"})):(c(),O(o(Ja),{key:0,class:"h-4 w-4"}))]),_:1})):x("",!0),e.variant==="kanban"?(c(),O(lt(U.value),{key:1,class:J(["h-4 w-4 flex-shrink-0 mt-0.5",p.value.color])},null,8,["class"])):x("",!0),f("div",ro,[f("div",uo,[f("h4",{class:J(["font-medium truncate",{"line-through text-muted-foreground":h.value,"text-sm":e.variant==="kanban"}])},w(e.entregable.nombre),3),e.variant!=="kanban"?(c(),E(Z,{key:0},[l(o(ne),{class:J([o(u)(e.entregable.prioridad),"text-[10px] px-1.5"]),variant:"outline"},{default:r(()=>[_(w(S.value.label),1)]),_:1},8,["class"]),l(o(ne),{class:J([o(s)(e.entregable.estado),"text-[10px] px-1.5"])},{default:r(()=>[_(w(p.value.label),1)]),_:1},8,["class"])],64)):x("",!0),e.variant==="kanban"&&e.entregable.prioridad==="alta"?(c(),O(o(ne),{key:1,class:"bg-red-100 text-red-800 text-[10px] px-1"},{default:r(()=>[l(o(en),{class:"h-3 w-3"})]),_:1})):x("",!0)]),e.variant==="kanban"?(c(),E("div",co,[e.entregable.fecha_fin?(c(),E("span",{key:0,class:J(["flex items-center gap-1",{"text-red-600":d.value}])},[l(o(Ge),{class:"h-3 w-3"}),_(" "+w(o(g)(e.entregable.fecha_fin)),1)],2)):x("",!0),e.entregable.responsable?(c(),E("span",fo,[l(o(tt),{class:"h-3 w-3"}),_(" "+w(e.entregable.responsable.name),1)])):x("",!0)])):x("",!0)])]),e.variant==="kanban"?(c(),E("div",mo,[l(o(q),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:T[1]||(T[1]=It(Y=>a("view"),["stop"]))},{default:r(()=>[l(o(Pa),{class:"h-3 w-3 mr-1"}),T[13]||(T[13]=_(" Ver ",-1))]),_:1}),l(o(q),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:T[2]||(T[2]=It(Y=>a("edit"),["stop"]))},{default:r(()=>[l(o(_t),{class:"h-3 w-3 mr-1"}),T[14]||(T[14]=_(" Editar ",-1))]),_:1}),l(o(q),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:T[3]||(T[3]=It(Y=>a("show-comentarios"),["stop"])),title:"Comentarios"},{default:r(()=>[l(o(We),{class:"h-3 w-3"}),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(c(),E("span",go,w(e.entregable.comentarios_count),1)):x("",!0)]),_:1}),l(o(q),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:T[4]||(T[4]=It(Y=>a("show-actividad"),["stop"])),title:"Actividad"},{default:r(()=>[l(o(qe),{class:"h-3 w-3"})]),_:1})])):x("",!0),e.expanded&&e.variant!=="kanban"?(c(),E("div",po,[e.entregable.descripcion?(c(),E("p",vo,w(e.entregable.descripcion),1)):x("",!0),f("div",ho,[f("div",bo,[l(o(Ge),{class:"h-4 w-4"}),f("span",null,w(o(g)(e.entregable.fecha_inicio))+" - "+w(o(g)(e.entregable.fecha_fin)),1)]),e.entregable.responsable?(c(),E("div",yo,[l(o(tt),{class:"h-4 w-4"}),f("span",null,w(e.entregable.responsable.name),1)])):x("",!0),C.value?(c(),E("div",{key:1,class:J(["flex items-center gap-1",{"text-red-600":d.value}])},[l(o(Pe),{class:"h-4 w-4"}),f("span",null,w(C.value),1)],2)):x("",!0)]),e.entregable.usuarios&&e.entregable.usuarios.length>0?(c(),E("div",xo,[l(o(ma),{class:"h-4 w-4 text-muted-foreground"}),f("div",wo,[(c(!0),E(Z,null,fe(e.entregable.usuarios,Y=>(c(),O(o(ne),{key:Y.id,variant:"secondary",class:"text-xs"},{default:r(()=>[_(w(Y.name),1)]),_:2},1024))),128))])])):x("",!0),h.value?(c(),E("div",_o,[e.entregable.completado_at?(c(),E("div",Eo,[l(o(Pe),{class:"h-3 w-3"}),f("span",null,"Completado: "+w(o(v)(e.entregable.completado_at)),1)])):x("",!0),e.entregable.completado_por_usuario?(c(),E("div",Co,[l(o(tt),{class:"h-3 w-3"}),f("span",null,"Por: "+w(e.entregable.completado_por_usuario.name),1)])):x("",!0),e.entregable.observaciones_estado?(c(),E("p",Do,' "'+w(e.entregable.observaciones_estado)+'" ',1)):x("",!0)])):x("",!0)])):x("",!0),e.variant==="default"&&(e.canEdit||e.canDelete||e.canComplete)?(c(),E("div",ko,[l(o(q),{variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[5]||(T[5]=Y=>a("view"))},{default:r(()=>[l(o(Pa),{class:"h-3 w-3 mr-1"}),T[15]||(T[15]=_(" Ver detalles ",-1))]),_:1}),!h.value&&!P.value?(c(),E(Z,{key:0},[e.canComplete?(c(),O(o(q),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[6]||(T[6]=Y=>a("complete"))},{default:r(()=>[l(o(it),{class:"h-3 w-3 mr-1"}),T[16]||(T[16]=_(" Completar ",-1))]),_:1})):x("",!0),e.canEdit&&e.entregable.estado==="pendiente"?(c(),O(o(q),{key:1,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[7]||(T[7]=Y=>a("change-status","en_progreso"))},{default:r(()=>[l(o(Pe),{class:"h-3 w-3 mr-1"}),T[17]||(T[17]=_(" En progreso ",-1))]),_:1})):x("",!0)],64)):h.value?(c(),E(Z,{key:1},[e.canEdit?(c(),O(o(q),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[8]||(T[8]=Y=>a("change-status","pendiente"))},{default:r(()=>[l(o(st),{class:"h-3 w-3 mr-1"}),T[18]||(T[18]=_(" Reabrir ",-1))]),_:1})):x("",!0)],64)):x("",!0),e.canEdit?(c(),O(o(q),{key:2,variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:T[9]||(T[9]=Y=>a("edit"))},{default:r(()=>[l(o(_t),{class:"h-3 w-3 mr-1"}),T[19]||(T[19]=_(" Editar ",-1))]),_:1})):x("",!0),l(o(q),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:T[10]||(T[10]=Y=>a("show-comentarios"))},{default:r(()=>[l(o(We),{class:"h-3 w-3 mr-1"}),T[20]||(T[20]=_(" Comentarios ",-1)),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(c(),O(o(ne),{key:0,variant:"secondary",class:"ml-1 text-xs"},{default:r(()=>[_(w(e.entregable.comentarios_count),1)]),_:1})):x("",!0)]),_:1}),l(o(q),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:T[11]||(T[11]=Y=>a("show-actividad"))},{default:r(()=>[l(o(qe),{class:"h-3 w-3 mr-1"}),T[21]||(T[21]=_(" Actividad ",-1))]),_:1}),e.canDelete?(c(),O(o(q),{key:3,variant:"ghost",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50",onClick:T[12]||(T[12]=Y=>a("delete"))},{default:r(()=>[l(o(tn),{class:"h-3 w-3 mr-1"}),T[22]||(T[22]=_(" Eliminar ",-1))]),_:1})):x("",!0)])):x("",!0)]),_:1},8,["class"])]),_:1},8,["class","data-id","data-estado"]))}}),So={class:"space-y-6"},$o={key:0},Io={class:"font-semibold mb-3 flex items-center gap-2"},To={class:"space-y-2"},Po={key:0,class:"text-center py-8"},Ao=Me({__name:"HitosEntregablesList",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=dt(n,"entregables"),{entregablesAgrupados:s}=Et(i),u=G(new Set),g=S=>{u.value.has(S)?u.value.delete(S):u.value.add(S)},v=S=>u.value.has(S),m=S=>{a("complete",S)},b=(S,C)=>{a("change-status",S,C)},p=[{key:"pendientes",icon:st,iconClass:"text-yellow-600",label:"Pendientes"},{key:"en_progreso",icon:Pe,iconClass:"text-blue-600",label:"En Progreso"},{key:"completados",icon:it,iconClass:"text-green-600",label:"Completados"},{key:"cancelados",icon:Qt,iconClass:"text-red-600",label:"Cancelados"}];return(S,C)=>(c(),E("div",So,[(c(),E(Z,null,fe(p,d=>(c(),E(Z,{key:d.key},[o(s)[d.key].length>0?(c(),E("div",$o,[f("h3",Io,[(c(),O(lt(d.icon),{class:J(["h-5 w-5",d.iconClass])},null,8,["class"])),_(" "+w(d.label)+" ("+w(o(s)[d.key].length)+") ",1)]),f("div",To,[(c(!0),E(Z,null,fe(o(s)[d.key],h=>(c(),O(Ea,{key:h.id,entregable:h,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:v(h.id),variant:"default",onToggleExpand:P=>g(h.id),onView:P=>a("view",h),onEdit:P=>a("edit",h),onDelete:P=>a("delete",h),onComplete:P=>m(h),onChangeStatus:P=>b(h,P),onShowComentarios:P=>a("show-comentarios",h),onShowActividad:P=>a("show-actividad",h)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])])):x("",!0)],64))),64)),e.entregables.length===0?(c(),E("div",Po,[l(o(at),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),C[0]||(C[0]=f("p",{class:"text-muted-foreground"},"No hay entregables asignados",-1))])):x("",!0)]))}}),Oo={class:"hidden sm:inline text-xs"},Mo={key:0,class:"space-y-2"},No={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},Ro={class:"text-muted-foreground text-sm"},Vo=Me({__name:"HitosEntregablesTabs",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=dt(n,"entregables"),{entregablesAgrupados:s}=Et(i),u=G(new Set),g=G("pendiente"),v=d=>{u.value.has(d)?u.value.delete(d):u.value.add(d)},m=d=>u.value.has(d),b={pendiente:{icon:st,iconClass:"text-yellow-600",label:"Pendientes",key:"pendientes"},en_progreso:{icon:Pe,iconClass:"text-blue-600",label:"En Progreso",key:"en_progreso"},completado:{icon:it,iconClass:"text-green-600",label:"Completados",key:"completados"},cancelado:{icon:Qt,iconClass:"text-red-600",label:"Cancelados",key:"cancelados"}},p=d=>{a("complete",d)},S=(d,h)=>{a("change-status",d,h)},C=d=>{const h=b[d];return s.value[h.key]};return(d,h)=>(c(),O(o(wa),{modelValue:g.value,"onUpdate:modelValue":h[0]||(h[0]=P=>g.value=P),class:"w-full"},{default:r(()=>[l(o(_a),{class:"w-full grid grid-cols-4 h-auto"},{default:r(()=>[(c(!0),E(Z,null,fe(o(pa),P=>(c(),O(o(Ie),{key:P,value:P,class:"gap-1.5 py-2 px-2 data-[state=active]:bg-background"},{default:r(()=>[(c(),O(lt(b[P].icon),{class:J(["h-4 w-4 flex-shrink-0",b[P].iconClass])},null,8,["class"])),f("span",Oo,w(b[P].label),1),l(o(ne),{variant:"secondary",class:"ml-1 text-xs px-1.5 py-0"},{default:r(()=>[_(w(C(P).length),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),(c(!0),E(Z,null,fe(o(pa),P=>(c(),O(o(Te),{key:P,value:P,class:"mt-4"},{default:r(()=>[C(P).length>0?(c(),E("div",Mo,[(c(!0),E(Z,null,fe(C(P),U=>(c(),O(Ea,{key:U.id,entregable:U,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:m(U.id),variant:"default",onToggleExpand:j=>v(U.id),onView:j=>a("view",U),onEdit:j=>a("edit",U),onDelete:j=>a("delete",U),onComplete:j=>p(U),onChangeStatus:j=>S(U,j),onShowComentarios:j=>a("show-comentarios",U),onShowActividad:j=>a("show-actividad",U)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])):(c(),E("div",No,[(c(),O(lt(b[P].icon),{class:J(["h-10 w-10 mx-auto mb-3",b[P].iconClass+"/50"])},null,8,["class"])),f("p",Ro," No hay entregables "+w(b[P].label.toLowerCase()),1)]))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))}});/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ra(Object(n),!0).forEach(function(a){Fo(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Nt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Nt=function(t){return typeof t}:Nt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(e)}function Fo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Re(){return Re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Re.apply(this,arguments)}function zo(e,t){if(e==null)return{};var n={},a=Object.keys(e),i,s;for(s=0;s<a.length;s++)i=a[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Bo(e,t){if(e==null)return{};var n=zo(e,t),a,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Ho="1.15.6";function Ne(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Ve=Ne(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ct=Ne(/Edge/i),Va=Ne(/firefox/i),vt=Ne(/safari/i)&&!Ne(/chrome/i)&&!Ne(/android/i),Ca=Ne(/iP(ad|od|hone)/i),pn=Ne(/chrome/i)&&Ne(/android/i),vn={capture:!1,passive:!1};function W(e,t,n){e.addEventListener(t,n,!Ve&&vn)}function X(e,t,n){e.removeEventListener(t,n,!Ve&&vn)}function Xt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function hn(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ke(e,t,n,a){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&Xt(e,t):Xt(e,t))||a&&e===n)return e;if(e===n)break}while(e=hn(e))}return null}var Fa=/\s+/g;function we(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(Fa," ").replace(" "+t+" "," ");e.className=(a+(n?" "+t:"")).replace(Fa," ")}}function F(e,t,n){var a=e&&e.style;if(a){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in a)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),a[t]=n+(typeof n=="string"?"":"px")}}function ot(e,t){var n="";if(typeof e=="string")n=e;else do{var a=F(e,"transform");a&&a!=="none"&&(n=a+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function bn(e,t,n){if(e){var a=e.getElementsByTagName(t),i=0,s=a.length;if(n)for(;i<s;i++)n(a[i],i);return a}return[]}function Ae(){var e=document.scrollingElement;return e||document.documentElement}function se(e,t,n,a,i){if(!(!e.getBoundingClientRect&&e!==window)){var s,u,g,v,m,b,p;if(e!==window&&e.parentNode&&e!==Ae()?(s=e.getBoundingClientRect(),u=s.top,g=s.left,v=s.bottom,m=s.right,b=s.height,p=s.width):(u=0,g=0,v=window.innerHeight,m=window.innerWidth,b=window.innerHeight,p=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!Ve))do if(i&&i.getBoundingClientRect&&(F(i,"transform")!=="none"||n&&F(i,"position")!=="static")){var S=i.getBoundingClientRect();u-=S.top+parseInt(F(i,"border-top-width")),g-=S.left+parseInt(F(i,"border-left-width")),v=u+s.height,m=g+s.width;break}while(i=i.parentNode);if(a&&e!==window){var C=ot(i||e),d=C&&C.a,h=C&&C.d;C&&(u/=h,g/=d,p/=d,b/=h,v=u+b,m=g+p)}return{top:u,left:g,bottom:v,right:m,width:p,height:b}}}function za(e,t,n){for(var a=He(e,!0),i=se(e)[t];a;){var s=se(a)[n],u=void 0;if(u=i>=s,!u)return a;if(a===Ae())break;a=He(a,!1)}return!1}function rt(e,t,n,a){for(var i=0,s=0,u=e.children;s<u.length;){if(u[s].style.display!=="none"&&u[s]!==z.ghost&&(a||u[s]!==z.dragged)&&ke(u[s],n.draggable,e,!1)){if(i===t)return u[s];i++}s++}return null}function Da(e,t){for(var n=e.lastElementChild;n&&(n===z.ghost||F(n,"display")==="none"||t&&!Xt(n,t));)n=n.previousElementSibling;return n||null}function Ee(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==z.clone&&(!t||Xt(e,t))&&n++;return n}function Ba(e){var t=0,n=0,a=Ae();if(e)do{var i=ot(e),s=i.a,u=i.d;t+=e.scrollLeft*s,n+=e.scrollTop*u}while(e!==a&&(e=e.parentNode));return[t,n]}function Uo(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var a in t)if(t.hasOwnProperty(a)&&t[a]===e[n][a])return Number(n)}return-1}function He(e,t){if(!e||!e.getBoundingClientRect)return Ae();var n=e,a=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=F(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Ae();if(a||t)return n;a=!0}}while(n=n.parentNode);return Ae()}function jo(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function oa(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var ht;function yn(e,t){return function(){if(!ht){var n=arguments,a=this;n.length===1?e.call(a,n[0]):e.apply(a,n),ht=setTimeout(function(){ht=void 0},t)}}}function Lo(){clearTimeout(ht),ht=void 0}function xn(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function wn(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function _n(e,t,n){var a={};return Array.from(e.children).forEach(function(i){var s,u,g,v;if(!(!ke(i,t.draggable,e,!1)||i.animated||i===n)){var m=se(i);a.left=Math.min((s=a.left)!==null&&s!==void 0?s:1/0,m.left),a.top=Math.min((u=a.top)!==null&&u!==void 0?u:1/0,m.top),a.right=Math.max((g=a.right)!==null&&g!==void 0?g:-1/0,m.right),a.bottom=Math.max((v=a.bottom)!==null&&v!==void 0?v:-1/0,m.bottom)}}),a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}var be="Sortable"+new Date().getTime();function Yo(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(i){if(!(F(i,"display")==="none"||i===z.ghost)){e.push({target:i,rect:se(i)});var s=Oe({},e[e.length-1].rect);if(i.thisAnimationDuration){var u=ot(i,!0);u&&(s.top-=u.f,s.left-=u.e)}i.fromRect=s}})}},addAnimationState:function(a){e.push(a)},removeAnimationState:function(a){e.splice(Uo(e,{target:a}),1)},animateAll:function(a){var i=this;if(!this.options.animation){clearTimeout(t),typeof a=="function"&&a();return}var s=!1,u=0;e.forEach(function(g){var v=0,m=g.target,b=m.fromRect,p=se(m),S=m.prevFromRect,C=m.prevToRect,d=g.rect,h=ot(m,!0);h&&(p.top-=h.f,p.left-=h.e),m.toRect=p,m.thisAnimationDuration&&oa(S,p)&&!oa(b,p)&&(d.top-p.top)/(d.left-p.left)===(b.top-p.top)/(b.left-p.left)&&(v=Go(d,S,C,i.options)),oa(p,b)||(m.prevFromRect=b,m.prevToRect=p,v||(v=i.options.animation),i.animate(m,d,p,v)),v&&(s=!0,u=Math.max(u,v),clearTimeout(m.animationResetTimer),m.animationResetTimer=setTimeout(function(){m.animationTime=0,m.prevFromRect=null,m.fromRect=null,m.prevToRect=null,m.thisAnimationDuration=null},v),m.thisAnimationDuration=v)}),clearTimeout(t),s?t=setTimeout(function(){typeof a=="function"&&a()},u):typeof a=="function"&&a(),e=[]},animate:function(a,i,s,u){if(u){F(a,"transition",""),F(a,"transform","");var g=ot(this.el),v=g&&g.a,m=g&&g.d,b=(i.left-s.left)/(v||1),p=(i.top-s.top)/(m||1);a.animatingX=!!b,a.animatingY=!!p,F(a,"transform","translate3d("+b+"px,"+p+"px,0)"),this.forRepaintDummy=Xo(a),F(a,"transition","transform "+u+"ms"+(this.options.easing?" "+this.options.easing:"")),F(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){F(a,"transition",""),F(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},u)}}}}function Xo(e){return e.offsetWidth}function Go(e,t,n,a){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*a.animation}var Qe=[],la={initializeByDefault:!0},Dt={mount:function(t){for(var n in la)la.hasOwnProperty(n)&&!(n in t)&&(t[n]=la[n]);Qe.forEach(function(a){if(a.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Qe.push(t)},pluginEvent:function(t,n,a){var i=this;this.eventCanceled=!1,a.cancel=function(){i.eventCanceled=!0};var s=t+"Global";Qe.forEach(function(u){n[u.pluginName]&&(n[u.pluginName][s]&&n[u.pluginName][s](Oe({sortable:n},a)),n.options[u.pluginName]&&n[u.pluginName][t]&&n[u.pluginName][t](Oe({sortable:n},a)))})},initializePlugins:function(t,n,a,i){Qe.forEach(function(g){var v=g.pluginName;if(!(!t.options[v]&&!g.initializeByDefault)){var m=new g(t,n,t.options);m.sortable=t,m.options=t.options,t[v]=m,Re(a,m.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var u=this.modifyOption(t,s,t.options[s]);typeof u<"u"&&(t.options[s]=u)}},getEventProperties:function(t,n){var a={};return Qe.forEach(function(i){typeof i.eventProperties=="function"&&Re(a,i.eventProperties.call(n[i.pluginName],t))}),a},modifyOption:function(t,n,a){var i;return Qe.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[n]=="function"&&(i=s.optionListeners[n].call(t[s.pluginName],a))}),i}};function Wo(e){var t=e.sortable,n=e.rootEl,a=e.name,i=e.targetEl,s=e.cloneEl,u=e.toEl,g=e.fromEl,v=e.oldIndex,m=e.newIndex,b=e.oldDraggableIndex,p=e.newDraggableIndex,S=e.originalEvent,C=e.putSortable,d=e.extraEventProperties;if(t=t||n&&n[be],!!t){var h,P=t.options,U="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Ve&&!Ct?h=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(h=document.createEvent("Event"),h.initEvent(a,!0,!0)),h.to=u||n,h.from=g||n,h.item=i||n,h.clone=s,h.oldIndex=v,h.newIndex=m,h.oldDraggableIndex=b,h.newDraggableIndex=p,h.originalEvent=S,h.pullMode=C?C.lastPutMode:void 0;var j=Oe(Oe({},d),Dt.getEventProperties(a,t));for(var K in j)h[K]=j[K];n&&n.dispatchEvent(h),P[U]&&P[U].call(t,h)}}var qo=["evt"],pe=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=a.evt,s=Bo(a,qo);Dt.pluginEvent.bind(z)(t,n,Oe({dragEl:$,parentEl:ae,ghostEl:H,rootEl:ee,nextEl:Le,lastDownEl:Rt,cloneEl:te,cloneHidden:ze,dragStarted:ft,putSortable:de,activeSortable:z.active,originalEvent:i,oldIndex:et,oldDraggableIndex:bt,newIndex:_e,newDraggableIndex:Fe,hideGhostForTarget:kn,unhideGhostForTarget:Sn,cloneNowHidden:function(){ze=!0},cloneNowShown:function(){ze=!1},dispatchSortableEvent:function(g){ge({sortable:n,name:g,originalEvent:i})}},s))};function ge(e){Wo(Oe({putSortable:de,cloneEl:te,targetEl:$,rootEl:ee,oldIndex:et,oldDraggableIndex:bt,newIndex:_e,newDraggableIndex:Fe},e))}var $,ae,H,ee,Le,Rt,te,ze,et,_e,bt,Fe,Tt,de,Je=!1,Gt=!1,Wt=[],Ue,De,sa,ia,Ha,Ua,ft,Ze,yt,xt=!1,Pt=!1,Vt,ce,ra=[],va=!1,qt=[],Zt=typeof document<"u",At=Ca,ja=Ct||Ve?"cssFloat":"float",Ko=Zt&&!pn&&!Ca&&"draggable"in document.createElement("div"),En=(function(){if(Zt){if(Ve)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),Cn=function(t,n){var a=F(t),i=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),s=rt(t,0,n),u=rt(t,1,n),g=s&&F(s),v=u&&F(u),m=g&&parseInt(g.marginLeft)+parseInt(g.marginRight)+se(s).width,b=v&&parseInt(v.marginLeft)+parseInt(v.marginRight)+se(u).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&g.float&&g.float!=="none"){var p=g.float==="left"?"left":"right";return u&&(v.clear==="both"||v.clear===p)?"vertical":"horizontal"}return s&&(g.display==="block"||g.display==="flex"||g.display==="table"||g.display==="grid"||m>=i&&a[ja]==="none"||u&&a[ja]==="none"&&m+b>i)?"vertical":"horizontal"},Qo=function(t,n,a){var i=a?t.left:t.top,s=a?t.right:t.bottom,u=a?t.width:t.height,g=a?n.left:n.top,v=a?n.right:n.bottom,m=a?n.width:n.height;return i===g||s===v||i+u/2===g+m/2},Zo=function(t,n){var a;return Wt.some(function(i){var s=i[be].options.emptyInsertThreshold;if(!(!s||Da(i))){var u=se(i),g=t>=u.left-s&&t<=u.right+s,v=n>=u.top-s&&n<=u.bottom+s;if(g&&v)return a=i}}),a},Dn=function(t){function n(s,u){return function(g,v,m,b){var p=g.options.group.name&&v.options.group.name&&g.options.group.name===v.options.group.name;if(s==null&&(u||p))return!0;if(s==null||s===!1)return!1;if(u&&s==="clone")return s;if(typeof s=="function")return n(s(g,v,m,b),u)(g,v,m,b);var S=(u?g:v).options.group.name;return s===!0||typeof s=="string"&&s===S||s.join&&s.indexOf(S)>-1}}var a={},i=t.group;(!i||Nt(i)!="object")&&(i={name:i}),a.name=i.name,a.checkPull=n(i.pull,!0),a.checkPut=n(i.put),a.revertClone=i.revertClone,t.group=a},kn=function(){!En&&H&&F(H,"display","none")},Sn=function(){!En&&H&&F(H,"display","")};Zt&&!pn&&document.addEventListener("click",function(e){if(Gt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Gt=!1,!1},!0);var je=function(t){if($){t=t.touches?t.touches[0]:t;var n=Zo(t.clientX,t.clientY);if(n){var a={};for(var i in t)t.hasOwnProperty(i)&&(a[i]=t[i]);a.target=a.rootEl=n,a.preventDefault=void 0,a.stopPropagation=void 0,n[be]._onDragOver(a)}}},Jo=function(t){$&&$.parentNode[be]._isOutsideThisEl(t.target)};function z(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Re({},t),e[be]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Cn(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(u,g){u.setData("Text",g.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:z.supportPointer!==!1&&"PointerEvent"in window&&(!vt||Ca),emptyInsertThreshold:5};Dt.initializePlugins(this,e,n);for(var a in n)!(a in t)&&(t[a]=n[a]);Dn(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:Ko,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?W(e,"pointerdown",this._onTapStart):(W(e,"mousedown",this._onTapStart),W(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(W(e,"dragover",this),W(e,"dragenter",this)),Wt.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Re(this,Yo())}z.prototype={constructor:z,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ze=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,$):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,a=this.el,i=this.options,s=i.preventOnFilter,u=t.type,g=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,v=(g||t).target,m=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||v,b=i.filter;if(il(a),!$&&!(/mousedown|pointerdown/.test(u)&&t.button!==0||i.disabled)&&!m.isContentEditable&&!(!this.nativeDraggable&&vt&&v&&v.tagName.toUpperCase()==="SELECT")&&(v=ke(v,i.draggable,a,!1),!(v&&v.animated)&&Rt!==v)){if(et=Ee(v),bt=Ee(v,i.draggable),typeof b=="function"){if(b.call(this,t,v,this)){ge({sortable:n,rootEl:m,name:"filter",targetEl:v,toEl:a,fromEl:a}),pe("filter",n,{evt:t}),s&&t.preventDefault();return}}else if(b&&(b=b.split(",").some(function(p){if(p=ke(m,p.trim(),a,!1),p)return ge({sortable:n,rootEl:p,name:"filter",targetEl:v,fromEl:a,toEl:a}),pe("filter",n,{evt:t}),!0}),b)){s&&t.preventDefault();return}i.handle&&!ke(m,i.handle,a,!1)||this._prepareDragStart(t,g,v)}}},_prepareDragStart:function(t,n,a){var i=this,s=i.el,u=i.options,g=s.ownerDocument,v;if(a&&!$&&a.parentNode===s){var m=se(a);if(ee=s,$=a,ae=$.parentNode,Le=$.nextSibling,Rt=a,Tt=u.group,z.dragged=$,Ue={target:$,clientX:(n||t).clientX,clientY:(n||t).clientY},Ha=Ue.clientX-m.left,Ua=Ue.clientY-m.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,$.style["will-change"]="all",v=function(){if(pe("delayEnded",i,{evt:t}),z.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Va&&i.nativeDraggable&&($.draggable=!0),i._triggerDragStart(t,n),ge({sortable:i,name:"choose",originalEvent:t}),we($,u.chosenClass,!0)},u.ignore.split(",").forEach(function(b){bn($,b.trim(),da)}),W(g,"dragover",je),W(g,"mousemove",je),W(g,"touchmove",je),u.supportPointer?(W(g,"pointerup",i._onDrop),!this.nativeDraggable&&W(g,"pointercancel",i._onDrop)):(W(g,"mouseup",i._onDrop),W(g,"touchend",i._onDrop),W(g,"touchcancel",i._onDrop)),Va&&this.nativeDraggable&&(this.options.touchStartThreshold=4,$.draggable=!0),pe("delayStart",this,{evt:t}),u.delay&&(!u.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Ct||Ve))){if(z.eventCanceled){this._onDrop();return}u.supportPointer?(W(g,"pointerup",i._disableDelayedDrag),W(g,"pointercancel",i._disableDelayedDrag)):(W(g,"mouseup",i._disableDelayedDrag),W(g,"touchend",i._disableDelayedDrag),W(g,"touchcancel",i._disableDelayedDrag)),W(g,"mousemove",i._delayedDragTouchMoveHandler),W(g,"touchmove",i._delayedDragTouchMoveHandler),u.supportPointer&&W(g,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(v,u.delay)}else v()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){$&&da($),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;X(t,"mouseup",this._disableDelayedDrag),X(t,"touchend",this._disableDelayedDrag),X(t,"touchcancel",this._disableDelayedDrag),X(t,"pointerup",this._disableDelayedDrag),X(t,"pointercancel",this._disableDelayedDrag),X(t,"mousemove",this._delayedDragTouchMoveHandler),X(t,"touchmove",this._delayedDragTouchMoveHandler),X(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?W(document,"pointermove",this._onTouchMove):n?W(document,"touchmove",this._onTouchMove):W(document,"mousemove",this._onTouchMove):(W($,"dragend",this),W(ee,"dragstart",this._onDragStart));try{document.selection?Ft(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(Je=!1,ee&&$){pe("dragStarted",this,{evt:n}),this.nativeDraggable&&W(document,"dragover",Jo);var a=this.options;!t&&we($,a.dragClass,!1),we($,a.ghostClass,!0),z.active=this,t&&this._appendGhost(),ge({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(De){this._lastX=De.clientX,this._lastY=De.clientY,kn();for(var t=document.elementFromPoint(De.clientX,De.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(De.clientX,De.clientY),t!==n);)n=t;if($.parentNode[be]._isOutsideThisEl(t),n)do{if(n[be]){var a=void 0;if(a=n[be]._onDragOver({clientX:De.clientX,clientY:De.clientY,target:t,rootEl:n}),a&&!this.options.dragoverBubble)break}t=n}while(n=hn(n));Sn()}},_onTouchMove:function(t){if(Ue){var n=this.options,a=n.fallbackTolerance,i=n.fallbackOffset,s=t.touches?t.touches[0]:t,u=H&&ot(H,!0),g=H&&u&&u.a,v=H&&u&&u.d,m=At&&ce&&Ba(ce),b=(s.clientX-Ue.clientX+i.x)/(g||1)+(m?m[0]-ra[0]:0)/(g||1),p=(s.clientY-Ue.clientY+i.y)/(v||1)+(m?m[1]-ra[1]:0)/(v||1);if(!z.active&&!Je){if(a&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<a)return;this._onDragStart(t,!0)}if(H){u?(u.e+=b-(sa||0),u.f+=p-(ia||0)):u={a:1,b:0,c:0,d:1,e:b,f:p};var S="matrix(".concat(u.a,",").concat(u.b,",").concat(u.c,",").concat(u.d,",").concat(u.e,",").concat(u.f,")");F(H,"webkitTransform",S),F(H,"mozTransform",S),F(H,"msTransform",S),F(H,"transform",S),sa=b,ia=p,De=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!H){var t=this.options.fallbackOnBody?document.body:ee,n=se($,!0,At,!0,t),a=this.options;if(At){for(ce=t;F(ce,"position")==="static"&&F(ce,"transform")==="none"&&ce!==document;)ce=ce.parentNode;ce!==document.body&&ce!==document.documentElement?(ce===document&&(ce=Ae()),n.top+=ce.scrollTop,n.left+=ce.scrollLeft):ce=Ae(),ra=Ba(ce)}H=$.cloneNode(!0),we(H,a.ghostClass,!1),we(H,a.fallbackClass,!0),we(H,a.dragClass,!0),F(H,"transition",""),F(H,"transform",""),F(H,"box-sizing","border-box"),F(H,"margin",0),F(H,"top",n.top),F(H,"left",n.left),F(H,"width",n.width),F(H,"height",n.height),F(H,"opacity","0.8"),F(H,"position",At?"absolute":"fixed"),F(H,"zIndex","100000"),F(H,"pointerEvents","none"),z.ghost=H,t.appendChild(H),F(H,"transform-origin",Ha/parseInt(H.style.width)*100+"% "+Ua/parseInt(H.style.height)*100+"%")}},_onDragStart:function(t,n){var a=this,i=t.dataTransfer,s=a.options;if(pe("dragStart",this,{evt:t}),z.eventCanceled){this._onDrop();return}pe("setupClone",this),z.eventCanceled||(te=wn($),te.removeAttribute("id"),te.draggable=!1,te.style["will-change"]="",this._hideClone(),we(te,this.options.chosenClass,!1),z.clone=te),a.cloneId=Ft(function(){pe("clone",a),!z.eventCanceled&&(a.options.removeCloneOnHide||ee.insertBefore(te,$),a._hideClone(),ge({sortable:a,name:"clone"}))}),!n&&we($,s.dragClass,!0),n?(Gt=!0,a._loopId=setInterval(a._emulateDragOver,50)):(X(document,"mouseup",a._onDrop),X(document,"touchend",a._onDrop),X(document,"touchcancel",a._onDrop),i&&(i.effectAllowed="move",s.setData&&s.setData.call(a,i,$)),W(document,"drop",a),F($,"transform","translateZ(0)")),Je=!0,a._dragStartId=Ft(a._dragStarted.bind(a,n,t)),W(document,"selectstart",a),ft=!0,window.getSelection().removeAllRanges(),vt&&F(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,a=t.target,i,s,u,g=this.options,v=g.group,m=z.active,b=Tt===v,p=g.sort,S=de||m,C,d=this,h=!1;if(va)return;function P(ue,Ke){pe(ue,d,Oe({evt:t,isOwner:b,axis:C?"vertical":"horizontal",revert:u,dragRect:i,targetRect:s,canSort:p,fromSortable:S,target:a,completed:j,onMove:function(kt,St){return Ot(ee,n,$,i,kt,se(kt),t,St)},changed:K},Ke))}function U(){P("dragOverAnimationCapture"),d.captureAnimationState(),d!==S&&S.captureAnimationState()}function j(ue){return P("dragOverCompleted",{insertion:ue}),ue&&(b?m._hideClone():m._showClone(d),d!==S&&(we($,de?de.options.ghostClass:m.options.ghostClass,!1),we($,g.ghostClass,!0)),de!==d&&d!==z.active?de=d:d===z.active&&de&&(de=null),S===d&&(d._ignoreWhileAnimating=a),d.animateAll(function(){P("dragOverAnimationComplete"),d._ignoreWhileAnimating=null}),d!==S&&(S.animateAll(),S._ignoreWhileAnimating=null)),(a===$&&!$.animated||a===n&&!a.animated)&&(Ze=null),!g.dragoverBubble&&!t.rootEl&&a!==document&&($.parentNode[be]._isOutsideThisEl(t.target),!ue&&je(t)),!g.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),h=!0}function K(){_e=Ee($),Fe=Ee($,g.draggable),ge({sortable:d,name:"change",toEl:n,newIndex:_e,newDraggableIndex:Fe,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),a=ke(a,g.draggable,n,!0),P("dragOver"),z.eventCanceled)return h;if($.contains(t.target)||a.animated&&a.animatingX&&a.animatingY||d._ignoreWhileAnimating===a)return j(!1);if(Gt=!1,m&&!g.disabled&&(b?p||(u=ae!==ee):de===this||(this.lastPutMode=Tt.checkPull(this,m,$,t))&&v.checkPut(this,m,$,t))){if(C=this._getDirection(t,a)==="vertical",i=se($),P("dragOverValid"),z.eventCanceled)return h;if(u)return ae=ee,U(),this._hideClone(),P("revert"),z.eventCanceled||(Le?ee.insertBefore($,Le):ee.appendChild($)),j(!0);var T=Da(n,g.draggable);if(!T||nl(t,C,this)&&!T.animated){if(T===$)return j(!1);if(T&&n===t.target&&(a=T),a&&(s=se(a)),Ot(ee,n,$,i,a,s,t,!!a)!==!1)return U(),T&&T.nextSibling?n.insertBefore($,T.nextSibling):n.appendChild($),ae=n,K(),j(!0)}else if(T&&al(t,C,this)){var Y=rt(n,0,g,!0);if(Y===$)return j(!1);if(a=Y,s=se(a),Ot(ee,n,$,i,a,s,t,!1)!==!1)return U(),n.insertBefore($,Y),ae=n,K(),j(!0)}else if(a.parentNode===n){s=se(a);var oe=0,re,me=$.parentNode!==n,V=!Qo($.animated&&$.toRect||i,a.animated&&a.toRect||s,C),A=C?"top":"left",D=za(a,"top","top")||za($,"top","top"),N=D?D.scrollTop:void 0;Ze!==a&&(re=s[A],xt=!1,Pt=!V&&g.invertSwap||me),oe=ol(t,a,s,C,V?1:g.swapThreshold,g.invertedSwapThreshold==null?g.swapThreshold:g.invertedSwapThreshold,Pt,Ze===a);var k;if(oe!==0){var y=Ee($);do y-=oe,k=ae.children[y];while(k&&(F(k,"display")==="none"||k===H))}if(oe===0||k===a)return j(!1);Ze=a,yt=oe;var M=a.nextElementSibling,L=!1;L=oe===1;var ye=Ot(ee,n,$,i,a,s,t,L);if(ye!==!1)return(ye===1||ye===-1)&&(L=ye===1),va=!0,setTimeout(tl,30),U(),L&&!M?n.appendChild($):a.parentNode.insertBefore($,L?M:a),D&&xn(D,0,N-D.scrollTop),ae=$.parentNode,re!==void 0&&!Pt&&(Vt=Math.abs(re-se(a)[A])),K(),j(!0)}if(n.contains($))return j(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){X(document,"mousemove",this._onTouchMove),X(document,"touchmove",this._onTouchMove),X(document,"pointermove",this._onTouchMove),X(document,"dragover",je),X(document,"mousemove",je),X(document,"touchmove",je)},_offUpEvents:function(){var t=this.el.ownerDocument;X(t,"mouseup",this._onDrop),X(t,"touchend",this._onDrop),X(t,"pointerup",this._onDrop),X(t,"pointercancel",this._onDrop),X(t,"touchcancel",this._onDrop),X(document,"selectstart",this)},_onDrop:function(t){var n=this.el,a=this.options;if(_e=Ee($),Fe=Ee($,a.draggable),pe("drop",this,{evt:t}),ae=$&&$.parentNode,_e=Ee($),Fe=Ee($,a.draggable),z.eventCanceled){this._nulling();return}Je=!1,Pt=!1,xt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ha(this.cloneId),ha(this._dragStartId),this.nativeDraggable&&(X(document,"drop",this),X(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),vt&&F(document.body,"user-select",""),F($,"transform",""),t&&(ft&&(t.cancelable&&t.preventDefault(),!a.dropBubble&&t.stopPropagation()),H&&H.parentNode&&H.parentNode.removeChild(H),(ee===ae||de&&de.lastPutMode!=="clone")&&te&&te.parentNode&&te.parentNode.removeChild(te),$&&(this.nativeDraggable&&X($,"dragend",this),da($),$.style["will-change"]="",ft&&!Je&&we($,de?de.options.ghostClass:this.options.ghostClass,!1),we($,this.options.chosenClass,!1),ge({sortable:this,name:"unchoose",toEl:ae,newIndex:null,newDraggableIndex:null,originalEvent:t}),ee!==ae?(_e>=0&&(ge({rootEl:ae,name:"add",toEl:ae,fromEl:ee,originalEvent:t}),ge({sortable:this,name:"remove",toEl:ae,originalEvent:t}),ge({rootEl:ae,name:"sort",toEl:ae,fromEl:ee,originalEvent:t}),ge({sortable:this,name:"sort",toEl:ae,originalEvent:t})),de&&de.save()):_e!==et&&_e>=0&&(ge({sortable:this,name:"update",toEl:ae,originalEvent:t}),ge({sortable:this,name:"sort",toEl:ae,originalEvent:t})),z.active&&((_e==null||_e===-1)&&(_e=et,Fe=bt),ge({sortable:this,name:"end",toEl:ae,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){pe("nulling",this),ee=$=ae=H=Le=te=Rt=ze=Ue=De=ft=_e=Fe=et=bt=Ze=yt=de=Tt=z.dragged=z.ghost=z.clone=z.active=null,qt.forEach(function(t){t.checked=!0}),qt.length=sa=ia=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":$&&(this._onDragOver(t),el(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,a=this.el.children,i=0,s=a.length,u=this.options;i<s;i++)n=a[i],ke(n,u.draggable,this.el,!1)&&t.push(n.getAttribute(u.dataIdAttr)||sl(n));return t},sort:function(t,n){var a={},i=this.el;this.toArray().forEach(function(s,u){var g=i.children[u];ke(g,this.options.draggable,i,!1)&&(a[s]=g)},this),n&&this.captureAnimationState(),t.forEach(function(s){a[s]&&(i.removeChild(a[s]),i.appendChild(a[s]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return ke(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var a=this.options;if(n===void 0)return a[t];var i=Dt.modifyOption(this,t,n);typeof i<"u"?a[t]=i:a[t]=n,t==="group"&&Dn(a)},destroy:function(){pe("destroy",this);var t=this.el;t[be]=null,X(t,"mousedown",this._onTapStart),X(t,"touchstart",this._onTapStart),X(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(X(t,"dragover",this),X(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Wt.splice(Wt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ze){if(pe("hideClone",this),z.eventCanceled)return;F(te,"display","none"),this.options.removeCloneOnHide&&te.parentNode&&te.parentNode.removeChild(te),ze=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ze){if(pe("showClone",this),z.eventCanceled)return;$.parentNode==ee&&!this.options.group.revertClone?ee.insertBefore(te,$):Le?ee.insertBefore(te,Le):ee.appendChild(te),this.options.group.revertClone&&this.animate($,te),F(te,"display",""),ze=!1}}};function el(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Ot(e,t,n,a,i,s,u,g){var v,m=e[be],b=m.options.onMove,p;return window.CustomEvent&&!Ve&&!Ct?v=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent("move",!0,!0)),v.to=t,v.from=e,v.dragged=n,v.draggedRect=a,v.related=i||t,v.relatedRect=s||se(t),v.willInsertAfter=g,v.originalEvent=u,e.dispatchEvent(v),b&&(p=b.call(m,v,u)),p}function da(e){e.draggable=!1}function tl(){va=!1}function al(e,t,n){var a=se(rt(n.el,0,n.options,!0)),i=_n(n.el,n.options,H),s=10;return t?e.clientX<i.left-s||e.clientY<a.top&&e.clientX<a.right:e.clientY<i.top-s||e.clientY<a.bottom&&e.clientX<a.left}function nl(e,t,n){var a=se(Da(n.el,n.options.draggable)),i=_n(n.el,n.options,H),s=10;return t?e.clientX>i.right+s||e.clientY>a.bottom&&e.clientX>a.left:e.clientY>i.bottom+s||e.clientX>a.right&&e.clientY>a.top}function ol(e,t,n,a,i,s,u,g){var v=a?e.clientY:e.clientX,m=a?n.height:n.width,b=a?n.top:n.left,p=a?n.bottom:n.right,S=!1;if(!u){if(g&&Vt<m*i){if(!xt&&(yt===1?v>b+m*s/2:v<p-m*s/2)&&(xt=!0),xt)S=!0;else if(yt===1?v<b+Vt:v>p-Vt)return-yt}else if(v>b+m*(1-i)/2&&v<p-m*(1-i)/2)return ll(t)}return S=S||u,S&&(v<b+m*s/2||v>p-m*s/2)?v>b+m/2?1:-1:0}function ll(e){return Ee($)<Ee(e)?1:-1}function sl(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,a=0;n--;)a+=t.charCodeAt(n);return a.toString(36)}function il(e){qt.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var a=t[n];a.checked&&qt.push(a)}}function Ft(e){return setTimeout(e,0)}function ha(e){return clearTimeout(e)}Zt&&W(document,"touchmove",function(e){(z.active||Je)&&e.cancelable&&e.preventDefault()});z.utils={on:W,off:X,css:F,find:bn,is:function(t,n){return!!ke(t,n,t,!1)},extend:jo,throttle:yn,closest:ke,toggleClass:we,clone:wn,index:Ee,nextTick:Ft,cancelNextTick:ha,detectDirection:Cn,getChild:rt,expando:be};z.get=function(e){return e[be]};z.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(z.utils=Oe(Oe({},z.utils),a.utils)),Dt.mount(a)})};z.create=function(e,t){return new z(e,t)};z.version=Ho;var le=[],mt,ba,ya=!1,ua,ca,Kt,gt;function rl(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var a=n.originalEvent;this.sortable.nativeDraggable?W(document,"dragover",this._handleAutoScroll):this.options.supportPointer?W(document,"pointermove",this._handleFallbackAutoScroll):a.touches?W(document,"touchmove",this._handleFallbackAutoScroll):W(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var a=n.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?X(document,"dragover",this._handleAutoScroll):(X(document,"pointermove",this._handleFallbackAutoScroll),X(document,"touchmove",this._handleFallbackAutoScroll),X(document,"mousemove",this._handleFallbackAutoScroll)),La(),zt(),Lo()},nulling:function(){Kt=ba=mt=ya=gt=ua=ca=null,le.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,a){var i=this,s=(n.touches?n.touches[0]:n).clientX,u=(n.touches?n.touches[0]:n).clientY,g=document.elementFromPoint(s,u);if(Kt=n,a||this.options.forceAutoScrollFallback||Ct||Ve||vt){fa(n,this.options,g,a);var v=He(g,!0);ya&&(!gt||s!==ua||u!==ca)&&(gt&&La(),gt=setInterval(function(){var m=He(document.elementFromPoint(s,u),!0);m!==v&&(v=m,zt()),fa(n,i.options,m,a)},10),ua=s,ca=u)}else{if(!this.options.bubbleScroll||He(g,!0)===Ae()){zt();return}fa(n,this.options,He(g,!1),!1)}}},Re(e,{pluginName:"scroll",initializeByDefault:!0})}function zt(){le.forEach(function(e){clearInterval(e.pid)}),le=[]}function La(){clearInterval(gt)}var fa=yn(function(e,t,n,a){if(t.scroll){var i=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,u=t.scrollSensitivity,g=t.scrollSpeed,v=Ae(),m=!1,b;ba!==n&&(ba=n,zt(),mt=t.scroll,b=t.scrollFn,mt===!0&&(mt=He(n,!0)));var p=0,S=mt;do{var C=S,d=se(C),h=d.top,P=d.bottom,U=d.left,j=d.right,K=d.width,T=d.height,Y=void 0,oe=void 0,re=C.scrollWidth,me=C.scrollHeight,V=F(C),A=C.scrollLeft,D=C.scrollTop;C===v?(Y=K<re&&(V.overflowX==="auto"||V.overflowX==="scroll"||V.overflowX==="visible"),oe=T<me&&(V.overflowY==="auto"||V.overflowY==="scroll"||V.overflowY==="visible")):(Y=K<re&&(V.overflowX==="auto"||V.overflowX==="scroll"),oe=T<me&&(V.overflowY==="auto"||V.overflowY==="scroll"));var N=Y&&(Math.abs(j-i)<=u&&A+K<re)-(Math.abs(U-i)<=u&&!!A),k=oe&&(Math.abs(P-s)<=u&&D+T<me)-(Math.abs(h-s)<=u&&!!D);if(!le[p])for(var y=0;y<=p;y++)le[y]||(le[y]={});(le[p].vx!=N||le[p].vy!=k||le[p].el!==C)&&(le[p].el=C,le[p].vx=N,le[p].vy=k,clearInterval(le[p].pid),(N!=0||k!=0)&&(m=!0,le[p].pid=setInterval((function(){a&&this.layer===0&&z.active._onTouchMove(Kt);var M=le[this.layer].vy?le[this.layer].vy*g:0,L=le[this.layer].vx?le[this.layer].vx*g:0;typeof b=="function"&&b.call(z.dragged.parentNode[be],L,M,e,Kt,le[this.layer].el)!=="continue"||xn(le[this.layer].el,L,M)}).bind({layer:p}),24))),p++}while(t.bubbleScroll&&S!==v&&(S=He(S,!1)));ya=m}},30),$n=function(t){var n=t.originalEvent,a=t.putSortable,i=t.dragEl,s=t.activeSortable,u=t.dispatchSortableEvent,g=t.hideGhostForTarget,v=t.unhideGhostForTarget;if(n){var m=a||s;g();var b=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,p=document.elementFromPoint(b.clientX,b.clientY);v(),m&&!m.el.contains(p)&&(u("spill"),this.onSpill({dragEl:i,putSortable:a}))}};function ka(){}ka.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,a=t.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var i=rt(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),a&&a.animateAll()},drop:$n};Re(ka,{pluginName:"revertOnSpill"});function Sa(){}Sa.prototype={onSpill:function(t){var n=t.dragEl,a=t.putSortable,i=a||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:$n};Re(Sa,{pluginName:"removeOnSpill"});z.mount(new rl);z.mount(Sa,ka);const dl=["data-estado"],ul={class:"p-3 border-b bg-background/50 rounded-t-lg"},cl={class:"flex items-center gap-2"},fl={class:"font-medium text-sm"},ml=["data-estado"],gl={key:0,class:"h-20 border-2 border-dashed border-muted-foreground/20 rounded-lg flex items-center justify-center text-sm text-muted-foreground"},pl=Me({__name:"HitosKanbanColumn",props:{estado:{},entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},isDragOver:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=Q(()=>pt[n.estado]),s=Q(()=>{switch(n.estado){case"completado":return it;case"en_progreso":return Pe;case"cancelado":return Qt;default:return st}}),u=Q(()=>{const g="flex flex-col rounded-lg border bg-muted/30 min-h-[300px] transition-colors duration-150",v=n.isDragOver?"border-primary border-dashed bg-primary/5":"border-border";return`${g} ${v}`});return(g,v)=>(c(),E("div",{class:J(u.value),"data-estado":e.estado},[f("div",ul,[f("div",cl,[(c(),O(lt(s.value),{class:J(["h-4 w-4 flex-shrink-0",i.value.color])},null,8,["class"])),f("span",fl,w(i.value.label),1),l(o(ne),{variant:"secondary",class:"ml-auto text-xs"},{default:r(()=>[_(w(e.entregables.length),1)]),_:1})])]),l(o(wt),{class:"flex-1 p-2"},{default:r(()=>[f("div",{class:"kanban-column-cards space-y-2 min-h-[200px]","data-estado":e.estado},[(c(!0),E(Z,null,fe(e.entregables,m=>(c(),O(Ea,{key:m.id,entregable:m,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,draggable:e.canDrag,variant:"kanban",onView:b=>a("view",m),onEdit:b=>a("edit",m),onDelete:b=>a("delete",m),onComplete:b=>a("complete",m),onChangeStatus:b=>a("change-status",m,b),onShowComentarios:b=>a("show-comentarios",m),onShowActividad:b=>a("show-actividad",m)},null,8,["entregable","can-edit","can-delete","can-complete","draggable","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128)),e.entregables.length===0?(c(),E("div",gl," Sin entregables ")):x("",!0)],8,ml)]),_:1})],10,dl))}}),vl={class:"kanban-container flex gap-4 overflow-x-auto snap-x snap-mandatory pb-4 px-1 min-w-0"},hl=Me({__name:"HitosEntregablesKanban",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},confirmOnDrag:{type:Boolean,default:!0}},emits:["view","edit","delete","complete","change-status","drag-change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=dt(n,"entregables"),{entregablesAgrupados:s}=Et(i),u=G(null),g=G([]),v={pendiente:"pendientes",en_progreso:"en_progreso",completado:"completados",cancelado:"cancelados"},m=S=>s.value[v[S]],b=()=>{p(),n.canDrag&&Ia(()=>{document.querySelectorAll(".kanban-column-cards").forEach(C=>{const d=z.create(C,{group:"entregables-kanban",animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",delay:100,delayOnTouchOnly:!0,touchStartThreshold:3,onStart:()=>{},onEnd:h=>{const P=parseInt(h.item.dataset.id||"0"),U=h.to.dataset.estado,j=h.from.dataset.estado;if(u.value=null,U===j)return;const K=n.entregables.find(T=>T.id===P);K&&a("drag-change-status",K,U)},onChange:h=>{const P=h.to.dataset.estado;P&&(u.value=P)}});g.value.push(d)})})},p=()=>{g.value.forEach(S=>{S.destroy()}),g.value=[]};return Wa(()=>{b()}),In(()=>{p()}),Ce(()=>n.entregables,()=>{Ia(()=>{b()})},{deep:!0}),(S,C)=>(c(),E("div",vl,[(c(!0),E(Z,null,fe(o(pa),d=>(c(),E("div",{key:d,class:"kanban-column flex-shrink-0 w-72 snap-center"},[l(pl,{estado:d,entregables:m(d),"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canDrag,"is-drag-over":u.value===d,onView:C[0]||(C[0]=h=>a("view",h)),onEdit:C[1]||(C[1]=h=>a("edit",h)),onDelete:C[2]||(C[2]=h=>a("delete",h)),onComplete:C[3]||(C[3]=h=>a("complete",h)),onChangeStatus:C[4]||(C[4]=(h,P)=>a("change-status",h,P)),onShowComentarios:C[5]||(C[5]=h=>a("show-comentarios",h)),onShowActividad:C[6]||(C[6]=h=>a("show-actividad",h))},null,8,["estado","entregables","can-edit","can-delete","can-complete","can-drag","is-drag-over"])]))),128))]))}}),bl={class:"space-y-4 min-w-0"},Ya="entregables-confirm-drag",yl=Me({__name:"HitosEntregablesPanel",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},initialModalEntregableId:{},initialModalTab:{}},emits:["view","edit","delete","complete","update-status","open-modal","modal-tab-change"],setup(e,{emit:t}){const n=e,a=t,i=dt(n,"entregables"),{viewMode:s}=Et(i),g=G((()=>{const V=localStorage.getItem(Ya);return V===null?!0:V==="true"})()),v=V=>{g.value=V,localStorage.setItem(Ya,String(V))},m=G(!1),b=G(null),p=G("pendiente"),S=G(!1),C=G(!1),d=G(null),h=V=>{a("open-modal",V,"comentarios")},P=V=>{a("open-modal",V,"actividad")};Wa(()=>{if(n.initialModalEntregableId){const V=n.entregables.find(A=>A.id===n.initialModalEntregableId);V&&a("open-modal",V,n.initialModalTab||"detalles")}});const U=V=>{a("open-modal",V,"detalles")},j=V=>{a("edit",V)},K=V=>{d.value=V,C.value=!0},T=()=>{d.value&&a("delete",d.value),C.value=!1,d.value=null},Y=V=>{b.value=V,p.value="completado",m.value=!0},oe=(V,A)=>{b.value=V,p.value=A,m.value=!0},re=(V,A)=>{g.value?(b.value=V,p.value=A,m.value=!0):a("update-status",V,A,"",[])},me=(V,A)=>{b.value&&(p.value==="completado"?a("complete",b.value,V,A):a("update-status",b.value,p.value,V,A),m.value=!1,b.value=null)};return(V,A)=>{var D,N;return c(),E("div",bl,[l(so,{modelValue:o(s),"onUpdate:modelValue":A[0]||(A[0]=k=>Tn(s)?s.value=k:null),"confirm-on-drag":g.value,"onUpdate:confirmOnDrag":v},null,8,["modelValue","confirm-on-drag"]),o(s)==="list"?(c(),O(Ao,{key:0,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onView:U,onEdit:j,onDelete:K,onComplete:Y,onChangeStatus:oe,onShowComentarios:h,onShowActividad:P},null,8,["entregables","can-edit","can-delete","can-complete"])):o(s)==="tabs"?(c(),O(Vo,{key:1,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onView:U,onEdit:j,onDelete:K,onComplete:Y,onChangeStatus:oe,onShowComentarios:h,onShowActividad:P},null,8,["entregables","can-edit","can-delete","can-complete"])):o(s)==="kanban"?(c(),O(hl,{key:2,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canComplete,"confirm-on-drag":g.value,onView:U,onEdit:j,onDelete:K,onComplete:Y,onChangeStatus:oe,onDragChangeStatus:re,onShowComentarios:h,onShowActividad:P},null,8,["entregables","can-edit","can-delete","can-complete","can-drag","confirm-on-drag"])):x("",!0),l(Hn,{open:m.value,"onUpdate:open":A[1]||(A[1]=k=>m.value=k),"entregable-nombre":(D=b.value)==null?void 0:D.nombre,"estado-actual":(N=b.value)==null?void 0:N.estado,"nuevo-estado":p.value,loading:S.value,onConfirm:me},null,8,["open","entregable-nombre","estado-actual","nuevo-estado","loading"]),l(o(On),{open:C.value,"onUpdate:open":A[2]||(A[2]=k=>C.value=k)},{default:r(()=>[l(o(Mn),null,{default:r(()=>[l(o(Nn),null,{default:r(()=>[l(o(Rn),null,{default:r(()=>[...A[3]||(A[3]=[_("¿Estás seguro?",-1)])]),_:1}),l(o(Vn),null,{default:r(()=>{var k;return[_(' Esta acción no se puede deshacer. Se eliminará permanentemente el entregable "'+w((k=d.value)==null?void 0:k.nombre)+'". ',1)]}),_:1})]),_:1}),l(o(Fn),null,{default:r(()=>[l(o(zn),null,{default:r(()=>[...A[4]||(A[4]=[_("Cancelar",-1)])]),_:1}),l(o(Bn),{class:"bg-red-600 hover:bg-red-700",onClick:T},{default:r(()=>[...A[5]||(A[5]=[_(" Eliminar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Xa={hito:null,estadisticas:null,actividades:[],usuariosActividades:[],usuariosEntregables:[],camposPersonalizados:[],valoresCamposPersonalizados:{},canEdit:!1,canDelete:!1,canManageEntregables:!1,canComplete:!1};function xl(e){const t=G({...Xa}),n=G(!1),a=G(null),i=async()=>{var u,g;if(!e.value){s();return}n.value=!0,a.value=null;try{const v=`/api/proyectos/hitos/${e.value}/detalles`,m=await qa.get(v);t.value={hito:m.data.hito||null,estadisticas:m.data.estadisticas||null,actividades:m.data.actividades||[],usuariosActividades:m.data.usuariosActividades||[],usuariosEntregables:m.data.usuariosEntregables||[],camposPersonalizados:m.data.camposPersonalizados||[],valoresCamposPersonalizados:m.data.valoresCamposPersonalizados||{},canEdit:m.data.canEdit||!1,canDelete:m.data.canDelete||!1,canManageEntregables:m.data.canManageEntregables||!1,canComplete:m.data.canComplete||!1}}catch(v){console.error("Error al cargar detalles del hito:",v),a.value=((g=(u=v.response)==null?void 0:u.data)==null?void 0:g.message)||"Error al cargar detalles del hito",s()}finally{n.value=!1}},s=()=>{t.value={...Xa}};return{data:t,loading:n,error:a,cargar:i,reset:s}}const wl={class:"flex items-center gap-2 sm:gap-4"},_l={class:"flex-1 min-w-0"},El={class:"truncate"},Cl={class:"relative"},Dl={key:0,class:"absolute inset-0 bg-gradient-to-b from-transparent via-background/50 to-background pointer-events-none"},kl={class:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full justify-center py-1"},Sl={class:"flex flex-wrap gap-3 sm:gap-4 mt-2 sm:mt-3 text-xs sm:text-sm text-muted-foreground"},$l={class:"flex items-center gap-1.5"},Il={key:0,class:"flex items-center gap-1"},Tl={key:1,class:"flex items-center gap-1"},Pl={class:"flex-1 min-h-0 overflow-hidden flex flex-col"},Al={class:"px-3 py-3 sm:px-6 sm:py-4"},Ol={key:0,class:"space-y-4"},Ml={key:0},Nl={class:"text-sm whitespace-pre-wrap"},Rl={class:"grid gap-4 md:grid-cols-2"},Vl={class:"flex items-center gap-1.5 text-sm"},Fl={key:1},zl={class:"grid grid-cols-2 sm:grid-cols-4 gap-2"},Bl={class:"bg-gray-50 rounded-lg p-2 text-center"},Hl={class:"text-lg font-semibold"},Ul={class:"bg-blue-50 rounded-lg p-2 text-center"},jl={class:"text-lg font-semibold text-blue-700"},Ll={class:"bg-green-50 rounded-lg p-2 text-center"},Yl={class:"text-lg font-semibold text-green-700"},Xl={class:"bg-red-50 rounded-lg p-2 text-center"},Gl={class:"text-lg font-semibold text-red-700"},Wl={class:"flex items-center gap-2"},ql={class:"flex flex-wrap gap-2"},Kl={key:0,class:"text-sm"},Ql={key:1,class:"mt-2"},Zl={class:"grid gap-3 md:grid-cols-2 text-sm"},Jl={class:"flex items-center justify-between w-full gap-2"},es={class:"flex gap-1.5 sm:gap-2"},ts=Me({__name:"HitoDetallesModal",props:{open:{type:Boolean},hitoId:{},proyectoId:{},initialTab:{default:"detalles"},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageEntregables:{type:Boolean,default:!1}},emits:["update:open","update:tab","edit-hito","view-entregable","edit-entregable","add-entregable","refresh"],setup(e,{emit:t}){const n=e,a=t,i=dt(n,"hitoId"),{data:s,loading:u,error:g,cargar:v}=xl(i),m=["detalles","entregables","comentarios","actividad"],b=G(m.includes(n.initialTab)?n.initialTab:"detalles"),p=G(!1),S=G({search:null,estado:null,prioridad:null,responsable_id:null,fecha_inicio:null,fecha_fin:null}),C=G({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null});Ce(()=>n.open,async A=>{A&&n.hitoId&&(await v(),b.value=m.includes(n.initialTab)?n.initialTab:"detalles")},{immediate:!0}),Ce(()=>n.initialTab,A=>{n.open&&A&&m.includes(A)&&(b.value=A)}),Ce(b,A=>{a("update:tab",A)});const d=Q(()=>s.value.hito),h=Q(()=>s.value.estadisticas),P=Q(()=>{var D;let A=((D=d.value)==null?void 0:D.entregables)||[];if(S.value.search){const N=S.value.search.toLowerCase();A=A.filter(k=>k.nombre.toLowerCase().includes(N)||k.descripcion&&k.descripcion.toLowerCase().includes(N))}return S.value.estado&&(A=A.filter(N=>N.estado===S.value.estado)),S.value.prioridad&&(A=A.filter(N=>N.prioridad===S.value.prioridad)),S.value.responsable_id&&(A=A.filter(N=>{var k;return((k=N.responsable)==null?void 0:k.id)===S.value.responsable_id})),A}),U=Q(()=>{let A=s.value.actividades||[];return C.value.usuario_id&&(A=A.filter(D=>{var N;return((N=D.causer)==null?void 0:N.id)===C.value.usuario_id})),C.value.tipo_entidad&&(A=A.filter(D=>D.subject_type===C.value.tipo_entidad)),C.value.tipo_accion&&(A=A.filter(D=>D.event===C.value.tipo_accion)),(C.value.fecha_inicio||C.value.fecha_fin)&&(A=A.filter(D=>{const N=new Date(D.created_at);if(C.value.fecha_inicio){const k=new Date(C.value.fecha_inicio);if(N<k)return!1}if(C.value.fecha_fin){const k=new Date(C.value.fecha_fin);if(k.setHours(23,59,59,999),N>k)return!1}return!0})),A}),j=A=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[A]||"bg-gray-100 text-gray-800",K=A=>A?Ye(Yt(A),"dd MMM yyyy",{locale:Xe}):"No definida",T=A=>A?Ye(Yt(A),"dd MMM yyyy 'a las' HH:mm",{locale:Xe}):"No definida",Y=Q(()=>!n.proyectoId||!n.hitoId?null:`/admin/proyectos/${n.proyectoId}/hitos/${n.hitoId}`),oe=()=>{a("update:open",!1)},re=async()=>{await v(),a("refresh")},me=A=>{a("view-entregable",A)},V=A=>{a("edit-entregable",A)};return(A,D)=>(c(),O(o(an),{open:e.open,"onUpdate:open":D[6]||(D[6]=N=>a("update:open",N))},{default:r(()=>[l(o(nn),{class:"w-full sm:w-[95vw] max-w-full sm:!max-w-5xl h-[100dvh] sm:h-auto sm:max-h-[90vh] rounded-none sm:rounded-lg flex flex-col p-0 gap-0 overflow-hidden"},{default:r(()=>[l(o(on),{class:"flex-shrink-0 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 sm:pb-4 border-b"},{default:r(()=>[o(u)&&!d.value?(c(),E(Z,{key:0},[l(o(Be),{class:"h-7 w-3/4 mb-2"}),l(o(Be),{class:"h-4 w-1/2"})],64)):o(g)?(c(),E(Z,{key:1},[l(o(Ut),{class:"text-destructive"},{default:r(()=>[...D[7]||(D[7]=[_("Error al cargar",-1)])]),_:1}),l(o(jt),null,{default:r(()=>[_(w(o(g)),1)]),_:1})],64)):d.value?(c(),E(Z,{key:2},[f("div",wl,[f("div",_l,[l(o(Ut),{class:"text-lg sm:text-xl flex items-center gap-2"},{default:r(()=>[l(o(ga),{class:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),f("span",El,w(d.value.nombre),1)]),_:1})]),l(o(ne),{class:J([j(d.value.estado),"flex-shrink-0 text-xs"])},{default:r(()=>[_(w(d.value.estado_label||d.value.estado),1)]),_:1},8,["class"]),l(o(q),{variant:"ghost",size:"sm",class:"flex-shrink-0 h-8 w-8 p-0",onClick:re,disabled:o(u),title:"Actualizar"},{default:r(()=>[l(o(gn),{class:J(["h-4 w-4",{"animate-spin":o(u)}])},null,8,["class"])]),_:1},8,["disabled"])]),l(o(jt),{class:"mt-1 text-xs sm:text-sm"},{default:r(()=>{var N;return[_(" Proyecto: "+w((N=d.value.proyecto)==null?void 0:N.nombre),1)]}),_:1}),l(o(sn),{open:p.value,"onUpdate:open":D[0]||(D[0]=N=>p.value=N),class:"sm:!block"},{default:r(()=>[l(o(Za),{class:"sm:hidden w-full mt-2"},{default:r(()=>[f("div",Cl,[p.value?x("",!0):(c(),E("div",Dl)),f("button",kl,[f("span",null,w(p.value?"Ocultar detalles":"Ver detalles"),1),l(o(xa),{class:J(["h-3 w-3 transition-transform duration-200",{"rotate-180":p.value}])},null,8,["class"])])])]),_:1}),l(o(rn),{class:"sm:!block"},{default:r(()=>{var N;return[f("div",Sl,[f("div",$l,[l(o(Ht),{"model-value":d.value.porcentaje_completado,class:"w-16 sm:w-20 h-2"},null,8,["model-value"]),f("span",null,w(d.value.porcentaje_completado)+"%",1)]),d.value.fecha_fin?(c(),E("div",Il,[l(o(Pe),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),f("span",{class:J({"text-red-600":(N=h.value)==null?void 0:N.esta_vencido})},w(K(d.value.fecha_fin)),3)])):x("",!0),d.value.responsable?(c(),E("div",Tl,[l(o(tt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),f("span",null,w(d.value.responsable.name),1)])):x("",!0)])]}),_:1})]),_:1},8,["open"])],64)):x("",!0)]),_:1}),f("div",Pl,[l(o(wa),{modelValue:b.value,"onUpdate:modelValue":D[4]||(D[4]=N=>b.value=N),class:"flex-1 min-h-0 flex flex-col"},{default:r(()=>[l(o(_a),{class:"flex-shrink-0 mx-4 sm:mx-6 mt-3 sm:mt-4 justify-start"},{default:r(()=>{var N,k;return[l(o(Ie),{value:"detalles",label:"Detalles",icon:o(at)},{default:r(()=>[l(o(at),{class:"h-4 w-4 mr-1.5"}),D[8]||(D[8]=_(" Detalles ",-1))]),_:1},8,["icon"]),l(o(Ie),{value:"entregables",label:"Entregables",icon:o(nt),badge:(N=h.value)==null?void 0:N.total_entregables},{default:r(()=>{var y;return[l(o(nt),{class:"h-4 w-4 mr-1.5"}),D[9]||(D[9]=_(" Entregables ",-1)),(y=h.value)!=null&&y.total_entregables?(c(),O(o(ne),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(w(h.value.total_entregables),1)]),_:1})):x("",!0)]}),_:1},8,["icon","badge"]),l(o(Ie),{value:"comentarios",label:"Comentarios",icon:o(We),badge:(k=d.value)==null?void 0:k.total_comentarios},{default:r(()=>{var y;return[l(o(We),{class:"h-4 w-4 mr-1.5"}),D[10]||(D[10]=_(" Comentarios ",-1)),(y=d.value)!=null&&y.total_comentarios?(c(),O(o(ne),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(w(d.value.total_comentarios),1)]),_:1})):x("",!0)]}),_:1},8,["icon","badge"]),l(o(Ie),{value:"actividad",label:"Actividad",icon:o(qe)},{default:r(()=>[l(o(qe),{class:"h-4 w-4 mr-1.5"}),D[11]||(D[11]=_(" Actividad ",-1))]),_:1},8,["icon"])]}),_:1}),l(o(wt),{class:"flex-1 min-h-0 overflow-y-auto"},{default:r(()=>[f("div",Al,[o(u)&&!d.value?(c(),E("div",Ol,[l(o(Be),{class:"h-32 w-full"}),l(o(Be),{class:"h-32 w-full"})])):x("",!0),l(o(Te),{value:"detalles",class:"mt-0 space-y-4"},{default:r(()=>[d.value?(c(),E(Z,{key:0},[l(o(ve),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...D[12]||(D[12]=[_("Información General",-1)])]),_:1})]),_:1}),l(o(he),{class:"space-y-4"},{default:r(()=>{var N;return[d.value.descripcion?(c(),E("div",Ml,[D[13]||(D[13]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Descripción",-1)),f("p",Nl,w(d.value.descripcion),1)])):x("",!0),f("div",Rl,[f("div",null,[D[14]||(D[14]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Inicio",-1)),f("div",Vl,[l(o(Ge),{class:"h-4 w-4"}),_(" "+w(K(d.value.fecha_inicio)),1)])]),f("div",null,[D[15]||(D[15]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Fin",-1)),f("div",{class:J(["flex items-center gap-1.5 text-sm",{"text-red-600":(N=h.value)==null?void 0:N.esta_vencido}])},[l(o(Ge),{class:"h-4 w-4"}),_(" "+w(K(d.value.fecha_fin)),1)],2)])]),h.value?(c(),E("div",Fl,[D[20]||(D[20]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-2"},"Resumen de Entregables",-1)),f("div",zl,[f("div",Bl,[f("div",Hl,w(h.value.entregables_pendientes),1),D[16]||(D[16]=f("div",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),f("div",Ul,[f("div",jl,w(h.value.entregables_en_progreso),1),D[17]||(D[17]=f("div",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),f("div",Ll,[f("div",Yl,w(h.value.entregables_completados),1),D[18]||(D[18]=f("div",{class:"text-xs text-muted-foreground"},"Completados",-1))]),f("div",Xl,[f("div",Gl,w(h.value.entregables_cancelados),1),D[19]||(D[19]=f("div",{class:"text-xs text-muted-foreground"},"Cancelados",-1))])])])):x("",!0)]}),_:1})]),_:1}),d.value.etiquetas&&d.value.etiquetas.length>0?(c(),O(o(ve),{key:0},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[f("div",Wl,[l(o(mn),{class:"h-4 w-4"}),l(o($e),{class:"text-base"},{default:r(()=>[...D[21]||(D[21]=[_("Etiquetas",-1)])]),_:1})])]),_:1}),l(o(he),null,{default:r(()=>[f("div",ql,[(c(!0),E(Z,null,fe(d.value.etiquetas,N=>(c(),O(o(ne),{key:N.id,variant:"outline",class:"px-2.5 py-1",style:Ka({borderColor:N.color||"#94a3b8",color:N.color||"#64748b",backgroundColor:`${N.color}15`||"#f1f5f9"})},{default:r(()=>[_(w(N.nombre),1)]),_:2},1032,["style"]))),128))])]),_:1})]),_:1})):x("",!0),o(s).camposPersonalizados&&o(s).camposPersonalizados.length>0?(c(),O(cn,{key:1,campos:o(s).camposPersonalizados,"valores-campos":o(s).valoresCamposPersonalizados,descripcion:"Información adicional del hito",columns:2},null,8,["campos","valores-campos"])):x("",!0),d.value.parent||d.value.ruta_completa?(c(),O(o(ve),{key:2},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...D[22]||(D[22]=[_("Jerarquía",-1)])]),_:1})]),_:1}),l(o(he),null,{default:r(()=>[d.value.ruta_completa?(c(),E("div",Kl,[D[23]||(D[23]=f("span",{class:"text-muted-foreground"},"Ruta: ",-1)),_(" "+w(d.value.ruta_completa),1)])):x("",!0),d.value.nivel!==void 0?(c(),E("div",Ql,[l(o(ne),{variant:"outline"},{default:r(()=>[_("Nivel "+w(d.value.nivel),1)]),_:1})])):x("",!0)]),_:1})]),_:1})):x("",!0),l(o(ve),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...D[24]||(D[24]=[_("Información del Sistema",-1)])]),_:1})]),_:1}),l(o(he),null,{default:r(()=>[f("div",Zl,[f("div",null,[D[25]||(D[25]=f("span",{class:"text-muted-foreground"},"Creado: ",-1)),_(" "+w(T(d.value.created_at)),1)]),f("div",null,[D[26]||(D[26]=f("span",{class:"text-muted-foreground"},"Actualizado: ",-1)),_(" "+w(T(d.value.updated_at)),1)])])]),_:1})]),_:1})],64)):x("",!0)]),_:1}),l(o(Te),{value:"entregables",class:"mt-0 space-y-4"},{default:r(()=>[d.value?(c(),E(Z,{key:0},[d.value.entregables&&d.value.entregables.length>0?(c(),O(Un,{key:0,modelValue:S.value,"onUpdate:modelValue":D[1]||(D[1]=N=>S.value=N),usuarios:o(s).usuariosEntregables},null,8,["modelValue","usuarios"])):x("",!0),d.value.entregables&&d.value.entregables.length>0?(c(),O(o(ve),{key:1},{default:r(()=>[l(o(he),{class:"p-0"},{default:r(()=>[l(jn,{entregables:P.value,"proyecto-id":e.proyectoId,"hito-id":e.hitoId,"can-edit":e.canManageEntregables||o(s).canManageEntregables,"can-delete":e.canManageEntregables||o(s).canManageEntregables,"can-complete":o(s).canComplete,"show-checkbox":!1,onView:me,onEdit:V},null,8,["entregables","proyecto-id","hito-id","can-edit","can-delete","can-complete"])]),_:1})]),_:1})):(c(),O(o(ve),{key:2},{default:r(()=>[l(o(he),{class:"text-center py-8"},{default:r(()=>[l(o(nt),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),D[28]||(D[28]=f("p",{class:"text-muted-foreground mb-4"},"No hay entregables en este hito",-1)),e.canManageEntregables||o(s).canManageEntregables?(c(),O(o(q),{key:0,variant:"outline",onClick:D[2]||(D[2]=N=>a("add-entregable"))},{default:r(()=>[...D[27]||(D[27]=[_(" Crear Entregable ",-1)])]),_:1})):x("",!0)]),_:1})]),_:1}))],64)):x("",!0)]),_:1}),l(o(Te),{value:"comentarios",class:"mt-0"},{default:r(()=>[e.hitoId?(c(),O(fn,{key:0,"commentable-type":"hitos","commentable-id":e.hitoId,"can-create":e.canEdit||o(s).canEdit,embedded:""},null,8,["commentable-id","can-create"])):x("",!0)]),_:1}),l(o(Te),{value:"actividad",class:"mt-0 space-y-4"},{default:r(()=>[o(s).actividades&&o(s).actividades.length>0?(c(),O(dn,{key:0,modelValue:C.value,"onUpdate:modelValue":D[3]||(D[3]=N=>C.value=N),usuarios:o(s).usuariosActividades,"context-level":"hito"},null,8,["modelValue","usuarios"])):x("",!0),l(un,{activities:U.value,title:"Historial de Actividad",description:"Registro de cambios del hito y sus entregables","empty-message":"No hay actividad registrada","show-card":!1},null,8,["activities"])]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),l(o(ln),{class:"flex-shrink-0 px-3 py-3 sm:px-6 sm:py-4 border-t bg-muted/30"},{default:r(()=>[f("div",Jl,[f("div",es,[Y.value?(c(),O(o(Bt),{key:0,href:Y.value},{default:r(()=>[l(o(q),{variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3"},{default:r(()=>[l(o(Lt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),D[29]||(D[29]=f("span",{class:"hidden sm:inline"},"Abrir página completa",-1))]),_:1})]),_:1},8,["href"])):x("",!0),(e.canEdit||o(s).canEdit)&&d.value?(c(),O(o(q),{key:1,variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3",onClick:D[5]||(D[5]=N=>a("edit-hito"))},{default:r(()=>[l(o(_t),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),D[30]||(D[30]=f("span",{class:"hidden sm:inline"},"Editar",-1))]),_:1})):x("",!0)]),l(o(q),{variant:"ghost",size:"sm",class:"text-xs sm:text-sm",onClick:oe},{default:r(()=>[...D[31]||(D[31]=[_(" Cerrar ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["open"]))}}),Ga={entregable:null,proyecto:null,hito:null,usuariosAsignados:[],actividades:[],usuariosActividades:[],camposPersonalizados:[],valoresCamposPersonalizados:{},contratosRelacionados:[],canEdit:!1,canDelete:!1,canComplete:!1};function as(e){const t=G({...Ga}),n=G(!1),a=G(null),i=async()=>{var u,g;if(!e.value){s();return}n.value=!0,a.value=null;try{const v=`/api/proyectos/entregables/${e.value}/detalles`,m=await qa.get(v);t.value={entregable:m.data.entregable||null,proyecto:m.data.proyecto||null,hito:m.data.hito||null,usuariosAsignados:m.data.usuariosAsignados||[],actividades:m.data.actividades||[],usuariosActividades:m.data.usuariosActividades||[],camposPersonalizados:m.data.camposPersonalizados||[],valoresCamposPersonalizados:m.data.valoresCamposPersonalizados||{},contratosRelacionados:m.data.contratosRelacionados||[],canEdit:m.data.canEdit||!1,canDelete:m.data.canDelete||!1,canComplete:m.data.canComplete||!1}}catch(v){console.error("Error al cargar detalles del entregable:",v),a.value=((g=(u=v.response)==null?void 0:u.data)==null?void 0:g.message)||"Error al cargar detalles del entregable",s()}finally{n.value=!1}},s=()=>{t.value={...Ga}};return{data:t,loading:n,error:a,cargar:i,reset:s}}const ns={class:"flex items-center gap-2 sm:gap-4"},os={class:"flex-1 min-w-0"},ls={class:"truncate"},ss={class:"relative"},is={key:0,class:"absolute inset-0 bg-gradient-to-b from-transparent via-background/50 to-background pointer-events-none"},rs={class:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full justify-center py-1"},ds={class:"flex flex-wrap gap-3 sm:gap-4 mt-2 sm:mt-3 text-xs sm:text-sm text-muted-foreground"},us={class:"flex items-center gap-1.5"},cs={class:"capitalize"},fs={class:"flex items-center gap-1.5"},ms={key:1,class:"flex items-center gap-1"},gs={class:"flex-1 min-h-0 overflow-hidden flex flex-col"},ps={class:"px-3 py-3 sm:px-6 sm:py-4"},vs={key:0,class:"space-y-4"},hs={key:0},bs={class:"text-sm whitespace-pre-wrap"},ys={class:"grid gap-4 md:grid-cols-2"},xs={class:"flex items-center gap-1.5 text-sm"},ws={key:1},_s={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-3"},Es={class:"flex items-center gap-2 text-green-700 mb-2"},Cs={class:"text-sm text-green-600 space-y-1"},Ds={key:0},ks={key:1},Ss={key:2,class:"italic mt-2"},$s={class:"flex items-center gap-2"},Is={class:"flex flex-wrap gap-2"},Ts={class:"grid gap-3 md:grid-cols-2 text-sm"},Ps={key:0,class:"flex items-center gap-3"},As={class:"font-medium"},Os={class:"text-sm text-muted-foreground"},Ms={key:1,class:"text-muted-foreground"},Ns={key:0,class:"space-y-2"},Rs={class:"flex items-center gap-3"},Vs={class:"font-medium text-sm"},Fs={class:"text-xs text-muted-foreground"},zs={key:1,class:"text-muted-foreground"},Bs={class:"flex items-center justify-between w-full gap-2"},Hs={class:"flex gap-1.5 sm:gap-2"},Us=Me({__name:"EntregableDetallesModal",props:{open:{type:Boolean},entregableId:{},proyectoId:{},hitoId:{},initialTab:{default:"detalles"},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1}},emits:["update:open","update:tab","edit-entregable","refresh"],setup(e,{emit:t}){const n=e,a=t,i=dt(n,"entregableId"),{data:s,loading:u,error:g,cargar:v}=as(i),m=["detalles","equipo","evidencias","comentarios","actividad"],b=G(m.includes(n.initialTab)?n.initialTab:"detalles"),p=G(!1),S=G({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null}),C=G({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null});Ce(()=>n.open,async k=>{k&&n.entregableId&&(await v(),b.value=m.includes(n.initialTab)?n.initialTab:"detalles")},{immediate:!0}),Ce(()=>n.initialTab,k=>{n.open&&k&&m.includes(k)&&(b.value=k)}),Ce(b,k=>{a("update:tab",k)});const d=Q(()=>s.value.entregable),h=Q(()=>s.value.proyecto),P=Q(()=>s.value.hito),U=Q(()=>{var k;return(k=d.value)!=null&&k.fecha_fin?Jn(new Date(d.value.fecha_fin),new Date):null}),j=Q(()=>!d.value||d.value.estado==="completado"||d.value.estado==="cancelado"?!1:U.value!==null&&U.value<0),K=Q(()=>{var y;let k=((y=d.value)==null?void 0:y.evidencias)||[];return S.value.contrato_id&&(k=k.filter(M=>{var L;return((L=M.obligacion)==null?void 0:L.contrato_id)===S.value.contrato_id})),S.value.tipo&&(k=k.filter(M=>M.tipo_evidencia===S.value.tipo)),S.value.estado&&(k=k.filter(M=>M.estado===S.value.estado)),S.value.usuario_id&&(k=k.filter(M=>{var L;return((L=M.usuario)==null?void 0:L.id)===S.value.usuario_id})),k}),T=Q(()=>{const k={};return K.value.forEach(y=>{var M;if((M=y.obligacion)!=null&&M.contrato){const L=y.obligacion.contrato.id;k[L]||(k[L]={contrato:y.obligacion.contrato,evidencias:[]}),k[L].evidencias.push({...y,obligacion_titulo:y.obligacion.titulo})}}),Object.values(k)}),Y=Q(()=>{let k=s.value.actividades||[];return C.value.usuario_id&&(k=k.filter(y=>{var M;return((M=y.causer)==null?void 0:M.id)===C.value.usuario_id})),C.value.tipo_accion&&(k=k.filter(y=>y.event===C.value.tipo_accion)),(C.value.fecha_inicio||C.value.fecha_fin)&&(k=k.filter(y=>{const M=new Date(y.created_at);if(C.value.fecha_inicio){const L=new Date(C.value.fecha_inicio);if(M<L)return!1}if(C.value.fecha_fin){const L=new Date(C.value.fecha_fin);if(L.setHours(23,59,59,999),M>L)return!1}return!0})),k}),oe=k=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[k]||"bg-gray-100 text-gray-800",re=k=>({baja:"text-gray-500",media:"text-yellow-500",alta:"text-red-500"})[k]||"",me=k=>k?Ye(Yt(k),"dd MMM yyyy",{locale:Xe}):"No definida",V=k=>k?Ye(Yt(k),"dd MMM yyyy 'a las' HH:mm",{locale:Xe}):"No definida",A=Q(()=>{var M,L;const k=n.proyectoId||((M=h.value)==null?void 0:M.id),y=n.hitoId||((L=P.value)==null?void 0:L.id);return!k||!y||!n.entregableId?null:`/admin/proyectos/${k}/hitos/${y}/entregables/${n.entregableId}`}),D=()=>{a("update:open",!1)},N=async()=>{await v(),a("refresh")};return(k,y)=>(c(),O(o(an),{open:e.open,"onUpdate:open":y[5]||(y[5]=M=>a("update:open",M))},{default:r(()=>[l(o(nn),{class:"w-full sm:w-[95vw] max-w-full sm:!max-w-5xl h-[100dvh] sm:h-auto sm:max-h-[90vh] rounded-none sm:rounded-lg flex flex-col p-0 gap-0 overflow-hidden"},{default:r(()=>[l(o(on),{class:"flex-shrink-0 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 sm:pb-4 border-b"},{default:r(()=>[o(u)&&!d.value?(c(),E(Z,{key:0},[l(o(Be),{class:"h-7 w-3/4 mb-2"}),l(o(Be),{class:"h-4 w-1/2"})],64)):o(g)?(c(),E(Z,{key:1},[l(o(Ut),{class:"text-destructive"},{default:r(()=>[...y[6]||(y[6]=[_("Error al cargar",-1)])]),_:1}),l(o(jt),null,{default:r(()=>[_(w(o(g)),1)]),_:1})],64)):d.value?(c(),E(Z,{key:2},[f("div",ns,[f("div",os,[l(o(Ut),{class:"text-lg sm:text-xl flex items-center gap-2"},{default:r(()=>[l(o(at),{class:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),f("span",ls,w(d.value.nombre),1)]),_:1})]),l(o(ne),{class:J([oe(d.value.estado),"flex-shrink-0 text-xs"])},{default:r(()=>[_(w(d.value.estado_label||d.value.estado),1)]),_:1},8,["class"]),l(o(q),{variant:"ghost",size:"sm",class:"flex-shrink-0 h-8 w-8 p-0",onClick:N,disabled:o(u),title:"Actualizar"},{default:r(()=>[l(o(gn),{class:J(["h-4 w-4",{"animate-spin":o(u)}])},null,8,["class"])]),_:1},8,["disabled"])]),l(o(jt),{class:"mt-1 text-xs sm:text-sm"},{default:r(()=>{var M,L;return[_(" Hito: "+w((M=P.value)==null?void 0:M.nombre)+" · Proyecto: "+w((L=h.value)==null?void 0:L.nombre),1)]}),_:1}),l(o(sn),{open:p.value,"onUpdate:open":y[0]||(y[0]=M=>p.value=M),class:"sm:!block"},{default:r(()=>[l(o(Za),{class:"sm:hidden w-full mt-2"},{default:r(()=>[f("div",ss,[p.value?x("",!0):(c(),E("div",is)),f("button",rs,[f("span",null,w(p.value?"Ocultar detalles":"Ver detalles"),1),l(o(xa),{class:J(["h-3 w-3 transition-transform duration-200",{"rotate-180":p.value}])},null,8,["class"])])])]),_:1}),l(o(rn),{class:"sm:!block"},{default:r(()=>[f("div",ds,[f("div",us,[l(o(en),{class:J(["h-3.5 w-3.5 sm:h-4 sm:w-4",re(d.value.prioridad)])},null,8,["class"]),f("span",cs,w(d.value.prioridad),1)]),f("div",fs,[l(o(Ht),{"model-value":d.value.porcentaje_completado||0,class:"w-14 sm:w-16 h-2"},null,8,["model-value"]),f("span",null,w(d.value.porcentaje_completado||0)+"%",1)]),U.value!==null?(c(),E("div",{key:0,class:J(["flex items-center gap-1",{"text-red-600":j.value}])},[l(o(Pe),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),f("span",null,w(j.value?`Vencido hace ${Math.abs(U.value)} días`:U.value===0?"Vence hoy":`${U.value} días`),1)],2)):x("",!0),d.value.responsable?(c(),E("div",ms,[l(o(tt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),f("span",null,w(d.value.responsable.name),1)])):x("",!0)])]),_:1})]),_:1},8,["open"])],64)):x("",!0)]),_:1}),f("div",gs,[l(o(wa),{modelValue:b.value,"onUpdate:modelValue":y[3]||(y[3]=M=>b.value=M),class:"flex-1 min-h-0 flex flex-col"},{default:r(()=>[l(o(_a),{class:"flex-shrink-0 mx-4 sm:mx-6 mt-3 sm:mt-4 justify-start"},{default:r(()=>{var M,L,ye;return[l(o(Ie),{value:"detalles",label:"Detalles",icon:o(at)},{default:r(()=>[l(o(at),{class:"h-4 w-4 mr-1.5"}),y[7]||(y[7]=_(" Detalles ",-1))]),_:1},8,["icon"]),l(o(Ie),{value:"equipo",label:"Equipo",icon:o(ma)},{default:r(()=>[l(o(ma),{class:"h-4 w-4 mr-1.5"}),y[8]||(y[8]=_(" Equipo ",-1))]),_:1},8,["icon"]),l(o(Ie),{value:"evidencias",label:"Evidencias",icon:o(na),badge:(L=(M=d.value)==null?void 0:M.evidencias)==null?void 0:L.length},{default:r(()=>{var ue,Ke;return[l(o(na),{class:"h-4 w-4 mr-1.5"}),y[9]||(y[9]=_(" Evidencias ",-1)),(Ke=(ue=d.value)==null?void 0:ue.evidencias)!=null&&Ke.length?(c(),O(o(ne),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(w(d.value.evidencias.length),1)]),_:1})):x("",!0)]}),_:1},8,["icon","badge"]),l(o(Ie),{value:"comentarios",label:"Comentarios",icon:o(We),badge:(ye=d.value)==null?void 0:ye.total_comentarios},{default:r(()=>{var ue;return[l(o(We),{class:"h-4 w-4 mr-1.5"}),y[10]||(y[10]=_(" Comentarios ",-1)),(ue=d.value)!=null&&ue.total_comentarios?(c(),O(o(ne),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[_(w(d.value.total_comentarios),1)]),_:1})):x("",!0)]}),_:1},8,["icon","badge"]),l(o(Ie),{value:"actividad",label:"Actividad",icon:o(qe)},{default:r(()=>[l(o(qe),{class:"h-4 w-4 mr-1.5"}),y[11]||(y[11]=_(" Actividad ",-1))]),_:1},8,["icon"])]}),_:1}),l(o(wt),{class:"flex-1 min-h-0 overflow-y-auto"},{default:r(()=>[f("div",ps,[o(u)&&!d.value?(c(),E("div",vs,[l(o(Be),{class:"h-32 w-full"}),l(o(Be),{class:"h-32 w-full"})])):x("",!0),l(o(Te),{value:"detalles",class:"mt-0 space-y-4"},{default:r(()=>[d.value?(c(),E(Z,{key:0},[l(o(ve),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...y[12]||(y[12]=[_("Información General",-1)])]),_:1})]),_:1}),l(o(he),{class:"space-y-4"},{default:r(()=>[d.value.descripcion?(c(),E("div",hs,[y[13]||(y[13]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Descripción",-1)),f("p",bs,w(d.value.descripcion),1)])):x("",!0),f("div",ys,[f("div",null,[y[14]||(y[14]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Inicio",-1)),f("div",xs,[l(o(Ge),{class:"h-4 w-4"}),_(" "+w(me(d.value.fecha_inicio)),1)])]),f("div",null,[y[15]||(y[15]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Fin",-1)),f("div",{class:J(["flex items-center gap-1.5 text-sm",{"text-red-600":j.value}])},[l(o(Ge),{class:"h-4 w-4"}),_(" "+w(me(d.value.fecha_fin)),1)],2)])]),d.value.notas?(c(),E("div",ws,[y[16]||(y[16]=f("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Notas",-1)),l(o(Qn),null,{default:r(()=>[l(o(st),{class:"h-4 w-4"}),l(o(Zn),null,{default:r(()=>[_(w(d.value.notas),1)]),_:1})]),_:1})])):x("",!0),d.value.estado==="completado"?(c(),E("div",_s,[f("div",Es,[l(o(it),{class:"h-5 w-5"}),y[17]||(y[17]=f("span",{class:"font-medium"},"Completado",-1))]),f("div",Cs,[d.value.completado_at?(c(),E("div",Ds," Fecha: "+w(V(d.value.completado_at)),1)):x("",!0),d.value.completado_por_usuario?(c(),E("div",ks," Por: "+w(d.value.completado_por_usuario.name),1)):x("",!0),d.value.observaciones_estado?(c(),E("div",Ss,' "'+w(d.value.observaciones_estado)+'" ',1)):x("",!0)])])):x("",!0)]),_:1})]),_:1}),d.value.etiquetas&&d.value.etiquetas.length>0?(c(),O(o(ve),{key:0},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[f("div",$s,[l(o(mn),{class:"h-4 w-4"}),l(o($e),{class:"text-base"},{default:r(()=>[...y[18]||(y[18]=[_("Etiquetas",-1)])]),_:1})])]),_:1}),l(o(he),null,{default:r(()=>[f("div",Is,[(c(!0),E(Z,null,fe(d.value.etiquetas,M=>(c(),O(o(ne),{key:M.id,variant:"outline",class:"px-2.5 py-1",style:Ka({borderColor:M.color||"#94a3b8",color:M.color||"#64748b",backgroundColor:`${M.color}15`||"#f1f5f9"})},{default:r(()=>[_(w(M.nombre),1)]),_:2},1032,["style"]))),128))])]),_:1})]),_:1})):x("",!0),o(s).camposPersonalizados&&o(s).camposPersonalizados.length>0?(c(),O(cn,{key:1,campos:o(s).camposPersonalizados,"valores-campos":o(s).valoresCamposPersonalizados,descripcion:"Información adicional del entregable",columns:2},null,8,["campos","valores-campos"])):x("",!0),l(o(ve),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...y[19]||(y[19]=[_("Información del Sistema",-1)])]),_:1})]),_:1}),l(o(he),null,{default:r(()=>[f("div",Ts,[f("div",null,[y[20]||(y[20]=f("span",{class:"text-muted-foreground"},"Creado: ",-1)),_(" "+w(V(d.value.created_at)),1)]),f("div",null,[y[21]||(y[21]=f("span",{class:"text-muted-foreground"},"Actualizado: ",-1)),_(" "+w(V(d.value.updated_at)),1)]),f("div",null,[y[22]||(y[22]=f("span",{class:"text-muted-foreground"},"Orden: ",-1)),_(" "+w(d.value.orden),1)])])]),_:1})]),_:1})],64)):x("",!0)]),_:1}),l(o(Te),{value:"equipo",class:"mt-0 space-y-4"},{default:r(()=>[d.value?(c(),E(Z,{key:0},[l(o(ve),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...y[23]||(y[23]=[_("Responsable Principal",-1)])]),_:1})]),_:1}),l(o(he),null,{default:r(()=>[d.value.responsable?(c(),E("div",Ps,[l(o(Aa),{class:"h-10 w-10"},{default:r(()=>[d.value.responsable.avatar?(c(),O(o(Oa),{key:0,src:d.value.responsable.avatar},null,8,["src"])):x("",!0),l(o(Ma),null,{default:r(()=>[_(w(d.value.responsable.name.substring(0,2).toUpperCase()),1)]),_:1})]),_:1}),f("div",null,[f("p",As,w(d.value.responsable.name),1),f("p",Os,w(d.value.responsable.email),1)])])):(c(),E("p",Ms,"No hay responsable asignado"))]),_:1})]),_:1}),l(o(ve),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...y[24]||(y[24]=[_("Colaboradores",-1)])]),_:1}),l(o(Kn),null,{default:r(()=>{var M;return[_(w(((M=o(s).usuariosAsignados)==null?void 0:M.length)||0)+" usuarios asignados",1)]}),_:1})]),_:1}),l(o(he),null,{default:r(()=>[o(s).usuariosAsignados&&o(s).usuariosAsignados.length>0?(c(),E("div",Ns,[(c(!0),E(Z,null,fe(o(s).usuariosAsignados,M=>(c(),E("div",{key:M.user_id,class:"flex items-center justify-between p-3 bg-muted rounded-lg"},[f("div",Rs,[l(o(Aa),{class:"h-8 w-8"},{default:r(()=>[M.user.avatar?(c(),O(o(Oa),{key:0,src:M.user.avatar},null,8,["src"])):x("",!0),l(o(Ma),null,{default:r(()=>[_(w(M.user.name.substring(0,2).toUpperCase()),1)]),_:2},1024)]),_:2},1024),f("div",null,[f("p",Vs,w(M.user.name),1),f("p",Fs,w(M.user.email),1)])]),l(o(ne),{variant:"outline",class:"capitalize"},{default:r(()=>[_(w(M.rol),1)]),_:2},1024)]))),128))])):(c(),E("p",zs,"No hay colaboradores asignados"))]),_:1})]),_:1})],64)):x("",!0)]),_:1}),l(o(Te),{value:"evidencias",class:"mt-0 space-y-4"},{default:r(()=>[d.value?(c(),E(Z,{key:0},[d.value.evidencias&&d.value.evidencias.length>0?(c(),O(Wn,{key:0,modelValue:S.value,"onUpdate:modelValue":y[1]||(y[1]=M=>S.value=M),contratos:o(s).contratosRelacionados,evidencias:d.value.evidencias},null,8,["modelValue","contratos","evidencias"])):x("",!0),d.value.evidencias&&d.value.evidencias.length>0?(c(),O(qn,{key:1,mode:"grouped","evidencias-agrupadas":T.value,"format-date":me},null,8,["evidencias-agrupadas"])):(c(),O(o(ve),{key:2},{default:r(()=>[l(o(he),{class:"text-center py-8"},{default:r(()=>[l(o(na),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),y[25]||(y[25]=f("p",{class:"text-muted-foreground"},"No hay evidencias asociadas a este entregable",-1))]),_:1})]),_:1}))],64)):x("",!0)]),_:1}),l(o(Te),{value:"comentarios",class:"mt-0"},{default:r(()=>[e.entregableId?(c(),O(fn,{key:0,"commentable-type":"entregables","commentable-id":e.entregableId,"can-create":e.canEdit||o(s).canEdit,embedded:""},null,8,["commentable-id","can-create"])):x("",!0)]),_:1}),l(o(Te),{value:"actividad",class:"mt-0 space-y-4"},{default:r(()=>[o(s).actividades&&o(s).actividades.length>0?(c(),O(dn,{key:0,modelValue:C.value,"onUpdate:modelValue":y[2]||(y[2]=M=>C.value=M),usuarios:o(s).usuariosActividades,"context-level":"entregable"},null,8,["modelValue","usuarios"])):x("",!0),l(un,{activities:Y.value,title:"Historial de Actividad",description:"Registro de cambios del entregable","empty-message":"No hay actividad registrada","show-card":!1},null,8,["activities"])]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),l(o(ln),{class:"flex-shrink-0 px-3 py-3 sm:px-6 sm:py-4 border-t bg-muted/30"},{default:r(()=>[f("div",Bs,[f("div",Hs,[A.value?(c(),O(o(Bt),{key:0,href:A.value},{default:r(()=>[l(o(q),{variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3"},{default:r(()=>[l(o(Lt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),y[26]||(y[26]=f("span",{class:"hidden sm:inline"},"Abrir página completa",-1))]),_:1})]),_:1},8,["href"])):x("",!0),(e.canEdit||o(s).canEdit)&&d.value?(c(),O(o(q),{key:1,variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3",onClick:y[4]||(y[4]=M=>a("edit-entregable"))},{default:r(()=>[l(o(_t),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),y[27]||(y[27]=f("span",{class:"hidden sm:inline"},"Editar",-1))]),_:1})):x("",!0)]),l(o(q),{variant:"ghost",size:"sm",class:"text-xs sm:text-sm",onClick:D},{default:r(()=>[...y[28]||(y[28]=[_(" Cerrar ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["open"]))}}),js={class:"flex flex-col md:flex-row h-full min-h-[500px] overflow-hidden bg-background"},Ls={class:"hidden md:flex md:w-72 lg:w-80 flex-col border-r bg-muted/30"},Ys={class:"p-4 border-b bg-background"},Xs={class:"flex items-center justify-between"},Gs={class:"font-semibold text-sm text-muted-foreground uppercase tracking-wide flex items-center gap-2"},Ws={key:0,class:"mt-3"},qs={class:"p-2 space-y-1"},Ks={key:0,class:"p-4 text-center text-muted-foreground text-sm"},Qs=["data-active","onClick"],Zs={class:"flex items-center gap-2"},Js={class:"font-medium truncate flex-1"},ei={key:0,class:"mt-1 ml-4 text-xs text-muted-foreground truncate"},ti={class:"flex items-center gap-2 mt-2 ml-4 text-xs text-muted-foreground"},ai={class:"mt-2 ml-4"},ni={class:"flex-1 flex flex-col min-h-0 min-w-0"},oi={class:"md:hidden mb-2 border-b bg-background sticky top-0 z-10 space-y-2"},li={class:"flex items-center gap-2"},si={class:"flex flex-col"},ii={key:0,class:"text-xs text-muted-foreground"},ri={class:"text-muted-foreground"},di={key:0,class:"flex items-center justify-center h-full min-h-[400px]"},ui={class:"text-center space-y-3 max-w-sm p-6"},ci={key:1,class:"p-0 md:p-6 space-y-6 overflow-x-hidden"},fi={class:"flex items-start justify-between gap-4"},mi={class:"flex-1 min-w-0"},gi={class:"flex items-center gap-2 mb-1"},pi={key:0,class:"flex items-center gap-1.5 text-sm text-muted-foreground mt-1"},vi={key:1,class:"text-sm text-muted-foreground mt-2"},hi={class:"space-y-2"},bi={class:"flex justify-between items-center text-sm"},yi={class:"font-medium"},xi={class:"flex flex-wrap gap-4 text-sm"},wi={key:0,class:"flex items-center gap-1.5 text-muted-foreground"},_i={key:1,class:"flex items-center gap-1.5 text-muted-foreground"},Ei={key:2,class:"flex items-center gap-1.5 text-muted-foreground"},Ci={class:"flex flex-wrap gap-2"},Di={class:"space-y-4 min-w-0"},ki={class:"flex items-center justify-between"},Si={class:"font-semibold flex items-center gap-2"},$i={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},Cr=Me({__name:"HitosDashboard",props:{hitos:{},proyectoId:{},proyectos:{},selectedProyectoId:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},showViewDetail:{type:Boolean,default:!0},showProyectoInHito:{type:Boolean,default:!1},baseUrl:{default:"/admin/proyectos"}},emits:["select-hito","edit-hito","delete-hito","view-hito","add-entregable","view-entregable","complete-entregable","update-entregable-status","edit-entregable","delete-entregable","filter-proyecto"],setup(e,{emit:t}){var St;const n=e,a=t,i=G(((St=n.selectedProyectoId)==null?void 0:St.toString())||"_all"),s=Q(()=>{if(i.value==="_all")return n.hitos;const B=parseInt(i.value,10);return n.hitos.filter(I=>I.proyecto_id===B)}),u=B=>{i.value=B,m.value=null;const I=B!=="_all"?parseInt(B,10):null;a("filter-proyecto",I)};Pn("(max-width: 768px)");const g=()=>{const I=new URLSearchParams(window.location.search).get("hito");return I?parseInt(I,10):null},v=()=>{const B=new URLSearchParams(window.location.search),I=B.get("modal"),ie=B.get("modal_tab")||"detalles";return I==="hito"?{type:"hito",tab:ie}:I!=null&&I.startsWith("entregable_")?{type:"entregable",entregableId:parseInt(I.replace("entregable_",""),10),tab:ie}:{type:null,tab:"detalles"}},m=G(g()),b=v(),p=Q(()=>s.value.find(B=>B.id===m.value)??null),S=Q(()=>n.proyectoId?n.proyectoId:p.value?p.value.proyecto_id:null),C=Q(()=>S.value?`${n.baseUrl}/${S.value}/hitos`:null),d=Q(()=>!p.value||!S.value?null:`${n.baseUrl}/${S.value}/hitos/${p.value.id}/entregables`);Ce(m,B=>{if(B){const I=window.location.pathname,ie=new URLSearchParams(window.location.search);ie.set("hito",String(B));const xe=`${I}?${ie.toString()}`;Ta.get(xe,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]}),a("select-hito",B)}});const h=B=>{m.value=B},P=B=>{const I=parseInt(B,10);isNaN(I)||h(I)},U=B=>B?Ye(new Date(B),"dd MMM yyyy",{locale:Xe}):"Sin fecha",j=B=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[B]||"bg-gray-100 text-gray-800",K=B=>({pendiente:"bg-gray-400",en_progreso:"bg-blue-500 animate-pulse",completado:"bg-green-500",cancelado:"bg-red-500"})[B]||"bg-gray-400",T=B=>{p.value&&a("view-entregable",B,p.value)},Y=(B,I,ie)=>{a("complete-entregable",B,I,ie)},oe=(B,I,ie,xe)=>{a("update-entregable-status",B,I,ie,xe)},re=B=>{p.value&&a("edit-entregable",B,p.value)},me=B=>{p.value&&a("delete-entregable",B,p.value)},V=()=>{p.value&&a("edit-hito",p.value)},A=()=>{p.value&&a("delete-hito",p.value)},D=()=>{p.value&&a("add-entregable",p.value)},N=()=>{p.value&&(y.value="detalles",k.value=!0)},k=G(b.type==="hito"),y=G(b.type==="hito"?b.tab:"detalles"),M=G(b.type==="entregable"),L=G(b.entregableId||null),ye=G(b.type==="entregable"?b.tab:"detalles"),ue=(B,I,ie)=>{const xe=window.location.pathname,R=new URLSearchParams(window.location.search);B==="hito"?(R.set("modal","hito"),ie&&R.set("modal_tab",ie)):B==="entregable"&&I?(R.set("modal",`entregable_${I}`),ie&&R.set("modal_tab",ie)):(R.delete("modal"),R.delete("modal_tab"),R.delete("pagina"));const $t=`${xe}?${R.toString()}`;Ta.get($t,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]})};Ce([k,y],([B,I])=>{B?ue("hito",void 0,I):new URLSearchParams(window.location.search).get("modal")==="hito"&&ue(null)}),Ce([M,ye],([B,I])=>{if(B&&L.value)ue("entregable",L.value,I);else{const xe=new URLSearchParams(window.location.search).get("modal");xe!=null&&xe.startsWith("entregable_")&&ue(null)}});const Ke=(B,I="detalles")=>{L.value=B.id,ye.value=I,M.value=!0},$a=()=>{y.value="comentarios",k.value=!0},kt=()=>{y.value="actividad",k.value=!0};return(B,I)=>{var ie,xe;return c(),E("div",js,[f("aside",Ls,[f("div",Ys,[f("div",Xs,[f("h2",Gs,[l(o(ga),{class:"h-4 w-4"}),_(" Hitos ("+w(s.value.length)+") ",1)]),e.showViewDetail&&C.value?(c(),O(o(Bt),{key:0,href:C.value},{default:r(()=>[l(o(q),{variant:"outline",size:"sm"},{default:r(()=>[l(o(Lt),{class:"h-3.5 w-3.5 mr-1"}),I[7]||(I[7]=_(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):x("",!0)]),e.proyectos&&e.proyectos.length>0?(c(),E("div",Ws,[l(o(Jt),{"model-value":i.value,"onUpdate:modelValue":u},{default:r(()=>[l(o(ea),{class:"w-full h-9 text-sm"},{default:r(()=>[l(o(ta),{placeholder:"Todos los proyectos"})]),_:1}),l(o(aa),null,{default:r(()=>[l(o(ut),{value:"_all"},{default:r(()=>[...I[8]||(I[8]=[_("Todos los proyectos",-1)])]),_:1}),(c(!0),E(Z,null,fe(e.proyectos,R=>(c(),O(o(ut),{key:R.id,value:R.id.toString()},{default:r(()=>[_(w(R.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])])):x("",!0)]),l(o(wt),{class:"flex-1"},{default:r(()=>[f("div",qs,[s.value.length===0?(c(),E("div",Ks," No hay hitos definidos ")):x("",!0),(c(!0),E(Z,null,fe(s.value,R=>(c(),E("button",{key:R.id,"data-active":m.value===R.id,class:"w-full text-left p-3 rounded-lg transition-colors duration-150 hover:bg-accent hover:text-accent-foreground data-[active=true]:bg-primary/10 data-[active=true]:text-primary data-[active=true]:border-l-2 data-[active=true]:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",onClick:$t=>h(R.id)},[f("div",Zs,[f("div",{class:J([K(R.estado),"w-2 h-2 rounded-full flex-shrink-0"])},null,2),f("span",Js,w(R.nombre),1),m.value===R.id?(c(),O(o(Ja),{key:0,class:"h-4 w-4 flex-shrink-0 text-primary"})):x("",!0)]),e.showProyectoInHito&&R.proyecto?(c(),E("div",ei,w(R.proyecto.nombre),1)):x("",!0),f("div",ti,[l(o(ne),{class:J([j(R.estado),"text-[10px] px-1.5 py-0"])},{default:r(()=>[_(w(R.estado_label||R.estado),1)]),_:2},1032,["class"]),f("span",null,w(R.porcentaje_completado)+"%",1)]),f("div",ai,[l(o(Ht),{"model-value":R.porcentaje_completado,class:"h-1"},null,8,["model-value"])])],8,Qs))),128))])]),_:1})]),f("main",ni,[f("div",oi,[e.proyectos&&e.proyectos.length>0?(c(),O(o(Jt),{key:0,"model-value":i.value,"onUpdate:modelValue":u},{default:r(()=>[l(o(ea),{class:"w-full h-9 text-sm"},{default:r(()=>[l(o(ta),{placeholder:"Todos los proyectos"})]),_:1}),l(o(aa),null,{default:r(()=>[l(o(ut),{value:"_all"},{default:r(()=>[...I[9]||(I[9]=[_("Todos los proyectos",-1)])]),_:1}),(c(!0),E(Z,null,fe(e.proyectos,R=>(c(),O(o(ut),{key:R.id,value:R.id.toString()},{default:r(()=>[_(w(R.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])):x("",!0),l(o(Jt),{"model-value":((ie=m.value)==null?void 0:ie.toString())||"","onUpdate:modelValue":P},{default:r(()=>[l(o(ea),{class:"w-full"},{default:r(()=>[l(o(ta),{placeholder:"Selecciona un hito"})]),_:1}),l(o(aa),null,{default:r(()=>[(c(!0),E(Z,null,fe(s.value,R=>(c(),O(o(ut),{key:R.id,value:R.id.toString()},{default:r(()=>[f("div",li,[f("div",{class:J([K(R.estado),"w-2 h-2 rounded-full"])},null,2),f("div",si,[f("span",null,w(R.nombre),1),e.showProyectoInHito&&R.proyecto?(c(),E("span",ii,w(R.proyecto.nombre),1)):x("",!0)]),f("span",ri,"("+w(R.porcentaje_completado)+"%)",1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),l(o(wt),{class:"flex-1"},{default:r(()=>[p.value?(c(),E("div",ci,[l(o(ve),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[f("div",fi,[f("div",mi,[f("div",gi,[f("div",{class:J([K(p.value.estado),"w-2.5 h-2.5 rounded-full"])},null,2),l(o($e),{class:"text-xl truncate"},{default:r(()=>[_(w(p.value.nombre),1)]),_:1})]),e.showProyectoInHito&&p.value.proyecto?(c(),E("div",pi,[l(o(eo),{class:"h-4 w-4"}),f("span",null,w(p.value.proyecto.nombre),1)])):x("",!0),p.value.descripcion?(c(),E("p",vi,w(p.value.descripcion),1)):x("",!0)]),l(o(ne),{class:J(j(p.value.estado))},{default:r(()=>[_(w(p.value.estado_label||p.value.estado),1)]),_:1},8,["class"])])]),_:1}),l(o(he),{class:"space-y-4"},{default:r(()=>[f("div",hi,[f("div",bi,[I[12]||(I[12]=f("span",{class:"text-muted-foreground"},"Progreso",-1)),f("span",yi,w(p.value.porcentaje_completado)+"%",1)]),l(o(Ht),{"model-value":p.value.porcentaje_completado,class:"h-2"},null,8,["model-value"])]),f("div",xi,[p.value.fecha_inicio?(c(),E("div",wi,[l(o(Ge),{class:"h-4 w-4"}),f("span",null,"Inicio: "+w(U(p.value.fecha_inicio)),1)])):x("",!0),p.value.fecha_fin?(c(),E("div",_i,[l(o(Pe),{class:"h-4 w-4"}),f("span",null,"Fin: "+w(U(p.value.fecha_fin)),1)])):x("",!0),p.value.responsable?(c(),E("div",Ei,[l(o(tt),{class:"h-4 w-4"}),f("span",null,w(p.value.responsable.name),1)])):x("",!0)]),l(o(An)),f("div",Ci,[e.canEdit?(c(),O(o(q),{key:0,variant:"outline",size:"sm",onClick:V},{default:r(()=>[l(o(_t),{class:"h-4 w-4 mr-1.5"}),I[13]||(I[13]=_(" Editar Hito ",-1))]),_:1})):x("",!0),e.canManageDeliverables?(c(),O(o(q),{key:1,variant:"outline",size:"sm",onClick:D},{default:r(()=>[l(o(Na),{class:"h-4 w-4 mr-1.5"}),I[14]||(I[14]=_(" Añadir Entregable ",-1))]),_:1})):x("",!0),e.showViewDetail?(c(),O(o(q),{key:2,variant:"ghost",size:"sm",onClick:N},{default:r(()=>[l(o(nt),{class:"h-4 w-4 mr-1.5"}),I[15]||(I[15]=_(" Ver detalles ",-1))]),_:1})):x("",!0),l(o(q),{variant:"ghost",size:"sm",onClick:$a},{default:r(()=>[l(o(We),{class:"h-4 w-4 mr-1.5"}),I[16]||(I[16]=_(" Comentarios ",-1)),p.value.comentarios_count&&p.value.comentarios_count>0?(c(),O(o(ne),{key:0,variant:"secondary",class:"ml-1.5 text-xs"},{default:r(()=>[_(w(p.value.comentarios_count),1)]),_:1})):x("",!0)]),_:1}),l(o(q),{variant:"ghost",size:"sm",onClick:kt},{default:r(()=>[l(o(qe),{class:"h-4 w-4 mr-1.5"}),I[17]||(I[17]=_(" Actividad ",-1))]),_:1}),e.canDelete?(c(),O(o(q),{key:3,variant:"ghost",size:"sm",class:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:A},{default:r(()=>[l(o(tn),{class:"h-4 w-4 mr-1.5"}),I[18]||(I[18]=_(" Eliminar ",-1))]),_:1})):x("",!0)])]),_:1})]),_:1}),f("div",Di,[f("div",ki,[f("h3",Si,[l(o(nt),{class:"h-5 w-5"}),I[19]||(I[19]=_(" Entregables ",-1)),l(o(ne),{variant:"secondary",class:"ml-1"},{default:r(()=>{var R;return[_(w(((R=p.value.entregables)==null?void 0:R.length)||0),1)]}),_:1})]),e.showViewDetail&&d.value?(c(),O(o(Bt),{key:0,href:d.value},{default:r(()=>[l(o(q),{variant:"outline",size:"sm"},{default:r(()=>[l(o(Lt),{class:"h-3.5 w-3.5 mr-1"}),I[20]||(I[20]=_(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):x("",!0)]),p.value.entregables&&p.value.entregables.length>0?(c(),O(o(yl),{key:0,entregables:p.value.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"initial-modal-entregable-id":o(b).type==="entregable"?o(b).entregableId:void 0,"initial-modal-tab":o(b).type==="entregable"?o(b).tab:void 0,onView:T,onComplete:Y,onUpdateStatus:oe,onEdit:re,onDelete:me,onOpenModal:Ke,onModalTabChange:I[0]||(I[0]=(R,$t)=>{L.value=R,ye.value=$t})},null,8,["entregables","can-edit","can-delete","can-complete","initial-modal-entregable-id","initial-modal-tab"])):(c(),E("div",$i,[l(o(nt),{class:"h-10 w-10 mx-auto text-muted-foreground/50 mb-3"}),I[22]||(I[22]=f("p",{class:"text-muted-foreground text-sm"},"No hay entregables en este hito",-1)),e.canManageDeliverables?(c(),O(o(q),{key:0,variant:"outline",size:"sm",class:"mt-4",onClick:D},{default:r(()=>[l(o(Na),{class:"h-4 w-4 mr-1.5"}),I[21]||(I[21]=_(" Crear primer entregable ",-1))]),_:1})):x("",!0)]))])])):(c(),E("div",di,[f("div",ui,[l(o(ga),{class:"h-16 w-16 mx-auto text-muted-foreground/50"}),I[10]||(I[10]=f("h3",{class:"font-medium text-lg"},"Selecciona un hito",-1)),I[11]||(I[11]=f("p",{class:"text-sm text-muted-foreground"}," Elige un hito de la lista para ver sus detalles y entregables ",-1))])]))]),_:1})]),p.value?(c(),O(ts,{key:0,open:k.value,"onUpdate:open":I[1]||(I[1]=R=>k.value=R),"hito-id":p.value.id,"proyecto-id":S.value||0,"initial-tab":y.value,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-manage-entregables":e.canManageDeliverables,"onUpdate:tab":I[2]||(I[2]=R=>y.value=R),onEditHito:V,onViewEntregable:T,onEditEntregable:re,onAddEntregable:D},null,8,["open","hito-id","proyecto-id","initial-tab","can-edit","can-delete","can-manage-entregables"])):x("",!0),L.value?(c(),O(Us,{key:1,open:M.value,"onUpdate:open":[I[3]||(I[3]=R=>M.value=R),I[6]||(I[6]=R=>{R||(L.value=null)})],"entregable-id":L.value,"proyecto-id":S.value,"hito-id":(xe=p.value)==null?void 0:xe.id,"initial-tab":ye.value,"can-edit":e.canEdit,"can-delete":e.canDelete,"onUpdate:tab":I[4]||(I[4]=R=>ye.value=R),onEditEntregable:I[5]||(I[5]=()=>p.value&&re({id:L.value}))},null,8,["open","entregable-id","proyecto-id","hito-id","initial-tab","can-edit","can-delete"])):x("",!0)])}}});export{Cr as _};
