import{_ as y}from"./index-DDOs4BX8.js";import{_ as h}from"./createLucideIcon-ws-ojhqG.js";import{_ as Y,c as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-eH9eZ0b3.js";import{_ as X}from"./Switch.vue_vue_type_script_setup_true_lang-CoNZ-XvS.js";import{_ as Z,a as ee,b as $,c as b,d as te,e as g}from"./TableHeader.vue_vue_type_script_setup_true_lang-B9MUxOhn.js";import{V as se,C as ae,_ as ie}from"./AppLayout.vue_vue_type_script_setup_true_lang-DBe60XPu.js";import{d as le,k as z,c as N,a as C,o,b as a,u as t,m as re,e as i,f as l,i as v,g as n,n as x,j as c,t as p,F as S,r as B,l as oe,W as k}from"./app-BD3MTM58.js";import{_ as ne}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-BMVP7A5c.js";import{l as D,C as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-CBFnjOpf.js";import{C as L}from"./clock-Cbi2s884.js";import{C as A}from"./circle-check-big-CfvjhVYy.js";import{C as T}from"./circle-alert-OKsAybsd.js";import"./index-CeeVXjEe.js";import"./VisuallyHidden-I5ZB6YL5.js";import"./Input.vue_vue_type_script_setup_true_lang-4dPJJov-.js";import"./VisuallyHiddenInput-BHe2wgPK.js";import"./index-Blt3B60n.js";import"./check-Di0hAdCT.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-ff5IG9It.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-DaZYUUcn.js";import"./Label.vue_vue_type_script_setup_true_lang-CqzYP5es.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BtEd5dZV.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-D8eqrWvm.js";import"./users-CUQRvubh.js";import"./index-CUgsP1ga.js";import"./briefcase-BMZqU2EF.js";import"./calendar-CHxGHjFt.js";import"./map-pin-BEVeS3av.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DHO4dgla.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-CaLjgM8F.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DJO2kGII.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-CIJ4DMw1.js";import"./loader-circle-DWmh85C3.js";import"./trash-2-KUgHUgZu.js";import"./plus-BU8iIQ4G.js";import"./search-DSPNRLCC.js";import"./history-DDpRg7Pm.js";import"./save-CkkQSecf.js";const de={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ue={class:"flex items-center gap-4 mb-4"},ce={class:"flex items-center space-x-2"},fe={class:"relative min-h-[50vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},me={class:"rounded-md border"},pe={class:"flex items-center gap-1"},_e={class:"flex flex-col"},ve={class:"flex items-center gap-1"},xe={class:"flex flex-col"},ge={class:"flex items-center gap-1"},he={class:"flex flex-col"},be={class:"flex items-center gap-2 mb-1"},ye={class:"font-medium"},Ce={key:0,class:"text-sm text-muted-foreground"},ke={class:"text-sm"},we={class:"text-sm"},Ve={class:"flex items-center gap-2"},$e={class:"flex justify-end gap-2"},ze={key:0,class:"flex items-center justify-between mt-4"},Se={class:"text-sm text-muted-foreground"},De={class:"flex gap-2"},vt=le({__name:"Index",props:{votaciones:{},categorias:{},filters:{},mostrar_pasadas:{type:Boolean},filterFieldsConfig:{}},setup(P){const d=P,j=[{title:"Dashboard",href:"/dashboard"},{title:"Mis Votaciones",href:"/votaciones"}],w=z(d.mostrar_pasadas||!1),{route:E}=window,q=N(()=>({quickSearch:d.filters.search||"",rootGroup:d.filters.advanced_filters?JSON.parse(d.filters.advanced_filters):void 0})),H={fields:d.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por título o descripción...",quickSearchFields:["titulo","descripcion"],maxNestingLevel:2,allowSaveFilters:!0,debounceTime:500,autoApply:!1},f=z("fecha_inicio"),m=z("asc"),V=r=>{f.value===r?m.value=m.value==="asc"?"desc":"asc":(f.value=r,m.value="asc")},I=N(()=>[...d.votaciones.data].sort((s,e)=>{let u,_;switch(f.value){case"fecha_inicio":u=new Date(s.fecha_inicio),_=new Date(e.fecha_inicio);break;case"fecha_fin":u=new Date(s.fecha_fin),_=new Date(e.fecha_fin);break;case"titulo":u=s.titulo.toLowerCase(),_=e.titulo.toLowerCase();break;default:u=s[f.value],_=e[f.value]}return u<_?m.value==="asc"?-1:1:u>_?m.value==="asc"?1:-1:0})),R=()=>{k.get("/votaciones",{...d.filters,mostrar_pasadas:w.value||void 0},{preserveState:!0,replace:!0})},U=r=>{k.get(`/votaciones/${r}/votar`)},W=r=>{k.get(`/votaciones/${r}/mi-voto`)},G=r=>{k.get(`/votaciones/${r}/resultados`)},J=r=>r.ya_voto?A:r.ha_finalizado?T:L,O=r=>r.ya_voto?"default":r.ha_finalizado?"destructive":"secondary",Q=r=>r.ya_voto?r.ha_finalizado?"Voté (Finalizada)":"Ya voté":r.ha_finalizado?"Expirada":"Disponible",M=r=>new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(r,s)=>(o(),C(S,null,[a(t(re),{title:"Mis Votaciones"}),a(ie,{breadcrumbs:j},{default:i(()=>[l("div",de,[s[19]||(s[19]=l("div",{class:"flex items-center justify-between"},[l("div",null,[l("h1",{class:"text-3xl font-bold"},"Mis Votaciones"),l("p",{class:"text-muted-foreground"}," Votaciones disponibles para mi participación ")])],-1)),l("div",ue,[a(ne,{config:H,route:t(E)("votaciones.index"),"initial-filters":q.value,class:"flex-1"},null,8,["route","initial-filters"]),l("div",ce,[a(t(X),{id:"mostrar-pasadas",modelValue:w.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>w.value=e),R]},null,8,["modelValue"]),s[4]||(s[4]=l("label",{for:"mostrar-pasadas",class:"text-sm font-medium whitespace-nowrap"}," Ver historial ",-1))])]),l("div",fe,[a(t(Y),{class:"border-0 shadow-none h-full"},{default:i(()=>[a(t(K),{class:"pt-6"},{default:i(()=>[l("div",me,[a(t(Z),null,{default:i(()=>[a(t(ee),null,{default:i(()=>[a(t($),null,{default:i(()=>[a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[1]||(s[1]=e=>V("titulo"))},{default:i(()=>[l("div",pe,[s[5]||(s[5]=n(" Título ")),l("div",_e,[a(t(D),{class:x(["h-3 w-3",{"text-primary":f.value==="titulo"&&m.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="titulo"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:i(()=>s[6]||(s[6]=[n("Categoría")])),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[2]||(s[2]=e=>V("fecha_inicio"))},{default:i(()=>[l("div",ve,[s[7]||(s[7]=n(" Fecha de Apertura ")),l("div",xe,[a(t(D),{class:x(["h-3 w-3",{"text-primary":f.value==="fecha_inicio"&&m.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="fecha_inicio"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[3]||(s[3]=e=>V("fecha_fin"))},{default:i(()=>[l("div",ge,[s[8]||(s[8]=n(" Fecha Límite ")),l("div",he,[a(t(D),{class:x(["h-3 w-3",{"text-primary":f.value==="fecha_fin"&&m.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="fecha_fin"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:i(()=>s[9]||(s[9]=[n("Mi Estado")])),_:1}),a(t(b),{class:"text-right"},{default:i(()=>s[10]||(s[10]=[n("Acción")])),_:1})]),_:1})]),_:1}),a(t(te),null,{default:i(()=>[d.votaciones.data.length===0?(o(),c(t($),{key:0},{default:i(()=>[a(t(g),{colspan:6,class:"text-center py-8 text-muted-foreground"},{default:i(()=>[n(p(w.value?"No tienes historial de votaciones":"No tienes votaciones disponibles en este momento"),1)]),_:1})]),_:1})):v("",!0),(o(!0),C(S,null,B(I.value,e=>(o(),c(t($),{key:e.id,class:x({"opacity-75":e.ha_finalizado,"bg-green-50/50 dark:bg-green-950/10":e.ya_voto&&!e.ha_finalizado,"bg-blue-50/50 dark:bg-blue-950/10":e.puede_votar})},{default:i(()=>[a(t(g),null,{default:i(()=>{var u,_;return[l("div",null,[l("div",be,[l("p",ye,p(e.titulo),1),e.estado_visual==="finalizada"?(o(),c(t(y),{key:0,variant:"secondary",class:"text-xs"},{default:i(()=>s[11]||(s[11]=[n(" Finalizada ")])),_:1})):e.estado_visual==="activa"?(o(),c(t(y),{key:1,variant:"default",class:"text-xs"},{default:i(()=>s[12]||(s[12]=[n(" Activa ")])),_:1})):e.estado_visual==="pendiente"?(o(),c(t(y),{key:2,variant:"outline",class:"text-xs"},{default:i(()=>s[13]||(s[13]=[n(" Pendiente ")])),_:1})):v("",!0)]),e.descripcion?(o(),C("p",Ce,p((u=e.descripcion)==null?void 0:u.substring(0,80))+p(((_=e.descripcion)==null?void 0:_.length)>80?"...":""),1)):v("",!0)])]}),_:2},1024),a(t(g),null,{default:i(()=>[a(t(y),{variant:"outline"},{default:i(()=>[n(p(e.categoria.nombre),1)]),_:2},1024)]),_:2},1024),a(t(g),null,{default:i(()=>[l("div",ke,p(M(e.fecha_inicio)),1)]),_:2},1024),a(t(g),null,{default:i(()=>[l("div",we,p(M(e.fecha_fin)),1)]),_:2},1024),a(t(g),null,{default:i(()=>[l("div",Ve,[(o(),c(oe(J(e)),{class:x(["h-4 w-4",{"text-green-600":e.ya_voto,"text-orange-600":e.puede_votar,"text-red-600":!e.puede_votar&&!e.ya_voto}])},null,8,["class"])),a(t(y),{variant:O(e)},{default:i(()=>[n(p(Q(e)),1)]),_:2},1032,["variant"])])]),_:2},1024),a(t(g),{class:"text-right"},{default:i(()=>[l("div",$e,[e.puede_votar?(o(),c(t(h),{key:0,onClick:u=>U(e.id),size:"sm"},{default:i(()=>[a(t(se),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=n(" Votar "))]),_:2},1032,["onClick"])):v("",!0),e.estado_visual==="pendiente"?(o(),c(t(h),{key:1,variant:"outline",size:"sm",disabled:"",class:"cursor-not-allowed"},{default:i(()=>[a(t(L),{class:"mr-2 h-4 w-4"}),s[15]||(s[15]=n(" Próximamente "))]),_:1})):v("",!0),e.puede_ver_voto?(o(),c(t(h),{key:2,onClick:u=>W(e.id),variant:"outline",size:"sm"},{default:i(()=>[a(t(A),{class:"mr-2 h-4 w-4"}),s[16]||(s[16]=n(" Ver mi voto "))]),_:2},1032,["onClick"])):v("",!0),e.resultados_visibles?(o(),c(t(h),{key:3,onClick:u=>G(e.id),variant:"default",size:"sm",class:"bg-blue-600 hover:bg-blue-700 text-white"},{default:i(()=>[a(t(ae),{class:"mr-2 h-4 w-4"}),s[17]||(s[17]=n(" Ver Resultados "))]),_:2},1032,["onClick"])):v("",!0),e.ha_finalizado&&!e.ya_voto?(o(),c(t(h),{key:4,variant:"outline",size:"sm",disabled:""},{default:i(()=>[a(t(T),{class:"mr-2 h-4 w-4"}),s[18]||(s[18]=n(" No participé "))]),_:1})):v("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),d.votaciones.last_page>1?(o(),C("div",ze,[l("p",Se," Mostrando "+p((d.votaciones.current_page-1)*d.votaciones.per_page+1)+" a "+p(Math.min(d.votaciones.current_page*d.votaciones.per_page,d.votaciones.total))+" de "+p(d.votaciones.total)+" resultados ",1),l("div",De,[(o(!0),C(S,null,B(d.votaciones.links,e=>(o(),c(t(h),{key:e.label,variant:e.active?"default":"outline",disabled:!e.url,size:"sm",onClick:u=>e.url&&t(k).get(e.url),innerHTML:e.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):v("",!0)]),_:1})]),_:1})])])]),_:1})],64))}});export{vt as default};
