import{d as H,r as h,C as E,i as m,e as d,f as t,u as e,p as I,w as r,g as a,P as x,h as l,l as R,j as c,t as p,F as $,k as j,b as D,A as N,E as B}from"./app-CbA_dzrH.js";import{_ as F}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DjfisSTq.js";import{_ as P,a as A,b as M,c as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dpl1EP6e.js";import{_ as q}from"./CardDescription.vue_vue_type_script_setup_true_lang-FdnBhRW4.js";import{_ as b}from"./createLucideIcon-0y3HvBb2.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-Dw2oMjuZ.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-BHOcaT7W.js";import{_ as L}from"./Textarea.vue_vue_type_script_setup_true_lang-DNuak2_2.js";import{_ as O,a as T,b as X,c as G,d as J}from"./SelectValue.vue_vue_type_script_setup_true_lang-C7VbuHoF.js";import{_ as K}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-CFvHKQ5j.js";import{t as V}from"./index-CXCj42Z3.js";import{A as Q}from"./arrow-left-DWk22nOp.js";import{X as W}from"./x-CxSWfWOJ.js";import{U as Y}from"./user-plus-t2hm4xO_.js";import{S as Z}from"./save-CybCtRtH.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C4x6rJ8B.js";import"./index-D-PGeZ3t.js";import"./floating-ui.vue-D3EH1Xba.js";import"./index-BGfSt6nP.js";import"./shield-yBic2gp-.js";import"./user-BnDczykq.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-H44qAxpr.js";import"./chevron-right-pq_ChJ0s.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-H8FdC1v8.js";import"./VisuallyHidden-BOU54Fpc.js";import"./index-DzUkqZxm.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-fWHHAQt9.js";import"./circle-alert-CfNQ3Vlu.js";import"./map-pin-B0r5dLQM.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-nF_8TJte.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CPMNIlI6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-B4CsJOKK.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BZUuILpY.js";import"./tag-DBRua3DS.js";import"./users-DLZP89St.js";import"./target-B8OPFMH2.js";import"./vote-5ymqB6Fb.js";import"./folder-open-B03CPFE8.js";import"./send-BUC0oswk.js";import"./file-text-DINmkRZl.js";import"./briefcase-BEGziJue.js";import"./calendar-BOFnEXb6.js";import"./megaphone-CDZIxwTF.js";import"./user-check-B3Jm4jmh.js";import"./clipboard-list-wMp9Eq1A.js";import"./mail-I3hCy8Tx.js";import"./message-square-RBI0Tfwc.js";import"./external-link-CKKN5QSr.js";import"./panel-left-ivBXt___.js";import"./index-MuREUf8q.js";import"./check-8t2yOxAa.js";import"./index-DPtKDKxs.js";import"./nullish-CHIgUVhi.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-mf8fWrST.js";import"./search-BT-o3QIf.js";import"./loader-circle-BA_4hMzh.js";import"./chevron-left-R6JGwNmv.js";const ee={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},oe={class:"flex items-center justify-between"},se={class:"space-y-2"},te={key:0,class:"text-sm text-red-500"},re={class:"space-y-2"},ie={key:0,class:"text-sm text-red-500"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le={class:"space-y-2"},ne={key:0,class:"text-sm text-red-500"},de={class:"space-y-2"},pe={key:0,class:"text-sm text-red-500"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ue={class:"space-y-2"},ce={key:0,class:"text-sm text-red-500"},fe={class:"space-y-2"},_e={class:"space-y-2"},be={key:0,class:"p-3 bg-muted rounded-lg flex items-center justify-between"},ve={class:"font-medium"},ye={class:"text-sm text-muted-foreground"},he={key:0,class:"text-sm text-red-500"},ge={class:"flex items-center space-x-2"},xe={class:"flex justify-end gap-2 pt-4"},So=H({__name:"Create",props:{proyecto:{},responsables:{},estados:{},siguienteOrden:{}},setup(w){const _=w,k=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:_.proyecto.nombre,href:`/admin/proyectos/${_.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${_.proyecto.id}/hitos`},{title:"Crear Hito",href:"#"}],y=h(!1),{route:C}=window,u=h(null),v=h(new Map);_.responsables.forEach(n=>v.value.set(n.id,n));const s=E({nombre:"",descripcion:"",fecha_inicio:"",fecha_fin:"",estado:"pendiente",responsable_id:null,orden:_.siguienteOrden,crear_entregables_predefinidos:!1}),S=n=>{if(n.userIds.length>0){const o=n.userIds[0];s.responsable_id=o,v.value.has(o)?u.value=v.value.get(o)||null:(u.value={id:o,name:`Usuario seleccionado (ID: ${o})`,email:"Se actualizará al guardar"},v.value.set(o,u.value))}},U=()=>{const n={...s.data()};s.transform(()=>n).post(`/admin/proyectos/${_.proyecto.id}/hitos`,{onSuccess:()=>{V.success("Hito creado exitosamente")},onError:()=>{V.error("Error al crear el hito")}})};return(n,o)=>(d(),m($,null,[t(e(I),{title:`Crear Hito - ${n.proyecto.nombre}`},null,8,["title"]),t(F,{breadcrumbs:k},{default:r(()=>[a("div",ee,[a("div",oe,[o[10]||(o[10]=a("h1",{class:"text-2xl font-bold"},"Crear Nuevo Hito",-1)),t(e(x),{href:`/admin/proyectos/${n.proyecto.id}/hitos`},{default:r(()=>[t(e(b),{variant:"outline",size:"sm"},{default:r(()=>[t(e(Q),{class:"h-4 w-4 mr-2"}),o[9]||(o[9]=l(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),t(e(P),null,{default:r(()=>[t(e(A),null,{default:r(()=>[t(e(M),null,{default:r(()=>[...o[11]||(o[11]=[l("Información del Hito",-1)])]),_:1}),t(e(q),null,{default:r(()=>[...o[12]||(o[12]=[l(" Define los detalles del nuevo hito para el proyecto ",-1)])]),_:1})]),_:1}),t(e(z),null,{default:r(()=>[a("form",{onSubmit:R(U,["prevent"]),class:"space-y-6"},[a("div",se,[t(e(f),{for:"nombre",required:""},{default:r(()=>[...o[13]||(o[13]=[l("Nombre del Hito",-1)])]),_:1}),t(e(g),{id:"nombre",modelValue:e(s).nombre,"onUpdate:modelValue":o[0]||(o[0]=i=>e(s).nombre=i),type:"text",placeholder:"Ej: Pre-producción",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.nombre?(d(),m("span",te,p(e(s).errors.nombre),1)):c("",!0)]),a("div",re,[t(e(f),{for:"descripcion"},{default:r(()=>[...o[14]||(o[14]=[l("Descripción",-1)])]),_:1}),t(e(L),{id:"descripcion",modelValue:e(s).descripcion,"onUpdate:modelValue":o[1]||(o[1]=i=>e(s).descripcion=i),placeholder:"Describe el objetivo y alcance del hito...",disabled:e(s).processing,rows:"3"},null,8,["modelValue","disabled"]),e(s).errors.descripcion?(d(),m("span",ie,p(e(s).errors.descripcion),1)):c("",!0)]),a("div",ae,[a("div",le,[t(e(f),{for:"fecha_inicio"},{default:r(()=>[...o[15]||(o[15]=[l("Fecha de Inicio",-1)])]),_:1}),t(e(g),{id:"fecha_inicio",modelValue:e(s).fecha_inicio,"onUpdate:modelValue":o[2]||(o[2]=i=>e(s).fecha_inicio=i),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_inicio?(d(),m("span",ne,p(e(s).errors.fecha_inicio),1)):c("",!0)]),a("div",de,[t(e(f),{for:"fecha_fin"},{default:r(()=>[...o[16]||(o[16]=[l("Fecha de Fin",-1)])]),_:1}),t(e(g),{id:"fecha_fin",modelValue:e(s).fecha_fin,"onUpdate:modelValue":o[3]||(o[3]=i=>e(s).fecha_fin=i),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_fin?(d(),m("span",pe,p(e(s).errors.fecha_fin),1)):c("",!0)])]),a("div",me,[a("div",ue,[t(e(f),{for:"estado"},{default:r(()=>[...o[17]||(o[17]=[l("Estado Inicial",-1)])]),_:1}),t(e(O),{modelValue:e(s).estado,"onUpdate:modelValue":o[4]||(o[4]=i=>e(s).estado=i)},{default:r(()=>[t(e(T),null,{default:r(()=>[t(e(X),{placeholder:"Seleccionar estado"})]),_:1}),t(e(G),null,{default:r(()=>[(d(!0),m($,null,j(n.estados,i=>(d(),D(e(J),{key:i.value,value:i.value},{default:r(()=>[l(p(i.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(s).errors.estado?(d(),m("span",ce,p(e(s).errors.estado),1)):c("",!0)]),a("div",fe,[t(e(f),{for:"responsable_id"},{default:r(()=>[...o[18]||(o[18]=[l("Responsable",-1)])]),_:1}),a("div",_e,[u.value?(d(),m("div",be,[a("div",null,[a("p",ve,p(u.value.name),1),a("p",ye,p(u.value.email),1)]),t(e(b),{type:"button",variant:"ghost",size:"sm",onClick:o[5]||(o[5]=i=>{e(s).responsable_id=null,u.value=null})},{default:r(()=>[t(e(W),{class:"h-4 w-4"})]),_:1})])):c("",!0),t(e(b),{type:"button",variant:"outline",onClick:o[6]||(o[6]=i=>y.value=!0),class:"w-full"},{default:r(()=>[t(e(Y),{class:"h-4 w-4 mr-2"}),l(" "+p(u.value?"Cambiar Responsable":"Seleccionar Responsable"),1)]),_:1})]),e(s).errors.responsable_id?(d(),m("span",he,p(e(s).errors.responsable_id),1)):c("",!0)])]),a("div",ge,[N(a("input",{id:"crear_entregables","onUpdate:modelValue":o[7]||(o[7]=i=>e(s).crear_entregables_predefinidos=i),type:"checkbox",class:"rounded border-gray-300"},null,512),[[B,e(s).crear_entregables_predefinidos]]),t(e(f),{for:"crear_entregables",class:"cursor-pointer"},{default:r(()=>[...o[19]||(o[19]=[l(" Crear entregables predefinidos según el tipo de proyecto ",-1)])]),_:1})]),a("div",xe,[t(e(x),{href:`/admin/proyectos/${n.proyecto.id}/hitos`},{default:r(()=>[t(e(b),{type:"button",variant:"outline"},{default:r(()=>[...o[20]||(o[20]=[l(" Cancelar ",-1)])]),_:1})]),_:1},8,["href"]),t(e(b),{type:"submit",disabled:e(s).processing},{default:r(()=>[t(e(Z),{class:"h-4 w-4 mr-2"}),o[21]||(o[21]=l(" Crear Hito ",-1))]),_:1},8,["disabled"])])],32)]),_:1})]),_:1})]),t(K,{modelValue:y.value,"onUpdate:modelValue":o[8]||(o[8]=i=>y.value=i),title:"Seleccionar Responsable del Hito",description:"Selecciona el usuario que será responsable de este hito","search-endpoint":e(C)("admin.proyectos.search-users"),"excluded-ids":e(s).responsable_id?[e(s).responsable_id]:[],"max-selection":1,"submit-button-text":"Seleccionar Responsable","search-placeholder":"Buscar por nombre, email, documento o teléfono...",onSubmit:S},null,8,["modelValue","search-endpoint","excluded-ids"])]),_:1})],64))}});export{So as default};
