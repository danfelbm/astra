import{d as z,r as C,p as A,c as $,i as c,j as v,e as l,g as d,f as s,w as r,h as x,t as i,b as g,F as E,k as V,m as n,x as F,n as L,l as G}from"./app-22iUgOMO.js";import{_ as w}from"./createLucideIcon-DYCv6hRJ.js";import{_ as U}from"./index-DBWcKyvi.js";import{_ as M}from"./Label.vue_vue_type_script_setup_true_lang-DAYcABOY.js";import{_ as Z}from"./Input.vue_vue_type_script_setup_true_lang-BOumzjFB.js";import{_ as Q}from"./Checkbox.vue_vue_type_script_setup_true_lang-Dde5577f.js";import{e as X,_ as J,a as K,b as O,c as R,d as W}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CkAxTu3n.js";import{_ as Y,a as ee}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-COTaknTk.js";import{c as te}from"./useFlashMessages-r6OJwE5M.js";import{C as ae}from"./chevrons-up-down-DHAsq1RA.js";import{S as se}from"./search-CeLbB5Wm.js";import{a as q,F as oe,T as le}from"./target-nNhv35Ae.js";import{P as ne}from"./plus-BZ3Q1wzb.js";import{C as re}from"./SelectValue.vue_vue_type_script_setup_true_lang-BUbIyXRi.js";import{X as ie}from"./x-D2_7tWf5.js";import{G as ue,B as de,P as ce,Z as fe,H as me,S as pe,F as _e,a as ve}from"./zap-HY6QURU1.js";import{L as xe}from"./layers-37yZpZij.js";import{T as he}from"./trending-up-WpTFN8PQ.js";import{A as ge}from"./award-B-jyp4Ib.js";import{H as be}from"./hash-C5bw07jk.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";const we={class:"space-y-2"},ke={key:0,class:"flex justify-between items-center"},Ce={class:"text-xs text-muted-foreground"},$e={class:"text-left truncate"},Ee={class:"relative"},Ve={class:"flex-1 overflow-y-auto border rounded-lg min-h-[200px] max-h-[400px]"},qe={key:0,class:"p-8 text-center"},Se={class:"text-muted-foreground"},Be={key:1,class:"p-2 space-y-1"},Ne={class:"flex items-center gap-2"},Te={class:"font-medium"},Fe={class:"ml-4 space-y-1 pb-2"},Le=["onClick"],Ue={class:"flex-1"},je={key:0,class:"text-xs text-muted-foreground"},Ie={key:1,class:"text-xs text-muted-foreground truncate max-w-[200px]"},De={class:"flex items-center justify-between w-full"},He={class:"text-sm text-muted-foreground"},Pe={class:"flex gap-2"},ze={key:1,class:"flex flex-wrap gap-1.5"},Ae=["onClick","disabled"],Ge={key:2,class:"text-sm text-muted-foreground"},Me=z({__name:"EtiquetaSelector",props:{modelValue:{},categorias:{},maxEtiquetas:{default:10},placeholder:{default:"Seleccionar etiquetas..."},disabled:{type:Boolean,default:!1},allowCreate:{type:Boolean,default:!1},label:{default:""},description:{default:""}},emits:["update:modelValue","create"],setup(f,{emit:j}){const u=f,k=j,p=C(!1),m=C(""),S=`etiqueta-selector-${Math.random().toString(36).substr(2,9)}`,b=C({});A(p,o=>{o&&(u.categorias.forEach(e=>{b.value[e.id]=!0}),m.value="")});const B=$(()=>{if(!m.value)return u.categorias;const o=m.value.toLowerCase();return u.categorias.map(e=>{var t;return{...e,etiquetas:((t=e.etiquetas)==null?void 0:t.filter(a=>{var y;return a.nombre.toLowerCase().includes(o)||((y=a.descripcion)==null?void 0:y.toLowerCase().includes(o))}))||[]}}).filter(e=>e.etiquetas.length>0)}),_=$(()=>{const o=[];return u.categorias.forEach(e=>{var t;(t=e.etiquetas)==null||t.forEach(a=>{u.modelValue.includes(a.id)&&o.push({...a,categoria:e})})}),o}),I=$(()=>_.value.length===0?u.placeholder:_.value.length===1?_.value[0].nombre:`${_.value.length} etiquetas seleccionadas`);function h(o){return u.modelValue.includes(o)}function N(o){return u.disabled?!1:h(o.id)?!0:u.modelValue.length<u.maxEtiquetas}function D(o){const e=o.id;let t=[...u.modelValue];if(h(e))t=t.filter(a=>a!==e);else if(t.length<u.maxEtiquetas)t.push(e);else return;k("update:modelValue",t)}function H(o){const e=u.modelValue.filter(t=>t!==o);k("update:modelValue",e)}function P(){var e;if(!u.allowCreate||!m.value)return;const o=(e=u.categorias[0])==null?void 0:e.id;o&&(k("create",m.value,o),m.value="",p.value=!1)}function T(o){return{Tag:q,Hash:be,Bookmark:ve,Flag:_e,Star:pe,Heart:me,Zap:fe,Target:le,Award:ge,TrendingUp:he,Folder:oe,Package:ce,Box:de,Layers:xe,Grid:ue}[o]||q}return(o,e)=>(n(),c("div",we,[f.label?(n(),c("div",ke,[l(s(M),{for:S},{default:r(()=>[x(i(f.label),1)]),_:1}),d("span",Ce,i(_.value.length)+" / "+i(f.maxEtiquetas)+" seleccionadas ",1)])):v("",!0),l(s(w),{id:S,type:"button",onClick:e[0]||(e[0]=t=>p.value=!0),variant:"outline",role:"combobox","aria-expanded":p.value,disabled:f.disabled,class:"w-full justify-between"},{default:r(()=>[d("span",$e,i(I.value),1),l(s(ae),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:1},8,["aria-expanded","disabled"]),l(s(X),{open:p.value,"onUpdate:open":e[5]||(e[5]=t=>p.value=t)},{default:r(()=>[l(s(J),{class:"max-w-2xl max-h-[80vh] flex flex-col"},{default:r(()=>[l(s(K),null,{default:r(()=>[l(s(O),null,{default:r(()=>[...e[6]||(e[6]=[x("Seleccionar Etiquetas",-1)])]),_:1}),l(s(R),null,{default:r(()=>[x(" Selecciona hasta "+i(f.maxEtiquetas)+" etiquetas para categorizar ",1)]),_:1})]),_:1}),d("div",Ee,[l(s(se),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),l(s(Z),{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=t=>m.value=t),placeholder:"Buscar etiqueta...",class:"pl-10"},null,8,["modelValue"])]),d("div",Ve,[B.value.length===0?(n(),c("div",qe,[l(s(q),{class:"h-12 w-12 mx-auto mb-3 text-muted-foreground"}),d("p",Se,i(m.value?"No se encontraron etiquetas":"No hay etiquetas disponibles"),1),f.allowCreate&&m.value.length>2?(n(),g(s(w),{key:0,type:"button",onClick:P,variant:"ghost",size:"sm",class:"mt-2"},{default:r(()=>[l(s(ne),{class:"mr-2 h-3 w-3"}),x(' Crear "'+i(m.value)+'" ',1)]),_:1})):v("",!0)])):(n(),c("div",Be,[(n(!0),c(E,null,V(B.value,t=>(n(),g(s(Y),{key:t.id,open:b.value[t.id],"onUpdate:open":a=>b.value[t.id]=a},{default:r(()=>[l(s(te),{class:"flex items-center justify-between w-full p-3 hover:bg-muted/50 rounded-lg transition-colors"},{default:r(()=>[d("div",Ne,[t.icono?(n(),g(F(T(t.icono)),{key:0,class:"h-4 w-4 text-muted-foreground"})):v("",!0),d("span",Te,i(t.nombre),1),l(s(U),{variant:"secondary",class:"text-xs"},{default:r(()=>{var a;return[x(i(((a=t.etiquetas)==null?void 0:a.length)||0),1)]}),_:2},1024)]),l(s(re),{class:L(["h-4 w-4 text-muted-foreground transition-transform duration-200",{"rotate-180":b.value[t.id]}])},null,8,["class"])]),_:2},1024),l(s(ee),null,{default:r(()=>[d("div",Fe,[(n(!0),c(E,null,V(t.etiquetas,a=>(n(),c("div",{key:a.id,onClick:y=>D(a),class:L(["flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors",h(a.id)?"bg-primary/10":"hover:bg-muted",!N(a)&&!h(a.id)&&"opacity-50 cursor-not-allowed"])},[l(s(Q),{checked:h(a.id),disabled:!N(a),onClick:e[2]||(e[2]=G(()=>{},["stop"]))},null,8,["checked","disabled"]),d("span",Ue,i(a.nombre),1),a.parent?(n(),c("span",je," ("+i(a.parent.nombre)+") ",1)):v("",!0),a.descripcion?(n(),c("span",Ie,i(a.descripcion),1)):v("",!0)],10,Le))),128))])]),_:2},1024)]),_:2},1032,["open","onUpdate:open"]))),128))]))]),l(s(W),null,{default:r(()=>[d("div",De,[d("span",He,i(_.value.length)+" / "+i(f.maxEtiquetas)+" seleccionadas ",1),d("div",Pe,[l(s(w),{type:"button",variant:"outline",onClick:e[3]||(e[3]=t=>p.value=!1)},{default:r(()=>[...e[7]||(e[7]=[x(" Cancelar ",-1)])]),_:1}),l(s(w),{type:"button",onClick:e[4]||(e[4]=t=>p.value=!1)},{default:r(()=>[...e[8]||(e[8]=[x(" Aceptar ",-1)])]),_:1})])])]),_:1})]),_:1})]),_:1},8,["open"]),_.value.length>0?(n(),c("div",ze,[(n(!0),c(E,null,V(_.value,t=>(n(),g(s(U),{key:t.id,variant:"secondary",class:"pr-1"},{default:r(()=>{var a;return[(a=t.categoria)!=null&&a.icono?(n(),g(F(T(t.categoria.icono)),{key:0,class:"mr-1 h-3 w-3"})):v("",!0),x(" "+i(t.nombre)+" ",1),d("button",{onClick:y=>H(t.id),disabled:f.disabled,class:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[l(s(ie),{class:"h-3 w-3 hover:opacity-80"})],8,Ae)]}),_:2},1024))),128))])):v("",!0),f.description?(n(),c("p",Ge,i(f.description),1)):v("",!0)]))}}),ft=ye(Me,[["__scopeId","data-v-a0760241"]]);export{ft as E};
