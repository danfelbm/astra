import{k as T,q as W,d as Z,c as I,a as i,o,f as y,b as p,i as m,u as n,e as f,g as x,t as c,n as K,F as z,r as N,j as E,h as J,K as oe,w as X}from"./app-adm4E9By.js";import{c as re,_ as P}from"./createLucideIcon-BZexDsQJ.js";import{_ as G,c as ae,a as ne}from"./CardTitle.vue_vue_type_script_setup_true_lang-ouwQQD5O.js";import{_ as U}from"./Label.vue_vue_type_script_setup_true_lang-U1PsHnlq.js";import{U as ie}from"./upload-BmKGueyB.js";import{E as de}from"./eye-DpvTalqH.js";import{D as ue}from"./download-BhlWgaEa.js";import{X as Q,_ as ce,a as me,b as pe,c as fe,d as ve,e as he}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CUlOaAYK.js";import{_ as se}from"./Checkbox.vue_vue_type_script_setup_true_lang-JizJBHFY.js";import{_ as H}from"./Input.vue_vue_type_script_setup_true_lang-DPeax23E.js";import{_ as ye}from"./Textarea.vue_vue_type_script_setup_true_lang-BVFP9d73.js";import{_ as be,a as _e,b as ge,c as $e,d as ke}from"./SelectValue.vue_vue_type_script_setup_true_lang-COAsKRo-.js";import{C as we}from"./calendar-W5yOTorW.js";import{P as xe}from"./plus-mxdiJDdT.js";import{G as Fe}from"./grip-vertical-C7iH4eI-.js";import{T as De}from"./trash-2-DB0L4lLl.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=re("FileIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);function Ce(){const F=T(!1),S=T({}),u=T(new Map),v=()=>{const e=window.location.pathname;return e.startsWith("/admin")?"/admin":e.startsWith("/miembro")?"/miembro":""};return{isUploading:F,uploadProgress:S,uploadErrors:u,uploadFiles:async(e,a)=>{var d,r;F.value=!0,u.value.clear();const t=new FormData;e.forEach(b=>{t.append("files[]",b)}),t.append("module",a.module),t.append("field_id",a.fieldId);try{const b=await W.post(`${v()}/api/files/upload`,t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:s=>{if(s.total){const g=Math.round(s.loaded*100/s.total);e.forEach(C=>{S.value[C.name]=g,a.onProgress&&a.onProgress(C.name,g)})}}});if(b.data.success)return a.onSuccess&&a.onSuccess(b.data.files),b.data.files;throw new Error(b.data.message||"Error al subir archivos")}catch(b){const s=((r=(d=b.response)==null?void 0:d.data)==null?void 0:r.message)||b.message||"Error desconocido al subir archivos";throw e.forEach(g=>{u.value.set(g.name,s)}),a.onError&&a.onError(b),b}finally{F.value=!1,setTimeout(()=>{S.value={}},2e3)}},deleteFile:async e=>{try{return(await W.delete(`${v()}/api/files/delete`,{data:{path:e}})).data.success}catch(a){return console.error("Error al eliminar archivo:",a),!1}},downloadFile:async(e,a)=>{try{const t=await W.get(`${v()}/api/files/download`,{params:{path:e},responseType:"blob"}),d=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=d,r.setAttribute("download",a||e.split("/").pop()||"archivo"),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(d)}catch(t){throw console.error("Error al descargar archivo:",t),t}},getFileInfo:async e=>{try{const a=await W.get(`${v()}/api/files/info`,{params:{path:e}});return a.data.success?a.data.file:null}catch(a){return console.error("Error al obtener información del archivo:",a),null}},validateFileType:(e,a)=>{var r;const t=a.split(",").map(b=>b.trim().toLowerCase()),d="."+((r=e.name.split(".").pop())==null?void 0:r.toLowerCase());return t.some(b=>b===d)},validateFileSize:(e,a)=>{const t=a*1024*1024;return e.size<=t},formatFileSize:e=>{if(e===0)return"0 Bytes";const a=1024,t=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(e)/Math.log(a));return Math.round(e/Math.pow(a,d)*100)/100+" "+t[d]}}}const Se={class:"space-y-2"},Ae={key:0,class:"text-red-500 ml-1"},Me={key:0,class:"text-sm text-muted-foreground"},Ee={class:"flex flex-col items-center justify-center text-center"},Be={class:"text-sm font-medium mb-1"},Ue={class:"text-xs text-muted-foreground"},ze=["multiple","accept","disabled"],Te={key:0,class:"space-y-2"},Ie={class:"space-y-2"},Ve={class:"flex items-center justify-between"},qe={class:"flex items-center space-x-3 flex-1"},Pe={class:"min-w-0 flex-1"},je={class:"text-sm font-medium truncate"},Le={key:0,class:"text-xs text-muted-foreground"},Re={class:"flex items-center space-x-2"},Ye={key:1,class:"space-y-2"},Ne={class:"space-y-2"},He={class:"space-y-2"},Oe={class:"flex items-center justify-between"},We={class:"flex items-center space-x-3 flex-1"},Ge=["src","alt"],Ke={class:"min-w-0 flex-1"},Xe={class:"text-sm font-medium truncate"},Ze={class:"text-xs text-muted-foreground"},Je={key:0,class:"w-full space-y-1"},Qe={class:"flex justify-between text-xs text-muted-foreground"},et={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden"},tt={key:1,class:"text-xs text-red-600"},at={key:2,class:"text-sm text-red-600"},st={key:3,class:"text-xs text-muted-foreground"},lt={key:0},ca=Z({__name:"FileUploadField",props:{modelValue:{},label:{},description:{},required:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},maxFiles:{default:5},maxFileSize:{default:10},accept:{default:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif"},error:{},disabled:{type:Boolean,default:!1},showPreview:{type:Boolean,default:!0},module:{default:"postulaciones"},fieldId:{default:"file"},autoUpload:{type:Boolean,default:!0}},emits:["update:modelValue","filesSelected"],setup(F,{expose:S,emit:u}){const v=F,h=u,{isUploading:$,uploadFiles:B,deleteFile:V,formatFileSize:D}=Ce(),q=T(),k=T([]),e=T(new Map),a=T(new Map),t=T(new Map);T(!1);const d=I(()=>v.modelValue?v.modelValue.length>0&&typeof v.modelValue[0]=="string"?v.modelValue.map((l,w)=>({id:`existing_${w}`,name:l.split("/").pop()||"archivo",size:0,path:l,url:`/storage/${l}`})):v.modelValue:[]),r=I(()=>{const l=d.value.length+k.value.length;return v.multiple?l<v.maxFiles:l===0}),b=I(()=>v.accept.split(",").map(l=>l.trim().toLowerCase())),s=()=>{var l;!v.disabled&&r.value&&((l=q.value)==null||l.click())},g=l=>{var _;const w="."+((_=l.name.split(".").pop())==null?void 0:_.toLowerCase());return b.value.some(A=>A===w)},C=l=>{const w=v.maxFileSize*1024*1024;return l.size<=w},R=async l=>{const w=l.target,_=Array.from(w.files||[]);t.value.clear();const A=[];if(_.forEach(M=>{if(!g(M)){t.value.set(M.name,`Tipo de archivo no permitido. Solo se permiten: ${v.accept}`);return}if(!C(M)){t.value.set(M.name,`El archivo excede el tamaño máximo de ${v.maxFileSize}MB`);return}const Y=d.value.length+A.length;if(v.multiple&&Y>=v.maxFiles){t.value.set(M.name,`Se ha alcanzado el límite de ${v.maxFiles} archivos`);return}if(A.push(M),M.type.startsWith("image/")&&v.showPreview){const L=new FileReader;L.onload=le=>{var ee;e.value.set(M.name,(ee=le.target)==null?void 0:ee.result)},L.readAsDataURL(M)}}),v.multiple?k.value=[...k.value,...A]:k.value=A.slice(0,1),A.length>0&&(h("filesSelected",A),v.autoUpload&&v.module&&v.fieldId))try{const M=await B(A,{module:v.module,fieldId:v.fieldId,onProgress:(Y,L)=>{a.value.set(Y,L)},onSuccess:Y=>{const L=[...d.value,...Y];h("update:modelValue",L),k.value=[],e.value.clear()},onError:Y=>{console.error("Error al subir archivos:",Y),A.forEach(L=>{t.value.set(L.name,"Error al subir el archivo")})}})}catch(M){console.error("Error en carga automática:",M)}w.value=""},j=l=>{const w=k.value[l];e.value.delete(w.name),a.value.delete(w.name),t.value.delete(w.name),k.value.splice(l,1)},O=async l=>{const w=d.value[l];if(w.path)try{await V(w.path)}catch(A){console.error("Error al eliminar archivo del servidor:",A)}const _=[...d.value];if(_.splice(l,1),typeof v.modelValue[0]=="string"){const A=_.map(M=>M.path).filter(Boolean);h("update:modelValue",A)}else h("update:modelValue",_)};return S({selectedFiles:k,uploadProgress:a,uploadErrors:t}),(l,w)=>(o(),i("div",Se,[y("div",null,[p(n(U),{class:"text-sm font-medium"},{default:f(()=>[x(c(l.label)+" ",1),l.required?(o(),i("span",Ae,"*")):m("",!0)]),_:1}),l.description?(o(),i("p",Me,c(l.description),1)):m("",!0)]),p(n(G),{class:K(["border-2 border-dashed hover:border-primary/50 transition-colors cursor-pointer",{"opacity-50 cursor-not-allowed":l.disabled||!r.value||n($),"border-red-300":l.error}]),onClick:s},{default:f(()=>[p(n(ae),{class:"p-6"},{default:f(()=>[y("div",Ee,[p(n(ie),{class:"h-10 w-10 text-muted-foreground mb-3"}),y("p",Be,c(n($)?"Subiendo archivos...":r.value?"Haz clic para seleccionar archivos":"Límite de archivos alcanzado"),1),y("p",Ue,c(l.multiple?`Hasta ${l.maxFiles} archivos`:"Un archivo")+" • Máx. "+c(l.maxFileSize)+"MB • Formatos: "+c(l.accept),1)])]),_:1})]),_:1},8,["class"]),y("input",{ref_key:"fileInputRef",ref:q,type:"file",multiple:l.multiple,accept:l.accept,disabled:l.disabled||!r.value||n($),onChange:R,class:"hidden"},null,40,ze),d.value.length>0?(o(),i("div",Te,[p(n(U),{class:"text-xs text-muted-foreground"},{default:f(()=>w[0]||(w[0]=[x("Archivos cargados:")])),_:1}),y("div",Ie,[(o(!0),i(z,null,N(d.value,(_,A)=>(o(),E(n(G),{key:_.id,class:"p-3"},{default:f(()=>[y("div",Ve,[y("div",qe,[p(n(te),{class:"h-5 w-5 text-muted-foreground flex-shrink-0"}),y("div",Pe,[y("p",je,c(_.name),1),_.size>0?(o(),i("p",Le,c(n(D)(_.size)),1)):m("",!0)])]),y("div",Re,[_.url?(o(),E(n(P),{key:0,type:"button",variant:"ghost",size:"sm",onClick:J(M=>l.window.open(_.url,"_blank"),["stop"])},{default:f(()=>[p(n(de),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):m("",!0),_.url?(o(),E(n(P),{key:1,type:"button",variant:"ghost",size:"sm",onClick:J(M=>l.window.open(_.url+"?download=true","_blank"),["stop"])},{default:f(()=>[p(n(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):m("",!0),l.disabled?m("",!0):(o(),E(n(P),{key:2,type:"button",variant:"ghost",size:"sm",onClick:J(M=>O(A),["stop"])},{default:f(()=>[p(n(Q),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick"]))])])]),_:2},1024))),128))])])):m("",!0),k.value.length>0?(o(),i("div",Ye,[p(n(U),{class:"text-xs text-muted-foreground"},{default:f(()=>[x(c(a.value.size>0?"Subiendo archivos...":"Archivos pendientes de carga:"),1)]),_:1}),y("div",Ne,[(o(!0),i(z,null,N(k.value,(_,A)=>(o(),E(n(G),{key:_.name,class:K(["p-3",{"border-red-300":t.value.has(_.name)}])},{default:f(()=>[y("div",He,[y("div",Oe,[y("div",We,[e.value.has(_.name)&&l.showPreview?(o(),i("img",{key:0,src:e.value.get(_.name),alt:_.name,class:"h-10 w-10 object-cover rounded flex-shrink-0"},null,8,Ge)):(o(),E(n(te),{key:1,class:"h-5 w-5 text-muted-foreground flex-shrink-0"})),y("div",Ke,[y("p",Xe,c(_.name),1),y("p",Ze,c(n(D)(_.size)),1)])]),l.disabled?m("",!0):(o(),E(n(P),{key:0,type:"button",variant:"ghost",size:"sm",onClick:M=>j(A)},{default:f(()=>[p(n(Q),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick"]))]),a.value.has(_.name)?(o(),i("div",Je,[y("div",Qe,[w[1]||(w[1]=y("span",null,"Subiendo...",-1)),y("span",null,c(a.value.get(_.name))+"%",1)]),y("div",et,[y("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 h-2 rounded-full transition-all duration-300 ease-out",style:oe({width:`${a.value.get(_.name)}%`})},w[2]||(w[2]=[y("div",{class:"h-full bg-white/30 animate-pulse"},null,-1)]),4)])])):m("",!0),t.value.has(_.name)?(o(),i("p",tt,c(t.value.get(_.name)),1)):m("",!0)])]),_:2},1032,["class"]))),128))])])):m("",!0),l.error?(o(),i("p",at,c(l.error),1)):m("",!0),!l.disabled&&r.value?(o(),i("div",st,[l.multiple?(o(),i("p",lt,c(d.value.length+k.value.length)+" de "+c(l.maxFiles)+" archivos ",1)):m("",!0)])):m("",!0)]))}}),ot={class:"space-y-2"},rt={key:0,class:"text-red-500 ml-1"},nt={key:1,class:"text-sm text-muted-foreground"},it={class:"relative"},dt={class:"flex gap-2"},ut={class:"flex-1 relative"},ct={key:0,class:"text-xs text-muted-foreground mt-1"},mt=["id"],pt={key:3,class:"text-xs text-muted-foreground space-y-1"},ft={key:0},vt={key:1},ht={key:2},yt={key:3},bt=Z({__name:"DatePickerField",props:{modelValue:{},label:{},description:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{},minDate:{},maxDate:{},format:{default:"DD/MM/YYYY"},allowPastDates:{type:Boolean,default:!0},allowFutureDates:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(F,{emit:S}){const u=F,v=S,h=I({get:()=>{if(!u.modelValue)return"";let e;if(u.modelValue instanceof Date?e=u.modelValue:e=new Date(u.modelValue),isNaN(e.getTime()))return"";const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0");return`${a}-${t}-${d}`},set:e=>{if(!e){v("update:modelValue",null);return}const a=new Date(e),t=new Date;t.setHours(0,0,0,0),a.setHours(0,0,0,0),!(!u.allowPastDates&&a<t)&&(!u.allowFutureDates&&a>t||v("update:modelValue",e))}}),$=I(()=>u.minDate?u.minDate:u.allowPastDates?"":new Date().toISOString().split("T")[0]),B=I(()=>u.maxDate?u.maxDate:u.allowFutureDates?"":new Date().toISOString().split("T")[0]),V=e=>{if(!e)return"";try{const[a,t,d]=e.split("-");return u.format==="DD/MM/YYYY"?`${d}/${t}/${a}`:e}catch(a){return console.error("Error al formatear fecha:",a),e}},D=I(()=>h.value?V(h.value):""),q=()=>{v("update:modelValue",null)},k=`datepicker-${Math.random().toString(36).substr(2,9)}`;return(e,a)=>(o(),i("div",ot,[e.label?(o(),E(n(U),{key:0,for:k,class:"text-sm font-medium"},{default:f(()=>[x(c(e.label)+" ",1),e.required?(o(),i("span",rt,"*")):m("",!0)]),_:1})):m("",!0),e.description?(o(),i("p",nt,c(e.description),1)):m("",!0),y("div",it,[y("div",dt,[y("div",ut,[p(n(H),{id:k,type:"date",modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=t=>h.value=t),disabled:e.disabled,min:$.value,max:B.value,class:K(["w-full",e.error?"border-red-300 focus:border-red-500":""]),"aria-invalid":!!e.error,"aria-describedby":e.error?`${k}-error`:void 0},null,8,["modelValue","disabled","min","max","class","aria-invalid","aria-describedby"]),p(n(we),{class:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"})]),!e.required&&h.value?(o(),E(n(P),{key:0,type:"button",variant:"outline",size:"icon",onClick:q,disabled:e.disabled,title:"Limpiar fecha"},{default:f(()=>[p(n(Q),{class:"h-4 w-4"})]),_:1},8,["disabled"])):m("",!0)]),D.value&&e.format!=="YYYY-MM-DD"?(o(),i("p",ct," Fecha seleccionada: "+c(D.value),1)):m("",!0)]),e.error?(o(),i("p",{key:2,id:`${k}-error`,class:"text-sm text-red-600"},c(e.error),9,mt)):m("",!0),!e.allowPastDates||!e.allowFutureDates||e.minDate||e.maxDate?(o(),i("div",pt,[!e.allowPastDates&&!e.minDate?(o(),i("p",ft," * No se permiten fechas pasadas ")):m("",!0),!e.allowFutureDates&&!e.maxDate?(o(),i("p",vt," * No se permiten fechas futuras ")):m("",!0),e.minDate?(o(),i("p",ht," * Fecha mínima: "+c(V(e.minDate)),1)):m("",!0),e.maxDate?(o(),i("p",yt," * Fecha máxima: "+c(V(e.maxDate)),1)):m("",!0)])):m("",!0)]))}}),_t={class:"space-y-2"},gt={class:"flex items-start space-x-3"},$t={class:"flex-1 space-y-1"},kt={key:0,class:"text-red-500 ml-1"},wt={key:0,class:"text-sm text-muted-foreground"},xt={key:1,class:"text-xs text-green-600"},Ft=["id"],Dt={class:"my-6 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700"},Ct=["innerHTML"],ma=Z({__name:"DisclaimerField",props:{modelValue:{type:[Boolean,Object,null]},label:{},description:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{},disclaimerText:{},modalTitle:{default:"Términos y Condiciones"},acceptButtonText:{default:"Acepto"},declineButtonText:{default:"No acepto"}},emits:["update:modelValue"],setup(F,{emit:S}){const u=F,v=S,h=T(!1),$=T(!1),B=T(null);u.modelValue&&(typeof u.modelValue=="boolean"?$.value=u.modelValue:typeof u.modelValue=="object"&&u.modelValue.accepted&&($.value=u.modelValue.accepted,B.value=u.modelValue.timestamp||null)),X(()=>u.modelValue,a=>{a?typeof a=="boolean"?$.value=a:typeof a=="object"&&a.accepted!==void 0&&($.value=a.accepted,B.value=a.timestamp||null):($.value=!1,B.value=null)});const V=a=>{a&&!$.value&&!u.disabled?h.value=!0:a||q()},D=()=>{$.value=!0,B.value=new Date().toISOString(),v("update:modelValue",{accepted:!0,timestamp:B.value}),h.value=!1},q=()=>{$.value=!1,B.value=null,v("update:modelValue",null),h.value=!1},k=`disclaimer-${Math.random().toString(36).substr(2,9)}`,e=a=>new Date(a).toLocaleString("es-CO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(a,t)=>(o(),i("div",_t,[y("div",gt,[p(n(se),{id:k,checked:$.value,"onUpdate:checked":V,disabled:a.disabled,"aria-invalid":!!a.error,"aria-describedby":a.error?`${k}-error`:void 0,class:"mt-1"},null,8,["checked","disabled","aria-invalid","aria-describedby"]),y("div",$t,[p(n(U),{for:k,class:"text-sm font-medium cursor-pointer leading-relaxed",onClick:t[0]||(t[0]=()=>!a.disabled&&!$.value&&(h.value=!0))},{default:f(()=>[x(c(a.label)+" ",1),a.required?(o(),i("span",kt,"*")):m("",!0)]),_:1}),a.description?(o(),i("p",wt,c(a.description),1)):m("",!0),$.value&&B.value?(o(),i("p",xt," ✓ Aceptado el "+c(e(B.value)),1)):m("",!0),a.disabled?m("",!0):(o(),i("button",{key:2,type:"button",onClick:t[1]||(t[1]=d=>h.value=!0),class:"text-xs text-blue-600 hover:text-blue-800 underline"},c($.value?"Ver términos aceptados":"Leer términos y condiciones"),1))])]),a.error?(o(),i("p",{key:0,id:`${k}-error`,class:"text-sm text-red-600 ml-6"},c(a.error),9,Ft)):m("",!0),p(n(ce),{open:h.value,"onUpdate:open":t[3]||(t[3]=d=>h.value=d)},{default:f(()=>[p(n(me),{class:"max-w-2xl max-h-[80vh] overflow-y-auto"},{default:f(()=>[p(n(pe),null,{default:f(()=>[p(n(fe),null,{default:f(()=>[x(c(a.modalTitle),1)]),_:1}),p(n(ve),null,{default:f(()=>t[4]||(t[4]=[x(" Por favor, lea atentamente los siguientes términos y condiciones: ")])),_:1})]),_:1}),y("div",Dt,[y("div",{class:"prose prose-sm dark:prose-invert max-w-none whitespace-pre-wrap",innerHTML:a.disclaimerText},null,8,Ct)]),p(n(he),{class:"flex gap-2 sm:gap-0"},{default:f(()=>[!$.value||!a.disabled?(o(),E(n(P),{key:0,type:"button",variant:"outline",onClick:q,disabled:a.disabled},{default:f(()=>[x(c(a.declineButtonText),1)]),_:1},8,["disabled"])):m("",!0),!$.value||!a.disabled?(o(),E(n(P),{key:1,type:"button",onClick:D,disabled:a.disabled},{default:f(()=>[x(c(a.acceptButtonText),1)]),_:1},8,["disabled"])):m("",!0),$.value&&a.disabled?(o(),E(n(P),{key:2,type:"button",variant:"outline",onClick:t[2]||(t[2]=d=>h.value=!1)},{default:f(()=>t[5]||(t[5]=[x(" Cerrar ")])),_:1})):m("",!0)]),_:1})]),_:1})]),_:1},8,["open"])]))}}),St={class:"space-y-4"},At={key:0,class:"text-red-500 ml-1"},Mt={key:0,class:"text-sm text-muted-foreground mt-1"},Et={key:1,class:"text-xs text-muted-foreground mt-1"},Bt={class:"space-y-3"},Ut={class:"flex items-center justify-between"},zt={class:"flex items-center gap-2"},Tt={class:"text-sm font-medium"},It={key:0,class:"text-red-500 ml-1"},Vt={key:0,class:"text-red-500 ml-1"},qt={key:0,class:"text-red-500 ml-1"},Pt={key:0,class:"text-red-500 ml-1"},jt={key:0,class:"text-red-500 ml-1"},Lt={key:0,class:"text-red-500 ml-1"},Rt={key:0,class:"text-red-500 ml-1"},Yt={class:"space-y-2"},Nt=["id","name","value","checked","onChange","disabled"],Ht={key:0,class:"text-red-500 ml-1"},Ot={class:"space-y-2"},Wt={key:1,class:"text-sm text-muted-foreground text-center"},Gt={key:2,class:"text-sm text-red-600"},pa=Z({__name:"RepeaterField",props:{modelValue:{},label:{},description:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{},minItems:{default:0},maxItems:{default:10},itemName:{default:"Elemento"},addButtonText:{default:"Agregar elemento"},removeButtonText:{default:"Eliminar"},fields:{}},emits:["update:modelValue"],setup(F,{emit:S}){const u=F,v=S,h=T([]);if(u.modelValue&&Array.isArray(u.modelValue))h.value=u.modelValue;else if(u.minItems>0)for(let t=0;t<u.minItems;t++)h.value.push($());X(()=>u.modelValue,t=>{t&&Array.isArray(t)&&(h.value=t)}),X(h,t=>{v("update:modelValue",t)},{deep:!0});function $(){const t={id:`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,data:{}};return u.fields.forEach(d=>{d.type==="checkbox"?t.data[d.id]=[]:d.type==="repeater"?t.data[d.id]=[]:t.data[d.id]=""}),t}const B=()=>{h.value.length<u.maxItems&&h.value.push($())},V=t=>{h.value.length>u.minItems&&h.value.splice(t,1)},D=(t,d,r)=>{h.value[t]&&(h.value[t].data[d]=r)},q=(t,d,r,b)=>{const s=h.value[t].data[d]||[];let g;b?g=[...s,r]:g=s.filter(C=>C!==r),D(t,d,g)},k=I(()=>h.value.length<u.maxItems),e=I(()=>h.value.length>u.minItems),a=I(()=>{const t=[];return u.minItems>0&&t.push(`Mínimo ${u.minItems} elemento${u.minItems>1?"s":""}`),u.maxItems<1/0&&t.push(`Máximo ${u.maxItems} elemento${u.maxItems>1?"s":""}`),t.length>0?t.join(" | "):""});return(t,d)=>(o(),i("div",St,[y("div",null,[p(n(U),{class:"text-base font-semibold"},{default:f(()=>[x(c(t.label)+" ",1),t.required?(o(),i("span",At,"*")):m("",!0)]),_:1}),t.description?(o(),i("p",Mt,c(t.description),1)):m("",!0),a.value?(o(),i("p",Et,c(a.value),1)):m("",!0)]),y("div",Bt,[(o(!0),i(z,null,N(h.value,(r,b)=>(o(),E(n(G),{key:r.id,class:K(["relative",[t.disabled?"opacity-60":""]])},{default:f(()=>[p(n(ne),{class:"pb-3"},{default:f(()=>[y("div",Ut,[y("div",zt,[p(n(Fe),{class:"h-4 w-4 text-muted-foreground"}),y("span",Tt,c(t.itemName)+" "+c(b+1),1)]),e.value?(o(),E(n(P),{key:0,type:"button",variant:"ghost",size:"sm",onClick:s=>V(b),disabled:t.disabled,class:"h-8 px-2"},{default:f(()=>[p(n(De),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick","disabled"])):m("",!0)])]),_:2},1024),p(n(ae),{class:"space-y-4"},{default:f(()=>[(o(!0),i(z,null,N(t.fields,s=>{var g,C,R,j,O;return o(),i("div",{key:s.id,class:"space-y-2"},[s.type==="text"?(o(),i(z,{key:0},[p(n(U),{for:`${r.id}-${s.id}`,class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",It,"*")):m("",!0)]),_:2},1032,["for"]),p(n(H),{id:`${r.id}-${s.id}`,"model-value":r.data[s.id]||"","onUpdate:modelValue":l=>D(b,s.id,l),placeholder:s.description,disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","placeholder","disabled"])],64)):s.type==="textarea"?(o(),i(z,{key:1},[p(n(U),{for:`${r.id}-${s.id}`,class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",Vt,"*")):m("",!0)]),_:2},1032,["for"]),p(n(ye),{id:`${r.id}-${s.id}`,"model-value":r.data[s.id]||"","onUpdate:modelValue":l=>D(b,s.id,l),placeholder:s.description,disabled:t.disabled,rows:"3"},null,8,["id","model-value","onUpdate:modelValue","placeholder","disabled"])],64)):s.type==="number"?(o(),i(z,{key:2},[p(n(U),{for:`${r.id}-${s.id}`,class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",qt,"*")):m("",!0)]),_:2},1032,["for"]),p(n(H),{id:`${r.id}-${s.id}`,type:"number","model-value":r.data[s.id]||"","onUpdate:modelValue":l=>D(b,s.id,l),placeholder:s.description,disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","placeholder","disabled"])],64)):s.type==="email"?(o(),i(z,{key:3},[p(n(U),{for:`${r.id}-${s.id}`,class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",Pt,"*")):m("",!0)]),_:2},1032,["for"]),p(n(H),{id:`${r.id}-${s.id}`,type:"email","model-value":r.data[s.id]||"","onUpdate:modelValue":l=>D(b,s.id,l),placeholder:"ejemplo@correo.com",disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","disabled"])],64)):s.type==="date"?(o(),i(z,{key:4},[p(n(U),{for:`${r.id}-${s.id}`,class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",jt,"*")):m("",!0)]),_:2},1032,["for"]),p(n(H),{id:`${r.id}-${s.id}`,type:"date","model-value":r.data[s.id]||"","onUpdate:modelValue":l=>D(b,s.id,l),disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","disabled"])],64)):s.type==="datepicker"?(o(),E(bt,{key:5,"model-value":r.data[s.id]||null,"onUpdate:modelValue":l=>D(b,s.id,l),label:s.title,description:s.description,required:s.required,disabled:t.disabled,minDate:(g=s.datepickerConfig)==null?void 0:g.minDate,maxDate:(C=s.datepickerConfig)==null?void 0:C.maxDate,format:(R=s.datepickerConfig)==null?void 0:R.format,allowPastDates:(j=s.datepickerConfig)==null?void 0:j.allowPastDates,allowFutureDates:(O=s.datepickerConfig)==null?void 0:O.allowFutureDates},null,8,["model-value","onUpdate:modelValue","label","description","required","disabled","minDate","maxDate","format","allowPastDates","allowFutureDates"])):s.type==="select"?(o(),i(z,{key:6},[p(n(U),{for:`${r.id}-${s.id}`,class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",Lt,"*")):m("",!0)]),_:2},1032,["for"]),p(n(be),{"model-value":r.data[s.id]||"","onUpdate:modelValue":l=>D(b,s.id,l),disabled:t.disabled},{default:f(()=>[p(n(_e),null,{default:f(()=>[p(n(ge),{placeholder:`Seleccionar ${s.title.toLowerCase()}`},null,8,["placeholder"])]),_:2},1024),p(n($e),null,{default:f(()=>[(o(!0),i(z,null,N(s.options,l=>(o(),E(n(ke),{key:l,value:l},{default:f(()=>[x(c(l),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["model-value","onUpdate:modelValue","disabled"])],64)):s.type==="radio"?(o(),i(z,{key:7},[p(n(U),{class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",Rt,"*")):m("",!0)]),_:2},1024),y("div",Yt,[(o(!0),i(z,null,N(s.options,l=>(o(),i("div",{key:l,class:"flex items-center space-x-2"},[y("input",{id:`${r.id}-${s.id}-${l}`,type:"radio",name:`${r.id}-${s.id}`,value:l,checked:r.data[s.id]===l,onChange:()=>D(b,s.id,l),disabled:t.disabled,class:"h-4 w-4"},null,40,Nt),p(n(U),{for:`${r.id}-${s.id}-${l}`,class:"text-sm font-normal"},{default:f(()=>[x(c(l),1)]),_:2},1032,["for"])]))),128))])],64)):s.type==="checkbox"?(o(),i(z,{key:8},[p(n(U),{class:"text-sm"},{default:f(()=>[x(c(s.title)+" ",1),s.required?(o(),i("span",Ht,"*")):m("",!0)]),_:2},1024),y("div",Ot,[(o(!0),i(z,null,N(s.options,l=>(o(),i("div",{key:l,class:"flex items-center space-x-2"},[p(n(se),{id:`${r.id}-${s.id}-${l}`,checked:(r.data[s.id]||[]).includes(l),"onUpdate:checked":w=>q(b,s.id,l,w),disabled:t.disabled},null,8,["id","checked","onUpdate:checked","disabled"]),p(n(U),{for:`${r.id}-${s.id}-${l}`,class:"text-sm font-normal"},{default:f(()=>[x(c(l),1)]),_:2},1032,["for"])]))),128))])],64)):m("",!0)])}),128))]),_:2},1024)]),_:2},1032,["class"]))),128))]),k.value?(o(),E(n(P),{key:0,type:"button",variant:"outline",onClick:B,disabled:t.disabled,class:"w-full"},{default:f(()=>[p(n(xe),{class:"h-4 w-4 mr-2"}),x(" "+c(t.addButtonText),1)]),_:1},8,["disabled"])):m("",!0),k.value?m("",!0):(o(),i("p",Wt," Has alcanzado el límite máximo de "+c(t.maxItems)+" elementos ",1)),t.error?(o(),i("p",Gt,c(t.error),1)):m("",!0)]))}});function fa(F,S){const u=T(new Map);X(S,()=>{u.value.clear()},{deep:!0});const v=(e,a,t)=>{const d=r=>r==null?"":typeof r=="boolean"?r?"true":"false":String(r);switch(a){case"equals":return Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every(r=>t.includes(r)):d(e)===d(t);case"not_equals":return Array.isArray(e)&&Array.isArray(t)?e.length!==t.length||!e.every(r=>t.includes(r)):d(e)!==d(t);case"contains":return Array.isArray(e)?Array.isArray(t)?t.some(r=>e.includes(r)):e.includes(t):d(e).includes(d(t));case"not_contains":return Array.isArray(e)?Array.isArray(t)?!t.some(r=>e.includes(r)):!e.includes(t):!d(e).includes(d(t));case"is_empty":return Array.isArray(e)?e.length===0:!e||d(e)==="";case"is_not_empty":return Array.isArray(e)?e.length>0:!!e&&d(e)!=="";default:return console.warn(`Operador condicional no soportado: ${a}`),!0}},h=e=>{var s;if(!((s=e.conditionalConfig)!=null&&s.enabled))return!0;const a=e.id;if(u.value.has(a))return u.value.get(a);const{showWhen:t,conditions:d}=e.conditionalConfig;if(!d||d.length===0)return!0;const r=d.map(g=>{const C=S.value[g.fieldId];return v(C,g.operator,g.value)}),b=t==="all"?r.every(g=>g):r.some(g=>g);return u.value.set(a,b),b},$=I(()=>F.value.filter(e=>h(e)));return{evaluateCondition:v,shouldShowField:h,visibleFields:$,getDependentFields:e=>F.value.filter(a=>{var t;return(t=a.conditionalConfig)!=null&&t.enabled?a.conditionalConfig.conditions.some(d=>d.fieldId===e):!1}),validateConditionalRules:e=>{var b;const a=[];if(!((b=e.conditionalConfig)!=null&&b.enabled))return a;e.conditionalConfig.conditions.some(s=>s.fieldId===e.id)&&a.push(`El campo "${e.title}" no puede depender de sí mismo`),e.conditionalConfig.conditions.forEach(s=>{const g=F.value.find(C=>C.id===s.fieldId);g?["select","radio","checkbox"].includes(g.type)||a.push(`El campo "${e.title}" depende de "${g.title}" que no es de tipo select, radio o checkbox`):a.push(`El campo "${e.title}" hace referencia a un campo inexistente: ${s.fieldId}`)});const d=new Set,r=(s,g=[])=>{var R;if(g.includes(s))return a.push(`Referencia circular detectada: ${[...g,s].join(" → ")}`),!0;if(d.has(s))return!1;d.add(s);const C=F.value.find(j=>j.id===s);if(!((R=C==null?void 0:C.conditionalConfig)!=null&&R.enabled))return!1;for(const j of C.conditionalConfig.conditions)r(j.fieldId,[...g,s]);return!1};return r(e.id),a},getAvailableSourceFields:e=>F.value.filter(a=>a.id===e?!1:["select","radio","checkbox"].includes(a.type)),getFieldOptions:e=>{const a=F.value.find(t=>t.id===e);return a?a.options&&a.options.length>0?a.options:a.type==="checkbox"?["checked","unchecked"]:[]:[]},clearHiddenFieldValues:()=>{F.value.forEach(e=>{h(e)||(e.type==="checkbox"?S.value[e.id]=[]:e.type==="repeater"?S.value[e.id]=[]:e.type==="disclaimer"?S.value[e.id]=null:S.value[e.id]="")})},evaluationCache:I(()=>u.value)}}export{ca as _,bt as a,ma as b,pa as c,Ce as d,fa as u};
