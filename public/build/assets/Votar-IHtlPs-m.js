import{d as w,C,k as D,c as b,a as E,o as z,b as i,u as e,m as k,e as s,f as a,t as m,g as l,n as F,h as B,F as q,W as L}from"./app-CZVAIQ2j.js";import{_ as S}from"./index-Ca9vCh23.js";import{_ as h}from"./createLucideIcon-BxKKonsI.js";import{_ as x,c as $,a as U,b as N}from"./CardTitle.vue_vue_type_script_setup_true_lang-FpzMwRGj.js";import{_ as P,a as R,b as j,c as W,d as H,e as I,f as Z,g as J}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-ISiaVLWv.js";import{_ as K}from"./UserLayout.vue_vue_type_script_setup_true_lang-Ce6E6opB.js";import{D as O}from"./DynamicFormRenderer-C3vf7oSh.js";import{A as Q}from"./arrow-left-D9r11IcI.js";import{C as X}from"./clock-p5N4RGrV.js";import{T as Y}from"./triangle-alert-BOrY6wui.js";import{V as A}from"./vote-BbAZHbdL.js";import"./index-D3qaEgis.js";import"./VisuallyHidden-r3WkqmHs.js";import"./Input.vue_vue_type_script_setup_true_lang-DUqjSIWB.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CQ7UCZ-F.js";import"./PopperContent-B74AR3_x.js";import"./floating-ui.vue-ChS3Pls3.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-4aMsC9XF.js";import"./check-mlGdLtMP.js";import"./nullish-CHIgUVhi.js";import"./x-lxNEdBJ-.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-Dtm1UlW3.js";import"./index-CGt0dgIA.js";import"./shield-CutgDwZP.js";import"./user-COzEv5xc.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B5FKbIli.js";import"./Label.vue_vue_type_script_setup_true_lang-B8ojZqIO.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Bo1dE-Lv.js";import"./index-GrVQiRvY.js";import"./circle-alert-UNJr2893.js";import"./map-pin-JV2Idhmv.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CE_qzYXH.js";import"./square-check-big-DxvCxcI_.js";import"./file-text-1p13N2Vy.js";import"./users-C-BhDct3.js";import"./index-C4IMxQzW.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-BCccZNs6.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BeTKplQH.js";import"./Textarea.vue_vue_type_script_setup_true_lang-Caz7yP_R.js";import"./plus-B8VIWw35.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-B5FmBwHf.js";import"./RovingFocusItem-BLU8L_Mt.js";import"./utils-DI-9FNf9.js";import"./VisuallyHiddenInput-D0N4NXKw.js";import"./useConditionalFields-D7LeoXLp.js";import"./upload-DJv2xbSV.js";import"./eye-CGxpylke.js";import"./download-BbHG2hvH.js";import"./calendar-DplaDJ7W.js";import"./grip-vertical-ClMI04xg.js";import"./trash-2-B7VXvzqJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oo={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},to={class:"flex items-center justify-between"},eo={class:"text-3xl font-bold"},io={class:"text-muted-foreground"},ao={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},so={class:"flex items-center gap-2"},ro={class:"flex items-center gap-2 text-sm text-muted-foreground"},no={class:"flex items-center gap-2 text-sm"},mo={class:"mt-4 pt-4 border-t"},lo={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},co={class:"text-muted-foreground"},fo={class:"mt-1"},uo={class:"text-muted-foreground"},po={class:"mt-1 font-semibold text-primary"},_o={class:"text-xs text-muted-foreground ml-1"},vo={class:"flex justify-end pt-6 border-t"},vt=w({__name:"Votar",props:{votacion:{},candidatosElegibles:{}},setup(T){const r=T,M=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Votaciones",href:"/miembro/votaciones"},{title:"Votar",href:"#"}],c=C((()=>{const t={};return r.votacion.formulario_config.forEach(o=>{o.type==="checkbox"?t[o.id]=[]:t[o.id]=""}),{respuestas:t}})()),u=D(!1),y=()=>{c.post(route("user.votaciones.store",{votacion:r.votacion.id}),{onSuccess:()=>{},onError:t=>{console.error("Errores de validación:",t)}})},V=()=>{L.get(route("user.votaciones.index"))},v=t=>({"America/Bogota":"GMT-5","America/Mexico_City":"GMT-6","America/Lima":"GMT-5","America/Argentina/Buenos_Aires":"GMT-3","America/Santiago":"GMT-3","America/Caracas":"GMT-4","America/La_Paz":"GMT-4","America/Guayaquil":"GMT-5","America/Asuncion":"GMT-3","America/Montevideo":"GMT-3","America/Panama":"GMT-5","America/Costa_Rica":"GMT-6","America/Guatemala":"GMT-6","America/Havana":"GMT-5","America/Santo_Domingo":"GMT-4"})[t]||t,p=(t,o=!0)=>{const n=t.includes("local")?t:t===r.votacion.fecha_inicio&&r.votacion.fecha_inicio_local?r.votacion.fecha_inicio_local:t===r.votacion.fecha_fin&&r.votacion.fecha_fin_local?r.votacion.fecha_fin_local:t,d=new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(o&&r.votacion.timezone){const f=v(r.votacion.timezone);return`${d} (${f})`}return d},_=b(()=>{const t=new Date,n=new Date(r.votacion.fecha_fin_local||r.votacion.fecha_fin).getTime()-t.getTime();if(n<=0)return"Expirada";const d=Math.floor(n/(1e3*60*60)),f=Math.floor(n%(1e3*60*60)/(1e3*60));if(d>24){const g=Math.floor(d/24);return`${g} día${g>1?"s":""}`}else return d>0?`${d}h ${f}m`:`${f}m`}),G=b(()=>r.votacion.formulario_config.every(t=>{if(!t.required)return!0;const o=c.respuestas[t.id];return t.type==="checkbox"?Array.isArray(o)&&o.length>0:t.type==="convocatoria"?o!==""&&o!==void 0:o&&o.toString().trim()!==""}));return(t,o)=>(z(),E(q,null,[i(e(k),{title:`Votar: ${t.votacion.titulo}`},null,8,["title"]),i(K,{breadcrumbs:M},{default:s(()=>[a("div",oo,[a("div",to,[a("div",null,[a("h1",eo,m(t.votacion.titulo),1),a("p",io,m(t.votacion.descripcion),1)]),i(e(h),{variant:"outline",onClick:V},{default:s(()=>[i(e(Q),{class:"mr-2 h-4 w-4"}),o[3]||(o[3]=l(" Volver ",-1))]),_:1})]),i(e(x),null,{default:s(()=>[i(e($),{class:"pt-6"},{default:s(()=>[a("div",ao,[a("div",so,[i(e(S),{variant:"outline"},{default:s(()=>[l(m(t.votacion.categoria.nombre),1)]),_:1})]),a("div",ro,[i(e(X),{class:"h-4 w-4"}),l(" Termina: "+m(p(t.votacion.fecha_fin)),1)]),a("div",no,[i(e(Y),{class:"h-4 w-4 text-orange-600"}),a("span",{class:F(_.value==="Expirada"?"text-red-600":"text-orange-600")},m(_.value==="Expirada"?"Votación expirada":`Tiempo restante: ${_.value}`),3)])]),a("div",mo,[a("div",lo,[a("div",co,[o[4]||(o[4]=a("span",{class:"font-medium"},"Periodo de votación:",-1)),a("div",fo," Inicio: "+m(p(t.votacion.fecha_inicio)),1),a("div",null," Fin: "+m(p(t.votacion.fecha_fin)),1)]),a("div",uo,[o[5]||(o[5]=a("span",{class:"font-medium"},"Zona horaria:",-1)),a("div",po,[l(m(v(t.votacion.timezone))+" ",1),a("span",_o,"("+m(t.votacion.timezone)+")",1)])])])])]),_:1})]),_:1}),i(e(x),null,{default:s(()=>[i(e(U),null,{default:s(()=>[i(e(N),{class:"flex items-center gap-2"},{default:s(()=>[i(e(A),{class:"h-5 w-5"}),o[6]||(o[6]=l(" Formulario de Votación ",-1))]),_:1})]),_:1}),i(e($),null,{default:s(()=>[a("form",{onSubmit:o[1]||(o[1]=B(n=>u.value=!0,["prevent"])),class:"space-y-6"},[i(O,{fields:t.votacion.formulario_config,modelValue:e(c).respuestas,"onUpdate:modelValue":o[0]||(o[0]=n=>e(c).respuestas=n),"candidatos-elegibles":t.candidatosElegibles||{},errors:e(c).errors,disabled:e(c).processing,title:"",description:"",context:"votacion"},null,8,["fields","modelValue","candidatos-elegibles","errors","disabled"]),a("div",vo,[i(e(h),{type:"submit",disabled:!G.value||e(c).processing,class:"min-w-32"},{default:s(()=>[i(e(A),{class:"mr-2 h-4 w-4"}),l(" "+m(e(c).processing?"Enviando...":"Enviar Voto"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),i(e(P),{open:u.value,"onUpdate:open":o[2]||(o[2]=n=>u.value=n)},{default:s(()=>[i(e(R),null,{default:s(()=>[i(e(j),null,{default:s(()=>[i(e(W),null,{default:s(()=>[...o[7]||(o[7]=[l("¿Confirmar voto?",-1)])]),_:1}),i(e(H),null,{default:s(()=>[...o[8]||(o[8]=[l(" Una vez enviado tu voto, no podrás modificarlo. ¿Estás seguro de que quieres proceder? ",-1)])]),_:1})]),_:1}),i(e(I),null,{default:s(()=>[i(e(Z),null,{default:s(()=>[...o[9]||(o[9]=[l("Cancelar",-1)])]),_:1}),i(e(J),{onClick:y,class:"bg-primary"},{default:s(()=>[...o[10]||(o[10]=[l(" Confirmar Voto ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{vt as default};
