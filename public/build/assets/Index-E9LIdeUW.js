import{d as U,c as I,r as H,i as m,e as o,f as t,q as G,w as i,g as r,j as D,b as g,t as c,v as z,h as u,m as d,n as h,A as O,F as C,k as A,y as R,ax as W,s as y}from"./app-BfPvEkA-.js";import{_ as X}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DTJI6jLA.js";import{_ as b,c as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-BSnzyO3E.js";import{c as Y,_ as p}from"./createLucideIcon-GRWsbGen.js";import{_ as Z}from"./Input.vue_vue_type_script_setup_true_lang-CJnDnmxt.js";import{_ as ee}from"./index-CxtQmOvh.js";import{H as J}from"./HitoCard-DdLe8G1k.js";import{t as _}from"./index-C1jn35iD.js";import{A as te}from"./arrow-left-D1_7lsfE.js";import{P as F}from"./plus-CERtrmWf.js";import{S as oe}from"./search-D9_vtSZ4.js";import{L as se}from"./list-CKDvdz_d.js";import{T as ie}from"./target-XeGtVmgO.js";import"./useFlashMessages-gsLhf-aG.js";import"./index-CJv7SX-q.js";import"./floating-ui.vue-CpZRpgHK.js";import"./x-Dw4t4IDb.js";import"./index-BF541tzt.js";import"./shield-DkzIFnLS.js";import"./user-CWXbkCuh.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CP_MrTjg.js";import"./chevron-right-D9aoj9_l.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-Wgj1Iu2M.js";import"./VisuallyHidden-CIkrP0st.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-B_ZtV9MM.js";import"./index-BPPxL6pp.js";import"./check-CToYTb8V.js";import"./Label.vue_vue_type_script_setup_true_lang-D_cUwdsK.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-DdETzXx_.js";import"./circle-alert-CLEo-4FT.js";import"./map-pin-Ykp1wsoK.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-058Aari0.js";import"./chevrons-up-down-CjQASlBd.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-IEazrvco.js";import"./tag-CoGzPL-F.js";import"./users-CCMBlNO7.js";import"./vote-D31UAZtL.js";import"./folder-open-DeUQARC-.js";import"./send-BFfzLRJ5.js";import"./file-text-DCJ8hQH1.js";import"./briefcase-Bt71kvwc.js";import"./calendar-DVEbrIqF.js";import"./megaphone-CNGCjuWw.js";import"./user-check-Dq_vXN10.js";import"./clipboard-list-BmLok2Qx.js";import"./mail-Bc4gVGPd.js";import"./message-square-BckQ1ppN.js";import"./external-link-DQIY_jE4.js";import"./panel-left-DvTN1S0d.js";import"./index-B6_MdlZi.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-BCUVTAVp.js";import"./Progress.vue_vue_type_script_setup_true_lang-UOC-lxG-.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DLBzl4-t.js";import"./StatusChangeModal.vue_vue_type_script_setup_true_lang-DYukgcx7.js";import"./Textarea.vue_vue_type_script_setup_true_lang-DkDba8IO.js";import"./circle-x-Dl3prhah.js";import"./clock-DPnnatu6.js";import"./circle-check-big-ieuJ3URW.js";import"./loader-circle-C_tvD8Ml.js";import"./square-pen-Bqnbj1Se.js";import"./trash-2-BEnHvTNO.js";import"./es-BDPlFIsO.js";import"./calendar-days-DvMzCfJq.js";import"./eye-Dayw-SIs.js";import"./pen-BMTJWwsZ.js";import"./copy-C-Md4DW9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=Y("NetworkIcon",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),re={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},le={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ne={class:"text-sm text-muted-foreground mt-1"},de={class:"flex items-center gap-2"},me={key:0,class:"grid grid-cols-2 md:grid-cols-5 gap-4"},ce={class:"text-2xl font-bold"},ue={class:"text-2xl font-bold text-gray-500"},pe={class:"text-2xl font-bold text-blue-500"},fe={class:"text-2xl font-bold text-green-500"},ye={class:"flex flex-col sm:flex-row gap-2"},ve={class:"flex-1"},ge={class:"relative"},xe={class:"flex gap-2"},he={key:1},be={key:0,class:"grid gap-4 md:grid-cols-2"},$e={key:1,class:"space-y-3"},ke={class:"rounded-full bg-muted p-3 mb-4"},we={class:"text-muted-foreground text-center mb-4"},Ee={key:3,class:"flex justify-center gap-2 mt-4"},Lt=U({__name:"Index",props:{proyecto:{},hitos:{},filters:{},estadisticas:{},timeline:{},canCreate:{type:Boolean},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageDeliverables:{type:Boolean}},setup(a){var j,q;const l=a,f=I(()=>Array.isArray(l.hitos)?{data:l.hitos,current_page:1,last_page:1,per_page:l.hitos.length,total:l.hitos.length}:l.hitos),k=H(((j=l.filters)==null?void 0:j.search)||""),x=H(((q=l.filters)==null?void 0:q.estado)||""),v=H(!1),K=I(()=>{if(!v.value)return f.value.data;const n=f.value.data.filter(s=>!s.parent_id),e=(s,V=0)=>f.value.data.filter(E=>E.parent_id===s).flatMap(E=>[{...E,_nivel:V},...e(E.id,V+1)]);return n.flatMap(s=>[{...s,_nivel:0},...e(s.id,1)])}),Q=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:l.proyecto.nombre,href:`/admin/proyectos/${l.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${l.proyecto.id}/hitos`}],M=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`)},P=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/edit`)},B=n=>{confirm(`¿Estás seguro de eliminar el hito "${n.nombre}"?`)&&y.delete(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}`,{onSuccess:()=>{_.success("Hito eliminado exitosamente")},onError:()=>{_.error("Error al eliminar el hito")}})},N=n=>{y.post(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/duplicar`,{},{onSuccess:()=>{_.success("Hito duplicado exitosamente")},onError:()=>{_.error("Error al duplicar el hito")}})},S=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/entregables/create`)},T=n=>{y.visit(`/admin/proyectos/${l.proyecto.id}/hitos/${n.id}/entregables`)},L=()=>{y.get(`/admin/proyectos/${l.proyecto.id}/hitos`,{search:k.value,estado:x.value},{preserveState:!0,preserveScroll:!0})},w=n=>{x.value=n,L()};return(n,e)=>(d(),m(C,null,[o(t(G),{title:`Hitos - ${a.proyecto.nombre}`},null,8,["title"]),o(X,{breadcrumbs:Q},{default:i(()=>[r("div",re,[r("div",le,[r("div",null,[e[6]||(e[6]=r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Hitos del Proyecto ",-1)),r("p",ne,c(a.proyecto.nombre),1)]),r("div",de,[o(t(z),{href:`/admin/proyectos/${a.proyecto.id}`},{default:i(()=>[o(t(p),{variant:"outline",size:"sm"},{default:i(()=>[o(t(te),{class:"h-4 w-4 mr-2"}),e[7]||(e[7]=u(" Volver al Proyecto ",-1))]),_:1})]),_:1},8,["href"]),a.canCreate?(d(),g(t(z),{key:0,href:`/admin/proyectos/${a.proyecto.id}/hitos/create`},{default:i(()=>[o(t(p),{size:"sm"},{default:i(()=>[o(t(F),{class:"h-4 w-4 mr-2"}),e[8]||(e[8]=u(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):D("",!0)])]),a.estadisticas?(d(),m("div",me,[o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",ce,c(a.estadisticas.total),1),e[9]||(e[9]=r("p",{class:"text-xs text-muted-foreground"},"Total",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",ue,c(a.estadisticas.pendientes),1),e[10]||(e[10]=r("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",pe,c(a.estadisticas.en_progreso),1),e[11]||(e[11]=r("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",fe,c(a.estadisticas.completados),1),e[12]||(e[12]=r("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),_:1})]),_:1}),o(t(b),null,{default:i(()=>[o(t($),{class:"p-4"},{default:i(()=>[r("p",{class:h(["text-2xl font-bold",{"text-red-500":a.estadisticas.vencidos>0}])},c(a.estadisticas.vencidos),3),e[13]||(e[13]=r("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))]),_:1})]),_:1})])):D("",!0),r("div",ye,[r("div",ve,[r("div",ge,[o(t(oe),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o(t(Z),{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=s=>k.value=s),placeholder:"Buscar hitos...",class:"pl-9",onKeyup:O(L,["enter"])},null,8,["modelValue"])])]),r("div",xe,[o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":v.value}),onClick:e[1]||(e[1]=s=>v.value=!v.value),title:"Cambiar vista"},{default:i(()=>[v.value?(d(),g(t(ae),{key:0,class:"h-4 w-4 mr-2"})):(d(),g(t(se),{key:1,class:"h-4 w-4 mr-2"})),u(" "+c(v.value?"Jerárquica":"Plana"),1)]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value===""}),onClick:e[2]||(e[2]=s=>w(""))},{default:i(()=>[...e[14]||(e[14]=[u(" Todos ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="pendiente"}),onClick:e[3]||(e[3]=s=>w("pendiente"))},{default:i(()=>[...e[15]||(e[15]=[u(" Pendientes ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="en_progreso"}),onClick:e[4]||(e[4]=s=>w("en_progreso"))},{default:i(()=>[...e[16]||(e[16]=[u(" En Progreso ",-1)])]),_:1},8,["class"]),o(t(p),{variant:"outline",size:"sm",class:h({"bg-primary text-primary-foreground":x.value==="completado"}),onClick:e[5]||(e[5]=s=>w("completado"))},{default:i(()=>[...e[17]||(e[17]=[u(" Completados ",-1)])]),_:1},8,["class"])])]),f.value.data.length>0?(d(),m("div",he,[v.value?(d(),m("div",$e,[(d(!0),m(C,null,A(K.value,s=>(d(),m("div",{key:s.id,style:R({marginLeft:`${(s._nivel||0)*2}rem`}),class:"transition-all"},[o(J,{hito:s,"proyecto-id":a.proyecto.id,canEdit:a.canEdit,canDelete:a.canDelete,canManageDeliverables:a.canManageDeliverables,showActions:!0,onView:M,onEdit:P,onDelete:B,onDuplicate:N,onAddEntregable:S,onViewEntregables:T},W({_:2},[s._nivel>0?{name:"prepend",fn:i(()=>[o(t(ee),{variant:"outline",class:"mr-2"},{default:i(()=>[u(" Nivel "+c(s._nivel),1)]),_:2},1024)]),key:"0"}:void 0]),1032,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"])],4))),128))])):(d(),m("div",be,[(d(!0),m(C,null,A(f.value.data,s=>(d(),g(J,{key:s.id,hito:s,"proyecto-id":a.proyecto.id,canEdit:a.canEdit,canDelete:a.canDelete,canManageDeliverables:a.canManageDeliverables,showActions:!0,onView:M,onEdit:P,onDelete:B,onDuplicate:N,onAddEntregable:S,onViewEntregables:T},null,8,["hito","proyecto-id","canEdit","canDelete","canManageDeliverables"]))),128))]))])):(d(),g(t(b),{key:2},{default:i(()=>[o(t($),{class:"flex flex-col items-center justify-center py-12"},{default:i(()=>[r("div",ke,[o(t(ie),{class:"h-8 w-8 text-muted-foreground"})]),e[19]||(e[19]=r("h3",{class:"text-lg font-semibold mb-2"},"No hay hitos",-1)),r("p",we,c(k.value?"No se encontraron hitos con los filtros aplicados":"Comienza creando el primer hito del proyecto"),1),a.canCreate&&!k.value?(d(),g(t(z),{key:0,href:`/admin/proyectos/${a.proyecto.id}/hitos/create`},{default:i(()=>[o(t(p),null,{default:i(()=>[o(t(F),{class:"h-4 w-4 mr-2"}),e[18]||(e[18]=u(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):D("",!0)]),_:1})]),_:1})),f.value.last_page>1?(d(),m("div",Ee,[(d(!0),m(C,null,A(f.value.last_page,s=>(d(),g(t(p),{key:s,variant:s===f.value.current_page?"default":"outline",size:"sm",onClick:V=>t(y).visit(`/admin/proyectos/${a.proyecto.id}/hitos?page=${s}`)},{default:i(()=>[u(c(s),1)]),_:2},1032,["variant","onClick"]))),128))])):D("",!0)])]),_:1})],64))}});export{Lt as default};
