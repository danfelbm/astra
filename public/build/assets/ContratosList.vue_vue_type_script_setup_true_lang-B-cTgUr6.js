import{d as Q,r as F,c as V,i as g,e as s,j as d,f as t,w as a,b as u,g as k,h as i,t as c,F as W,k as X,m as r,n as B,v as E,s as L}from"./app-DPZe4w2x.js";import{_ as Y,c as Z}from"./CardTitle.vue_vue_type_script_setup_true_lang-BCQJcDUY.js";import{_ as y}from"./createLucideIcon-CtVqLifD.js";import{_ as D}from"./index-CnATNmjU.js";import{_ as j}from"./Checkbox.vue_vue_type_script_setup_true_lang-fisiD3Y9.js";import{a as ee,b as T,c as p,d as te,e as v,_ as se}from"./TableHeader.vue_vue_type_script_setup_true_lang-D0N5J3gC.js";import{b as ae,c as le,d as ie,e as oe,f as P,g as b}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CSPDkw7c.js";import{g as re,a as ne,f as de}from"./contratos-BiUTbrRP.js";import{u as ue}from"./useToast-C6vP8B9W.js";import{F as M}from"./file-text-Ds-M-qF1.js";import{C as fe}from"./circle-alert-Donphzw1.js";import{C as ce}from"./calendar-PgbUr37k.js";import{D as me}from"./dollar-sign-BYTPwtqy.js";import{E as ge}from"./ellipsis-B_TxJhZC.js";import{E as ve}from"./eye-BBI1XKOw.js";import{S as ke}from"./square-pen-Cl6Kw445.js";import{L as pe}from"./list-BzQYBNVT.js";import{D as xe}from"./download-AjLhgXL7.js";import{C as ye}from"./copy-QvWOK9jm.js";import{T as be}from"./trash-2-BI7w8b20.js";const _e={class:"space-y-4"},he={key:0,class:"flex items-center justify-center py-12"},we={class:"flex items-center gap-1"},Ce={key:0,class:"text-xs"},$e={class:"flex items-center gap-1"},Se={key:0,class:"text-xs"},ze={class:"flex items-center gap-1"},Ee={key:0,class:"text-xs"},De={class:"flex flex-col gap-2"},Ae={class:"flex items-center gap-2"},Fe={class:"flex items-center gap-1 mt-1"},Ve={key:0,class:"flex items-center gap-1 flex-wrap"},Be={key:1,class:"text-gray-400"},Le={class:"flex items-center gap-1"},Te={key:0,class:"flex items-center gap-1"},Pe={key:1,class:"text-gray-400"},Ne={key:0,class:"text-sm text-gray-600"},lt=Q({__name:"ContratosList",props:{contratos:{},loading:{type:Boolean,default:!1},showProyecto:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0},showSelection:{type:Boolean,default:!1},selectedIds:{default:()=>[]},actionsStyle:{default:"dropdown"}},emits:["select","selectAll","edit","delete","duplicate","changeStatus","download"],setup(f,{expose:q,emit:I}){const w=f,C=I,R=ue(),m=F(new Set(w.selectedIds)),_=F("fecha_inicio"),h=F("desc"),S=V(()=>w.contratos.length>0&&w.contratos.every(o=>m.value.has(o.id))),G=V(()=>w.contratos.some(o=>m.value.has(o.id))&&!S.value),N=V(()=>{const o=[...w.contratos];return o.sort((e,l)=>{let n=e[_.value],$=l[_.value];return n==null?1:$==null?-1:(typeof n=="string"&&(n=n.toLowerCase(),$=$.toLowerCase()),h.value==="asc"?n>$?1:-1:n<$?1:-1)}),o}),H=o=>({borrador:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",activo:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",finalizado:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",cancelado:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"})[o]||"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",J=o=>({servicio:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",obra:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",suministro:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200",consultoria:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",otro:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"})[o]||"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",U=o=>o?new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"-",A=o=>{_.value===o?h.value=h.value==="asc"?"desc":"asc":(_.value=o,h.value="asc")},K=o=>{m.value.has(o)?m.value.delete(o):m.value.add(o)},O=()=>{S.value?m.value.clear():w.contratos.forEach(o=>m.value.add(o.id)),C("selectAll",S.value)},x=(o,e)=>{switch(o){case"view":L.get(route("admin.contratos.show",e.id));break;case"edit":C("edit",e),L.get(route("admin.contratos.edit",e.id));break;case"obligations":L.get(route("admin.obligaciones.index",{contrato_id:e.id}));break;case"duplicate":C("duplicate",e);break;case"delete":C("delete",e);break;case"download":e.archivo_pdf?(C("download",e),window.open(e.archivo_pdf,"_blank")):R.error("Este contrato no tiene archivo PDF");break}},z=(o,e)=>{C("changeStatus",o,e)};return q({selectedContratos:m}),(o,e)=>(r(),g("div",_e,[s(t(Y),null,{default:a(()=>[s(t(Z),{class:"p-0"},{default:a(()=>[f.loading?(r(),g("div",he,[...e[3]||(e[3]=[k("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):(r(),u(t(se),{key:1},{default:a(()=>[s(t(ee),null,{default:a(()=>[s(t(T),null,{default:a(()=>[f.showSelection?(r(),u(t(p),{key:0,class:"w-12"},{default:a(()=>[s(t(j),{checked:S.value,indeterminate:G.value,"onUpdate:checked":O},null,8,["checked","indeterminate"])]),_:1})):d("",!0),s(t(p),{class:"cursor-pointer hover:bg-gray-50",onClick:e[0]||(e[0]=l=>A("nombre"))},{default:a(()=>[k("div",we,[e[4]||(e[4]=i(" Nombre ",-1)),_.value==="nombre"?(r(),g("span",Ce,c(h.value==="asc"?"↑":"↓"),1)):d("",!0)])]),_:1}),f.showProyecto?(r(),u(t(p),{key:1},{default:a(()=>[...e[5]||(e[5]=[i("Proyecto",-1)])]),_:1})):d("",!0),s(t(p),null,{default:a(()=>[...e[6]||(e[6]=[i("Estado",-1)])]),_:1}),s(t(p),null,{default:a(()=>[...e[7]||(e[7]=[i("Tipo",-1)])]),_:1}),s(t(p),{class:"cursor-pointer hover:bg-gray-50",onClick:e[1]||(e[1]=l=>A("fecha_inicio"))},{default:a(()=>[k("div",$e,[e[8]||(e[8]=i(" Fecha Inicio ",-1)),_.value==="fecha_inicio"?(r(),g("span",Se,c(h.value==="asc"?"↑":"↓"),1)):d("",!0)])]),_:1}),s(t(p),null,{default:a(()=>[...e[9]||(e[9]=[i("Fecha Fin",-1)])]),_:1}),s(t(p),{class:"cursor-pointer hover:bg-gray-50",onClick:e[2]||(e[2]=l=>A("monto_total"))},{default:a(()=>[k("div",ze,[e[10]||(e[10]=i(" Monto ",-1)),_.value==="monto_total"?(r(),g("span",Ee,c(h.value==="asc"?"↑":"↓"),1)):d("",!0)])]),_:1}),s(t(p),null,{default:a(()=>[...e[11]||(e[11]=[i("Responsable",-1)])]),_:1}),f.showActions&&f.actionsStyle==="dropdown"?(r(),u(t(p),{key:2,class:"text-right"},{default:a(()=>[...e[12]||(e[12]=[i("Acciones",-1)])]),_:1})):d("",!0)]),_:1})]),_:1}),s(t(te),null,{default:a(()=>[N.value.length>0?(r(!0),g(W,{key:0},X(N.value,l=>(r(),u(t(T),{key:l.id,class:B({"bg-gray-50":m.value.has(l.id)})},{default:a(()=>[f.showSelection?(r(),u(t(v),{key:0},{default:a(()=>[s(t(j),{checked:m.value.has(l.id),"onUpdate:checked":()=>K(l.id)},null,8,["checked","onUpdate:checked"])]),_:2},1024)):d("",!0),s(t(v),{class:"font-medium"},{default:a(()=>[k("div",De,[k("div",Ae,[s(t(M),{class:"h-4 w-4 text-gray-400"}),k("div",null,[i(c(l.nombre)+" ",1),k("div",Fe,[l.esta_vencido?(r(),u(t(D),{key:0,variant:"destructive",class:"text-xs"},{default:a(()=>[...e[13]||(e[13]=[i(" Vencido ",-1)])]),_:1})):l.esta_proximo_vencer?(r(),u(t(D),{key:1,variant:"outline",class:"text-xs text-yellow-600 border-yellow-600"},{default:a(()=>[s(t(fe),{class:"h-3 w-3 mr-1"}),i(" "+c(l.dias_restantes)+" días ",1)]),_:2},1024)):d("",!0)])])]),f.showActions&&f.actionsStyle==="buttons"?(r(),g("div",Ve,[s(t(E),{href:o.route("admin.contratos.show",l.id)},{default:a(()=>[s(t(y),{variant:"outline",size:"sm",class:"h-7 text-xs"},{default:a(()=>[...e[14]||(e[14]=[i(" Ver detalles ",-1)])]),_:1})]),_:1},8,["href"]),s(t(E),{href:o.route("admin.contratos.edit",l.id)},{default:a(()=>[s(t(y),{variant:"outline",size:"sm",class:"h-7 text-xs"},{default:a(()=>[...e[15]||(e[15]=[i(" Editar ",-1)])]),_:1})]),_:1},8,["href"]),s(t(E),{href:o.route("admin.obligaciones.index",{contrato_id:l.id})},{default:a(()=>[s(t(y),{variant:"outline",size:"sm",class:"h-7 text-xs"},{default:a(()=>[...e[16]||(e[16]=[i(" Ver obligaciones ",-1)])]),_:1})]),_:1},8,["href"]),l.estado==="borrador"?(r(),u(t(y),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-950",onClick:n=>z(l,"activo")},{default:a(()=>[...e[17]||(e[17]=[i(" Activar ",-1)])]),_:1},8,["onClick"])):d("",!0),l.estado==="activo"?(r(),u(t(y),{key:1,variant:"outline",size:"sm",class:"h-7 text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:n=>z(l,"finalizado")},{default:a(()=>[...e[18]||(e[18]=[i(" Finalizar ",-1)])]),_:1},8,["onClick"])):d("",!0),s(t(y),{variant:"outline",size:"sm",class:"h-7 text-xs text-purple-600 hover:text-purple-700 hover:bg-purple-50 dark:hover:bg-purple-950",onClick:n=>x("duplicate",l)},{default:a(()=>[...e[19]||(e[19]=[i(" Duplicar ",-1)])]),_:1},8,["onClick"]),s(t(y),{variant:"outline",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:n=>x("delete",l)},{default:a(()=>[...e[20]||(e[20]=[i(" Eliminar ",-1)])]),_:1},8,["onClick"])])):d("",!0)])]),_:2},1024),f.showProyecto?(r(),u(t(v),{key:1},{default:a(()=>[l.proyecto?(r(),u(t(E),{key:0,href:o.route("admin.proyectos.show",l.proyecto.id),class:"text-blue-600 hover:underline"},{default:a(()=>[i(c(l.proyecto.nombre),1)]),_:2},1032,["href"])):(r(),g("span",Be,"-"))]),_:2},1024)):d("",!0),s(t(v),null,{default:a(()=>[s(t(D),{class:B(H(l.estado))},{default:a(()=>[i(c(t(re)(l.estado)),1)]),_:2},1032,["class"])]),_:2},1024),s(t(v),null,{default:a(()=>[s(t(D),{class:B(J(l.tipo)),variant:"outline"},{default:a(()=>[i(c(t(ne)(l.tipo)),1)]),_:2},1032,["class"])]),_:2},1024),s(t(v),null,{default:a(()=>[k("div",Le,[s(t(ce),{class:"h-4 w-4 text-gray-400"}),i(" "+c(U(l.fecha_inicio)),1)])]),_:2},1024),s(t(v),null,{default:a(()=>[i(c(U(l.fecha_fin)),1)]),_:2},1024),s(t(v),null,{default:a(()=>[l.monto_total?(r(),g("div",Te,[s(t(me),{class:"h-4 w-4 text-gray-400"}),i(" "+c(t(de)(l.monto_total,l.moneda)),1)])):(r(),g("span",Pe,"-"))]),_:2},1024),s(t(v),null,{default:a(()=>{var n;return[i(c(((n=l.responsable)==null?void 0:n.name)||"-"),1)]}),_:2},1024),f.showActions&&f.actionsStyle==="dropdown"?(r(),u(t(v),{key:2,class:"text-right"},{default:a(()=>[s(t(ae),null,{default:a(()=>[s(t(le),{asChild:""},{default:a(()=>[s(t(y),{variant:"ghost",size:"sm"},{default:a(()=>[s(t(ge),{class:"h-4 w-4"})]),_:1})]),_:1}),s(t(ie),{align:"end"},{default:a(()=>[s(t(oe),null,{default:a(()=>[...e[21]||(e[21]=[i("Acciones",-1)])]),_:1}),s(t(P)),s(t(b),{onClick:n=>x("view",l)},{default:a(()=>[s(t(ve),{class:"h-4 w-4 mr-2"}),e[22]||(e[22]=i(" Ver detalles ",-1))]),_:1},8,["onClick"]),s(t(b),{onClick:n=>x("edit",l)},{default:a(()=>[s(t(ke),{class:"h-4 w-4 mr-2"}),e[23]||(e[23]=i(" Editar ",-1))]),_:1},8,["onClick"]),s(t(b),{onClick:n=>x("obligations",l)},{default:a(()=>[s(t(pe),{class:"h-4 w-4 mr-2"}),e[24]||(e[24]=i(" Ver obligaciones ",-1))]),_:1},8,["onClick"]),l.archivo_pdf?(r(),u(t(b),{key:0,onClick:n=>x("download",l)},{default:a(()=>[s(t(xe),{class:"h-4 w-4 mr-2"}),e[25]||(e[25]=i(" Descargar PDF ",-1))]),_:1},8,["onClick"])):d("",!0),s(t(P)),l.estado==="borrador"?(r(),u(t(b),{key:1,onClick:n=>z(l,"activo")},{default:a(()=>[...e[26]||(e[26]=[i(" Activar ",-1)])]),_:1},8,["onClick"])):d("",!0),l.estado==="activo"?(r(),u(t(b),{key:2,onClick:n=>z(l,"finalizado")},{default:a(()=>[...e[27]||(e[27]=[i(" Finalizar ",-1)])]),_:1},8,["onClick"])):d("",!0),s(t(b),{onClick:n=>x("duplicate",l)},{default:a(()=>[s(t(ye),{class:"h-4 w-4 mr-2"}),e[28]||(e[28]=i(" Duplicar ",-1))]),_:1},8,["onClick"]),s(t(P)),s(t(b),{class:"text-red-600",onClick:n=>x("delete",l)},{default:a(()=>[s(t(be),{class:"h-4 w-4 mr-2"}),e[29]||(e[29]=i(" Eliminar ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):d("",!0)]),_:2},1032,["class"]))),128)):(r(),u(t(T),{key:1},{default:a(()=>[s(t(v),{colspan:f.showSelection?10:9,class:"text-center py-8 text-gray-500"},{default:a(()=>[s(t(M),{class:"h-12 w-12 text-gray-300 mx-auto mb-2"}),e[30]||(e[30]=k("p",null,"No se encontraron contratos",-1))]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1}))]),_:1})]),_:1}),f.showSelection&&m.value.size>0?(r(),g("div",Ne,c(m.value.size)+" contrato(s) seleccionado(s) ",1)):d("",!0)]))}});export{lt as _};
