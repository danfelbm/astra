import{d as C,C as k,k as F,c as v,a as T,o as S,b as e,u as t,m as A,e as s,f as i,t as m,g as r,n as M,h as z,F as B,W as q}from"./app-BYrg8azN.js";import{_ as N}from"./index-Dnt_evNg.js";import{_ as g}from"./createLucideIcon-DxPAJKhv.js";import{_ as b,c as $,a as U,b as j}from"./CardTitle.vue_vue_type_script_setup_true_lang-DlaYTSU0.js";import{_ as L,a as R,b as W,c as G,d as H,e as I,f as J,g as K}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-COIixYkt.js";import{V as x,_ as O}from"./AppLayout.vue_vue_type_script_setup_true_lang-DQbGPnII.js";import{D as P}from"./DynamicFormRenderer-Ds4CUNhp.js";import{A as Q}from"./arrow-left-DtNp39QY.js";import{C as X}from"./clock-DvDon2TL.js";import{T as Y}from"./triangle-alert-VNQvS6Fy.js";import"./index-C0uR22Wz.js";import"./VisuallyHidden-Cjvdecbm.js";import"./Input.vue_vue_type_script_setup_true_lang-cNMPFlQg.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DhSQWsLU.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-D0KTl89S.js";import"./check-Dnm50LWO.js";import"./index-CtsYRsim.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CKhh5LrD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-DXoi_pIi.js";import"./Label.vue_vue_type_script_setup_true_lang-CpYAXHQ5.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Dy7n7nzo.js";import"./users-CRqqnxs_.js";import"./index-Cwqy0GLJ.js";import"./briefcase-DHuSDdT_.js";import"./calendar-DjYpadyA.js";import"./circle-alert-GYpGhiYY.js";import"./map-pin-KZYz5i_q.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-BYbvIOKB.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-DIDmoHU5.js";import"./Textarea.vue_vue_type_script_setup_true_lang-CtHMuZrV.js";import"./plus-B3vGyxqV.js";import"./user-B0IM4lcc.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-C3fnyVFA.js";import"./RovingFocusItem-BeahFnxH.js";import"./utils-zp5SM-uI.js";import"./VisuallyHiddenInput-D2J8ATW5.js";import"./useConditionalFields-Bi2StHU-.js";import"./upload-BchiVH36.js";import"./eye-DZtEPcHP.js";import"./download-BO4uatT5.js";import"./grip-vertical-Dpu_XeLC.js";import"./trash-2-MIyhm2eH.js";const Z={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},tt={class:"flex items-center justify-between"},ot={class:"text-3xl font-bold"},et={class:"text-muted-foreground"},at={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},st={class:"flex items-center gap-2"},it={class:"flex items-center gap-2 text-sm text-muted-foreground"},rt={class:"flex items-center gap-2 text-sm"},nt={class:"flex justify-end pt-6 border-t"},Yt=C({__name:"Votar",props:{votacion:{},candidatosElegibles:{}},setup(h){const d=h,V=[{title:"Dashboard",href:"/dashboard"},{title:"Mis Votaciones",href:"/votaciones"},{title:"Votar",href:"#"}],n=k((()=>{const a={};return d.votacion.formulario_config.forEach(o=>{o.type==="checkbox"?a[o.id]=[]:a[o.id]=""}),{respuestas:a}})()),f=F(!1),w=()=>{n.post(`/votaciones/${d.votacion.id}/votar`,{onSuccess:()=>{},onError:a=>{console.error("Errores de validación:",a)}})},y=()=>{q.get("/votaciones")},D=a=>new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=v(()=>{const a=new Date,l=new Date(d.votacion.fecha_fin).getTime()-a.getTime();if(l<=0)return"Expirada";const c=Math.floor(l/(1e3*60*60)),p=Math.floor(l%(1e3*60*60)/(1e3*60));if(c>24){const _=Math.floor(c/24);return`${_} día${_>1?"s":""}`}else return c>0?`${c}h ${p}m`:`${p}m`}),E=v(()=>d.votacion.formulario_config.every(a=>{if(!a.required)return!0;const o=n.respuestas[a.id];return a.type==="checkbox"?Array.isArray(o)&&o.length>0:o&&o.toString().trim()!==""}));return(a,o)=>(S(),T(B,null,[e(t(A),{title:`Votar: ${a.votacion.titulo}`},null,8,["title"]),e(O,{breadcrumbs:V},{default:s(()=>[i("div",Z,[i("div",tt,[i("div",null,[i("h1",ot,m(a.votacion.titulo),1),i("p",et,m(a.votacion.descripcion),1)]),e(t(g),{variant:"outline",onClick:y},{default:s(()=>[e(t(Q),{class:"mr-2 h-4 w-4"}),o[3]||(o[3]=r(" Volver "))]),_:1})]),e(t(b),null,{default:s(()=>[e(t($),{class:"pt-6"},{default:s(()=>[i("div",at,[i("div",st,[e(t(N),{variant:"outline"},{default:s(()=>[r(m(a.votacion.categoria.nombre),1)]),_:1})]),i("div",it,[e(t(X),{class:"h-4 w-4"}),r(" Termina: "+m(D(a.votacion.fecha_fin)),1)]),i("div",rt,[e(t(Y),{class:"h-4 w-4 text-orange-600"}),i("span",{class:M(u.value==="Expirada"?"text-red-600":"text-orange-600")},m(u.value==="Expirada"?"Votación expirada":`Tiempo restante: ${u.value}`),3)])])]),_:1})]),_:1}),e(t(b),null,{default:s(()=>[e(t(U),null,{default:s(()=>[e(t(j),{class:"flex items-center gap-2"},{default:s(()=>[e(t(x),{class:"h-5 w-5"}),o[4]||(o[4]=r(" Formulario de Votación "))]),_:1})]),_:1}),e(t($),null,{default:s(()=>[i("form",{onSubmit:o[1]||(o[1]=z(l=>f.value=!0,["prevent"])),class:"space-y-6"},[e(P,{fields:a.votacion.formulario_config,modelValue:t(n).respuestas,"onUpdate:modelValue":o[0]||(o[0]=l=>t(n).respuestas=l),"candidatos-elegibles":a.candidatosElegibles||{},errors:t(n).errors,disabled:t(n).processing,title:"",description:"",context:"votacion"},null,8,["fields","modelValue","candidatos-elegibles","errors","disabled"]),i("div",nt,[e(t(g),{type:"submit",disabled:!E.value||t(n).processing,class:"min-w-32"},{default:s(()=>[e(t(x),{class:"mr-2 h-4 w-4"}),r(" "+m(t(n).processing?"Enviando...":"Enviar Voto"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),e(t(L),{open:f.value,"onUpdate:open":o[2]||(o[2]=l=>f.value=l)},{default:s(()=>[e(t(R),null,{default:s(()=>[e(t(W),null,{default:s(()=>[e(t(G),null,{default:s(()=>o[5]||(o[5]=[r("¿Confirmar voto?")])),_:1}),e(t(H),null,{default:s(()=>o[6]||(o[6]=[r(" Una vez enviado tu voto, no podrás modificarlo. ¿Estás seguro de que quieres proceder? ")])),_:1})]),_:1}),e(t(I),null,{default:s(()=>[e(t(J),null,{default:s(()=>o[7]||(o[7]=[r("Cancelar")])),_:1}),e(t(K),{onClick:w,class:"bg-primary"},{default:s(()=>o[8]||(o[8]=[r(" Confirmar Voto ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{Yt as default};
