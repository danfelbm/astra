import{d as h,C as q,k as L,j as V,o as u,e as l,b as t,f as n,u as e,m as M,P as S,g as o,h as R,a as _,F as k,r as F,t as f}from"./app-Ds26iX9R.js";import{T as z,S as B,U as P,_ as g,a as c,b as v,c as y,d as G,e as E,f as O,g as Q,h as H,j as I,i as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-C3fdEij9.js";import{_ as m}from"./AppLogo.vue_vue_type_script_setup_true_lang-DNyimiy1.js";import{_ as x}from"./CardDescription.vue_vue_type_script_setup_true_lang-ibSplSGH.js";import{_ as d,a as w}from"./Label.vue_vue_type_script_setup_true_lang-aw07jv8z.js";import{_ as K}from"./Textarea.vue_vue_type_script_setup_true_lang-CfsBvtld.js";import{_ as W}from"./Switch.vue_vue_type_script_setup_true_lang-C1LFfXz1.js";import{_ as X}from"./Checkbox.vue_vue_type_script_setup_true_lang-wPcqA1MM.js";import{_ as Y,a as Z,b,c as $}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-CMvKXxvg.js";import{F as ee,_ as se}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-DkxOziUk.js";import{_ as p}from"./InputError.vue_vue_type_script_setup_true_lang-Czbsvtje.js";import{A as te}from"./arrow-left-bpvY5JZ-.js";import{S as le}from"./save-BuMcsQhS.js";import"./index-DKljZNKx.js";import"./VisuallyHidden-D7kGmBGU.js";import"./VisuallyHiddenInput-CESC7Zv0.js";import"./RovingFocusItem-3lmBRLjP.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-BNzAqoao.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-Df67dS10.js";import"./trash-2-BobbqLUd.js";import"./plus-kQl5Glma.js";import"./search-BBcyzRM-.js";import"./history-C1svIZ4T.js";const oe={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ae={class:"flex items-center justify-between"},ne={class:"space-y-2"},ie={class:"space-y-2"},re={class:"space-y-2"},de={class:"flex items-center justify-between"},ue={class:"space-y-0.5"},me={class:"flex items-center space-x-2"},fe={class:"space-y-2"},pe={class:"grid grid-cols-2 gap-2"},_e={class:"flex items-center px-3 py-2 bg-muted rounded-md"},ge={class:"text-sm text-muted-foreground"},ce={class:"grid grid-cols-2 gap-2 mt-2"},ve={key:0,class:"space-y-3"},ye={class:"flex-1"},xe={class:"text-xs text-muted-foreground mt-1"},be={key:1,class:"text-center py-8 text-muted-foreground"},$e={class:"flex justify-end gap-4"},Ie=h({__name:"Create",props:{roles:{},filterFieldsConfig:{},modelTypes:{}},setup(Ce){const U=[{title:"Dashboard",href:"/dashboard"},{title:"Administración",href:"#"},{title:"Segmentos",href:"/admin/segments"},{title:"Crear Segmento",href:"#"}],a=q({name:"",description:"",model_type:"App\\Models\\User",filters:{},is_dynamic:!0,cache_duration:300,role_ids:[]}),D=L(null),N=r=>{const s=a.role_ids.indexOf(r);s>-1?a.role_ids.splice(s,1):a.role_ids.push(r)},j=r=>{a.filters=r},A=()=>{a.post("/admin/segments",{preserveScroll:!0,onSuccess:()=>{}})},T=r=>r<60?`${r} segundos`:r<3600?`${Math.floor(r/60)} minutos`:`${Math.floor(r/3600)} horas`;return(r,s)=>(u(),V(J,{breadcrumbs:U},{default:l(()=>[t(e(M),{title:"Crear Segmento"}),n("div",oe,[n("div",ae,[s[10]||(s[10]=n("div",null,[n("h2",{class:"text-2xl font-bold tracking-tight"},"Crear Nuevo Segmento"),n("p",{class:"text-muted-foreground"}," Define un segmento de usuarios basado en filtros dinámicos ")],-1)),t(e(S),{href:r.route("admin.segments.index")},{default:l(()=>[t(e(m),{variant:"outline"},{default:l(()=>[t(e(te),{class:"mr-2 h-4 w-4"}),s[9]||(s[9]=o(" Volver "))]),_:1})]),_:1},8,["href"])]),n("form",{onSubmit:R(A,["prevent"]),class:"space-y-6"},[t(e(Y),{defaultValue:"general",class:"space-y-4"},{default:l(()=>[t(e(Z),{class:"grid w-full grid-cols-4"},{default:l(()=>[t(e(b),{value:"general"},{default:l(()=>[t(e(z),{class:"mr-2 h-4 w-4"}),s[11]||(s[11]=o(" General "))]),_:1}),t(e(b),{value:"filters"},{default:l(()=>[t(e(ee),{class:"mr-2 h-4 w-4"}),s[12]||(s[12]=o(" Filtros "))]),_:1}),t(e(b),{value:"settings"},{default:l(()=>[t(e(B),{class:"mr-2 h-4 w-4"}),s[13]||(s[13]=o(" Configuración "))]),_:1}),t(e(b),{value:"roles"},{default:l(()=>[t(e(P),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=o(" Roles "))]),_:1})]),_:1}),t(e($),{value:"general"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[15]||(s[15]=[o("Información General")])),_:1}),t(e(x),null,{default:l(()=>s[16]||(s[16]=[o(" Define el nombre y descripción del segmento ")])),_:1})]),_:1}),t(e(y),{class:"space-y-4"},{default:l(()=>[n("div",ne,[t(e(d),{htmlFor:"name"},{default:l(()=>s[17]||(s[17]=[o("Nombre del Segmento")])),_:1}),t(e(w),{id:"name",modelValue:e(a).name,"onUpdate:modelValue":s[0]||(s[0]=i=>e(a).name=i),placeholder:"Usuarios por Región Norte"},null,8,["modelValue"]),t(p,{message:e(a).errors.name},null,8,["message"])]),n("div",ie,[t(e(d),{htmlFor:"description"},{default:l(()=>s[18]||(s[18]=[o("Descripción")])),_:1}),t(e(K),{id:"description",modelValue:e(a).description,"onUpdate:modelValue":s[1]||(s[1]=i=>e(a).description=i),placeholder:"Describe el propósito y criterios de este segmento...",rows:"4"},null,8,["modelValue"]),t(p,{message:e(a).errors.description},null,8,["message"])]),n("div",re,[t(e(d),{htmlFor:"model_type"},{default:l(()=>s[19]||(s[19]=[o("Tipo de Modelo")])),_:1}),t(e(G),{modelValue:e(a).model_type,"onUpdate:modelValue":s[2]||(s[2]=i=>e(a).model_type=i)},{default:l(()=>[t(e(E),null,{default:l(()=>[t(e(O),{placeholder:"Selecciona el tipo de modelo"})]),_:1}),t(e(Q),null,{default:l(()=>[(u(!0),_(k,null,F(r.modelTypes,(i,C)=>(u(),V(e(H),{key:C,value:C},{default:l(()=>[o(f(i),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),s[20]||(s[20]=n("p",{class:"text-xs text-muted-foreground"}," Selecciona el modelo de datos sobre el que aplicar el segmento ",-1)),t(p,{message:e(a).errors.model_type},null,8,["message"])])]),_:1})]),_:1})]),_:1}),t(e($),{value:"filters"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[21]||(s[21]=[o("Criterios de Filtrado")])),_:1}),t(e(x),null,{default:l(()=>s[22]||(s[22]=[o(" Define los filtros que determinarán qué usuarios pertenecen a este segmento ")])),_:1})]),_:1}),t(e(y),null,{default:l(()=>[t(se,{ref_key:"advancedFiltersRef",ref:D,config:{fields:r.filterFieldsConfig,showQuickSearch:!1},route:"",onApply:j},null,8,["config"]),t(p,{message:e(a).errors.filters},null,8,["message"]),s[23]||(s[23]=n("div",{class:"mt-4 p-4 bg-muted/50 rounded-lg"},[n("p",{class:"text-sm text-muted-foreground"},[n("strong",null,"Nota:"),o(" Los filtros definidos aquí serán aplicados dinámicamente para determinar qué usuarios pertenecen a este segmento. Los segmentos dinámicos se recalculan automáticamente según los criterios establecidos. ")])],-1))]),_:1})]),_:1})]),_:1}),t(e($),{value:"settings"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[24]||(s[24]=[o("Configuración del Segmento")])),_:1}),t(e(x),null,{default:l(()=>s[25]||(s[25]=[o(" Ajusta el comportamiento y cache del segmento ")])),_:1})]),_:1}),t(e(y),{class:"space-y-6"},{default:l(()=>[n("div",de,[n("div",ue,[t(e(d),null,{default:l(()=>s[26]||(s[26]=[o("Tipo de Segmento")])),_:1}),s[27]||(s[27]=n("p",{class:"text-sm text-muted-foreground"}," Los segmentos dinámicos se recalculan en tiempo real ",-1))]),n("div",me,[t(e(d),{htmlFor:"is_dynamic",class:"text-sm"},{default:l(()=>s[28]||(s[28]=[o("Dinámico")])),_:1}),t(e(W),{id:"is_dynamic",modelValue:e(a).is_dynamic,"onUpdate:modelValue":s[3]||(s[3]=i=>e(a).is_dynamic=i)},null,8,["modelValue"])])]),n("div",fe,[t(e(d),{htmlFor:"cache_duration"},{default:l(()=>s[29]||(s[29]=[o("Duración del Cache (segundos)")])),_:1}),n("div",pe,[t(e(w),{id:"cache_duration",modelValue:e(a).cache_duration,"onUpdate:modelValue":s[4]||(s[4]=i=>e(a).cache_duration=i),modelModifiers:{number:!0},type:"number",min:"0",max:"86400"},null,8,["modelValue"]),n("div",_e,[n("span",ge,f(T(e(a).cache_duration)),1)])]),s[30]||(s[30]=n("p",{class:"text-xs text-muted-foreground"}," Tiempo que se mantendrán en cache los resultados del segmento (0 = sin cache) ",-1)),t(p,{message:e(a).errors.cache_duration},null,8,["message"])]),n("div",null,[t(e(d),{class:"text-sm font-medium"},{default:l(()=>s[31]||(s[31]=[o("Valores Predefinidos")])),_:1}),n("div",ce,[t(e(m),{type:"button",variant:"outline",size:"sm",onClick:s[5]||(s[5]=i=>e(a).cache_duration=60)},{default:l(()=>s[32]||(s[32]=[o(" 1 minuto ")])),_:1}),t(e(m),{type:"button",variant:"outline",size:"sm",onClick:s[6]||(s[6]=i=>e(a).cache_duration=300)},{default:l(()=>s[33]||(s[33]=[o(" 5 minutos ")])),_:1}),t(e(m),{type:"button",variant:"outline",size:"sm",onClick:s[7]||(s[7]=i=>e(a).cache_duration=1800)},{default:l(()=>s[34]||(s[34]=[o(" 30 minutos ")])),_:1}),t(e(m),{type:"button",variant:"outline",size:"sm",onClick:s[8]||(s[8]=i=>e(a).cache_duration=3600)},{default:l(()=>s[35]||(s[35]=[o(" 1 hora ")])),_:1})])])]),_:1})]),_:1})]),_:1}),t(e($),{value:"roles"},{default:l(()=>[t(e(g),null,{default:l(()=>[t(e(c),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[36]||(s[36]=[o("Roles Asociados")])),_:1}),t(e(x),null,{default:l(()=>s[37]||(s[37]=[o(" Vincula este segmento con roles específicos para delimitar el alcance de datos ")])),_:1})]),_:1}),t(e(y),null,{default:l(()=>[r.roles.length>0?(u(),_("div",ve,[(u(!0),_(k,null,F(r.roles,i=>(u(),_("div",{key:i.id,class:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-muted/50"},[t(e(X),{checked:e(a).role_ids.includes(i.id),"onUpdate:checked":C=>N(i.id),class:"mt-1"},null,8,["checked","onUpdate:checked"]),n("div",ye,[t(e(d),{class:"text-sm font-medium cursor-pointer"},{default:l(()=>[o(f(i.display_name),1)]),_:2},1024),n("p",xe,f(i.description||"Sin descripción"),1),t(e(I),{variant:"outline",class:"mt-2"},{default:l(()=>[o(f(i.name),1)]),_:2},1024)])]))),128))])):(u(),_("div",be," No hay roles disponibles ")),t(p,{message:e(a).errors.role_ids},null,8,["message"])]),_:1})]),_:1})]),_:1})]),_:1}),n("div",$e,[t(e(S),{href:r.route("admin.segments.index")},{default:l(()=>[t(e(m),{type:"button",variant:"outline"},{default:l(()=>s[38]||(s[38]=[o(" Cancelar ")])),_:1})]),_:1},8,["href"]),t(e(m),{type:"submit",disabled:e(a).processing},{default:l(()=>[t(e(le),{class:"mr-2 h-4 w-4"}),o(" "+f(e(a).processing?"Creando...":"Crear Segmento"),1)]),_:1},8,["disabled"])])],32)])]),_:1}))}});export{Ie as default};
