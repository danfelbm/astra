import{_ as sa}from"./UserLayout.vue_vue_type_script_setup_true_lang-MTFCrp7k.js";import{_ as S}from"./index-Dz0AhZBc.js";import{_ as N}from"./createLucideIcon-BDUZba4X.js";import{_ as h,c as _,a as $,b as P}from"./CardTitle.vue_vue_type_script_setup_true_lang-C2c7pMmf.js";import{_ as O}from"./CardDescription.vue_vue_type_script_setup_true_lang-CkhLW1Is.js";import{_ as ra,a as ia,b as L,c as G}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-D6Hzvc_R.js";import{D as da}from"./DynamicFormRenderer-eopo8bAT.js";import{d as na,r as V,c as C,u as la,i as c,e as s,f as o,q as ua,w as r,g as t,b as A,j as y,s as ca,h as m,t as n,n as v,m as d,x as M,F as X,k as ma}from"./app-CoEQhKpt.js";import{A as pa}from"./arrow-left-DMUoaX36.js";import{S as H}from"./save-Cv0vUDfg.js";import{S as J}from"./send-xA0-nT9S.js";import{C as fa}from"./clock-nEqX_w6D.js";import{C as K}from"./circle-check-big-BLWcrk-v.js";import{C as Q}from"./circle-x-DvX65R3L.js";import{C as B}from"./circle-alert-AWE8jQF5.js";import{F as ba}from"./file-text-8lUScYXr.js";import{U as va}from"./user-jnyfe7Ih.js";import{C as ga}from"./calendar-CbIY2L75.js";import"./useFlashMessages-BGN1rIwl.js";import"./index-K6ku0g50.js";import"./floating-ui.vue-CYFjou9n.js";import"./x-BBbbZ3gF.js";import"./Input.vue_vue_type_script_setup_true_lang-XRhrZpB7.js";import"./index-Bs6HyYYC.js";import"./index-ByA2uQ-X.js";import"./shield-CKK-CpZt.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-V1oNGW-T.js";import"./chevron-right-D5eyya27.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-B2_vgUfx.js";import"./VisuallyHidden-J5YXH2CX.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-C2r07lY1.js";import"./check-B6fbIfh8.js";import"./Label.vue_vue_type_script_setup_true_lang-B_DtxG9i.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-C-dwc-5i.js";import"./index-CTVjHHSe.js";import"./map-pin-CzRtagr-.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BTwt3rHQ.js";import"./ellipsis-tQqAmOsE.js";import"./usePermissions-CxuY713q.js";import"./square-check-big-H01iwAQe.js";import"./users-CXSsRjik.js";import"./folder-open-rAyPl225.js";import"./index-BKWrPKyO.js";import"./RovingFocusItem-Ddq9enye.js";import"./utils-DZWqhDwz.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BcBIoZ99.js";import"./Textarea.vue_vue_type_script_setup_true_lang-ByPSRNTH.js";import"./plus-Ci5WHHRF.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-aFo9NN92.js";import"./VisuallyHiddenInput-DEiIysYg.js";import"./circle-C8s_lWro.js";import"./FileUploadField.vue_vue_type_script_setup_true_lang-8eyjIlWM.js";import"./useFileUpload-BBkTQ6yF.js";import"./upload-TmvS7OMa.js";import"./file-CfC2wSYp.js";import"./eye-Duhqmmpb.js";import"./download-DRuxhdd7.js";import"./useConditionalFields-uHPj5cWW.js";import"./grip-vertical-BAiDcfC3.js";import"./trash-2-BD1jGhTh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const xa={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ya={class:"space-y-6"},ka={class:"flex items-center justify-between"},ha={class:"space-y-1"},_a={class:"flex items-center gap-2"},Ca={class:"text-3xl font-bold tracking-tight"},wa={class:"text-muted-foreground"},$a={class:"flex items-start justify-between"},Pa={class:"flex items-start gap-3"},Aa={class:"space-y-1"},Ea={class:"flex items-center gap-2"},Fa={class:"text-sm text-muted-foreground"},ja={key:0},za={key:1},Sa={key:2},Na={key:3},Va={key:4},Ba={key:5},Ra={class:"flex items-start gap-2"},Ta={class:"flex-1"},qa={class:"text-xs mt-2 opacity-75"},Da={key:0},Ua={key:1},Ia={key:2},Oa={class:"grid grid-cols-2 gap-4 text-sm"},La={class:"font-medium"},Ga={class:"font-medium"},Ma={class:"font-medium text-xs"},Xa={class:"font-medium"},Ha={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Ja={class:"flex items-start gap-2"},Ka={class:"text-sm text-red-800"},Qa={key:1,class:"flex justify-end gap-3"},Wa={class:"flex items-center justify-between"},Ya={class:"flex items-center justify-between"},Za={class:"text-muted-foreground"},ae={class:"font-medium text-right max-w-xs"},ee={class:"grid grid-cols-2 gap-4 text-sm"},oe={class:"font-medium"},te={class:"font-medium"},se={class:"font-medium"},re={class:"font-medium"},fo=na({__name:"Form",props:{convocatoria:{},postulacion:{},candidatura_aprobada:{},canApply:{type:Boolean},canCreate:{type:Boolean},canEditOwn:{type:Boolean}},setup(a){var T,q,D,U,I;const i=a,W=[{title:"Postulaciones",href:"/miembro/postulaciones"},{title:i.convocatoria.nombre,href:`/miembro/convocatorias/${i.convocatoria.id}`}],E=V(),Y=C(()=>i.candidatura_aprobada?[{id:i.candidatura_aprobada.id,version:i.candidatura_aprobada.version,fecha_aprobacion:i.candidatura_aprobada.fecha_aprobacion,resumen:`Perfil v${i.candidatura_aprobada.version} - Aprobado ${i.candidatura_aprobada.fecha_aprobacion}`}]:[]),b=la({formulario_data:((T=i.postulacion)==null?void 0:T.formulario_data)||{},candidatura_id:(q=i.postulacion)!=null&&q.candidatura_snapshot?(D=i.candidatura_aprobada)==null?void 0:D.id:null,enviar:!1}),w=V((U=i.postulacion)!=null&&U.candidatura_snapshot&&((I=i.candidatura_aprobada)==null?void 0:I.id)||null),F=C(()=>!!i.postulacion),R=C(()=>i.postulacion?i.postulacion.puede_editar:!0),z=C(()=>{var l;return!!((l=i.postulacion)!=null&&l.comentarios_admin)}),Z=l=>{switch(l){case"abierta":return K;case"futura":return ga;case"cerrada":return Q;default:return B}},aa=()=>{b.enviar=!1,b.candidatura_id=w.value,b.post(`/miembro/convocatorias/${i.convocatoria.id}/postular`,{preserveScroll:!0})},g=V(null),ea=()=>{var l,e,u;if(g.value=null,!((l=E.value)!=null&&l.formularioCompleto)){const f=((e=E.value)==null?void 0:e.camposIncompletos)||[],p=(u=E.value)==null?void 0:u.perfilCandidaturaRequerido;f.length>0?g.value=`Formulario incompleto: Por favor completa todos los campos requeridos (${f.length} campos faltantes).`:p&&!w.value?g.value="Debes seleccionar tu perfil de candidatura aprobado para continuar.":g.value="Por favor completa todos los campos requeridos del formulario.";const x=document.querySelector('[role="tabpanel"]');x&&x.scrollIntoView({behavior:"smooth",block:"start"});return}b.enviar=!0,b.candidatura_id=w.value,b.post(`/miembro/convocatorias/${i.convocatoria.id}/postular`,{preserveScroll:!0,onError:f=>{const p=Object.values(f)[0];p?g.value=Array.isArray(p)?p[0]:p:g.value="Error al enviar la postulación. Por favor revisa los datos e intenta nuevamente."}})},oa=(l,e)=>{const u={};for(const[f,p]of Object.entries(l)){const x=e.find(j=>j.id===f);x&&(u[x.title]=Array.isArray(p)?p.join(", "):p)}return u},ta=C(()=>{var l;return(l=i.postulacion)!=null&&l.formulario_data?oa(i.postulacion.formulario_data,i.convocatoria.formulario_postulacion):{}}),k=C(()=>{var e,u,f,p,x,j;if(!((e=i.postulacion)!=null&&e.candidatura_snapshot))return null;const l=i.postulacion.candidatura_snapshot;return{usuario:((u=l.usuario)==null?void 0:u.name)||"N/A",version:((f=l.candidatura)==null?void 0:f.version_original)||"N/A",fecha_aprobacion:((p=l.candidatura)==null?void 0:p.fecha_aprobacion)||"N/A",aprobado_por:((j=(x=l.candidatura)==null?void 0:x.aprobado_por)==null?void 0:j.name)||"N/A"}});return(l,e)=>(d(),c(X,null,[s(o(ua),{title:`${F.value?"Editar":"Nueva"} Postulación - ${a.convocatoria.nombre}`},null,8,["title"]),s(sa,{breadcrumbs:W},{default:r(()=>[t("div",xa,[t("div",ya,[t("div",ka,[t("div",ha,[t("div",_a,[s(o(N),{variant:"ghost",size:"sm",onClick:e[0]||(e[0]=u=>o(ca).get("/miembro/postulaciones"))},{default:r(()=>[s(o(pa),{class:"h-4 w-4 mr-2"}),e[3]||(e[3]=m(" Volver ",-1))]),_:1})]),t("h1",Ca,n(F.value?"Editar Postulación":"Nueva Postulación"),1),t("p",wa,n(a.convocatoria.nombre),1)]),s(o(S),{class:v(a.convocatoria.estado_temporal==="abierta"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800")},{default:r(()=>[(d(),A(M(Z(a.convocatoria.estado_temporal)),{class:"mr-1 h-3 w-3"})),m(" "+n(a.convocatoria.estado_temporal_label),1)]),_:1},8,["class"])]),a.postulacion?(d(),A(o(h),{key:0,class:v({"border-yellow-500":a.postulacion.estado==="borrador","border-blue-500":a.postulacion.estado==="enviada","border-purple-500":a.postulacion.estado==="en_revision","border-green-500":a.postulacion.estado==="aceptada","border-red-500":a.postulacion.estado==="rechazada"})},{default:r(()=>[s(o(_),{class:"pt-6"},{default:r(()=>[t("div",$a,[t("div",Pa,[t("div",{class:v([{"bg-yellow-100 text-yellow-600":a.postulacion.estado==="borrador","bg-blue-100 text-blue-600":a.postulacion.estado==="enviada","bg-purple-100 text-purple-600":a.postulacion.estado==="en_revision","bg-green-100 text-green-600":a.postulacion.estado==="aceptada","bg-red-100 text-red-600":a.postulacion.estado==="rechazada"},"rounded-full p-2"])},[(d(),A(M(a.postulacion.estado==="borrador"?o(H):a.postulacion.estado==="enviada"?o(J):a.postulacion.estado==="en_revision"?o(fa):a.postulacion.estado==="aceptada"?o(K):o(Q)),{class:"h-5 w-5"}))],2),t("div",Aa,[t("div",Ea,[e[4]||(e[4]=t("h3",{class:"font-semibold"},"Estado actual:",-1)),s(o(S),{class:v(a.postulacion.estado==="borrador"?"bg-yellow-100 text-yellow-800":a.postulacion.estado==="enviada"?"bg-blue-100 text-blue-800":a.postulacion.estado==="en_revision"?"bg-purple-100 text-purple-800":a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},{default:r(()=>[m(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),t("p",Fa,[a.postulacion.estado==="borrador"&&z.value?(d(),c("span",ja," Tu postulación fue devuelta a borrador. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):a.postulacion.estado==="borrador"?(d(),c("span",za," Puedes editar y enviar tu postulación cuando esté completa. ")):a.postulacion.estado==="enviada"?(d(),c("span",Sa," Tu postulación ha sido enviada y está pendiente de revisión. ")):a.postulacion.estado==="en_revision"?(d(),c("span",Na," Tu postulación está siendo revisada por el administrador. ")):a.postulacion.estado==="aceptada"?(d(),c("span",Va," ¡Felicidades! Tu postulación ha sido aceptada. ")):a.postulacion.estado==="rechazada"?(d(),c("span",Ba," Tu postulación fue rechazada. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):y("",!0)])])])]),z.value?(d(),c("div",{key:0,class:v([{"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800":a.postulacion.estado==="rechazada","bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800":a.postulacion.estado==="borrador","bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800":a.postulacion.estado==="aceptada"},"mt-4 p-4 rounded-lg"])},[t("div",Ra,[s(o(B),{class:v([{"text-red-600 dark:text-red-400":a.postulacion.estado==="rechazada","text-amber-600 dark:text-amber-400":a.postulacion.estado==="borrador","text-blue-600 dark:text-blue-400":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-600 dark:text-green-400":a.postulacion.estado==="aceptada"},"h-5 w-5 mt-0.5 flex-shrink-0"])},null,8,["class"]),t("div",Ta,[t("p",{class:v(["font-semibold mb-1",{"text-red-900 dark:text-red-100":a.postulacion.estado==="rechazada","text-amber-900 dark:text-amber-100":a.postulacion.estado==="borrador","text-blue-900 dark:text-blue-100":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-900 dark:text-green-100":a.postulacion.estado==="aceptada"}])}," Comentarios de la comisión: ",2),t("p",{class:v(["text-sm whitespace-pre-wrap",{"text-red-800 dark:text-red-200":a.postulacion.estado==="rechazada","text-amber-800 dark:text-amber-200":a.postulacion.estado==="borrador","text-blue-800 dark:text-blue-200":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-800 dark:text-green-200":a.postulacion.estado==="aceptada"}])},n(a.postulacion.comentarios_admin),3),t("p",qa,[a.postulacion.estado==="rechazada"||a.postulacion.estado==="borrador"&&z.value?(d(),c("span",Da," Por favor, atiende estos comentarios antes de reenviar tu postulación. ")):a.postulacion.estado==="aceptada"?(d(),c("span",Ua," Tu postulación fue aceptada con estos comentarios. ")):(d(),c("span",Ia," Estos comentarios fueron agregados durante la revisión. "))])])])],2)):y("",!0)]),_:1})]),_:1},8,["class"])):y("",!0),s(o(h),null,{default:r(()=>[s(o($),null,{default:r(()=>[s(o(P),{class:"flex items-center gap-2"},{default:r(()=>[s(o(ba),{class:"h-5 w-5"}),e[5]||(e[5]=m(" Información de la Convocatoria ",-1))]),_:1}),s(o(O),null,{default:r(()=>[m(n(a.convocatoria.descripcion),1)]),_:1})]),_:1}),s(o(_),{class:"space-y-4"},{default:r(()=>[t("div",Oa,[t("div",null,[e[6]||(e[6]=t("span",{class:"text-muted-foreground"},"Cargo:",-1)),t("p",La,n(a.convocatoria.cargo),1)]),t("div",null,[e[7]||(e[7]=t("span",{class:"text-muted-foreground"},"Periodo:",-1)),t("p",Ga,n(a.convocatoria.periodo),1)]),t("div",null,[e[8]||(e[8]=t("span",{class:"text-muted-foreground"},"Fechas:",-1)),t("p",Ma,n(a.convocatoria.rango_fechas),1)]),t("div",null,[e[9]||(e[9]=t("span",{class:"text-muted-foreground"},"Ubicación:",-1)),t("p",Xa,n(a.convocatoria.ubicacion),1)])])]),_:1})]),_:1}),s(o(ra),{"default-value":"formulario",class:"space-y-4"},{default:r(()=>[s(o(ia),{class:"grid w-full grid-cols-2"},{default:r(()=>[s(o(L),{value:"formulario"},{default:r(()=>[...e[10]||(e[10]=[m(" Formulario de Postulación ",-1)])]),_:1}),s(o(L),{value:"resumen",disabled:!F.value},{default:r(()=>[...e[11]||(e[11]=[m(" Resumen Actual ",-1)])]),_:1},8,["disabled"])]),_:1}),s(o(G),{value:"formulario",class:"space-y-6"},{default:r(()=>[s(o(h),null,{default:r(()=>[s(o($),null,{default:r(()=>[s(o(P),null,{default:r(()=>[...e[12]||(e[12]=[m("Completa tu Postulación",-1)])]),_:1}),s(o(O),null,{default:r(()=>[...e[13]||(e[13]=[m(" Completa todos los campos requeridos para enviar tu postulación. ",-1)])]),_:1})]),_:1}),s(o(_),null,{default:r(()=>[s(da,{ref_key:"formRenderer",ref:E,fields:a.convocatoria.formulario_postulacion,modelValue:o(b).formulario_data,"onUpdate:modelValue":e[1]||(e[1]=u=>o(b).formulario_data=u),"candidatura-seleccionada":w.value,"onUpdate:candidaturaSeleccionada":e[2]||(e[2]=u=>w.value=u),"candidaturas-aprobadas":Y.value,errors:o(b).errors,disabled:!R.value},null,8,["fields","modelValue","candidatura-seleccionada","candidaturas-aprobadas","errors","disabled"])]),_:1})]),_:1}),g.value?(d(),c("div",Ha,[t("div",Ja,[s(o(B),{class:"h-5 w-5 text-red-600 mt-0.5"}),t("p",Ka,n(g.value),1)])])):y("",!0),R.value?(d(),c("div",Qa,[s(o(N),{type:"button",variant:"outline",onClick:aa,disabled:o(b).processing},{default:r(()=>[s(o(H),{class:"mr-2 h-4 w-4"}),e[14]||(e[14]=m(" Guardar Borrador ",-1))]),_:1},8,["disabled"]),s(o(N),{type:"button",onClick:ea,disabled:o(b).processing},{default:r(()=>[s(o(J),{class:"mr-2 h-4 w-4"}),e[15]||(e[15]=m(" Enviar Postulación ",-1))]),_:1},8,["disabled"])])):y("",!0)]),_:1}),F.value?(d(),A(o(G),{key:0,value:"resumen",class:"space-y-4"},{default:r(()=>[s(o(h),null,{default:r(()=>[s(o($),null,{default:r(()=>[s(o(P),null,{default:r(()=>[...e[16]||(e[16]=[m("Estado de la Postulación",-1)])]),_:1})]),_:1}),s(o(_),{class:"space-y-4"},{default:r(()=>[t("div",Wa,[e[17]||(e[17]=t("span",{class:"text-muted-foreground"},"Estado:",-1)),s(o(S),{class:v(a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":a.postulacion.estado==="rechazada"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800")},{default:r(()=>[m(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),t("div",Ya,[e[18]||(e[18]=t("span",{class:"text-muted-foreground"},"Perfil vinculado:",-1)),t("span",null,n(k.value?"Sí":"No"),1)])]),_:1})]),_:1}),s(o(h),null,{default:r(()=>[s(o($),null,{default:r(()=>[s(o(P),null,{default:r(()=>[...e[19]||(e[19]=[m("Respuestas del Formulario",-1)])]),_:1})]),_:1}),s(o(_),{class:"space-y-3"},{default:r(()=>[(d(!0),c(X,null,ma(ta.value,(u,f)=>(d(),c("div",{key:f,class:"flex justify-between"},[t("span",Za,n(f)+":",1),t("span",ae,n(u),1)]))),128))]),_:1})]),_:1}),k.value?(d(),A(o(h),{key:0},{default:r(()=>[s(o($),null,{default:r(()=>[s(o(P),{class:"flex items-center gap-2"},{default:r(()=>[s(o(va),{class:"h-5 w-5"}),e[20]||(e[20]=m(" Perfil de Candidatura Vinculado ",-1))]),_:1})]),_:1}),s(o(_),{class:"space-y-3"},{default:r(()=>[t("div",ee,[t("div",null,[e[21]||(e[21]=t("span",{class:"text-muted-foreground"},"Usuario:",-1)),t("p",oe,n(k.value.usuario),1)]),t("div",null,[e[22]||(e[22]=t("span",{class:"text-muted-foreground"},"Versión:",-1)),t("p",te,"v"+n(k.value.version),1)]),t("div",null,[e[23]||(e[23]=t("span",{class:"text-muted-foreground"},"Fecha aprobación:",-1)),t("p",se,n(k.value.fecha_aprobacion),1)]),t("div",null,[e[24]||(e[24]=t("span",{class:"text-muted-foreground"},"Aprobado por:",-1)),t("p",re,n(k.value.aprobado_por),1)])])]),_:1})]),_:1})):y("",!0)]),_:1})):y("",!0)]),_:1})])])]),_:1})],64))}});export{fo as default};
