import{d as J,r as E,c as Q,i as m,e as d,f as s,u as e,p as Y,w as i,g as t,h as l,R as Z,b as f,j as v,t as n,n as _,q as y,F as z,k as ee,W as U}from"./app-DKHB3frB.js";import{_ as j}from"./index-DfcXqyNn.js";import{_ as L}from"./createLucideIcon-D5HzA-Fj.js";import{_ as C,a as q,b as I,c as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-BN5K4Nag.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-CxAdhP6G.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-DAqjEbMc.js";import{_ as ae}from"./Separator.vue_vue_type_script_setup_true_lang-CN17Rsq4.js";import{_ as H,a as O}from"./index-_jkU5nzb.js";import{_ as se}from"./GuestLayout.vue_vue_type_script_setup_true_lang-n4_qUFY6.js";import{C as g}from"./circle-check-big-B_0VYi2C.js";import{C as V}from"./circle-x-D2-don4a.js";import{S as A}from"./shield-CrR1imKk.js";import{S as K}from"./search-DwGrHrhu.js";import{H as oe}from"./hash-CiHPpGEQ.js";import{C as ie}from"./copy-BPUlitFx.js";import{C as le}from"./clock-CUma3HcP.js";import{T as ne}from"./triangle-alert-C7S2AntP.js";import{E as re}from"./external-link-ZjIvmA6y.js";import"./index-BEt9E4_6.js";import"./index-CeqWoqQN.js";import"./floating-ui.vue-z0Pp58hl.js";import"./index-BNJutSWN.js";import"./index-D-hWJ3gm.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DTAlWRNq.js";const de={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ue={class:"text-center"},ce={class:"text-4xl font-bold flex items-center justify-center gap-3"},me={class:"space-y-4"},fe={class:"flex gap-2"},ve={key:0,class:"max-w-4xl mx-auto w-full space-y-6"},_e={class:"flex items-center gap-4"},pe={class:"flex-1"},ge={class:"space-y-4"},xe={class:"flex items-center gap-2"},ke={class:"text-xs font-mono bg-muted p-3 rounded flex-1 break-all"},he={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},be={class:"flex items-center gap-1"},ye={class:"flex items-center gap-1"},Ce={class:"flex items-center gap-1"},we={class:"flex items-center gap-1"},Ve={class:"space-y-4"},Te={key:0,class:"text-muted-foreground"},Se={class:"flex flex-wrap gap-4 text-sm"},$e={class:"flex items-center gap-2"},Ee={class:"flex items-center gap-2 text-muted-foreground"},qe={class:"space-y-6"},Ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-6"},Le={key:0},Ae={class:"font-medium"},De={class:"font-medium"},Fe={key:1},Ne={class:"font-medium"},Be={class:"font-mono text-xs break-all bg-muted p-2 rounded"},Pe={class:"space-y-6"},Re={class:"flex items-start justify-between"},ze={class:"flex-1"},Ue={key:0,class:"text-red-500"},je={key:0,class:"text-sm text-muted-foreground mt-1"},He={class:"bg-muted/30 rounded-lg p-4"},Oe={class:"text-lg"},Ke={key:1,class:"max-w-2xl mx-auto text-center space-y-4"},We={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},Me={class:"text-center p-4"},Xe={class:"text-center p-4"},Ge={class:"text-center p-4"},ht=J({__name:"VerificarToken",props:{token:{},verification:{}},setup(W){const D=W,x=E(D.token||""),T=E(!1),o=E(D.verification||null),p=Q(()=>{if(!o.value)return null;const u=o.value;return u.is_valid?{icon:g,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",label:"VÁLIDO",description:"Token verificado criptográficamente"}:{icon:V,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"INVÁLIDO",description:u.error||"Token no válido o corrupto"}}),F=()=>{x.value.trim()&&(T.value=!0,U.get(`/verificar-token/${encodeURIComponent(x.value.trim())}`,{},{onFinish:()=>{T.value=!1}}))},S=u=>new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),M=(u,a)=>{var h,b,r;return!a&&a!==0?((h=u.title)==null?void 0:h.toLowerCase().includes("candidato"))||((b=u.title)==null?void 0:b.toLowerCase().includes("elige"))||u.title==="1. Elige un candidato por el que desees votar"||u.type==="radio"&&((r=u.title)==null?void 0:r.match(/^\d+\.\s*Elige/))?"Voto en blanco":"Sin respuesta":u.type==="checkbox"?Array.isArray(a)&&a.length>0?a.join(", "):"Sin respuesta":a.toString()},$=E(!1),X=async()=>{var u;if((u=o.value)!=null&&u.token)try{await navigator.clipboard.writeText(o.value.token),$.value=!0,setTimeout(()=>{$.value=!1},2e3)}catch(a){console.error("Error al copiar token:",a)}},G=()=>{x.value="",o.value=null,U.get("/verificar-token")};return(u,a)=>(d(),m(z,null,[s(e(Y),{title:"Verificación de Tokens de Votación"}),s(se,{title:"Verificar Token",description:"Verifica la autenticidad de tokens de votación"},{default:i(()=>{var h,b;return[t("div",de,[t("div",ue,[t("h1",ce,[s(e(A),{class:"h-10 w-10 text-blue-600"}),a[1]||(a[1]=l(" Verificación de Tokens ",-1))]),a[2]||(a[2]=t("p",{class:"text-muted-foreground mt-2 max-w-2xl mx-auto"}," Verifica la autenticidad e integridad de cualquier token de votación de forma pública y anónima. Utiliza criptografía digital para garantizar que los votos no han sido alterados. ",-1))]),s(e(C),{class:"max-w-2xl mx-auto w-full"},{default:i(()=>[s(e(q),null,{default:i(()=>[s(e(I),{class:"flex items-center gap-2"},{default:i(()=>[s(e(K),{class:"h-5 w-5"}),a[3]||(a[3]=l(" Buscar Token ",-1))]),_:1})]),_:1}),s(e(w),null,{default:i(()=>[t("div",me,[t("div",null,[s(e(c),{for:"token-input"},{default:i(()=>[...a[4]||(a[4]=[l("Token de Votación",-1)])]),_:1}),s(e(te),{id:"token-input",modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=r=>x.value=r),placeholder:"Pega aquí tu token de votación para verificar...",onKeyup:Z(F,["enter"]),class:"font-mono text-sm"},null,8,["modelValue"])]),t("div",fe,[s(e(L),{onClick:F,disabled:!x.value.trim()||T.value,class:"flex-1"},{default:i(()=>[s(e(K),{class:"mr-2 h-4 w-4"}),l(" "+n(T.value?"Verificando...":"Verificar Token"),1)]),_:1},8,["disabled"]),o.value?(d(),f(e(L),{key:0,onClick:G,variant:"outline"},{default:i(()=>[...a[5]||(a[5]=[l(" Limpiar ",-1)])]),_:1})):v("",!0)])])]),_:1})]),_:1}),o.value?(d(),m("div",ve,[s(e(C),{class:_([(h=p.value)==null?void 0:h.borderColor,(b=p.value)==null?void 0:b.bgColor])},{default:i(()=>[s(e(w),{class:"pt-6"},{default:i(()=>{var r,k,N,B,P,R;return[t("div",_e,[(d(),f(y((r=p.value)==null?void 0:r.icon),{class:_(["h-12 w-12",(k=p.value)==null?void 0:k.color])},null,8,["class"])),t("div",pe,[t("h2",{class:_(["text-2xl font-bold",(N=p.value)==null?void 0:N.color])},n((B=p.value)==null?void 0:B.label),3),t("p",{class:_(["text-sm",(P=p.value)==null?void 0:P.color])},n((R=p.value)==null?void 0:R.description),3)])])]}),_:1})]),_:1},8,["class"]),s(e(C),null,{default:i(()=>[s(e(q),null,{default:i(()=>[s(e(I),{class:"flex items-center gap-2"},{default:i(()=>[s(e(oe),{class:"h-5 w-5"}),a[6]||(a[6]=l(" Información del Token ",-1))]),_:1})]),_:1}),s(e(w),null,{default:i(()=>[t("div",ge,[t("div",null,[s(e(c),{class:"text-sm font-medium text-muted-foreground"},{default:i(()=>[...a[7]||(a[7]=[l("Token",-1)])]),_:1}),t("div",xe,[t("p",ke,n(o.value.token),1),s(e(L),{variant:"outline",size:"sm",onClick:X,class:_({"bg-green-50 border-green-200":$.value})},{default:i(()=>[s(e(ie),{class:"h-4 w-4"}),l(" "+n($.value?"Copiado!":"Copiar"),1)]),_:1},8,["class"])])]),t("div",he,[t("div",null,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[8]||(a[8]=[l("Formato",-1)])]),_:1}),t("div",be,[(d(),f(y(o.value.verification_details.format_valid?e(g):e(V)),{class:_(["h-4 w-4",o.value.verification_details.format_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.format_valid?"Válido":"Inválido"),1)])]),t("div",null,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[9]||(a[9]=[l("Firma Digital",-1)])]),_:1}),t("div",ye,[(d(),f(y(o.value.verification_details.signature_valid?e(g):e(V)),{class:_(["h-4 w-4",o.value.verification_details.signature_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.signature_valid?"Válida":"Inválida"),1)])]),t("div",null,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[10]||(a[10]=[l("Integridad",-1)])]),_:1}),t("div",Ce,[(d(),f(y(o.value.verification_details.hash_valid?e(g):e(V)),{class:_(["h-4 w-4",o.value.verification_details.hash_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.hash_valid?"Íntegro":"Alterado"),1)])]),t("div",null,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[11]||(a[11]=[l("Votación",-1)])]),_:1}),t("div",we,[(d(),f(y(o.value.verification_details.votacion_exists?e(g):e(V)),{class:_(["h-4 w-4",o.value.verification_details.votacion_exists?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.votacion_exists?"Existe":"No existe"),1)])])])])]),_:1})]),_:1}),o.value.votacion?(d(),f(e(C),{key:0},{default:i(()=>[s(e(q),null,{default:i(()=>[s(e(I),null,{default:i(()=>[l(n(o.value.votacion.titulo),1)]),_:1})]),_:1}),s(e(w),null,{default:i(()=>[t("div",Ve,[o.value.votacion.descripcion?(d(),m("p",Te,n(o.value.votacion.descripcion),1)):v("",!0),t("div",Se,[t("div",$e,[s(e(j),{variant:"outline"},{default:i(()=>[l(n(o.value.votacion.categoria),1)]),_:1})]),t("div",Ee,[s(e(le),{class:"h-4 w-4"}),l(" "+n(S(o.value.votacion.fecha_inicio))+" - "+n(S(o.value.votacion.fecha_fin)),1)])])])]),_:1})]),_:1})):v("",!0),o.value.vote_data&&o.value.votacion?(d(),f(e(C),{key:1},{default:i(()=>[s(e(q),null,{default:i(()=>[s(e(I),{class:"flex items-center gap-2"},{default:i(()=>[s(e(g),{class:"h-5 w-5"}),a[12]||(a[12]=l(" Respuestas del Voto ",-1))]),_:1})]),_:1}),s(e(w),null,{default:i(()=>[t("div",qe,[t("div",Ie,[o.value.vote_data.urna_opened_at?(d(),m("div",Le,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[13]||(a[13]=[l("Apertura de Urna",-1)])]),_:1}),t("p",Ae,n(S(o.value.vote_data.urna_opened_at)),1)])):v("",!0),t("div",null,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[14]||(a[14]=[l("Fecha del Voto",-1)])]),_:1}),t("p",De,n(S(o.value.vote_data.vote_created_at||o.value.vote_data.timestamp)),1)]),o.value.vote_data.tiempo_en_urna?(d(),m("div",Fe,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[15]||(a[15]=[l("Tiempo en Urna",-1)])]),_:1}),t("p",Ne,n(o.value.vote_data.tiempo_en_urna.formato_legible||`${o.value.vote_data.tiempo_en_urna.minutos}:${String(o.value.vote_data.tiempo_en_urna.segundos).padStart(2,"0")}`),1)])):v("",!0),t("div",null,[s(e(c),{class:"text-muted-foreground"},{default:i(()=>[...a[16]||(a[16]=[l("Hash de Verificación",-1)])]),_:1}),t("p",Be,n(o.value.vote_data.vote_hash),1)])]),t("div",Pe,[(d(!0),m(z,null,ee(o.value.votacion.formulario_config,(r,k)=>(d(),m("div",{key:r.id,class:"space-y-2"},[t("div",Re,[t("div",ze,[s(e(c),{class:"text-base font-medium"},{default:i(()=>[l(n(k+1)+". "+n(r.title)+" ",1),r.required?(d(),m("span",Ue,"*")):v("",!0)]),_:2},1024),r.description?(d(),m("p",je,n(r.description),1)):v("",!0)]),s(e(j),{variant:"secondary",class:"ml-4"},{default:i(()=>[l(n(r.type==="text"?"Texto":r.type==="textarea"?"Texto largo":r.type==="select"?"Selección":r.type==="radio"?"Opción única":r.type==="checkbox"?"Múltiple":r.type),1)]),_:2},1024)]),t("div",He,[t("p",Oe,n(M(r,o.value.vote_data.respuestas[r.id])),1)]),k<o.value.votacion.formulario_config.length-1?(d(),f(e(ae),{key:0,class:"mt-6"})):v("",!0)]))),128))])])]),_:1})]),_:1})):v("",!0),s(e(H),null,{default:i(()=>[s(e(A),{class:"h-4 w-4"}),s(e(O),null,{default:i(()=>[...a[17]||(a[17]=[t("strong",null,"Verificación criptográfica:",-1),l(" Este token ha sido verificado usando criptografía digital RSA-2048 con SHA-256. La verificación confirma que el voto proviene del sistema oficial y no ha sido alterado. ",-1),t("br",null,null,-1),t("br",null,null,-1),t("strong",null,"Privacidad:",-1),l(" Esta verificación es completamente anónima. No se puede determinar la identidad del votante a partir de este token. ",-1)])]),_:1})]),_:1})])):(d(),m("div",Ke,[s(e(H),null,{default:i(()=>[s(e(ne),{class:"h-4 w-4"}),s(e(O),null,{default:i(()=>[...a[18]||(a[18]=[t("strong",null,"¿Cómo funciona?",-1),t("br",null,null,-1),l(" Cada voto genera un token firmado digitalmente que contiene las respuestas del formulario. Puedes verificar públicamente que tu voto fue procesado correctamente sin revelar tu identidad. ",-1)])]),_:1})]),_:1}),t("div",We,[t("div",Me,[s(e(A),{class:"h-8 w-8 text-blue-600 mx-auto mb-2"}),a[19]||(a[19]=t("h3",{class:"font-medium"},"Seguridad",-1)),a[20]||(a[20]=t("p",{class:"text-muted-foreground"},"Criptografía RSA-2048",-1))]),t("div",Xe,[s(e(g),{class:"h-8 w-8 text-green-600 mx-auto mb-2"}),a[21]||(a[21]=t("h3",{class:"font-medium"},"Verificable",-1)),a[22]||(a[22]=t("p",{class:"text-muted-foreground"},"Integridad garantizada",-1))]),t("div",Ge,[s(e(re),{class:"h-8 w-8 text-purple-600 mx-auto mb-2"}),a[23]||(a[23]=t("h3",{class:"font-medium"},"Público",-1)),a[24]||(a[24]=t("p",{class:"text-muted-foreground"},"Sin autenticación",-1))])])]))])]}),_:1})],64))}});export{ht as default};
