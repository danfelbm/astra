import{d as Q,r as W,s as k,p as Y,i as c,e as s,f as t,q as Z,w as a,g as o,h as i,t as n,j as x,m as u,F as E,k as q,b as C}from"./app-FZoHOgaH.js";import{_ as ee}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BMnM7jZE.js";import{_ as g,c as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-djiwawAA.js";import{c as te,_ as h}from"./createLucideIcon-pi43BedF.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-BEgEQ1Ma.js";import{_ as F}from"./index-B8DuVZ6-.js";import{_ as se,a as ae,b as R,c as p,d as le,e as _}from"./TableHeader.vue_vue_type_script_setup_true_lang-B8pSMG1P.js";import{_ as U,a as B,b as D,c as M,d as v}from"./SelectValue.vue_vue_type_script_setup_true_lang-Bm5Gj1mI.js";import{_ as oe,a as ie,b as re,e as S}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BUkxjj6a.js";import{t as y}from"./index-CvxOO9P_.js";import{l as ne}from"./lodash-DdJWEkOP.js";import{D as de}from"./download-OnXi1Gpt.js";import{U as ue}from"./users-D06yuiCC.js";import{C as me}from"./clock-CNzIr7o0.js";import{C as ce}from"./circle-check-big-B6h8ZwC3.js";import{X as P}from"./x-Bg3XxnFA.js";import{S as fe}from"./search-CSHDnqRM.js";import{F as pe}from"./file-text-C7Yp1Ly8.js";import{E as _e}from"./eye-BU_rTPjC.js";import{C as xe}from"./check-D8MJB2af.js";import{C as ve}from"./chevron-left-C0qEKhAp.js";import{C as ge}from"./chevron-right-BmPlSaC-.js";import{f as we,e as ye}from"./es-BDPlFIsO.js";import"./useFlashMessages-Bm7N6KRp.js";import"./index-axiiZVyU.js";import"./floating-ui.vue-C3D9D25A.js";import"./index-ybiiC-LH.js";import"./shield-Dq12MYkj.js";import"./user-CPzkR__l.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CuJ5linQ.js";import"./VisuallyHidden-Dbnz2TNK.js";import"./index-Cc-BeIiM.js";import"./Label.vue_vue_type_script_setup_true_lang-waJVfnmL.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CIHwSdjR.js";import"./circle-alert-C2ek-4S9.js";import"./map-pin-DMngM3dy.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-BiptSxHd.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-DbGRc_BL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-Da_6ahJg.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DA-dsnb1.js";import"./tag-uDee8c9E.js";import"./target-ChjALuOe.js";import"./vote-Guhs9Ix2.js";import"./folder-open-CyZnsmsD.js";import"./send-B68USuYn.js";import"./briefcase-C7xhbZjB.js";import"./calendar-tvCvxrpC.js";import"./megaphone-Bf3YxDyR.js";import"./user-check-D5fucGr0.js";import"./clipboard-list-CmSzLpIl.js";import"./mail-BOH-fMhV.js";import"./message-square-CiGRX4EB.js";import"./external-link-M3oE2-QG.js";import"./panel-left-DxDlnwDZ.js";import"./index-Bpcp85lZ.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=te("EllipsisVerticalIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),ke={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},he={class:"flex items-center justify-between"},Ce={class:"flex gap-2"},$e={class:"grid gap-4 md:grid-cols-4"},Se={class:"flex flex-row items-center justify-between space-y-0"},Ve={class:"text-2xl font-bold"},ze={class:"flex flex-row items-center justify-between space-y-0"},je={class:"text-2xl font-bold text-yellow-600"},Ae={class:"flex flex-row items-center justify-between space-y-0"},Ee={class:"text-2xl font-bold text-green-600"},Fe={class:"flex flex-row items-center justify-between space-y-0"},Re={class:"text-2xl font-bold text-red-600"},Ue={class:"grid gap-4 md:grid-cols-5"},Be={class:"mt-4"},De={key:0,class:"text-center py-8"},Me={key:1,class:"rounded-md border"},Pe={class:"font-semibold"},Te={class:"text-sm text-muted-foreground"},Le={class:"space-y-1"},Ne={key:0,class:"text-sm"},Ie={key:1,class:"text-sm"},He={key:2,class:"text-sm"},Ge={key:3,class:"text-sm text-muted-foreground"},Oe={key:1,class:"text-sm text-muted-foreground"},Xe={class:"text-sm"},Je={key:0,class:"text-sm"},Ke={key:1,class:"text-sm text-muted-foreground"},Qe={key:2,class:"flex items-center justify-between mt-4"},We={class:"text-sm text-muted-foreground"},Ye={class:"flex items-center space-x-2"},Ze={class:"text-sm"},ts=Q({__name:"Index",props:{requests:{},stats:{},filters:{}},setup(d){const V=window.route,b=d,T=[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Solicitudes de Actualizaci贸n",href:"/admin/solicitudes-actualizacion"}],m=W({status:b.filters.status||"all",has_documents:b.filters.has_documents||"all",date_from:b.filters.date_from||"",date_to:b.filters.date_to||"",search:b.filters.search||""}),z=()=>Object.entries(m.value).reduce((r,[e,l])=>(l&&l!=="all"&&(r[e]=l),r),{}),L=ne.debounce(()=>{const r=z();k.get("/admin/solicitudes-actualizacion",{...r,page:1},{preserveState:!0,preserveScroll:!0})},300);Y(()=>m.value,()=>{L()},{deep:!0});const N=()=>{m.value={status:"all",has_documents:"all",date_from:"",date_to:"",search:""}},j=r=>{const e=z();k.get("/admin/solicitudes-actualizacion",{...e,page:r},{preserveState:!0,preserveScroll:!0})},I=r=>{k.visit(`/admin/solicitudes-actualizacion/${r}`)},H=r=>{confirm("驴Aprobar esta solicitud de actualizaci贸n?")&&k.post(V("admin.update-requests.approve",{updateRequest:r}),{notes:"Aprobado desde lista"},{preserveScroll:!0,onSuccess:e=>{const l=e.props.flash;l!=null&&l.success?y.success(l.success):y.success("Solicitud aprobada correctamente")},onError:e=>{console.error("Error:",e);const l=(e==null?void 0:e.message)||"Error al aprobar la solicitud";y.error(l)},onFinish:e=>{const l=e.props.flash;l!=null&&l.error&&y.error(l.error)}})},G=r=>{const e=prompt("Motivo del rechazo:");e&&k.post(V("admin.update-requests.reject",{updateRequest:r}),{notes:e},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{y.success("Solicitud rechazada")},onError:l=>{console.error("Error:",l),y.error("Error al rechazar la solicitud")}})},O=()=>{window.location.href="/admin/solicitudes-actualizacion/export/csv?"+new URLSearchParams(m.value).toString()},X=r=>r?we(new Date(r),"dd MMM yyyy HH:mm",{locale:ye}):"-",J=r=>{switch(r){case"pending":return"warning";case"approved":return"success";case"rejected":return"destructive";default:return"secondary"}},K=r=>{switch(r){case"pending":return"Pendiente";case"approved":return"Aprobada";case"rejected":return"Rechazada";default:return r}};return(r,e)=>(u(),c(E,null,[s(t(Z),{title:"Solicitudes de Actualizaci贸n"}),s(ee,{breadcrumbs:T},{default:a(()=>[o("div",ke,[o("div",he,[e[8]||(e[8]=o("div",null,[o("h1",{class:"text-3xl font-bold tracking-tight"},"Solicitudes de Actualizaci贸n"),o("p",{class:"text-muted-foreground"}," Gestiona las solicitudes de actualizaci贸n de datos de usuarios ")],-1)),o("div",Ce,[s(t(h),{onClick:O,variant:"outline"},{default:a(()=>[s(t(de),{class:"mr-2 h-4 w-4"}),e[7]||(e[7]=i(" Exportar CSV ",-1))]),_:1})])]),o("div",$e,[s(t(g),null,{default:a(()=>[s(t(w),{class:"pt-6"},{default:a(()=>[o("div",Se,[o("div",null,[e[9]||(e[9]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Total Solicitudes",-1)),o("p",Ve,n(d.stats.total),1)]),s(t(ue),{class:"h-4 w-4 text-muted-foreground"})])]),_:1})]),_:1}),s(t(g),null,{default:a(()=>[s(t(w),{class:"pt-6"},{default:a(()=>[o("div",ze,[o("div",null,[e[10]||(e[10]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Pendientes",-1)),o("p",je,n(d.stats.pending),1)]),s(t(me),{class:"h-4 w-4 text-yellow-500"})])]),_:1})]),_:1}),s(t(g),null,{default:a(()=>[s(t(w),{class:"pt-6"},{default:a(()=>[o("div",Ae,[o("div",null,[e[11]||(e[11]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Aprobadas",-1)),o("p",Ee,n(d.stats.approved),1)]),s(t(ce),{class:"h-4 w-4 text-green-500"})])]),_:1})]),_:1}),s(t(g),null,{default:a(()=>[s(t(w),{class:"pt-6"},{default:a(()=>[o("div",Fe,[o("div",null,[e[12]||(e[12]=o("p",{class:"text-sm font-medium text-muted-foreground"},"Rechazadas",-1)),o("p",Re,n(d.stats.rejected),1)]),s(t(P),{class:"h-4 w-4 text-red-500"})])]),_:1})]),_:1})]),s(t(g),null,{default:a(()=>[s(t(w),{class:"pt-6"},{default:a(()=>[o("div",Ue,[o("div",null,[s(t($),{modelValue:m.value.search,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value.search=l),placeholder:"Buscar por nombre/documento...",class:"w-full"},{prefix:a(()=>[s(t(fe),{class:"h-4 w-4 text-muted-foreground"})]),_:1},8,["modelValue"])]),s(t(U),{modelValue:m.value.status,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value.status=l)},{default:a(()=>[s(t(B),null,{default:a(()=>[s(t(D),{placeholder:"Estado"})]),_:1}),s(t(M),null,{default:a(()=>[s(t(v),{value:"all"},{default:a(()=>[...e[13]||(e[13]=[i("Todos",-1)])]),_:1}),s(t(v),{value:"pending"},{default:a(()=>[...e[14]||(e[14]=[i("Pendiente",-1)])]),_:1}),s(t(v),{value:"approved"},{default:a(()=>[...e[15]||(e[15]=[i("Aprobada",-1)])]),_:1}),s(t(v),{value:"rejected"},{default:a(()=>[...e[16]||(e[16]=[i("Rechazada",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(t(U),{modelValue:m.value.has_documents,"onUpdate:modelValue":e[2]||(e[2]=l=>m.value.has_documents=l)},{default:a(()=>[s(t(B),null,{default:a(()=>[s(t(D),{placeholder:"Documentos"})]),_:1}),s(t(M),null,{default:a(()=>[s(t(v),{value:"all"},{default:a(()=>[...e[17]||(e[17]=[i("Todos",-1)])]),_:1}),s(t(v),{value:"true"},{default:a(()=>[...e[18]||(e[18]=[i("Con documentos",-1)])]),_:1}),s(t(v),{value:"false"},{default:a(()=>[...e[19]||(e[19]=[i("Sin documentos",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(t($),{modelValue:m.value.date_from,"onUpdate:modelValue":e[3]||(e[3]=l=>m.value.date_from=l),type:"date",placeholder:"Fecha desde"},null,8,["modelValue"]),s(t($),{modelValue:m.value.date_to,"onUpdate:modelValue":e[4]||(e[4]=l=>m.value.date_to=l),type:"date",placeholder:"Fecha hasta"},null,8,["modelValue"])]),o("div",Be,[s(t(h),{onClick:N,variant:"outline",size:"sm"},{default:a(()=>[...e[20]||(e[20]=[i(" Limpiar filtros ",-1)])]),_:1})])]),_:1})]),_:1}),s(t(g),null,{default:a(()=>[s(t(w),{class:"pt-6"},{default:a(()=>[d.requests.data.length===0?(u(),c("div",De,[...e[21]||(e[21]=[o("p",{class:"text-muted-foreground"},"No se encontraron solicitudes",-1)])])):(u(),c("div",Me,[s(t(se),null,{default:a(()=>[s(t(ae),null,{default:a(()=>[s(t(R),null,{default:a(()=>[s(t(p),null,{default:a(()=>[...e[22]||(e[22]=[i("#",-1)])]),_:1}),s(t(p),null,{default:a(()=>[...e[23]||(e[23]=[i("Usuario",-1)])]),_:1}),s(t(p),null,{default:a(()=>[...e[24]||(e[24]=[i("Cambios",-1)])]),_:1}),s(t(p),null,{default:a(()=>[...e[25]||(e[25]=[i("Documentos",-1)])]),_:1}),s(t(p),null,{default:a(()=>[...e[26]||(e[26]=[i("Estado",-1)])]),_:1}),s(t(p),null,{default:a(()=>[...e[27]||(e[27]=[i("Fecha",-1)])]),_:1}),s(t(p),null,{default:a(()=>[...e[28]||(e[28]=[i("Admin",-1)])]),_:1}),s(t(p),{class:"text-right"},{default:a(()=>[...e[29]||(e[29]=[i("Acciones",-1)])]),_:1})]),_:1})]),_:1}),s(t(le),null,{default:a(()=>[(u(!0),c(E,null,q(d.requests.data,l=>(u(),C(t(R),{key:l.id},{default:a(()=>[s(t(_),{class:"font-medium"},{default:a(()=>[i(n(l.id),1)]),_:2},1024),s(t(_),null,{default:a(()=>[o("div",null,[o("p",Pe,n(l.user.name),1),o("p",Te,n(l.user.documento_identidad),1)])]),_:2},1024),s(t(_),null,{default:a(()=>{var f,A;return[o("div",Le,[l.new_email?(u(),c("div",Ne,"  "+n(l.new_email),1)):x("",!0),l.new_telefono?(u(),c("div",Ie,"  "+n(l.new_telefono),1)):x("",!0),l.new_municipio?(u(),c("div",He,"  "+n([(f=l.new_departamento)==null?void 0:f.nombre,(A=l.new_municipio)==null?void 0:A.nombre].filter(Boolean).join(", ")),1)):x("",!0),!l.new_email&&!l.new_telefono&&!l.new_municipio?(u(),c("div",Ge," Sin cambios ")):x("",!0)])]}),_:2},1024),s(t(_),null,{default:a(()=>{var f;return[((f=l.documentos_soporte)==null?void 0:f.length)>0?(u(),C(t(F),{key:0},{default:a(()=>[s(t(pe),{class:"mr-1 h-3 w-3"}),i(" "+n(l.documentos_soporte.length),1)]),_:2},1024)):(u(),c("span",Oe,"-"))]}),_:2},1024),s(t(_),null,{default:a(()=>[s(t(F),{variant:J(l.status)},{default:a(()=>[i(n(K(l.status)),1)]),_:2},1032,["variant"])]),_:2},1024),s(t(_),null,{default:a(()=>[o("span",Xe,n(X(l.created_at)),1)]),_:2},1024),s(t(_),null,{default:a(()=>[l.admin?(u(),c("span",Je,n(l.admin.name),1)):(u(),c("span",Ke,"-"))]),_:2},1024),s(t(_),{class:"text-right"},{default:a(()=>[s(t(oe),null,{default:a(()=>[s(t(ie),{"as-child":""},{default:a(()=>[s(t(h),{variant:"ghost",size:"icon"},{default:a(()=>[s(t(be),{class:"h-4 w-4"})]),_:1})]),_:1}),s(t(re),{align:"end"},{default:a(()=>[s(t(S),{onClick:f=>I(l.id)},{default:a(()=>[s(t(_e),{class:"mr-2 h-4 w-4"}),e[30]||(e[30]=i(" Ver detalle ",-1))]),_:1},8,["onClick"]),l.status==="pending"?(u(),C(t(S),{key:0,onClick:f=>H(l.id),class:"text-green-600"},{default:a(()=>[s(t(xe),{class:"mr-2 h-4 w-4"}),e[31]||(e[31]=i(" Aprobar ",-1))]),_:1},8,["onClick"])):x("",!0),l.status==="pending"?(u(),C(t(S),{key:1,onClick:f=>G(l.id),class:"text-red-600"},{default:a(()=>[s(t(P),{class:"mr-2 h-4 w-4"}),e[32]||(e[32]=i(" Rechazar ",-1))]),_:1},8,["onClick"])):x("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])),d.requests.last_page>1?(u(),c("div",Qe,[o("div",We," Mostrando "+n(d.requests.from||0)+" a "+n(d.requests.to||0)+" de "+n(d.requests.total)+" resultados ",1),o("div",Ye,[s(t(h),{onClick:e[5]||(e[5]=l=>j(d.requests.current_page-1)),disabled:d.requests.current_page===1,variant:"outline",size:"sm"},{default:a(()=>[s(t(ve),{class:"h-4 w-4"}),e[33]||(e[33]=i(" Anterior ",-1))]),_:1},8,["disabled"]),o("div",Ze," P谩gina "+n(d.requests.current_page)+" de "+n(d.requests.last_page),1),s(t(h),{onClick:e[6]||(e[6]=l=>j(d.requests.current_page+1)),disabled:d.requests.current_page===d.requests.last_page,variant:"outline",size:"sm"},{default:a(()=>[e[34]||(e[34]=i(" Siguiente ",-1)),s(t(ge),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])):x("",!0)]),_:1})]),_:1})])]),_:1})],64))}});export{ts as default};
