import{d as w,C,k as D,c as b,a as E,o as z,b as i,u as e,m as k,e as s,f as a,t as m,g as l,n as F,h as B,F as q,W as L}from"./app-Bywfx_ml.js";import{_ as S}from"./index-Cno0IQxw.js";import{_ as h}from"./createLucideIcon-FkVd53OX.js";import{_ as x,c as $,a as U,b as N}from"./CardTitle.vue_vue_type_script_setup_true_lang-CldQR6g9.js";import{_ as P,a as R,b as j,c as W,d as H,e as I,f as Z,g as J}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-Cpxcjv__.js";import{_ as K}from"./UserLayout.vue_vue_type_script_setup_true_lang-Bsn6r2tt.js";import{D as O}from"./DynamicFormRenderer-CLjtH2HO.js";import{A as Q}from"./arrow-left-B_JfcKnD.js";import{C as X}from"./clock-DYWb1AX_.js";import{T as Y}from"./triangle-alert-BZMBy-rF.js";import{V as A}from"./vote-BUAa5LxR.js";import"./index-CftsjdQX.js";import"./VisuallyHidden-FcgVIwgs.js";import"./Input.vue_vue_type_script_setup_true_lang-CxaxIk_k.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-Dgmw3vod.js";import"./PopperContent-BYQgMTsN.js";import"./floating-ui.vue-CY6i3Hml.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-aNd5mOSC.js";import"./check-D3O-V1OF.js";import"./nullish-CHIgUVhi.js";import"./x-1ihn3QHR.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C-UWQlVl.js";import"./index-ClWSenH1.js";import"./index-B5ONv_w2.js";import"./shield-DUNEBTXe.js";import"./user-DSkF_2iF.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CihCd30d.js";import"./Label.vue_vue_type_script_setup_true_lang-auZCtUj0.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CaYLRMs9.js";import"./index-B4rJ-Toz.js";import"./circle-alert-C_55rC1m.js";import"./map-pin-BuNky5Mk.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-MCT3fXxF.js";import"./square-check-big-C6E61CTf.js";import"./file-text-CtJXtRnK.js";import"./users-Bnw7SyAM.js";import"./index-aA3b8MlC.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-BD9n7BPv.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-B7HRxtHu.js";import"./Textarea.vue_vue_type_script_setup_true_lang-CgI1e-Zm.js";import"./plus-Zzf4cwGN.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-CpGK3yL_.js";import"./RovingFocusItem-DdD271Lh.js";import"./utils-DuXaafzm.js";import"./VisuallyHiddenInput-D38zWEE5.js";import"./useConditionalFields-idy1cgm9.js";import"./upload-LmwwlrUj.js";import"./eye-CSVDqNQ8.js";import"./download-Br5xTFUJ.js";import"./calendar-BZsIr4Tq.js";import"./grip-vertical-D5R52uEm.js";import"./trash-2-CsBl4p4U.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oo={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},to={class:"flex items-center justify-between"},eo={class:"text-3xl font-bold"},io={class:"text-muted-foreground"},ao={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},so={class:"flex items-center gap-2"},ro={class:"flex items-center gap-2 text-sm text-muted-foreground"},no={class:"flex items-center gap-2 text-sm"},mo={class:"mt-4 pt-4 border-t"},lo={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},co={class:"text-muted-foreground"},fo={class:"mt-1"},uo={class:"text-muted-foreground"},po={class:"mt-1 font-semibold text-primary"},_o={class:"text-xs text-muted-foreground ml-1"},vo={class:"flex justify-end pt-6 border-t"},gt=w({__name:"Votar",props:{votacion:{},candidatosElegibles:{}},setup(T){const r=T,M=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Votaciones",href:"/miembro/votaciones"},{title:"Votar",href:"#"}],c=C((()=>{const t={};return r.votacion.formulario_config.forEach(o=>{o.type==="checkbox"?t[o.id]=[]:o.type==="convocatoria"?t[o.id]=void 0:t[o.id]=""}),{respuestas:t}})()),u=D(!1),y=()=>{c.post(route("user.votaciones.store",{votacion:r.votacion.id}),{onSuccess:()=>{},onError:t=>{console.error("Errores de validación:",t)}})},V=()=>{L.get(route("user.votaciones.index"))},v=t=>({"America/Bogota":"GMT-5","America/Mexico_City":"GMT-6","America/Lima":"GMT-5","America/Argentina/Buenos_Aires":"GMT-3","America/Santiago":"GMT-3","America/Caracas":"GMT-4","America/La_Paz":"GMT-4","America/Guayaquil":"GMT-5","America/Asuncion":"GMT-3","America/Montevideo":"GMT-3","America/Panama":"GMT-5","America/Costa_Rica":"GMT-6","America/Guatemala":"GMT-6","America/Havana":"GMT-5","America/Santo_Domingo":"GMT-4"})[t]||t,p=(t,o=!0)=>{const n=t.includes("local")?t:t===r.votacion.fecha_inicio&&r.votacion.fecha_inicio_local?r.votacion.fecha_inicio_local:t===r.votacion.fecha_fin&&r.votacion.fecha_fin_local?r.votacion.fecha_fin_local:t,d=new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(o&&r.votacion.timezone){const f=v(r.votacion.timezone);return`${d} (${f})`}return d},_=b(()=>{const t=new Date,n=new Date(r.votacion.fecha_fin_local||r.votacion.fecha_fin).getTime()-t.getTime();if(n<=0)return"Expirada";const d=Math.floor(n/(1e3*60*60)),f=Math.floor(n%(1e3*60*60)/(1e3*60));if(d>24){const g=Math.floor(d/24);return`${g} día${g>1?"s":""}`}else return d>0?`${d}h ${f}m`:`${f}m`}),G=b(()=>r.votacion.formulario_config.every(t=>{const o=c.respuestas[t.id];return t.type==="convocatoria"?o!==void 0:t.required?t.type==="checkbox"?Array.isArray(o)&&o.length>0:o&&o.toString().trim()!=="":!0}));return(t,o)=>(z(),E(q,null,[i(e(k),{title:`Votar: ${t.votacion.titulo}`},null,8,["title"]),i(K,{breadcrumbs:M},{default:s(()=>[a("div",oo,[a("div",to,[a("div",null,[a("h1",eo,m(t.votacion.titulo),1),a("p",io,m(t.votacion.descripcion),1)]),i(e(h),{variant:"outline",onClick:V},{default:s(()=>[i(e(Q),{class:"mr-2 h-4 w-4"}),o[3]||(o[3]=l(" Volver ",-1))]),_:1})]),i(e(x),null,{default:s(()=>[i(e($),{class:"pt-6"},{default:s(()=>[a("div",ao,[a("div",so,[i(e(S),{variant:"outline"},{default:s(()=>[l(m(t.votacion.categoria.nombre),1)]),_:1})]),a("div",ro,[i(e(X),{class:"h-4 w-4"}),l(" Termina: "+m(p(t.votacion.fecha_fin)),1)]),a("div",no,[i(e(Y),{class:"h-4 w-4 text-orange-600"}),a("span",{class:F(_.value==="Expirada"?"text-red-600":"text-orange-600")},m(_.value==="Expirada"?"Votación expirada":`Tiempo restante: ${_.value}`),3)])]),a("div",mo,[a("div",lo,[a("div",co,[o[4]||(o[4]=a("span",{class:"font-medium"},"Periodo de votación:",-1)),a("div",fo," Inicio: "+m(p(t.votacion.fecha_inicio)),1),a("div",null," Fin: "+m(p(t.votacion.fecha_fin)),1)]),a("div",uo,[o[5]||(o[5]=a("span",{class:"font-medium"},"Zona horaria:",-1)),a("div",po,[l(m(v(t.votacion.timezone))+" ",1),a("span",_o,"("+m(t.votacion.timezone)+")",1)])])])])]),_:1})]),_:1}),i(e(x),null,{default:s(()=>[i(e(U),null,{default:s(()=>[i(e(N),{class:"flex items-center gap-2"},{default:s(()=>[i(e(A),{class:"h-5 w-5"}),o[6]||(o[6]=l(" Formulario de Votación ",-1))]),_:1})]),_:1}),i(e($),null,{default:s(()=>[a("form",{onSubmit:o[1]||(o[1]=B(n=>u.value=!0,["prevent"])),class:"space-y-6"},[i(O,{fields:t.votacion.formulario_config,modelValue:e(c).respuestas,"onUpdate:modelValue":o[0]||(o[0]=n=>e(c).respuestas=n),"candidatos-elegibles":t.candidatosElegibles||{},errors:e(c).errors,disabled:e(c).processing,title:"",description:"",context:"votacion"},null,8,["fields","modelValue","candidatos-elegibles","errors","disabled"]),a("div",vo,[i(e(h),{type:"submit",disabled:!G.value||e(c).processing,class:"min-w-32"},{default:s(()=>[i(e(A),{class:"mr-2 h-4 w-4"}),l(" "+m(e(c).processing?"Enviando...":"Enviar Voto"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),i(e(P),{open:u.value,"onUpdate:open":o[2]||(o[2]=n=>u.value=n)},{default:s(()=>[i(e(R),null,{default:s(()=>[i(e(j),null,{default:s(()=>[i(e(W),null,{default:s(()=>[...o[7]||(o[7]=[l("¿Confirmar voto?",-1)])]),_:1}),i(e(H),null,{default:s(()=>[...o[8]||(o[8]=[l(" Una vez enviado tu voto, no podrás modificarlo. ¿Estás seguro de que quieres proceder? ",-1)])]),_:1})]),_:1}),i(e(I),null,{default:s(()=>[i(e(Z),null,{default:s(()=>[...o[9]||(o[9]=[l("Cancelar",-1)])]),_:1}),i(e(J),{onClick:y,class:"bg-primary"},{default:s(()=>[...o[10]||(o[10]=[l(" Confirmar Voto ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{gt as default};
