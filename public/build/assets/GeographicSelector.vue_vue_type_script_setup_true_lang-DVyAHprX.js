import{a as ee,_ as ae}from"./CardContent.vue_vue_type_script_setup_true_lang-Bntkxlet.js";import{_ as le,a as ie}from"./CardTitle.vue_vue_type_script_setup_true_lang-DK2ilspb.js";import{_ as M}from"./Label.vue_vue_type_script_setup_true_lang-BzJ2EVso.js";import{_ as T,a as U,b as D,c as E,d as L}from"./SelectValue.vue_vue_type_script_setup_true_lang-D4QYm6QX.js";import{d as te,k as w,c as k,s as oe,j as f,o as u,e as d,i as v,u as t,b as s,f as R,g as _,t as c,l as W,a as p,F as A,r as F,n as de,x as g}from"./app-C3cTzfVp.js";const se={class:"text-sm text-muted-foreground"},re={key:0,class:"text-xs text-muted-foreground mt-1"},ue={key:0},ne={key:0,class:"text-xs text-muted-foreground mt-1"},ce={key:1},me={key:0,class:"text-xs text-muted-foreground mt-1"},pe={key:2},_e={key:0,class:"text-xs text-muted-foreground mt-1"},Ve=te({__name:"GeographicSelector",props:{modelValue:{default:()=>({territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[]})},disabled:{type:Boolean,default:!1},title:{default:"Ubicación Geográfica"},description:{default:"Selecciona la ubicación"},mode:{default:"multiple"},showCard:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(X,{emit:Y}){const n=X,Z=Y,J=w([]),x=w([]),C=w([]),j=w([]),m=w(!1),o=k(()=>n.mode==="multiple"),h=k(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.territorios_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.territorio_id;return l?[l]:[]}}),y=k(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.departamentos_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.departamento_id;return l?[l]:[]}}),V=k(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.municipios_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.municipio_id;return l?[l]:[]}}),G=k(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.localidades_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.localidad_id;return l?[l]:[]}}),I=async()=>{try{m.value=!0;const e=await fetch("/admin/geographic/territorios");J.value=await e.json()}catch(e){console.error("Error loading territorios:",e)}finally{m.value=!1}},z=async e=>{if(!e.length){x.value=[];return}try{m.value=!0;const a=await fetch(`/admin/geographic/departamentos?territorio_ids=${e.join(",")}`);x.value=await a.json()}catch(a){console.error("Error loading departamentos:",a)}finally{m.value=!1}},q=async e=>{if(!e.length){C.value=[];return}try{m.value=!0;const a=await fetch(`/admin/geographic/municipios?departamento_ids=${e.join(",")}`);C.value=await a.json()}catch(a){console.error("Error loading municipios:",a)}finally{m.value=!1}},H=async e=>{if(!e.length){j.value=[];return}try{m.value=!0;const a=await fetch(`/admin/geographic/localidades?municipio_ids=${e.join(",")}`);j.value=await a.json()}catch(a){console.error("Error loading localidades:",a)}finally{m.value=!1}},B=(e,a)=>{var b,S,$,i,K,O,P,Q;let l;if(o.value){const r=Array.isArray(e)?e.map(Number).filter(Boolean):e?[Number(e)].filter(Boolean):[];l={territorios_ids:((b=n.modelValue)==null?void 0:b.territorios_ids)||[],departamentos_ids:((S=n.modelValue)==null?void 0:S.departamentos_ids)||[],municipios_ids:(($=n.modelValue)==null?void 0:$.municipios_ids)||[],localidades_ids:((i=n.modelValue)==null?void 0:i.localidades_ids)||[]},a==="territorio"?(l.territorios_ids=r,l.departamentos_ids=[],l.municipios_ids=[],l.localidades_ids=[],g(()=>z(r))):a==="departamento"?(l.departamentos_ids=r,l.municipios_ids=[],l.localidades_ids=[],g(()=>q(r))):a==="municipio"?(l.municipios_ids=r,l.localidades_ids=[],g(()=>H(r))):a==="localidad"&&(l.localidades_ids=r)}else{const r=e?Number(e):void 0;l={territorio_id:(K=n.modelValue)==null?void 0:K.territorio_id,departamento_id:(O=n.modelValue)==null?void 0:O.departamento_id,municipio_id:(P=n.modelValue)==null?void 0:P.municipio_id,localidad_id:(Q=n.modelValue)==null?void 0:Q.localidad_id},a==="territorio"?(l.territorio_id=r,l.departamento_id=void 0,l.municipio_id=void 0,l.localidad_id=void 0,g(()=>z(r?[r]:[]))):a==="departamento"?(l.departamento_id=r,l.municipio_id=void 0,l.localidad_id=void 0,g(()=>q(r?[r]:[]))):a==="municipio"?(l.municipio_id=r,l.localidad_id=void 0,g(()=>H(r?[r]:[]))):a==="localidad"&&(l.localidad_id=r)}Z("update:modelValue",l)};oe(async()=>{await I(),h.value.length&&await z(h.value),y.value.length&&await q(y.value),V.value.length&&await H(V.value)});const N=(e,a,l)=>o.value?`${e} ${e===1?a:l} seleccionado${e===1?"":"s"}`:"";return(e,a)=>(u(),f(W(e.showCard?t(ae):"div"),{class:de(e.showCard?"border-dashed":"")},{default:d(()=>[e.showCard?(u(),f(t(le),{key:0},{default:d(()=>[s(t(ie),{class:"text-base"},{default:d(()=>[_(c(e.title),1)]),_:1}),R("p",se,c(e.description),1)]),_:1})):v("",!0),(u(),f(W(e.showCard?t(ee):"div"),{class:"space-y-4"},{default:d(()=>{var l,b,S,$;return[R("div",null,[s(t(M),null,{default:d(()=>[_("Territorio"+c(o.value?"s":""),1)]),_:1}),s(t(T),{"model-value":o.value?h.value.map(i=>i.toString()):((l=h.value[0])==null?void 0:l.toString())||"","onUpdate:modelValue":a[0]||(a[0]=i=>B(i,"territorio")),multiple:o.value,disabled:e.disabled||m.value},{default:d(()=>[s(t(U),null,{default:d(()=>[s(t(D),{placeholder:`Seleccionar territorio${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),s(t(E),null,{default:d(()=>[(u(!0),p(A,null,F(J.value,i=>(u(),f(t(L),{key:i.id,value:i.id.toString()},{default:d(()=>[_(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",re,c(N(h.value.length,"territorio","territorios")),1)):v("",!0)]),x.value.length>0?(u(),p("div",ue,[s(t(M),null,{default:d(()=>[_("Departamento"+c(o.value?"s":""),1)]),_:1}),s(t(T),{"model-value":o.value?y.value.map(i=>i.toString()):((b=y.value[0])==null?void 0:b.toString())||"","onUpdate:modelValue":a[1]||(a[1]=i=>B(i,"departamento")),multiple:o.value,disabled:e.disabled||m.value},{default:d(()=>[s(t(U),null,{default:d(()=>[s(t(D),{placeholder:`Seleccionar departamento${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),s(t(E),null,{default:d(()=>[(u(!0),p(A,null,F(x.value,i=>(u(),f(t(L),{key:i.id,value:i.id.toString()},{default:d(()=>[_(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",ne,c(N(y.value.length,"departamento","departamentos")),1)):v("",!0)])):v("",!0),C.value.length>0?(u(),p("div",ce,[s(t(M),null,{default:d(()=>[_("Municipio"+c(o.value?"s":""),1)]),_:1}),s(t(T),{"model-value":o.value?V.value.map(i=>i.toString()):((S=V.value[0])==null?void 0:S.toString())||"","onUpdate:modelValue":a[2]||(a[2]=i=>B(i,"municipio")),multiple:o.value,disabled:e.disabled||m.value},{default:d(()=>[s(t(U),null,{default:d(()=>[s(t(D),{placeholder:`Seleccionar municipio${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),s(t(E),null,{default:d(()=>[(u(!0),p(A,null,F(C.value,i=>(u(),f(t(L),{key:i.id,value:i.id.toString()},{default:d(()=>[_(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",me,c(N(V.value.length,"municipio","municipios")),1)):v("",!0)])):v("",!0),j.value.length>0?(u(),p("div",pe,[s(t(M),null,{default:d(()=>[_("Localidad"+c(o.value?"es":""),1)]),_:1}),s(t(T),{"model-value":o.value?G.value.map(i=>i.toString()):(($=G.value[0])==null?void 0:$.toString())||"","onUpdate:modelValue":a[3]||(a[3]=i=>B(i,"localidad")),multiple:o.value,disabled:e.disabled||m.value},{default:d(()=>[s(t(U),null,{default:d(()=>[s(t(D),{placeholder:`Seleccionar localidad${o.value?"es":""}...`},null,8,["placeholder"])]),_:1}),s(t(E),null,{default:d(()=>[(u(!0),p(A,null,F(j.value,i=>(u(),f(t(L),{key:i.id,value:i.id.toString()},{default:d(()=>[_(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",_e,c(N(G.value.length,"localidad","localidades")),1)):v("",!0)])):v("",!0)]}),_:1}))]),_:1},8,["class"]))}});export{Ve as _};
