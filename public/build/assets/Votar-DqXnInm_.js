import{d as w,C,k as D,c as b,a as E,o as z,b as i,u as e,m as k,e as r,f as a,t as l,g as m,n as F,h as B,F as S,W as q}from"./app-DkmRr0KC.js";import{_ as L}from"./index-DVRv0UkJ.js";import{_ as h}from"./createLucideIcon-DXkxOUK0.js";import{_ as x,c as $,a as U,b as N}from"./CardTitle.vue_vue_type_script_setup_true_lang-C5ejVlRg.js";import{_ as P,a as R,b as j,c as W,d as H,e as I,f as Z,g as J}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-Cs-5ka0s.js";import{_ as K}from"./UserLayout.vue_vue_type_script_setup_true_lang-CXQLvBE_.js";import{D as O}from"./DynamicFormRenderer-BUhiVXuR.js";import{A as Q}from"./arrow-left-D0SI--kH.js";import{C as X}from"./clock-BFv09G8c.js";import{T as Y}from"./triangle-alert-Bi-zYadw.js";import{V as A}from"./vote-_t7hyScb.js";import"./index-C9_fScWN.js";import"./VisuallyHidden-B4JTwG-M.js";import"./Input.vue_vue_type_script_setup_true_lang-DihuhIKU.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CMBoC-Ke.js";import"./PopperContent-a6xuH_X0.js";import"./floating-ui.vue-CeXbWfQj.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CLO-V0CQ.js";import"./check-Co91sU4n.js";import"./nullish-CHIgUVhi.js";import"./x-D_lEJPee.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-DWY7xu_8.js";import"./index-BdJFCkyv.js";import"./index-Bku5qikM.js";import"./shield-Bf5LORgb.js";import"./user-AeqXvCM3.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BBdfce-v.js";import"./Label.vue_vue_type_script_setup_true_lang-CJyIYAf6.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-ZxQp_3oc.js";import"./index-BYI2yCwO.js";import"./circle-alert-Cn12rJzD.js";import"./map-pin-mX_8rXlu.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CzJh65a2.js";import"./square-check-big-BEsnhUwL.js";import"./file-text-DxNfQIRv.js";import"./users-CeUnMfI3.js";import"./index-ljVxmsRr.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-BocLyR7u.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CGBXdJMY.js";import"./Textarea.vue_vue_type_script_setup_true_lang-BcMxfGEX.js";import"./plus-BZtBw6vi.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-AIBEsGCn.js";import"./RovingFocusItem-Mldeqe5o.js";import"./utils-1ENJBrs6.js";import"./VisuallyHiddenInput-Gjm3l0BY.js";import"./useConditionalFields-B5PBjRw9.js";import"./upload-Oe4sEJiV.js";import"./eye-D5bQcE0n.js";import"./download-DTe6pyL0.js";import"./calendar-BT7rYFTu.js";import"./grip-vertical-DGYuFPGT.js";import"./trash-2-Y3FGW_Rn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oo={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},to={class:"flex items-center justify-between"},eo={class:"text-3xl font-bold"},io={class:"text-muted-foreground"},ao={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ro={class:"flex items-center gap-2"},so={class:"flex items-center gap-2 text-sm text-muted-foreground"},no={class:"flex items-center gap-2 text-sm"},lo={class:"mt-4 pt-4 border-t"},mo={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},co={class:"text-muted-foreground"},fo={class:"mt-1"},uo={class:"text-muted-foreground"},po={class:"mt-1 font-semibold text-primary"},_o={class:"text-xs text-muted-foreground ml-1"},vo={class:"flex justify-end pt-6 border-t"},gt=w({__name:"Votar",props:{votacion:{},candidatosElegibles:{}},setup(T){const s=T,M=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Votaciones",href:"/miembro/votaciones"},{title:"Votar",href:"#"}],c=C((()=>{const t={};return s.votacion.formulario_config.forEach(o=>{o.type==="checkbox"?t[o.id]=[]:o.type==="convocatoria"?t[o.id]=void 0:t[o.id]=""}),{respuestas:t}})()),u=D(!1),y=()=>{c.post(route("user.votaciones.store",{votacion:s.votacion.id}),{preserveScroll:!0,preserveState:!1,onSuccess:()=>{},onError:t=>{console.error("Errores de validación:",t)}})},V=()=>{q.get(route("user.votaciones.index"))},v=t=>({"America/Bogota":"GMT-5","America/Mexico_City":"GMT-6","America/Lima":"GMT-5","America/Argentina/Buenos_Aires":"GMT-3","America/Santiago":"GMT-3","America/Caracas":"GMT-4","America/La_Paz":"GMT-4","America/Guayaquil":"GMT-5","America/Asuncion":"GMT-3","America/Montevideo":"GMT-3","America/Panama":"GMT-5","America/Costa_Rica":"GMT-6","America/Guatemala":"GMT-6","America/Havana":"GMT-5","America/Santo_Domingo":"GMT-4"})[t]||t,p=(t,o=!0)=>{const n=t.includes("local")?t:t===s.votacion.fecha_inicio&&s.votacion.fecha_inicio_local?s.votacion.fecha_inicio_local:t===s.votacion.fecha_fin&&s.votacion.fecha_fin_local?s.votacion.fecha_fin_local:t,d=new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(o&&s.votacion.timezone){const f=v(s.votacion.timezone);return`${d} (${f})`}return d},_=b(()=>{const t=new Date,n=new Date(s.votacion.fecha_fin_local||s.votacion.fecha_fin).getTime()-t.getTime();if(n<=0)return"Expirada";const d=Math.floor(n/(1e3*60*60)),f=Math.floor(n%(1e3*60*60)/(1e3*60));if(d>24){const g=Math.floor(d/24);return`${g} día${g>1?"s":""}`}else return d>0?`${d}h ${f}m`:`${f}m`}),G=b(()=>s.votacion.formulario_config.every(t=>{const o=c.respuestas[t.id];return t.type==="convocatoria"?o!==void 0:t.required?t.type==="checkbox"?Array.isArray(o)&&o.length>0:o&&o.toString().trim()!=="":!0}));return(t,o)=>(z(),E(S,null,[i(e(k),{title:`Votar: ${t.votacion.titulo}`},null,8,["title"]),i(K,{breadcrumbs:M},{default:r(()=>[a("div",oo,[a("div",to,[a("div",null,[a("h1",eo,l(t.votacion.titulo),1),a("p",io,l(t.votacion.descripcion),1)]),i(e(h),{variant:"outline",onClick:V},{default:r(()=>[i(e(Q),{class:"mr-2 h-4 w-4"}),o[3]||(o[3]=m(" Volver ",-1))]),_:1})]),i(e(x),null,{default:r(()=>[i(e($),{class:"pt-6"},{default:r(()=>[a("div",ao,[a("div",ro,[i(e(L),{variant:"outline"},{default:r(()=>[m(l(t.votacion.categoria.nombre),1)]),_:1})]),a("div",so,[i(e(X),{class:"h-4 w-4"}),m(" Termina: "+l(p(t.votacion.fecha_fin)),1)]),a("div",no,[i(e(Y),{class:"h-4 w-4 text-orange-600"}),a("span",{class:F(_.value==="Expirada"?"text-red-600":"text-orange-600")},l(_.value==="Expirada"?"Votación expirada":`Tiempo restante: ${_.value}`),3)])]),a("div",lo,[a("div",mo,[a("div",co,[o[4]||(o[4]=a("span",{class:"font-medium"},"Periodo de votación:",-1)),a("div",fo," Inicio: "+l(p(t.votacion.fecha_inicio)),1),a("div",null," Fin: "+l(p(t.votacion.fecha_fin)),1)]),a("div",uo,[o[5]||(o[5]=a("span",{class:"font-medium"},"Zona horaria:",-1)),a("div",po,[m(l(v(t.votacion.timezone))+" ",1),a("span",_o,"("+l(t.votacion.timezone)+")",1)])])])])]),_:1})]),_:1}),i(e(x),null,{default:r(()=>[i(e(U),null,{default:r(()=>[i(e(N),{class:"flex items-center gap-2"},{default:r(()=>[i(e(A),{class:"h-5 w-5"}),o[6]||(o[6]=m(" Formulario de Votación ",-1))]),_:1})]),_:1}),i(e($),null,{default:r(()=>[a("form",{onSubmit:o[1]||(o[1]=B(n=>u.value=!0,["prevent"])),class:"space-y-6"},[i(O,{fields:t.votacion.formulario_config,modelValue:e(c).respuestas,"onUpdate:modelValue":o[0]||(o[0]=n=>e(c).respuestas=n),"candidatos-elegibles":t.candidatosElegibles||{},errors:e(c).errors,disabled:e(c).processing,title:"",description:"",context:"votacion"},null,8,["fields","modelValue","candidatos-elegibles","errors","disabled"]),a("div",vo,[i(e(h),{type:"submit",disabled:!G.value||e(c).processing,class:"min-w-32"},{default:r(()=>[i(e(A),{class:"mr-2 h-4 w-4"}),m(" "+l(e(c).processing?"Enviando...":"Enviar Voto"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),i(e(P),{open:u.value,"onUpdate:open":o[2]||(o[2]=n=>u.value=n)},{default:r(()=>[i(e(R),null,{default:r(()=>[i(e(j),null,{default:r(()=>[i(e(W),null,{default:r(()=>[...o[7]||(o[7]=[m("¿Confirmar voto?",-1)])]),_:1}),i(e(H),null,{default:r(()=>[...o[8]||(o[8]=[m(" Una vez enviado tu voto, no podrás modificarlo. ¿Estás seguro de que quieres proceder? ",-1)])]),_:1})]),_:1}),i(e(I),null,{default:r(()=>[i(e(Z),null,{default:r(()=>[...o[9]||(o[9]=[m("Cancelar",-1)])]),_:1}),i(e(J),{onClick:y,class:"bg-primary"},{default:r(()=>[...o[10]||(o[10]=[m(" Confirmar Voto ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{gt as default};
