import{_ as N,a as D,b as j,c as A}from"./CardTitle.vue_vue_type_script_setup_true_lang-G6BIo_UQ.js";import{_ as q}from"./Input.vue_vue_type_script_setup_true_lang-D33lp28i.js";import{_ as L}from"./Textarea.vue_vue_type_script_setup_true_lang-W4eXJeWz.js";import{_ as B}from"./Label.vue_vue_type_script_setup_true_lang-B6ck6RT6.js";import{_ as M}from"./Checkbox.vue_vue_type_script_setup_true_lang-BiEnS0fV.js";import{_ as w}from"./createLucideIcon-Hey_p6JF.js";import{_ as O,a as G}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-DmjWfUhk.js";import{_ as X,b as H,a as J,d as K,c as Q}from"./SelectValue.vue_vue_type_script_setup_true_lang-DGLWaf-u.js";import{F as W}from"./file-text-Dz7hfeXj.js";import{E as Y}from"./eye-DhZpretq.js";import{D as Z}from"./download-CtWduEMz.js";import{X as _}from"./x-C1oZAMsO.js";import{C as ee}from"./circle-alert-BGNKGfx_.js";import{d as S,r as T,c as I,i as u,e as s,j as h,b as m,w as i,h as g,t as f,f as t,n as k,F as V,k as F,g as b,m as d,o as ae,p as P}from"./app-tiBs69RM.js";const le={class:"space-y-2"},te={key:0,class:"text-red-500"},oe={key:0,class:"text-sm text-gray-500"},de={key:6,class:"flex items-center space-x-2"},se={class:"space-y-2"},re={key:8,class:"space-y-2"},ie={key:0,class:"flex items-center gap-2 p-3 rounded-lg border bg-gray-50 dark:bg-gray-800"},ue={class:"text-sm flex-1 truncate"},ce={class:"flex items-center gap-1"},ne={key:1},me={class:"flex items-center gap-2"},fe={key:0,class:"text-xs text-gray-500 mt-1"},ve={key:9,class:"p-3 bg-gray-100 dark:bg-gray-800 rounded-md"},he={class:"text-sm text-gray-600 dark:text-gray-400"},pe={key:10,class:"flex items-center gap-2 text-sm text-red-600"},R=S({__name:"CampoPersonalizadoInput",props:{campo:{},modelValue:{},error:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:E}){const y=e,c=E,n=T(!1),r=I(()=>y.campo.tipo==="file"&&typeof y.modelValue=="string"&&y.modelValue?y.modelValue:null),v=o=>{c("update:modelValue",o)},$=o=>{c("update:modelValue",o)},U=()=>{r.value&&window.open(`/storage/campos-personalizados/${r.value}`,"_blank")},x=()=>{if(r.value){const o=document.createElement("a");o.href=`/storage/campos-personalizados/${r.value}`,o.download=r.value,o.click()}},C=()=>{n.value=!1},z=o=>{const a=o.target;a.files&&a.files[0]&&c("update:modelValue",a.files[0])};return(o,a)=>(d(),u("div",le,[s(t(B),{for:`campo-${e.campo.id}`},{default:i(()=>[g(f(e.campo.nombre)+" ",1),e.campo.es_requerido?(d(),u("span",te,"*")):h("",!0)]),_:1},8,["for"]),e.campo.descripcion?(d(),u("p",oe,f(e.campo.descripcion),1)):h("",!0),e.campo.tipo==="text"?(d(),m(t(q),{key:1,id:`campo-${e.campo.id}`,type:"text",value:e.modelValue,placeholder:e.campo.placeholder,required:e.campo.es_requerido,disabled:e.disabled,class:k({"border-red-500":e.error}),onInput:a[0]||(a[0]=l=>v(l.target.value))},null,8,["id","value","placeholder","required","disabled","class"])):e.campo.tipo==="number"?(d(),m(t(q),{key:2,id:`campo-${e.campo.id}`,type:"number",value:e.modelValue,placeholder:e.campo.placeholder,required:e.campo.es_requerido,disabled:e.disabled,class:k({"border-red-500":e.error}),onInput:a[1]||(a[1]=l=>v(l.target.value))},null,8,["id","value","placeholder","required","disabled","class"])):e.campo.tipo==="date"?(d(),m(t(q),{key:3,id:`campo-${e.campo.id}`,type:"date",value:e.modelValue,required:e.campo.es_requerido,disabled:e.disabled,class:k({"border-red-500":e.error}),onInput:a[2]||(a[2]=l=>v(l.target.value))},null,8,["id","value","required","disabled","class"])):e.campo.tipo==="textarea"?(d(),m(t(L),{key:4,id:`campo-${e.campo.id}`,"model-value":e.modelValue,placeholder:e.campo.placeholder,required:e.campo.es_requerido,disabled:e.disabled,class:k({"border-red-500":e.error}),rows:"4","onUpdate:modelValue":v},null,8,["id","model-value","placeholder","required","disabled","class"])):e.campo.tipo==="select"?(d(),m(t(X),{key:5,"model-value":e.modelValue,disabled:e.disabled,"onUpdate:modelValue":v},{default:i(()=>[s(t(J),{class:k({"border-red-500":e.error})},{default:i(()=>[s(t(H),{placeholder:e.campo.placeholder||"Seleccione una opción"},null,8,["placeholder"])]),_:1},8,["class"]),s(t(Q),null,{default:i(()=>[(d(!0),u(V,null,F(e.campo.opciones,l=>(d(),m(t(K),{key:l.value,value:l.value},{default:i(()=>[g(f(l.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"])):e.campo.tipo==="checkbox"?(d(),u("div",de,[s(t(M),{id:`campo-${e.campo.id}`,checked:e.modelValue,disabled:e.disabled,"onUpdate:checked":$},null,8,["id","checked","disabled"]),s(t(B),{for:`campo-${e.campo.id}`,class:"text-sm font-normal cursor-pointer"},{default:i(()=>[g(f(e.campo.placeholder||"Marcar esta opción"),1)]),_:1},8,["for"])])):e.campo.tipo==="radio"?(d(),m(t(O),{key:7,"model-value":e.modelValue,disabled:e.disabled,"onUpdate:modelValue":v},{default:i(()=>[b("div",se,[(d(!0),u(V,null,F(e.campo.opciones,l=>(d(),u("div",{key:l.value,class:"flex items-center space-x-2"},[s(t(G),{value:l.value,id:`campo-${e.campo.id}-${l.value}`},null,8,["value","id"]),s(t(B),{for:`campo-${e.campo.id}-${l.value}`,class:"text-sm font-normal cursor-pointer"},{default:i(()=>[g(f(l.label),1)]),_:2},1032,["for"])]))),128))])]),_:1},8,["model-value","disabled"])):e.campo.tipo==="file"?(d(),u("div",re,[r.value&&!n.value?(d(),u("div",ie,[s(t(W),{class:"h-5 w-5 text-gray-500 flex-shrink-0"}),b("span",ue,f(r.value),1),b("div",ce,[s(t(w),{type:"button",variant:"ghost",size:"sm",onClick:U,title:"Ver archivo"},{default:i(()=>[s(t(Y),{class:"h-4 w-4"})]),_:1}),s(t(w),{type:"button",variant:"ghost",size:"sm",onClick:x,title:"Descargar archivo"},{default:i(()=>[s(t(Z),{class:"h-4 w-4"})]),_:1}),s(t(w),{type:"button",variant:"outline",size:"sm",onClick:a[3]||(a[3]=l=>n.value=!0)},{default:i(()=>[...a[4]||(a[4]=[g(" Reemplazar ",-1)])]),_:1})])])):h("",!0),!r.value||n.value?(d(),u("div",ne,[b("div",me,[s(t(q),{id:`campo-${e.campo.id}`,type:"file",required:e.campo.es_requerido&&!r.value,class:k({"border-red-500":e.error,"flex-1":n.value}),onChange:z},null,8,["id","required","class"]),n.value?(d(),m(t(w),{key:0,type:"button",variant:"ghost",size:"sm",onClick:C,title:"Cancelar"},{default:i(()=>[s(t(_),{class:"h-4 w-4"})]),_:1})):h("",!0)]),n.value?(d(),u("p",fe," Selecciona un nuevo archivo para reemplazar el actual ")):h("",!0)])):h("",!0)])):(d(),u("div",ve,[b("p",he,' Tipo de campo "'+f(e.campo.tipo)+'" no soportado ',1)])),e.error?(d(),u("div",pe,[s(t(ee),{class:"h-4 w-4"}),b("span",null,f(e.error),1)])):h("",!0)]))}}),be={key:1,class:"space-y-4"},Ie=S({__name:"CamposPersonalizadosForm",props:{campos:{},modelValue:{},valores:{},errors:{},showCard:{type:Boolean,default:!0},titulo:{default:"Campos Personalizados"},disabled:{type:Boolean,default:!1},grupo:{},grupoFn:{}},emits:["update:modelValue","update"],setup(e,{expose:E,emit:y}){const c=e,n=y,r=T({}),v=I(()=>c.modelValue||c.valores||{});ae(()=>{$()});const $=()=>{const o={...v.value};c.campos.forEach(a=>{a.id in o||(o[a.id]=a.tipo==="checkbox"?!1:"")}),r.value=o};P(()=>v.value,o=>{if(o&&Object.keys(o).length>0){const a={...r.value};Object.keys(o).forEach(l=>{a[l]=o[l]}),r.value=a}},{deep:!0}),P(()=>c.campos,()=>{$()},{deep:!0});const U=o=>{const a=o.slug.toLowerCase();return a.includes("financ")||a.includes("monto")||a.includes("precio")||a.includes("presupuesto")?"financiero":a.includes("info")||a.includes("descrip")||a.includes("nota")?"informacion":"otros"},x=I(()=>{if(!c.grupo)return c.campos;const o=c.grupoFn||U;return c.campos.filter(a=>o(a)===c.grupo)}),C=(o,a)=>{r.value[o]=a,n("update:modelValue",{...r.value}),n("update",{...r.value})},z=o=>{if(c.errors)return c.errors[`campos_personalizados.${o.id}`]||c.errors[`campos_personalizados.${o.slug}`]||c.errors[o.slug]};return E({getValores:()=>({...r.value}),setValor:(o,a)=>{r.value[o]=a,n("update:modelValue",{...r.value}),n("update",{...r.value})}}),(o,a)=>x.value.length>0?(d(),u(V,{key:0},[e.showCard?(d(),m(t(N),{key:0},{default:i(()=>[s(t(D),null,{default:i(()=>[s(t(j),null,{default:i(()=>[g(f(e.titulo),1)]),_:1})]),_:1}),s(t(A),{class:"space-y-4"},{default:i(()=>[(d(!0),u(V,null,F(x.value,l=>(d(),u("div",{key:l.id},[s(R,{campo:l,modelValue:r.value[l.id],"onUpdate:modelValue":[p=>r.value[l.id]=p,p=>C(l.id,p)],error:z(l),disabled:e.disabled},null,8,["campo","modelValue","onUpdate:modelValue","error","disabled"])]))),128))]),_:1})]),_:1})):(d(),u("div",be,[(d(!0),u(V,null,F(x.value,l=>(d(),u("div",{key:l.id},[s(R,{campo:l,modelValue:r.value[l.id],"onUpdate:modelValue":[p=>r.value[l.id]=p,p=>C(l.id,p)],error:z(l),disabled:e.disabled},null,8,["campo","modelValue","onUpdate:modelValue","error","disabled"])]))),128))]))],64)):e.showCard&&!e.grupo?(d(),m(t(N),{key:1},{default:i(()=>[s(t(D),null,{default:i(()=>[s(t(j),null,{default:i(()=>[g(f(e.titulo),1)]),_:1})]),_:1}),s(t(A),null,{default:i(()=>[...a[0]||(a[0]=[b("p",{class:"text-gray-500 text-center py-4"}," No hay campos personalizados configurados ",-1)])]),_:1})]),_:1})):h("",!0)}});export{Ie as _};
