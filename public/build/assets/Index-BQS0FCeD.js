import{d as A,M as P,r as g,c as U,s as v,p as L,b,w as a,g as i,e,i as _,j as w,h as r,m as x,t as y,f as o,v as V,F as M,k as O,n as G}from"./app-BN8Ry2Uz.js";import{_ as I}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CX_YO1Ot.js";import{_ as q,a as H,b as J,c as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-DHiq7Fn8.js";import{_ as C}from"./createLucideIcon-DkYFWMj7.js";import{_ as Q}from"./Input.vue_vue_type_script_setup_true_lang-DYDC1lYY.js";import{_ as k,a as E,b as S,c as F,d as n}from"./SelectValue.vue_vue_type_script_setup_true_lang-CJGv1M4B.js";import{u as R}from"./useToast-uWlZtbhA.js";import{l as W}from"./lodash-8uXp0Sok.js";import{_ as X}from"./ContratosList.vue_vue_type_script_setup_true_lang-CF03Seq7.js";import{D as Y}from"./download-Bi3Xd7lS.js";import{P as Z}from"./plus-D2h2hSfG.js";import{S as tt}from"./search-tCxMKaPs.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BrRSTFu1.js";import"./index-BDCrv6lm.js";import"./floating-ui.vue-D4rwglXX.js";import"./x-BFmIeg5D.js";import"./index-YthOG16x.js";import"./shield-C1_DXaFv.js";import"./user-DIAUTLlT.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CsMtHAMH.js";import"./chevron-right-BiE_jqy-.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BSTuZ3SV.js";import"./VisuallyHidden-C1zWs8BH.js";import"./index-ZlaPHUAE.js";import"./Label.vue_vue_type_script_setup_true_lang-BCztf1NB.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-DQgqwjvD.js";import"./index-ldW_JwnJ.js";import"./circle-alert-CW-wP0pq.js";import"./map-pin-CAp2k_Xq.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-Djb4X3lm.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-DR6TRg5z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-ZTyWxDyP.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C40c5JX9.js";import"./tag-DF4BT472.js";import"./users-CcMEhXu_.js";import"./target-CqtICypL.js";import"./vote-CcXqOEYC.js";import"./folder-open-XAGZLVxS.js";import"./send-Bls9faQY.js";import"./file-text-dm4ZpMmY.js";import"./briefcase-YGI0x6MK.js";import"./calendar-CUMe5TgZ.js";import"./megaphone-DNkfwnI6.js";import"./user-check-GMcLJmPf.js";import"./clipboard-list-Ctnb5vgT.js";import"./mail-DdGNWyVV.js";import"./message-square-PzhqunTd.js";import"./external-link-BRTZwAqM.js";import"./panel-left-CXRaLaWs.js";import"./index-Ptla8SE3.js";import"./check-C7lL3vIK.js";import"./index-Dr9R6Oz5.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-B4lCOxLa.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-2ewVhjc2.js";import"./dollar-sign-DS1jAbvy.js";import"./ellipsis-Snf2Upkh.js";import"./eye-6o4hMQ35.js";import"./square-pen-DTLQKlVD.js";import"./list-d-X0x8Hg.js";import"./copy-f9Im0tCT.js";import"./trash-2-D5jHS43t.js";const ot={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},et={class:"flex flex-col gap-4 md:flex-row md:justify-between md:items-center"},at={class:"text-2xl md:text-3xl font-bold"},rt={key:0,class:"text-xs md:text-sm text-gray-600 block md:inline mt-1 md:mt-0"},st={class:"flex gap-2 flex-wrap"},lt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},it={class:"relative"},nt={key:0,class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},dt={class:"text-xs sm:text-sm text-gray-600 text-center sm:text-left"},mt={class:"flex gap-2 flex-wrap justify-center sm:justify-end"},_o=A({__name:"Index",props:{contratos:{},filters:{},proyecto:{},estadisticas:{}},setup(s){const p=s,B=[{title:"Admin",href:"/admin/dashboard"},{title:"Contratos",href:"/admin/contratos"}];P();const c=R(),f=g(p.filters.search||""),d=g(p.filters.estado||"all"),m=g(p.filters.tipo||"all"),T=U(()=>f.value||d.value&&d.value!=="all"||m.value&&m.value!=="all"||p.filters.vencidos||p.filters.proximos_vencer),$=W.debounce(()=>{var l;v.get(route("admin.contratos.index"),{search:f.value||void 0,estado:d.value==="all"?void 0:d.value,tipo:m.value==="all"?void 0:m.value,proyecto_id:(l=p.proyecto)==null?void 0:l.id,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})},300);L([f,d,m],()=>{$()});const h=()=>{f.value="",d.value="all",m.value="all",$()},j=l=>{confirm(`¿Está seguro de eliminar el contrato "${l.nombre}"?`)&&v.delete(route("admin.contratos.destroy",l.id),{onSuccess:()=>{c.success("Contrato eliminado exitosamente")},onError:()=>{c.error("Error al eliminar el contrato")}})},D=(l,t)=>{v.post(route("admin.contratos.cambiar-estado",l.id),{estado:t},{onSuccess:()=>{c.success("Estado actualizado exitosamente"),v.reload({only:["contratos"]})},onError:()=>{c.error("Error al cambiar el estado")}})},N=l=>{v.post(route("admin.contratos.duplicar",l.id),{},{onSuccess:()=>{c.success("Contrato duplicado exitosamente"),v.reload({only:["contratos"]})},onError:()=>{c.error("Error al duplicar el contrato")}})},z=()=>{window.location.href=route("admin.contratos.export",{search:f.value||void 0,estado:d.value==="all"?void 0:d.value,tipo:m.value==="all"?void 0:m.value})};return(l,t)=>(x(),b(I,{breadcrumbs:B},{default:a(()=>[i("div",ot,[i("div",et,[i("div",null,[i("h1",at,[t[3]||(t[3]=r(" Contratos ",-1)),s.proyecto?(x(),_("span",rt," del proyecto: "+y(s.proyecto.nombre),1)):w("",!0)]),t[4]||(t[4]=i("p",{class:"text-sm md:text-base text-gray-600 mt-1"},"Gestiona los contratos de los proyectos",-1))]),i("div",st,[e(o(C),{variant:"outline",onClick:z,class:"flex-1 sm:flex-none"},{default:a(()=>[e(o(Y),{class:"h-4 w-4 mr-2"}),t[5]||(t[5]=i("span",{class:"hidden sm:inline"},"Exportar",-1))]),_:1}),e(o(V),{href:s.proyecto?l.route("admin.proyectos.contratos.create",s.proyecto.id):l.route("admin.contratos.create"),class:"flex-1 sm:flex-none"},{default:a(()=>[e(o(C),{class:"w-full"},{default:a(()=>[e(o(Z),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=r(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])])]),e(o(q),null,{default:a(()=>[e(o(H),null,{default:a(()=>[e(o(J),{class:"text-lg"},{default:a(()=>[...t[7]||(t[7]=[r("Filtros",-1)])]),_:1})]),_:1}),e(o(K),null,{default:a(()=>[i("div",lt,[i("div",null,[i("div",it,[e(o(tt),{class:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e(o(Q),{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=u=>f.value=u),placeholder:"Buscar contratos...",class:"pl-10"},null,8,["modelValue"])])]),e(o(k),{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=u=>d.value=u)},{default:a(()=>[e(o(E),null,{default:a(()=>[e(o(S),{placeholder:"Todos los estados"})]),_:1}),e(o(F),null,{default:a(()=>[e(o(n),{value:"all"},{default:a(()=>[...t[8]||(t[8]=[r("Todos los estados",-1)])]),_:1}),e(o(n),{value:"borrador"},{default:a(()=>[...t[9]||(t[9]=[r("Borrador",-1)])]),_:1}),e(o(n),{value:"activo"},{default:a(()=>[...t[10]||(t[10]=[r("Activo",-1)])]),_:1}),e(o(n),{value:"finalizado"},{default:a(()=>[...t[11]||(t[11]=[r("Finalizado",-1)])]),_:1}),e(o(n),{value:"cancelado"},{default:a(()=>[...t[12]||(t[12]=[r("Cancelado",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(o(k),{modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=u=>m.value=u)},{default:a(()=>[e(o(E),null,{default:a(()=>[e(o(S),{placeholder:"Todos los tipos"})]),_:1}),e(o(F),null,{default:a(()=>[e(o(n),{value:"all"},{default:a(()=>[...t[13]||(t[13]=[r("Todos los tipos",-1)])]),_:1}),e(o(n),{value:"servicio"},{default:a(()=>[...t[14]||(t[14]=[r("Servicio",-1)])]),_:1}),e(o(n),{value:"obra"},{default:a(()=>[...t[15]||(t[15]=[r("Obra",-1)])]),_:1}),e(o(n),{value:"suministro"},{default:a(()=>[...t[16]||(t[16]=[r("Suministro",-1)])]),_:1}),e(o(n),{value:"consultoria"},{default:a(()=>[...t[17]||(t[17]=[r("Consultoría",-1)])]),_:1}),e(o(n),{value:"otro"},{default:a(()=>[...t[18]||(t[18]=[r("Otro",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),T.value?(x(),b(o(C),{key:0,variant:"outline",onClick:h},{default:a(()=>[...t[19]||(t[19]=[r(" Limpiar Filtros ",-1)])]),_:1})):w("",!0)])]),_:1})]),_:1}),e(X,{contratos:s.contratos.data,"show-proyecto":!s.proyecto,"show-actions":!0,"actions-style":"buttons",onChangeStatus:D,onDuplicate:N,onDelete:j},null,8,["contratos","show-proyecto"]),s.contratos.last_page>1?(x(),_("div",nt,[i("p",dt," Mostrando "+y(s.contratos.from)+" - "+y(s.contratos.to)+" de "+y(s.contratos.total)+" contratos ",1),i("div",mt,[(x(!0),_(M,null,O(s.contratos.last_page,u=>(x(),b(o(V),{key:u,href:l.route("admin.contratos.index",{...p.filters,page:u}),class:G(["px-3 py-1 rounded text-sm",u===s.contratos.current_page?"bg-primary text-white":"bg-gray-100 hover:bg-gray-200"])},{default:a(()=>[r(y(u),1)]),_:2},1032,["href","class"]))),128))])])):w("",!0)])]),_:1}))}});export{_o as default};
