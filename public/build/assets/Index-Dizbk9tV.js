import{d as et,M as lt,r as A,c as st,s as T,p as ot,b as v,w as l,g as i,e,i as z,j as b,h as o,m as u,t as n,f as t,v as y,F as I,k as O,n as B}from"./app-Bwo8gItk.js";import{_ as at}from"./AdminLayout.vue_vue_type_script_setup_true_lang-YCtVpAij.js";import{_ as w,a as V,b as E,c as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-CCSG5iJV.js";import{_ as F}from"./createLucideIcon-CiWTV2sr.js";import{_ as rt}from"./Input.vue_vue_type_script_setup_true_lang-1axY5i_y.js";import{_ as D}from"./index-WQ9DFilu.js";import{_ as it,a as nt,b as N,c as x,d as dt,e as c}from"./TableHeader.vue_vue_type_script_setup_true_lang-CXWdjufp.js";import{_ as G,a as R,b as q,c as H,d as f}from"./SelectValue.vue_vue_type_script_setup_true_lang-Cbbm024S.js";import{_ as ut,a as ft,b as mt,c as pt,d as P,e as S}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DEG_Wv36.js";import{u as ct}from"./useToast-Ch_IE9xd.js";import{l as vt}from"./lodash-eMSSI6Nq.js";import{D as xt}from"./download-CHuyfJkQ.js";import{P as _t}from"./plus-Bflq7jJP.js";import{F as J}from"./file-text-BE7lj9lG.js";import{C as j}from"./circle-alert-BjQ4nvNB.js";import{D as gt}from"./dollar-sign-BSjLa0t8.js";import{S as bt}from"./search-CJZjgN3x.js";import{E as yt}from"./ellipsis-Bi6i19DO.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-Clun62gV.js";import"./index-rDJfqaGK.js";import"./floating-ui.vue-0ZArUiY9.js";import"./x-BLnECrCi.js";import"./index-CgVSfdqX.js";import"./shield-ByLQ2f9R.js";import"./user-C6TSB5_J.js";import"./chevron-right-BfbIuNo5.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-aDqgcxXL.js";import"./VisuallyHidden-D4hNOF66.js";import"./index-ymXBWjcf.js";import"./Label.vue_vue_type_script_setup_true_lang-CnYuL5N8.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BKV7xEtz.js";import"./index-CeoZ0Klu.js";import"./map-pin-Ppz-XqMb.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-DoGHpuwP.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BwGPK6gw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-d1_uBanv.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BREJC4p2.js";import"./tag-CW6t7i9-.js";import"./users-B58AUZuH.js";import"./target-B1zI-nHp.js";import"./vote-C1sfV5Q9.js";import"./folder-open-BO1Ubl99.js";import"./send-DKhPmQQO.js";import"./briefcase-UmhjC-Iz.js";import"./calendar-Np9EKWlU.js";import"./megaphone-lNFWg1ya.js";import"./user-check-DizkiFOQ.js";import"./clipboard-list-BWeBPmBd.js";import"./mail-Ch2yZ2HC.js";import"./message-square-D0aUt5mG.js";import"./external-link-DH3_urnm.js";import"./panel-left-C0kZvL6R.js";import"./check-Y8HDg3In.js";import"./index-D73sxKyv.js";const wt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},$t={class:"flex justify-between items-center"},Ct={class:"text-3xl font-bold"},kt={key:0,class:"text-sm text-gray-600"},Vt={class:"flex gap-2"},Et={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},Ft={class:"text-2xl font-bold"},St={class:"text-2xl font-bold text-green-600"},Tt={class:"text-2xl font-bold text-red-600"},zt={class:"text-2xl font-bold text-yellow-600"},Dt={class:"text-2xl font-bold"},jt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},At={class:"relative"},Bt={class:"flex gap-2 mt-4"},Nt={class:"flex items-center gap-2"},Pt={key:0,class:"flex items-center justify-between"},Mt={class:"text-sm text-gray-600"},Lt={class:"flex gap-2"},Ie=et({__name:"Index",props:{contratos:{},filters:{},proyecto:{},estadisticas:{}},setup(d){const _=d,K=[{title:"Admin",href:"/admin/dashboard"},{title:"Contratos",href:"/admin/contratos"}];lt();const C=ct(),g=A(_.filters.search||""),m=A(_.filters.estado||"all"),p=A(_.filters.tipo||"all"),Q=st(()=>g.value||m.value&&m.value!=="all"||p.value&&p.value!=="all"||_.filters.vencidos||_.filters.proximos_vencer),W=r=>({borrador:"bg-gray-100 text-gray-800",activo:"bg-green-100 text-green-800",finalizado:"bg-blue-100 text-blue-800",cancelado:"bg-red-100 text-red-800"})[r]||"bg-gray-100 text-gray-800",X=r=>({servicio:"bg-purple-100 text-purple-800",obra:"bg-orange-100 text-orange-800",suministro:"bg-indigo-100 text-indigo-800",consultoria:"bg-pink-100 text-pink-800",otro:"bg-gray-100 text-gray-800"})[r]||"bg-gray-100 text-gray-800",M=r=>r?new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"-",L=vt.debounce(()=>{var r;T.get(route("admin.contratos.index"),{search:g.value||void 0,estado:m.value==="all"?void 0:m.value,tipo:p.value==="all"?void 0:p.value,proyecto_id:(r=_.proyecto)==null?void 0:r.id,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})},300);ot([g,m,p],()=>{L()});const Y=()=>{g.value="",m.value="all",p.value="all",L()},Z=r=>{confirm(`¿Está seguro de eliminar el contrato "${r.nombre}"?`)&&T.delete(route("admin.contratos.destroy",r.id),{onSuccess:()=>{C.success("Contrato eliminado exitosamente")},onError:()=>{C.error("Error al eliminar el contrato")}})},U=(r,s)=>{T.post(route("admin.contratos.cambiar-estado",r.id),{estado:s},{onSuccess:()=>{C.success("Estado actualizado exitosamente")},onError:()=>{C.error("Error al cambiar el estado")}})},h=r=>{confirm(`¿Desea duplicar el contrato "${r.nombre}"?`)&&T.post(route("admin.contratos.duplicar",r.id),{},{onSuccess:()=>{C.success("Contrato duplicado exitosamente")},onError:()=>{C.error("Error al duplicar el contrato")}})},tt=()=>{window.location.href=route("admin.contratos.export",{search:g.value||void 0,estado:m.value==="all"?void 0:m.value,tipo:p.value==="all"?void 0:p.value})};return(r,s)=>(u(),v(at,{breadcrumbs:K},{default:l(()=>[i("div",wt,[i("div",$t,[i("div",null,[i("h1",Ct,[s[3]||(s[3]=o(" Contratos ",-1)),d.proyecto?(u(),z("span",kt," del proyecto: "+n(d.proyecto.nombre),1)):b("",!0)]),s[4]||(s[4]=i("p",{class:"text-gray-600 mt-1"},"Gestiona los contratos de los proyectos",-1))]),i("div",Vt,[e(t(F),{variant:"outline",onClick:tt},{default:l(()=>[e(t(xt),{class:"h-4 w-4 mr-2"}),s[5]||(s[5]=o(" Exportar ",-1))]),_:1}),e(t(y),{href:d.proyecto?r.route("admin.proyectos.contratos.create",d.proyecto.id):r.route("admin.contratos.create")},{default:l(()=>[e(t(F),null,{default:l(()=>[e(t(_t),{class:"h-4 w-4 mr-2"}),s[6]||(s[6]=o(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])])]),i("div",Et,[e(t(w),null,{default:l(()=>[e(t(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(E),{class:"text-sm font-medium"},{default:l(()=>[...s[7]||(s[7]=[o("Total",-1)])]),_:1}),e(t(J),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),e(t($),null,{default:l(()=>[i("div",Ft,n(d.estadisticas.total),1)]),_:1})]),_:1}),e(t(w),null,{default:l(()=>[e(t(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(E),{class:"text-sm font-medium"},{default:l(()=>[...s[8]||(s[8]=[o("Activos",-1)])]),_:1}),e(t(J),{class:"h-4 w-4 text-green-600"})]),_:1}),e(t($),null,{default:l(()=>[i("div",St,n(d.estadisticas.activos),1)]),_:1})]),_:1}),e(t(w),null,{default:l(()=>[e(t(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(E),{class:"text-sm font-medium"},{default:l(()=>[...s[9]||(s[9]=[o("Vencidos",-1)])]),_:1}),e(t(j),{class:"h-4 w-4 text-red-600"})]),_:1}),e(t($),null,{default:l(()=>[i("div",Tt,n(d.estadisticas.vencidos),1)]),_:1})]),_:1}),e(t(w),null,{default:l(()=>[e(t(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(E),{class:"text-sm font-medium"},{default:l(()=>[...s[10]||(s[10]=[o("Próximos a Vencer",-1)])]),_:1}),e(t(j),{class:"h-4 w-4 text-yellow-600"})]),_:1}),e(t($),null,{default:l(()=>[i("div",zt,n(d.estadisticas.proximos_vencer),1)]),_:1})]),_:1}),e(t(w),null,{default:l(()=>[e(t(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[e(t(E),{class:"text-sm font-medium"},{default:l(()=>[...s[11]||(s[11]=[o("Monto Total",-1)])]),_:1}),e(t(gt),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),e(t($),null,{default:l(()=>[i("div",Dt,n(d.estadisticas.monto_total),1)]),_:1})]),_:1})]),e(t(w),null,{default:l(()=>[e(t(V),null,{default:l(()=>[e(t(E),{class:"text-lg"},{default:l(()=>[...s[12]||(s[12]=[o("Filtros",-1)])]),_:1})]),_:1}),e(t($),null,{default:l(()=>[i("div",jt,[i("div",null,[i("div",At,[e(t(bt),{class:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e(t(rt),{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=a=>g.value=a),placeholder:"Buscar contratos...",class:"pl-10"},null,8,["modelValue"])])]),e(t(G),{modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=a=>m.value=a)},{default:l(()=>[e(t(R),null,{default:l(()=>[e(t(q),{placeholder:"Todos los estados"})]),_:1}),e(t(H),null,{default:l(()=>[e(t(f),{value:"all"},{default:l(()=>[...s[13]||(s[13]=[o("Todos los estados",-1)])]),_:1}),e(t(f),{value:"borrador"},{default:l(()=>[...s[14]||(s[14]=[o("Borrador",-1)])]),_:1}),e(t(f),{value:"activo"},{default:l(()=>[...s[15]||(s[15]=[o("Activo",-1)])]),_:1}),e(t(f),{value:"finalizado"},{default:l(()=>[...s[16]||(s[16]=[o("Finalizado",-1)])]),_:1}),e(t(f),{value:"cancelado"},{default:l(()=>[...s[17]||(s[17]=[o("Cancelado",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(t(G),{modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=a=>p.value=a)},{default:l(()=>[e(t(R),null,{default:l(()=>[e(t(q),{placeholder:"Todos los tipos"})]),_:1}),e(t(H),null,{default:l(()=>[e(t(f),{value:"all"},{default:l(()=>[...s[18]||(s[18]=[o("Todos los tipos",-1)])]),_:1}),e(t(f),{value:"servicio"},{default:l(()=>[...s[19]||(s[19]=[o("Servicio",-1)])]),_:1}),e(t(f),{value:"obra"},{default:l(()=>[...s[20]||(s[20]=[o("Obra",-1)])]),_:1}),e(t(f),{value:"suministro"},{default:l(()=>[...s[21]||(s[21]=[o("Suministro",-1)])]),_:1}),e(t(f),{value:"consultoria"},{default:l(()=>[...s[22]||(s[22]=[o("Consultoría",-1)])]),_:1}),e(t(f),{value:"otro"},{default:l(()=>[...s[23]||(s[23]=[o("Otro",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Q.value?(u(),v(t(F),{key:0,variant:"outline",onClick:Y},{default:l(()=>[...s[24]||(s[24]=[o(" Limpiar Filtros ",-1)])]),_:1})):b("",!0)]),i("div",Bt,[e(t(y),{href:r.route("admin.contratos.vencidos")},{default:l(()=>[e(t(F),{variant:"outline",size:"sm"},{default:l(()=>[e(t(j),{class:"h-4 w-4 mr-2 text-red-600"}),s[25]||(s[25]=o(" Ver Vencidos ",-1))]),_:1})]),_:1},8,["href"]),e(t(y),{href:r.route("admin.contratos.proximos-vencer")},{default:l(()=>[e(t(F),{variant:"outline",size:"sm"},{default:l(()=>[e(t(j),{class:"h-4 w-4 mr-2 text-yellow-600"}),s[26]||(s[26]=o(" Próximos a Vencer ",-1))]),_:1})]),_:1},8,["href"])])]),_:1})]),_:1}),e(t(w),null,{default:l(()=>[e(t($),{class:"p-0"},{default:l(()=>[e(t(it),null,{default:l(()=>[e(t(nt),null,{default:l(()=>[e(t(N),null,{default:l(()=>[e(t(x),null,{default:l(()=>[...s[27]||(s[27]=[o("Nombre",-1)])]),_:1}),e(t(x),null,{default:l(()=>[...s[28]||(s[28]=[o("Proyecto",-1)])]),_:1}),e(t(x),null,{default:l(()=>[...s[29]||(s[29]=[o("Estado",-1)])]),_:1}),e(t(x),null,{default:l(()=>[...s[30]||(s[30]=[o("Tipo",-1)])]),_:1}),e(t(x),null,{default:l(()=>[...s[31]||(s[31]=[o("Fecha Inicio",-1)])]),_:1}),e(t(x),null,{default:l(()=>[...s[32]||(s[32]=[o("Fecha Fin",-1)])]),_:1}),e(t(x),null,{default:l(()=>[...s[33]||(s[33]=[o("Monto",-1)])]),_:1}),e(t(x),null,{default:l(()=>[...s[34]||(s[34]=[o("Responsable",-1)])]),_:1}),e(t(x),{class:"text-right"},{default:l(()=>[...s[35]||(s[35]=[o("Acciones",-1)])]),_:1})]),_:1})]),_:1}),e(t(dt),null,{default:l(()=>[(u(!0),z(I,null,O(d.contratos.data,a=>(u(),v(t(N),{key:a.id},{default:l(()=>[e(t(c),{class:"font-medium"},{default:l(()=>[i("div",Nt,[o(n(a.nombre)+" ",1),a.esta_vencido?(u(),v(t(D),{key:0,variant:"destructive",class:"text-xs"},{default:l(()=>[...s[36]||(s[36]=[o(" Vencido ",-1)])]),_:1})):a.esta_proximo_vencer?(u(),v(t(D),{key:1,variant:"outline",class:"text-xs text-yellow-600 border-yellow-600"},{default:l(()=>[o(n(a.dias_restantes)+" días ",1)]),_:2},1024)):b("",!0)])]),_:2},1024),e(t(c),null,{default:l(()=>[e(t(y),{href:r.route("admin.proyectos.show",a.proyecto.id),class:"text-blue-600 hover:underline"},{default:l(()=>[o(n(a.proyecto.nombre),1)]),_:2},1032,["href"])]),_:2},1024),e(t(c),null,{default:l(()=>[e(t(D),{class:B(W(a.estado))},{default:l(()=>[o(n(a.estado),1)]),_:2},1032,["class"])]),_:2},1024),e(t(c),null,{default:l(()=>[e(t(D),{class:B(X(a.tipo))},{default:l(()=>[o(n(a.tipo),1)]),_:2},1032,["class"])]),_:2},1024),e(t(c),null,{default:l(()=>[o(n(M(a.fecha_inicio)),1)]),_:2},1024),e(t(c),null,{default:l(()=>[o(n(M(a.fecha_fin)),1)]),_:2},1024),e(t(c),null,{default:l(()=>[o(n(a.monto_formateado||"-"),1)]),_:2},1024),e(t(c),null,{default:l(()=>{var k;return[o(n(((k=a.responsable)==null?void 0:k.name)||"-"),1)]}),_:2},1024),e(t(c),{class:"text-right"},{default:l(()=>[e(t(ut),null,{default:l(()=>[e(t(ft),{asChild:""},{default:l(()=>[e(t(F),{variant:"ghost",size:"sm"},{default:l(()=>[e(t(yt),{class:"h-4 w-4"})]),_:1})]),_:1}),e(t(mt),{align:"end"},{default:l(()=>[e(t(pt),null,{default:l(()=>[...s[37]||(s[37]=[o("Acciones",-1)])]),_:1}),e(t(P)),e(t(y),{href:r.route("admin.contratos.show",a.id)},{default:l(()=>[e(t(S),null,{default:l(()=>[...s[38]||(s[38]=[o("Ver detalles",-1)])]),_:1})]),_:1},8,["href"]),e(t(y),{href:r.route("admin.contratos.edit",a.id)},{default:l(()=>[e(t(S),null,{default:l(()=>[...s[39]||(s[39]=[o("Editar",-1)])]),_:1})]),_:1},8,["href"]),e(t(P)),a.estado==="borrador"?(u(),v(t(S),{key:0,onClick:k=>U(a,"activo")},{default:l(()=>[...s[40]||(s[40]=[o(" Activar ",-1)])]),_:1},8,["onClick"])):b("",!0),a.estado==="activo"?(u(),v(t(S),{key:1,onClick:k=>U(a,"finalizado")},{default:l(()=>[...s[41]||(s[41]=[o(" Finalizar ",-1)])]),_:1},8,["onClick"])):b("",!0),e(t(S),{onClick:k=>h(a)},{default:l(()=>[...s[42]||(s[42]=[o(" Duplicar ",-1)])]),_:1},8,["onClick"]),e(t(P)),e(t(S),{class:"text-red-600",onClick:k=>Z(a)},{default:l(()=>[...s[43]||(s[43]=[o(" Eliminar ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),d.contratos.data.length===0?(u(),v(t(N),{key:0},{default:l(()=>[e(t(c),{colspan:"9",class:"text-center py-8 text-gray-500"},{default:l(()=>[...s[44]||(s[44]=[o(" No se encontraron contratos ",-1)])]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),d.contratos.last_page>1?(u(),z("div",Pt,[i("p",Mt," Mostrando "+n(d.contratos.from)+" - "+n(d.contratos.to)+" de "+n(d.contratos.total)+" contratos ",1),i("div",Lt,[(u(!0),z(I,null,O(d.contratos.last_page,a=>(u(),v(t(y),{key:a,href:r.route("admin.contratos.index",{..._.filters,page:a}),class:B(["px-3 py-1 rounded text-sm",a===d.contratos.current_page?"bg-primary text-white":"bg-gray-100 hover:bg-gray-200"])},{default:l(()=>[o(n(a),1)]),_:2},1032,["href","class"]))),128))])])):b("",!0)])]),_:1}))}});export{Ie as default};
