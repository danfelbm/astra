import{d as pe,r as F,c as A,b as v,e as f,w as s,f as t,g as n,u as e,p as ce,t as u,j as T,P as B,h as o,x as ve,i as z,F as D,k as P,q as H,W as L}from"./app-CbA_dzrH.js";import{_ as _e}from"./UserLayout.vue_vue_type_script_setup_true_lang-C0kuRXSj.js";import{_ as x,a as w,b as k,c as $}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dpl1EP6e.js";import{_ as J}from"./CardDescription.vue_vue_type_script_setup_true_lang-FdnBhRW4.js";import{c as ge,_}from"./createLucideIcon-0y3HvBb2.js";import{_ as Q}from"./index-MuREUf8q.js";import{_ as be}from"./Input.vue_vue_type_script_setup_true_lang-Dw2oMjuZ.js";import{_ as I,a as N,b as U,c as q,d as c}from"./SelectValue.vue_vue_type_script_setup_true_lang-C7VbuHoF.js";import{_ as ye,a as he,b as Y,c as g,d as xe,e as b}from"./TableHeader.vue_vue_type_script_setup_true_lang-DHecD5Xq.js";import{A as we}from"./arrow-left-DWk22nOp.js";import{U as ke}from"./upload-D1gsNalI.js";import{F as S}from"./file-text-DINmkRZl.js";import{C as Z}from"./circle-check-big-CTzKScww.js";import{C as K}from"./clock-Bx6DQ-_s.js";import{C as ee}from"./circle-x-BAB6M3OH.js";import{F as $e}from"./filter-DH7chmfT.js";import{E as Ce}from"./eye-CuQC-PD5.js";import{S as Ve}from"./square-pen-CVrov98_.js";import{T as Ee}from"./trash-2-di4yGiJv.js";import{V as ze}from"./video-DOuG9gQV.js";import{C as Me}from"./camera-COQ6A8Gl.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C4x6rJ8B.js";import"./index-D-PGeZ3t.js";import"./floating-ui.vue-D3EH1Xba.js";import"./x-CxSWfWOJ.js";import"./index-BGfSt6nP.js";import"./shield-yBic2gp-.js";import"./user-BnDczykq.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-H44qAxpr.js";import"./chevron-right-pq_ChJ0s.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-H8FdC1v8.js";import"./VisuallyHidden-BOU54Fpc.js";import"./index-DzUkqZxm.js";import"./Label.vue_vue_type_script_setup_true_lang-BHOcaT7W.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-fWHHAQt9.js";import"./index-CXCj42Z3.js";import"./circle-alert-CfNQ3Vlu.js";import"./map-pin-B0r5dLQM.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BZUuILpY.js";import"./square-check-big-CDgrQbfI.js";import"./users-DLZP89St.js";import"./folder-open-B03CPFE8.js";import"./index-DPtKDKxs.js";import"./check-8t2yOxAa.js";import"./nullish-CHIgUVhi.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=ge("AudioLinesIcon",[["path",{d:"M2 10v3",key:"1fnikh"}],["path",{d:"M6 6v11",key:"11sgs0"}],["path",{d:"M10 3v18",key:"yhl04a"}],["path",{d:"M14 8v7",key:"3a1oy3"}],["path",{d:"M18 5v13",key:"123xd1"}],["path",{d:"M22 10v3",key:"154ddg"}]]),Te={class:"space-y-6"},Be={class:"flex items-center justify-between"},Se={class:"text-muted-foreground mt-2"},je={class:"flex gap-2"},Ae={class:"grid gap-4 md:grid-cols-4"},De={class:"text-2xl font-bold"},Pe={class:"text-2xl font-bold"},Le={class:"text-2xl font-bold"},Ie={class:"text-2xl font-bold"},Ne={class:"grid gap-4 md:grid-cols-5"},Ue={class:"flex gap-2"},qe={key:0,class:"text-center py-8"},Ke={class:"flex items-center gap-2"},Oe={class:"capitalize"},Re={class:"text-sm"},Ge={class:"text-sm"},We={class:"flex items-center gap-2"},Xe={class:"text-xs text-muted-foreground"},He={class:"text-sm text-muted-foreground"},Je={class:"text-sm text-muted-foreground"},Qe={class:"flex items-center justify-end gap-1"},Ye={key:2,class:"mt-4 flex justify-center"},Ze={class:"flex gap-1"},Rt=pe({__name:"Index",props:{contrato:{},evidencias:{},filters:{},estadisticas:{},authPermissions:{}},setup(te){var O,R,G,W;const m=te,M=F(((O=m.filters)==null?void 0:O.search)||""),C=F(((R=m.filters)==null?void 0:R.tipo)||"all"),V=F(((G=m.filters)==null?void 0:G.estado)||"all"),E=F(((W=m.filters)==null?void 0:W.obligacion_id)||"all"),se=l=>({imagen:Me,video:ze,audio:Fe,documento:S})[l]||S,ae=l=>({pendiente:"secondary",aprobada:"success",rechazada:"destructive"})[l]||"default",le=l=>({pendiente:K,aprobada:Z,rechazada:ee})[l]||K,oe=A(()=>{var l;return((l=m.authPermissions)==null?void 0:l.includes("evidencias.edit_own"))||!1}),ie=A(()=>{var l;return((l=m.authPermissions)==null?void 0:l.includes("evidencias.delete_own"))||!1}),ne=A(()=>{var l;return((l=m.authPermissions)==null?void 0:l.includes("evidencias.create_own"))||!1}),j=()=>{L.get(route("user.mis-contratos.evidencias.index",m.contrato.id),{search:M.value,tipo:C.value==="all"?"":C.value,estado:V.value==="all"?"":V.value,obligacion_id:E.value==="all"?"":E.value},{preserveState:!0,preserveScroll:!0})},re=()=>{M.value="",C.value="all",V.value="all",E.value="all",j()},de=l=>{confirm("¿Estás seguro de que deseas eliminar esta evidencia?")&&L.delete(route("user.mis-contratos.evidencias.destroy",[m.contrato.id,l]),{preserveScroll:!0,onSuccess:()=>{}})},ue=l=>l?new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",fe=l=>{if(l===0)return"0 Bytes";const a=1024,i=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(l)/Math.log(a));return Math.round(l/Math.pow(a,d)*100)/100+" "+i[d]},me=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Contratos",href:"/miembro/mis-contratos"},{title:m.contrato.nombre,href:`/miembro/mis-contratos/${m.contrato.id}`},{title:"Evidencias",href:"#"}];return(l,a)=>(f(),v(_e,{title:`Evidencias - ${l.contrato.nombre}`,breadcrumbs:me},{default:s(()=>[t(e(ce),{title:`Evidencias - ${l.contrato.nombre}`},null,8,["title"]),n("div",Te,[n("div",Be,[n("div",null,[a[4]||(a[4]=n("h1",{class:"text-3xl font-bold tracking-tight"},"Evidencias del Contrato",-1)),n("p",Se," Gestione todas las evidencias de cumplimiento de "+u(l.contrato.nombre),1)]),n("div",je,[t(e(_),{href:l.route("user.mis-contratos.show",l.contrato.id),as:e(B),variant:"outline"},{default:s(()=>[t(e(we),{class:"w-4 h-4 mr-2"}),a[5]||(a[5]=o(" Volver al Contrato ",-1))]),_:1},8,["href","as"]),ne.value?(f(),v(e(_),{key:0,href:l.route("user.mis-contratos.evidencias.create",l.contrato.id),as:e(B)},{default:s(()=>[t(e(ke),{class:"w-4 h-4 mr-2"}),a[6]||(a[6]=o(" Nueva Evidencia ",-1))]),_:1},8,["href","as"])):T("",!0)])]),n("div",Ae,[t(e(x),null,{default:s(()=>[t(e(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(k),{class:"text-sm font-medium"},{default:s(()=>[...a[7]||(a[7]=[o("Total Evidencias",-1)])]),_:1}),t(e(S),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e($),null,{default:s(()=>[n("div",De,u(l.evidencias.total),1)]),_:1})]),_:1}),t(e(x),null,{default:s(()=>[t(e(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(k),{class:"text-sm font-medium"},{default:s(()=>[...a[8]||(a[8]=[o("Aprobadas",-1)])]),_:1}),t(e(Z),{class:"h-4 w-4 text-green-600"})]),_:1}),t(e($),null,{default:s(()=>{var i,d;return[n("div",Pe,u(((d=(i=l.evidencias)==null?void 0:i.data)==null?void 0:d.filter(p=>p.estado==="aprobada").length)||0),1)]}),_:1})]),_:1}),t(e(x),null,{default:s(()=>[t(e(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(k),{class:"text-sm font-medium"},{default:s(()=>[...a[9]||(a[9]=[o("Pendientes",-1)])]),_:1}),t(e(K),{class:"h-4 w-4 text-orange-600"})]),_:1}),t(e($),null,{default:s(()=>{var i,d;return[n("div",Le,u(((d=(i=l.evidencias)==null?void 0:i.data)==null?void 0:d.filter(p=>p.estado==="pendiente").length)||0),1)]}),_:1})]),_:1}),t(e(x),null,{default:s(()=>[t(e(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(k),{class:"text-sm font-medium"},{default:s(()=>[...a[10]||(a[10]=[o("Rechazadas",-1)])]),_:1}),t(e(ee),{class:"h-4 w-4 text-red-600"})]),_:1}),t(e($),null,{default:s(()=>{var i,d;return[n("div",Ie,u(((d=(i=l.evidencias)==null?void 0:i.data)==null?void 0:d.filter(p=>p.estado==="rechazada").length)||0),1)]}),_:1})]),_:1})]),t(e(x),null,{default:s(()=>[t(e(w),null,{default:s(()=>[t(e(k),null,{default:s(()=>[...a[11]||(a[11]=[o("Filtros",-1)])]),_:1}),t(e(J),null,{default:s(()=>[...a[12]||(a[12]=[o("Filtre las evidencias por tipo, estado u obligación",-1)])]),_:1})]),_:1}),t(e($),null,{default:s(()=>[n("div",Ne,[n("div",null,[t(e(be),{modelValue:M.value,"onUpdate:modelValue":a[0]||(a[0]=i=>M.value=i),placeholder:"Buscar por descripción...",onKeyup:ve(j,["enter"])},null,8,["modelValue"])]),n("div",null,[t(e(I),{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=i=>C.value=i)},{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(U),{placeholder:"Tipo de evidencia"})]),_:1}),t(e(q),null,{default:s(()=>[t(e(c),{value:"all"},{default:s(()=>[...a[13]||(a[13]=[o("Todos los tipos",-1)])]),_:1}),t(e(c),{value:"imagen"},{default:s(()=>[...a[14]||(a[14]=[o("Imagen",-1)])]),_:1}),t(e(c),{value:"video"},{default:s(()=>[...a[15]||(a[15]=[o("Video",-1)])]),_:1}),t(e(c),{value:"audio"},{default:s(()=>[...a[16]||(a[16]=[o("Audio",-1)])]),_:1}),t(e(c),{value:"documento"},{default:s(()=>[...a[17]||(a[17]=[o("Documento",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",null,[t(e(I),{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=i=>V.value=i)},{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(U),{placeholder:"Estado"})]),_:1}),t(e(q),null,{default:s(()=>[t(e(c),{value:"all"},{default:s(()=>[...a[18]||(a[18]=[o("Todos los estados",-1)])]),_:1}),t(e(c),{value:"pendiente"},{default:s(()=>[...a[19]||(a[19]=[o("Pendiente",-1)])]),_:1}),t(e(c),{value:"aprobada"},{default:s(()=>[...a[20]||(a[20]=[o("Aprobada",-1)])]),_:1}),t(e(c),{value:"rechazada"},{default:s(()=>[...a[21]||(a[21]=[o("Rechazada",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",null,[t(e(I),{modelValue:E.value,"onUpdate:modelValue":a[3]||(a[3]=i=>E.value=i)},{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(U),{placeholder:"Obligación"})]),_:1}),t(e(q),null,{default:s(()=>[t(e(c),{value:"all"},{default:s(()=>[...a[22]||(a[22]=[o("Todas las obligaciones",-1)])]),_:1}),(f(!0),z(D,null,P(l.contrato.obligaciones||[],i=>(f(),v(e(c),{key:i.id,value:i.id.toString()},{default:s(()=>[o(u(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),n("div",Ue,[t(e(_),{onClick:j,class:"flex-1"},{default:s(()=>[t(e($e),{class:"w-4 h-4 mr-2"}),a[23]||(a[23]=o(" Filtrar ",-1))]),_:1}),t(e(_),{onClick:re,variant:"outline"},{default:s(()=>[...a[24]||(a[24]=[o(" Limpiar ",-1)])]),_:1})])])]),_:1})]),_:1}),t(e(x),null,{default:s(()=>[t(e(w),null,{default:s(()=>[t(e(k),null,{default:s(()=>[...a[25]||(a[25]=[o("Evidencias Registradas",-1)])]),_:1}),t(e(J),null,{default:s(()=>{var i,d,p;return[o(" Mostrando "+u(((d=(i=l.evidencias)==null?void 0:i.data)==null?void 0:d.length)||0)+" de "+u(((p=l.evidencias)==null?void 0:p.total)||0)+" evidencias ",1)]}),_:1})]),_:1}),t(e($),null,{default:s(()=>{var i,d,p,X;return[(d=(i=l.evidencias)==null?void 0:i.data)!=null&&d.length?(f(),v(e(ye),{key:1},{default:s(()=>[t(e(he),null,{default:s(()=>[t(e(Y),null,{default:s(()=>[t(e(g),null,{default:s(()=>[...a[27]||(a[27]=[o("Tipo",-1)])]),_:1}),t(e(g),null,{default:s(()=>[...a[28]||(a[28]=[o("Obligación",-1)])]),_:1}),t(e(g),null,{default:s(()=>[...a[29]||(a[29]=[o("Descripción",-1)])]),_:1}),t(e(g),null,{default:s(()=>[...a[30]||(a[30]=[o("Archivos",-1)])]),_:1}),t(e(g),null,{default:s(()=>[...a[31]||(a[31]=[o("Estado",-1)])]),_:1}),t(e(g),null,{default:s(()=>[...a[32]||(a[32]=[o("Fecha",-1)])]),_:1}),t(e(g),null,{default:s(()=>[...a[33]||(a[33]=[o("Tamaño",-1)])]),_:1}),t(e(g),{class:"text-right"},{default:s(()=>[...a[34]||(a[34]=[o("Acciones",-1)])]),_:1})]),_:1})]),_:1}),t(e(xe),null,{default:s(()=>{var y;return[(f(!0),z(D,null,P(((y=l.evidencias)==null?void 0:y.data)||[],r=>(f(),v(e(Y),{key:r.id},{default:s(()=>[t(e(b),null,{default:s(()=>[n("div",Ke,[(f(),v(H(se(r.tipo_evidencia)),{class:"w-4 h-4 text-muted-foreground"})),n("span",Oe,u(r.tipo_evidencia),1)])]),_:2},1024),t(e(b),null,{default:s(()=>{var h;return[n("span",Re,u(((h=r.obligacion)==null?void 0:h.nombre)||"-"),1)]}),_:2},1024),t(e(b),null,{default:s(()=>[n("span",Ge,u(r.descripcion||"Sin descripción"),1)]),_:2},1024),t(e(b),null,{default:s(()=>[n("div",We,[t(e(Q),{variant:"secondary",class:"text-xs"},{default:s(()=>[o(u(r.total_archivos||1),1)]),_:2},1024),n("span",Xe,u((r.total_archivos||1)===1?"archivo":"archivos"),1)])]),_:2},1024),t(e(b),null,{default:s(()=>[t(e(Q),{variant:ae(r.estado)},{default:s(()=>[(f(),v(H(le(r.estado)),{class:"w-3 h-3 mr-1"})),o(" "+u(r.estado),1)]),_:2},1032,["variant"])]),_:2},1024),t(e(b),null,{default:s(()=>[n("span",He,u(ue(r.created_at)),1)]),_:2},1024),t(e(b),null,{default:s(()=>{var h;return[n("span",Je,u(fe(((h=r.metadata)==null?void 0:h.size)||0)),1)]}),_:2},1024),t(e(b),{class:"text-right"},{default:s(()=>[n("div",Qe,[t(e(_),{href:l.route("user.mis-contratos.evidencias.show",[l.contrato.id,r.id]),as:e(B),variant:"ghost",size:"sm"},{default:s(()=>[t(e(Ce),{class:"w-4 h-4"})]),_:2},1032,["href","as"]),oe.value&&r.estado==="pendiente"?(f(),v(e(_),{key:0,href:l.route("user.mis-contratos.evidencias.edit",[l.contrato.id,r.id]),as:e(B),variant:"ghost",size:"sm"},{default:s(()=>[t(e(Ve),{class:"w-4 h-4"})]),_:2},1032,["href","as"])):T("",!0),ie.value&&r.estado==="pendiente"?(f(),v(e(_),{key:1,onClick:h=>de(r.id),variant:"ghost",size:"sm",class:"text-destructive hover:text-destructive"},{default:s(()=>[t(e(Ee),{class:"w-4 h-4"})]),_:2},1032,["onClick"])):T("",!0)])]),_:2},1024)]),_:2},1024))),128))]}),_:1})]),_:1})):(f(),z("div",qe,[t(e(S),{class:"w-12 h-12 mx-auto text-muted-foreground mb-3"}),a[26]||(a[26]=n("p",{class:"text-muted-foreground"},"No se encontraron evidencias con los filtros aplicados",-1))])),(((p=l.evidencias)==null?void 0:p.last_page)||1)>1?(f(),z("div",Ye,[n("nav",Ze,[(f(!0),z(D,null,P(((X=l.evidencias)==null?void 0:X.last_page)||1,y=>{var r;return f(),v(e(_),{key:y,onClick:h=>e(L).get(l.route("user.mis-contratos.evidencias.index",l.contrato.id),{...l.filters,page:y}),variant:y===(((r=l.evidencias)==null?void 0:r.current_page)||1)?"default":"outline",size:"sm"},{default:s(()=>[o(u(y),1)]),_:2},1032,["onClick","variant"])}),128))])])):T("",!0)]}),_:1})]),_:1})])]),_:1},8,["title"]))}});export{Rt as default};
