import{_ as y}from"./index-B1hFReqZ.js";import{_ as h}from"./createLucideIcon-C8o-8vKY.js";import{_ as Y,c as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-CE7ACGrx.js";import{_ as X}from"./Switch.vue_vue_type_script_setup_true_lang-CUcgEOWv.js";import{_ as Z,a as ee,b as $,c as b,d as te,e as g}from"./TableHeader.vue_vue_type_script_setup_true_lang-D2Tj3Sp7.js";import{_ as se}from"./UserLayout.vue_vue_type_script_setup_true_lang-DoO20Mkd.js";import{d as ae,k as z,c as N,a as C,o,b as a,u as t,m as ie,e as i,f as r,i as v,g as n,n as x,j as m,t as p,F as S,r as B,l as re,W as k}from"./app-Bqj6cabU.js";import{_ as le}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-B_H5Fi-i.js";import{l as D,C as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-Bqrud0Vz.js";import{V as oe}from"./vote-BfMb807g.js";import{C as L}from"./clock-CnuCdFMJ.js";import{C as A}from"./circle-check-big-CUswkiRQ.js";import{C as ne}from"./chart-column-t5eHOF4l.js";import{C as T}from"./circle-alert-C1YWw91b.js";import"./index-_CXItz_H.js";import"./VisuallyHidden-DgAOoJOt.js";import"./Input.vue_vue_type_script_setup_true_lang-BgUqW2xn.js";import"./VisuallyHiddenInput-BqQIydg1.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-1zoq1_ge.js";import"./index-BKc_ekQU.js";import"./floating-ui.vue-JANudi2O.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CFEiplAu.js";import"./shield-B6qXhAif.js";import"./user-DxJeGoXE.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-abXnMk-o.js";import"./Label.vue_vue_type_script_setup_true_lang-CrvKdd-Q.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CtdU0Fle.js";import"./index-CLO0EMv4.js";import"./map-pin-C8oba01p.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-W66iioUR.js";import"./square-check-big-CxlbbnBX.js";import"./file-text-DXUAiP0m.js";import"./users-BPHT5OHo.js";import"./index-CwsEjmb9.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-D4-66thX.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-Z9DdC44R.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-ClaqeSjv.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DrPOJGi-.js";import"./es-DfN3vIXC.js";import"./calendar-BUIf-xWA.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-P28DQP-x.js";import"./loader-circle-Dwmj8osf.js";import"./trash-2-DZx14x3r.js";import"./plus-BLlcKvw3.js";import"./search-kSiJLLM7.js";import"./check-JsU3fe4g.js";import"./history-4O-5Tph_.js";import"./save-CvFoKHL0.js";const de={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ue={class:"flex items-center gap-4 mb-4"},me={class:"flex items-center space-x-2"},ce={class:"relative min-h-[50vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},fe={class:"rounded-md border"},pe={class:"flex items-center gap-1"},_e={class:"flex flex-col"},ve={class:"flex items-center gap-1"},xe={class:"flex flex-col"},ge={class:"flex items-center gap-1"},he={class:"flex flex-col"},be={class:"flex items-center gap-2 mb-1"},ye={class:"font-medium"},Ce={key:0,class:"text-sm text-muted-foreground"},ke={class:"text-sm"},we={class:"text-sm"},Ve={class:"flex items-center gap-2"},$e={class:"flex justify-end gap-2"},ze={key:0,class:"flex items-center justify-between mt-4"},Se={class:"text-sm text-muted-foreground"},De={class:"flex gap-2"},wt=ae({__name:"Index",props:{votaciones:{},categorias:{},filters:{},mostrar_pasadas:{type:Boolean},filterFieldsConfig:{}},setup(P){const d=P,j=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Votaciones",href:"/miembro/votaciones"}],w=z(d.mostrar_pasadas||!1),{route:E}=window,q=N(()=>({quickSearch:d.filters.search||"",rootGroup:d.filters.advanced_filters?JSON.parse(d.filters.advanced_filters):void 0})),H={fields:d.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por título o descripción...",quickSearchFields:["titulo","descripcion"],maxNestingLevel:2,allowSaveFilters:!0,debounceTime:500,autoApply:!1},c=z("fecha_inicio"),f=z("asc"),V=l=>{c.value===l?f.value=f.value==="asc"?"desc":"asc":(c.value=l,f.value="asc")},I=N(()=>[...d.votaciones.data].sort((s,e)=>{let u,_;switch(c.value){case"fecha_inicio":u=new Date(s.fecha_inicio),_=new Date(e.fecha_inicio);break;case"fecha_fin":u=new Date(s.fecha_fin),_=new Date(e.fecha_fin);break;case"titulo":u=s.titulo.toLowerCase(),_=e.titulo.toLowerCase();break;default:u=s[c.value],_=e[c.value]}return u<_?f.value==="asc"?-1:1:u>_?f.value==="asc"?1:-1:0})),R=()=>{k.get("/miembro/votaciones",{...d.filters,mostrar_pasadas:w.value||void 0},{preserveState:!0,replace:!0})},U=l=>{k.get(`/miembro/votaciones/${l}/votar`)},W=l=>{k.get(`/miembro/votaciones/${l}/mi-voto`)},G=l=>{k.get(`/miembro/votaciones/${l}/resultados`)},J=l=>l.ya_voto?A:l.ha_finalizado?T:L,O=l=>l.ya_voto?"default":l.ha_finalizado?"destructive":"secondary",Q=l=>l.ya_voto?l.ha_finalizado?"Voté (Finalizada)":"Ya voté":l.ha_finalizado?"Expirada":"Disponible",M=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(l,s)=>(o(),C(S,null,[a(t(ie),{title:"Mis Votaciones"}),a(se,{breadcrumbs:j},{default:i(()=>[r("div",de,[s[19]||(s[19]=r("div",{class:"flex items-center justify-between"},[r("div",null,[r("h1",{class:"text-3xl font-bold"},"Mis Votaciones"),r("p",{class:"text-muted-foreground"}," Votaciones disponibles para mi participación ")])],-1)),r("div",ue,[a(le,{config:H,route:t(E)("user.votaciones.index"),"initial-filters":q.value,class:"flex-1"},null,8,["route","initial-filters"]),r("div",me,[a(t(X),{id:"mostrar-pasadas",modelValue:w.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>w.value=e),R]},null,8,["modelValue"]),s[4]||(s[4]=r("label",{for:"mostrar-pasadas",class:"text-sm font-medium whitespace-nowrap"}," Ver historial ",-1))])]),r("div",ce,[a(t(Y),{class:"border-0 shadow-none h-full"},{default:i(()=>[a(t(K),{class:"pt-6"},{default:i(()=>[r("div",fe,[a(t(Z),null,{default:i(()=>[a(t(ee),null,{default:i(()=>[a(t($),null,{default:i(()=>[a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[1]||(s[1]=e=>V("titulo"))},{default:i(()=>[r("div",pe,[s[5]||(s[5]=n(" Título ")),r("div",_e,[a(t(D),{class:x(["h-3 w-3",{"text-primary":c.value==="titulo"&&f.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":c.value==="titulo"&&f.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:i(()=>s[6]||(s[6]=[n("Categoría")])),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[2]||(s[2]=e=>V("fecha_inicio"))},{default:i(()=>[r("div",ve,[s[7]||(s[7]=n(" Fecha de Apertura ")),r("div",xe,[a(t(D),{class:x(["h-3 w-3",{"text-primary":c.value==="fecha_inicio"&&f.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":c.value==="fecha_inicio"&&f.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[3]||(s[3]=e=>V("fecha_fin"))},{default:i(()=>[r("div",ge,[s[8]||(s[8]=n(" Fecha Límite ")),r("div",he,[a(t(D),{class:x(["h-3 w-3",{"text-primary":c.value==="fecha_fin"&&f.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":c.value==="fecha_fin"&&f.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:i(()=>s[9]||(s[9]=[n("Mi Estado")])),_:1}),a(t(b),{class:"text-right"},{default:i(()=>s[10]||(s[10]=[n("Acción")])),_:1})]),_:1})]),_:1}),a(t(te),null,{default:i(()=>[d.votaciones.data.length===0?(o(),m(t($),{key:0},{default:i(()=>[a(t(g),{colspan:6,class:"text-center py-8 text-muted-foreground"},{default:i(()=>[n(p(w.value?"No tienes historial de votaciones":"No tienes votaciones disponibles en este momento"),1)]),_:1})]),_:1})):v("",!0),(o(!0),C(S,null,B(I.value,e=>(o(),m(t($),{key:e.id,class:x({"opacity-75":e.ha_finalizado,"bg-green-50/50 dark:bg-green-950/10":e.ya_voto&&!e.ha_finalizado,"bg-blue-50/50 dark:bg-blue-950/10":e.puede_votar})},{default:i(()=>[a(t(g),null,{default:i(()=>{var u,_;return[r("div",null,[r("div",be,[r("p",ye,p(e.titulo),1),e.estado_visual==="finalizada"?(o(),m(t(y),{key:0,variant:"secondary",class:"text-xs"},{default:i(()=>s[11]||(s[11]=[n(" Finalizada ")])),_:1})):e.estado_visual==="activa"?(o(),m(t(y),{key:1,variant:"default",class:"text-xs"},{default:i(()=>s[12]||(s[12]=[n(" Activa ")])),_:1})):e.estado_visual==="pendiente"?(o(),m(t(y),{key:2,variant:"outline",class:"text-xs"},{default:i(()=>s[13]||(s[13]=[n(" Pendiente ")])),_:1})):v("",!0)]),e.descripcion?(o(),C("p",Ce,p((u=e.descripcion)==null?void 0:u.substring(0,80))+p(((_=e.descripcion)==null?void 0:_.length)>80?"...":""),1)):v("",!0)])]}),_:2},1024),a(t(g),null,{default:i(()=>[a(t(y),{variant:"outline"},{default:i(()=>[n(p(e.categoria.nombre),1)]),_:2},1024)]),_:2},1024),a(t(g),null,{default:i(()=>[r("div",ke,p(M(e.fecha_inicio)),1)]),_:2},1024),a(t(g),null,{default:i(()=>[r("div",we,p(M(e.fecha_fin)),1)]),_:2},1024),a(t(g),null,{default:i(()=>[r("div",Ve,[(o(),m(re(J(e)),{class:x(["h-4 w-4",{"text-green-600":e.ya_voto,"text-orange-600":e.puede_votar,"text-red-600":!e.puede_votar&&!e.ya_voto}])},null,8,["class"])),a(t(y),{variant:O(e)},{default:i(()=>[n(p(Q(e)),1)]),_:2},1032,["variant"])])]),_:2},1024),a(t(g),{class:"text-right"},{default:i(()=>[r("div",$e,[e.puede_votar?(o(),m(t(h),{key:0,onClick:u=>U(e.id),size:"sm"},{default:i(()=>[a(t(oe),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=n(" Votar "))]),_:2},1032,["onClick"])):v("",!0),e.estado_visual==="pendiente"?(o(),m(t(h),{key:1,variant:"outline",size:"sm",disabled:"",class:"cursor-not-allowed"},{default:i(()=>[a(t(L),{class:"mr-2 h-4 w-4"}),s[15]||(s[15]=n(" Próximamente "))]),_:1})):v("",!0),e.puede_ver_voto?(o(),m(t(h),{key:2,onClick:u=>W(e.id),variant:"outline",size:"sm"},{default:i(()=>[a(t(A),{class:"mr-2 h-4 w-4"}),s[16]||(s[16]=n(" Ver mi voto "))]),_:2},1032,["onClick"])):v("",!0),e.resultados_visibles?(o(),m(t(h),{key:3,onClick:u=>G(e.id),variant:"default",size:"sm",class:"bg-blue-600 hover:bg-blue-700 text-white"},{default:i(()=>[a(t(ne),{class:"mr-2 h-4 w-4"}),s[17]||(s[17]=n(" Ver Resultados "))]),_:2},1032,["onClick"])):v("",!0),e.ha_finalizado&&!e.ya_voto?(o(),m(t(h),{key:4,variant:"outline",size:"sm",disabled:""},{default:i(()=>[a(t(T),{class:"mr-2 h-4 w-4"}),s[18]||(s[18]=n(" No participé "))]),_:1})):v("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),d.votaciones.last_page>1?(o(),C("div",ze,[r("p",Se," Mostrando "+p((d.votaciones.current_page-1)*d.votaciones.per_page+1)+" a "+p(Math.min(d.votaciones.current_page*d.votaciones.per_page,d.votaciones.total))+" de "+p(d.votaciones.total)+" resultados ",1),r("div",De,[(o(!0),C(S,null,B(d.votaciones.links,e=>(o(),m(t(h),{key:e.label,variant:e.active?"default":"outline",disabled:!e.url,size:"sm",onClick:u=>e.url&&t(k).get(e.url),innerHTML:e.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):v("",!0)]),_:1})]),_:1})])])]),_:1})],64))}});export{wt as default};
