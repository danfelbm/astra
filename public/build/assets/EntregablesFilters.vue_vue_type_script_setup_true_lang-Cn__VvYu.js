import{d as J,r as Z,c as O,b as f,w as t,e as s,f as e,j as m,h as d,i as v,F as B,k as S,g as u,m as o,l as ee,t as _,x as se,y as te}from"./app-CmZXEU6r.js";import{a as le,b as R,c as w,d as ae,e as C,_ as oe}from"./TableHeader.vue_vue_type_script_setup_true_lang-cI0BJVd7.js";import{_ as H}from"./Checkbox.vue_vue_type_script_setup_true_lang-B_oFJ-wf.js";import{c as ne,_ as h}from"./createLucideIcon-CnNZrfzB.js";import{_ as I}from"./index-BxKCYSwr.js";import{_ as ie,a as de,b as re}from"./index-BvJ6gQQI.js";import{C as X}from"./circle-alert-D9XfP6Me.js";import{E as ue}from"./eye-B1Ivn6OU.js";import{S as ce}from"./square-pen-D0zU8NYD.js";import{C as fe}from"./clock-DC1BIKRj.js";import{C as me}from"./circle-check-BKb87Xra.js";import{T as pe}from"./trash-2-D-RhzEvF.js";import{C as ve}from"./calendar-DdB3Zl5z.js";import{U as _e}from"./users-ByXG9ROn.js";import{e as xe,C as he,_ as L,a as A,b as M,c as N,d as D}from"./SelectValue.vue_vue_type_script_setup_true_lang-D5V10iEd.js";import{a as ge,b as ke,c as ye,_ as Ce}from"./CardTitle.vue_vue_type_script_setup_true_lang-B1S67cXd.js";import{_ as E}from"./Label.vue_vue_type_script_setup_true_lang-DqIcWBli.js";import{_ as q}from"./Input.vue_vue_type_script_setup_true_lang-D2njpHVb.js";import{F as G}from"./filter-VE8MdV7U.js";import{X as V}from"./x-BVEqjV7Q.js";import{S as $e}from"./search-BUYmF1F5.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=ne("CircleDotIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]),be={class:"font-medium"},Ee={key:0,class:"text-sm text-muted-foreground"},Ve={key:1,class:"flex items-center gap-1 mt-1"},De={class:"text-xs text-red-600"},Fe={key:2,class:"flex items-center gap-1 mt-1"},Be={class:"text-xs text-orange-600"},Se={class:"flex gap-1 mt-2"},ze={key:0,class:"flex items-center gap-2"},Te={class:"text-sm"},Ie={key:1,class:"text-sm text-muted-foreground"},Pe={class:"flex items-center gap-1"},Ue={class:"text-sm"},je={key:0,class:"flex items-center gap-1"},Re={class:"text-sm"},Le={key:1,class:"text-sm text-muted-foreground"},Ae={key:0,class:"flex flex-wrap gap-1"},Me={key:1,class:"text-sm text-muted-foreground"},bs=J({__name:"EntregablesTable",props:{entregables:{},proyectoId:{},hitoId:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!0}},emits:["view","edit","delete","complete","mark-in-progress","selection-change"],setup(p,{emit:P}){const F=p,k=P,c=Z([]),U=O(()=>F.entregables.map(a=>({...a,diasRestantes:b(a.fecha_fin),estaVencido:a.fecha_fin&&b(a.fecha_fin)<0,estaProximoVencer:a.fecha_fin&&b(a.fecha_fin)>=0&&b(a.fecha_fin)<=7}))),j=()=>{c.value.length===F.entregables.length?c.value=[]:c.value=F.entregables.map(a=>a.id),k("selection-change",c.value)},y=a=>c.value.includes(a),$=a=>{const i=c.value.indexOf(a);i>-1?c.value.splice(i,1):c.value.push(a),k("selection-change",c.value)},z=a=>({pendiente:"secondary",en_progreso:"default",completado:"success",cancelado:"destructive"})[a]||"secondary",T=a=>({baja:"outline",media:"default",alta:"destructive"})[a]||"outline",x=a=>a==="alta"?xe:a==="baja"?he:we,l=a=>a?new Date(a).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}):"-",b=a=>{if(!a)return null;const i=new Date,g=new Date(a).getTime()-i.getTime();return Math.ceil(g/(1e3*60*60*24))},r=a=>{k("view",a)},K=a=>{k("edit",a)},Q=a=>{k("complete",a)},W=a=>{k("delete",a)},Y=a=>{k("mark-in-progress",a)};return(a,i)=>(o(),f(e(oe),null,{default:t(()=>[s(e(le),null,{default:t(()=>[s(e(R),null,{default:t(()=>[p.showCheckbox?(o(),f(e(w),{key:0,class:"w-[40px]"},{default:t(()=>[s(e(H),{checked:c.value.length===p.entregables.length&&p.entregables.length>0,"onUpdate:checked":j},null,8,["checked"])]),_:1})):m("",!0),s(e(w),null,{default:t(()=>[...i[1]||(i[1]=[d("Entregable",-1)])]),_:1}),s(e(w),null,{default:t(()=>[...i[2]||(i[2]=[d("Responsable",-1)])]),_:1}),s(e(w),null,{default:t(()=>[...i[3]||(i[3]=[d("Estado",-1)])]),_:1}),s(e(w),null,{default:t(()=>[...i[4]||(i[4]=[d("Prioridad",-1)])]),_:1}),s(e(w),null,{default:t(()=>[...i[5]||(i[5]=[d("Fecha Fin",-1)])]),_:1}),s(e(w),null,{default:t(()=>[...i[6]||(i[6]=[d("Colaboradores",-1)])]),_:1}),s(e(w),null,{default:t(()=>[...i[7]||(i[7]=[d("Etiquetas",-1)])]),_:1})]),_:1})]),_:1}),s(e(ae),null,{default:t(()=>[(o(!0),v(B,null,S(U.value,n=>(o(),f(e(R),{key:n.id,class:"hover:bg-muted/50"},{default:t(()=>[p.showCheckbox?(o(),f(e(C),{key:0,onClick:i[0]||(i[0]=ee(()=>{},["stop"]))},{default:t(()=>[s(e(H),{checked:y(n.id),"onUpdate:checked":()=>$(n.id)},null,8,["checked","onUpdate:checked"])]),_:2},1024)):m("",!0),s(e(C),null,{default:t(()=>[u("div",null,[u("p",be,_(n.nombre),1),n.descripcion?(o(),v("p",Ee,_(n.descripcion),1)):m("",!0),n.estaVencido?(o(),v("div",Ve,[s(e(X),{class:"h-3 w-3 text-red-600"}),u("span",De,"Vencido hace "+_(Math.abs(n.diasRestantes))+" días",1)])):n.estaProximoVencer?(o(),v("div",Fe,[s(e(X),{class:"h-3 w-3 text-orange-600"}),u("span",Be,"Vence en "+_(n.diasRestantes)+" días",1)])):m("",!0),u("div",Se,[s(e(h),{variant:"ghost",size:"sm",class:"h-7 px-2 text-xs",onClick:g=>r(n)},{default:t(()=>[s(e(ue),{class:"mr-1 h-3 w-3"}),i[8]||(i[8]=d(" Ver ",-1))]),_:1},8,["onClick"]),p.canEdit?(o(),f(e(h),{key:0,variant:"ghost",size:"sm",class:"h-7 px-2 text-xs",onClick:g=>K(n)},{default:t(()=>[s(e(ce),{class:"mr-1 h-3 w-3"}),i[9]||(i[9]=d(" Editar ",-1))]),_:1},8,["onClick"])):m("",!0),p.canEdit&&n.estado==="pendiente"?(o(),f(e(h),{key:1,variant:"ghost",size:"sm",class:"h-7 px-2 text-xs text-blue-600 hover:text-blue-700",onClick:g=>Y(n)},{default:t(()=>[s(e(fe),{class:"mr-1 h-3 w-3"}),i[10]||(i[10]=d(" En Progreso ",-1))]),_:1},8,["onClick"])):m("",!0),p.canComplete&&n.estado!=="completado"?(o(),f(e(h),{key:2,variant:"ghost",size:"sm",class:"h-7 px-2 text-xs text-green-600 hover:text-green-700",onClick:g=>Q(n)},{default:t(()=>[s(e(me),{class:"mr-1 h-3 w-3"}),i[11]||(i[11]=d(" Completar ",-1))]),_:1},8,["onClick"])):m("",!0),p.canDelete?(o(),f(e(h),{key:3,variant:"ghost",size:"sm",class:"h-7 px-2 text-xs text-red-600 hover:text-red-700",onClick:g=>W(n)},{default:t(()=>[s(e(pe),{class:"mr-1 h-3 w-3"}),i[12]||(i[12]=d(" Eliminar ",-1))]),_:1},8,["onClick"])):m("",!0)])])]),_:2},1024),s(e(C),null,{default:t(()=>[n.responsable?(o(),v("div",ze,[s(e(ie),{class:"h-8 w-8"},{default:t(()=>[n.responsable.avatar?(o(),f(e(de),{key:0,src:n.responsable.avatar},null,8,["src"])):m("",!0),s(e(re),null,{default:t(()=>[d(_(n.responsable.name.substring(0,2).toUpperCase()),1)]),_:2},1024)]),_:2},1024),u("span",Te,_(n.responsable.name),1)])):(o(),v("span",Ie,"Sin asignar"))]),_:2},1024),s(e(C),null,{default:t(()=>[s(e(I),{variant:z(n.estado)},{default:t(()=>[d(_(n.estado_label),1)]),_:2},1032,["variant"])]),_:2},1024),s(e(C),null,{default:t(()=>[s(e(I),{variant:T(n.prioridad)},{default:t(()=>[(o(),f(se(x(n.prioridad)),{class:"mr-1 h-3 w-3"})),d(" "+_(n.prioridad_label),1)]),_:2},1032,["variant"])]),_:2},1024),s(e(C),null,{default:t(()=>[u("div",Pe,[s(e(ve),{class:"h-4 w-4 text-muted-foreground"}),u("span",Ue,_(l(n.fecha_fin)),1)])]),_:2},1024),s(e(C),null,{default:t(()=>[n.usuarios&&n.usuarios.length>0?(o(),v("div",je,[s(e(_e),{class:"h-4 w-4 text-muted-foreground"}),u("span",Re,_(n.usuarios.length),1)])):(o(),v("span",Le,"-"))]),_:2},1024),s(e(C),null,{default:t(()=>[n.etiquetas&&n.etiquetas.length>0?(o(),v("div",Ae,[(o(!0),v(B,null,S(n.etiquetas.slice(0,2),g=>(o(),f(e(I),{key:g.id,variant:"outline",class:"text-xs",style:te({borderColor:g.color||"#94a3b8",color:g.color||"#64748b"})},{default:t(()=>[d(_(g.nombre),1)]),_:2},1032,["style"]))),128)),n.etiquetas.length>2?(o(),f(e(I),{key:0,variant:"outline",class:"text-xs"},{default:t(()=>[d(" +"+_(n.etiquetas.length-2),1)]),_:2},1024)):m("",!0)])):(o(),v("span",Me,"-"))]),_:2},1024)]),_:2},1024))),128)),p.entregables.length===0?(o(),f(e(R),{key:0},{default:t(()=>[s(e(C),{colspan:p.showCheckbox?8:7,class:"text-center py-8"},{default:t(()=>[...i[13]||(i[13]=[u("p",{class:"text-muted-foreground"},"No se encontraron entregables",-1)])]),_:1},8,["colspan"])]),_:1})):m("",!0)]),_:1})]),_:1}))}}),Ne={class:"flex items-center justify-between"},qe={class:"flex items-center gap-2"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},He={class:"space-y-2"},Xe={class:"relative"},Ge={class:"space-y-2"},Je={class:"flex gap-2"},Ke={class:"space-y-2"},Qe={class:"flex gap-2"},We={key:0,class:"space-y-2"},Ye={class:"flex gap-2"},Ze={class:"space-y-2 md:col-span-2"},es={class:"grid grid-cols-2 gap-2"},ss={key:1,class:"space-y-4"},ts={class:"flex items-center justify-between"},ls={class:"flex items-center gap-2"},Es=J({__name:"EntregablesFilters",props:{modelValue:{},usuarios:{default:()=>[]},showCard:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(p,{emit:P}){const F=p,k=P,c=O({get:()=>F.modelValue,set:x=>k("update:modelValue",x)}),U=[{value:"pendiente",label:"Pendiente"},{value:"en_progreso",label:"En Progreso"},{value:"completado",label:"Completado"},{value:"cancelado",label:"Cancelado"}],j=[{value:"baja",label:"Baja"},{value:"media",label:"Media"},{value:"alta",label:"Alta"}],y=(x,l)=>{c.value={...c.value,[x]:l}},$=x=>{y(x,null)},z=()=>{c.value={search:null,estado:null,prioridad:null,responsable_id:null,fecha_inicio:null,fecha_fin:null}},T=O(()=>Object.values(c.value).some(x=>x!=null&&x!==""));return(x,l)=>p.showCard?(o(),f(e(Ce),{key:0},{default:t(()=>[s(e(ge),{class:"pb-3"},{default:t(()=>[u("div",Ne,[u("div",qe,[s(e(G),{class:"h-4 w-4"}),s(e(ke),{class:"text-base"},{default:t(()=>[...l[11]||(l[11]=[d("Filtros de Entregables",-1)])]),_:1})]),T.value?(o(),f(e(h),{key:0,variant:"ghost",size:"sm",onClick:z},{default:t(()=>[s(e(V),{class:"h-4 w-4 mr-1"}),l[12]||(l[12]=d(" Limpiar ",-1))]),_:1})):m("",!0)])]),_:1}),s(e(ye),null,{default:t(()=>{var b;return[u("div",Oe,[u("div",He,[s(e(E),{for:"search"},{default:t(()=>[...l[13]||(l[13]=[d("Buscar",-1)])]),_:1}),u("div",Xe,[s(e($e),{class:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),s(e(q),{id:"search",value:c.value.search||"",onInput:l[0]||(l[0]=r=>y("search",r.target.value)),placeholder:"Buscar entregable...",class:"pl-8"},null,8,["value"])]),c.value.search?(o(),f(e(h),{key:0,variant:"ghost",size:"icon",class:"absolute right-2 top-8 h-6 w-6",onClick:l[1]||(l[1]=r=>$("search"))},{default:t(()=>[s(e(V),{class:"h-3 w-3"})]),_:1})):m("",!0)]),u("div",Ge,[s(e(E),{for:"estado"},{default:t(()=>[...l[14]||(l[14]=[d("Estado",-1)])]),_:1}),u("div",Je,[s(e(L),{"model-value":c.value.estado||"null","onUpdate:modelValue":l[2]||(l[2]=r=>y("estado",r==="null"?null:r))},{default:t(()=>[s(e(A),{id:"estado"},{default:t(()=>[s(e(M),{placeholder:"Todos los estados"})]),_:1}),s(e(N),null,{default:t(()=>[s(e(D),{value:"null"},{default:t(()=>[...l[15]||(l[15]=[d("Todos los estados",-1)])]),_:1}),(o(),v(B,null,S(U,r=>s(e(D),{key:r.value,value:r.value},{default:t(()=>[d(_(r.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value"]),c.value.estado?(o(),f(e(h),{key:0,variant:"ghost",size:"icon",onClick:l[3]||(l[3]=r=>$("estado"))},{default:t(()=>[s(e(V),{class:"h-4 w-4"})]),_:1})):m("",!0)])]),u("div",Ke,[s(e(E),{for:"prioridad"},{default:t(()=>[...l[16]||(l[16]=[d("Prioridad",-1)])]),_:1}),u("div",Qe,[s(e(L),{"model-value":c.value.prioridad||"null","onUpdate:modelValue":l[4]||(l[4]=r=>y("prioridad",r==="null"?null:r))},{default:t(()=>[s(e(A),{id:"prioridad"},{default:t(()=>[s(e(M),{placeholder:"Todas las prioridades"})]),_:1}),s(e(N),null,{default:t(()=>[s(e(D),{value:"null"},{default:t(()=>[...l[17]||(l[17]=[d("Todas las prioridades",-1)])]),_:1}),(o(),v(B,null,S(j,r=>s(e(D),{key:r.value,value:r.value},{default:t(()=>[d(_(r.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value"]),c.value.prioridad?(o(),f(e(h),{key:0,variant:"ghost",size:"icon",onClick:l[5]||(l[5]=r=>$("prioridad"))},{default:t(()=>[s(e(V),{class:"h-4 w-4"})]),_:1})):m("",!0)])]),p.usuarios.length>0?(o(),v("div",We,[s(e(E),{for:"responsable"},{default:t(()=>[...l[18]||(l[18]=[d("Responsable",-1)])]),_:1}),u("div",Ye,[s(e(L),{"model-value":((b=c.value.responsable_id)==null?void 0:b.toString())||"null","onUpdate:modelValue":l[6]||(l[6]=r=>y("responsable_id",r==="null"?null:parseInt(r)))},{default:t(()=>[s(e(A),{id:"responsable"},{default:t(()=>[s(e(M),{placeholder:"Todos los responsables"})]),_:1}),s(e(N),null,{default:t(()=>[s(e(D),{value:"null"},{default:t(()=>[...l[19]||(l[19]=[d("Todos los responsables",-1)])]),_:1}),(o(!0),v(B,null,S(p.usuarios,r=>(o(),f(e(D),{key:r.id,value:r.id.toString()},{default:t(()=>[d(_(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"]),c.value.responsable_id?(o(),f(e(h),{key:0,variant:"ghost",size:"icon",onClick:l[7]||(l[7]=r=>$("responsable_id"))},{default:t(()=>[s(e(V),{class:"h-4 w-4"})]),_:1})):m("",!0)])])):m("",!0),u("div",Ze,[s(e(E),null,{default:t(()=>[...l[20]||(l[20]=[d("Rango de Fechas",-1)])]),_:1}),u("div",es,[u("div",null,[s(e(E),{class:"text-xs text-muted-foreground"},{default:t(()=>[...l[21]||(l[21]=[d("Desde",-1)])]),_:1}),s(e(q),{type:"date",value:c.value.fecha_inicio||"",onInput:l[8]||(l[8]=r=>y("fecha_inicio",r.target.value)),class:"mt-1"},null,8,["value"])]),u("div",null,[s(e(E),{class:"text-xs text-muted-foreground"},{default:t(()=>[...l[22]||(l[22]=[d("Hasta",-1)])]),_:1}),s(e(q),{type:"date",value:c.value.fecha_fin||"",onInput:l[9]||(l[9]=r=>y("fecha_fin",r.target.value)),class:"mt-1"},null,8,["value"])])]),c.value.fecha_inicio||c.value.fecha_fin?(o(),f(e(h),{key:0,variant:"ghost",size:"sm",onClick:l[10]||(l[10]=r=>{$("fecha_inicio"),$("fecha_fin")}),class:"w-full mt-1"},{default:t(()=>[s(e(V),{class:"h-4 w-4 mr-1"}),l[23]||(l[23]=d(" Limpiar fechas ",-1))]),_:1})):m("",!0)])])]}),_:1})]),_:1})):(o(),v("div",ss,[u("div",ts,[u("div",ls,[s(e(G),{class:"h-4 w-4"}),l[24]||(l[24]=u("h3",{class:"text-sm font-medium"},"Filtros",-1))]),T.value?(o(),f(e(h),{key:0,variant:"ghost",size:"sm",onClick:z},{default:t(()=>[s(e(V),{class:"h-4 w-4 mr-1"}),l[25]||(l[25]=d(" Limpiar ",-1))]),_:1})):m("",!0)]),l[26]||(l[26]=u("div",{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},null,-1))]))}});export{Es as _,bs as a};
