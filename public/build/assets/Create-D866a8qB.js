import{d as A,r as x,u as M,i as p,e as t,f as e,q as T,w as r,g as i,b as g,j as u,v as S,h as l,l as L,m as n,t as m,F as V,k as w}from"./app-NmALTVyN.js";import{_ as O}from"./AdminLayout.vue_vue_type_script_setup_true_lang-bLp48OwR.js";import{_ as z,a as q,b as C,c as U}from"./CardTitle.vue_vue_type_script_setup_true_lang-BzTFcOtj.js";import{_ as H}from"./CardDescription.vue_vue_type_script_setup_true_lang-Bv7agPvB.js";import{_ as v}from"./createLucideIcon-wqcwkUQd.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-Bm_1WzJZ.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-BM_hjP20.js";import{_ as X}from"./Textarea.vue_vue_type_script_setup_true_lang--Uehqdx8.js";import{_ as D,a as E,b as P,c as j,d as k}from"./SelectValue.vue_vue_type_script_setup_true_lang-CEtk9hit.js";import{_ as G}from"./CamposPersonalizadosForm.vue_vue_type_script_setup_true_lang-Cwlfeydb.js";import{E as J}from"./EtiquetaSelector-Cqb6o4VG.js";import{_ as K}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-BPHbSiWM.js";import{t as I}from"./index-COqoEB39.js";import{A as Q}from"./arrow-left-92cQyYkQ.js";import{X as W}from"./x-Cd_4Yvl_.js";import{U as Y}from"./user-plus-DnncSran.js";import{S as Z}from"./save-DzmewKWL.js";import{T as ee}from"./tag-Bm7brt-v.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C3T8umbB.js";import"./index-C2UErq72.js";import"./floating-ui.vue-DabOKq8u.js";import"./index-CmdJBr9K.js";import"./shield-BqM34IAP.js";import"./user-DtOxb5Ze.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-rERjetO9.js";import"./chevron-right-Crr3uzoO.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DI9gfWoU.js";import"./VisuallyHidden-BCgqoBWa.js";import"./index-DVFh-uMH.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-mVPyQqNq.js";import"./circle-alert-DDqlzooM.js";import"./map-pin-aXg-1VED.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-1Q_mV4Ij.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-BGaMd-Nb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-Rn5TBnRj.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C1h5Vtyx.js";import"./users-vgqJVzu0.js";import"./target-DKjnpYLV.js";import"./vote-BRUZwb_0.js";import"./folder-open-C5pd7ZzZ.js";import"./send-Bi9GDGVw.js";import"./file-text-CT6oxPWB.js";import"./briefcase-Cp62jigF.js";import"./calendar-D33aSez1.js";import"./megaphone-SfxlGp_B.js";import"./user-check-CYc87UfZ.js";import"./clipboard-list-46U3lKIb.js";import"./mail-BsuCB09v.js";import"./message-square-BnCZEtBG.js";import"./external-link-BreQtYoE.js";import"./panel-left-Bot3oP6H.js";import"./index-ZW8gywEB.js";import"./check-zQEdtOat.js";import"./index-CSSlEsXb.js";import"./nullish-CHIgUVhi.js";import"./CampoPersonalizadoInput.vue_vue_type_script_setup_true_lang-Bfitb_8E.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CbGJcpPL.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-DqAGAaiZ.js";import"./RovingFocusItem-C1OjHX30.js";import"./utils-B3LQv26W.js";import"./VisuallyHiddenInput-CnfH8Gly.js";import"./circle-B6tflSs0.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-3Ks87K5r.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-C9k4H4GE.js";import"./index-Y2dGAfTm.js";import"./search-CgQd1oDs.js";import"./useKbd-kRIii9yh.js";import"./useEtiquetaHierarchy-CBNsHXX7.js";import"./list-BM4knEsT.js";import"./tree-pine-DrRZ8NLI.js";import"./plus-ezYOOOnX.js";import"./zap-DhKjDt-7.js";import"./layers-Cv6y6btT.js";import"./trending-up-Ce4vb4SY.js";import"./award-BVb0czI6.js";import"./flag-pRXFgr0Q.js";import"./hash-VD-ESTM6.js";import"./loader-circle-CGtOz5FN.js";import"./chevron-left-B5a_g8ln.js";const oe={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},te={class:"flex items-center justify-between"},se={class:"space-y-2"},re={key:0,class:"text-sm text-red-500"},ae={class:"space-y-2"},ie={key:0,class:"text-sm text-red-500"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={class:"space-y-2"},de={key:0,class:"text-sm text-red-500"},me={class:"space-y-2"},pe={key:0,class:"text-sm text-red-500"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe={class:"space-y-2"},ce={key:0,class:"text-sm text-red-500"},_e={class:"space-y-2"},be={class:"space-y-2"},ve={key:0,class:"p-3 bg-muted rounded-lg flex items-center justify-between"},ye={class:"font-medium"},ge={class:"text-sm text-muted-foreground"},he={key:0,class:"text-sm text-red-500"},xe={key:0,class:"space-y-2"},Ve={key:0,class:"text-sm text-red-500"},$e={class:"flex justify-end gap-2 pt-4"},Wo=A({__name:"Create",props:{proyecto:{},responsables:{},hitosDisponibles:{},camposPersonalizados:{},categorias:{},estados:{},siguienteOrden:{}},setup(d){const _=d,R=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:_.proyecto.nombre,href:`/admin/proyectos/${_.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${_.proyecto.id}/hitos`},{title:"Crear Hito",href:"#"}],h=x(!1),{route:F}=window,f=x(null),y=x(new Map);_.responsables.forEach(b=>y.value.set(b.id,b));const s=M({nombre:"",descripcion:"",fecha_inicio:"",fecha_fin:"",estado:"pendiente",responsable_id:null,parent_id:null,campos_personalizados:{},etiquetas:[],orden:_.siguienteOrden,crear_entregables_predefinidos:!1}),N=b=>{if(b.userIds.length>0){const o=b.userIds[0];s.responsable_id=o,y.value.has(o)?f.value=y.value.get(o)||null:(f.value={id:o,name:`Usuario seleccionado (ID: ${o})`,email:"Se actualizará al guardar"},y.value.set(o,f.value))}},B=()=>{s.post(`/admin/proyectos/${_.proyecto.id}/hitos`,{onSuccess:()=>{I.success("Hito creado exitosamente")},onError:()=>{I.error("Error al crear el hito")}})};return(b,o)=>(n(),p(V,null,[t(e(T),{title:`Crear Hito - ${d.proyecto.nombre}`},null,8,["title"]),t(O,{breadcrumbs:R},{default:r(()=>[i("div",oe,[i("div",te,[o[12]||(o[12]=i("h1",{class:"text-2xl font-bold"},"Crear Nuevo Hito",-1)),t(e(S),{href:`/admin/proyectos/${d.proyecto.id}/hitos`},{default:r(()=>[t(e(v),{variant:"outline",size:"sm"},{default:r(()=>[t(e(Q),{class:"h-4 w-4 mr-2"}),o[11]||(o[11]=l(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),t(e(z),null,{default:r(()=>[t(e(q),null,{default:r(()=>[t(e(C),null,{default:r(()=>[...o[13]||(o[13]=[l("Información del Hito",-1)])]),_:1}),t(e(H),null,{default:r(()=>[...o[14]||(o[14]=[l(" Define los detalles del nuevo hito para el proyecto ",-1)])]),_:1})]),_:1}),t(e(U),null,{default:r(()=>[i("form",{onSubmit:L(B,["prevent"]),class:"space-y-6"},[i("div",se,[t(e(c),{for:"nombre",required:""},{default:r(()=>[...o[15]||(o[15]=[l("Nombre del Hito",-1)])]),_:1}),t(e($),{id:"nombre",modelValue:e(s).nombre,"onUpdate:modelValue":o[0]||(o[0]=a=>e(s).nombre=a),type:"text",placeholder:"Ej: Pre-producción",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.nombre?(n(),p("span",re,m(e(s).errors.nombre),1)):u("",!0)]),i("div",ae,[t(e(c),{for:"descripcion"},{default:r(()=>[...o[16]||(o[16]=[l("Descripción",-1)])]),_:1}),t(e(X),{id:"descripcion",modelValue:e(s).descripcion,"onUpdate:modelValue":o[1]||(o[1]=a=>e(s).descripcion=a),placeholder:"Describe el objetivo y alcance del hito...",disabled:e(s).processing,rows:"3"},null,8,["modelValue","disabled"]),e(s).errors.descripcion?(n(),p("span",ie,m(e(s).errors.descripcion),1)):u("",!0)]),i("div",le,[i("div",ne,[t(e(c),{for:"fecha_inicio"},{default:r(()=>[...o[17]||(o[17]=[l("Fecha de Inicio",-1)])]),_:1}),t(e($),{id:"fecha_inicio",modelValue:e(s).fecha_inicio,"onUpdate:modelValue":o[2]||(o[2]=a=>e(s).fecha_inicio=a),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_inicio?(n(),p("span",de,m(e(s).errors.fecha_inicio),1)):u("",!0)]),i("div",me,[t(e(c),{for:"fecha_fin"},{default:r(()=>[...o[18]||(o[18]=[l("Fecha de Fin",-1)])]),_:1}),t(e($),{id:"fecha_fin",modelValue:e(s).fecha_fin,"onUpdate:modelValue":o[3]||(o[3]=a=>e(s).fecha_fin=a),type:"date",disabled:e(s).processing},null,8,["modelValue","disabled"]),e(s).errors.fecha_fin?(n(),p("span",pe,m(e(s).errors.fecha_fin),1)):u("",!0)])]),i("div",ue,[i("div",fe,[t(e(c),{for:"estado"},{default:r(()=>[...o[19]||(o[19]=[l("Estado Inicial",-1)])]),_:1}),t(e(D),{modelValue:e(s).estado,"onUpdate:modelValue":o[4]||(o[4]=a=>e(s).estado=a)},{default:r(()=>[t(e(E),null,{default:r(()=>[t(e(P),{placeholder:"Seleccionar estado"})]),_:1}),t(e(j),null,{default:r(()=>[(n(!0),p(V,null,w(d.estados,a=>(n(),g(e(k),{key:a.value,value:a.value},{default:r(()=>[l(m(a.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(s).errors.estado?(n(),p("span",ce,m(e(s).errors.estado),1)):u("",!0)]),i("div",_e,[t(e(c),{for:"responsable_id"},{default:r(()=>[...o[20]||(o[20]=[l("Responsable",-1)])]),_:1}),i("div",be,[f.value?(n(),p("div",ve,[i("div",null,[i("p",ye,m(f.value.name),1),i("p",ge,m(f.value.email),1)]),t(e(v),{type:"button",variant:"ghost",size:"sm",onClick:o[5]||(o[5]=a=>{e(s).responsable_id=null,f.value=null})},{default:r(()=>[t(e(W),{class:"h-4 w-4"})]),_:1})])):u("",!0),t(e(v),{type:"button",variant:"outline",onClick:o[6]||(o[6]=a=>h.value=!0),class:"w-full"},{default:r(()=>[t(e(Y),{class:"h-4 w-4 mr-2"}),l(" "+m(f.value?"Cambiar Responsable":"Seleccionar Responsable"),1)]),_:1})]),e(s).errors.responsable_id?(n(),p("span",he,m(e(s).errors.responsable_id),1)):u("",!0)])]),d.hitosDisponibles&&d.hitosDisponibles.length>0?(n(),p("div",xe,[t(e(c),{for:"parent_id"},{default:r(()=>[...o[21]||(o[21]=[l("Hito Padre (opcional)",-1)])]),_:1}),t(e(D),{modelValue:e(s).parent_id,"onUpdate:modelValue":o[7]||(o[7]=a=>e(s).parent_id=a)},{default:r(()=>[t(e(E),null,{default:r(()=>[t(e(P),{placeholder:"Sin padre (raíz)"})]),_:1}),t(e(j),null,{default:r(()=>[t(e(k),{value:null},{default:r(()=>[...o[22]||(o[22]=[l("Sin padre (raíz)",-1)])]),_:1}),(n(!0),p(V,null,w(d.hitosDisponibles,a=>(n(),g(e(k),{key:a.id,value:a.id},{default:r(()=>[l(m("—".repeat(a.nivel))+" "+m(a.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),o[23]||(o[23]=i("p",{class:"text-sm text-muted-foreground"},"Selecciona un hito padre para crear una jerarquía",-1)),e(s).errors.parent_id?(n(),p("span",Ve,m(e(s).errors.parent_id),1)):u("",!0)])):u("",!0),i("div",$e,[t(e(S),{href:`/admin/proyectos/${d.proyecto.id}/hitos`},{default:r(()=>[t(e(v),{type:"button",variant:"outline"},{default:r(()=>[...o[24]||(o[24]=[l("Cancelar",-1)])]),_:1})]),_:1},8,["href"]),t(e(v),{type:"submit",disabled:e(s).processing},{default:r(()=>[t(e(Z),{class:"h-4 w-4 mr-2"}),o[25]||(o[25]=l(" Crear Hito ",-1))]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),d.camposPersonalizados&&d.camposPersonalizados.length>0?(n(),g(G,{key:0,campos:d.camposPersonalizados,valores:e(s).campos_personalizados,errors:e(s).errors,onUpdate:o[8]||(o[8]=a=>e(s).campos_personalizados=a)},null,8,["campos","valores","errors"])):u("",!0),d.categorias&&d.categorias.length>0?(n(),g(e(z),{key:1},{default:r(()=>[t(e(q),null,{default:r(()=>[t(e(C),{class:"flex items-center gap-2"},{default:r(()=>[t(e(ee),{class:"h-5 w-5"}),o[26]||(o[26]=l(" Etiquetas ",-1))]),_:1}),t(e(H),null,{default:r(()=>[...o[27]||(o[27]=[l(" Asigna etiquetas para categorizar y organizar este hito ",-1)])]),_:1})]),_:1}),t(e(U),null,{default:r(()=>[t(J,{modelValue:e(s).etiquetas,"onUpdate:modelValue":o[9]||(o[9]=a=>e(s).etiquetas=a),categorias:d.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas para el hito...",description:"Puedes asignar hasta 10 etiquetas"},null,8,["modelValue","categorias"])]),_:1})]),_:1})):u("",!0)]),t(K,{modelValue:h.value,"onUpdate:modelValue":o[10]||(o[10]=a=>h.value=a),title:"Seleccionar Responsable del Hito",description:"Selecciona el usuario que será responsable de este hito","search-endpoint":e(F)("admin.proyectos.search-users"),"excluded-ids":e(s).responsable_id?[e(s).responsable_id]:[],"max-selection":1,"submit-button-text":"Seleccionar Responsable","search-placeholder":"Buscar por nombre, email, documento o teléfono...",onSubmit:N},null,8,["modelValue","search-endpoint","excluded-ids"])]),_:1})],64))}});export{Wo as default};
