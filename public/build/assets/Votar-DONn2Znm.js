import{d as C,C as k,k as F,c as v,a as T,o as S,b as o,u as e,m as A,e as s,f as i,t as d,g as r,n as M,h as z,F as B,W as j}from"./app-gzqSbCbx.js";import{_ as g,c as b,j as q,a as N,b as U,V as $,i as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-C59gz0Yk.js";import{_ as x}from"./AppLogo.vue_vue_type_script_setup_true_lang-ZW9hWR24.js";import{_ as R,a as W,b as G,c as H,d as I,e as J,f as K,g as O}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-D018nFXS.js";import{D as P}from"./DynamicFormRenderer-HlKjkmom.js";import{A as Q}from"./arrow-left-BEx8XMuh.js";import{C as X}from"./clock-Dc3D0_jx.js";import{T as Y}from"./triangle-alert-lwaHWnAb.js";import"./Label.vue_vue_type_script_setup_true_lang-h_Er4x2c.js";import"./index-BKD8hVBb.js";import"./VisuallyHidden-88zd2gRf.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DxfD0a4m.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-D1b1aGuI.js";import"./Textarea.vue_vue_type_script_setup_true_lang-D1U5HTqU.js";import"./plus-DtOXhY4_.js";import"./user-Co1Sx88b.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-DtFCjq0X.js";import"./RovingFocusItem-dpE1IPKA.js";import"./VisuallyHiddenInput-3LZH_3dk.js";import"./useConditionalFields-C_bYUxhH.js";import"./upload-D4445LB_.js";import"./eye-ZON80H8G.js";import"./download-D6sbdw7y.js";import"./grip-vertical-Bqf-dM2X.js";import"./trash-2-qf81oQ62.js";const Z={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ee={class:"flex items-center justify-between"},te={class:"text-3xl font-bold"},oe={class:"text-muted-foreground"},ae={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},se={class:"flex items-center gap-2"},ie={class:"flex items-center gap-2 text-sm text-muted-foreground"},re={class:"flex items-center gap-2 text-sm"},ne={class:"flex justify-end pt-6 border-t"},ze=C({__name:"Votar",props:{votacion:{},candidatosElegibles:{}},setup(h){const m=h,V=[{title:"Dashboard",href:"/dashboard"},{title:"Mis Votaciones",href:"/votaciones"},{title:"Votar",href:"#"}],n=k((()=>{const a={};return m.votacion.formulario_config.forEach(t=>{t.type==="checkbox"?a[t.id]=[]:a[t.id]=""}),{respuestas:a}})()),u=F(!1),w=()=>{n.post(`/votaciones/${m.votacion.id}/votar`,{onSuccess:()=>{},onError:a=>{console.error("Errores de validación:",a)}})},y=()=>{j.get("/votaciones")},D=a=>new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),f=v(()=>{const a=new Date,l=new Date(m.votacion.fecha_fin).getTime()-a.getTime();if(l<=0)return"Expirada";const c=Math.floor(l/(1e3*60*60)),p=Math.floor(l%(1e3*60*60)/(1e3*60));if(c>24){const _=Math.floor(c/24);return`${_} día${_>1?"s":""}`}else return c>0?`${c}h ${p}m`:`${p}m`}),E=v(()=>m.votacion.formulario_config.every(a=>{if(!a.required)return!0;const t=n.respuestas[a.id];return a.type==="checkbox"?Array.isArray(t)&&t.length>0:t&&t.toString().trim()!==""}));return(a,t)=>(S(),T(B,null,[o(e(A),{title:`Votar: ${a.votacion.titulo}`},null,8,["title"]),o(L,{breadcrumbs:V},{default:s(()=>[i("div",Z,[i("div",ee,[i("div",null,[i("h1",te,d(a.votacion.titulo),1),i("p",oe,d(a.votacion.descripcion),1)]),o(e(x),{variant:"outline",onClick:y},{default:s(()=>[o(e(Q),{class:"mr-2 h-4 w-4"}),t[3]||(t[3]=r(" Volver "))]),_:1})]),o(e(g),null,{default:s(()=>[o(e(b),{class:"pt-6"},{default:s(()=>[i("div",ae,[i("div",se,[o(e(q),{variant:"outline"},{default:s(()=>[r(d(a.votacion.categoria.nombre),1)]),_:1})]),i("div",ie,[o(e(X),{class:"h-4 w-4"}),r(" Termina: "+d(D(a.votacion.fecha_fin)),1)]),i("div",re,[o(e(Y),{class:"h-4 w-4 text-orange-600"}),i("span",{class:M(f.value==="Expirada"?"text-red-600":"text-orange-600")},d(f.value==="Expirada"?"Votación expirada":`Tiempo restante: ${f.value}`),3)])])]),_:1})]),_:1}),o(e(g),null,{default:s(()=>[o(e(N),null,{default:s(()=>[o(e(U),{class:"flex items-center gap-2"},{default:s(()=>[o(e($),{class:"h-5 w-5"}),t[4]||(t[4]=r(" Formulario de Votación "))]),_:1})]),_:1}),o(e(b),null,{default:s(()=>[i("form",{onSubmit:t[1]||(t[1]=z(l=>u.value=!0,["prevent"])),class:"space-y-6"},[o(P,{fields:a.votacion.formulario_config,modelValue:e(n).respuestas,"onUpdate:modelValue":t[0]||(t[0]=l=>e(n).respuestas=l),"candidatos-elegibles":a.candidatosElegibles||{},errors:e(n).errors,disabled:e(n).processing,title:"",description:"",context:"votacion"},null,8,["fields","modelValue","candidatos-elegibles","errors","disabled"]),i("div",ne,[o(e(x),{type:"submit",disabled:!E.value||e(n).processing,class:"min-w-32"},{default:s(()=>[o(e($),{class:"mr-2 h-4 w-4"}),r(" "+d(e(n).processing?"Enviando...":"Enviar Voto"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),o(e(R),{open:u.value,"onUpdate:open":t[2]||(t[2]=l=>u.value=l)},{default:s(()=>[o(e(W),null,{default:s(()=>[o(e(G),null,{default:s(()=>[o(e(H),null,{default:s(()=>t[5]||(t[5]=[r("¿Confirmar voto?")])),_:1}),o(e(I),null,{default:s(()=>t[6]||(t[6]=[r(" Una vez enviado tu voto, no podrás modificarlo. ¿Estás seguro de que quieres proceder? ")])),_:1})]),_:1}),o(e(J),null,{default:s(()=>[o(e(K),null,{default:s(()=>t[7]||(t[7]=[r("Cancelar")])),_:1}),o(e(O),{onClick:w,class:"bg-primary"},{default:s(()=>t[8]||(t[8]=[r(" Confirmar Voto ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{ze as default};
