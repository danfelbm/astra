import{d as H,c as I,b as f,w as a,g as i,j as c,e as s,f as t,v as k,h as l,m as n,x as z,t as d,i as r,F as A,k as E}from"./app-KXtif7qq.js";import{_ as J}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DUay4fSq.js";import{_ as h,c as g,a as y,b as p}from"./CardTitle.vue_vue_type_script_setup_true_lang-B7Mglf7h.js";import{_ as K}from"./CardDescription.vue_vue_type_script_setup_true_lang-DSfUmw7N.js";import{_}from"./createLucideIcon-BY2zdh_L.js";import{_ as T}from"./index-DMu57UMp.js";import{_ as L,a as M}from"./index-B3w0F3K5.js";import{_ as Q}from"./ComentariosPanel.vue_vue_type_script_setup_true_lang-gn3oaPRx.js";import{_ as W}from"./EvidenciaAccionesEstado.vue_vue_type_script_setup_true_lang-kfPpzn4U.js";import{F as D}from"./file-QzGI2f6s.js";import{M as S}from"./music-2JV5ODN3.js";import{V as Y}from"./video-DF7NqHPM.js";import{I as Z}from"./image-D8Oh1jlI.js";import{C as O}from"./circle-x-Bjko7jiW.js";import{C as R}from"./circle-check-big-D3hEmsch.js";import{C as P}from"./clock-CwnMLRYk.js";import{A as ee}from"./arrow-left-nC1PH91F.js";import{D as w}from"./download-CWAwe1UV.js";import{T as te}from"./triangle-alert-DfsWRGnr.js";import{E as U}from"./eye-Dbpfrmlv.js";import"./useFlashMessages-C0levHeu.js";import"./index-dxUqd-18.js";import"./floating-ui.vue-oBzjxj0U.js";import"./x-BG7w8fZB.js";import"./Input.vue_vue_type_script_setup_true_lang-BkaVdW_x.js";import"./index-DM1P4Ifz.js";import"./index-WC1PnT1j.js";import"./shield-DnGJw1Ro.js";import"./user-D9tKp3_0.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B_dxU_KJ.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-lIT9MUQE.js";import"./VisuallyHidden-CuGa-e_U.js";import"./check-BXO7M11A.js";import"./chevron-right-qwsTIbSz.js";import"./house-D8k__HYI.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BtuZaRmw.js";import"./Label.vue_vue_type_script_setup_true_lang-kqtySDWN.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-hjOO1ket.js";import"./index-Dm0KPXQj.js";import"./circle-alert-BxdHbCZ8.js";import"./map-pin-Bgv-opIp.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-D7Pmpm9D.js";import"./chevrons-up-down-DK_UD8ra.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CHh-gB3O.js";import"./target-Dm6ej6_p.js";import"./users-BWb5DPyh.js";import"./vote-BnmR_OQK.js";import"./folder-open-Cx58QfFB.js";import"./send-C8_ce2KL.js";import"./file-text-CE1uNbyL.js";import"./briefcase-CRBoyl6H.js";import"./calendar-Ce5ju53J.js";import"./megaphone-BVwAYYrZ.js";import"./user-check-BpAk48jb.js";import"./clipboard-list-DEDIgC_n.js";import"./mail-SA5Kz7Xj.js";import"./message-square-CUB5aJ5F.js";import"./external-link-hexnS8K7.js";import"./panel-left-DuOe-Xz_.js";import"./index-D_JV8DVQ.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-C9giesaT.js";import"./RichTextEditor-B6uRBFwG.js";import"./italic-JnmAseTc.js";import"./list-Bv7GadOT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FileUploadField.vue_vue_type_script_setup_true_lang-DGNTq39P.js";import"./useFileUpload-5III_w6g.js";import"./upload-B42i2FXz.js";import"./paperclip-CZMafWH4.js";import"./loader-circle-DQozwruZ.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DumW1HW7.js";import"./arrow-right-DFQbcq1m.js";import"./ellipsis-6iwspEXM.js";import"./square-pen-BWHv0H84.js";import"./trash-2-BZw66j_J.js";import"./chevron-left-CJQtt0rE.js";import"./Switch.vue_vue_type_script_setup_true_lang-DyvvAwg_.js";import"./VisuallyHiddenInput-BGtQfI-v.js";import"./ComentarioContextoInput.vue_vue_type_script_setup_true_lang-Crr86EOM.js";const ie={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},oe={class:"flex justify-between items-start"},se={class:"flex items-center gap-4 mt-2"},ae={class:"text-muted-foreground"},ne={class:"flex gap-2"},de={class:"flex items-center justify-between"},re={key:0},le={class:"grid gap-6 lg:grid-cols-3"},ce={class:"lg:col-span-2 space-y-6"},me={key:0,class:"ml-2"},ue={class:"space-y-4"},fe={key:0,class:"space-y-4"},ve={key:0,class:"text-center"},xe=["src","alt"],he={class:"text-sm text-muted-foreground mt-2"},ge={key:1,class:"text-center"},_e=["src"],ye={class:"text-sm text-muted-foreground mt-2"},pe={key:2,class:"flex flex-col items-center gap-4"},be={class:"flex items-center gap-3"},we={class:"text-left"},ke={class:"font-medium"},Ce=["src"],$e={key:3,class:"flex items-center gap-4 py-4"},De={class:"flex-1"},ze={class:"font-medium"},Ae={class:"text-sm text-muted-foreground"},Ee={key:1,class:"bg-muted/30 rounded-lg p-4"},Te={key:0,class:"text-center"},Se=["src","alt"],Ve={key:1,class:"text-center"},Fe=["src"],Be={key:2,class:"flex flex-col items-center gap-4"},Ne=["src"],je={key:3,class:"flex flex-col items-center gap-4 py-8"},Ie={class:"text-center"},Le={class:"font-medium"},Me={class:"text-sm text-muted-foreground"},Oe={key:0},Re={key:2,class:"text-center py-8 text-muted-foreground"},Pe={class:"whitespace-pre-wrap"},Ue={class:"space-y-6"},Xe={class:"font-medium"},qe={key:0,class:"text-sm text-muted-foreground"},Ge={key:0},He={class:"font-medium"},Je={key:0,class:"text-sm text-muted-foreground mt-1"},Ke={class:"space-y-2"},Qe={class:"font-medium text-sm"},We={class:"text-xs text-muted-foreground"},Ye={class:"text-sm"},Ze={class:"text-sm"},et={key:0},tt={class:"space-y-2 max-h-32 overflow-y-auto"},it={class:"truncate flex-1 mr-2"},ot={key:1},st={class:"text-sm"},at={key:2},nt={class:"text-sm"},dt={class:"text-sm"},rt={class:"text-xs text-muted-foreground"},lt={class:"text-sm"},ct={key:3},mt={class:"text-sm"},ut={key:0,class:"text-xs text-muted-foreground"},ft={class:"text-sm whitespace-pre-wrap"},Mi=H({__name:"Show",props:{contrato:{},evidencia:{}},setup(e){const x=e,X=[{title:"Admin",href:"/admin/dashboard"},{title:"Contratos",href:"/admin/contratos"},{title:x.contrato.nombre,href:`/admin/contratos/${x.contrato.id}`},{title:"Evidencia",href:"#"}],V=I(()=>({imagen:Z,video:Y,audio:S,documento:D})[x.evidencia.tipo_evidencia]||D),F=I(()=>({pendiente:{color:"secondary",icon:P,bgClass:"bg-yellow-50",textClass:"text-yellow-800"},aprobada:{color:"success",icon:R,bgClass:"bg-green-50",textClass:"text-green-800"},rechazada:{color:"destructive",icon:O,bgClass:"bg-red-50",textClass:"text-red-800"}})[x.evidencia.estado]||{color:"default",icon:P,bgClass:"bg-gray-50",textClass:"text-gray-800"}),B=u=>u?new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",q=u=>u?new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"-",b=u=>{const o=u||x.evidencia.archivo_url;o&&window.open(o,"_blank")},G=()=>{var u;((u=x.evidencia.archivos_urls)==null?void 0:u.length)>0?x.evidencia.archivos_urls.forEach((o,C)=>{setTimeout(()=>{window.open(o,"_blank")},C*500)}):x.evidencia.archivo_url&&b()};return(u,o)=>(n(),f(J,{breadcrumbs:X},{default:a(()=>{var C,N;return[i("div",ie,[i("div",oe,[i("div",null,[s(t(k),{href:`/admin/contratos/${e.contrato.id}`,class:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-2"},{default:a(()=>[s(t(ee),{class:"w-4 h-4 mr-2"}),o[0]||(o[0]=l(" Volver al Contrato ",-1))]),_:1},8,["href"]),o[1]||(o[1]=i("h2",{class:"text-3xl font-bold tracking-tight"},"Evidencia",-1)),i("div",se,[s(t(T),{variant:F.value.color},{default:a(()=>[(n(),f(z(F.value.icon),{class:"w-3 h-3 mr-1"})),l(" "+d(e.evidencia.estado_label),1)]),_:1},8,["variant"]),s(t(T),{variant:"outline"},{default:a(()=>[(n(),f(z(V.value),{class:"w-3 h-3 mr-1"})),l(" "+d(e.evidencia.tipo_evidencia_label),1)]),_:1}),s(t(T),{variant:"secondary"},{default:a(()=>[l(d(e.evidencia.tiene_multiples_archivos?`${e.evidencia.total_archivos} archivos`:"1 archivo"),1)]),_:1}),i("span",ae," Subida "+d(q(e.evidencia.created_at)),1)])]),i("div",ne,[e.evidencia.tiene_multiples_archivos?(n(),f(t(_),{key:0,onClick:G,variant:"outline"},{default:a(()=>[s(t(w),{class:"w-4 h-4 mr-2"}),l(" Descargar Todos ("+d(e.evidencia.total_archivos)+") ",1)]),_:1})):e.evidencia.archivo_url?(n(),f(t(_),{key:1,onClick:b,variant:"outline"},{default:a(()=>[s(t(w),{class:"w-4 h-4 mr-2"}),o[2]||(o[2]=l(" Descargar ",-1))]),_:1})):c("",!0)])]),(C=e.contrato.proyecto)!=null&&C.id?(n(),f(t(h),{key:0,class:"border-dashed"},{default:a(()=>[s(t(g),{class:"py-3"},{default:a(()=>[i("div",de,[o[3]||(o[3]=i("span",{class:"text-sm text-muted-foreground"},"Acciones rápidas",-1)),s(W,{evidencia:e.evidencia,"proyecto-id":e.contrato.proyecto.id,"estado-actual":e.evidencia.estado},null,8,["evidencia","proyecto-id","estado-actual"])])]),_:1})]),_:1})):c("",!0),e.evidencia.estado==="rechazada"?(n(),f(t(L),{key:1,class:"border-red-200 bg-red-50"},{default:a(()=>[s(t(O),{class:"h-4 w-4 text-red-600"}),s(t(M),{class:"text-red-800"},{default:a(()=>[o[4]||(o[4]=l(" Esta evidencia ha sido rechazada. ",-1)),e.evidencia.observaciones_admin?(n(),r("span",re," Motivo: "+d(e.evidencia.observaciones_admin),1)):c("",!0)]),_:1})]),_:1})):c("",!0),e.evidencia.estado==="aprobada"?(n(),f(t(L),{key:2,class:"border-green-200 bg-green-50"},{default:a(()=>[s(t(R),{class:"h-4 w-4 text-green-600"}),s(t(M),{class:"text-green-800"},{default:a(()=>[...o[5]||(o[5]=[l(" Esta evidencia ha sido aprobada exitosamente. ",-1)])]),_:1})]),_:1})):c("",!0),i("div",le,[i("div",ce,[s(t(h),null,{default:a(()=>[s(t(y),null,{default:a(()=>[s(t(p),{class:"flex items-center gap-2"},{default:a(()=>[(n(),f(z(V.value),{class:"w-5 h-5"})),o[6]||(o[6]=l(" Archivo de Evidencia ",-1))]),_:1}),s(t(K),null,{default:a(()=>[l(d(e.evidencia.archivo_nombre||"Archivo subido")+" ",1),e.evidencia.archivo_size_formatted?(n(),r("span",me," ("+d(e.evidencia.archivo_size_formatted)+") ",1)):c("",!0)]),_:1})]),_:1}),s(t(g),null,{default:a(()=>{var v;return[i("div",ue,[((v=e.evidencia.archivos_info)==null?void 0:v.length)>0?(n(),r("div",fe,[(n(!0),r(A,null,E(e.evidencia.archivos_info,(m,$)=>(n(),r("div",{key:m.indice,class:"bg-muted/30 rounded-lg p-4 relative group"},[s(t(_),{onClick:j=>b(m.url),variant:"outline",size:"sm",class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity"},{default:a(()=>[s(t(w),{class:"w-4 h-4"})]),_:1},8,["onClick"]),e.evidencia.es_imagen?(n(),r("div",ve,[i("img",{src:m.url,alt:m.nombre,class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"},null,8,xe),i("p",he,d(m.nombre),1)])):e.evidencia.es_video?(n(),r("div",ge,[i("video",{src:m.url,controls:"",class:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}," Tu navegador no soporta la reproducción de video. ",8,_e),i("p",ye,d(m.nombre),1)])):e.evidencia.es_audio?(n(),r("div",pe,[i("div",be,[s(t(S),{class:"w-12 h-12 text-muted-foreground"}),i("div",we,[i("p",ke,d(m.nombre),1),o[7]||(o[7]=i("p",{class:"text-sm text-muted-foreground"},"Archivo de audio",-1))])]),i("audio",{src:m.url,controls:"",class:"w-full max-w-md"}," Tu navegador no soporta la reproducción de audio. ",8,Ce)])):(n(),r("div",$e,[s(t(D),{class:"w-12 h-12 text-muted-foreground flex-shrink-0"}),i("div",De,[i("p",ze,d(m.nombre),1),i("p",Ae,d(e.evidencia.tipo_evidencia_label),1)]),s(t(_),{onClick:j=>b(m.url),variant:"outline",size:"sm"},{default:a(()=>[s(t(w),{class:"w-4 h-4 mr-2"}),o[8]||(o[8]=l(" Descargar ",-1))]),_:1},8,["onClick"])]))]))),128))])):e.evidencia.archivo_url?(n(),r("div",Ee,[e.evidencia.es_imagen?(n(),r("div",Te,[i("img",{src:e.evidencia.archivo_url,alt:e.evidencia.descripcion||"Evidencia",class:"max-w-full max-h-96 mx-auto rounded-lg shadow-sm"},null,8,Se)])):e.evidencia.es_video?(n(),r("div",Ve,[i("video",{src:e.evidencia.archivo_url,controls:"",class:"max-w-full max-h-96 mx-auto rounded-lg shadow-sm"}," Tu navegador no soporta la reproducción de video. ",8,Fe)])):e.evidencia.es_audio?(n(),r("div",Be,[s(t(S),{class:"w-16 h-16 text-muted-foreground"}),i("audio",{src:e.evidencia.archivo_url,controls:"",class:"w-full max-w-md"}," Tu navegador no soporta la reproducción de audio. ",8,Ne)])):(n(),r("div",je,[s(t(D),{class:"w-16 h-16 text-muted-foreground"}),i("div",Ie,[i("p",Le,d(e.evidencia.archivo_nombre),1),i("p",Me,[l(d(e.evidencia.tipo_evidencia_label)+" ",1),e.evidencia.archivo_size_formatted?(n(),r("span",Oe," • "+d(e.evidencia.archivo_size_formatted),1)):c("",!0)])]),s(t(_),{onClick:b,variant:"outline"},{default:a(()=>[s(t(w),{class:"w-4 h-4 mr-2"}),o[9]||(o[9]=l(" Descargar para ver ",-1))]),_:1})]))])):(n(),r("div",Re,[s(t(te),{class:"w-12 h-12 mx-auto mb-3"}),o[10]||(o[10]=i("p",null,"No se pudo cargar el archivo",-1))]))])]}),_:1})]),_:1}),e.evidencia.descripcion?(n(),f(t(h),{key:0},{default:a(()=>[s(t(y),null,{default:a(()=>[s(t(p),null,{default:a(()=>[...o[11]||(o[11]=[l("Descripción",-1)])]),_:1})]),_:1}),s(t(g),null,{default:a(()=>[i("p",Pe,d(e.evidencia.descripcion),1)]),_:1})]),_:1})):c("",!0),s(Q,{"commentable-type":"evidencias","commentable-id":e.evidencia.id,"can-create":!0},null,8,["commentable-id"])]),i("div",Ue,[s(t(h),null,{default:a(()=>[s(t(y),null,{default:a(()=>[s(t(p),null,{default:a(()=>[...o[12]||(o[12]=[l("Información del Contrato",-1)])]),_:1})]),_:1}),s(t(g),{class:"space-y-4"},{default:a(()=>[i("div",null,[o[13]||(o[13]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Contrato",-1)),i("p",Xe,d(e.contrato.nombre),1),e.contrato.numero_contrato?(n(),r("p",qe," # "+d(e.contrato.numero_contrato),1)):c("",!0)]),e.contrato.proyecto?(n(),r("div",Ge,[o[14]||(o[14]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Proyecto",-1)),s(t(k),{href:`/admin/proyectos/${e.contrato.proyecto.id}`,class:"text-sm text-primary hover:underline"},{default:a(()=>[l(d(e.contrato.proyecto.nombre),1)]),_:1},8,["href"])])):c("",!0),s(t(_),{href:`/admin/contratos/${e.contrato.id}`,as:t(k),variant:"outline",size:"sm",class:"w-full"},{default:a(()=>[s(t(U),{class:"w-4 h-4 mr-2"}),o[15]||(o[15]=l(" Ver Contrato ",-1))]),_:1},8,["href","as"])]),_:1})]),_:1}),s(t(h),null,{default:a(()=>[s(t(y),null,{default:a(()=>[s(t(p),null,{default:a(()=>[...o[16]||(o[16]=[l("Obligación Contractual",-1)])]),_:1})]),_:1}),s(t(g),{class:"space-y-4"},{default:a(()=>[i("div",null,[i("p",He,d(e.evidencia.obligacion.nombre),1),e.evidencia.obligacion.descripcion?(n(),r("p",Je,d(e.evidencia.obligacion.descripcion),1)):c("",!0)]),s(t(_),{href:`/admin/obligaciones/${e.evidencia.obligacion.id}`,as:t(k),variant:"outline",size:"sm",class:"w-full"},{default:a(()=>[s(t(U),{class:"w-4 h-4 mr-2"}),o[17]||(o[17]=l(" Ver Obligación ",-1))]),_:1},8,["href","as"])]),_:1})]),_:1}),((N=e.evidencia.entregables)==null?void 0:N.length)>0?(n(),f(t(h),{key:0},{default:a(()=>[s(t(y),null,{default:a(()=>[s(t(p),null,{default:a(()=>[...o[18]||(o[18]=[l("Entregables Asociados",-1)])]),_:1})]),_:1}),s(t(g),null,{default:a(()=>[i("div",Ke,[(n(!0),r(A,null,E(e.evidencia.entregables,v=>(n(),f(t(k),{key:v.id,href:`/admin/proyectos/${v.hito.proyecto.id}/hitos/${v.hito.id}/entregables/${v.id}`,class:"block p-3 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer"},{default:a(()=>[i("p",Qe,d(v.nombre),1),i("p",We,d(v.hito.nombre),1)]),_:2},1032,["href"]))),128))])]),_:1})]),_:1})):c("",!0),s(t(h),null,{default:a(()=>[s(t(y),null,{default:a(()=>[s(t(p),null,{default:a(()=>[l(d(e.evidencia.tiene_multiples_archivos?"Detalles de los Archivos":"Detalles del Archivo"),1)]),_:1})]),_:1}),s(t(g),{class:"space-y-3"},{default:a(()=>{var v,m;return[i("div",null,[o[19]||(o[19]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Tipo",-1)),i("p",Ye,d(e.evidencia.tipo_evidencia_label),1)]),i("div",null,[o[20]||(o[20]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Cantidad",-1)),i("p",Ze,d(e.evidencia.total_archivos||1)+" archivo(s)",1)]),((v=e.evidencia.archivos_info)==null?void 0:v.length)>0?(n(),r("div",et,[o[21]||(o[21]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Archivos",-1)),i("div",tt,[(n(!0),r(A,null,E(e.evidencia.archivos_info,$=>(n(),r("div",{key:$.indice,class:"flex items-center justify-between text-xs p-2 bg-muted/30 rounded"},[i("span",it,d($.nombre),1),s(t(_),{onClick:j=>b($.url),size:"sm",variant:"ghost",class:"h-6 w-6 p-0"},{default:a(()=>[s(t(w),{class:"w-3 h-3"})]),_:1},8,["onClick"])]))),128))])])):e.evidencia.archivo_size_formatted?(n(),r("div",ot,[o[22]||(o[22]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Tamaño",-1)),i("p",st,d(e.evidencia.archivo_size_formatted),1)])):c("",!0),(m=e.evidencia.metadata)!=null&&m.mime_type?(n(),r("div",at,[o[23]||(o[23]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Formato",-1)),i("p",nt,d(e.evidencia.metadata.mime_type),1)])):c("",!0),i("div",null,[o[24]||(o[24]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Subido por",-1)),i("p",dt,d(e.evidencia.usuario.name),1),i("p",rt,d(e.evidencia.usuario.email),1)]),i("div",null,[o[25]||(o[25]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Fecha de subida",-1)),i("p",lt,d(B(e.evidencia.created_at)),1)]),e.evidencia.revisado_at?(n(),r("div",ct,[o[26]||(o[26]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Revisado",-1)),i("p",mt,d(B(e.evidencia.revisado_at)),1),e.evidencia.revisor?(n(),r("p",ut," por "+d(e.evidencia.revisor.name),1)):c("",!0)])):c("",!0)]}),_:1})]),_:1}),e.evidencia.observaciones_admin?(n(),f(t(h),{key:1},{default:a(()=>[s(t(y),null,{default:a(()=>[s(t(p),null,{default:a(()=>[...o[27]||(o[27]=[l("Observaciones de Revisión",-1)])]),_:1})]),_:1}),s(t(g),null,{default:a(()=>[i("p",ft,d(e.evidencia.observaciones_admin),1)]),_:1})]),_:1})):c("",!0)])])])]}),_:1}))}});export{Mi as default};
