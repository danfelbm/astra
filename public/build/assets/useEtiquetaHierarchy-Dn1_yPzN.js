import{r as s,c as M}from"./app-B7JHmzZ3.js";function _(a=s([])){const E=r=>{const n=new Map,l=[];return r.forEach(e=>{n.set(e.id,{...e,children:[]})}),r.forEach(e=>{const t=n.get(e.id);if(t)if(e.parent_id){const i=n.get(e.parent_id);i&&(i.children||(i.children=[]),i.children.push(t))}else l.push(t)}),l},o=r=>{const n=[],l=e=>{n.push(e),e.children&&e.children.length>0&&e.children.forEach(t=>l(t))};return r.forEach(e=>l(e)),n},h=(r,n=a.value)=>{for(const l of n){if(l.id===r)return l;if(l.children&&l.children.length>0){const e=h(r,l.children);if(e)return e}}return null},f=r=>{const n=[],l=o(a.value);let e=l.find(t=>t.id===r);for(;e;)n.unshift(e),e=e.parent_id?l.find(t=>t.id===e.parent_id):null;return n},p=(r,n)=>f(r).some(e=>e.id===n),g=(r,n)=>r===n?!1:!p(n,r),m=(r=a.value)=>{let n=0;const l=e=>{n++,e.children&&e.children.forEach(t=>l(t))};return r.forEach(e=>l(e)),n},v=(r=a.value)=>{if(!r||r.length===0)return 0;const n=(l,e=0)=>!l.children||l.children.length===0?e:Math.max(...l.children.map(t=>n(t,e+1)));return Math.max(...r.map(l=>n(l,0)))},D=(r,n=a.value)=>{if(!r)return n;const l=r.toLowerCase(),e=t=>{const i=t.nombre.toLowerCase().includes(l)||t.descripcion&&t.descripcion.toLowerCase().includes(l);let d=[];return t.children&&(d=t.children.map(u=>e(u)).filter(u=>u!==null)),i||d.length>0?{...t,children:d}:null};return n.map(t=>e(t)).filter(t=>t!==null)},b={draggedItem:s(null),dragOverItem:s(null),handleDragStart(r){this.draggedItem.value=r},handleDragOver(r,n){r.preventDefault(),this.dragOverItem.value=n},handleDrop(r,n){if(r.preventDefault(),!this.draggedItem.value)return;const l=this.draggedItem.value.id,e=(n==null?void 0:n.id)||null;return e&&!g(l,e)?(console.error("No se puede crear un ciclo en la jerarquÃ­a"),!1):{hijoId:l,padreId:e,valido:!0}},handleDragEnd(){this.draggedItem.value=null,this.dragOverItem.value=null}},c=s(new Set),x=r=>{c.value.has(r)?c.value.delete(r):c.value.add(r)},w=()=>{o(a.value).forEach(n=>{n.children&&n.children.length>0&&c.value.add(n.id)})},I=()=>{c.value.clear()},C=M(()=>({totalNodos:m(),profundidadMaxima:v(),totalRaices:a.value.filter(r=>!r.parent_id).length,totalConHijos:o(a.value).filter(r=>r.children&&r.children.length>0).length}));return{etiquetas:a,expandidos:c,estadisticas:C,construirArbol:E,aplanarArbol:o,buscarEnArbol:h,obtenerCamino:f,filtrarArbol:D,esDescendienteDe:p,validarRelacionPadreHijo:g,contarNodos:m,obtenerProfundidadMaxima:v,toggleExpansion:x,expandirTodos:w,colapsarTodos:I,dragDropHelpers:b}}export{_ as u};
