import{d as I,c as B,b as p,e as r,u as t,w as s,f as e,g as l,i as c,j as g,h as d,t as u,P,n as T,s as W,r as D,A as G,x as X,F as _,k as y,ar as J,W as w}from"./app-CGDcXcXm.js";import{_ as O}from"./UserLayout.vue_vue_type_script_setup_true_lang-CK2bSkKT.js";import{_ as h,b,a as x,c as Q}from"./CardTitle.vue_vue_type_script_setup_true_lang-BudF5sLg.js";import{_ as $}from"./CardDescription.vue_vue_type_script_setup_true_lang-B32gJRul.js";import{_ as A}from"./createLucideIcon-DanALmEC.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-De2JuYAO.js";import{_ as Y,a as Z,b as z,c as S}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-CJdIR_d7.js";import{_ as M,a as L}from"./index-3LFn1my6.js";import{_ as U}from"./index-BsPs8wxd.js";import{C as q}from"./calendar-BTZmtWlZ.js";import{D as tt}from"./dollar-sign-uPD9EzGg.js";import{U as et}from"./user-CyfX3Swe.js";import{C as st}from"./circle-alert-CaBwTfyT.js";import{F as E}from"./file-text-ByNZVhOA.js";import{E as ot}from"./eye-DIpLVUZd.js";import{S as at}from"./square-pen-BPwE7V_J.js";import{S as rt}from"./search-DKUrL-QT.js";import{F as lt}from"./filter-CxuF1EEm.js";import{T as nt}from"./triangle-alert-BkXGATZ3.js";import{C as it}from"./clock-CRCIQO9f.js";import{C as H}from"./circle-check-big-r-NobB5n.js";import{C as dt}from"./circle-x-DB25FOn9.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-_Nm3H6S4.js";import"./index-BBAsWOFq.js";import"./floating-ui.vue-36zNgrSP.js";import"./x-BDmXRx4n.js";import"./index-CcR8_wTx.js";import"./shield-Bejn5muX.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BBLyUXDE.js";import"./chevron-right-Ch7F_p_y.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-Blow8o_p.js";import"./VisuallyHidden-5PoN3-2b.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-BAaIhJ0J.js";import"./index-D4d4TGf0.js";import"./check-WUsKeayf.js";import"./nullish-CHIgUVhi.js";import"./Label.vue_vue_type_script_setup_true_lang-ucIShhqX.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-o2J4dePs.js";import"./index-D3sE_pCs.js";import"./map-pin-Cz6bXU5Q.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C7YVKPpr.js";import"./square-check-big-DJvqSVRt.js";import"./users-CsdoQTZz.js";import"./folder-open-ByFFqHS3.js";import"./index-HHRqvbiQ.js";import"./RovingFocusItem-DZlSNDJ8.js";import"./utils-BbQHozWa.js";const ct={class:"flex items-start justify-between"},ut={class:"flex-1"},mt={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},ft={key:0,class:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2"},pt={class:"grid grid-cols-2 gap-3 text-sm"},gt={class:"flex items-center gap-2"},vt={class:"ml-1 font-medium"},_t={class:"flex items-center gap-2"},yt={class:"ml-1 font-medium"},ht={key:0,class:"flex items-center gap-2"},bt={class:"font-medium"},xt={key:1,class:"flex items-center gap-2"},kt={class:"truncate"},wt={key:1,class:"flex items-center gap-2"},$t={key:2},Ct={class:"flex justify-between text-xs text-gray-600 mb-1"},zt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},St={class:"flex items-center justify-between"},Vt={key:0,class:"flex gap-2"},V=I({__name:"ContratoCard",props:{contrato:{},showProyecto:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0}},setup(N){const f=N,j=B(()=>({borrador:"bg-gray-100 text-gray-800",activo:"bg-green-100 text-green-800",finalizado:"bg-blue-100 text-blue-800",cancelado:"bg-red-100 text-red-800"})[f.contrato.estado]||"bg-gray-100 text-gray-800"),C=B(()=>f.contrato.estado==="cancelado"?"bg-red-500":f.contrato.estado==="finalizado"?"bg-blue-500":f.contrato.esta_vencido?"bg-red-500":f.contrato.esta_proximo_vencer?"bg-yellow-500":"bg-green-500"),v=a=>a?new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"-";return(a,m)=>(r(),p(t(h),{class:"hover:shadow-lg transition-shadow duration-300 cursor-pointer"},{default:s(()=>[e(t(x),null,{default:s(()=>[l("div",ct,[l("div",ut,[e(t(b),{class:"text-lg font-semibold mb-1"},{default:s(()=>[d(u(a.contrato.nombre),1)]),_:1}),a.showProyecto&&a.contrato.proyecto?(r(),c("div",mt,[e(t(P),{href:`/admin/proyectos/${a.contrato.proyecto.id}`,class:"hover:text-primary transition-colors"},{default:s(()=>[d(u(a.contrato.proyecto.nombre),1)]),_:1},8,["href"])])):g("",!0)]),e(t(U),{class:T(j.value)},{default:s(()=>[d(u(a.contrato.estado),1)]),_:1},8,["class"])])]),_:1}),e(t(Q),{class:"space-y-4"},{default:s(()=>[a.contrato.descripcion?(r(),c("p",ft,u(a.contrato.descripcion),1)):g("",!0),l("div",pt,[l("div",gt,[e(t(q),{class:"h-4 w-4 text-gray-400"}),l("div",null,[m[2]||(m[2]=l("span",{class:"text-gray-600 dark:text-gray-400"},"Inicio:",-1)),l("span",vt,u(v(a.contrato.fecha_inicio)),1)])]),l("div",_t,[e(t(q),{class:"h-4 w-4 text-gray-400"}),l("div",null,[m[3]||(m[3]=l("span",{class:"text-gray-600 dark:text-gray-400"},"Fin:",-1)),l("span",yt,u(v(a.contrato.fecha_fin)),1)])]),a.contrato.monto_formateado?(r(),c("div",ht,[e(t(tt),{class:"h-4 w-4 text-gray-400"}),l("span",bt,u(a.contrato.monto_formateado),1)])):g("",!0),a.contrato.responsable?(r(),c("div",xt,[e(t(et),{class:"h-4 w-4 text-gray-400"}),l("span",kt,u(a.contrato.responsable.name),1)])):g("",!0)]),a.contrato.esta_vencido||a.contrato.esta_proximo_vencer?(r(),c("div",wt,[e(t(st),{class:T(["h-4 w-4",a.contrato.esta_vencido?"text-red-500":"text-yellow-500"])},null,8,["class"]),l("span",{class:T(["text-sm font-medium",a.contrato.esta_vencido?"text-red-600":"text-yellow-600"])},u(a.contrato.esta_vencido?"Contrato vencido":`Vence en ${a.contrato.dias_restantes} días`),3)])):g("",!0),a.contrato.estado==="activo"&&a.contrato.porcentaje_transcurrido!==void 0?(r(),c("div",$t,[l("div",Ct,[m[4]||(m[4]=l("span",null,"Progreso",-1)),l("span",null,u(a.contrato.porcentaje_transcurrido)+"%",1)]),l("div",zt,[l("div",{class:T([C.value,"h-2 rounded-full transition-all duration-300"]),style:W({width:`${a.contrato.porcentaje_transcurrido}%`})},null,6)])])):g("",!0),l("div",St,[e(t(U),{variant:"outline",class:"text-xs"},{default:s(()=>[e(t(E),{class:"h-3 w-3 mr-1"}),d(" "+u(a.contrato.tipo),1)]),_:1}),a.showActions?(r(),c("div",Vt,[e(t(A),{size:"sm",variant:"ghost",onClick:m[0]||(m[0]=k=>a.$inertia.get(`/admin/contratos/${a.contrato.id}`))},{default:s(()=>[e(t(ot),{class:"h-4 w-4"})]),_:1}),e(t(A),{size:"sm",variant:"ghost",onClick:m[1]||(m[1]=k=>a.$inertia.get(`/admin/contratos/${a.contrato.id}/edit`))},{default:s(()=>[e(t(at),{class:"h-4 w-4"})]),_:1})])):g("",!0)])]),_:1})]),_:1}))}}),Tt={class:"space-y-6"},Ft={class:"flex flex-col gap-4"},Pt={class:"flex flex-col md:flex-row gap-4"},Bt={class:"flex-1 relative"},Nt=["value"],jt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-6"},Dt={key:0,class:"text-center py-12"},At={key:1,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Et={key:0,class:"text-center py-12"},Mt={key:1,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Lt={key:0,class:"text-center py-12"},Ut={key:1,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},qt={key:0,class:"text-center py-12"},Ht={key:1,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},It={key:0,class:"text-center py-12"},Kt={key:1,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Wt={key:2,class:"flex justify-center mt-6"},Gt={class:"flex gap-2"},Ue=I({__name:"Index",props:{contratos:{},filtros:{},estadisticas:{},proyectos:{},authPermissions:{}},setup(N){const f=N,j=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Contratos",href:"/miembro/mis-contratos"}],C=D(f.filtros.search||""),v=D(f.filtros.estado||"todos"),a=D(f.filtros.proyecto_id||0);B(()=>f.authPermissions.includes("contratos.view_own"));const m=B(()=>({todos:f.contratos.data,activos:f.contratos.data.filter(o=>o.estado==="activo"),finalizados:f.contratos.data.filter(o=>o.estado==="finalizado"),borradores:f.contratos.data.filter(o=>o.estado==="borrador"),cancelados:f.contratos.data.filter(o=>o.estado==="cancelado")})),k=()=>{w.get(route("user.mis-contratos.index"),{search:C.value,estado:v.value!=="todos"?v.value:void 0,proyecto_id:a.value||void 0},{preserveState:!0,preserveScroll:!0})},K=i=>{v.value=i,k()};return(i,o)=>(r(),p(O,{breadcrumbs:j},{default:s(()=>[l("div",Tt,[l("div",Ft,[o[4]||(o[4]=l("div",null,[l("h2",{class:"text-3xl font-bold tracking-tight"},"Mis Contratos"),l("p",{class:"text-muted-foreground mt-2"}," Gestiona y consulta los contratos de tus proyectos ")],-1)),l("div",Pt,[l("div",Bt,[e(t(rt),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e(t(R),{modelValue:C.value,"onUpdate:modelValue":o[0]||(o[0]=n=>C.value=n),placeholder:"Buscar contratos...",class:"pl-10",onKeyup:X(k,["enter"])},null,8,["modelValue"])]),G(l("select",{"onUpdate:modelValue":o[1]||(o[1]=n=>a.value=n),onChange:k,class:"px-3 py-2 border border-input rounded-md bg-background"},[o[2]||(o[2]=l("option",{value:0},"Todos los proyectos",-1)),(r(!0),c(_,null,y(i.proyectos,n=>(r(),c("option",{key:n.id,value:n.id},u(n.nombre),9,Nt))),128))],544),[[J,a.value]]),e(t(A),{onClick:k},{default:s(()=>[e(t(lt),{class:"w-4 h-4 mr-2"}),o[3]||(o[3]=d(" Filtrar ",-1))]),_:1})])]),l("div",jt,[e(t(h),null,{default:s(()=>[e(t(x),{class:"pb-3"},{default:s(()=>[e(t($),null,{default:s(()=>[...o[5]||(o[5]=[d("Total",-1)])]),_:1}),e(t(b),{class:"text-2xl"},{default:s(()=>[d(u(i.estadisticas.total),1)]),_:1})]),_:1})]),_:1}),e(t(h),null,{default:s(()=>[e(t(x),{class:"pb-3"},{default:s(()=>[e(t($),null,{default:s(()=>[...o[6]||(o[6]=[d("Activos",-1)])]),_:1}),e(t(b),{class:"text-2xl text-green-600"},{default:s(()=>[d(u(i.estadisticas.activos),1)]),_:1})]),_:1})]),_:1}),e(t(h),null,{default:s(()=>[e(t(x),{class:"pb-3"},{default:s(()=>[e(t($),null,{default:s(()=>[...o[7]||(o[7]=[d("Finalizados",-1)])]),_:1}),e(t(b),{class:"text-2xl text-blue-600"},{default:s(()=>[d(u(i.estadisticas.finalizados),1)]),_:1})]),_:1})]),_:1}),e(t(h),null,{default:s(()=>[e(t(x),{class:"pb-3"},{default:s(()=>[e(t($),null,{default:s(()=>[...o[8]||(o[8]=[d("Vencidos",-1)])]),_:1}),e(t(b),{class:"text-2xl text-red-600"},{default:s(()=>[d(u(i.estadisticas.vencidos),1)]),_:1})]),_:1})]),_:1}),e(t(h),null,{default:s(()=>[e(t(x),{class:"pb-3"},{default:s(()=>[e(t($),null,{default:s(()=>[...o[9]||(o[9]=[d("Por Vencer",-1)])]),_:1}),e(t(b),{class:"text-2xl text-orange-600"},{default:s(()=>[d(u(i.estadisticas.proximos_vencer),1)]),_:1})]),_:1})]),_:1}),e(t(h),null,{default:s(()=>[e(t(x),{class:"pb-3"},{default:s(()=>[e(t($),null,{default:s(()=>[...o[10]||(o[10]=[d("Monto Total",-1)])]),_:1}),e(t(b),{class:"text-xl"},{default:s(()=>{var n;return[d(" $"+u(((n=i.estadisticas.monto_total)==null?void 0:n.toLocaleString())||0),1)]}),_:1})]),_:1})]),_:1})]),i.estadisticas.vencidos>0?(r(),p(t(M),{key:0,class:"border-red-200 bg-red-50"},{default:s(()=>[e(t(nt),{class:"h-4 w-4 text-red-600"}),e(t(L),{class:"text-red-800"},{default:s(()=>[d(" Tienes "+u(i.estadisticas.vencidos)+" contrato(s) vencido(s) que requieren atención. ",1),e(t(P),{href:i.route("user.mis-contratos.vencidos"),class:"font-medium underline ml-2"},{default:s(()=>[...o[11]||(o[11]=[d(" Ver contratos vencidos ",-1)])]),_:1},8,["href"])]),_:1})]),_:1})):g("",!0),i.estadisticas.proximos_vencer>0?(r(),p(t(M),{key:1,class:"border-orange-200 bg-orange-50"},{default:s(()=>[e(t(it),{class:"h-4 w-4 text-orange-600"}),e(t(L),{class:"text-orange-800"},{default:s(()=>[d(u(i.estadisticas.proximos_vencer)+" contrato(s) vencerán en los próximos 30 días. ",1),e(t(P),{href:i.route("user.mis-contratos.proximos-vencer"),class:"font-medium underline ml-2"},{default:s(()=>[...o[12]||(o[12]=[d(" Ver próximos a vencer ",-1)])]),_:1},8,["href"])]),_:1})]),_:1})):g("",!0),e(t(Y),{"default-value":v.value,"onUpdate:modelValue":K},{default:s(()=>[e(t(Z),{class:"grid w-full grid-cols-5"},{default:s(()=>[e(t(z),{value:"todos"},{default:s(()=>[d(" Todos ("+u(m.value.todos.length)+") ",1)]),_:1}),e(t(z),{value:"activos"},{default:s(()=>[d(" Activos ("+u(m.value.activos.length)+") ",1)]),_:1}),e(t(z),{value:"finalizados"},{default:s(()=>[d(" Finalizados ("+u(m.value.finalizados.length)+") ",1)]),_:1}),e(t(z),{value:"borradores"},{default:s(()=>[d(" Borradores ("+u(m.value.borradores.length)+") ",1)]),_:1}),e(t(z),{value:"cancelados"},{default:s(()=>[d(" Cancelados ("+u(m.value.cancelados.length)+") ",1)]),_:1})]),_:1}),e(t(S),{value:"todos",class:"mt-6"},{default:s(()=>[i.contratos.data.length===0?(r(),c("div",Dt,[e(t(E),{class:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),o[13]||(o[13]=l("p",{class:"text-muted-foreground"}," No tienes contratos asignados ",-1))])):(r(),c("div",At,[(r(!0),c(_,null,y(i.contratos.data,n=>(r(),p(V,{key:n.id,contrato:n,"show-actions":!1,onClick:F=>t(w).visit(i.route("user.mis-contratos.show",n.id))},null,8,["contrato","onClick"]))),128))]))]),_:1}),e(t(S),{value:"activos",class:"mt-6"},{default:s(()=>[m.value.activos.length===0?(r(),c("div",Et,[e(t(H),{class:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),o[14]||(o[14]=l("p",{class:"text-muted-foreground"}," No hay contratos activos ",-1))])):(r(),c("div",Mt,[(r(!0),c(_,null,y(m.value.activos,n=>(r(),p(V,{key:n.id,contrato:n,"show-actions":!1,onClick:F=>t(w).visit(i.route("user.mis-contratos.show",n.id))},null,8,["contrato","onClick"]))),128))]))]),_:1}),e(t(S),{value:"finalizados",class:"mt-6"},{default:s(()=>[m.value.finalizados.length===0?(r(),c("div",Lt,[e(t(H),{class:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),o[15]||(o[15]=l("p",{class:"text-muted-foreground"}," No hay contratos finalizados ",-1))])):(r(),c("div",Ut,[(r(!0),c(_,null,y(m.value.finalizados,n=>(r(),p(V,{key:n.id,contrato:n,"show-actions":!1,onClick:F=>t(w).visit(i.route("user.mis-contratos.show",n.id))},null,8,["contrato","onClick"]))),128))]))]),_:1}),e(t(S),{value:"borradores",class:"mt-6"},{default:s(()=>[m.value.borradores.length===0?(r(),c("div",qt,[e(t(E),{class:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),o[16]||(o[16]=l("p",{class:"text-muted-foreground"}," No hay contratos en borrador ",-1))])):(r(),c("div",Ht,[(r(!0),c(_,null,y(m.value.borradores,n=>(r(),p(V,{key:n.id,contrato:n,"show-actions":!1,onClick:F=>t(w).visit(i.route("user.mis-contratos.show",n.id))},null,8,["contrato","onClick"]))),128))]))]),_:1}),e(t(S),{value:"cancelados",class:"mt-6"},{default:s(()=>[m.value.cancelados.length===0?(r(),c("div",It,[e(t(dt),{class:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),o[17]||(o[17]=l("p",{class:"text-muted-foreground"}," No hay contratos cancelados ",-1))])):(r(),c("div",Kt,[(r(!0),c(_,null,y(m.value.cancelados,n=>(r(),p(V,{key:n.id,contrato:n,"show-actions":!1,onClick:F=>t(w).visit(i.route("user.mis-contratos.show",n.id))},null,8,["contrato","onClick"]))),128))]))]),_:1})]),_:1},8,["default-value"]),i.contratos.links&&i.contratos.links.length>3?(r(),c("div",Wt,[l("nav",Gt,[(r(!0),c(_,null,y(i.contratos.links,n=>(r(),p(t(P),{key:n.label,href:n.url,class:T(["px-3 py-2 rounded-md text-sm",n.active?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"]),innerHTML:n.label,"preserve-state":"","preserve-scroll":""},null,8,["href","class","innerHTML"]))),128))])])):g("",!0)])]),_:1}))}});export{Ue as default};
