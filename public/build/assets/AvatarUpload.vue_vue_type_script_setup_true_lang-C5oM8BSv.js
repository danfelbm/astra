import{_ as F,a as M,b as P}from"./index-CgVSfdqX.js";import{_ as $}from"./createLucideIcon-CiWTV2sr.js";import{_ as G}from"./Label.vue_vue_type_script_setup_true_lang-CnYuL5N8.js";import{t as x}from"./index-CeoZ0Klu.js";import{U as L}from"./user-C6TSB5_J.js";import{L as R}from"./loader-circle-CjGsoDjy.js";import{U as T}from"./upload-Dk12Veil.js";import{X as I}from"./x-BLnECrCi.js";import{d as W,r as y,p as J,i as d,j as f,g as l,b as u,w as h,h as k,t as p,f as o,e as w,n as q,m as s}from"./app-Bwo8gItk.js";const O={class:"space-y-2"},X={key:0},H={key:1,class:"text-sm text-muted-foreground"},K={class:"flex items-start space-x-4"},Q={key:1,class:"text-2xl font-semibold"},Y={class:"flex-1 space-y-2"},Z=["accept","disabled"],ee={class:"space-y-2"},ae={class:"flex justify-center"},te={class:"text-sm"},se={key:0,class:"text-muted-foreground"},re={key:1,class:"text-muted-foreground"},le={class:"text-xs text-muted-foreground"},ve=W({__name:"AvatarUpload",props:{modelValue:{},label:{default:"Foto de perfil"},description:{default:"JPG, PNG o WEBP. Máximo 5MB."},maxSize:{default:5},accept:{default:".jpg,.jpeg,.png,.webp"},userName:{default:"Usuario"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","upload","delete","error"],setup(a,{emit:U}){const b=a,m=U,v=y(!1),n=y(!1),g=y(),c=y(null);J(()=>b.modelValue,e=>{c.value=e},{immediate:!0});const B=e=>e.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2),C=["image/jpeg","image/jpg","image/png","image/webp"],N=e=>{if(!C.includes(e.type))return"Tipo de archivo no válido. Solo se permiten JPG, PNG y WEBP.";const t=b.maxSize*1024*1024;return e.size>t?`El archivo excede el tamaño máximo de ${b.maxSize}MB.`:null},_=async e=>{const t=N(e);if(t){x.error(t),m("error",t);return}try{n.value=!0;const r=new FileReader;r.onload=i=>{var D;c.value=(D=i.target)==null?void 0:D.result},r.readAsDataURL(e),m("upload",e),x.success("Avatar cargado correctamente")}catch{const i="Error al cargar el archivo";x.error(i),m("error",i)}finally{n.value=!1}},z=e=>{var i;const r=(i=e.target.files)==null?void 0:i[0];r&&_(r)},S=e=>{e.preventDefault(),v.value=!0},V=e=>{e.preventDefault(),v.value=!1},j=e=>{var r;e.preventDefault(),v.value=!1;const t=(r=e.dataTransfer)==null?void 0:r.files[0];t&&t.type.startsWith("image/")&&_(t)},A=()=>{var e;(e=g.value)==null||e.click()},E=()=>{c.value=null,m("update:modelValue",null),m("delete"),x.success("Avatar eliminado correctamente"),g.value&&(g.value.value="")};return(e,t)=>(s(),d("div",O,[a.label||a.description?(s(),d("div",X,[a.label?(s(),u(o(G),{key:0,class:"text-sm font-medium"},{default:h(()=>[k(p(a.label),1)]),_:1})):f("",!0),a.description?(s(),d("p",H,p(a.description),1)):f("",!0)])):f("",!0),l("div",K,[w(o(F),{class:"h-24 w-24"},{default:h(()=>[c.value?(s(),u(o(M),{key:0,src:c.value,alt:a.userName},null,8,["src","alt"])):f("",!0),w(o(P),{class:"bg-muted"},{default:h(()=>[!a.userName||a.userName==="Usuario"?(s(),u(o(L),{key:0,class:"h-12 w-12 text-muted-foreground"})):(s(),d("span",Q,p(B(a.userName)),1))]),_:1})]),_:1}),l("div",Y,[l("div",{onDragover:S,onDragleave:V,onDrop:j,class:q(["border-2 border-dashed rounded-lg p-4 text-center cursor-pointer transition-colors",v.value?"border-primary bg-primary/5":"border-border hover:border-primary/50",a.disabled?"opacity-50 cursor-not-allowed":""]),onClick:A},[l("input",{ref_key:"fileInputRef",ref:g,type:"file",accept:a.accept,onChange:z,disabled:a.disabled||n.value,class:"hidden"},null,40,Z),l("div",ee,[l("div",ae,[n.value?(s(),u(o(R),{key:0,class:"h-8 w-8 animate-spin text-primary"})):(s(),u(o(T),{key:1,class:"h-8 w-8 text-muted-foreground"}))]),l("div",te,[n.value?(s(),d("span",se,"Cargando...")):(s(),d("span",re,[...t[0]||(t[0]=[k(" Arrastra una imagen aquí o ",-1),l("span",{class:"text-primary font-medium"},"selecciona un archivo",-1)])]))]),l("p",le,p(a.accept.replace(/\./g,"").toUpperCase().replace(/,/g,", "))+" • Max "+p(a.maxSize)+"MB ",1)])],34),c.value?(s(),u(o($),{key:0,onClick:E,variant:"outline",size:"sm",disabled:a.disabled||n.value,class:"w-full"},{default:h(()=>[w(o(I),{class:"h-4 w-4 mr-2"}),t[1]||(t[1]=k(" Eliminar avatar ",-1))]),_:1},8,["disabled"])):f("",!0)])])]))}});export{ve as _};
