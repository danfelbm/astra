import{d as xe,i as u,e as a,j as f,f as o,w as i,h as d,t as c,F as S,k as F,m as n,b as h,c as j,u as je,r as y,p as N,o as Ae,q as Ee,g as r,O as ze,x as Ie,n as ue,s as B}from"./app-B0Dy8rKi.js";import{_ as Ue}from"./index-BXYOoHn0.js";import{_ as x}from"./createLucideIcon-xrpdt54s.js";import{_ as A,c as E,a as T,b as H}from"./CardTitle.vue_vue_type_script_setup_true_lang-BfMGMCj7.js";import{_ as ce}from"./Checkbox.vue_vue_type_script_setup_true_lang-CGbLpFR2.js";import{_ as me}from"./Input.vue_vue_type_script_setup_true_lang-D8Hp4vgl.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-CU8FAIJ9.js";import{_ as ee,a as oe,b as te,c as ae,d as se}from"./SelectValue.vue_vue_type_script_setup_true_lang-DkJUGQDC.js";import{_ as Be,a as Fe,b as K,c as Y}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-DvdE5wH6.js";import{_ as fe}from"./Textarea.vue_vue_type_script_setup_true_lang-Cb-Myens.js";import{_ as R}from"./DateTimePicker.vue_vue_type_script_setup_true_lang-juqrlRCw.js";import{_ as Pe}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B30diyEW.js";import{L as De,_ as Le,D as qe}from"./DynamicFormBuilder-FXRIqbH2.js";import{_ as Me}from"./CsvImportWizard.vue_vue_type_script_setup_true_lang-BFQgf-Of.js";import{_ as Ne}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-j-GFI0cw.js";import{d as Te}from"./debounce-DQ46m1Tt.js";import{C as He}from"./circle-alert-Dkrr0PoB.js";import{U as pe}from"./upload-_6idcvZL.js";import{P as ve}from"./plus-DHb6rSSh.js";import{H as _e}from"./history-CfApZoyy.js";import{S as Re}from"./search-VtBBu6cR.js";import{L as Ge}from"./loader-circle-Bsvu9v1G.js";import{T as Oe}from"./trash-2-Cy9pknTk.js";import{C as Ze}from"./chevron-left-Df02W1EK.js";import{C as Qe}from"./chevron-right-CL72Brng.js";import{C as We}from"./circle-x-CU5qjqXO.js";import{C as Xe}from"./circle-check-big-BRLzGkp6.js";import{C as ge}from"./clock-DTyKloi2.js";import"./index-DGkMxdGf.js";import"./index-CxRjDcu6.js";import"./floating-ui.vue-CNHy5hvL.js";import"./check-Cf-GKpqy.js";import"./VisuallyHidden-DxSInn-M.js";import"./RovingFocusItem-D5q5BBGh.js";import"./utils-7R8MTDx-.js";import"./useFlashMessages-yn6-i8Xw.js";import"./x-436kEeG1.js";import"./index-BwF5VWwN.js";import"./shield-qWpKl1FA.js";import"./user-DBmnWwc7.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-5ICDNOri.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BO7OrjmZ.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Cy2v8V6t.js";import"./index-Bgqi0rpw.js";import"./map-pin-DXKoxVta.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DtgYdlF8.js";import"./chevrons-up-down-DXUOC6ow.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-B90NpS3k.js";import"./folder-BoXM9L1f.js";import"./users-BLf_K4wj.js";import"./target-BB5alG4s.js";import"./vote-BnrnRf8h.js";import"./folder-open-BPPvUoY9.js";import"./send-DbUsvwpO.js";import"./file-text-Dh4nESY8.js";import"./briefcase-CxcIQXSO.js";import"./calendar-DJcLf8Ae.js";import"./megaphone-B6ytzu6a.js";import"./user-check-CI-NP1LQ.js";import"./clipboard-list-CVSvnyXy.js";import"./mail-B5MLu5Su.js";import"./message-square-BSAL19zT.js";import"./external-link-BYYejV6M.js";import"./panel-left-CiOSA-PW.js";import"./index-DDDDmr0x.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-BquK8dj_.js";import"./VisuallyHiddenInput-zWXrEOtO.js";import"./circle-DV5NyTIT.js";import"./grip-vertical-kXnWMZyl.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-wfFOS7Tg.js";import"./eye-D6ZrbgaG.js";import"./git-branch-Bd-QlnVJ.js";import"./square-pen-E3B5bnus.js";import"./copy-BDTmUIb5.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-CGiBK8AC.js";import"./index-CZbqIb6w.js";const Je={key:0,class:"text-red-500"},Ke={key:0,class:"text-sm text-destructive mt-1"},Ye={key:1,class:"text-xs text-muted-foreground mt-1"},eo=xe({__name:"TimezoneSelector",props:{modelValue:{},disabled:{type:Boolean,default:!1},label:{default:"Zona Horaria"},placeholder:{default:"Seleccionar zona horaria"},description:{default:"Las fechas de apertura y cierre se aplicar√°n seg√∫n esta zona horaria"},required:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(v,{emit:m}){const p=m,G=P=>{p("update:modelValue",P)};return(P,O)=>(n(),u("div",null,[a(o(b),null,{default:i(()=>[d(c(v.label)+" ",1),v.required?(n(),u("span",Je,"*")):f("",!0)]),_:1}),a(o(ee),{"model-value":v.modelValue,"onUpdate:modelValue":G,disabled:v.disabled},{default:i(()=>[a(o(oe),null,{default:i(()=>[a(o(te),{placeholder:v.placeholder},null,8,["placeholder"])]),_:1}),a(o(ae),null,{default:i(()=>[(n(!0),u(S,null,F(o(De),t=>(n(),h(o(se),{key:t.value,value:t.value},{default:i(()=>[d(c(t.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),v.error?(n(),u("p",Ke,c(v.error),1)):v.description?(n(),u("p",Ye,c(v.description),1)):f("",!0)]))}}),oo={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},to={class:"flex items-center justify-between"},ao={class:"text-3xl font-bold"},so={class:"text-muted-foreground"},io={class:"relative min-h-[70vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},lo={class:"grid gap-6 md:grid-cols-2"},ro={class:"space-y-4"},no={key:0,class:"text-sm text-destructive mt-1"},uo={key:0,class:"text-sm text-destructive mt-1"},co={key:0,class:"text-sm text-destructive mt-1"},mo={class:"space-y-4"},fo={key:0,class:"text-sm text-destructive mt-1"},po={key:0,class:"text-sm text-destructive mt-1"},vo={key:1,class:"text-sm text-destructive mt-1"},_o={class:"flex items-center space-x-2"},go={key:0,class:"space-y-2"},xo={class:"flex items-center space-x-2 mt-4"},bo={key:0,class:"text-sm text-destructive mt-1"},yo={key:0},ho={key:0,class:"text-sm text-destructive mt-1"},Vo={class:"flex justify-between"},ko={class:"flex gap-2"},wo={class:"flex justify-between"},Co={class:"flex gap-2"},$o={class:"flex items-center space-x-2 text-yellow-700"},So={class:"space-y-4"},jo={class:"flex items-center gap-2"},Ao={key:0,class:"text-center py-6 text-muted-foreground"},Eo={key:1,class:"space-y-3"},zo=["onClick"],Io={class:"flex items-center gap-3"},Uo={class:"font-medium text-sm"},Bo={class:"text-xs text-muted-foreground"},Fo={class:"flex items-center gap-2"},Po={key:0,class:"text-xs text-muted-foreground"},Do={key:0},Lo={key:1,class:"text-xs text-muted-foreground"},qo={class:"relative"},Mo={key:0,class:"flex items-center justify-center py-8"},No={key:1,class:"text-center py-8 text-muted-foreground"},To={key:0},Ho={key:1},Ro={key:2},Go={class:"space-y-2 max-h-96 overflow-y-auto"},Oo={class:"flex-1 min-w-0"},Zo={class:"font-medium truncate"},Qo={class:"flex items-center gap-4 text-sm text-muted-foreground"},Wo={class:"truncate"},Xo={key:0},Jo={key:1},Ko={key:0,class:"flex items-center justify-between pt-4 border-t"},Yo={class:"text-sm text-muted-foreground"},et={class:"flex gap-2"},ot={class:"flex justify-between"},Ca=xe({__name:"Form",props:{categorias:{},votacion:{},cargos:{},periodosElectorales:{},convocatorias:{},canManageVoters:{type:Boolean}},setup(v){var ne,de;const m=v,p=j(()=>!!m.votacion),G=j(()=>{var l;return p.value&&((l=m.votacion)==null?void 0:l.estado)==="borrador"&&m.canManageVoters}),P=[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:p.value?"Editar":"Crear",href:"#"}],O=()=>{if(!m.votacion)return{titulo:"",descripcion:"",categoria_id:"",fecha_inicio:null,fecha_fin:null,estado:"borrador",resultados_publicos:!1,allow_tokens_download:!1,fecha_publicacion_resultados:null,limite_censo:null,mensaje_limite_censo:"",formulario_config:[],timezone:"America/Bogota",territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[]};const l=m.votacion;return{titulo:l.titulo||"",descripcion:l.descripcion||"",categoria_id:l.categoria_id?String(l.categoria_id):"",fecha_inicio:l.fecha_inicio||null,fecha_fin:l.fecha_fin||null,estado:l.estado||"borrador",resultados_publicos:!!l.resultados_publicos,allow_tokens_download:!!l.allow_tokens_download,fecha_publicacion_resultados:l.fecha_publicacion_resultados||null,limite_censo:l.limite_censo||null,mensaje_limite_censo:l.mensaje_limite_censo||"",formulario_config:l.formulario_config||[],timezone:l.timezone||"America/Bogota",territorios_ids:l.territorios_ids||[],departamentos_ids:l.departamentos_ids||[],municipios_ids:l.municipios_ids||[],localidades_ids:l.localidades_ids||[]}},t=je(O()),k=y("basicos"),be=[{value:"borrador",label:"Borrador"},{value:"activa",label:"Activa"},{value:"finalizada",label:"Finalizada"}],ie=j({get:()=>({territorios_ids:t.territorios_ids||[],departamentos_ids:t.departamentos_ids||[],municipios_ids:t.municipios_ids||[],localidades_ids:t.localidades_ids||[]}),set:l=>{t.territorios_ids=l.territorios_ids,t.departamentos_ids=l.departamentos_ids,t.municipios_ids=l.municipios_ids,t.localidades_ids=l.localidades_ids}}),le=j(()=>!t.fecha_fin||!t.fecha_inicio?"":t.fecha_fin<=t.fecha_inicio?"La fecha de fin debe ser posterior a la fecha de inicio":""),Z=()=>{if(!z.value){k.value="basicos",alert('Por favor completa todos los campos requeridos en la pesta√±a "Datos B√°sicos" antes de crear la votaci√≥n.');return}if(t.formulario_config.length===0){alert("Por favor agrega al menos un campo al formulario antes de crear la votaci√≥n.");return}p.value?t.put(`/admin/votaciones/${m.votacion.id}`,{onError:l=>{const e=Object.values(l)[0];e&&alert(`Error: ${Array.isArray(e)?e[0]:e}`)}}):t.post("/admin/votaciones",{onError:l=>{const e=Object.values(l)[0];e&&alert(`Error: ${Array.isArray(e)?e[0]:e}`)}})},z=j(()=>t.titulo&&t.categoria_id&&t.fecha_inicio&&t.fecha_fin&&t.timezone);j(()=>z.value&&t.formulario_config.length>0);const $=y(((ne=m.votacion)==null?void 0:ne.votantes)||[]),w=y(((de=m.votacion)==null?void 0:de.votantes_total)||0),_=y(1),Q=y(50),W=y(!1),V=y(""),X=y(1),I=y(!1),D=y(!1),L=y([]),re=async()=>{var l;if(!(!p.value||!((l=m.votacion)!=null&&l.id)))try{const e=await fetch(`/admin/votaciones/${m.votacion.id}/imports/recent`);if(e.ok){const g=await e.json();L.value=g}}catch(e){console.error("Error loading recent imports:",e)}},ye=l=>{B.get(`/admin/imports/${l}`)},he=()=>{var l;(l=m.votacion)!=null&&l.id&&B.get(`/admin/votaciones/${m.votacion.id}/imports`)},q=l=>{switch(l){case"pending":return{icon:ge,label:"Pendiente",class:"text-yellow-600"};case"processing":return{icon:ge,label:"Procesando",class:"text-blue-600"};case"completed":return{icon:Xe,label:"Completada",class:"text-green-600"};case"failed":return{icon:We,label:"Fallida",class:"text-red-600"}}},Ve=l=>new Date(l).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=async(l=1,e="")=>{var g;if((g=m.votacion)!=null&&g.id){W.value=!0;try{const s=new URLSearchParams({page:l.toString(),per_page:Q.value.toString(),...e&&{query:e}}),M=await(await fetch(`/admin/votaciones/${m.votacion.id}/assigned-voters?${s}`)).json();$.value=M.data||[],w.value=M.total||0,_.value=M.current_page||1,X.value=M.last_page||1}catch(s){console.error("Error cargando votantes:",s)}finally{W.value=!1}}},ke=Te(()=>{_.value=1,U(1,V.value)},300),J=l=>{_.value=l,U(l,V.value)};N(V,()=>{ke()}),N(()=>k.value,l=>{var e;l==="votantes"&&((e=m.votacion)!=null&&e.id)&&w.value>0&&($.value.length===0||$.value.length<w.value&&$.value.length<=50)&&U()});const we=l=>{var e;!l.userIds||l.userIds.length===0||!p.value||!((e=m.votacion)!=null&&e.id)||B.post(`/admin/votaciones/${m.votacion.id}/votantes`,{votante_ids:l.userIds.map(g=>g.toString())},{preserveScroll:!0,onSuccess:()=>{w.value+=l.userIds.length,U(_.value,V.value),D.value=!1},onError:g=>{console.error("Error adding votantes:",g),alert("Error al agregar votantes")}})},Ce=l=>{var e;!p.value||!((e=m.votacion)!=null&&e.id)||B.delete(`/admin/votaciones/${m.votacion.id}/votantes`,{data:{votante_id:l},preserveScroll:!0,onSuccess:()=>{w.value-=1,$.value.length===1&&_.value>1?J(_.value-1):U(_.value,V.value)},onError:g=>{console.error("Error removing votante:",g),alert("Error al remover votante")}})},$e=l=>{I.value=!1,re(),B.get(`/admin/imports/${l}`)},Se=()=>{I.value=!1};return N(()=>m.votacion,l=>{if(l){const e=O();t.titulo=e.titulo,t.descripcion=e.descripcion,t.categoria_id=e.categoria_id,t.fecha_inicio=e.fecha_inicio,t.fecha_fin=e.fecha_fin,t.estado=e.estado,t.resultados_publicos=e.resultados_publicos,t.allow_tokens_download=e.allow_tokens_download,t.fecha_publicacion_resultados=e.fecha_publicacion_resultados,t.formulario_config=e.formulario_config,t.timezone=e.timezone,p.value&&re()}},{immediate:!0,deep:!0}),N(()=>t.resultados_publicos,l=>{console.log("resultados_publicos changed to:",l)},{immediate:!0}),Ae(()=>{}),(l,e)=>(n(),u(S,null,[a(o(Ee),{title:p.value?"Editar Votaci√≥n":"Nueva Votaci√≥n"},null,8,["title"]),a(Pe,{breadcrumbs:P},{default:i(()=>{var g;return[r("div",oo,[r("div",to,[r("div",null,[r("h1",ao,c(p.value?"Editar Votaci√≥n":"Nueva Votaci√≥n"),1),r("p",so,c(p.value?"Modifica los datos de la votaci√≥n":"Crea una nueva votaci√≥n paso a paso"),1)])]),r("div",io,[a(o(A),{class:"border-0 shadow-none h-full"},{default:i(()=>[a(o(E),{class:"p-6"},{default:i(()=>[a(o(Be),{modelValue:k.value,"onUpdate:modelValue":e[23]||(e[23]=s=>k.value=s),class:"w-full"},{default:i(()=>[a(o(Fe),{class:"grid w-full grid-cols-3"},{default:i(()=>[a(o(K),{value:"basicos"},{default:i(()=>[...e[25]||(e[25]=[r("span",{class:"flex items-center gap-2"},[r("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"1"),d(" Datos B√°sicos ")],-1)])]),_:1}),a(o(K),{value:"formulario",disabled:!p.value&&!z.value},{default:i(()=>[...e[26]||(e[26]=[r("span",{class:"flex items-center gap-2"},[r("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"2"),d(" Formulario ")],-1)])]),_:1},8,["disabled"]),a(o(K),{value:"votantes",disabled:!p.value},{default:i(()=>[...e[27]||(e[27]=[r("span",{class:"flex items-center gap-2"},[r("span",{class:"rounded-full bg-primary text-primary-foreground w-5 h-5 text-xs flex items-center justify-center"},"3"),d(" Votantes ")],-1)])]),_:1},8,["disabled"])]),_:1}),a(o(Y),{value:"basicos",class:"space-y-6"},{default:i(()=>[r("div",lo,[r("div",ro,[r("div",null,[a(o(b),{for:"titulo"},{default:i(()=>[...e[28]||(e[28]=[d("T√≠tulo *",-1)])]),_:1}),a(o(me),{id:"titulo",modelValue:o(t).titulo,"onUpdate:modelValue":e[0]||(e[0]=s=>o(t).titulo=s),placeholder:"Nombre de la votaci√≥n",error:o(t).errors.titulo},null,8,["modelValue","error"]),o(t).errors.titulo?(n(),u("p",no,c(o(t).errors.titulo),1)):f("",!0)]),r("div",null,[a(o(b),{for:"descripcion"},{default:i(()=>[...e[29]||(e[29]=[d("Descripci√≥n",-1)])]),_:1}),a(o(fe),{id:"descripcion",modelValue:o(t).descripcion,"onUpdate:modelValue":e[1]||(e[1]=s=>o(t).descripcion=s),placeholder:"Descripci√≥n detallada de la votaci√≥n",rows:"4"},null,8,["modelValue"]),o(t).errors.descripcion?(n(),u("p",uo,c(o(t).errors.descripcion),1)):f("",!0)]),r("div",null,[a(o(b),{for:"categoria"},{default:i(()=>[...e[30]||(e[30]=[d("Categor√≠a *",-1)])]),_:1}),a(o(ee),{modelValue:o(t).categoria_id,"onUpdate:modelValue":e[2]||(e[2]=s=>o(t).categoria_id=s)},{default:i(()=>[a(o(oe),null,{default:i(()=>[a(o(te),{placeholder:"Seleccionar categor√≠a"})]),_:1}),a(o(ae),null,{default:i(()=>[(n(!0),u(S,null,F(v.categorias,s=>(n(),h(o(se),{key:s.id,value:s.id.toString()},{default:i(()=>[d(c(s.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),o(t).errors.categoria_id?(n(),u("p",co,c(o(t).errors.categoria_id),1)):f("",!0)]),a(Le,{modelValue:ie.value,"onUpdate:modelValue":e[3]||(e[3]=s=>ie.value=s)},null,8,["modelValue"])]),r("div",mo,[r("div",null,[a(o(b),{for:"fecha_inicio"},{default:i(()=>[...e[31]||(e[31]=[d("Fecha y Hora de Inicio *",-1)])]),_:1}),a(o(R),{modelValue:o(t).fecha_inicio,"onUpdate:modelValue":e[4]||(e[4]=s=>o(t).fecha_inicio=s),placeholder:"Seleccionar fecha y hora de inicio"},null,8,["modelValue"]),o(t).errors.fecha_inicio?(n(),u("p",fo,c(o(t).errors.fecha_inicio),1)):f("",!0)]),r("div",null,[a(o(b),{for:"fecha_fin"},{default:i(()=>[...e[32]||(e[32]=[d("Fecha y Hora de Fin *",-1)])]),_:1}),a(o(R),{modelValue:o(t).fecha_fin,"onUpdate:modelValue":e[5]||(e[5]=s=>o(t).fecha_fin=s),placeholder:"Seleccionar fecha y hora de fin"},null,8,["modelValue"]),le.value?(n(),u("p",po,c(le.value),1)):f("",!0),o(t).errors.fecha_fin?(n(),u("p",vo,c(o(t).errors.fecha_fin),1)):f("",!0)]),r("div",null,[a(o(b),{for:"estado"},{default:i(()=>[...e[33]||(e[33]=[d("Estado",-1)])]),_:1}),a(o(ee),{modelValue:o(t).estado,"onUpdate:modelValue":e[6]||(e[6]=s=>o(t).estado=s)},{default:i(()=>[a(o(oe),null,{default:i(()=>[a(o(te))]),_:1}),a(o(ae),null,{default:i(()=>[(n(),u(S,null,F(be,s=>a(o(se),{key:s.value,value:s.value},{default:i(()=>[d(c(s.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),a(eo,{modelValue:o(t).timezone,"onUpdate:modelValue":e[7]||(e[7]=s=>o(t).timezone=s),required:"",error:o(t).errors.timezone},null,8,["modelValue","error"]),r("div",_o,[a(o(ce),{id:"resultados_publicos",checked:o(t).resultados_publicos,"onUpdate:checked":e[8]||(e[8]=s=>o(t).resultados_publicos=s)},null,8,["checked"]),a(o(b),{for:"resultados_publicos"},{default:i(()=>[...e[34]||(e[34]=[d(" Resultados p√∫blicos ",-1)])]),_:1})]),a(ze,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:i(()=>[o(t).resultados_publicos?(n(),u("div",go,[a(o(b),{for:"fecha_publicacion_resultados"},{default:i(()=>[...e[35]||(e[35]=[d(" Fecha de publicaci√≥n de resultados (opcional) ",-1)])]),_:1}),a(o(R),{id:"fecha_publicacion_resultados",modelValue:o(t).fecha_publicacion_resultados,"onUpdate:modelValue":e[9]||(e[9]=s=>o(t).fecha_publicacion_resultados=s),placeholder:"Dejar vac√≠o para publicar al finalizar la votaci√≥n"},null,8,["modelValue"]),e[37]||(e[37]=r("p",{class:"text-xs text-muted-foreground"}," Si se especifica una fecha, los resultados ser√°n visibles desde esa fecha. Si se deja vac√≠o, los resultados solo ser√°n visibles despu√©s de que termine la votaci√≥n. ",-1)),r("div",xo,[a(o(ce),{id:"allow_tokens_download",checked:o(t).allow_tokens_download,"onUpdate:checked":e[10]||(e[10]=s=>o(t).allow_tokens_download=s)},null,8,["checked"]),a(o(b),{for:"allow_tokens_download"},{default:i(()=>[...e[36]||(e[36]=[d(" Permitir descarga de tokens en CSV ",-1)])]),_:1})]),e[38]||(e[38]=r("p",{class:"text-xs text-muted-foreground ml-6"}," Permite a los usuarios descargar todos los tokens de verificaci√≥n en formato CSV para an√°lisis externos. ",-1))])):f("",!0)]),_:1}),r("div",null,[a(o(b),{for:"limite_censo"},{default:i(()=>[...e[39]||(e[39]=[d("L√≠mite del Censo (opcional)",-1)])]),_:1}),a(o(R),{id:"limite_censo",modelValue:o(t).limite_censo,"onUpdate:modelValue":e[11]||(e[11]=s=>o(t).limite_censo=s),placeholder:"Seleccionar fecha l√≠mite del censo"},null,8,["modelValue"]),e[40]||(e[40]=r("p",{class:"text-xs text-muted-foreground"}," Fecha de referencia para determinar disponibilidad de la votaci√≥n seg√∫n criterios externos como fecha de inscripci√≥n. ",-1)),o(t).errors.limite_censo?(n(),u("p",bo,c(o(t).errors.limite_censo),1)):f("",!0)]),o(t).limite_censo?(n(),u("div",yo,[a(o(b),{for:"mensaje_limite_censo"},{default:i(()=>[...e[41]||(e[41]=[d(" Mensaje de notificaci√≥n sobre l√≠mite de censo (opcional) ",-1)])]),_:1}),a(o(fe),{id:"mensaje_limite_censo",modelValue:o(t).mensaje_limite_censo,"onUpdate:modelValue":e[12]||(e[12]=s=>o(t).mensaje_limite_censo=s),placeholder:"Mensaje a mostrar cuando un usuario no cumple con el l√≠mite del censo",rows:"3",class:"mt-1"},null,8,["modelValue"]),e[42]||(e[42]=r("p",{class:"text-xs text-muted-foreground mt-1"}," Este mensaje se mostrar√° si un usuario intenta registrarse pero su fecha de inscripci√≥n es posterior al l√≠mite del censo configurado. ",-1)),o(t).errors.mensaje_limite_censo?(n(),u("p",ho,c(o(t).errors.mensaje_limite_censo),1)):f("",!0)])):f("",!0)])]),r("div",Vo,[e[44]||(e[44]=r("div",null,null,-1)),r("div",ko,[p.value?(n(),h(o(x),{key:0,onClick:Z,disabled:o(t).processing||!z.value,variant:"default"},{default:i(()=>[d(c(o(t).processing?"Actualizando...":"Actualizar Votaci√≥n"),1)]),_:1},8,["disabled"])):f("",!0),a(o(x),{onClick:e[13]||(e[13]=s=>k.value="formulario"),disabled:!z.value,variant:"outline"},{default:i(()=>[...e[43]||(e[43]=[d(" Siguiente: Configurar Formulario ",-1)])]),_:1},8,["disabled"])])])]),_:1}),a(o(Y),{value:"formulario",class:"space-y-6"},{default:i(()=>{var s;return[a(qe,{modelValue:o(t).formulario_config,"onUpdate:modelValue":e[14]||(e[14]=C=>o(t).formulario_config=C),title:"Constructor de Formulario",description:"Agrega los campos que aparecer√°n en la votaci√≥n","show-perfil-candidatura-config":!0,"show-convocatoria-config":!0,cargos:((s=m.cargos)==null?void 0:s.filter(C=>C.es_cargo))||[],"periodos-electorales":m.periodosElectorales||[],convocatorias:m.convocatorias||[],context:"votacion"},null,8,["modelValue","cargos","periodos-electorales","convocatorias"]),r("div",wo,[a(o(x),{variant:"outline",onClick:e[15]||(e[15]=C=>k.value="basicos")},{default:i(()=>[...e[45]||(e[45]=[d(" Anterior ",-1)])]),_:1}),r("div",Co,[G.value&&m.canManageVoters?(n(),h(o(x),{key:0,variant:"outline",onClick:e[16]||(e[16]=C=>k.value="votantes"),disabled:o(t).formulario_config.length===0},{default:i(()=>[...e[46]||(e[46]=[d(" Siguiente: Gestionar Votantes ",-1)])]),_:1},8,["disabled"])):f("",!0),a(o(x),{onClick:Z,disabled:o(t).processing||o(t).formulario_config.length===0},{default:i(()=>[d(c(o(t).processing?"Guardando...":p.value?"Actualizar":"Crear")+" Votaci√≥n ",1)]),_:1},8,["disabled"])])])]}),_:1}),a(o(Y),{value:"votantes",class:"space-y-6"},{default:i(()=>[e[65]||(e[65]=r("div",null,[r("h3",{class:"text-lg font-semibold"},"Gesti√≥n de Votantes"),r("p",{class:"text-sm text-muted-foreground"}," Asigna los usuarios que podr√°n participar en esta votaci√≥n ")],-1)),m.canManageVoters?f("",!0):(n(),h(o(A),{key:0,class:"border-yellow-200 bg-yellow-50"},{default:i(()=>[a(o(E),{class:"pt-6"},{default:i(()=>[r("div",$o,[a(o(He),{class:"h-5 w-5"}),e[47]||(e[47]=r("p",{class:"font-semibold"},"Sin permisos para manejar censo electoral",-1))]),e[48]||(e[48]=r("p",{class:"mt-2 text-sm text-gray-600"}," No tienes los permisos necesarios para gestionar el censo electoral de esta votaci√≥n. Contacta a un administrador si necesitas acceso a esta funcionalidad. ",-1))]),_:1})]),_:1})),m.canManageVoters?(n(),u(S,{key:1},[I.value?f("",!0):(n(),h(o(A),{key:0},{default:i(()=>[a(o(T),null,{default:i(()=>[a(o(H),{class:"flex items-center gap-2"},{default:i(()=>[a(o(pe),{class:"h-5 w-5"}),e[49]||(e[49]=d(" Importar Votantes ",-1))]),_:1})]),_:1}),a(o(E),null,{default:i(()=>[r("div",So,[e[51]||(e[51]=r("p",{class:"text-sm text-muted-foreground"}," Importa votantes desde un archivo CSV con mapeo din√°mico de campos. Los usuarios importados ser√°n asignados autom√°ticamente a esta votaci√≥n. ",-1)),e[52]||(e[52]=r("p",{class:"text-sm text-blue-600"},[r("a",{href:"/ejemplo-usuarios.csv",download:"",class:"underline"}," üì• Descargar plantilla CSV de ejemplo ")],-1)),a(o(x),{variant:"outline",onClick:e[17]||(e[17]=s=>I.value=!0)},{default:i(()=>[a(o(pe),{class:"mr-2 h-4 w-4"}),e[50]||(e[50]=d(" Iniciar Importaci√≥n ",-1))]),_:1})])]),_:1})]),_:1})),I.value&&p.value&&v.votacion?(n(),h(Me,{key:1,mode:"votacion","votacion-id":v.votacion.id,"votacion-titulo":v.votacion.titulo,"redirect-on-success":!1,onSuccess:$e,onCancel:Se},null,8,["votacion-id","votacion-titulo"])):f("",!0),p.value?(n(),h(o(A),{key:2},{default:i(()=>[a(o(T),null,{default:i(()=>[a(o(H),{class:"flex items-center gap-2"},{default:i(()=>[a(o(ve),{class:"h-5 w-5"}),e[53]||(e[53]=d(" Agregar Votantes ",-1))]),_:1})]),_:1}),a(o(E),null,{default:i(()=>[a(o(x),{onClick:e[18]||(e[18]=s=>D.value=!0),class:"w-full",variant:"outline"},{default:i(()=>[a(o(ve),{class:"h-4 w-4 mr-2"}),e[54]||(e[54]=d(" Buscar y A√±adir Votantes ",-1))]),_:1}),e[55]||(e[55]=r("p",{class:"text-sm text-muted-foreground mt-2"}," Busca usuarios por nombre, email, documento o tel√©fono ",-1))]),_:1})]),_:1})):f("",!0),p.value?(n(),h(o(A),{key:3},{default:i(()=>[a(o(T),null,{default:i(()=>[a(o(H),{class:"flex items-center justify-between"},{default:i(()=>[r("span",jo,[a(o(_e),{class:"h-5 w-5"}),e[56]||(e[56]=d(" Historial de Importaciones ",-1))]),L.value.length>0?(n(),h(o(x),{key:0,variant:"outline",size:"sm",onClick:he},{default:i(()=>[...e[57]||(e[57]=[d(" Ver Todas ",-1)])]),_:1})):f("",!0)]),_:1})]),_:1}),a(o(E),null,{default:i(()=>[L.value.length===0?(n(),u("div",Ao,[a(o(_e),{class:"mx-auto h-8 w-8 mb-2"}),e[58]||(e[58]=r("p",null,"No hay importaciones registradas",-1)),e[59]||(e[59]=r("p",{class:"text-sm"},"Las importaciones aparecer√°n aqu√≠ una vez que subas archivos CSV",-1))])):(n(),u("div",Eo,[(n(!0),u(S,null,F(L.value,s=>(n(),u("div",{key:s.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:C=>ye(s.id)},[r("div",Io,[(n(),h(Ie(q(s.status).icon),{class:ue(["h-4 w-4",q(s.status).class])},null,8,["class"])),r("div",null,[r("p",Uo,c(s.original_filename),1),r("p",Bo," Por "+c(s.created_by.name)+" ‚Ä¢ "+c(Ve(s.created_at)),1)])]),r("div",Fo,[a(o(Ue),{variant:"outline",class:ue(q(s.status).class)},{default:i(()=>[d(c(q(s.status).label),1)]),_:2},1032,["class"]),s.status==="completed"?(n(),u("div",Po,[d(c(s.successful_rows)+" exitosos ",1),s.failed_rows>0?(n(),u("span",Do,", "+c(s.failed_rows)+" errores",1)):f("",!0)])):s.status==="processing"?(n(),u("div",Lo,c(s.progress_percentage)+"% ",1)):f("",!0)])],8,zo))),128))]))]),_:1})]),_:1})):f("",!0),a(o(A),null,{default:i(()=>[a(o(T),null,{default:i(()=>[a(o(H),null,{default:i(()=>[d("Votantes Asignados ("+c(w.value)+")",1)]),_:1})]),_:1}),a(o(E),{class:"space-y-4"},{default:i(()=>[r("div",qo,[a(o(Re),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a(o(me),{modelValue:V.value,"onUpdate:modelValue":e[19]||(e[19]=s=>V.value=s),type:"text",placeholder:"Buscar por nombre, email, documento o tel√©fono...",class:"pl-10"},null,8,["modelValue"])]),W.value?(n(),u("div",Mo,[a(o(Ge),{class:"h-8 w-8 animate-spin text-muted-foreground"}),e[60]||(e[60]=r("span",{class:"ml-2 text-muted-foreground"},"Cargando votantes...",-1))])):$.value.length===0?(n(),u("div",No,[V.value?(n(),u("p",To,'No se encontraron votantes que coincidan con "'+c(V.value)+'"',1)):(n(),u("p",Ho,"No hay votantes asignados a esta votaci√≥n")),e[61]||(e[61]=r("p",{class:"text-sm"},"Importa un archivo CSV o agrega votantes manualmente",-1))])):(n(),u("div",Ro,[r("div",Go,[(n(!0),u(S,null,F($.value,s=>(n(),u("div",{key:s.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"},[r("div",Oo,[r("p",Zo,c(s.name),1),r("div",Qo,[r("span",Wo,c(s.email),1),s.documento_identidad?(n(),u("span",Xo,"Doc: "+c(s.documento_identidad),1)):f("",!0),s.telefono?(n(),u("span",Jo,"Tel: "+c(s.telefono),1)):f("",!0)])]),a(o(x),{variant:"ghost",size:"sm",onClick:C=>Ce(s.id)},{default:i(()=>[a(o(Oe),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick"])]))),128))]),X.value>1?(n(),u("div",Ko,[r("div",Yo," Mostrando "+c((_.value-1)*Q.value+1)+" - "+c(Math.min(_.value*Q.value,w.value))+" de "+c(w.value)+" votantes ",1),r("div",et,[a(o(x),{variant:"outline",size:"sm",disabled:_.value===1,onClick:e[20]||(e[20]=s=>J(_.value-1))},{default:i(()=>[a(o(Ze),{class:"h-4 w-4"}),e[62]||(e[62]=d(" Anterior ",-1))]),_:1},8,["disabled"]),a(o(x),{variant:"outline",size:"sm",disabled:_.value===X.value,onClick:e[21]||(e[21]=s=>J(_.value+1))},{default:i(()=>[e[63]||(e[63]=d(" Siguiente ",-1)),a(o(Qe),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])):f("",!0)]))]),_:1})]),_:1}),r("div",ot,[a(o(x),{variant:"outline",onClick:e[22]||(e[22]=s=>k.value="formulario")},{default:i(()=>[...e[64]||(e[64]=[d(" Anterior ",-1)])]),_:1}),a(o(x),{onClick:Z,disabled:o(t).processing},{default:i(()=>[d(c(o(t).processing?"Guardando...":"Actualizar")+" Votaci√≥n ",1)]),_:1},8,["disabled"])])],64)):f("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),a(Ne,{modelValue:D.value,"onUpdate:modelValue":e[24]||(e[24]=s=>D.value=s),title:"A√±adir Votantes",description:"Selecciona los usuarios que deseas a√±adir como votantes de esta votaci√≥n","search-endpoint":`/admin/votaciones/${(g=m.votacion)==null?void 0:g.id}/search-users`,"search-placeholder":"Buscar por nombre, email, documento o tel√©fono...","submit-button-text":"A√±adir Votantes","empty-message":"Escribe para buscar usuarios disponibles","no-results-message":"No se encontraron usuarios con esa b√∫squeda",onSubmit:we},null,8,["modelValue","search-endpoint"])]}),_:1})],64))}});export{Ca as default};
