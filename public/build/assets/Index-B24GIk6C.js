import{_ as y}from"./index-Ca9vCh23.js";import{_ as h}from"./createLucideIcon-BxKKonsI.js";import{_ as Y,c as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-FpzMwRGj.js";import{_ as X}from"./Switch.vue_vue_type_script_setup_true_lang-CKyUjNUV.js";import{_ as Z,a as ee,b as $,c as b,d as te,e as g}from"./TableHeader.vue_vue_type_script_setup_true_lang-Cv2H5uW_.js";import{_ as se}from"./UserLayout.vue_vue_type_script_setup_true_lang-Ce6E6opB.js";import{d as ae,k as z,c as M,a as w,o as l,b as a,u as t,m as ie,e as i,f as r,i as v,g as n,n as x,j as m,t as p,F as S,r as N,l as re,W as C}from"./app-CZVAIQ2j.js";import{_ as oe}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-Bg-AmfBj.js";import{e as D,C as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-4aMsC9XF.js";import{V as le}from"./vote-BbAZHbdL.js";import{C as L}from"./clock-p5N4RGrV.js";import{C as A}from"./circle-check-big-CvJj3mOa.js";import{C as ne}from"./chart-column-Ti_zUSSU.js";import{C as T}from"./circle-alert-UNJr2893.js";import"./index-D3qaEgis.js";import"./VisuallyHidden-r3WkqmHs.js";import"./Input.vue_vue_type_script_setup_true_lang-DUqjSIWB.js";import"./PopperContent-B74AR3_x.js";import"./floating-ui.vue-ChS3Pls3.js";import"./VisuallyHiddenInput-D0N4NXKw.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-Dtm1UlW3.js";import"./index-CGt0dgIA.js";import"./x-lxNEdBJ-.js";import"./shield-CutgDwZP.js";import"./user-COzEv5xc.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B5FKbIli.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CQ7UCZ-F.js";import"./Label.vue_vue_type_script_setup_true_lang-B8ojZqIO.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Bo1dE-Lv.js";import"./index-GrVQiRvY.js";import"./map-pin-JV2Idhmv.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CE_qzYXH.js";import"./square-check-big-DxvCxcI_.js";import"./file-text-1p13N2Vy.js";import"./users-C-BhDct3.js";import"./index-C4IMxQzW.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-BCccZNs6.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-CY_82c1_.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-CbIXV-QY.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-B4lD7kF0.js";import"./chevron-left-B3-1fvDR.js";import"./es-BRx6Co7f.js";import"./calendar-DplaDJ7W.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-DL3jfgsf.js";import"./loader-circle-uyPXCWhW.js";import"./trash-2-B7VXvzqJ.js";import"./plus-B8VIWw35.js";import"./search-gmIcLyxX.js";import"./check-mlGdLtMP.js";import"./history-v_xHgxH7.js";import"./save-BTina3Vh.js";import"./nullish-CHIgUVhi.js";const de={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ue={class:"flex items-center gap-4 mb-4"},me={class:"flex items-center space-x-2"},ce={class:"relative min-h-[50vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},fe={class:"rounded-md border"},pe={class:"flex items-center gap-1"},_e={class:"flex flex-col"},ve={class:"flex items-center gap-1"},xe={class:"flex flex-col"},ge={class:"flex items-center gap-1"},he={class:"flex flex-col"},be={class:"flex items-center gap-2 mb-1"},ye={class:"font-medium"},we={key:0,class:"text-sm text-muted-foreground"},Ce={class:"text-sm"},ke={class:"text-sm"},Ve={class:"flex items-center gap-2"},$e={class:"flex justify-end gap-2"},ze={key:0,class:"flex items-center justify-between mt-4"},Se={class:"text-sm text-muted-foreground"},De={class:"flex gap-2"},St=ae({__name:"Index",props:{votaciones:{},categorias:{},filters:{},mostrar_pasadas:{type:Boolean},filterFieldsConfig:{},canVote:{type:Boolean},canViewResults:{type:Boolean},canViewOwnVote:{type:Boolean}},setup(P){const d=P,j=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Votaciones",href:"/miembro/votaciones"}],k=z(d.mostrar_pasadas||!1),{route:E}=window,q=M(()=>({quickSearch:d.filters.search||"",rootGroup:d.filters.advanced_filters?JSON.parse(d.filters.advanced_filters):void 0})),R={fields:d.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por título o descripción...",quickSearchFields:["titulo","descripcion"],maxNestingLevel:2,allowSaveFilters:!0,debounceTime:500,autoApply:!1},c=z("fecha_inicio"),f=z("asc"),V=o=>{c.value===o?f.value=f.value==="asc"?"desc":"asc":(c.value=o,f.value="asc")},H=M(()=>[...d.votaciones.data].sort((s,e)=>{let u,_;switch(c.value){case"fecha_inicio":u=new Date(s.fecha_inicio),_=new Date(e.fecha_inicio);break;case"fecha_fin":u=new Date(s.fecha_fin),_=new Date(e.fecha_fin);break;case"titulo":u=s.titulo.toLowerCase(),_=e.titulo.toLowerCase();break;default:u=s[c.value],_=e[c.value]}return u<_?f.value==="asc"?-1:1:u>_?f.value==="asc"?1:-1:0})),I=()=>{C.get("/miembro/votaciones",{...d.filters,mostrar_pasadas:k.value||void 0},{preserveState:!0,replace:!0})},O=o=>{C.get(`/miembro/votaciones/${o}/votar`)},U=o=>{C.get(`/miembro/votaciones/${o}/mi-voto`)},W=o=>{C.get(`/miembro/votaciones/${o}/resultados`)},G=o=>o.ya_voto?A:o.ha_finalizado?T:L,J=o=>o.ya_voto?"default":o.ha_finalizado?"destructive":"secondary",Q=o=>o.ya_voto?o.ha_finalizado?"Voté (Finalizada)":"Ya voté":o.ha_finalizado?"Expirada":"Disponible",B=o=>new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(o,s)=>(l(),w(S,null,[a(t(ie),{title:"Mis Votaciones"}),a(se,{breadcrumbs:j},{default:i(()=>[r("div",de,[s[19]||(s[19]=r("div",{class:"flex items-center justify-between"},[r("div",null,[r("h1",{class:"text-3xl font-bold"},"Mis Votaciones"),r("p",{class:"text-muted-foreground"}," Votaciones disponibles para mi participación ")])],-1)),r("div",ue,[a(oe,{config:R,route:t(E)("user.votaciones.index"),"initial-filters":q.value,class:"flex-1"},null,8,["route","initial-filters"]),r("div",me,[a(t(X),{id:"mostrar-pasadas",modelValue:k.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>k.value=e),I]},null,8,["modelValue"]),s[4]||(s[4]=r("label",{for:"mostrar-pasadas",class:"text-sm font-medium whitespace-nowrap"}," Ver historial ",-1))])]),r("div",ce,[a(t(Y),{class:"border-0 shadow-none h-full"},{default:i(()=>[a(t(K),{class:"pt-6"},{default:i(()=>[r("div",fe,[a(t(Z),null,{default:i(()=>[a(t(ee),null,{default:i(()=>[a(t($),null,{default:i(()=>[a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[1]||(s[1]=e=>V("titulo"))},{default:i(()=>[r("div",pe,[s[5]||(s[5]=n(" Título ",-1)),r("div",_e,[a(t(D),{class:x(["h-3 w-3",{"text-primary":c.value==="titulo"&&f.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":c.value==="titulo"&&f.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:i(()=>[...s[6]||(s[6]=[n("Categoría",-1)])]),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[2]||(s[2]=e=>V("fecha_inicio"))},{default:i(()=>[r("div",ve,[s[7]||(s[7]=n(" Fecha de Apertura ",-1)),r("div",xe,[a(t(D),{class:x(["h-3 w-3",{"text-primary":c.value==="fecha_inicio"&&f.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":c.value==="fecha_inicio"&&f.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[3]||(s[3]=e=>V("fecha_fin"))},{default:i(()=>[r("div",ge,[s[8]||(s[8]=n(" Fecha Límite ",-1)),r("div",he,[a(t(D),{class:x(["h-3 w-3",{"text-primary":c.value==="fecha_fin"&&f.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":c.value==="fecha_fin"&&f.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:i(()=>[...s[9]||(s[9]=[n("Mi Estado",-1)])]),_:1}),a(t(b),{class:"text-right"},{default:i(()=>[...s[10]||(s[10]=[n("Acción",-1)])]),_:1})]),_:1})]),_:1}),a(t(te),null,{default:i(()=>[d.votaciones.data.length===0?(l(),m(t($),{key:0},{default:i(()=>[a(t(g),{colspan:6,class:"text-center py-8 text-muted-foreground"},{default:i(()=>[n(p(k.value?"No tienes historial de votaciones":"No tienes votaciones disponibles en este momento"),1)]),_:1})]),_:1})):v("",!0),(l(!0),w(S,null,N(H.value,e=>(l(),m(t($),{key:e.id,class:x({"opacity-75":e.ha_finalizado,"bg-green-50/50 dark:bg-green-950/10":e.ya_voto&&!e.ha_finalizado,"bg-blue-50/50 dark:bg-blue-950/10":e.puede_votar})},{default:i(()=>[a(t(g),null,{default:i(()=>{var u,_;return[r("div",null,[r("div",be,[r("p",ye,p(e.titulo),1),e.estado_visual==="finalizada"?(l(),m(t(y),{key:0,variant:"secondary",class:"text-xs"},{default:i(()=>[...s[11]||(s[11]=[n(" Finalizada ",-1)])]),_:1})):e.estado_visual==="activa"?(l(),m(t(y),{key:1,variant:"default",class:"text-xs"},{default:i(()=>[...s[12]||(s[12]=[n(" Activa ",-1)])]),_:1})):e.estado_visual==="pendiente"?(l(),m(t(y),{key:2,variant:"outline",class:"text-xs"},{default:i(()=>[...s[13]||(s[13]=[n(" Pendiente ",-1)])]),_:1})):v("",!0)]),e.descripcion?(l(),w("p",we,p((u=e.descripcion)==null?void 0:u.substring(0,80))+p(((_=e.descripcion)==null?void 0:_.length)>80?"...":""),1)):v("",!0)])]}),_:2},1024),a(t(g),null,{default:i(()=>[a(t(y),{variant:"outline"},{default:i(()=>[n(p(e.categoria.nombre),1)]),_:2},1024)]),_:2},1024),a(t(g),null,{default:i(()=>[r("div",Ce,p(B(e.fecha_inicio)),1)]),_:2},1024),a(t(g),null,{default:i(()=>[r("div",ke,p(B(e.fecha_fin)),1)]),_:2},1024),a(t(g),null,{default:i(()=>[r("div",Ve,[(l(),m(re(G(e)),{class:x(["h-4 w-4",{"text-green-600":e.ya_voto,"text-orange-600":e.puede_votar,"text-red-600":!e.puede_votar&&!e.ya_voto}])},null,8,["class"])),a(t(y),{variant:J(e)},{default:i(()=>[n(p(Q(e)),1)]),_:2},1032,["variant"])])]),_:2},1024),a(t(g),{class:"text-right"},{default:i(()=>[r("div",$e,[e.puede_votar?(l(),m(t(h),{key:0,onClick:u=>O(e.id),size:"sm"},{default:i(()=>[a(t(le),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=n(" Votar ",-1))]),_:2},1032,["onClick"])):v("",!0),e.estado_visual==="pendiente"?(l(),m(t(h),{key:1,variant:"outline",size:"sm",disabled:"",class:"cursor-not-allowed"},{default:i(()=>[a(t(L),{class:"mr-2 h-4 w-4"}),s[15]||(s[15]=n(" Próximamente ",-1))]),_:1})):v("",!0),e.puede_ver_voto?(l(),m(t(h),{key:2,onClick:u=>U(e.id),variant:"outline",size:"sm"},{default:i(()=>[a(t(A),{class:"mr-2 h-4 w-4"}),s[16]||(s[16]=n(" Ver mi voto ",-1))]),_:2},1032,["onClick"])):v("",!0),e.resultados_visibles?(l(),m(t(h),{key:3,onClick:u=>W(e.id),variant:"default",size:"sm",class:"bg-blue-600 hover:bg-blue-700 text-white"},{default:i(()=>[a(t(ne),{class:"mr-2 h-4 w-4"}),s[17]||(s[17]=n(" Ver Resultados ",-1))]),_:2},1032,["onClick"])):v("",!0),e.ha_finalizado&&!e.ya_voto?(l(),m(t(h),{key:4,variant:"outline",size:"sm",disabled:""},{default:i(()=>[a(t(T),{class:"mr-2 h-4 w-4"}),s[18]||(s[18]=n(" No participé ",-1))]),_:1})):v("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),d.votaciones.last_page>1?(l(),w("div",ze,[r("p",Se," Mostrando "+p((d.votaciones.current_page-1)*d.votaciones.per_page+1)+" a "+p(Math.min(d.votaciones.current_page*d.votaciones.per_page,d.votaciones.total))+" de "+p(d.votaciones.total)+" resultados ",1),r("div",De,[(l(!0),w(S,null,N(d.votaciones.links,e=>(l(),m(t(h),{key:e.label,variant:e.active?"default":"outline",disabled:!e.url,size:"sm",onClick:u=>e.url&&t(C).get(e.url),innerHTML:e.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):v("",!0)]),_:1})]),_:1})])])]),_:1})],64))}});export{St as default};
