import{_ as Q}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DTy3l80b.js";import{d as J,r as V,c as L,b as v,e as n,w as r,f as a,u as o,g as s,j as y,h as u,t as l,i as f,F as N,k as I,n as B,q as K,s as Y,W as M,p as Z,P as T}from"./app-CNcf-zdV.js";import{a as k,b as $,c as C,_ as E}from"./CardTitle.vue_vue_type_script_setup_true_lang-DhL5ChM3.js";import{_ as x}from"./createLucideIcon-DgLLtpTc.js";import{_ as P}from"./index-s_YMJFqv.js";import{_ as ee}from"./Progress.vue_vue_type_script_setup_true_lang-CIVpzJ8O.js";import{t as R}from"./index-UZehIf0x.js";import{E as te}from"./EtiquetaDisplay-BrbaTZWq.js";import{E as se}from"./EtiquetaSelector-B0vTWatm.js";import{_ as oe}from"./CardDescription.vue_vue_type_script_setup_true_lang-C68I3fFy.js";import{_ as ae,a as re}from"./ScrollArea.vue_vue_type_script_setup_true_lang-BXUGztSw.js";import{C as ie}from"./chevron-left-CxQtTkVA.js";import{C as U}from"./calendar-DAAYlVnm.js";import{C as ne}from"./chevron-right-CoIj8tGl.js";import{F as O}from"./file-text-VjUXoo3d.js";import{C as le}from"./circle-x-Dhjrtdk5.js";import{C as W}from"./circle-check-big-CiofKZcV.js";import{C as de}from"./circle-DT2yxC1F.js";import{S as H}from"./square-pen-Def0jsxb.js";import{T as ce}from"./trash-2-BaR4XxZx.js";import{F as ue}from"./zap-B3vRugs_.js";import{C as me}from"./clock-Bv_E-7na.js";import{a as fe,T as pe}from"./target-Bzh15SE9.js";import{P as X}from"./plus-B0xw1qKM.js";import{U as G}from"./user-DzTPpMzP.js";import{B as ye,C as ge}from"./circle-pause-w8dqj3kE.js";import{C as ve}from"./circle-play-CqHcPDjI.js";import{C as _e}from"./circle-alert-BWYDLxj9.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-D8koaehi.js";import"./index-C53AKuaZ.js";import"./floating-ui.vue-g3wBdaGy.js";import"./x-arLKReWz.js";import"./Input.vue_vue_type_script_setup_true_lang-CXr4ucc6.js";import"./index-BfcJxwg-.js";import"./index-DoUjDw3v.js";import"./shield-Ds2U7D9u.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BBJrNP3L.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CS3Y7RjP.js";import"./VisuallyHidden-BMJ7uEAj.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-Bt0xndJV.js";import"./check-N9bkD0I5.js";import"./nullish-CHIgUVhi.js";import"./Label.vue_vue_type_script_setup_true_lang-BFduy937.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-D-RM_gVc.js";import"./map-pin-CODmF8A6.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-CPZLV3U1.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CQwxGvmo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-Co9lmALi.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Bowse19S.js";import"./users-BCniY5Uo.js";import"./vote-DWrrItDX.js";import"./folder-open-Bl1zn-Xz.js";import"./send-Cs3Svvwv.js";import"./briefcase-BxQurTMk.js";import"./megaphone-DSquqsX_.js";import"./user-check-t0y4Vuir.js";import"./mail-CzyXkW1x.js";import"./message-square-vVP8zyj_.js";import"./external-link-DknYr06I.js";import"./panel-left-C37rxO5h.js";import"./index-DraxJDKZ.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-CxYPgAQ2.js";import"./trending-up-cr0lmCPe.js";import"./award-Bw1tM6WA.js";import"./hash-PJNBOiW2.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-PuWmj34h.js";import"./RovingFocusItem-KgjJr8lb.js";import"./utils-D1nKU7ku.js";import"./index-wZxNlukw.js";import"./search-DXa90Ror.js";import"./useKbd-kRIii9yh.js";import"./VisuallyHiddenInput-DQv9Xmp3.js";import"./useEtiquetaHierarchy-CJQVQYQg.js";import"./list-CqxvUFHd.js";const he={class:"flex justify-between items-start"},xe={class:"flex items-center gap-2"},be={key:0,class:"grid grid-cols-4 gap-4 mb-6"},we={class:"text-center"},ke={class:"text-2xl font-bold text-green-600"},$e={class:"text-center"},Ce={class:"text-2xl font-bold text-blue-600"},Ee={class:"text-center"},qe={class:"text-2xl font-bold text-gray-600"},De={class:"text-center"},Se={class:"text-2xl font-bold text-red-600"},ze={key:1,class:"space-y-4"},Te={key:0,class:"flex items-center justify-between mb-4"},Pe={class:"flex items-center gap-2"},je={class:"font-medium"},Me={class:"flex gap-2"},Be={class:"space-y-2"},Ve={key:0,class:"absolute left-5 top-8 w-0.5 h-full bg-border"},Fe={class:"relative z-10 flex-shrink-0"},Ae={class:"flex-1 min-w-0"},Ne={class:"flex items-start justify-between gap-4"},Le={class:"font-semibold truncate"},Re={class:"flex items-center gap-4 mt-1 text-sm text-muted-foreground"},Ie={class:"flex items-center gap-1"},Ue={key:0,class:"flex items-center gap-1"},Oe={key:0,class:"text-right"},He={class:"font-semibold"},We={class:"text-xs text-muted-foreground"},Xe={key:0,class:"mt-2"},Ge={class:"w-full bg-muted rounded-full h-2"},Je={key:2,class:"text-center py-8"},Ke=J({__name:"ContratoTimeline",props:{contratos:{},titulo:{},descripcion:{},mostrarMonto:{type:Boolean},compacto:{type:Boolean}},setup(g){const c=g,_=V(new Date),b=V(!1),q=L(()=>({activos:c.contratos.filter(t=>t.estado==="activo").length,finalizados:c.contratos.filter(t=>t.estado==="finalizado").length,borradores:c.contratos.filter(t=>t.estado==="borrador").length,cancelados:c.contratos.filter(t=>t.estado==="cancelado").length})),D=L(()=>[...c.contratos].sort((e,t)=>new Date(e.fecha_inicio).getTime()-new Date(t.fecha_inicio).getTime())),S=L(()=>{if(c.contratos.length===0)return null;const e=c.contratos.flatMap(h=>[new Date(h.fecha_inicio),h.fecha_fin?new Date(h.fecha_fin):new Date(h.fecha_inicio)]),t=new Date(Math.min(...e.map(h=>h.getTime()))),i=new Date(Math.max(...e.map(h=>h.getTime())));return{min:t,max:i}});L(()=>{if(!S.value)return[];const e=[],t=new Date(S.value.min);for(t.setDate(1);t<=S.value.max;)e.push(new Date(t)),t.setMonth(t.getMonth()+1);return e});const F=e=>({borrador:{color:"secondary",icon:O,label:"Borrador"},activo:{color:"success",icon:W,label:"Activo"},finalizado:{color:"default",icon:W,label:"Finalizado"},cancelado:{color:"destructive",icon:le,label:"Cancelado"}})[e]||{color:"default",icon:de,label:e},A=e=>e.toLocaleDateString("es-ES",{month:"long",year:"numeric"}),j=e=>new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"}),z=e=>e.estado!=="activo"||!e.fecha_fin?!1:new Date(e.fecha_fin)<new Date,w=e=>{if(e.estado!=="activo"||!e.fecha_fin)return!1;const t=Math.ceil((new Date(e.fecha_fin).getTime()-new Date().getTime())/(1e3*60*60*24));return t>0&&t<=30},m=()=>{const e=new Date(_.value);e.setMonth(e.getMonth()-1),_.value=e},d=()=>{const e=new Date(_.value);e.setMonth(e.getMonth()+1),_.value=e},p=()=>{_.value=new Date};return(e,t)=>(n(),v(o(E),null,{default:r(()=>[a(o(k),null,{default:r(()=>[s("div",he,[s("div",null,[a(o($),null,{default:r(()=>[u(l(e.titulo||"Timeline de Contratos"),1)]),_:1}),e.descripcion?(n(),v(o(oe),{key:0},{default:r(()=>[u(l(e.descripcion),1)]),_:1})):y("",!0)]),s("div",xe,[a(o(P),{variant:"outline"},{default:r(()=>[u(l(e.contratos.length)+" contratos ",1)]),_:1}),e.compacto?y("",!0):(n(),v(o(x),{key:0,onClick:t[0]||(t[0]=i=>b.value=!b.value),size:"sm",variant:"outline"},{default:r(()=>[u(l(b.value?"Vista compacta":"Vista expandida"),1)]),_:1}))])])]),_:1}),a(o(C),null,{default:r(()=>[e.compacto?y("",!0):(n(),f("div",be,[s("div",we,[s("div",ke,l(q.value.activos),1),t[1]||(t[1]=s("div",{class:"text-xs text-muted-foreground"},"Activos",-1))]),s("div",$e,[s("div",Ce,l(q.value.finalizados),1),t[2]||(t[2]=s("div",{class:"text-xs text-muted-foreground"},"Finalizados",-1))]),s("div",Ee,[s("div",qe,l(q.value.borradores),1),t[3]||(t[3]=s("div",{class:"text-xs text-muted-foreground"},"Borradores",-1))]),s("div",De,[s("div",Se,l(q.value.cancelados),1),t[4]||(t[4]=s("div",{class:"text-xs text-muted-foreground"},"Cancelados",-1))])])),e.contratos.length>0?(n(),f("div",ze,[e.compacto?y("",!0):(n(),f("div",Te,[a(o(x),{onClick:m,size:"sm",variant:"outline"},{default:r(()=>[a(o(ie),{class:"w-4 h-4"})]),_:1}),s("div",Pe,[a(o(U),{class:"w-4 h-4 text-muted-foreground"}),s("span",je,l(A(_.value)),1)]),s("div",Me,[a(o(x),{onClick:p,size:"sm",variant:"outline"},{default:r(()=>[...t[5]||(t[5]=[u(" Hoy ",-1)])]),_:1}),a(o(x),{onClick:d,size:"sm",variant:"outline"},{default:r(()=>[a(o(ne),{class:"w-4 h-4"})]),_:1})])])),a(o(ae),{class:"w-full whitespace-nowrap"},{default:r(()=>[s("div",Be,[(n(!0),f(N,null,I(D.value,(i,h)=>(n(),f("div",{key:i.id,class:"relative flex items-center gap-4 p-3 rounded-lg hover:bg-muted/50 transition-colors"},[h<D.value.length-1?(n(),f("div",Ve)):y("",!0),s("div",Fe,[s("div",{class:B(["w-10 h-10 rounded-full flex items-center justify-center",{"bg-green-100":i.estado==="activo","bg-blue-100":i.estado==="finalizado","bg-gray-100":i.estado==="borrador","bg-red-100":i.estado==="cancelado"}])},[(n(),v(K(F(i.estado).icon),{class:B(["w-5 h-5",{"text-green-600":i.estado==="activo","text-blue-600":i.estado==="finalizado","text-gray-600":i.estado==="borrador","text-red-600":i.estado==="cancelado"}])},null,8,["class"]))],2)]),s("div",Ae,[s("div",Ne,[s("div",null,[s("h4",Le,l(i.nombre),1),s("div",Re,[s("span",Ie,[a(o(U),{class:"w-3 h-3"}),u(" "+l(j(i.fecha_inicio)),1)]),i.fecha_fin?(n(),f("span",Ue," → "+l(j(i.fecha_fin)),1)):y("",!0),z(i)?(n(),v(o(P),{key:1,variant:"destructive",class:"text-xs"},{default:r(()=>[...t[6]||(t[6]=[u(" Vencido ",-1)])]),_:1})):w(i)?(n(),v(o(P),{key:2,variant:"secondary",class:"text-xs"},{default:r(()=>[...t[7]||(t[7]=[u(" Próximo a vencer ",-1)])]),_:1})):y("",!0)])]),e.mostrarMonto&&i.monto_total?(n(),f("div",Oe,[s("div",He," $"+l(i.monto_total.toLocaleString()),1),s("div",We,l(i.moneda||"USD"),1)])):y("",!0)]),i.fecha_fin&&!e.compacto?(n(),f("div",Xe,[s("div",Ge,[s("div",{class:B(["h-2 rounded-full transition-all",{"bg-green-500":i.estado==="activo"&&!z(i),"bg-red-500":z(i),"bg-orange-500":w(i),"bg-blue-500":i.estado==="finalizado","bg-gray-400":i.estado==="cancelado"}]),style:Y({width:`${Math.min(100,Math.max(0,(new Date().getTime()-new Date(i.fecha_inicio).getTime())/(new Date(i.fecha_fin).getTime()-new Date(i.fecha_inicio).getTime())*100))}%`})},null,6)])])):y("",!0)])]))),128))]),a(o(re),{orientation:"horizontal"})]),_:1})])):(n(),f("div",Je,[a(o(O),{class:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),t[8]||(t[8]=s("p",{class:"text-muted-foreground"},"No hay contratos para mostrar",-1))]))]),_:1})]),_:1}))}});function Qe(){const g=V(!1),c=V(null);async function _(m,d){return g.value=!0,c.value=null,new Promise((p,e)=>{M.post(`/admin/proyectos/${m}/etiquetas`,{etiqueta_id:d},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{g.value=!1,p(!0)},onError:t=>{g.value=!1,c.value=Object.values(t).join(", "),e(t)}})})}async function b(m,d){return g.value=!0,c.value=null,new Promise((p,e)=>{M.delete(`/admin/proyectos/${m}/etiquetas/${d}`,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{g.value=!1,p(!0)},onError:t=>{g.value=!1,c.value="Error al quitar la etiqueta",e(t)}})})}async function q(m,d){return g.value=!0,c.value=null,new Promise((p,e)=>{M.put(`/admin/proyectos/${m}/etiquetas/sync`,{etiquetas:d},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{g.value=!1,p(!0)},onError:t=>{g.value=!1,c.value="Error al sincronizar etiquetas",e(t)}})})}async function D(m){g.value=!0,c.value=null;try{const d=await fetch(`/admin/proyectos/${m}/etiquetas/suggest`);if(!d.ok)throw new Error("Error al obtener sugerencias");const p=await d.json();return g.value=!1,p.etiquetas||[]}catch(d){return g.value=!1,c.value="Error al obtener sugerencias de etiquetas",console.error(d),[]}}async function S(m){var d;g.value=!0,c.value=null;try{const p=await fetch("/admin/etiquetas",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content"))||""},body:JSON.stringify(m)});if(!p.ok){const t=await p.json();throw new Error(t.message||"Error al crear etiqueta")}const e=await p.json();return g.value=!1,e.data}catch(p){return g.value=!1,c.value=p.message||"Error al crear etiqueta",console.error(p),null}}async function F(m){if(m.length<2)return[];try{const d=await fetch(`/admin/etiquetas/search?q=${encodeURIComponent(m)}`);if(!d.ok)throw new Error("Error al buscar etiquetas");return(await d.json()).data||[]}catch(d){return console.error("Error buscando etiquetas:",d),[]}}function A(m){const d=new Map;return m.forEach(p=>{var t;const e=((t=p.categoria)==null?void 0:t.nombre)||"Sin categoría";d.has(e)||d.set(e,[]),d.get(e).push(p)}),d}function j(m){var d;return m.color||((d=m.categoria)==null?void 0:d.color)||"gray"}function z(m,d=10){return m<d}async function w(m,d){return g.value=!0,c.value=null,new Promise((p,e)=>{M.post(`/admin/proyectos/${m}/etiquetas/reorder`,{etiquetas:d},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{g.value=!1,p(!0)},onError:t=>{g.value=!1,c.value="Error al reordenar etiquetas",e(t)}})})}return{isLoading:g,error:c,addEtiquetaToProyecto:_,removeEtiquetaFromProyecto:b,syncEtiquetasProyecto:q,getSugerenciasEtiquetas:D,reorderEtiquetas:w,createEtiqueta:S,searchEtiquetas:F,groupEtiquetasByCategoria:A,getEtiquetaColor:j,canAddMoreEtiquetas:z}}const Ye={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Ze={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},et={class:"text-2xl font-bold text-gray-900 dark:text-white"},tt={key:0,class:"mt-2 text-gray-600 dark:text-gray-400"},st={class:"flex gap-2"},ot={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},at={class:"lg:col-span-2 space-y-4"},rt={class:"flex items-center justify-between"},it={class:"flex items-center gap-3"},nt={class:"flex items-center gap-3"},lt={class:"space-y-2"},dt={class:"flex justify-between text-sm"},ct={class:"font-medium"},ut={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2"},mt={class:"flex items-start gap-3"},ft={class:"font-medium"},pt={class:"text-xs text-gray-500"},yt={key:0,class:"flex items-start gap-3"},gt={class:"font-medium"},vt={class:"text-xs text-gray-500"},_t={key:0,class:"flex items-center gap-3 pt-2"},ht={class:"font-medium ml-2"},xt={key:0},bt={key:1,class:"text-sm text-muted-foreground"},wt={key:1,class:"space-y-4"},kt={class:"flex gap-2"},$t={class:"space-y-3"},Ct={class:"text-sm text-gray-600 dark:text-gray-400"},Et={class:"font-medium"},qt={key:0,class:"space-y-4"},Dt={class:"mt-4"},St={class:"text-sm text-muted-foreground mb-3"},zt={class:"grid gap-2"},Tt={class:"flex items-start justify-between"},Pt={class:"font-medium"},jt={class:"flex items-center gap-2 mt-1"},Mt={class:"text-xs text-muted-foreground"},Bt={key:0,class:"text-right"},Vt={class:"font-semibold"},Ft={class:"text-xs text-muted-foreground"},At={key:1,class:"text-center py-6"},Nt={class:"space-y-3"},Lt={class:"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Rt={class:"flex-1"},It={class:"text-sm"},Ut={class:"font-medium"},Ot={class:"text-xs text-gray-500 mt-1"},Ht={class:"space-y-4"},Wt={key:0,class:"flex items-center gap-3"},Xt={class:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Gt={class:"font-medium"},Jt={class:"text-sm text-gray-500"},Kt={key:1,class:"text-gray-500"},Qt={class:"font-mono"},Yt={class:"font-medium"},Zt={class:"text-sm"},es={class:"text-sm"},ko=J({__name:"Show",props:{proyecto:{},categorias:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageTags:{type:Boolean},canViewContracts:{type:Boolean},canCreateContracts:{type:Boolean}},setup(g){const c=g,_=V(!1),b=V([]),{syncEtiquetasProyecto:q,isLoading:D}=Qe();c.proyecto.etiquetas&&(b.value=c.proyecto.etiquetas.map(e=>e.id));const S=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:c.proyecto.nombre,href:`/admin/proyectos/${c.proyecto.id}`}],F=()=>{confirm(`¿Estás seguro de eliminar el proyecto "${c.proyecto.nombre}"?`)&&M.delete(`/admin/proyectos/${c.proyecto.id}`,{onSuccess:()=>{R.success("Proyecto eliminado exitosamente")},onError:()=>{R.error("Error al eliminar el proyecto")}})},A=e=>({planificacion:pe,en_progreso:ve,pausado:ge,completado:W,cancelado:ye})[e]||_e,j=e=>({planificacion:"bg-blue-100 text-blue-800",en_progreso:"bg-yellow-100 text-yellow-800",pausado:"bg-orange-100 text-orange-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800",z=e=>({baja:"bg-gray-100 text-gray-800",media:"bg-blue-100 text-blue-800",alta:"bg-orange-100 text-orange-800",critica:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800",w=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),m=e=>{const t=Math.floor((new Date(e).getTime()-new Date().getTime())/864e5);return t===0?"Hoy":t===1?"Mañana":t===-1?"Ayer":t>0?`En ${t} días`:`Hace ${Math.abs(t)} días`},d=async()=>{try{await q(c.proyecto.id,b.value),_.value=!1,R.success("Etiquetas actualizadas exitosamente"),M.reload({only:["proyecto"]})}catch{R.error("Error al actualizar las etiquetas")}},p=()=>{var e;b.value=((e=c.proyecto.etiquetas)==null?void 0:e.map(t=>t.id))||[],_.value=!1};return(e,t)=>(n(),f(N,null,[a(o(Z),{title:`Proyecto: ${e.proyecto.nombre}`},null,8,["title"]),a(Q,{breadcrumbs:S},{default:r(()=>[s("div",Ye,[s("div",Ze,[s("div",null,[s("h1",et,l(e.proyecto.nombre),1),e.proyecto.descripcion?(n(),f("p",tt,l(e.proyecto.descripcion),1)):y("",!0)]),s("div",st,[e.canEdit?(n(),v(o(T),{key:0,href:`/admin/proyectos/${e.proyecto.id}/edit`},{default:r(()=>[a(o(x),null,{default:r(()=>[a(o(H),{class:"mr-2 h-4 w-4"}),t[2]||(t[2]=u(" Editar ",-1))]),_:1})]),_:1},8,["href"])):y("",!0),e.canDelete?(n(),v(o(x),{key:1,variant:"destructive",onClick:F},{default:r(()=>[a(o(ce),{class:"mr-2 h-4 w-4"}),t[3]||(t[3]=u(" Eliminar ",-1))]),_:1})):y("",!0)])]),s("div",ot,[s("div",at,[a(o(E),null,{default:r(()=>[a(o(k),null,{default:r(()=>[a(o($),null,{default:r(()=>[...t[4]||(t[4]=[u("Estado del Proyecto",-1)])]),_:1})]),_:1}),a(o(C),{class:"space-y-4"},{default:r(()=>[s("div",rt,[s("div",it,[(n(),v(K(A(e.proyecto.estado)),{class:"h-5 w-5 text-gray-500"})),t[5]||(t[5]=s("span",{class:"font-medium"},"Estado:",-1)),a(o(P),{class:B(j(e.proyecto.estado))},{default:r(()=>[u(l(e.proyecto.estado_label),1)]),_:1},8,["class"])]),s("div",nt,[a(o(ue),{class:"h-5 w-5 text-gray-500"}),t[6]||(t[6]=s("span",{class:"font-medium"},"Prioridad:",-1)),a(o(P),{class:B(z(e.proyecto.prioridad))},{default:r(()=>[u(l(e.proyecto.prioridad_label),1)]),_:1},8,["class"])])]),s("div",lt,[s("div",dt,[t[7]||(t[7]=s("span",{class:"text-gray-600 dark:text-gray-400"},"Progreso",-1)),s("span",ct,l(e.proyecto.porcentaje_completado)+"%",1)]),a(o(ee),{value:e.proyecto.porcentaje_completado,class:"h-2"},null,8,["value"])]),s("div",ut,[s("div",mt,[a(o(U),{class:"h-5 w-5 text-gray-500 mt-0.5"}),s("div",null,[t[8]||(t[8]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de inicio",-1)),s("p",ft,l(w(e.proyecto.fecha_inicio)),1),s("p",pt,l(m(e.proyecto.fecha_inicio)),1)])]),e.proyecto.fecha_fin?(n(),f("div",yt,[a(o(U),{class:"h-5 w-5 text-gray-500 mt-0.5"}),s("div",null,[t[9]||(t[9]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de fin",-1)),s("p",gt,l(w(e.proyecto.fecha_fin)),1),s("p",vt,l(m(e.proyecto.fecha_fin)),1)])])):y("",!0)]),e.proyecto.duracion_dias?(n(),f("div",_t,[a(o(me),{class:"h-5 w-5 text-gray-500"}),s("div",null,[t[10]||(t[10]=s("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Duración total:",-1)),s("span",ht,l(e.proyecto.duracion_dias)+" días",1)])])):y("",!0)]),_:1})]),_:1}),a(o(E),null,{default:r(()=>[a(o(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:r(()=>[a(o($),{class:"flex items-center gap-2"},{default:r(()=>[a(o(fe),{class:"h-5 w-5"}),t[11]||(t[11]=u(" Etiquetas ",-1))]),_:1}),e.canManageTags&&!_.value?(n(),v(o(x),{key:0,variant:"ghost",size:"sm",onClick:t[0]||(t[0]=i=>_.value=!0)},{default:r(()=>[a(o(H),{class:"h-4 w-4"})]),_:1})):y("",!0)]),_:1}),a(o(C),null,{default:r(()=>[_.value?(n(),f("div",wt,[e.categorias?(n(),v(se,{key:0,modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=i=>b.value=i),categorias:e.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas...",description:"Selecciona hasta 10 etiquetas para este proyecto"},null,8,["modelValue","categorias"])):y("",!0),s("div",kt,[a(o(x),{size:"sm",onClick:d,disabled:o(D)},{default:r(()=>[...t[12]||(t[12]=[u(" Guardar ",-1)])]),_:1},8,["disabled"]),a(o(x),{size:"sm",variant:"outline",onClick:p,disabled:o(D)},{default:r(()=>[...t[13]||(t[13]=[u(" Cancelar ",-1)])]),_:1},8,["disabled"])])])):(n(),f("div",xt,[e.proyecto.etiquetas&&e.proyecto.etiquetas.length>0?(n(),v(te,{key:0,etiquetas:e.proyecto.etiquetas,"show-categoria":!0,interactive:!0,size:"md"},null,8,["etiquetas"])):(n(),f("p",bt," No hay etiquetas asignadas "))]))]),_:1})]),_:1}),e.proyecto.campos_personalizados&&e.proyecto.campos_personalizados.length>0?(n(),v(o(E),{key:0},{default:r(()=>[a(o(k),null,{default:r(()=>[a(o($),null,{default:r(()=>[...t[14]||(t[14]=[u("Campos Personalizados",-1)])]),_:1})]),_:1}),a(o(C),null,{default:r(()=>[s("div",$t,[(n(!0),f(N,null,I(e.proyecto.campos_personalizados,i=>(n(),f("div",{key:i.id,class:"flex justify-between py-2 border-b last:border-b-0"},[s("span",Ct,l(i.nombre),1),s("span",Et,l(i.valor_formateado||i.valor||"-"),1)]))),128))])]),_:1})]),_:1})):y("",!0),e.canViewContracts?(n(),v(o(E),{key:1},{default:r(()=>[a(o(k),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:r(()=>[a(o($),{class:"flex items-center gap-2"},{default:r(()=>[a(o(O),{class:"h-5 w-5"}),t[15]||(t[15]=u(" Contratos ",-1))]),_:1}),e.canCreateContracts?(n(),v(o(T),{key:0,href:`/admin/proyectos/${e.proyecto.id}/contratos/create`},{default:r(()=>[a(o(x),{size:"sm"},{default:r(()=>[a(o(X),{class:"h-4 w-4 mr-2"}),t[16]||(t[16]=u(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])):y("",!0)]),_:1}),a(o(C),null,{default:r(()=>[e.proyecto.contratos&&e.proyecto.contratos.length>0?(n(),f("div",qt,[a(Ke,{contratos:e.proyecto.contratos,"mostrar-monto":!0,compacto:!0},null,8,["contratos"]),s("div",Dt,[s("p",St,l(e.proyecto.contratos.length)+" contrato(s) asociado(s) ",1),s("div",zt,[(n(!0),f(N,null,I(e.proyecto.contratos.slice(0,3),i=>(n(),v(o(T),{key:i.id,href:`/admin/contratos/${i.id}`,class:"block p-3 rounded-lg border hover:bg-muted/50 transition-colors"},{default:r(()=>[s("div",Tt,[s("div",null,[s("p",Pt,l(i.nombre),1),s("div",jt,[a(o(P),{variant:i.estado==="activo"?"default":i.estado==="finalizado"?"secondary":i.estado==="cancelado"?"destructive":"outline"},{default:r(()=>[u(l(i.estado),1)]),_:2},1032,["variant"]),s("span",Mt,l(new Date(i.fecha_inicio).toLocaleDateString()),1)])]),i.monto_total?(n(),f("div",Bt,[s("p",Vt,"$"+l(i.monto_total.toLocaleString()),1),s("p",Ft,l(i.moneda||"USD"),1)])):y("",!0)])]),_:2},1032,["href"]))),128))]),e.proyecto.contratos.length>3?(n(),v(o(T),{key:0,href:`/admin/contratos?proyecto_id=${e.proyecto.id}`,class:"block text-center mt-3 text-sm text-primary hover:underline"},{default:r(()=>[u(" Ver todos los contratos ("+l(e.proyecto.contratos.length)+") ",1)]),_:1},8,["href"])):y("",!0)])])):(n(),f("div",At,[a(o(O),{class:"h-10 w-10 mx-auto text-muted-foreground mb-3"}),t[18]||(t[18]=s("p",{class:"text-muted-foreground mb-3"},"No hay contratos asociados",-1)),e.canCreateContracts?(n(),v(o(T),{key:0,href:`/admin/proyectos/${e.proyecto.id}/contratos/create`},{default:r(()=>[a(o(x),{variant:"outline",size:"sm"},{default:r(()=>[a(o(X),{class:"h-4 w-4 mr-2"}),t[17]||(t[17]=u(" Crear Primer Contrato ",-1))]),_:1})]),_:1},8,["href"])):y("",!0)]))]),_:1})]),_:1})):y("",!0),e.proyecto.activities&&e.proyecto.activities.length>0?(n(),v(o(E),{key:2},{default:r(()=>[a(o(k),null,{default:r(()=>[a(o($),null,{default:r(()=>[...t[19]||(t[19]=[u("Actividad Reciente",-1)])]),_:1})]),_:1}),a(o(C),null,{default:r(()=>[s("div",Nt,[(n(!0),f(N,null,I(e.proyecto.activities,i=>{var h;return n(),f("div",{key:i.id,class:"flex items-start gap-3 pb-3 border-b last:border-b-0"},[s("div",Lt,[a(o(G),{class:"h-4 w-4 text-gray-500"})]),s("div",Rt,[s("p",It,[s("span",Ut,l(((h=i.causer)==null?void 0:h.name)||"Sistema"),1),u(" "+l(i.description),1)]),s("p",Ot,l(m(i.created_at)),1)])])}),128))])]),_:1})]),_:1})):y("",!0)]),s("div",Ht,[a(o(E),null,{default:r(()=>[a(o(k),null,{default:r(()=>[a(o($),null,{default:r(()=>[...t[20]||(t[20]=[u("Responsable",-1)])]),_:1})]),_:1}),a(o(C),null,{default:r(()=>[e.proyecto.responsable?(n(),f("div",Wt,[s("div",Xt,[a(o(G),{class:"h-5 w-5 text-gray-500"})]),s("div",null,[s("p",Gt,l(e.proyecto.responsable.name),1),s("p",Jt,l(e.proyecto.responsable.email),1)])])):(n(),f("p",Kt,"Sin asignar"))]),_:1})]),_:1}),a(o(E),null,{default:r(()=>[a(o(k),null,{default:r(()=>[a(o($),null,{default:r(()=>[...t[21]||(t[21]=[u("Información del Sistema",-1)])]),_:1})]),_:1}),a(o(C),{class:"space-y-3"},{default:r(()=>{var i;return[s("div",null,[t[22]||(t[22]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"ID del Proyecto",-1)),s("p",Qt,"#"+l(e.proyecto.id),1)]),s("div",null,[t[23]||(t[23]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado",-1)),a(o(P),{class:B(e.proyecto.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},{default:r(()=>[u(l(e.proyecto.activo?"Activo":"Inactivo"),1)]),_:1},8,["class"])]),s("div",null,[t[24]||(t[24]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Creado por",-1)),s("p",Yt,l(((i=e.proyecto.creador)==null?void 0:i.name)||"Sistema"),1)]),s("div",null,[t[25]||(t[25]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de creación",-1)),s("p",Zt,l(w(e.proyecto.created_at)),1)]),s("div",null,[t[26]||(t[26]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Última actualización",-1)),s("p",es,l(w(e.proyecto.updated_at)),1)])]}),_:1})]),_:1}),a(o(E),null,{default:r(()=>[a(o(k),null,{default:r(()=>[a(o($),null,{default:r(()=>[...t[27]||(t[27]=[u("Acciones Rápidas",-1)])]),_:1})]),_:1}),a(o(C),{class:"space-y-2"},{default:r(()=>[a(o(T),{href:"/admin/proyectos"},{default:r(()=>[a(o(x),{variant:"outline",class:"w-full justify-start"},{default:r(()=>[...t[28]||(t[28]=[u(" Volver al listado ",-1)])]),_:1})]),_:1}),e.canEdit?(n(),v(o(T),{key:0,href:`/admin/proyectos/${e.proyecto.id}/edit`},{default:r(()=>[a(o(x),{variant:"outline",class:"w-full justify-start"},{default:r(()=>[a(o(H),{class:"mr-2 h-4 w-4"}),t[29]||(t[29]=u(" Editar proyecto ",-1))]),_:1})]),_:1},8,["href"])):y("",!0)]),_:1})]),_:1})])])])]),_:1})],64))}});export{ko as default};
