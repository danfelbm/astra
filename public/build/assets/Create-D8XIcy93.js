import{d as Pe,r as N,c as V,p as Me,i as _,e as a,g as o,b as h,j as x,w as l,f as e,h as r,t as f,n as k,F as R,k as Q,x as Ve,m,u as Te,q as Le,l as Ne,s as Be,a as We}from"./app-KXtif7qq.js";import{_ as j}from"./createLucideIcon-BY2zdh_L.js";import{a as A,b as D,c as S,_ as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-B7Mglf7h.js";import{_ as U}from"./CardDescription.vue_vue_type_script_setup_true_lang-DSfUmw7N.js";import{_ as P}from"./Input.vue_vue_type_script_setup_true_lang-BkaVdW_x.js";import{_ as g}from"./Label.vue_vue_type_script_setup_true_lang-kqtySDWN.js";import{_ as Ie}from"./Textarea.vue_vue_type_script_setup_true_lang-Bh8SNKuH.js";import{_ as Se,a as ze,b as Fe,c as Ae,d as De}from"./SelectValue.vue_vue_type_script_setup_true_lang-lIT9MUQE.js";import{_ as q,a as T}from"./index-B3w0F3K5.js";import{_ as ee,a as M}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-DftRHeTZ.js";import{_ as Ge}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DUay4fSq.js";import{_ as Ee}from"./index-DMu57UMp.js";import{M as Y}from"./map-pin-Bgv-opIp.js";import{S as Z}from"./shield-DnGJw1Ro.js";import{F as K}from"./filter-9Xc6xFeu.js";import{C as Ue}from"./calendar-Ce5ju53J.js";import{S as Oe}from"./search-BA4urOEB.js";import{C as Re}from"./circle-check-DpFBMcSZ.js";import{U as B}from"./users-BWb5DPyh.js";import{I as H}from"./info-BXqeCBog.js";import{C as je}from"./circle-alert-BxdHbCZ8.js";import{_ as Qe}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-DaKm3VMr.js";import{t as C}from"./index-Dm0KPXQj.js";import{d as Ke}from"./debounce-DnkiiW0v.js";import{A as He}from"./arrow-left-nC1PH91F.js";import{S as Je}from"./save-J73N-xyk.js";import{M as Xe}from"./mail-SA5Kz7Xj.js";import{M as Ye}from"./message-square-CUB5aJ5F.js";import{S as Ze}from"./send-C8_ce2KL.js";import"./index-DM1P4Ifz.js";import"./VisuallyHidden-CuGa-e_U.js";import"./check-BXO7M11A.js";import"./floating-ui.vue-oBzjxj0U.js";import"./RovingFocusItem-CCHGvEa7.js";import"./utils-D9SmGaDo.js";import"./VisuallyHiddenInput-BGtQfI-v.js";import"./circle-D87C_hM_.js";import"./useFlashMessages-C0levHeu.js";import"./index-dxUqd-18.js";import"./x-BG7w8fZB.js";import"./index-WC1PnT1j.js";import"./user-D9tKp3_0.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B_dxU_KJ.js";import"./chevron-right-qwsTIbSz.js";import"./house-D8k__HYI.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BtuZaRmw.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-hjOO1ket.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-D7Pmpm9D.js";import"./chevrons-up-down-DK_UD8ra.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CHh-gB3O.js";import"./target-Dm6ej6_p.js";import"./vote-BnmR_OQK.js";import"./folder-open-Cx58QfFB.js";import"./file-text-CE1uNbyL.js";import"./briefcase-CRBoyl6H.js";import"./megaphone-BVwAYYrZ.js";import"./user-check-BpAk48jb.js";import"./clipboard-list-DEDIgC_n.js";import"./external-link-hexnS8K7.js";import"./panel-left-DuOe-Xz_.js";import"./index-D_JV8DVQ.js";import"./DialogTrigger-DVXxekQy.js";import"./useKbd-kRIii9yh.js";import"./chevron-left-CJQtt0rE.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DumW1HW7.js";import"./es-SykclP7y.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-BewCoNPe.js";import"./loader-circle-DQozwruZ.js";import"./trash-2-BZw66j_J.js";import"./plus-BtMHBz4b.js";import"./history-D1JCsHHy.js";const ea={class:"space-y-4"},aa={class:"flex justify-between items-center"},ta={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},la={class:"flex items-center gap-2"},sa={class:"flex items-center gap-2"},oa={class:"flex items-center gap-2"},na={class:"flex items-center gap-2"},ia={class:"flex flex-col md:flex-row gap-4"},ra={class:"flex-1"},da={class:"relative"},ua={class:"flex gap-2"},ma={class:"space-y-2 max-h-96 overflow-y-auto p-2"},pa={class:"flex items-start justify-between"},ca={class:"flex-1"},fa={class:"flex items-center gap-2"},_a={class:"font-medium"},ga={key:0,class:"text-sm text-muted-foreground mt-1"},va={class:"text-right"},xa={class:"text-2xl font-bold"},ba={key:0,class:"text-center py-8 text-muted-foreground"},ya={class:"space-y-3"},ka={class:"font-medium flex items-center gap-2"},wa={key:0,class:"text-sm text-muted-foreground mt-1"},ha={class:"flex items-center justify-between p-3 bg-muted rounded-md"},$a={class:"text-2xl font-bold"},Ca=Pe({__name:"SegmentSelector",props:{modelValue:{default:null},segments:{},required:{type:Boolean,default:!1},showPreview:{type:Boolean,default:!0}},emits:["update:modelValue","change"],setup(F,{emit:c}){const b=F,W=c,s=N(b.modelValue),E=N(""),v=N("all"),w=V(()=>b.segments.find(d=>d.id===s.value)||null),y=V(()=>{let d=b.segments;if(E.value){const n=E.value.toLowerCase();d=d.filter(p=>{var L;return p.nombre.toLowerCase().includes(n)||((L=p.descripcion)==null?void 0:L.toLowerCase().includes(n))})}return v.value!=="all"&&(d=d.filter(n=>n.tipo===v.value)),d}),$=V(()=>{const d={total:b.segments.length,geografico:0,rol:0,personalizado:0,dinamico:0,totalUsuarios:0};return b.segments.forEach(n=>{d[n.tipo]++,d.totalUsuarios+=n.count||0}),d}),J=d=>{s.value=d;const n=b.segments.find(p=>p.id===d)||null;W("update:modelValue",d),W("change",n)},I=d=>({geografico:Y,rol:Z,personalizado:K,dinamico:Ue})[d]||B,G=d=>({geografico:"text-blue-600",rol:"text-purple-600",personalizado:"text-green-600",dinamico:"text-orange-600"})[d]||"text-gray-600",X=d=>({geografico:"Geográfico",rol:"Por Rol",personalizado:"Personalizado",dinamico:"Dinámico"})[d]||d,O=d=>d?d>=1e6?`${(d/1e6).toFixed(1)}M`:d>=1e3?`${(d/1e3).toFixed(1)}K`:d.toLocaleString():"0";return Me(()=>b.modelValue,d=>{s.value=d}),(d,n)=>(m(),_("div",ea,[a(e(z),null,{default:l(()=>[a(e(A),null,{default:l(()=>[o("div",aa,[a(e(D),{class:"text-base"},{default:l(()=>[...n[6]||(n[6]=[r("Seleccionar Segmento",-1)])]),_:1}),a(e(Ee),{variant:"outline"},{default:l(()=>[r(f($.value.total)+" segmentos disponibles ",1)]),_:1})])]),_:1}),a(e(S),null,{default:l(()=>[o("div",ta,[o("div",la,[a(e(Y),{class:"w-4 h-4 text-blue-600"}),o("span",null,f($.value.geografico)+" Geográficos",1)]),o("div",sa,[a(e(Z),{class:"w-4 h-4 text-purple-600"}),o("span",null,f($.value.rol)+" Por Rol",1)]),o("div",oa,[a(e(K),{class:"w-4 h-4 text-green-600"}),o("span",null,f($.value.personalizado)+" Personalizados",1)]),o("div",na,[a(e(Ue),{class:"w-4 h-4 text-orange-600"}),o("span",null,f($.value.dinamico)+" Dinámicos",1)])])]),_:1})]),_:1}),o("div",ia,[o("div",ra,[o("div",da,[a(e(Oe),{class:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),a(e(P),{modelValue:E.value,"onUpdate:modelValue":n[0]||(n[0]=p=>E.value=p),placeholder:"Buscar segmento...",class:"pl-8"},null,8,["modelValue"])])]),o("div",ua,[a(e(j),{variant:"outline",size:"sm",class:k({"bg-accent":v.value==="all"}),onClick:n[1]||(n[1]=p=>v.value="all")},{default:l(()=>[...n[7]||(n[7]=[r(" Todos ",-1)])]),_:1},8,["class"]),a(e(j),{variant:"outline",size:"sm",class:k({"bg-accent":v.value==="geografico"}),onClick:n[2]||(n[2]=p=>v.value="geografico")},{default:l(()=>[a(e(Y),{class:"w-4 h-4 mr-1"}),n[8]||(n[8]=r(" Geográfico ",-1))]),_:1},8,["class"]),a(e(j),{variant:"outline",size:"sm",class:k({"bg-accent":v.value==="rol"}),onClick:n[3]||(n[3]=p=>v.value="rol")},{default:l(()=>[a(e(Z),{class:"w-4 h-4 mr-1"}),n[9]||(n[9]=r(" Rol ",-1))]),_:1},8,["class"]),a(e(j),{variant:"outline",size:"sm",class:k({"bg-accent":v.value==="personalizado"}),onClick:n[4]||(n[4]=p=>v.value="personalizado")},{default:l(()=>[a(e(K),{class:"w-4 h-4 mr-1"}),n[10]||(n[10]=r(" Personalizado ",-1))]),_:1},8,["class"])])]),a(e(z),null,{default:l(()=>[a(e(S),{class:"p-2"},{default:l(()=>[a(e(ee),{modelValue:s.value,"onUpdate:modelValue":[n[5]||(n[5]=p=>s.value=p),J]},{default:l(()=>[o("div",ma,[(m(!0),_(R,null,Q(y.value,p=>(m(),_("div",{key:p.id,class:k(["flex items-start space-x-3 p-3 rounded-lg border hover:bg-accent cursor-pointer",{"bg-accent border-primary":s.value===p.id}])},[a(e(M),{value:p.id,id:`segment-${p.id}`},null,8,["value","id"]),a(e(g),{for:`segment-${p.id}`,class:"flex-1 cursor-pointer"},{default:l(()=>[o("div",pa,[o("div",ca,[o("div",fa,[(m(),h(Ve(I(p.tipo)),{class:k(["w-4 h-4",G(p.tipo)])},null,8,["class"])),o("span",_a,f(p.nombre),1),a(e(Ee),{variant:"outline",class:"ml-2"},{default:l(()=>[r(f(X(p.tipo)),1)]),_:2},1024)]),p.descripcion?(m(),_("p",ga,f(p.descripcion),1)):x("",!0)]),o("div",va,[o("p",xa,f(O(p.count)),1),n[11]||(n[11]=o("p",{class:"text-xs text-muted-foreground"},"usuarios",-1))])])]),_:2},1032,["for"])],2))),128)),y.value.length===0?(m(),_("div",ba," No se encontraron segmentos ")):x("",!0)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),F.showPreview&&w.value?(m(),h(e(z),{key:0},{default:l(()=>[a(e(A),null,{default:l(()=>[a(e(D),{class:"text-base flex items-center gap-2"},{default:l(()=>[a(e(Re),{class:"w-4 h-4 text-green-600"}),n[12]||(n[12]=r(" Segmento Seleccionado ",-1))]),_:1})]),_:1}),a(e(S),null,{default:l(()=>[o("div",ya,[o("div",null,[o("h4",ka,[(m(),h(Ve(I(w.value.tipo)),{class:k(["w-4 h-4",G(w.value.tipo)])},null,8,["class"])),r(" "+f(w.value.nombre),1)]),w.value.descripcion?(m(),_("p",wa,f(w.value.descripcion),1)):x("",!0)]),o("div",ha,[o("div",null,[n[13]||(n[13]=o("p",{class:"text-sm text-muted-foreground"},"Total de destinatarios",-1)),o("p",$a,f(O(w.value.count)),1)]),a(e(B),{class:"w-8 h-8 text-muted-foreground"})]),a(e(q),null,{default:l(()=>[a(e(H),{class:"h-4 w-4"}),a(e(T),null,{default:l(()=>[...n[14]||(n[14]=[r(" Los usuarios de este segmento recibirán la campaña según los criterios definidos. El número de destinatarios puede variar al momento del envío. ",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})):x("",!0),F.required&&!s.value?(m(),h(e(q),{key:1,variant:"warning"},{default:l(()=>[a(e(je),{class:"h-4 w-4"}),a(e(T),null,{default:l(()=>[...n[15]||(n[15]=[r(" Debes seleccionar un segmento para continuar ",-1)])]),_:1})]),_:1})):x("",!0)]))}}),Va={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Sa={class:"flex justify-between items-center"},za={class:"text-3xl font-bold"},Fa={class:"text-muted-foreground mt-1"},Aa={class:"flex gap-2"},Da={class:"list-disc pl-4"},Ea={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ua={class:"flex items-center space-x-2"},Pa={class:"flex items-center space-x-2"},Ma={class:"flex items-center space-x-2"},ja={class:"flex items-center space-x-2"},qa={class:"flex items-center space-x-2"},Ta={key:0},La={key:0,class:"mt-4 p-3 bg-muted rounded-md"},Na={class:"flex items-center gap-2 text-sm"},Ba={class:"font-medium"},Wa={key:1,class:"space-y-4"},Ia={key:0,class:"p-3 bg-muted rounded-md"},Ga={class:"flex items-center gap-2 text-sm"},Oa={class:"font-medium"},Ra={key:1,class:"p-3 bg-muted rounded-md"},Qa={class:"font-medium"},Ka={key:0,class:"text-xs text-muted-foreground"},Ha={class:"font-medium"},Ja={key:0,class:"text-xs text-muted-foreground"},Xa={class:"flex items-center space-x-2"},Ya=["aria-checked"],Za={key:0,class:"space-y-2"},et={key:0},at={key:1,class:"space-y-4"},tt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},lt={key:2,class:"space-y-2"},st={class:"space-y-2"},ot={class:"flex items-center space-x-2"},nt=["aria-checked"],it={class:"flex items-center space-x-2"},rt=["aria-checked"],Vl=Pe({__name:"Create",props:{campana:{},segmentos:{default:()=>[]},plantillasEmail:{default:()=>[]},plantillasWhatsApp:{default:()=>[]},tiposOptions:{default:()=>["email","whatsapp","ambos"]},estadosOptions:{},batchSizeEmailDefault:{},batchSizeWhatsAppDefault:{},whatsAppDelayDefault:{},filterFieldsConfig:{}},setup(F){var ae,te,le,se,oe,ne,ie,re,de,ue,me,pe,ce,fe,_e,ge,ve,xe,be,ye,ke,we,he,$e,Ce;const c=F,b=V(()=>{var u;return!!((u=c.campana)!=null&&u.id)}),W=[{title:"Admin",href:"/admin/dashboard"},{title:"Campañas",href:"/admin/campanas"},{title:b.value?"Editar Campaña":"Nueva Campaña",href:"#"}],s=Te({nombre:((ae=c.campana)==null?void 0:ae.nombre)||"",descripcion:((te=c.campana)==null?void 0:te.descripcion)||"",tipo:((le=c.campana)==null?void 0:le.tipo)||"email",estado:((se=c.campana)==null?void 0:se.estado)||"borrador",segment_id:((oe=c.campana)==null?void 0:oe.segment_id)||null,audience_mode:((ne=c.campana)==null?void 0:ne.audience_mode)||"segment",filters:((ie=c.campana)==null?void 0:ie.filters)||{},plantilla_email_id:((re=c.campana)==null?void 0:re.plantilla_email_id)||null,plantilla_whatsapp_id:((de=c.campana)==null?void 0:de.plantilla_whatsapp_id)||null,fecha_programada:((ue=c.campana)==null?void 0:ue.fecha_programada)||"",es_programada:!!((me=c.campana)!=null&&me.fecha_programada),configuracion:{batch_size_email:((ce=(pe=c.campana)==null?void 0:pe.configuracion)==null?void 0:ce.batch_size_email)||c.batchSizeEmailDefault||50,whatsapp_delay_min:((_e=(fe=c.campana)==null?void 0:fe.configuracion)==null?void 0:_e.whatsapp_delay_min)||((ge=c.whatsAppDelayDefault)==null?void 0:ge.min)||5,whatsapp_delay_max:((xe=(ve=c.campana)==null?void 0:ve.configuracion)==null?void 0:xe.whatsapp_delay_max)||((be=c.whatsAppDelayDefault)==null?void 0:be.max)||30,enable_tracking:((ke=(ye=c.campana)==null?void 0:ye.configuracion)==null?void 0:ke.enable_tracking)??!0,enable_pixel_tracking:((he=(we=c.campana)==null?void 0:we.configuracion)==null?void 0:he.enable_pixel_tracking)??!0,enable_click_tracking:((Ce=($e=c.campana)==null?void 0:$e.configuracion)==null?void 0:Ce.enable_click_tracking)??!0}}),E=V(()=>c.segmentos.find(u=>u.id===s.segment_id)),v=V(()=>s.tipo==="email"||s.tipo==="ambos"),w=V(()=>s.tipo==="whatsapp"||s.tipo==="ambos"),y=N(null),$=N(!1),J=V(()=>({fields:c.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por nombre o email...",quickSearchFields:["name","email"],maxNestingLevel:2,allowSaveFilters:!1,autoApply:!1})),I=async u=>{s.filters=u,s.segment_id=null,await G()},G=Ke(async()=>{const u=s.filters;if(!(!!(u!=null&&u.advanced_filters)||!!(u!=null&&u.search))){y.value=null;return}$.value=!0;try{const i=await We.post("/admin/campanas/count-users",{filters:u});y.value=i.data.count}catch(i){console.error("Error contando usuarios:",i),y.value=null,C.error("Error al contar usuarios")}finally{$.value=!1}},500),X=()=>{s.filters={},y.value=null};Me(()=>s.tipo,u=>{u==="email"?s.plantilla_whatsapp_id=null:u==="whatsapp"&&(s.plantilla_email_id=null)});const O=()=>{var u;if(s.audience_mode==="segment"){if(!s.segment_id){C.error("Debes seleccionar un segmento");return}}else if(s.audience_mode==="manual"&&(!y.value||y.value<=0)){C.error("Debes definir filtros que generen al menos un destinatario");return}if(v.value&&!s.plantilla_email_id){C.error("Debes seleccionar una plantilla de email");return}if(w.value&&!s.plantilla_whatsapp_id){C.error("Debes seleccionar una plantilla de WhatsApp");return}b.value?s.put(`/admin/campanas/${(u=c.campana)==null?void 0:u.id}`,{onSuccess:()=>{C.success("Campaña actualizada exitosamente")},onError:()=>{C.error("Error al actualizar la campaña")}}):s.post("/admin/campanas",{onSuccess:()=>{C.success("Campaña creada exitosamente")},onError:()=>{C.error("Error al crear la campaña")}})},d=V(()=>{const u=s.nombre&&!s.processing&&(v.value?s.plantilla_email_id:!0)&&(w.value?s.plantilla_whatsapp_id:!0);return s.audience_mode==="segment"?u&&s.segment_id:u&&y.value&&y.value>0}),n=u=>{s.es_programada=u,u||(s.fecha_programada="")},p=u=>{s.configuracion.enable_pixel_tracking=u},L=u=>{s.configuracion.enable_click_tracking=u};return(u,t)=>(m(),h(Ge,{breadcrumbs:W},{default:l(()=>[a(e(Le),{title:b.value?"Editar Campaña":"Nueva Campaña"},null,8,["title"]),o("div",Va,[o("form",{onSubmit:Ne(O,["prevent"]),class:"space-y-6"},[o("div",Sa,[o("div",null,[o("h1",za,f(b.value?"Editar Campaña":"Nueva Campaña"),1),o("p",Fa,f(b.value?"Modifica los detalles de la campaña":"Configura y programa tu campaña de comunicación"),1)]),o("div",Aa,[a(e(j),{type:"button",variant:"outline",onClick:t[0]||(t[0]=i=>e(Be).visit("/admin/campanas"))},{default:l(()=>[a(e(He),{class:"w-4 h-4 mr-2"}),t[18]||(t[18]=r(" Cancelar ",-1))]),_:1}),a(e(j),{type:"submit",disabled:!d.value},{default:l(()=>[a(e(Je),{class:"w-4 h-4 mr-2"}),r(" "+f(b.value?"Actualizar":"Guardar")+" Campaña ",1)]),_:1},8,["disabled"])])]),Object.keys(e(s).errors).length>0?(m(),h(e(q),{key:0,variant:"destructive"},{default:l(()=>[a(e(je),{class:"h-4 w-4"}),a(e(T),null,{default:l(()=>[o("ul",Da,[(m(!0),_(R,null,Q(e(s).errors,(i,qe)=>(m(),_("li",{key:qe},f(i),1))),128))])]),_:1})]),_:1})):x("",!0),a(e(z),null,{default:l(()=>[a(e(A),null,{default:l(()=>[a(e(D),null,{default:l(()=>[...t[19]||(t[19]=[r("Información Básica",-1)])]),_:1}),a(e(U),null,{default:l(()=>[...t[20]||(t[20]=[r(" Define el nombre y tipo de campaña ",-1)])]),_:1})]),_:1}),a(e(S),{class:"space-y-4"},{default:l(()=>[o("div",Ea,[o("div",null,[a(e(g),{htmlFor:"nombre"},{default:l(()=>[...t[21]||(t[21]=[r(" Nombre de la Campaña ",-1),o("span",{class:"text-destructive"},"*",-1)])]),_:1}),a(e(P),{id:"nombre",modelValue:e(s).nombre,"onUpdate:modelValue":t[1]||(t[1]=i=>e(s).nombre=i),placeholder:"Ej: Recordatorio Asamblea General",error:e(s).errors.nombre},null,8,["modelValue","error"])]),o("div",null,[a(e(g),null,{default:l(()=>[...t[22]||(t[22]=[r("Tipo de Campaña ",-1),o("span",{class:"text-destructive"},"*",-1)])]),_:1}),a(e(ee),{modelValue:e(s).tipo,"onUpdate:modelValue":t[2]||(t[2]=i=>e(s).tipo=i),class:"flex flex-wrap gap-4 mt-2"},{default:l(()=>[o("div",Ua,[a(e(M),{value:"email",id:"tipo-email"}),a(e(g),{htmlFor:"tipo-email",class:"flex items-center gap-1 cursor-pointer"},{default:l(()=>[a(e(Xe),{class:"w-4 h-4"}),t[23]||(t[23]=r(" Email ",-1))]),_:1})]),o("div",Pa,[a(e(M),{value:"whatsapp",id:"tipo-whatsapp"}),a(e(g),{htmlFor:"tipo-whatsapp",class:"flex items-center gap-1 cursor-pointer"},{default:l(()=>[a(e(Ye),{class:"w-4 h-4"}),t[24]||(t[24]=r(" WhatsApp ",-1))]),_:1})]),o("div",Ma,[a(e(M),{value:"ambos",id:"tipo-ambos"}),a(e(g),{htmlFor:"tipo-ambos",class:"flex items-center gap-1 cursor-pointer"},{default:l(()=>[a(e(Ze),{class:"w-4 h-4"}),t[25]||(t[25]=r(" Ambos ",-1))]),_:1})])]),_:1},8,["modelValue"])])]),o("div",null,[a(e(g),{htmlFor:"descripcion"},{default:l(()=>[...t[26]||(t[26]=[r("Descripción",-1)])]),_:1}),a(e(Ie),{id:"descripcion",modelValue:e(s).descripcion,"onUpdate:modelValue":t[3]||(t[3]=i=>e(s).descripcion=i),placeholder:"Describe el objetivo de esta campaña...",rows:"3"},null,8,["modelValue"])])]),_:1})]),_:1}),a(e(z),null,{default:l(()=>[a(e(A),null,{default:l(()=>[a(e(D),null,{default:l(()=>[...t[27]||(t[27]=[r("Audiencia",-1)])]),_:1}),a(e(U),null,{default:l(()=>[...t[28]||(t[28]=[r(" Define quiénes recibirán esta campaña ",-1)])]),_:1})]),_:1}),a(e(S),{class:"space-y-4"},{default:l(()=>[a(e(ee),{modelValue:e(s).audience_mode,"onUpdate:modelValue":t[4]||(t[4]=i=>e(s).audience_mode=i),class:"flex gap-4"},{default:l(()=>[o("div",ja,[a(e(M),{value:"segment",id:"mode-segment"}),a(e(g),{htmlFor:"mode-segment",class:"flex items-center gap-1 cursor-pointer"},{default:l(()=>[a(e(B),{class:"w-4 h-4"}),t[29]||(t[29]=r(" Usar segmento existente ",-1))]),_:1})]),o("div",qa,[a(e(M),{value:"manual",id:"mode-manual"}),a(e(g),{htmlFor:"mode-manual",class:"flex items-center gap-1 cursor-pointer"},{default:l(()=>[a(e(K),{class:"w-4 h-4"}),t[30]||(t[30]=r(" Filtros manuales ",-1))]),_:1})])]),_:1},8,["modelValue"]),e(s).audience_mode==="segment"?(m(),_("div",Ta,[a(Ca,{modelValue:e(s).segment_id,"onUpdate:modelValue":t[5]||(t[5]=i=>e(s).segment_id=i),segments:F.segmentos},null,8,["modelValue","segments"]),E.value?(m(),_("div",La,[o("div",Na,[a(e(B),{class:"w-4 h-4"}),o("span",Ba,f(E.value.count)+" usuarios",1),t[31]||(t[31]=o("span",{class:"text-muted-foreground"},"recibirán esta campaña",-1))])])):x("",!0)])):(m(),_("div",Wa,[a(e(q),null,{default:l(()=>[a(e(H),{class:"h-4 w-4"}),a(e(T),null,{default:l(()=>[...t[32]||(t[32]=[r(" Define filtros para seleccionar usuarios específicos sin crear un segmento permanente. ",-1)])]),_:1})]),_:1}),a(Qe,{config:J.value,"hide-topbar":!0,onApply:I,onClear:X},null,8,["config"]),y.value!==null?(m(),_("div",Ia,[o("div",Ga,[a(e(B),{class:"w-4 h-4"}),o("span",Oa,f(y.value)+" usuarios",1),t[33]||(t[33]=o("span",{class:"text-muted-foreground"},"recibirán esta campaña",-1))])])):$.value?(m(),_("div",Ra,[...t[34]||(t[34]=[o("div",{class:"flex items-center gap-2 text-sm text-muted-foreground"},[o("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),r(" Calculando usuarios... ")],-1)])])):x("",!0)]))]),_:1})]),_:1}),v.value?(m(),h(e(z),{key:1},{default:l(()=>[a(e(A),null,{default:l(()=>[a(e(D),null,{default:l(()=>[...t[35]||(t[35]=[r("Plantilla de Email",-1)])]),_:1}),a(e(U),null,{default:l(()=>[...t[36]||(t[36]=[r(" Selecciona la plantilla de email a utilizar ",-1)])]),_:1})]),_:1}),a(e(S),null,{default:l(()=>[a(e(Se),{modelValue:e(s).plantilla_email_id,"onUpdate:modelValue":t[6]||(t[6]=i=>e(s).plantilla_email_id=i)},{default:l(()=>[a(e(ze),null,{default:l(()=>[a(e(Fe),{placeholder:"Selecciona una plantilla"})]),_:1}),a(e(Ae),null,{default:l(()=>[(m(!0),_(R,null,Q(F.plantillasEmail,i=>(m(),h(e(De),{key:i.id,value:i.id.toString()},{default:l(()=>[o("div",null,[o("div",Qa,f(i.nombre),1),i.asunto?(m(),_("div",Ka," Asunto: "+f(i.asunto),1)):x("",!0)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):x("",!0),w.value?(m(),h(e(z),{key:2},{default:l(()=>[a(e(A),null,{default:l(()=>[a(e(D),null,{default:l(()=>[...t[37]||(t[37]=[r("Plantilla de WhatsApp",-1)])]),_:1}),a(e(U),null,{default:l(()=>[...t[38]||(t[38]=[r(" Selecciona la plantilla de WhatsApp a utilizar ",-1)])]),_:1})]),_:1}),a(e(S),null,{default:l(()=>[a(e(Se),{modelValue:e(s).plantilla_whatsapp_id,"onUpdate:modelValue":t[7]||(t[7]=i=>e(s).plantilla_whatsapp_id=i)},{default:l(()=>[a(e(ze),null,{default:l(()=>[a(e(Fe),{placeholder:"Selecciona una plantilla"})]),_:1}),a(e(Ae),null,{default:l(()=>[(m(!0),_(R,null,Q(F.plantillasWhatsApp,i=>(m(),h(e(De),{key:i.id,value:i.id.toString()},{default:l(()=>[o("div",null,[o("div",Ha,f(i.nombre),1),i.descripcion?(m(),_("div",Ja,f(i.descripcion),1)):x("",!0)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):x("",!0),a(e(z),null,{default:l(()=>[a(e(A),null,{default:l(()=>[a(e(D),null,{default:l(()=>[...t[39]||(t[39]=[r("Programación",-1)])]),_:1}),a(e(U),null,{default:l(()=>[...t[40]||(t[40]=[r(" Define cuándo se enviará la campaña ",-1)])]),_:1})]),_:1}),a(e(S),{class:"space-y-4"},{default:l(()=>[o("div",Xa,[o("button",{type:"button",onClick:t[8]||(t[8]=i=>n(!e(s).es_programada)),class:k(["inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] cursor-pointer",e(s).es_programada?"bg-primary":"bg-input"]),"aria-checked":e(s).es_programada,role:"switch"},[o("span",{class:k(["pointer-events-none block size-4 rounded-full bg-background ring-0 transition-transform",e(s).es_programada?"translate-x-[calc(100%-2px)]":"translate-x-0"])},null,2)],10,Ya),a(e(g),{onClick:t[9]||(t[9]=i=>n(!e(s).es_programada)),class:"cursor-pointer"},{default:l(()=>[...t[41]||(t[41]=[r("Programar envío",-1)])]),_:1})]),e(s).es_programada?(m(),_("div",Za,[a(e(g),{htmlFor:"fecha_programada"},{default:l(()=>[...t[42]||(t[42]=[r(" Fecha y hora de envío ",-1),o("span",{class:"text-destructive"},"*",-1)])]),_:1}),a(e(P),{id:"fecha_programada",type:"datetime-local",modelValue:e(s).fecha_programada,"onUpdate:modelValue":t[10]||(t[10]=i=>e(s).fecha_programada=i),min:new Date().toISOString().slice(0,16),class:"w-full",required:""},null,8,["modelValue","min"]),t[43]||(t[43]=o("p",{class:"text-xs text-muted-foreground"}," La campaña se enviará automáticamente en la fecha y hora seleccionada ",-1))])):x("",!0)]),_:1})]),_:1}),a(e(z),null,{default:l(()=>[a(e(A),null,{default:l(()=>[a(e(D),null,{default:l(()=>[...t[44]||(t[44]=[r("Configuración Avanzada",-1)])]),_:1}),a(e(U),null,{default:l(()=>[...t[45]||(t[45]=[r(" Ajusta los parámetros de envío y tracking ",-1)])]),_:1})]),_:1}),a(e(S),{class:"space-y-4"},{default:l(()=>[v.value?(m(),_("div",et,[a(e(g),{htmlFor:"batch_size_email"},{default:l(()=>[...t[46]||(t[46]=[r(" Tamaño de lote (Email) ",-1)])]),_:1}),a(e(P),{id:"batch_size_email",type:"number",modelValue:e(s).configuracion.batch_size_email,"onUpdate:modelValue":t[11]||(t[11]=i=>e(s).configuracion.batch_size_email=i),modelModifiers:{number:!0},min:"1",max:"100",class:"max-w-xs"},null,8,["modelValue"]),t[47]||(t[47]=o("p",{class:"text-xs text-muted-foreground mt-1"}," Emails enviados por lote (máximo 100, recomendado: 50) ",-1))])):x("",!0),w.value?(m(),_("div",at,[a(e(q),null,{default:l(()=>[a(e(H),{class:"h-4 w-4"}),a(e(T),null,{default:l(()=>[...t[48]||(t[48]=[r(" Los mensajes de WhatsApp se envían uno a uno con intervalos de tiempo aleatorios para evitar bloqueos de la API. ",-1)])]),_:1})]),_:1}),o("div",tt,[o("div",null,[a(e(g),{htmlFor:"whatsapp_delay_min"},{default:l(()=>[...t[49]||(t[49]=[r(" Intervalo mínimo (segundos) ",-1)])]),_:1}),a(e(P),{id:"whatsapp_delay_min",type:"number",modelValue:e(s).configuracion.whatsapp_delay_min,"onUpdate:modelValue":t[12]||(t[12]=i=>e(s).configuracion.whatsapp_delay_min=i),modelModifiers:{number:!0},min:"5",max:"120"},null,8,["modelValue"]),t[50]||(t[50]=o("p",{class:"text-xs text-muted-foreground mt-1"}," Mínimo 5 segundos entre mensajes ",-1))]),o("div",null,[a(e(g),{htmlFor:"whatsapp_delay_max"},{default:l(()=>[...t[51]||(t[51]=[r(" Intervalo máximo (segundos) ",-1)])]),_:1}),a(e(P),{id:"whatsapp_delay_max",type:"number",modelValue:e(s).configuracion.whatsapp_delay_max,"onUpdate:modelValue":t[13]||(t[13]=i=>e(s).configuracion.whatsapp_delay_max=i),modelModifiers:{number:!0},min:"5",max:"120"},null,8,["modelValue"]),t[52]||(t[52]=o("p",{class:"text-xs text-muted-foreground mt-1"}," Máximo 120 segundos entre mensajes ",-1))])])])):x("",!0),v.value?(m(),_("div",lt,[a(e(g),null,{default:l(()=>[...t[53]||(t[53]=[r("Opciones de Tracking",-1)])]),_:1}),o("div",st,[o("div",ot,[o("button",{type:"button",onClick:t[14]||(t[14]=i=>p(!e(s).configuracion.enable_pixel_tracking)),class:k(["inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] cursor-pointer",e(s).configuracion.enable_pixel_tracking?"bg-primary":"bg-input"]),"aria-checked":e(s).configuracion.enable_pixel_tracking,role:"switch"},[o("span",{class:k(["pointer-events-none block size-4 rounded-full bg-background ring-0 transition-transform",e(s).configuracion.enable_pixel_tracking?"translate-x-[calc(100%-2px)]":"translate-x-0"])},null,2)],10,nt),a(e(g),{class:"font-normal cursor-pointer",onClick:t[15]||(t[15]=i=>p(!e(s).configuracion.enable_pixel_tracking))},{default:l(()=>[...t[54]||(t[54]=[r(" Tracking de apertura (pixel) ",-1)])]),_:1})]),o("div",it,[o("button",{type:"button",onClick:t[16]||(t[16]=i=>L(!e(s).configuracion.enable_click_tracking)),class:k(["inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] cursor-pointer",e(s).configuracion.enable_click_tracking?"bg-primary":"bg-input"]),"aria-checked":e(s).configuracion.enable_click_tracking,role:"switch"},[o("span",{class:k(["pointer-events-none block size-4 rounded-full bg-background ring-0 transition-transform",e(s).configuracion.enable_click_tracking?"translate-x-[calc(100%-2px)]":"translate-x-0"])},null,2)],10,rt),a(e(g),{class:"font-normal cursor-pointer",onClick:t[17]||(t[17]=i=>L(!e(s).configuracion.enable_click_tracking))},{default:l(()=>[...t[55]||(t[55]=[r(" Tracking de clicks ",-1)])]),_:1})])])])):x("",!0)]),_:1})]),_:1}),a(e(q),null,{default:l(()=>[a(e(H),{class:"h-4 w-4"}),a(e(T),null,{default:l(()=>[...t[56]||(t[56]=[r(" La campaña se guardará en estado ",-1),o("strong",null,"borrador",-1),r(". Podrás revisarla y enviarla desde el listado de campañas. ",-1)])]),_:1})]),_:1})],32)])]),_:1}))}});export{Vl as default};
