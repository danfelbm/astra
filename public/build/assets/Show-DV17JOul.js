import{r as I,s as E,d as ce,c as R,b as y,w as o,j as v,e as a,f as e,g as r,i as g,h as d,t as c,v as T,n as O,F as M,k as z,m as l,q as he,x as be,l as re}from"./app-DyDecVrT.js";import{_ as we}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BgilFYR4.js";import{a as P,b as V,c as q,_ as C}from"./CardTitle.vue_vue_type_script_setup_true_lang-BuhHtk84.js";import{_ as ee}from"./CardDescription.vue_vue_type_script_setup_true_lang-C6L8777e.js";import{_ as H}from"./createLucideIcon-BwdUYYzo.js";import{_ as D}from"./index-m3ghty3H.js";import{_ as ue}from"./Progress.vue_vue_type_script_setup_true_lang-DQ38hQVn.js";import{_ as _e,a as $e,b as L,c as U}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-BSC6hZ_N.js";import{_ as Ee,a as ke,b as le,c as j,d as qe,e as A}from"./TableHeader.vue_vue_type_script_setup_true_lang-c5kig89J.js";import{_ as Ce,a as Se,b as He}from"./index-CT8XWwjl.js";import{t as B}from"./index-d_u7LaGe.js";import{E as De}from"./EtiquetaDisplay-C9UWh_PA.js";import{E as Pe}from"./EtiquetaSelector-Ddl4oL_F.js";import{_ as Ve}from"./ContratosList.vue_vue_type_script_setup_true_lang-6j0j9zeo.js";import{_ as Te,a as Be,b as je,c as Ae,d as Me}from"./AccordionContent.vue_vue_type_script_setup_true_lang-CKBNjuTd.js";import{L as Ne,H as ze}from"./HitoCard-DQHOfiyI.js";import{T as te}from"./target-p6K750Ym.js";import{P as J}from"./plus-AnKxd2ZI.js";import{S as ie}from"./square-pen-BlQFaVga.js";import{T as Ie}from"./trash-2-C-QiAuMz.js";import{I as Fe}from"./info-FMlit0NM.js";import{F as Y}from"./file-text-CAPFRzk1.js";import{M as Le,B as Ue,C as Oe}from"./milestone-CAC5PxhI.js";import{I as Z}from"./image-G8fuF9Q9.js";import{A as Re}from"./activity-4TVevZYD.js";import{F as Ge}from"./flag-BDjON2iR.js";import{C as ne}from"./calendar-DfExCvzB.js";import{C as Je}from"./clock-3fn1twzS.js";import{U as de}from"./user-Cy82gxzM.js";import{E as Ke}from"./external-link-ClHepNQE.js";import{D as Xe}from"./download-Clj2Ng9P.js";import{C as Qe}from"./circle-check-big-BqYUn3Th.js";import{C as We}from"./circle-play-DEzaHTRq.js";import{C as Ye}from"./circle-alert-Bvf_HuO8.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-CRAe9h2W.js";import"./index-BBNLqMKn.js";import"./floating-ui.vue-CHDJ2Kr9.js";import"./x-BjprgZQl.js";import"./Input.vue_vue_type_script_setup_true_lang-BmoYhMxG.js";import"./index-BNjYEiC7.js";import"./shield-D3pC1MNI.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DlUAJ3wP.js";import"./chevron-right-E1uKy6vs.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DEQiuFCZ.js";import"./VisuallyHidden-3cCb0SUn.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-U4o3oQo-.js";import"./check-Az9et91K.js";import"./Label.vue_vue_type_script_setup_true_lang-Bkyt-HEy.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-Q88f5Wd9.js";import"./map-pin-Dx4ca6bm.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-DIukCrmq.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Cmu5Q6fw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-BIWf8QzU.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DflCLCME.js";import"./tag-DLET6lC0.js";import"./users-CsrJ7kjm.js";import"./vote-w5kKYk1r.js";import"./folder-open-CxtqkkdK.js";import"./send-Dv7fIvk5.js";import"./briefcase-tw-IGJ4e.js";import"./megaphone-B2qQIwij.js";import"./user-check-Bk-CJry2.js";import"./clipboard-list-DFQ0FIuz.js";import"./mail-90vIR3DR.js";import"./message-square-CX7YOG1_.js";import"./panel-left-CTsZEDb1.js";import"./index-CNFw1Ir9.js";import"./RovingFocusItem-DMi8O4UB.js";import"./utils-BPCrnLP_.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DkZoOMWj.js";import"./layers-pQFBzKpy.js";import"./zap-Cc0BOOh8.js";import"./trending-up-DeV7oG7t.js";import"./award-CWSQdkXs.js";import"./hash-DkWh4k-j.js";import"./index-CQnwGDQF.js";import"./search-O0A-BZfi.js";import"./useKbd-kRIii9yh.js";import"./VisuallyHiddenInput-BNvE1J5w.js";import"./useEtiquetaHierarchy-BqffPyXS.js";import"./list-qRqibYdd.js";import"./tree-pine-IsnOkU_Z.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BIhG3axg.js";import"./useToast-BF2rZyo9.js";import"./dollar-sign-BNspGz_G.js";import"./ellipsis-DeI8oXfl.js";import"./eye-qulbvIrl.js";import"./copy-DqkZVKYE.js";import"./useArrowNavigation-B5rxJs06.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-XT45oHWh.js";import"./pen-Dqie5IPd.js";import"./calendar-days-CxtENExk.js";import"./es-BDPlFIsO.js";function Ze(){const s=I(!1),u=I(null);async function N(h,m){return s.value=!0,u.value=null,new Promise((x,w)=>{E.post(`/admin/proyectos/${h}/etiquetas`,{etiqueta_id:m},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{s.value=!1,x(!0)},onError:_=>{s.value=!1,u.value=Object.values(_).join(", "),w(_)}})})}async function b(h,m){return s.value=!0,u.value=null,new Promise((x,w)=>{E.delete(`/admin/proyectos/${h}/etiquetas/${m}`,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{s.value=!1,x(!0)},onError:_=>{s.value=!1,u.value="Error al quitar la etiqueta",w(_)}})})}async function $(h,m){return s.value=!0,u.value=null,new Promise((x,w)=>{E.put(`/admin/proyectos/${h}/etiquetas/sync`,{etiquetas:m},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{s.value=!1,x(!0)},onError:_=>{s.value=!1,u.value="Error al sincronizar etiquetas",w(_)}})})}async function p(h){s.value=!0,u.value=null;try{const m=await fetch(`/admin/proyectos/${h}/etiquetas/suggest`);if(!m.ok)throw new Error("Error al obtener sugerencias");const x=await m.json();return s.value=!1,x.etiquetas||[]}catch(m){return s.value=!1,u.value="Error al obtener sugerencias de etiquetas",console.error(m),[]}}async function k(h){var m;s.value=!0,u.value=null;try{const x=await fetch("/admin/etiquetas",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.getAttribute("content"))||""},body:JSON.stringify(h)});if(!x.ok){const _=await x.json();throw new Error(_.message||"Error al crear etiqueta")}const w=await x.json();return s.value=!1,w.data}catch(x){return s.value=!1,u.value=x.message||"Error al crear etiqueta",console.error(x),null}}async function S(h){if(h.length<2)return[];try{const m=await fetch(`/admin/etiquetas/search?q=${encodeURIComponent(h)}`);if(!m.ok)throw new Error("Error al buscar etiquetas");return(await m.json()).data||[]}catch(m){return console.error("Error buscando etiquetas:",m),[]}}function K(h){const m=new Map;return h.forEach(x=>{var _;const w=((_=x.categoria)==null?void 0:_.nombre)||"Sin categoría";m.has(w)||m.set(w,[]),m.get(w).push(x)}),m}function X(h){var m;return h.color||((m=h.categoria)==null?void 0:m.color)||"gray"}function Q(h,m=10){return h<m}async function W(h,m){return s.value=!0,u.value=null,new Promise((x,w)=>{E.post(`/admin/proyectos/${h}/etiquetas/reorder`,{etiquetas:m},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{s.value=!1,x(!0)},onError:_=>{s.value=!1,u.value="Error al reordenar etiquetas",w(_)}})})}return{isLoading:s,error:u,addEtiquetaToProyecto:N,removeEtiquetaFromProyecto:b,syncEtiquetasProyecto:$,getSugerenciasEtiquetas:p,reorderEtiquetas:W,createEtiqueta:k,searchEtiquetas:S,groupEtiquetasByCategoria:K,getEtiquetaColor:X,canAddMoreEtiquetas:Q}}const et={key:0,class:"flex items-center gap-2"},tt={key:0,class:"mb-6"},at={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},st={class:"text-center"},ot={class:"text-2xl font-bold"},rt={class:"text-center"},lt={class:"text-2xl font-bold text-blue-500"},it={class:"text-center"},nt={class:"text-2xl font-bold text-green-500"},dt={class:"text-center"},ct={class:"space-y-2"},ut={class:"flex justify-between items-center text-sm"},mt={class:"font-medium"},ft={key:1,class:"space-y-4"},yt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},gt={key:2,class:"text-center py-6"},pt={class:"text-muted-foreground mb-3"},vt=ce({__name:"HitosGrid",props:{hitos:{},proyectoId:{},proyectoNombre:{},estadisticas:{},showStats:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0},showViewAll:{type:Boolean,default:!0},maxHitos:{default:void 0},canCreate:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},emptyMessage:{default:"No hay hitos definidos para este proyecto"}},emits:["view","edit","delete","duplicate","add-entregable","view-entregables"],setup(s){const u=s,N=R(()=>u.maxHitos&&u.maxHitos>0?u.hitos.slice(0,u.maxHitos):u.hitos),b=R(()=>u.maxHitos&&u.hitos.length>u.maxHitos);return($,p)=>(l(),y(e(C),null,{default:o(()=>[s.showHeader?(l(),y(e(P),{key:0,class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[r("div",null,[a(e(V),{class:"flex items-center gap-2"},{default:o(()=>[a(e(te),{class:"h-5 w-5"}),p[0]||(p[0]=d(" Hitos y Entregables ",-1))]),_:1}),s.proyectoNombre?(l(),y(e(ee),{key:0},{default:o(()=>[d(c(s.proyectoNombre),1)]),_:1})):v("",!0)]),s.showActions?(l(),g("div",et,[s.showViewAll&&s.hitos.length>0?(l(),y(e(T),{key:0,href:`/admin/proyectos/${s.proyectoId}/hitos`},{default:o(()=>[a(e(H),{variant:"outline",size:"sm"},{default:o(()=>[a(e(Ne),{class:"h-4 w-4 mr-2"}),p[1]||(p[1]=d(" Ver Todos ",-1))]),_:1})]),_:1},8,["href"])):v("",!0),s.canCreate?(l(),y(e(T),{key:1,href:`/admin/proyectos/${s.proyectoId}/hitos/create`},{default:o(()=>[a(e(H),{size:"sm"},{default:o(()=>[a(e(J),{class:"h-4 w-4 mr-2"}),p[2]||(p[2]=d(" Nuevo Hito ",-1))]),_:1})]),_:1},8,["href"])):v("",!0)])):v("",!0)]),_:1})):v("",!0),a(e(q),null,{default:o(()=>[s.showStats&&s.estadisticas&&s.estadisticas.total>0?(l(),g("div",tt,[r("div",at,[r("div",st,[r("p",ot,c(s.estadisticas.total),1),p[3]||(p[3]=r("p",{class:"text-xs text-muted-foreground"},"Total Hitos",-1))]),r("div",rt,[r("p",lt,c(s.estadisticas.en_progreso),1),p[4]||(p[4]=r("p",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),r("div",it,[r("p",nt,c(s.estadisticas.completados),1),p[5]||(p[5]=r("p",{class:"text-xs text-muted-foreground"},"Completados",-1))]),r("div",dt,[r("p",{class:O(["text-2xl font-bold",{"text-red-500":s.estadisticas.vencidos>0}])},c(s.estadisticas.vencidos),3),p[6]||(p[6]=r("p",{class:"text-xs text-muted-foreground"},"Vencidos",-1))])]),r("div",ct,[r("div",ut,[p[7]||(p[7]=r("span",{class:"text-muted-foreground"},"Progreso General",-1)),r("span",mt,c(s.estadisticas.progreso_general)+"%",1)]),a(e(ue),{value:s.estadisticas.progreso_general,class:"h-2"},null,8,["value"])])])):v("",!0),s.hitos.length>0?(l(),g("div",ft,[r("div",yt,[(l(!0),g(M,null,z(N.value,k=>(l(),y(ze,{key:k.id,hito:k,canEdit:s.canEdit,canDelete:s.canDelete,canManageDeliverables:s.canManageDeliverables,showActions:!0,onView:S=>$.$emit("view",k),onEdit:S=>$.$emit("edit",k),onDelete:S=>$.$emit("delete",k),onDuplicate:S=>$.$emit("duplicate",k),onAddEntregable:S=>$.$emit("add-entregable",k),onViewEntregables:S=>$.$emit("view-entregables",k)},null,8,["hito","canEdit","canDelete","canManageDeliverables","onView","onEdit","onDelete","onDuplicate","onAddEntregable","onViewEntregables"]))),128))]),b.value?(l(),y(e(T),{key:0,href:`/admin/proyectos/${s.proyectoId}/hitos`,class:"block text-center mt-4 text-sm text-primary hover:underline"},{default:o(()=>[d(" Ver todos los hitos ("+c(s.hitos.length)+") ",1)]),_:1},8,["href"])):v("",!0)])):(l(),g("div",gt,[a(e(te),{class:"h-10 w-10 mx-auto text-muted-foreground mb-3"}),r("p",pt,c(s.emptyMessage),1),s.canCreate?(l(),y(e(T),{key:0,href:`/admin/proyectos/${s.proyectoId}/hitos/create`},{default:o(()=>[a(e(H),{variant:"outline",size:"sm"},{default:o(()=>[a(e(J),{class:"h-4 w-4 mr-2"}),p[8]||(p[8]=d(" Crear Primer Hito ",-1))]),_:1})]),_:1},8,["href"])):v("",!0)]))]),_:1})]),_:1}))}}),xt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ht={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},bt={class:"text-2xl font-bold text-gray-900 dark:text-white"},wt={key:0,class:"mt-2 text-gray-600 dark:text-gray-400"},_t={class:"flex gap-2"},$t={class:"flex items-center justify-between"},Et={class:"flex items-center gap-3"},kt={class:"flex items-center gap-3"},qt={class:"space-y-2"},Ct={class:"flex justify-between text-sm"},St={class:"font-medium"},Ht={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2"},Dt={class:"flex items-start gap-3"},Pt={class:"font-medium"},Vt={class:"text-xs text-gray-500"},Tt={key:0,class:"flex items-start gap-3"},Bt={class:"font-medium"},jt={class:"text-xs text-gray-500"},At={key:0,class:"flex items-center gap-3 pt-2"},Mt={class:"font-medium ml-2"},Nt={key:0},zt={key:1,class:"text-sm text-muted-foreground"},It={key:1,class:"space-y-4"},Ft={class:"flex gap-2"},Lt={class:"space-y-4"},Ut={class:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},Ot={class:"text-gray-900 dark:text-gray-100"},Rt={key:0,class:"flex items-center gap-3"},Gt={class:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Jt={class:"font-medium"},Kt={class:"text-sm text-gray-500"},Xt={key:1,class:"text-gray-500"},Qt={class:"font-mono"},Wt={class:"font-medium"},Yt={class:"text-sm"},Zt={class:"text-sm"},ea={class:"space-y-3"},ta={class:"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},aa={class:"flex-1"},sa={class:"text-sm"},oa={class:"font-medium"},ra={class:"text-xs text-gray-500 mt-1"},la={key:0,class:"flex justify-end"},ia={class:"space-y-4"},na={class:"text-center"},da={key:1},ca={class:"flex items-center justify-between w-full pr-4"},ua={class:"flex items-center gap-3"},ma={class:"text-left"},fa={class:"font-semibold"},ya={class:"text-sm text-gray-500"},ga={class:"flex items-center gap-3"},pa={class:"text-sm text-gray-600"},va={class:"text-sm"},xa=["href"],ha={class:"text-center"},ba={class:"text-center"},wa={key:0,class:"space-y-4"},_a={class:"flex-1"},$a={class:"text-sm"},Ea={class:"font-medium"},ka={class:"text-xs text-muted-foreground mt-1"},qa={key:1,class:"text-sm text-muted-foreground text-center py-8"},yo=ce({__name:"Show",props:{proyecto:{},categorias:{},activities:{},totales:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canManageTags:{type:Boolean},canViewContracts:{type:Boolean},canCreateContracts:{type:Boolean},canViewHitos:{type:Boolean},canCreateHitos:{type:Boolean},canEditHitos:{type:Boolean},canDeleteHitos:{type:Boolean},canManageEntregables:{type:Boolean},estadisticasHitos:{}},setup(s){const u=s,N=I("general"),b=I({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null}),$=I(!1),p=I([]),{syncEtiquetasProyecto:k,isLoading:S}=Ze();u.proyecto.etiquetas&&(p.value=u.proyecto.etiquetas.map(n=>n.id));const K=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:u.proyecto.nombre,href:`/admin/proyectos/${u.proyecto.id}`}],X=()=>{confirm(`¿Estás seguro de eliminar el proyecto "${u.proyecto.nombre}"?`)&&E.delete(`/admin/proyectos/${u.proyecto.id}`,{onSuccess:()=>{B.success("Proyecto eliminado exitosamente")},onError:()=>{B.error("Error al eliminar el proyecto")}})},Q=n=>({planificacion:te,en_progreso:We,pausado:Oe,completado:Qe,cancelado:Ue})[n]||Ye,W=n=>({planificacion:"bg-blue-100 text-blue-800",en_progreso:"bg-yellow-100 text-yellow-800",pausado:"bg-orange-100 text-orange-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",h=n=>({baja:"bg-gray-100 text-gray-800",media:"bg-blue-100 text-blue-800",alta:"bg-orange-100 text-orange-800",critica:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",m=n=>new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),x=n=>{const t=Math.floor((new Date(n).getTime()-new Date().getTime())/864e5);return t===0?"Hoy":t===1?"Mañana":t===-1?"Ayer":t>0?`En ${t} días`:`Hace ${Math.abs(t)} días`},w=async()=>{try{await k(u.proyecto.id,p.value),$.value=!1,B.success("Etiquetas actualizadas exitosamente"),E.reload({only:["proyecto"]})}catch{B.error("Error al actualizar las etiquetas")}},_=()=>{var n;p.value=((n=u.proyecto.etiquetas)==null?void 0:n.map(t=>t.id))||[],$.value=!1},me=n=>{E.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${n.id}`)},fe=n=>{E.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${n.id}/edit`)},ye=n=>{confirm(`¿Estás seguro de eliminar el hito "${n.nombre}"? Se eliminarán también todos sus entregables.`)&&E.delete(`/admin/proyectos/${u.proyecto.id}/hitos/${n.id}`,{onSuccess:()=>{B.success("Hito eliminado exitosamente"),E.reload({only:["proyecto"]})},onError:()=>{B.error("Error al eliminar el hito")}})},ge=n=>{E.post(`/admin/proyectos/${u.proyecto.id}/hitos/${n.id}/duplicar`,{},{onSuccess:()=>{B.success("Hito duplicado exitosamente"),E.reload({only:["proyecto"]})},onError:()=>{B.error("Error al duplicar el hito")}})},pe=n=>{E.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${n.id}/entregables/create`)},ve=n=>{E.visit(`/admin/proyectos/${u.proyecto.id}/hitos/${n.id}/entregables`)},G=R(()=>{const n=[];return u.proyecto.contratos&&u.proyecto.contratos.forEach(t=>{t.obligaciones&&t.obligaciones.forEach(i=>{i.evidencias&&i.evidencias.forEach(f=>{n.push({...f,contrato_id:t.id,contrato_numero:t.numero_contrato,contrato_nombre:t.nombre,obligacion_titulo:i.titulo,_contrato:t})})})}),n}),xe=R(()=>{let n=G.value;return b.value.contrato_id&&(n=n.filter(t=>t.contrato_id===b.value.contrato_id)),b.value.tipo&&(n=n.filter(t=>t.tipo_evidencia===b.value.tipo)),b.value.estado&&(n=n.filter(t=>t.estado===b.value.estado)),b.value.usuario_id&&(n=n.filter(t=>{var i;return((i=t.usuario)==null?void 0:i.id)===b.value.usuario_id})),(b.value.fecha_inicio||b.value.fecha_fin)&&(n=n.filter(t=>{const i=new Date(t.created_at);if(b.value.fecha_inicio){const f=new Date(b.value.fecha_inicio);if(i<f)return!1}if(b.value.fecha_fin){const f=new Date(b.value.fecha_fin);if(f.setHours(23,59,59,999),i>f)return!1}return!0})),n}),ae=R(()=>{const n={};return xe.value.forEach(t=>{n[t.contrato_id]||(n[t.contrato_id]={contrato:t._contrato,evidencias:[]}),n[t.contrato_id].evidencias.push(t)}),Object.values(n)});return(n,t)=>(l(),g(M,null,[a(e(he),{title:`Proyecto: ${s.proyecto.nombre}`},null,8,["title"]),a(we,{breadcrumbs:K},{default:o(()=>[r("div",xt,[r("div",ht,[r("div",null,[r("h1",bt,c(s.proyecto.nombre),1),s.proyecto.descripcion?(l(),g("p",wt,c(s.proyecto.descripcion),1)):v("",!0)]),r("div",_t,[s.canEdit?(l(),y(e(T),{key:0,href:`/admin/proyectos/${s.proyecto.id}/edit`},{default:o(()=>[a(e(H),null,{default:o(()=>[a(e(ie),{class:"mr-2 h-4 w-4"}),t[6]||(t[6]=d(" Editar ",-1))]),_:1})]),_:1},8,["href"])):v("",!0),s.canDelete?(l(),y(e(H),{key:1,variant:"destructive",onClick:X},{default:o(()=>[a(e(Ie),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=d(" Eliminar ",-1))]),_:1})):v("",!0)])]),a(e(_e),{modelValue:N.value,"onUpdate:modelValue":t[5]||(t[5]=i=>N.value=i),class:"w-full"},{default:o(()=>[a(e($e),{class:"grid w-full grid-cols-5"},{default:o(()=>[a(e(L),{value:"general"},{default:o(()=>[a(e(Fe),{class:"mr-2 h-4 w-4"}),t[8]||(t[8]=d(" General ",-1))]),_:1}),a(e(L),{value:"contratos"},{default:o(()=>{var i;return[a(e(Y),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=d(" Contratos ",-1)),(i=s.totales)!=null&&i.contratos?(l(),y(e(D),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:o(()=>[d(c(s.totales.contratos),1)]),_:1})):v("",!0)]}),_:1}),a(e(L),{value:"hitos"},{default:o(()=>{var i;return[a(e(Le),{class:"mr-2 h-4 w-4"}),t[10]||(t[10]=d(" Hitos y Entregables ",-1)),(i=s.totales)!=null&&i.hitos?(l(),y(e(D),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:o(()=>[d(c(s.totales.hitos),1)]),_:1})):v("",!0)]}),_:1}),a(e(L),{value:"evidencias"},{default:o(()=>{var i;return[a(e(Z),{class:"mr-2 h-4 w-4"}),t[11]||(t[11]=d(" Evidencias ",-1)),(i=s.totales)!=null&&i.evidencias?(l(),y(e(D),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:o(()=>[d(c(s.totales.evidencias),1)]),_:1})):v("",!0)]}),_:1}),a(e(L),{value:"actividad"},{default:o(()=>[a(e(Re),{class:"mr-2 h-4 w-4"}),t[12]||(t[12]=d(" Actividad ",-1))]),_:1})]),_:1}),a(e(U),{value:"general",class:"space-y-4 mt-6"},{default:o(()=>[a(e(C),null,{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(V),null,{default:o(()=>[...t[13]||(t[13]=[d("Estado del Proyecto",-1)])]),_:1})]),_:1}),a(e(q),{class:"space-y-4"},{default:o(()=>[r("div",$t,[r("div",Et,[(l(),y(be(Q(s.proyecto.estado)),{class:"h-5 w-5 text-gray-500"})),t[14]||(t[14]=r("span",{class:"font-medium"},"Estado:",-1)),a(e(D),{class:O(W(s.proyecto.estado))},{default:o(()=>[d(c(s.proyecto.estado_label),1)]),_:1},8,["class"])]),r("div",kt,[a(e(Ge),{class:"h-5 w-5 text-gray-500"}),t[15]||(t[15]=r("span",{class:"font-medium"},"Prioridad:",-1)),a(e(D),{class:O(h(s.proyecto.prioridad))},{default:o(()=>[d(c(s.proyecto.prioridad_label),1)]),_:1},8,["class"])])]),r("div",qt,[r("div",Ct,[t[16]||(t[16]=r("span",{class:"text-gray-600 dark:text-gray-400"},"Progreso",-1)),r("span",St,c(s.proyecto.porcentaje_completado)+"%",1)]),a(e(ue),{value:s.proyecto.porcentaje_completado,class:"h-2"},null,8,["value"])]),r("div",Ht,[r("div",Dt,[a(e(ne),{class:"h-5 w-5 text-gray-500 mt-0.5"}),r("div",null,[t[17]||(t[17]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de inicio",-1)),r("p",Pt,c(m(s.proyecto.fecha_inicio)),1),r("p",Vt,c(x(s.proyecto.fecha_inicio)),1)])]),s.proyecto.fecha_fin?(l(),g("div",Tt,[a(e(ne),{class:"h-5 w-5 text-gray-500 mt-0.5"}),r("div",null,[t[18]||(t[18]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de fin",-1)),r("p",Bt,c(m(s.proyecto.fecha_fin)),1),r("p",jt,c(x(s.proyecto.fecha_fin)),1)])])):v("",!0)]),s.proyecto.duracion_dias?(l(),g("div",At,[a(e(Je),{class:"h-5 w-5 text-gray-500"}),r("div",null,[t[19]||(t[19]=r("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Duración total:",-1)),r("span",Mt,c(s.proyecto.duracion_dias)+" días",1)])])):v("",!0)]),_:1})]),_:1}),a(e(C),null,{default:o(()=>[a(e(P),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[a(e(V),null,{default:o(()=>[...t[20]||(t[20]=[d(" Etiquetas ",-1)])]),_:1}),s.canManageTags&&!$.value?(l(),y(e(H),{key:0,variant:"ghost",size:"sm",onClick:t[0]||(t[0]=i=>$.value=!0)},{default:o(()=>[a(e(ie),{class:"h-4 w-4"})]),_:1})):v("",!0)]),_:1}),a(e(q),null,{default:o(()=>[$.value?(l(),g("div",It,[s.categorias?(l(),y(Pe,{key:0,modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=i=>p.value=i),categorias:s.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas...",description:"Selecciona hasta 10 etiquetas para este proyecto"},null,8,["modelValue","categorias"])):v("",!0),r("div",Ft,[a(e(H),{size:"sm",onClick:w,disabled:e(S)},{default:o(()=>[...t[21]||(t[21]=[d(" Guardar ",-1)])]),_:1},8,["disabled"]),a(e(H),{size:"sm",variant:"outline",onClick:_,disabled:e(S)},{default:o(()=>[...t[22]||(t[22]=[d(" Cancelar ",-1)])]),_:1},8,["disabled"])])])):(l(),g("div",Nt,[s.proyecto.etiquetas&&s.proyecto.etiquetas.length>0?(l(),y(De,{key:0,etiquetas:s.proyecto.etiquetas,"show-categoria":!0,interactive:!0,size:"md"},null,8,["etiquetas"])):(l(),g("p",zt," No hay etiquetas asignadas "))]))]),_:1})]),_:1}),s.proyecto.campos_personalizados&&s.proyecto.campos_personalizados.length>0?(l(),y(e(C),{key:0},{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(V),null,{default:o(()=>[...t[23]||(t[23]=[d("Campos Personalizados",-1)])]),_:1})]),_:1}),a(e(q),null,{default:o(()=>[r("div",Lt,[(l(!0),g(M,null,z(s.proyecto.campos_personalizados,i=>{var f;return l(),g("div",{key:i.id,class:"py-2 border-b last:border-b-0"},[r("p",Ut,c((f=i.campo_personalizado)==null?void 0:f.nombre),1),r("p",Ot,c(i.valor_formateado||i.valor||"-"),1)])}),128))])]),_:1})]),_:1})):v("",!0),a(e(C),null,{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(V),null,{default:o(()=>[...t[24]||(t[24]=[d("Responsable",-1)])]),_:1})]),_:1}),a(e(q),null,{default:o(()=>[s.proyecto.responsable?(l(),g("div",Rt,[r("div",Gt,[a(e(de),{class:"h-5 w-5 text-gray-500"})]),r("div",null,[r("p",Jt,c(s.proyecto.responsable.name),1),r("p",Kt,c(s.proyecto.responsable.email),1)])])):(l(),g("p",Xt,"Sin asignar"))]),_:1})]),_:1}),a(e(C),null,{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(V),null,{default:o(()=>[...t[25]||(t[25]=[d("Información del Sistema",-1)])]),_:1})]),_:1}),a(e(q),{class:"space-y-3"},{default:o(()=>{var i;return[r("div",null,[t[26]||(t[26]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"ID del Proyecto",-1)),r("p",Qt,"#"+c(s.proyecto.id),1)]),r("div",null,[t[27]||(t[27]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado",-1)),a(e(D),{class:O(s.proyecto.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800")},{default:o(()=>[d(c(s.proyecto.activo?"Activo":"Inactivo"),1)]),_:1},8,["class"])]),r("div",null,[t[28]||(t[28]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Creado por",-1)),r("p",Wt,c(((i=s.proyecto.creador)==null?void 0:i.name)||"Sistema"),1)]),r("div",null,[t[29]||(t[29]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Fecha de creación",-1)),r("p",Yt,c(m(s.proyecto.created_at)),1)]),r("div",null,[t[30]||(t[30]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Última actualización",-1)),r("p",Zt,c(m(s.proyecto.updated_at)),1)])]}),_:1})]),_:1}),s.proyecto.activities&&s.proyecto.activities.length>0?(l(),y(e(C),{key:1},{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(V),null,{default:o(()=>[...t[31]||(t[31]=[d("Actividad Reciente",-1)])]),_:1})]),_:1}),a(e(q),null,{default:o(()=>[r("div",ea,[(l(!0),g(M,null,z(s.proyecto.activities,i=>{var f;return l(),g("div",{key:i.id,class:"flex items-start gap-3 pb-3 border-b last:border-b-0"},[r("div",ta,[a(e(de),{class:"h-4 w-4 text-gray-500"})]),r("div",aa,[r("p",sa,[r("span",oa,c(((f=i.causer)==null?void 0:f.name)||"Sistema"),1),d(" "+c(i.description),1)]),r("p",ra,c(x(i.created_at)),1)])])}),128))])]),_:1})]),_:1})):v("",!0)]),_:1}),a(e(U),{value:"contratos",class:"space-y-4 mt-6"},{default:o(()=>[s.canCreateContracts?(l(),g("div",la,[a(e(T),{href:`/admin/contratos/create?proyecto_id=${s.proyecto.id}`},{default:o(()=>[a(e(H),null,{default:o(()=>[a(e(J),{class:"mr-2 h-4 w-4"}),t[32]||(t[32]=d(" Nuevo Contrato ",-1))]),_:1})]),_:1},8,["href"])])):v("",!0),s.proyecto.contratos&&s.proyecto.contratos.length>0?(l(),y(e(C),{key:1},{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(V),null,{default:o(()=>[...t[33]||(t[33]=[d("Contratos del Proyecto",-1)])]),_:1}),a(e(ee),null,{default:o(()=>[...t[34]||(t[34]=[d(" Lista de contratos asociados a este proyecto ",-1)])]),_:1})]),_:1}),a(e(q),null,{default:o(()=>[r("div",ia,[a(Ve,{contratos:s.proyecto.contratos,"show-proyecto":!1,"show-actions":!0,"actions-style":"buttons"},null,8,["contratos"])])]),_:1})]),_:1})):(l(),y(e(C),{key:2},{default:o(()=>[a(e(q),{class:"py-8"},{default:o(()=>[r("div",na,[a(e(Y),{class:"mx-auto h-12 w-12 text-gray-400"}),t[36]||(t[36]=r("p",{class:"mt-2 text-sm text-gray-600"},"No hay contratos asociados",-1)),s.canCreateContracts?(l(),y(e(T),{key:0,href:`/admin/contratos/create?proyecto_id=${s.proyecto.id}`,class:"mt-4 inline-block"},{default:o(()=>[a(e(H),{variant:"outline"},{default:o(()=>[a(e(J),{class:"mr-2 h-4 w-4"}),t[35]||(t[35]=d(" Crear primer contrato ",-1))]),_:1})]),_:1},8,["href"])):v("",!0)])]),_:1})]),_:1}))]),_:1}),a(e(U),{value:"hitos",class:"space-y-4 mt-6"},{default:o(()=>[s.canViewHitos?(l(),y(vt,{key:0,hitos:s.proyecto.hitos||[],"proyecto-id":s.proyecto.id,estadisticas:s.estadisticasHitos,"show-stats":!0,"show-header":!0,"show-actions":!0,"show-view-all":!0,"can-create":s.canCreateHitos,"can-edit":s.canEditHitos,"can-delete":s.canDeleteHitos,"can-manage-deliverables":s.canManageEntregables,"empty-message":"No hay hitos definidos para este proyecto",onView:me,onEdit:fe,onDelete:ye,onDuplicate:ge,onAddEntregable:pe,onViewEntregables:ve},null,8,["hitos","proyecto-id","estadisticas","can-create","can-edit","can-delete","can-manage-deliverables"])):v("",!0)]),_:1}),a(e(U),{value:"evidencias",class:"space-y-4 mt-6"},{default:o(()=>[G.value.length>0?(l(),y(Te,{key:0,modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=i=>b.value=i),contratos:s.proyecto.contratos||[],evidencias:G.value},null,8,["modelValue","contratos","evidencias"])):v("",!0),ae.value.length>0?(l(),g("div",da,[a(e(Be),{type:"multiple",class:"space-y-4",collapsible:""},{default:o(()=>[(l(!0),g(M,null,z(ae.value,i=>(l(),y(e(je),{key:i.contrato.id,value:`contrato-${i.contrato.id}`,class:"border rounded-lg bg-card"},{default:o(()=>[a(e(Ae),{class:"px-4 py-3 hover:no-underline hover:bg-gray-50 dark:hover:bg-gray-800 rounded-t-lg"},{default:o(()=>[r("div",ca,[r("div",ua,[a(e(Y),{class:"h-5 w-5 text-gray-500"}),r("div",ma,[r("div",fa,c(i.contrato.nombre),1),r("div",ya,c(i.contrato.numero_contrato||"Sin número"),1)])]),r("div",ga,[a(e(D),{variant:"secondary"},{default:o(()=>[d(c(i.evidencias.length)+" evidencia(s) ",1)]),_:2},1024),a(e(T),{href:`/admin/contratos/${i.contrato.id}`,onClick:t[3]||(t[3]=re(()=>{},["stop"])),class:"text-blue-600 hover:text-blue-800 flex items-center gap-1"},{default:o(()=>[t[37]||(t[37]=d(" Ver contrato ",-1)),a(e(Ke),{class:"h-3 w-3"})]),_:1},8,["href"])])])]),_:2},1024),a(e(Me),{class:"px-4 pb-4"},{default:o(()=>[a(e(Ee),null,{default:o(()=>[a(e(ke),null,{default:o(()=>[a(e(le),null,{default:o(()=>[a(e(j),null,{default:o(()=>[...t[38]||(t[38]=[d("Tipo",-1)])]),_:1}),a(e(j),null,{default:o(()=>[...t[39]||(t[39]=[d("Obligación",-1)])]),_:1}),a(e(j),null,{default:o(()=>[...t[40]||(t[40]=[d("Descripción",-1)])]),_:1}),a(e(j),null,{default:o(()=>[...t[41]||(t[41]=[d("Usuario",-1)])]),_:1}),a(e(j),null,{default:o(()=>[...t[42]||(t[42]=[d("Estado",-1)])]),_:1}),a(e(j),null,{default:o(()=>[...t[43]||(t[43]=[d("Fecha",-1)])]),_:1}),a(e(j),{class:"text-right"},{default:o(()=>[...t[44]||(t[44]=[d("Acciones",-1)])]),_:1})]),_:1})]),_:1}),a(e(qe),null,{default:o(()=>[(l(!0),g(M,null,z(i.evidencias,f=>(l(),y(e(le),{key:f.id,class:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800"},{default:o(()=>[a(e(T),{href:`/admin/contratos/${f.contrato_id}/evidencias/${f.id}`,class:"contents"},{default:o(()=>[a(e(A),null,{default:o(()=>[a(e(D),{variant:"outline"},{default:o(()=>[d(c(f.tipo_evidencia),1)]),_:2},1024)]),_:2},1024),a(e(A),null,{default:o(()=>[d(c(f.obligacion_titulo),1)]),_:2},1024),a(e(A),null,{default:o(()=>[r("span",pa,c(f.descripcion||"-"),1)]),_:2},1024),a(e(A),null,{default:o(()=>{var F;return[r("span",va,c(((F=f.usuario)==null?void 0:F.name)||"-"),1)]}),_:2},1024),a(e(A),null,{default:o(()=>[a(e(D),{class:O({"bg-yellow-100 text-yellow-800":f.estado==="pendiente","bg-green-100 text-green-800":f.estado==="aprobada","bg-red-100 text-red-800":f.estado==="rechazada"})},{default:o(()=>[d(c(f.estado),1)]),_:2},1032,["class"])]),_:2},1024),a(e(A),null,{default:o(()=>[d(c(m(f.created_at)),1)]),_:2},1024),a(e(A),{class:"text-right"},{default:o(()=>[f.archivo_url?(l(),g("a",{key:0,href:f.archivo_url,target:"_blank",class:"inline-flex items-center text-blue-600 hover:text-blue-800",onClick:t[4]||(t[4]=re(()=>{},["stop"]))},[a(e(Xe),{class:"h-4 w-4"})],8,xa)):v("",!0)]),_:2},1024)]),_:2},1032,["href"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})])):G.value.length===0?(l(),y(e(C),{key:2},{default:o(()=>[a(e(q),{class:"py-8"},{default:o(()=>[r("div",ha,[a(e(Z),{class:"mx-auto h-12 w-12 text-gray-400"}),t[45]||(t[45]=r("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias cargadas",-1)),t[46]||(t[46]=r("p",{class:"text-xs text-gray-500 mt-1"},"Las evidencias se cargan desde los contratos",-1))])]),_:1})]),_:1})):(l(),y(e(C),{key:3},{default:o(()=>[a(e(q),{class:"py-8"},{default:o(()=>[r("div",ba,[a(e(Z),{class:"mx-auto h-12 w-12 text-gray-400"}),t[47]||(t[47]=r("p",{class:"mt-2 text-sm text-gray-600"},"No hay evidencias que coincidan con los filtros",-1)),t[48]||(t[48]=r("p",{class:"text-xs text-gray-500 mt-1"},"Intenta ajustar los criterios de búsqueda",-1))])]),_:1})]),_:1}))]),_:1}),a(e(U),{value:"actividad",class:"space-y-4 mt-6"},{default:o(()=>[a(e(C),null,{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(V),null,{default:o(()=>[...t[49]||(t[49]=[d("Historial de Actividad",-1)])]),_:1}),a(e(ee),null,{default:o(()=>[...t[50]||(t[50]=[d(" Registro completo de cambios y eventos del proyecto ",-1)])]),_:1})]),_:1}),a(e(q),null,{default:o(()=>[s.activities&&s.activities.length>0?(l(),g("div",wa,[(l(!0),g(M,null,z(s.activities,i=>{var f;return l(),g("div",{key:i.id,class:"flex gap-3 pb-4 border-b last:border-0"},[a(e(Ce),{class:"h-8 w-8"},{default:o(()=>{var F;return[(F=i.causer)!=null&&F.avatar?(l(),y(e(Se),{key:0,src:i.causer.avatar},null,8,["src"])):v("",!0),a(e(He),null,{default:o(()=>{var se,oe;return[d(c(((oe=(se=i.causer)==null?void 0:se.name)==null?void 0:oe.substring(0,2).toUpperCase())||"SI"),1)]}),_:2},1024)]}),_:2},1024),r("div",_a,[r("p",$a,[r("span",Ea,c(((f=i.causer)==null?void 0:f.name)||"Sistema"),1),d(" "+c(i.description),1)]),r("p",ka,c(x(i.created_at)),1)])])}),128))])):(l(),g("p",qa," No hay actividad registrada "))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})],64))}});export{yo as default};
