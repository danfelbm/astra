import{j as V,_ as g,a as C,b as k,c as y,F,r as da,i as ra}from"./AppLayout.vue_vue_type_script_setup_true_lang-RX7NkelO.js";import{_ as w}from"./AppLogo.vue_vue_type_script_setup_true_lang-BQXwVSd7.js";import{_ as j}from"./CardDescription.vue_vue_type_script_setup_true_lang-D8wHHSJn.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-BI0SyXeG.js";import{_ as ua,a as ma,b as T,c as W}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-jp9wKSvT.js";import{_ as ca}from"./Textarea.vue_vue_type_script_setup_true_lang-DziO9uLo.js";import{d as fa,C as pa,k as X,c as x,a as u,o as r,b as e,u as o,m as _a,e as s,f as t,j as b,i as f,W as va,g as n,t as d,n as h,l as G,F as R,r as P}from"./app--mCHh5ou.js";import{A as ba}from"./arrow-left-DCBguFEH.js";import{U as B}from"./user-Dh3yYRiW.js";import{S as M}from"./send-DwY3iyNQ.js";import{C as U}from"./clock-B50ftV1g.js";import{C as q}from"./circle-check-big-t4xlK_gH.js";import{C as I}from"./circle-x-g7ruS3fr.js";import{S as D}from"./square-pen-ClXEiQU9.js";import{M as ga}from"./message-square-BygTF_DN.js";import{H as ya}from"./history-DJltSvKp.js";import"./index-CIMxs0fY.js";import"./VisuallyHidden-B6T02AYu.js";import"./RovingFocusItem-Dtayco11.js";const xa={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Ca={class:"space-y-6"},ka={class:"flex items-center justify-between"},wa={class:"space-y-1"},$a={class:"flex items-center gap-2"},ha={class:"text-3xl font-bold tracking-tight"},Aa={class:"text-muted-foreground"},Ea={class:"grid gap-6 md:grid-cols-2"},Fa={class:"font-medium"},za={class:"font-medium"},Na={class:"font-medium"},Sa={class:"font-medium"},Va={class:"font-medium"},ja={class:"font-medium"},Ra={class:"font-medium"},Pa={class:"font-medium"},Ba={key:0,class:"text-center py-8 text-muted-foreground"},Ma={key:1,class:"space-y-4"},Ua={key:0,class:"font-medium mt-1"},qa={key:1,class:"font-medium mt-1"},Ia={key:1,class:"space-y-4"},Da={class:"grid grid-cols-2 gap-4"},Ha={class:"font-medium"},La={class:"font-medium"},Oa={class:"font-medium"},Ta={class:"font-medium"},Wa={class:"space-y-4"},Xa={class:"font-medium mt-1"},Ga={key:0,class:"flex flex-wrap gap-2"},Ja={key:1,class:"space-y-4"},Ka={class:"flex items-center gap-2 p-3 bg-muted rounded-lg"},Qa={class:"text-sm"},Ya={key:0,class:"text-sm text-red-600 mt-1"},Za={class:"flex gap-2"},ao={key:0},oo={class:"font-medium"},eo={class:"text-sm text-muted-foreground"},so={key:1},to={class:"font-medium"},lo={class:"space-y-4"},no={key:0,class:"absolute left-6 top-12 w-px h-full bg-border"},io={class:"flex-1 min-w-0"},ro={class:"flex items-center gap-2 mb-1"},uo={class:"flex items-center justify-between mb-2"},mo={class:"text-sm font-medium"},co={class:"text-xs text-muted-foreground"},fo={class:"space-y-2"},po={class:"flex items-center gap-2 text-sm"},_o={class:"font-medium"},vo={class:"text-muted-foreground"},bo={key:0,class:"text-sm"},go={class:"mt-1 p-2 bg-muted rounded text-sm"},Uo=fa({__name:"Show",props:{postulacion:{}},setup(J){const p=J,K=[{title:"Admin",href:"/admin/dashboard"},{title:"Postulaciones",href:"/admin/postulaciones"},{title:`${p.postulacion.usuario.name}`,href:`/admin/postulaciones/${p.postulacion.id}`}],_=pa({estado:"",comentarios:""}),z=X(!1),N=X(""),Q=l=>{switch(l){case"borrador":return D;case"enviada":return M;case"en_revision":return U;case"aceptada":return q;case"rechazada":return I;default:return F}},H=x(()=>{const l={};for(const[a,i]of Object.entries(p.postulacion.formulario_data)){const c=p.postulacion.convocatoria.formulario_postulacion.find(v=>v.id===a);c&&(l[c.title]=Array.isArray(i)?i.join(", "):i)}return l}),$=x(()=>{var a,i,c,v,E,S,O;if(!p.postulacion.candidatura_snapshot)return null;const l=p.postulacion.candidatura_snapshot;return{usuario:((a=l.usuario)==null?void 0:a.name)||"N/A",version:((i=l.candidatura)==null?void 0:i.version_original)||"N/A",fecha_aprobacion:((c=l.candidatura)==null?void 0:c.fecha_aprobacion)||"N/A",aprobado_por:((E=(v=l.candidatura)==null?void 0:v.aprobado_por)==null?void 0:E.name)||"N/A",formulario_data:((S=l.candidatura)==null?void 0:S.formulario_data)||{},configuracion_campos:((O=l.configuracion_en_momento)==null?void 0:O.campos)||[]}}),Y=x(()=>{if(!$.value)return{};const l={},{formulario_data:a,configuracion_campos:i}=$.value;for(const[c,v]of Object.entries(a)){const E=i.find(S=>S.id===c);E&&(l[E.title]=Array.isArray(v)?v.join(", "):v)}return l}),A=l=>{N.value=l,_.estado=l,_.comentarios="",z.value=!0},Z=()=>{_.post(`/admin/postulaciones/${p.postulacion.id}/cambiar-estado`,{onSuccess:()=>{z.value=!1}})},aa=()=>{z.value=!1,N.value="",_.reset()},oa=x(()=>["borrador","enviada","rechazada"].includes(p.postulacion.estado)),ea=x(()=>["enviada","en_revision"].includes(p.postulacion.estado)),sa=x(()=>["enviada","en_revision"].includes(p.postulacion.estado)),ta=x(()=>["enviada","en_revision","aceptada","rechazada"].includes(p.postulacion.estado)),la=x(()=>p.postulacion.estado==="borrador"),na=l=>({enviada:"Enviada",en_revision:"En Revisión",aceptada:"Aceptada",rechazada:"Rechazada",borrador:"Borrador"})[l]||l,L=x(()=>["rechazada"].includes(N.value)),ia=l=>({CheckCircle:q,XCircle:I,Clock:U,Send:M,Edit:D,FileText:F})[l]||F;return(l,a)=>(r(),u(R,null,[e(o(_a),{title:`Postulación de ${l.postulacion.usuario.name}`},null,8,["title"]),e(ra,{breadcrumbs:K},{default:s(()=>[t("div",xa,[t("div",Ca,[t("div",ka,[t("div",wa,[t("div",$a,[e(o(w),{variant:"ghost",size:"sm",onClick:a[0]||(a[0]=i=>o(va).get("/admin/postulaciones"))},{default:s(()=>[e(o(ba),{class:"h-4 w-4 mr-2"}),a[7]||(a[7]=n(" Volver "))]),_:1})]),t("h1",ha," Postulación de "+d(l.postulacion.usuario.name),1),t("p",Aa,d(l.postulacion.convocatoria.nombre),1)]),e(o(V),{class:h([l.postulacion.estado_color,"text-base px-3 py-1"])},{default:s(()=>[(r(),b(G(Q(l.postulacion.estado)),{class:"mr-2 h-4 w-4"})),n(" "+d(l.postulacion.estado_label),1)]),_:1},8,["class"])]),t("div",Ea,[e(o(g),null,{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),{class:"flex items-center gap-2"},{default:s(()=>[e(o(B),{class:"h-5 w-5"}),a[8]||(a[8]=n(" Información del Usuario "))]),_:1})]),_:1}),e(o(y),{class:"space-y-3"},{default:s(()=>[t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[9]||(a[9]=[n("Nombre:")])),_:1}),t("p",Fa,d(l.postulacion.usuario.name),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[10]||(a[10]=[n("Email:")])),_:1}),t("p",za,d(l.postulacion.usuario.email),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[11]||(a[11]=[n("Fecha postulación:")])),_:1}),t("p",Na,d(l.postulacion.fecha_postulacion||"Borrador"),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[12]||(a[12]=[n("Fecha creación:")])),_:1}),t("p",Sa,d(l.postulacion.created_at),1)])]),_:1})]),_:1}),e(o(g),null,{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),{class:"flex items-center gap-2"},{default:s(()=>[e(o(F),{class:"h-5 w-5"}),a[13]||(a[13]=n(" Convocatoria "))]),_:1})]),_:1}),e(o(y),{class:"space-y-3"},{default:s(()=>[t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[14]||(a[14]=[n("Nombre:")])),_:1}),t("p",Va,d(l.postulacion.convocatoria.nombre),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[15]||(a[15]=[n("Cargo:")])),_:1}),t("p",ja,d(l.postulacion.convocatoria.cargo),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[16]||(a[16]=[n("Periodo:")])),_:1}),t("p",Ra,d(l.postulacion.convocatoria.periodo),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[17]||(a[17]=[n("Ubicación:")])),_:1}),t("p",Pa,d(l.postulacion.convocatoria.ubicacion),1)])]),_:1})]),_:1})]),e(o(ua),{"default-value":"formulario",class:"space-y-4"},{default:s(()=>[e(o(ma),{class:"grid w-full grid-cols-2"},{default:s(()=>[e(o(T),{value:"formulario"},{default:s(()=>a[18]||(a[18]=[n(" Respuestas del Formulario ")])),_:1}),e(o(T),{value:"candidatura",disabled:!l.postulacion.tiene_candidatura_vinculada},{default:s(()=>[a[20]||(a[20]=n(" Perfil de Candidatura ")),l.postulacion.tiene_candidatura_vinculada?(r(),b(o(V),{key:0,variant:"secondary",class:"ml-2"},{default:s(()=>a[19]||(a[19]=[n(" Vinculado ")])),_:1})):f("",!0)]),_:1},8,["disabled"])]),_:1}),e(o(W),{value:"formulario",class:"space-y-4"},{default:s(()=>[e(o(g),null,{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),null,{default:s(()=>a[21]||(a[21]=[n("Respuestas del Formulario de Postulación")])),_:1}),e(o(j),null,{default:s(()=>a[22]||(a[22]=[n(" Respuestas proporcionadas por el usuario en el formulario de postulación. ")])),_:1})]),_:1}),e(o(y),null,{default:s(()=>[Object.keys(H.value).length===0?(r(),u("div",Ba,[e(o(F),{class:"mx-auto h-12 w-12 mb-2"}),a[23]||(a[23]=t("p",null,"No hay respuestas del formulario disponibles.",-1))])):(r(),u("div",Ma,[(r(!0),u(R,null,P(H.value,(i,c)=>(r(),u("div",{key:c,class:"border rounded-lg p-4"},[e(o(m),{class:"text-muted-foreground"},{default:s(()=>[n(d(c)+":",1)]),_:2},1024),typeof i=="string"&&i.length>100?(r(),u("p",Ua,d(i),1)):(r(),u("p",qa,d(i||"Sin respuesta"),1))]))),128))]))]),_:1})]),_:1})]),_:1}),e(o(W),{value:"candidatura",class:"space-y-4"},{default:s(()=>[l.postulacion.tiene_candidatura_vinculada?(r(),u("div",Ia,[e(o(g),null,{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),null,{default:s(()=>a[25]||(a[25]=[n("Información del Perfil de Candidatura")])),_:1})]),_:1}),e(o(y),{class:"space-y-3"},{default:s(()=>[t("div",Da,[t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[26]||(a[26]=[n("Usuario:")])),_:1}),t("p",Ha,d($.value.usuario),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[27]||(a[27]=[n("Versión:")])),_:1}),t("p",La,"v"+d($.value.version),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[28]||(a[28]=[n("Fecha aprobación:")])),_:1}),t("p",Oa,d($.value.fecha_aprobacion),1)]),t("div",null,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[29]||(a[29]=[n("Aprobado por:")])),_:1}),t("p",Ta,d($.value.aprobado_por),1)])])]),_:1})]),_:1}),e(o(g),null,{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),null,{default:s(()=>a[30]||(a[30]=[n("Datos del Perfil de Candidatura")])),_:1}),e(o(j),null,{default:s(()=>a[31]||(a[31]=[n(" Información capturada del perfil de candidatura en el momento de la postulación. ")])),_:1})]),_:1}),e(o(y),null,{default:s(()=>[t("div",Wa,[(r(!0),u(R,null,P(Y.value,(i,c)=>(r(),u("div",{key:c,class:"border rounded-lg p-4"},[e(o(m),{class:"text-muted-foreground"},{default:s(()=>[n(d(c)+":",1)]),_:2},1024),t("p",Xa,d(i||"Sin información"),1)]))),128))])]),_:1})]),_:1})])):(r(),b(o(g),{key:0},{default:s(()=>[e(o(y),{class:"text-center py-8"},{default:s(()=>[e(o(B),{class:"mx-auto h-12 w-12 text-muted-foreground mb-2"}),a[24]||(a[24]=t("p",{class:"text-muted-foreground"},"No hay perfil de candidatura vinculado a esta postulación.",-1))]),_:1})]),_:1}))]),_:1})]),_:1}),e(o(g),null,{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),null,{default:s(()=>a[32]||(a[32]=[n("Gestión de Estado")])),_:1}),e(o(j),null,{default:s(()=>a[33]||(a[33]=[n(" Cambia el estado de la postulación según el flujo de revisión. ")])),_:1})]),_:1}),e(o(y),null,{default:s(()=>[z.value?(r(),u("div",Ja,[t("div",Ka,[e(o(da),{class:"h-5 w-5 text-amber-600"}),t("p",Qa,[a[39]||(a[39]=n(" ¿Estás seguro de que quieres cambiar el estado a ")),t("strong",null,d(na(N.value)),1),a[40]||(a[40]=n("? "))])]),t("div",null,[e(o(m),{for:"comentarios"},{default:s(()=>[n(" Comentarios "+d(L.value?"(requerido)":"(opcional)"),1)]),_:1}),e(o(ca),{id:"comentarios",modelValue:o(_).comentarios,"onUpdate:modelValue":a[6]||(a[6]=i=>o(_).comentarios=i),placeholder:L.value?"Explica el motivo del rechazo...":"Comentarios adicionales...",rows:"3",class:h([o(_).errors.comentarios?"border-red-300":""])},null,8,["modelValue","placeholder","class"]),o(_).errors.comentarios?(r(),u("p",Ya,d(o(_).errors.comentarios),1)):f("",!0)]),t("div",Za,[e(o(w),{onClick:Z,disabled:o(_).processing},{default:s(()=>a[41]||(a[41]=[n(" Confirmar Cambio ")])),_:1},8,["disabled"]),e(o(w),{variant:"outline",onClick:aa,disabled:o(_).processing},{default:s(()=>a[42]||(a[42]=[n(" Cancelar ")])),_:1},8,["disabled"])])])):(r(),u("div",Ga,[la.value?(r(),b(o(w),{key:0,variant:"outline",onClick:a[1]||(a[1]=i=>A("enviada"))},{default:s(()=>[e(o(M),{class:"mr-2 h-4 w-4"}),a[34]||(a[34]=n(" Marcar como Enviada "))]),_:1})):f("",!0),oa.value?(r(),b(o(w),{key:1,variant:"outline",onClick:a[2]||(a[2]=i=>A("en_revision"))},{default:s(()=>[e(o(U),{class:"mr-2 h-4 w-4"}),a[35]||(a[35]=n(" Marcar en Revisión "))]),_:1})):f("",!0),ea.value?(r(),b(o(w),{key:2,onClick:a[3]||(a[3]=i=>A("aceptada"))},{default:s(()=>[e(o(q),{class:"mr-2 h-4 w-4"}),a[36]||(a[36]=n(" Aceptar "))]),_:1})):f("",!0),sa.value?(r(),b(o(w),{key:3,variant:"destructive",onClick:a[4]||(a[4]=i=>A("rechazada"))},{default:s(()=>[e(o(I),{class:"mr-2 h-4 w-4"}),a[37]||(a[37]=n(" Rechazar "))]),_:1})):f("",!0),ta.value?(r(),b(o(w),{key:4,variant:"outline",onClick:a[5]||(a[5]=i=>A("borrador"))},{default:s(()=>[e(o(D),{class:"mr-2 h-4 w-4"}),a[38]||(a[38]=n(" Volver a Borrador "))]),_:1})):f("",!0)]))]),_:1})]),_:1}),l.postulacion.revisado_por||l.postulacion.comentarios_admin?(r(),b(o(g),{key:0},{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),{class:"flex items-center gap-2"},{default:s(()=>[e(o(ga),{class:"h-5 w-5"}),a[43]||(a[43]=n(" Información de Revisión "))]),_:1})]),_:1}),e(o(y),{class:"space-y-3"},{default:s(()=>[l.postulacion.revisado_por?(r(),u("div",ao,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[44]||(a[44]=[n("Revisado por:")])),_:1}),t("p",oo,d(l.postulacion.revisado_por.name),1),t("p",eo,d(l.postulacion.fecha_revision),1)])):f("",!0),l.postulacion.comentarios_admin?(r(),u("div",so,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[45]||(a[45]=[n("Comentarios:")])),_:1}),t("p",to,d(l.postulacion.comentarios_admin),1)])):f("",!0)]),_:1})]),_:1})):f("",!0),l.postulacion.historial&&l.postulacion.historial.length>0?(r(),b(o(g),{key:1},{default:s(()=>[e(o(C),null,{default:s(()=>[e(o(k),{class:"flex items-center gap-2"},{default:s(()=>[e(o(ya),{class:"h-5 w-5"}),a[46]||(a[46]=n(" Historial de Cambios "))]),_:1}),e(o(j),null,{default:s(()=>a[47]||(a[47]=[n(" Cronología completa de todos los cambios de estado de esta postulación. ")])),_:1})]),_:1}),e(o(y),null,{default:s(()=>[t("div",lo,[(r(!0),u(R,null,P(l.postulacion.historial,(i,c)=>{var v;return r(),u("div",{key:i.id,class:h(["relative flex items-start gap-4 pb-4",{"border-b border-border":c<l.postulacion.historial.length-1}])},[c<l.postulacion.historial.length-1?(r(),u("div",no)):f("",!0),t("div",{class:h(["flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",[i.tipo_cambio==="positivo"?"bg-green-100 text-green-600":i.tipo_cambio==="negativo"?"bg-red-100 text-red-600":i.tipo_cambio==="progreso"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"]])},[(r(),b(G(ia(i.tipo_cambio_icon)),{class:"w-5 h-5"}))],2),t("div",io,[t("div",ro,[e(o(V),{class:h([i.estado_anterior_color,"text-xs"])},{default:s(()=>[n(d(i.estado_anterior_label),1)]),_:2},1032,["class"]),a[48]||(a[48]=t("span",{class:"text-muted-foreground text-sm"},"→",-1)),e(o(V),{class:h([i.estado_nuevo_color,"text-xs"])},{default:s(()=>[n(d(i.estado_nuevo_label),1)]),_:2},1032,["class"])]),t("div",uo,[t("h4",mo,d(i.motivo_cambio||"Cambio de estado"),1),t("span",co,d(i.tiempo_pasado),1)]),t("div",fo,[t("div",po,[e(o(B),{class:"w-4 h-4 text-muted-foreground"}),a[49]||(a[49]=t("span",{class:"text-muted-foreground"},"Por:",-1)),t("span",_o,d(((v=i.cambiado_por)==null?void 0:v.name)||"Usuario eliminado"),1),t("span",vo," • "+d(i.fecha_cambio),1)]),i.comentarios?(r(),u("div",bo,[e(o(m),{class:"text-muted-foreground"},{default:s(()=>a[50]||(a[50]=[n("Comentarios:")])),_:1}),t("p",go,d(i.comentarios),1)])):f("",!0)])])],2)}),128))])]),_:1})]),_:1})):f("",!0)])])]),_:1})],64))}});export{Uo as default};
