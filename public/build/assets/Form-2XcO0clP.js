import{d as ee,c as V,u as oe,r as ae,p as B,i as n,e as s,f as e,q as se,w as t,g as r,t as c,h as d,l as te,j as v,n as g,m as p,F as C,k,b as le,s as re}from"./app-y4isNqXm.js";import{_ as ie}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BvSka-gx.js";import{_ as w,a as I,b as R,c as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dadbzwfh.js";import{_ as $}from"./createLucideIcon-mCVR8rL0.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-BKHyNrqK.js";import{_ as de}from"./Textarea.vue_vue_type_script_setup_true_lang-DL3CrHUA.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-CC4rd9kP.js";import{_ as G}from"./Switch.vue_vue_type_script_setup_true_lang-B7Oys8bJ.js";import{_ as pe,a as ne}from"./index-Dps3Wpmu.js";import{_ as me}from"./Checkbox.vue_vue_type_script_setup_true_lang-BvofcSrr.js";import{_ as ue,a as ce,b as fe,c as _e,d as ve}from"./SelectValue.vue_vue_type_script_setup_true_lang-BUdvrEJT.js";import{t as q}from"./index-C9YznISG.js";import{C as xe}from"./circle-alert-Ddoyjw3_.js";import{T as be}from"./trash-2-BoTHZSgE.js";import{P as ge}from"./plus-CUf-YtBc.js";import{X as ye}from"./x-D_E1k7_n.js";import{S as Ve}from"./save-CiJ3T2Jj.js";import"./useFlashMessages-FTGjIqdP.js";import"./index-C2MoGcR6.js";import"./floating-ui.vue-xdvz-kq7.js";import"./index-B9qYd8OT.js";import"./shield-DWoLTuqf.js";import"./user-C_FJcT-g.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-6vX9ZX1T.js";import"./chevron-right-bINHmwj6.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-C8Rk8AiP.js";import"./VisuallyHidden-DJswMYCp.js";import"./index-CcU3hycU.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CNb--sGY.js";import"./map-pin-DcjZ8yWx.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-CBpBOOKh.js";import"./chevrons-up-down-EHQTTQnX.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-i_DNMnhz.js";import"./folder-DV0e_XpO.js";import"./users-TaqwL9Hf.js";import"./target-Cwu941VC.js";import"./vote-BE31yCSr.js";import"./folder-open-CR778kJc.js";import"./send-CMlKMa8p.js";import"./file-text-D6v7F4kd.js";import"./briefcase-CGik1Ys4.js";import"./calendar-VmbXhbGS.js";import"./megaphone-DZTXB9Yd.js";import"./user-check-C1eQjWhi.js";import"./clipboard-list-2XROZaCh.js";import"./mail-Mb4dvj7E.js";import"./message-square-rXQT8F_4.js";import"./external-link-CByLedJd.js";import"./panel-left-50tlwzCJ.js";import"./index-DRJ3k44r.js";import"./check-6I8478aV.js";import"./index-XQn911Vk.js";import"./VisuallyHiddenInput-BXSfD9RT.js";const Ce={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},$e={class:"flex items-center justify-between"},he={class:"text-2xl font-bold text-gray-900 dark:text-white"},ke={key:0,class:"mt-1 text-sm text-red-600"},we={key:0,class:"mt-1 text-sm text-red-600"},ze={key:0,class:"mt-1 text-sm text-red-600"},qe={key:0,class:"mt-1 text-sm text-red-600"},Ue={key:0,class:"mt-1 text-xs text-gray-500"},Ee={key:1,class:"mt-1 text-sm text-red-600"},Pe={key:0},je={class:"space-y-2"},Se={key:0,class:"mt-1 text-sm text-red-600"},Te={class:"space-y-2"},Ae={key:0,class:"mt-1 text-sm text-red-600"},Ne={key:0,class:"mt-1 text-sm text-red-600"},Oe={class:"space-y-4"},De={class:"flex items-center justify-between"},Le={class:"space-y-0.5"},Fe={class:"flex items-center justify-between"},Be={class:"space-y-0.5"},Io=ee({__name:"Form",props:{campo:{},tiposCampo:{},tipos:{},entidadesDisponibles:{}},setup(H){var E,P,j,S,T,A,N,O,D,L,F;const i=H,f=V(()=>!!i.campo),M=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:"Campos Personalizados",href:"/admin/campos-personalizados"},{title:f.value?`Editar: ${(E=i.campo)==null?void 0:E.nombre}`:"Nuevo Campo",href:"#"}],a=oe({nombre:((P=i.campo)==null?void 0:P.nombre)||"",slug:((j=i.campo)==null?void 0:j.slug)||"",tipo:((S=i.campo)==null?void 0:S.tipo)||"text",opciones:((T=i.campo)==null?void 0:T.opciones)||[],es_requerido:((A=i.campo)==null?void 0:A.es_requerido)!==void 0?i.campo.es_requerido:!1,activo:((N=i.campo)==null?void 0:N.activo)!==void 0?i.campo.activo:!0,descripcion:((O=i.campo)==null?void 0:O.descripcion)||"",placeholder:((D=i.campo)==null?void 0:D.placeholder)||"",validacion:((L=i.campo)==null?void 0:L.validacion)||"",aplicar_para:((F=i.campo)==null?void 0:F.aplicar_para)||["proyectos"]}),X=V(()=>i.tiposCampo||i.tipos||{}),J=V(()=>i.entidadesDisponibles||{proyectos:"Proyectos",contratos:"Contratos",hitos:"Hitos",entregables:"Entregables"}),b=ae(!1);B(()=>a.nombre,m=>{!f.value&&m&&(a.slug=m.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""))});const h=V(()=>["select","radio"].includes(a.tipo)),U=()=>{a.opciones.push({value:"",label:""})},K=m=>{a.opciones.splice(m,1)};B(()=>a.tipo,(m,o)=>{!h.value&&a.opciones.length>0?a.opciones=[]:h.value&&a.opciones.length===0&&U()});const Q=m=>{const o=a.aplicar_para.indexOf(m);o===-1?a.aplicar_para.push(m):a.aplicar_para.splice(o,1),a.aplicar_para.length===0&&(a.aplicar_para=["proyectos"],q.warning('Debe seleccionar al menos una entidad. Se ha seleccionado "Proyectos" por defecto.'))},W=()=>{var l;b.value=!0;const m=f.value?`/admin/campos-personalizados/${(l=i.campo)==null?void 0:l.id}`:"/admin/campos-personalizados",o=f.value?"put":"post";a[o](m,{preserveScroll:!0,onSuccess:()=>{q.success(f.value?"Campo actualizado exitosamente":"Campo creado exitosamente")},onError:u=>{q.error("Error al guardar el campo"),console.error(u)},onFinish:()=>{b.value=!1}})},Y=()=>{re.visit("/admin/campos-personalizados")},Z=m=>({text:"min:3|max:255|alpha_dash",number:"numeric|min:0|max:1000",date:"date|after:today|before:2030-12-31",textarea:"min:10|max:5000",file:"mimes:pdf,doc,docx|max:10240"})[m]||"";return(m,o)=>(p(),n(C,null,[s(e(se),{title:f.value?"Editar Campo Personalizado":"Nuevo Campo Personalizado"},null,8,["title"]),s(ie,{breadcrumbs:M},{default:t(()=>[r("div",Ce,[r("div",$e,[r("h1",he,c(f.value?"Editar Campo Personalizado":"Nuevo Campo Personalizado"),1)]),s(e(pe),null,{default:t(()=>[s(e(xe),{class:"h-4 w-4"}),s(e(ne),null,{default:t(()=>[...o[8]||(o[8]=[d(" Los campos personalizados permiten agregar información adicional a los proyectos. Una vez creado, el campo estará disponible en todos los formularios de proyectos. ",-1)])]),_:1})]),_:1}),r("form",{onSubmit:te(W,["prevent"]),class:"space-y-6"},[s(e(w),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(R),null,{default:t(()=>[...o[9]||(o[9]=[d("Información del Campo",-1)])]),_:1})]),_:1}),s(e(z),{class:"space-y-4"},{default:t(()=>[r("div",null,[s(e(_),{for:"nombre"},{default:t(()=>[...o[10]||(o[10]=[d("Nombre del Campo *",-1)])]),_:1}),s(e(x),{id:"nombre",modelValue:e(a).nombre,"onUpdate:modelValue":o[0]||(o[0]=l=>e(a).nombre=l),type:"text",placeholder:"Ej: Presupuesto estimado",class:g({"border-red-500":e(a).errors.nombre}),required:""},null,8,["modelValue","class"]),e(a).errors.nombre?(p(),n("p",ke,c(e(a).errors.nombre),1)):v("",!0)]),r("div",null,[s(e(_),{for:"slug"},{default:t(()=>[...o[11]||(o[11]=[d("Identificador (slug) *",-1)])]),_:1}),s(e(x),{id:"slug",modelValue:e(a).slug,"onUpdate:modelValue":o[1]||(o[1]=l=>e(a).slug=l),type:"text",placeholder:"presupuesto_estimado",class:g({"border-red-500":e(a).errors.slug}),disabled:f.value,required:""},null,8,["modelValue","class","disabled"]),o[12]||(o[12]=r("p",{class:"mt-1 text-xs text-gray-500"}," Identificador único del campo. Solo letras minúsculas, números y guiones bajos. ",-1)),e(a).errors.slug?(p(),n("p",we,c(e(a).errors.slug),1)):v("",!0)]),r("div",null,[s(e(_),{for:"descripcion"},{default:t(()=>[...o[13]||(o[13]=[d("Descripción",-1)])]),_:1}),s(e(de),{id:"descripcion",modelValue:e(a).descripcion,"onUpdate:modelValue":o[2]||(o[2]=l=>e(a).descripcion=l),placeholder:"Texto de ayuda para el usuario",rows:"2",class:g({"border-red-500":e(a).errors.descripcion})},null,8,["modelValue","class"]),e(a).errors.descripcion?(p(),n("p",ze,c(e(a).errors.descripcion),1)):v("",!0)]),r("div",null,[s(e(_),{for:"placeholder"},{default:t(()=>[...o[14]||(o[14]=[d("Texto de Placeholder",-1)])]),_:1}),s(e(x),{id:"placeholder",modelValue:e(a).placeholder,"onUpdate:modelValue":o[3]||(o[3]=l=>e(a).placeholder=l),type:"text",placeholder:"Texto que aparece cuando el campo está vacío",class:g({"border-red-500":e(a).errors.placeholder})},null,8,["modelValue","class"]),e(a).errors.placeholder?(p(),n("p",qe,c(e(a).errors.placeholder),1)):v("",!0)])]),_:1})]),_:1}),s(e(w),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(R),null,{default:t(()=>[...o[15]||(o[15]=[d("Configuración",-1)])]),_:1})]),_:1}),s(e(z),{class:"space-y-4"},{default:t(()=>[r("div",null,[s(e(_),{for:"tipo"},{default:t(()=>[...o[16]||(o[16]=[d("Tipo de Campo *",-1)])]),_:1}),s(e(ue),{modelValue:e(a).tipo,"onUpdate:modelValue":o[4]||(o[4]=l=>e(a).tipo=l),disabled:f.value},{default:t(()=>[s(e(ce),null,{default:t(()=>[s(e(fe),{placeholder:"Seleccione el tipo"})]),_:1}),s(e(_e),null,{default:t(()=>[(p(!0),n(C,null,k(X.value,(l,u)=>(p(),le(e(ve),{key:u,value:u},{default:t(()=>[d(c(l),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),f.value?(p(),n("p",Ue," El tipo no puede ser modificado después de crear el campo. ")):v("",!0),e(a).errors.tipo?(p(),n("p",Ee,c(e(a).errors.tipo),1)):v("",!0)]),h.value?(p(),n("div",Pe,[s(e(_),null,{default:t(()=>[...o[17]||(o[17]=[d("Opciones *",-1)])]),_:1}),r("div",je,[(p(!0),n(C,null,k(e(a).opciones,(l,u)=>(p(),n("div",{key:u,class:"flex gap-2"},[s(e(x),{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,placeholder:"Valor",class:"w-1/3",required:""},null,8,["modelValue","onUpdate:modelValue"]),s(e(x),{modelValue:l.label,"onUpdate:modelValue":y=>l.label=y,placeholder:"Etiqueta",class:"flex-1",required:""},null,8,["modelValue","onUpdate:modelValue"]),s(e($),{type:"button",variant:"destructive",size:"sm",onClick:y=>K(u),disabled:e(a).opciones.length===1},{default:t(()=>[s(e(be),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])]))),128)),s(e($),{type:"button",variant:"outline",size:"sm",onClick:U},{default:t(()=>[s(e(ge),{class:"mr-2 h-4 w-4"}),o[18]||(o[18]=d(" Agregar Opción ",-1))]),_:1})]),e(a).errors.opciones?(p(),n("p",Se,c(e(a).errors.opciones),1)):v("",!0)])):v("",!0),r("div",null,[s(e(_),null,{default:t(()=>[...o[19]||(o[19]=[d("Aplicar a:",-1)])]),_:1}),r("div",Te,[(p(!0),n(C,null,k(J.value,(l,u)=>(p(),n("div",{key:u,class:"flex items-center space-x-2"},[s(e(me),{id:`aplicar_${u}`,checked:e(a).aplicar_para.includes(u),"onUpdate:checked":()=>Q(u)},null,8,["id","checked","onUpdate:checked"]),s(e(_),{for:`aplicar_${u}`,class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer"},{default:t(()=>[d(c(l),1)]),_:2},1032,["for"])]))),128))]),o[20]||(o[20]=r("p",{class:"mt-1 text-xs text-gray-500"}," Seleccione dónde estará disponible este campo personalizado. ",-1)),e(a).errors.aplicar_para?(p(),n("p",Ae,c(e(a).errors.aplicar_para),1)):v("",!0)]),r("div",null,[s(e(_),{for:"validacion"},{default:t(()=>[...o[21]||(o[21]=[d("Reglas de Validación (Laravel)",-1)])]),_:1}),s(e(x),{id:"validacion",modelValue:e(a).validacion,"onUpdate:modelValue":o[5]||(o[5]=l=>e(a).validacion=l),type:"text",placeholder:Z(e(a).tipo),class:g({"border-red-500":e(a).errors.validacion})},null,8,["modelValue","placeholder","class"]),o[22]||(o[22]=r("p",{class:"mt-1 text-xs text-gray-500"}," Opcional. Usa sintaxis de Laravel. Ej: min:3|max:255 ",-1)),e(a).errors.validacion?(p(),n("p",Ne,c(e(a).errors.validacion),1)):v("",!0)]),r("div",Oe,[r("div",De,[r("div",Le,[s(e(_),{for:"es_requerido"},{default:t(()=>[...o[23]||(o[23]=[d("Campo Requerido",-1)])]),_:1}),o[24]||(o[24]=r("p",{class:"text-xs text-gray-500"}," Los usuarios deberán completar este campo obligatoriamente ",-1))]),s(e(G),{id:"es_requerido",modelValue:e(a).es_requerido,"onUpdate:modelValue":o[6]||(o[6]=l=>e(a).es_requerido=l)},null,8,["modelValue"])]),r("div",Fe,[r("div",Be,[s(e(_),{for:"activo"},{default:t(()=>[...o[25]||(o[25]=[d("Campo Activo",-1)])]),_:1}),o[26]||(o[26]=r("p",{class:"text-xs text-gray-500"}," Solo los campos activos se muestran en los formularios ",-1))]),s(e(G),{id:"activo",modelValue:e(a).activo,"onUpdate:modelValue":o[7]||(o[7]=l=>e(a).activo=l)},null,8,["modelValue"])])])]),_:1})]),_:1}),s(e(w),null,{default:t(()=>[s(e(z),{class:"flex justify-end gap-4 pt-6"},{default:t(()=>[s(e($),{type:"button",variant:"outline",onClick:Y,disabled:b.value},{default:t(()=>[s(e(ye),{class:"mr-2 h-4 w-4"}),o[27]||(o[27]=d(" Cancelar ",-1))]),_:1},8,["disabled"]),s(e($),{type:"submit",disabled:b.value||e(a).processing},{default:t(()=>[s(e(Ve),{class:"mr-2 h-4 w-4"}),d(" "+c(b.value?"Guardando...":f.value?"Actualizar Campo":"Crear Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})],32)])]),_:1})],64))}});export{Io as default};
