import{d as J,r as S,c as Q,i as m,e as r,f as s,u as e,p as Y,w as i,g as t,h as l,R as Z,b as f,j as v,t as n,n as _,q as h,F as U,k as ee,W as j}from"./app-DcHtu5PF.js";import{_ as H}from"./index-DeA91-Vu.js";import{_ as q}from"./createLucideIcon-DhgT7x3q.js";import{_ as b,a as $,b as I,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-DFz5wHps.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-BWaHSkv0.js";import{_ as u}from"./Label.vue_vue_type_script_setup_true_lang-DDB_RGyg.js";import{_ as ae}from"./Separator.vue_vue_type_script_setup_true_lang-DKkgTWGM.js";import{_ as P,a as O}from"./index-Dgc-4c47.js";import{_ as se}from"./GuestLayout.vue_vue_type_script_setup_true_lang-CBL03EwJ.js";import{C as g}from"./circle-check-big-BOEWcwCa.js";import{C as w}from"./circle-x-D_w4sB4I.js";import{S as A}from"./shield-CAvKiF51.js";import{S as K}from"./search-SBeu3FKT.js";import{H as oe}from"./hash-Q1wbNT1Z.js";import{C as ie}from"./copy-DRCLLxSR.js";import{C as le}from"./clock-B-gSeg1O.js";import{T as ne}from"./triangle-alert-KFDpxzbv.js";import{E as re}from"./external-link-PwoOyyd4.js";import"./index-Bgs8vsaH.js";import"./index-BMEoWgMN.js";import"./floating-ui.vue-CfYLCvVf.js";import"./index-Ck8H1poN.js";import"./index-Cb9gtIic.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Bcdq74SI.js";const de={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ue={class:"text-center"},ce={class:"text-4xl font-bold flex items-center justify-center gap-3"},me={class:"space-y-4"},fe={class:"flex gap-2"},ve={key:0,class:"max-w-4xl mx-auto w-full space-y-6"},_e={class:"flex items-center gap-4"},pe={class:"flex-1"},ge={class:"space-y-4"},xe={class:"flex items-center gap-2"},ke={class:"text-xs font-mono bg-muted p-3 rounded flex-1 break-all"},he={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},be={class:"flex items-center gap-1"},ye={class:"flex items-center gap-1"},we={class:"flex items-center gap-1"},Ce={class:"flex items-center gap-1"},Ve={class:"space-y-4"},Te={key:0,class:"text-muted-foreground"},Se={class:"flex flex-wrap gap-4 text-sm"},$e={class:"flex items-center gap-2"},Ie={class:"flex items-center gap-2 text-muted-foreground"},qe={class:"space-y-6"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-6"},De={key:0},Ee={class:"font-medium"},Fe={class:"font-medium"},Le={key:1},Ne={class:"font-medium"},Be={class:"font-mono text-xs break-all bg-muted p-2 rounded"},Re={class:"space-y-6"},ze={class:"flex items-start justify-between"},Ue={class:"flex-1"},je={key:0,class:"text-red-500"},He={key:0,class:"text-sm text-muted-foreground mt-1"},Pe={class:"bg-muted/30 rounded-lg p-4"},Oe={class:"text-lg"},Ke={key:1,class:"max-w-2xl mx-auto text-center space-y-4"},We={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},Me={class:"text-center p-4"},Xe={class:"text-center p-4"},Ge={class:"text-center p-4"},ht=J({__name:"VerificarToken",props:{token:{},verification:{}},setup(W){const D=W,x=S(D.token||""),C=S(!1),o=S(D.verification||null),p=Q(()=>{if(!o.value)return null;const c=o.value;return c.is_valid?{icon:g,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",label:"VÁLIDO",description:"Token verificado criptográficamente"}:{icon:w,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"INVÁLIDO",description:c.error||"Token no válido o corrupto"}}),E=()=>{x.value.trim()&&(C.value=!0,j.get(`/verificar-token/${encodeURIComponent(x.value.trim())}`,{},{onFinish:()=>{C.value=!1}}))},V=c=>new Date(c).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),M=(c,a)=>!a&&a!==0?"Sin respuesta":c.type==="checkbox"?Array.isArray(a)&&a.length>0?a.join(", "):"Sin respuesta":a.toString(),T=S(!1),X=async()=>{var c;if((c=o.value)!=null&&c.token)try{await navigator.clipboard.writeText(o.value.token),T.value=!0,setTimeout(()=>{T.value=!1},2e3)}catch(a){console.error("Error al copiar token:",a)}},G=()=>{x.value="",o.value=null,j.get("/verificar-token")};return(c,a)=>(r(),m(U,null,[s(e(Y),{title:"Verificación de Tokens de Votación"}),s(se,{title:"Verificar Token",description:"Verifica la autenticidad de tokens de votación"},{default:i(()=>{var F,L;return[t("div",de,[t("div",ue,[t("h1",ce,[s(e(A),{class:"h-10 w-10 text-blue-600"}),a[1]||(a[1]=l(" Verificación de Tokens ",-1))]),a[2]||(a[2]=t("p",{class:"text-muted-foreground mt-2 max-w-2xl mx-auto"}," Verifica la autenticidad e integridad de cualquier token de votación de forma pública y anónima. Utiliza criptografía digital para garantizar que los votos no han sido alterados. ",-1))]),s(e(b),{class:"max-w-2xl mx-auto w-full"},{default:i(()=>[s(e($),null,{default:i(()=>[s(e(I),{class:"flex items-center gap-2"},{default:i(()=>[s(e(K),{class:"h-5 w-5"}),a[3]||(a[3]=l(" Buscar Token ",-1))]),_:1})]),_:1}),s(e(y),null,{default:i(()=>[t("div",me,[t("div",null,[s(e(u),{for:"token-input"},{default:i(()=>[...a[4]||(a[4]=[l("Token de Votación",-1)])]),_:1}),s(e(te),{id:"token-input",modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=d=>x.value=d),placeholder:"Pega aquí tu token de votación para verificar...",onKeyup:Z(E,["enter"]),class:"font-mono text-sm"},null,8,["modelValue"])]),t("div",fe,[s(e(q),{onClick:E,disabled:!x.value.trim()||C.value,class:"flex-1"},{default:i(()=>[s(e(K),{class:"mr-2 h-4 w-4"}),l(" "+n(C.value?"Verificando...":"Verificar Token"),1)]),_:1},8,["disabled"]),o.value?(r(),f(e(q),{key:0,onClick:G,variant:"outline"},{default:i(()=>[...a[5]||(a[5]=[l(" Limpiar ",-1)])]),_:1})):v("",!0)])])]),_:1})]),_:1}),o.value?(r(),m("div",ve,[s(e(b),{class:_([(F=p.value)==null?void 0:F.borderColor,(L=p.value)==null?void 0:L.bgColor])},{default:i(()=>[s(e(y),{class:"pt-6"},{default:i(()=>{var d,k,N,B,R,z;return[t("div",_e,[(r(),f(h((d=p.value)==null?void 0:d.icon),{class:_(["h-12 w-12",(k=p.value)==null?void 0:k.color])},null,8,["class"])),t("div",pe,[t("h2",{class:_(["text-2xl font-bold",(N=p.value)==null?void 0:N.color])},n((B=p.value)==null?void 0:B.label),3),t("p",{class:_(["text-sm",(R=p.value)==null?void 0:R.color])},n((z=p.value)==null?void 0:z.description),3)])])]}),_:1})]),_:1},8,["class"]),s(e(b),null,{default:i(()=>[s(e($),null,{default:i(()=>[s(e(I),{class:"flex items-center gap-2"},{default:i(()=>[s(e(oe),{class:"h-5 w-5"}),a[6]||(a[6]=l(" Información del Token ",-1))]),_:1})]),_:1}),s(e(y),null,{default:i(()=>[t("div",ge,[t("div",null,[s(e(u),{class:"text-sm font-medium text-muted-foreground"},{default:i(()=>[...a[7]||(a[7]=[l("Token",-1)])]),_:1}),t("div",xe,[t("p",ke,n(o.value.token),1),s(e(q),{variant:"outline",size:"sm",onClick:X,class:_({"bg-green-50 border-green-200":T.value})},{default:i(()=>[s(e(ie),{class:"h-4 w-4"}),l(" "+n(T.value?"Copiado!":"Copiar"),1)]),_:1},8,["class"])])]),t("div",he,[t("div",null,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[8]||(a[8]=[l("Formato",-1)])]),_:1}),t("div",be,[(r(),f(h(o.value.verification_details.format_valid?e(g):e(w)),{class:_(["h-4 w-4",o.value.verification_details.format_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.format_valid?"Válido":"Inválido"),1)])]),t("div",null,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[9]||(a[9]=[l("Firma Digital",-1)])]),_:1}),t("div",ye,[(r(),f(h(o.value.verification_details.signature_valid?e(g):e(w)),{class:_(["h-4 w-4",o.value.verification_details.signature_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.signature_valid?"Válida":"Inválida"),1)])]),t("div",null,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[10]||(a[10]=[l("Integridad",-1)])]),_:1}),t("div",we,[(r(),f(h(o.value.verification_details.hash_valid?e(g):e(w)),{class:_(["h-4 w-4",o.value.verification_details.hash_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.hash_valid?"Íntegro":"Alterado"),1)])]),t("div",null,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[11]||(a[11]=[l("Votación",-1)])]),_:1}),t("div",Ce,[(r(),f(h(o.value.verification_details.votacion_exists?e(g):e(w)),{class:_(["h-4 w-4",o.value.verification_details.votacion_exists?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(o.value.verification_details.votacion_exists?"Existe":"No existe"),1)])])])])]),_:1})]),_:1}),o.value.votacion?(r(),f(e(b),{key:0},{default:i(()=>[s(e($),null,{default:i(()=>[s(e(I),null,{default:i(()=>[l(n(o.value.votacion.titulo),1)]),_:1})]),_:1}),s(e(y),null,{default:i(()=>[t("div",Ve,[o.value.votacion.descripcion?(r(),m("p",Te,n(o.value.votacion.descripcion),1)):v("",!0),t("div",Se,[t("div",$e,[s(e(H),{variant:"outline"},{default:i(()=>[l(n(o.value.votacion.categoria),1)]),_:1})]),t("div",Ie,[s(e(le),{class:"h-4 w-4"}),l(" "+n(V(o.value.votacion.fecha_inicio))+" - "+n(V(o.value.votacion.fecha_fin)),1)])])])]),_:1})]),_:1})):v("",!0),o.value.vote_data&&o.value.votacion?(r(),f(e(b),{key:1},{default:i(()=>[s(e($),null,{default:i(()=>[s(e(I),{class:"flex items-center gap-2"},{default:i(()=>[s(e(g),{class:"h-5 w-5"}),a[12]||(a[12]=l(" Respuestas del Voto ",-1))]),_:1})]),_:1}),s(e(y),null,{default:i(()=>[t("div",qe,[t("div",Ae,[o.value.vote_data.urna_opened_at?(r(),m("div",De,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[13]||(a[13]=[l("Apertura de Urna",-1)])]),_:1}),t("p",Ee,n(V(o.value.vote_data.urna_opened_at)),1)])):v("",!0),t("div",null,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[14]||(a[14]=[l("Fecha del Voto",-1)])]),_:1}),t("p",Fe,n(V(o.value.vote_data.vote_created_at||o.value.vote_data.timestamp)),1)]),o.value.vote_data.tiempo_en_urna?(r(),m("div",Le,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[15]||(a[15]=[l("Tiempo en Urna",-1)])]),_:1}),t("p",Ne,n(o.value.vote_data.tiempo_en_urna.formato_legible||`${o.value.vote_data.tiempo_en_urna.minutos}:${String(o.value.vote_data.tiempo_en_urna.segundos).padStart(2,"0")}`),1)])):v("",!0),t("div",null,[s(e(u),{class:"text-muted-foreground"},{default:i(()=>[...a[16]||(a[16]=[l("Hash de Verificación",-1)])]),_:1}),t("p",Be,n(o.value.vote_data.vote_hash),1)])]),t("div",Re,[(r(!0),m(U,null,ee(o.value.votacion.formulario_config,(d,k)=>(r(),m("div",{key:d.id,class:"space-y-2"},[t("div",ze,[t("div",Ue,[s(e(u),{class:"text-base font-medium"},{default:i(()=>[l(n(k+1)+". "+n(d.title)+" ",1),d.required?(r(),m("span",je,"*")):v("",!0)]),_:2},1024),d.description?(r(),m("p",He,n(d.description),1)):v("",!0)]),s(e(H),{variant:"secondary",class:"ml-4"},{default:i(()=>[l(n(d.type==="text"?"Texto":d.type==="textarea"?"Texto largo":d.type==="select"?"Selección":d.type==="radio"?"Opción única":d.type==="checkbox"?"Múltiple":d.type),1)]),_:2},1024)]),t("div",Pe,[t("p",Oe,n(M(d,o.value.vote_data.respuestas[d.id])),1)]),k<o.value.votacion.formulario_config.length-1?(r(),f(e(ae),{key:0,class:"mt-6"})):v("",!0)]))),128))])])]),_:1})]),_:1})):v("",!0),s(e(P),null,{default:i(()=>[s(e(A),{class:"h-4 w-4"}),s(e(O),null,{default:i(()=>[...a[17]||(a[17]=[t("strong",null,"Verificación criptográfica:",-1),l(" Este token ha sido verificado usando criptografía digital RSA-2048 con SHA-256. La verificación confirma que el voto proviene del sistema oficial y no ha sido alterado. ",-1),t("br",null,null,-1),t("br",null,null,-1),t("strong",null,"Privacidad:",-1),l(" Esta verificación es completamente anónima. No se puede determinar la identidad del votante a partir de este token. ",-1)])]),_:1})]),_:1})])):(r(),m("div",Ke,[s(e(P),null,{default:i(()=>[s(e(ne),{class:"h-4 w-4"}),s(e(O),null,{default:i(()=>[...a[18]||(a[18]=[t("strong",null,"¿Cómo funciona?",-1),t("br",null,null,-1),l(" Cada voto genera un token firmado digitalmente que contiene las respuestas del formulario. Puedes verificar públicamente que tu voto fue procesado correctamente sin revelar tu identidad. ",-1)])]),_:1})]),_:1}),t("div",We,[t("div",Me,[s(e(A),{class:"h-8 w-8 text-blue-600 mx-auto mb-2"}),a[19]||(a[19]=t("h3",{class:"font-medium"},"Seguridad",-1)),a[20]||(a[20]=t("p",{class:"text-muted-foreground"},"Criptografía RSA-2048",-1))]),t("div",Xe,[s(e(g),{class:"h-8 w-8 text-green-600 mx-auto mb-2"}),a[21]||(a[21]=t("h3",{class:"font-medium"},"Verificable",-1)),a[22]||(a[22]=t("p",{class:"text-muted-foreground"},"Integridad garantizada",-1))]),t("div",Ge,[s(e(re),{class:"h-8 w-8 text-purple-600 mx-auto mb-2"}),a[23]||(a[23]=t("h3",{class:"font-medium"},"Público",-1)),a[24]||(a[24]=t("p",{class:"text-muted-foreground"},"Sin autenticación",-1))])])]))])]}),_:1})],64))}});export{ht as default};
