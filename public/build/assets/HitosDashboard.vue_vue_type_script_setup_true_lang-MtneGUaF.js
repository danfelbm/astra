import{r as W,p as Ce,c as J,d as Pe,i as w,g as c,j as _,F as Z,k as fe,e as l,f as o,w as r,h as C,b as P,m as u,x as ot,t as x,n as ee,l as $t,ai as rt,o as qa,B as Tn,Y as Ia,a1 as An,a as Ka,v as zt,y as Qa,s as Ta}from"./app-BzLc-tQg.js";import{g as Pn}from"./Input.vue_vue_type_script_setup_true_lang-DTRfhza_.js";import{_ as we,c as Ee,a as Se,b as $e}from"./CardTitle.vue_vue_type_script_setup_true_lang-CPz0xz5d.js";import{c as Ja,_ as K}from"./createLucideIcon-nkJGOa1V.js";import{_ as se}from"./index-Bo3A_0mn.js";import{_ as Bt}from"./Progress.vue_vue_type_script_setup_true_lang-BePWkOZL.js";import{_ as xt}from"./ScrollArea.vue_vue_type_script_setup_true_lang-Cfk-trNe.js";import{_ as On}from"./Separator.vue_vue_type_script_setup_true_lang-jeVfHHyG.js";import{C as xa,_ as Jt,a as Zt,b as ea,c as ta,d as dt}from"./SelectValue.vue_vue_type_script_setup_true_lang-Y0Qcgjp4.js";import{_ as Mn,a as Nn,b as Rn,c as Fn,d as Vn,e as zn,f as Bn,g as Hn}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CdwEzN9L.js";import{n as Un,d as jn,f as Ye,e as Xe}from"./es-BDPlFIsO.js";import{_ as Ln}from"./StatusChangeModal.vue_vue_type_script_setup_true_lang-C5DiwLHq.js";import{_ as Yn}from"./Switch.vue_vue_type_script_setup_true_lang-DGkXIEvx.js";import{_ as Xn}from"./Label.vue_vue_type_script_setup_true_lang-BjgtvCVB.js";import{L as Gn}from"./list-C-untRxk.js";import{L as Wn,c as Za}from"./useFlashMessages-Dw-HwlHg.js";import{C as lt}from"./circle-alert-Dq1mOb6f.js";import{C as Kt}from"./circle-x-D5FFP1Tg.js";import{C as Ie}from"./clock-DnGNqUb-.js";import{C as st}from"./circle-check-big-DY7Anyd5.js";import{C as en}from"./chevron-right-B34UR9y-.js";import{F as tn}from"./flag-CTqVSjCi.js";import{C as Ge}from"./calendar-CB0qFUZA.js";import{U as tt}from"./user-BFFvCTt8.js";import{E as Aa}from"./eye-Dop9EAD9.js";import{S as _t}from"./square-pen-DH-b2dhS.js";import{M as We}from"./message-square-CoIUUq4D.js";import{A as qe,_ as an,a as nn,b as qn,c as Kn}from"./EvidenciasTable.vue_vue_type_script_setup_true_lang-CrGK3cqI.js";import{U as ma}from"./users-Br0fZ1Es.js";import{T as on}from"./trash-2-BppAmH8-.js";import{F as at}from"./file-text-3ulixKQ0.js";import{_ as _a,a as wa,b as Oe,c as Me}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-CguuZwsB.js";import{e as ln,_ as sn,a as rn,b as Ht,c as Ut,d as dn}from"./DialogTitle.vue_vue_type_script_setup_true_lang-4wm8HRfm.js";import{_ as un,a as cn}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BUnuDXd3.js";import{_ as Be}from"./Skeleton.vue_vue_type_script_setup_true_lang-B8-WJZ_L.js";import{_ as fn}from"./CamposPersonalizadosDisplay.vue_vue_type_script_setup_true_lang-BGWxJ1b6.js";import{_ as mn}from"./ComentariosPanel.vue_vue_type_script_setup_true_lang-BkVcAdGe.js";import{T as ga,a as gn}from"./target-BO3Y90CO.js";import{R as pn}from"./refresh-cw-DB0fksvI.js";import{E as jt}from"./external-link-C60ZUVkZ.js";import{p as Lt}from"./parseISO-DFjB8F03.js";import{_ as Qn}from"./CardDescription.vue_vue_type_script_setup_true_lang-CFMLPjNz.js";import{_ as Pa,a as Oa,b as Ma}from"./index-D89T0Fcq.js";import{_ as Jn,a as Zn}from"./index-Cgvxw6QJ.js";import{I as aa}from"./image-Bt1ZNjeK.js";import{F as eo}from"./folder-open-BtqoHfmN.js";import{P as Na}from"./plus-DOx7i78g.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Ja("Columns3Icon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=Ja("ListTodoIcon",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);function ao(e,t,n){const[a,i]=Un(n==null?void 0:n.in,e,t),s=Ra(a,i),d=Math.abs(jn(a,i));a.setDate(a.getDate()-s*d);const m=+(Ra(a,i)===-s),v=s*(d-m);return v===0?0:v}function Ra(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}const ut={VIEW_MODE:"entregables-view-mode",CONFIRM_ON_DRAG:"entregables-confirm-drag"},gt={pendiente:{label:"Pendiente",color:"text-gray-800",bgColor:"bg-gray-100",dotColor:"bg-gray-400"},en_progreso:{label:"En Progreso",color:"text-blue-800",bgColor:"bg-blue-100",dotColor:"bg-blue-500"},completado:{label:"Completado",color:"text-green-800",bgColor:"bg-green-100",dotColor:"bg-green-500"},cancelado:{label:"Cancelado",color:"text-red-800",bgColor:"bg-red-100",dotColor:"bg-red-500"}},Ot={baja:{label:"Baja",color:"text-gray-600",bgColor:"bg-gray-100"},media:{label:"Media",color:"text-yellow-800",bgColor:"bg-yellow-100"},alta:{label:"Alta",color:"text-red-800",bgColor:"bg-red-100"}},pa=["pendiente","en_progreso","completado","cancelado"];function wt(e,t={}){const{defaultViewMode:n="list",defaultConfirmOnDrag:a=!0}=t,i=W(localStorage.getItem(ut.VIEW_MODE)||n),s=W(localStorage.getItem(ut.CONFIRM_ON_DRAG)!==null?localStorage.getItem(ut.CONFIRM_ON_DRAG)==="true":a);Ce(i,h=>{localStorage.setItem(ut.VIEW_MODE,h)}),Ce(s,h=>{localStorage.setItem(ut.CONFIRM_ON_DRAG,String(h))});const d=J(()=>({pendientes:e.value.filter(h=>h.estado==="pendiente"),en_progreso:e.value.filter(h=>h.estado==="en_progreso"),completados:e.value.filter(h=>h.estado==="completado"),cancelados:e.value.filter(h=>h.estado==="cancelado")}));return{viewMode:i,confirmOnDrag:s,entregablesAgrupados:d,getEstadoConfig:h=>gt[h]||gt.pendiente,getPrioridadConfig:h=>Ot[h]||Ot.baja,getEstadoColor:h=>{const I=gt[h];return I?`${I.bgColor} ${I.color}`:"bg-gray-100 text-gray-800"},getPrioridadColor:h=>{const I=Ot[h];return I?`${I.bgColor} ${I.color}`:"bg-gray-100 text-gray-600"},formatDate:h=>h?Ye(new Date(h),"dd MMM yyyy",{locale:Xe}):"Sin fecha",formatDateTime:h=>h?Ye(new Date(h),"dd MMM yyyy 'a las' HH:mm",{locale:Xe}):"-",getDiasRestantes:h=>{if(!h)return null;const I=Math.ceil((new Date(h).getTime()-new Date().getTime())/(1e3*60*60*24));return I<0?`Vencido hace ${Math.abs(I)} días`:I===0?"Vence hoy":I===1?"Vence mañana":`${I} días`},isVencido:(h,I)=>!h||I==="completado"||I==="cancelado"?!1:new Date(h)<new Date}}const no={class:"flex items-center justify-between gap-4 flex-wrap"},oo={class:"flex gap-1 bg-muted p-1 rounded-lg"},lo={class:"ml-1.5 hidden sm:inline text-xs"},so={key:0,class:"flex items-center gap-2"},io=Pe({__name:"HitosViewModeToggle",props:{modelValue:{},confirmOnDrag:{type:Boolean}},emits:["update:modelValue","update:confirmOnDrag"],setup(e,{emit:t}){const n=t,a=[{value:"list",icon:Gn,label:"Lista"},{value:"tabs",icon:Wn,label:"Tabs"},{value:"kanban",icon:to,label:"Kanban"}];return(i,s)=>(u(),w("div",no,[c("div",oo,[(u(),w(Z,null,fe(a,d=>l(o(K),{key:d.value,variant:e.modelValue===d.value?"default":"ghost",size:"sm",class:"h-8 px-3",title:d.label,onClick:m=>n("update:modelValue",d.value)},{default:r(()=>[(u(),P(ot(d.icon),{class:"h-4 w-4"})),c("span",lo,x(d.label),1)]),_:2},1032,["variant","title","onClick"])),64))]),e.modelValue==="kanban"?(u(),w("div",so,[l(o(Yn),{id:"confirm-drag","model-value":e.confirmOnDrag,"onUpdate:modelValue":s[0]||(s[0]=d=>n("update:confirmOnDrag",d))},null,8,["model-value"]),l(o(Xn),{for:"confirm-drag",class:"text-sm text-muted-foreground cursor-pointer"},{default:r(()=>[...s[1]||(s[1]=[C(" Confirmar al arrastrar ",-1)])]),_:1})])):_("",!0)]))}}),ro={class:"flex items-start gap-2"},uo={class:"flex-1 min-w-0"},co={class:"flex items-center gap-2 flex-wrap"},fo={key:0,class:"mt-1.5 flex items-center gap-2 text-xs text-muted-foreground"},mo={key:1,class:"flex items-center gap-1 truncate"},go={key:0,class:"flex gap-1 mt-2 pt-2 border-t"},po={key:0,class:"ml-1"},vo={key:1,class:"ml-8 mt-3 space-y-3"},ho={key:0,class:"text-sm text-muted-foreground"},bo={class:"flex flex-wrap gap-4 text-sm"},yo={class:"flex items-center gap-1 text-muted-foreground"},xo={key:0,class:"flex items-center gap-1 text-muted-foreground"},_o={key:1,class:"flex items-center gap-2"},wo={class:"flex gap-1 flex-wrap"},Eo={key:2,class:"text-sm text-muted-foreground space-y-1"},Co={key:0,class:"flex items-center gap-1"},Do={key:1,class:"flex items-center gap-1"},ko={key:2,class:"italic mt-2"},So={key:2,class:"flex items-center gap-1 mt-3 pt-3 border-t"},Ea=Pe({__name:"HitosEntregableCard",props:{entregable:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},expanded:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},variant:{default:"default"}},emits:["toggle-expand","view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=W([]),{getEstadoColor:s,getPrioridadColor:d,formatDate:m,formatDateTime:v,getDiasRestantes:f,isVencido:y}=wt(i),p=J(()=>gt[n.entregable.estado]),D=J(()=>Ot[n.entregable.prioridad]),b=J(()=>f(n.entregable.fecha_fin)),g=J(()=>y(n.entregable.fecha_fin,n.entregable.estado)),h=J(()=>n.entregable.estado==="completado"),I=J(()=>n.entregable.estado==="cancelado"),H=J(()=>{switch(n.entregable.estado){case"completado":return st;case"en_progreso":return Ie;case"cancelado":return Kt;default:return lt}}),j=J(()=>{const Q="transition-all duration-150",T={en_progreso:"border-l-4 border-l-blue-500",completado:"border-l-4 border-l-green-500 bg-green-50/30",cancelado:"border-l-4 border-l-red-500 bg-red-50/30"},Y=[Q];return T[n.entregable.estado]&&Y.push(T[n.entregable.estado]),n.draggable&&Y.push("cursor-grab active:cursor-grabbing hover:shadow-md"),Y.join(" ")});return(Q,T)=>(u(),P(o(we),{class:ee(j.value),"data-id":e.entregable.id,"data-estado":e.entregable.estado},{default:r(()=>[l(o(Ee),{class:ee(e.variant==="kanban"?"p-3":"p-4")},{default:r(()=>[c("div",ro,[e.variant!=="kanban"?(u(),P(o(K),{key:0,variant:"ghost",size:"sm",class:"h-6 w-6 p-0 flex-shrink-0",onClick:T[0]||(T[0]=Y=>a("toggle-expand"))},{default:r(()=>[e.expanded?(u(),P(o(xa),{key:1,class:"h-4 w-4"})):(u(),P(o(en),{key:0,class:"h-4 w-4"}))]),_:1})):_("",!0),e.variant==="kanban"?(u(),P(ot(H.value),{key:1,class:ee(["h-4 w-4 flex-shrink-0 mt-0.5",p.value.color])},null,8,["class"])):_("",!0),c("div",uo,[c("div",co,[c("h4",{class:ee(["font-medium truncate",{"line-through text-muted-foreground":h.value,"text-sm":e.variant==="kanban"}])},x(e.entregable.nombre),3),e.variant!=="kanban"?(u(),w(Z,{key:0},[l(o(se),{class:ee([o(d)(e.entregable.prioridad),"text-[10px] px-1.5"]),variant:"outline"},{default:r(()=>[C(x(D.value.label),1)]),_:1},8,["class"]),l(o(se),{class:ee([o(s)(e.entregable.estado),"text-[10px] px-1.5"])},{default:r(()=>[C(x(p.value.label),1)]),_:1},8,["class"])],64)):_("",!0),e.variant==="kanban"&&e.entregable.prioridad==="alta"?(u(),P(o(se),{key:1,class:"bg-red-100 text-red-800 text-[10px] px-1"},{default:r(()=>[l(o(tn),{class:"h-3 w-3"})]),_:1})):_("",!0)]),e.variant==="kanban"?(u(),w("div",fo,[e.entregable.fecha_fin?(u(),w("span",{key:0,class:ee(["flex items-center gap-1",{"text-red-600":g.value}])},[l(o(Ge),{class:"h-3 w-3"}),C(" "+x(o(m)(e.entregable.fecha_fin)),1)],2)):_("",!0),e.entregable.responsable?(u(),w("span",mo,[l(o(tt),{class:"h-3 w-3"}),C(" "+x(e.entregable.responsable.name),1)])):_("",!0)])):_("",!0)])]),e.variant==="kanban"?(u(),w("div",go,[l(o(K),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:T[1]||(T[1]=$t(Y=>a("view"),["stop"]))},{default:r(()=>[l(o(Aa),{class:"h-3 w-3 mr-1"}),T[13]||(T[13]=C(" Ver ",-1))]),_:1}),l(o(K),{variant:"outline",size:"sm",class:"flex-1 h-7 text-xs",onClick:T[2]||(T[2]=$t(Y=>a("edit"),["stop"]))},{default:r(()=>[l(o(_t),{class:"h-3 w-3 mr-1"}),T[14]||(T[14]=C(" Editar ",-1))]),_:1}),l(o(K),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:T[3]||(T[3]=$t(Y=>a("show-comentarios"),["stop"])),title:"Comentarios"},{default:r(()=>[l(o(We),{class:"h-3 w-3"}),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(u(),w("span",po,x(e.entregable.comentarios_count),1)):_("",!0)]),_:1}),l(o(K),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:T[4]||(T[4]=$t(Y=>a("show-actividad"),["stop"])),title:"Actividad"},{default:r(()=>[l(o(qe),{class:"h-3 w-3"})]),_:1})])):_("",!0),e.expanded&&e.variant!=="kanban"?(u(),w("div",vo,[e.entregable.descripcion?(u(),w("p",ho,x(e.entregable.descripcion),1)):_("",!0),c("div",bo,[c("div",yo,[l(o(Ge),{class:"h-4 w-4"}),c("span",null,x(o(m)(e.entregable.fecha_inicio))+" - "+x(o(m)(e.entregable.fecha_fin)),1)]),e.entregable.responsable?(u(),w("div",xo,[l(o(tt),{class:"h-4 w-4"}),c("span",null,x(e.entregable.responsable.name),1)])):_("",!0),b.value?(u(),w("div",{key:1,class:ee(["flex items-center gap-1",{"text-red-600":g.value}])},[l(o(Ie),{class:"h-4 w-4"}),c("span",null,x(b.value),1)],2)):_("",!0)]),e.entregable.usuarios&&e.entregable.usuarios.length>0?(u(),w("div",_o,[l(o(ma),{class:"h-4 w-4 text-muted-foreground"}),c("div",wo,[(u(!0),w(Z,null,fe(e.entregable.usuarios,Y=>(u(),P(o(se),{key:Y.id,variant:"secondary",class:"text-xs"},{default:r(()=>[C(x(Y.name),1)]),_:2},1024))),128))])])):_("",!0),h.value?(u(),w("div",Eo,[e.entregable.completado_at?(u(),w("div",Co,[l(o(Ie),{class:"h-3 w-3"}),c("span",null,"Completado: "+x(o(v)(e.entregable.completado_at)),1)])):_("",!0),e.entregable.completado_por_usuario?(u(),w("div",Do,[l(o(tt),{class:"h-3 w-3"}),c("span",null,"Por: "+x(e.entregable.completado_por_usuario.name),1)])):_("",!0),e.entregable.observaciones_estado?(u(),w("p",ko,' "'+x(e.entregable.observaciones_estado)+'" ',1)):_("",!0)])):_("",!0)])):_("",!0),e.variant==="default"&&(e.canEdit||e.canDelete||e.canComplete)?(u(),w("div",So,[l(o(K),{variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[5]||(T[5]=Y=>a("view"))},{default:r(()=>[l(o(Aa),{class:"h-3 w-3 mr-1"}),T[15]||(T[15]=C(" Ver detalles ",-1))]),_:1}),!h.value&&!I.value?(u(),w(Z,{key:0},[e.canComplete?(u(),P(o(K),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[6]||(T[6]=Y=>a("complete"))},{default:r(()=>[l(o(st),{class:"h-3 w-3 mr-1"}),T[16]||(T[16]=C(" Completar ",-1))]),_:1})):_("",!0),e.canEdit&&e.entregable.estado==="pendiente"?(u(),P(o(K),{key:1,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[7]||(T[7]=Y=>a("change-status","en_progreso"))},{default:r(()=>[l(o(Ie),{class:"h-3 w-3 mr-1"}),T[17]||(T[17]=C(" En progreso ",-1))]),_:1})):_("",!0)],64)):h.value?(u(),w(Z,{key:1},[e.canEdit?(u(),P(o(K),{key:0,variant:"outline",size:"sm",class:"h-7 text-xs",onClick:T[8]||(T[8]=Y=>a("change-status","pendiente"))},{default:r(()=>[l(o(lt),{class:"h-3 w-3 mr-1"}),T[18]||(T[18]=C(" Reabrir ",-1))]),_:1})):_("",!0)],64)):_("",!0),e.canEdit?(u(),P(o(K),{key:2,variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:T[9]||(T[9]=Y=>a("edit"))},{default:r(()=>[l(o(_t),{class:"h-3 w-3 mr-1"}),T[19]||(T[19]=C(" Editar ",-1))]),_:1})):_("",!0),l(o(K),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:T[10]||(T[10]=Y=>a("show-comentarios"))},{default:r(()=>[l(o(We),{class:"h-3 w-3 mr-1"}),T[20]||(T[20]=C(" Comentarios ",-1)),e.entregable.comentarios_count&&e.entregable.comentarios_count>0?(u(),P(o(se),{key:0,variant:"secondary",class:"ml-1 text-xs"},{default:r(()=>[C(x(e.entregable.comentarios_count),1)]),_:1})):_("",!0)]),_:1}),l(o(K),{variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:T[11]||(T[11]=Y=>a("show-actividad"))},{default:r(()=>[l(o(qe),{class:"h-3 w-3 mr-1"}),T[21]||(T[21]=C(" Actividad ",-1))]),_:1}),e.canDelete?(u(),P(o(K),{key:3,variant:"ghost",size:"sm",class:"h-7 text-xs text-red-600 hover:text-red-700 hover:bg-red-50",onClick:T[12]||(T[12]=Y=>a("delete"))},{default:r(()=>[l(o(on),{class:"h-3 w-3 mr-1"}),T[22]||(T[22]=C(" Eliminar ",-1))]),_:1})):_("",!0)])):_("",!0)]),_:1},8,["class"])]),_:1},8,["class","data-id","data-estado"]))}}),$o={class:"space-y-6"},Io={key:0},To={class:"font-semibold mb-3 flex items-center gap-2"},Ao={class:"space-y-2"},Po={key:0,class:"text-center py-8"},Oo=Pe({__name:"HitosEntregablesList",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=rt(n,"entregables"),{entregablesAgrupados:s}=wt(i),d=W(new Set),m=D=>{d.value.has(D)?d.value.delete(D):d.value.add(D)},v=D=>d.value.has(D),f=D=>{a("complete",D)},y=(D,b)=>{a("change-status",D,b)},p=[{key:"pendientes",icon:lt,iconClass:"text-yellow-600",label:"Pendientes"},{key:"en_progreso",icon:Ie,iconClass:"text-blue-600",label:"En Progreso"},{key:"completados",icon:st,iconClass:"text-green-600",label:"Completados"},{key:"cancelados",icon:Kt,iconClass:"text-red-600",label:"Cancelados"}];return(D,b)=>(u(),w("div",$o,[(u(),w(Z,null,fe(p,g=>(u(),w(Z,{key:g.key},[o(s)[g.key].length>0?(u(),w("div",Io,[c("h3",To,[(u(),P(ot(g.icon),{class:ee(["h-5 w-5",g.iconClass])},null,8,["class"])),C(" "+x(g.label)+" ("+x(o(s)[g.key].length)+") ",1)]),c("div",Ao,[(u(!0),w(Z,null,fe(o(s)[g.key],h=>(u(),P(Ea,{key:h.id,entregable:h,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:v(h.id),variant:"default",onToggleExpand:I=>m(h.id),onView:I=>a("view",h),onEdit:I=>a("edit",h),onDelete:I=>a("delete",h),onComplete:I=>f(h),onChangeStatus:I=>y(h,I),onShowComentarios:I=>a("show-comentarios",h),onShowActividad:I=>a("show-actividad",h)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])])):_("",!0)],64))),64)),e.entregables.length===0?(u(),w("div",Po,[l(o(at),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),b[0]||(b[0]=c("p",{class:"text-muted-foreground"},"No hay entregables asignados",-1))])):_("",!0)]))}}),Mo={class:"hidden sm:inline text-xs"},No={key:0,class:"space-y-2"},Ro={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},Fo={class:"text-muted-foreground text-sm"},Vo=Pe({__name:"HitosEntregablesTabs",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=rt(n,"entregables"),{entregablesAgrupados:s}=wt(i),d=W(new Set),m=W("pendiente"),v=g=>{d.value.has(g)?d.value.delete(g):d.value.add(g)},f=g=>d.value.has(g),y={pendiente:{icon:lt,iconClass:"text-yellow-600",label:"Pendientes",key:"pendientes"},en_progreso:{icon:Ie,iconClass:"text-blue-600",label:"En Progreso",key:"en_progreso"},completado:{icon:st,iconClass:"text-green-600",label:"Completados",key:"completados"},cancelado:{icon:Kt,iconClass:"text-red-600",label:"Cancelados",key:"cancelados"}},p=g=>{a("complete",g)},D=(g,h)=>{a("change-status",g,h)},b=g=>{const h=y[g];return s.value[h.key]};return(g,h)=>(u(),P(o(_a),{modelValue:m.value,"onUpdate:modelValue":h[0]||(h[0]=I=>m.value=I),class:"w-full"},{default:r(()=>[l(o(wa),{class:"w-full grid grid-cols-4 h-auto"},{default:r(()=>[(u(!0),w(Z,null,fe(o(pa),I=>(u(),P(o(Oe),{key:I,value:I,class:"gap-1.5 py-2 px-2 data-[state=active]:bg-background"},{default:r(()=>[(u(),P(ot(y[I].icon),{class:ee(["h-4 w-4 flex-shrink-0",y[I].iconClass])},null,8,["class"])),c("span",Mo,x(y[I].label),1),l(o(se),{variant:"secondary",class:"ml-1 text-xs px-1.5 py-0"},{default:r(()=>[C(x(b(I).length),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),(u(!0),w(Z,null,fe(o(pa),I=>(u(),P(o(Me),{key:I,value:I,class:"mt-4"},{default:r(()=>[b(I).length>0?(u(),w("div",No,[(u(!0),w(Z,null,fe(b(I),H=>(u(),P(Ea,{key:H.id,entregable:H,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,expanded:f(H.id),variant:"default",onToggleExpand:j=>v(H.id),onView:j=>a("view",H),onEdit:j=>a("edit",H),onDelete:j=>a("delete",H),onComplete:j=>p(H),onChangeStatus:j=>D(H,j),onShowComentarios:j=>a("show-comentarios",H),onShowActividad:j=>a("show-actividad",H)},null,8,["entregable","can-edit","can-delete","can-complete","expanded","onToggleExpand","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128))])):(u(),w("div",Ro,[(u(),P(ot(y[I].icon),{class:ee(["h-10 w-10 mx-auto mb-3",y[I].iconClass+"/50"])},null,8,["class"])),c("p",Fo," No hay entregables "+x(y[I].label.toLowerCase()),1)]))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))}});/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fa(Object(n),!0).forEach(function(a){zo(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fa(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Mt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Mt=function(t){return typeof t}:Mt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(e)}function zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Re(){return Re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Re.apply(this,arguments)}function Bo(e,t){if(e==null)return{};var n={},a=Object.keys(e),i,s;for(s=0;s<a.length;s++)i=a[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Ho(e,t){if(e==null)return{};var n=Bo(e,t),a,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Uo="1.15.6";function Ne(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Fe=Ne(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Et=Ne(/Edge/i),Va=Ne(/firefox/i),pt=Ne(/safari/i)&&!Ne(/chrome/i)&&!Ne(/android/i),Ca=Ne(/iP(ad|od|hone)/i),vn=Ne(/chrome/i)&&Ne(/android/i),hn={capture:!1,passive:!1};function G(e,t,n){e.addEventListener(t,n,!Fe&&hn)}function X(e,t,n){e.removeEventListener(t,n,!Fe&&hn)}function Yt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function bn(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ke(e,t,n,a){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&Yt(e,t):Yt(e,t))||a&&e===n)return e;if(e===n)break}while(e=bn(e))}return null}var za=/\s+/g;function be(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(za," ").replace(" "+t+" "," ");e.className=(a+(n?" "+t:"")).replace(za," ")}}function R(e,t,n){var a=e&&e.style;if(a){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in a)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),a[t]=n+(typeof n=="string"?"":"px")}}function nt(e,t){var n="";if(typeof e=="string")n=e;else do{var a=R(e,"transform");a&&a!=="none"&&(n=a+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function yn(e,t,n){if(e){var a=e.getElementsByTagName(t),i=0,s=a.length;if(n)for(;i<s;i++)n(a[i],i);return a}return[]}function Te(){var e=document.scrollingElement;return e||document.documentElement}function le(e,t,n,a,i){if(!(!e.getBoundingClientRect&&e!==window)){var s,d,m,v,f,y,p;if(e!==window&&e.parentNode&&e!==Te()?(s=e.getBoundingClientRect(),d=s.top,m=s.left,v=s.bottom,f=s.right,y=s.height,p=s.width):(d=0,m=0,v=window.innerHeight,f=window.innerWidth,y=window.innerHeight,p=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!Fe))do if(i&&i.getBoundingClientRect&&(R(i,"transform")!=="none"||n&&R(i,"position")!=="static")){var D=i.getBoundingClientRect();d-=D.top+parseInt(R(i,"border-top-width")),m-=D.left+parseInt(R(i,"border-left-width")),v=d+s.height,f=m+s.width;break}while(i=i.parentNode);if(a&&e!==window){var b=nt(i||e),g=b&&b.a,h=b&&b.d;b&&(d/=h,m/=g,p/=g,y/=h,v=d+y,f=m+p)}return{top:d,left:m,bottom:v,right:f,width:p,height:y}}}function Ba(e,t,n){for(var a=He(e,!0),i=le(e)[t];a;){var s=le(a)[n],d=void 0;if(d=i>=s,!d)return a;if(a===Te())break;a=He(a,!1)}return!1}function it(e,t,n,a){for(var i=0,s=0,d=e.children;s<d.length;){if(d[s].style.display!=="none"&&d[s]!==F.ghost&&(a||d[s]!==F.dragged)&&ke(d[s],n.draggable,e,!1)){if(i===t)return d[s];i++}s++}return null}function Da(e,t){for(var n=e.lastElementChild;n&&(n===F.ghost||R(n,"display")==="none"||t&&!Yt(n,t));)n=n.previousElementSibling;return n||null}function _e(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==F.clone&&(!t||Yt(e,t))&&n++;return n}function Ha(e){var t=0,n=0,a=Te();if(e)do{var i=nt(e),s=i.a,d=i.d;t+=e.scrollLeft*s,n+=e.scrollTop*d}while(e!==a&&(e=e.parentNode));return[t,n]}function jo(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var a in t)if(t.hasOwnProperty(a)&&t[a]===e[n][a])return Number(n)}return-1}function He(e,t){if(!e||!e.getBoundingClientRect)return Te();var n=e,a=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=R(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Te();if(a||t)return n;a=!0}}while(n=n.parentNode);return Te()}function Lo(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function oa(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var vt;function xn(e,t){return function(){if(!vt){var n=arguments,a=this;n.length===1?e.call(a,n[0]):e.apply(a,n),vt=setTimeout(function(){vt=void 0},t)}}}function Yo(){clearTimeout(vt),vt=void 0}function _n(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function wn(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function En(e,t,n){var a={};return Array.from(e.children).forEach(function(i){var s,d,m,v;if(!(!ke(i,t.draggable,e,!1)||i.animated||i===n)){var f=le(i);a.left=Math.min((s=a.left)!==null&&s!==void 0?s:1/0,f.left),a.top=Math.min((d=a.top)!==null&&d!==void 0?d:1/0,f.top),a.right=Math.max((m=a.right)!==null&&m!==void 0?m:-1/0,f.right),a.bottom=Math.max((v=a.bottom)!==null&&v!==void 0?v:-1/0,f.bottom)}}),a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}var pe="Sortable"+new Date().getTime();function Xo(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(i){if(!(R(i,"display")==="none"||i===F.ghost)){e.push({target:i,rect:le(i)});var s=Ae({},e[e.length-1].rect);if(i.thisAnimationDuration){var d=nt(i,!0);d&&(s.top-=d.f,s.left-=d.e)}i.fromRect=s}})}},addAnimationState:function(a){e.push(a)},removeAnimationState:function(a){e.splice(jo(e,{target:a}),1)},animateAll:function(a){var i=this;if(!this.options.animation){clearTimeout(t),typeof a=="function"&&a();return}var s=!1,d=0;e.forEach(function(m){var v=0,f=m.target,y=f.fromRect,p=le(f),D=f.prevFromRect,b=f.prevToRect,g=m.rect,h=nt(f,!0);h&&(p.top-=h.f,p.left-=h.e),f.toRect=p,f.thisAnimationDuration&&oa(D,p)&&!oa(y,p)&&(g.top-p.top)/(g.left-p.left)===(y.top-p.top)/(y.left-p.left)&&(v=Wo(g,D,b,i.options)),oa(p,y)||(f.prevFromRect=y,f.prevToRect=p,v||(v=i.options.animation),i.animate(f,g,p,v)),v&&(s=!0,d=Math.max(d,v),clearTimeout(f.animationResetTimer),f.animationResetTimer=setTimeout(function(){f.animationTime=0,f.prevFromRect=null,f.fromRect=null,f.prevToRect=null,f.thisAnimationDuration=null},v),f.thisAnimationDuration=v)}),clearTimeout(t),s?t=setTimeout(function(){typeof a=="function"&&a()},d):typeof a=="function"&&a(),e=[]},animate:function(a,i,s,d){if(d){R(a,"transition",""),R(a,"transform","");var m=nt(this.el),v=m&&m.a,f=m&&m.d,y=(i.left-s.left)/(v||1),p=(i.top-s.top)/(f||1);a.animatingX=!!y,a.animatingY=!!p,R(a,"transform","translate3d("+y+"px,"+p+"px,0)"),this.forRepaintDummy=Go(a),R(a,"transition","transform "+d+"ms"+(this.options.easing?" "+this.options.easing:"")),R(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){R(a,"transition",""),R(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},d)}}}}function Go(e){return e.offsetWidth}function Wo(e,t,n,a){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*a.animation}var Qe=[],la={initializeByDefault:!0},Ct={mount:function(t){for(var n in la)la.hasOwnProperty(n)&&!(n in t)&&(t[n]=la[n]);Qe.forEach(function(a){if(a.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Qe.push(t)},pluginEvent:function(t,n,a){var i=this;this.eventCanceled=!1,a.cancel=function(){i.eventCanceled=!0};var s=t+"Global";Qe.forEach(function(d){n[d.pluginName]&&(n[d.pluginName][s]&&n[d.pluginName][s](Ae({sortable:n},a)),n.options[d.pluginName]&&n[d.pluginName][t]&&n[d.pluginName][t](Ae({sortable:n},a)))})},initializePlugins:function(t,n,a,i){Qe.forEach(function(m){var v=m.pluginName;if(!(!t.options[v]&&!m.initializeByDefault)){var f=new m(t,n,t.options);f.sortable=t,f.options=t.options,t[v]=f,Re(a,f.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var d=this.modifyOption(t,s,t.options[s]);typeof d<"u"&&(t.options[s]=d)}},getEventProperties:function(t,n){var a={};return Qe.forEach(function(i){typeof i.eventProperties=="function"&&Re(a,i.eventProperties.call(n[i.pluginName],t))}),a},modifyOption:function(t,n,a){var i;return Qe.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[n]=="function"&&(i=s.optionListeners[n].call(t[s.pluginName],a))}),i}};function qo(e){var t=e.sortable,n=e.rootEl,a=e.name,i=e.targetEl,s=e.cloneEl,d=e.toEl,m=e.fromEl,v=e.oldIndex,f=e.newIndex,y=e.oldDraggableIndex,p=e.newDraggableIndex,D=e.originalEvent,b=e.putSortable,g=e.extraEventProperties;if(t=t||n&&n[pe],!!t){var h,I=t.options,H="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Fe&&!Et?h=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(h=document.createEvent("Event"),h.initEvent(a,!0,!0)),h.to=d||n,h.from=m||n,h.item=i||n,h.clone=s,h.oldIndex=v,h.newIndex=f,h.oldDraggableIndex=y,h.newDraggableIndex=p,h.originalEvent=D,h.pullMode=b?b.lastPutMode:void 0;var j=Ae(Ae({},g),Ct.getEventProperties(a,t));for(var Q in j)h[Q]=j[Q];n&&n.dispatchEvent(h),I[H]&&I[H].call(t,h)}}var Ko=["evt"],ge=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=a.evt,s=Ho(a,Ko);Ct.pluginEvent.bind(F)(t,n,Ae({dragEl:k,parentEl:ne,ghostEl:U,rootEl:te,nextEl:Le,lastDownEl:Nt,cloneEl:ae,cloneHidden:ze,dragStarted:ct,putSortable:de,activeSortable:F.active,originalEvent:i,oldIndex:et,oldDraggableIndex:ht,newIndex:ye,newDraggableIndex:Ve,hideGhostForTarget:Sn,unhideGhostForTarget:$n,cloneNowHidden:function(){ze=!0},cloneNowShown:function(){ze=!1},dispatchSortableEvent:function(m){me({sortable:n,name:m,originalEvent:i})}},s))};function me(e){qo(Ae({putSortable:de,cloneEl:ae,targetEl:k,rootEl:te,oldIndex:et,oldDraggableIndex:ht,newIndex:ye,newDraggableIndex:Ve},e))}var k,ne,U,te,Le,Nt,ae,ze,et,ye,ht,Ve,It,de,Ze=!1,Xt=!1,Gt=[],Ue,De,sa,ia,Ua,ja,ct,Je,bt,yt=!1,Tt=!1,Rt,ce,ra=[],va=!1,Wt=[],Qt=typeof document<"u",At=Ca,La=Et||Fe?"cssFloat":"float",Qo=Qt&&!vn&&!Ca&&"draggable"in document.createElement("div"),Cn=(function(){if(Qt){if(Fe)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),Dn=function(t,n){var a=R(t),i=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),s=it(t,0,n),d=it(t,1,n),m=s&&R(s),v=d&&R(d),f=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+le(s).width,y=v&&parseInt(v.marginLeft)+parseInt(v.marginRight)+le(d).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&m.float&&m.float!=="none"){var p=m.float==="left"?"left":"right";return d&&(v.clear==="both"||v.clear===p)?"vertical":"horizontal"}return s&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||f>=i&&a[La]==="none"||d&&a[La]==="none"&&f+y>i)?"vertical":"horizontal"},Jo=function(t,n,a){var i=a?t.left:t.top,s=a?t.right:t.bottom,d=a?t.width:t.height,m=a?n.left:n.top,v=a?n.right:n.bottom,f=a?n.width:n.height;return i===m||s===v||i+d/2===m+f/2},Zo=function(t,n){var a;return Gt.some(function(i){var s=i[pe].options.emptyInsertThreshold;if(!(!s||Da(i))){var d=le(i),m=t>=d.left-s&&t<=d.right+s,v=n>=d.top-s&&n<=d.bottom+s;if(m&&v)return a=i}}),a},kn=function(t){function n(s,d){return function(m,v,f,y){var p=m.options.group.name&&v.options.group.name&&m.options.group.name===v.options.group.name;if(s==null&&(d||p))return!0;if(s==null||s===!1)return!1;if(d&&s==="clone")return s;if(typeof s=="function")return n(s(m,v,f,y),d)(m,v,f,y);var D=(d?m:v).options.group.name;return s===!0||typeof s=="string"&&s===D||s.join&&s.indexOf(D)>-1}}var a={},i=t.group;(!i||Mt(i)!="object")&&(i={name:i}),a.name=i.name,a.checkPull=n(i.pull,!0),a.checkPut=n(i.put),a.revertClone=i.revertClone,t.group=a},Sn=function(){!Cn&&U&&R(U,"display","none")},$n=function(){!Cn&&U&&R(U,"display","")};Qt&&!vn&&document.addEventListener("click",function(e){if(Xt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Xt=!1,!1},!0);var je=function(t){if(k){t=t.touches?t.touches[0]:t;var n=Zo(t.clientX,t.clientY);if(n){var a={};for(var i in t)t.hasOwnProperty(i)&&(a[i]=t[i]);a.target=a.rootEl=n,a.preventDefault=void 0,a.stopPropagation=void 0,n[pe]._onDragOver(a)}}},el=function(t){k&&k.parentNode[pe]._isOutsideThisEl(t.target)};function F(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Re({},t),e[pe]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Dn(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(d,m){d.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:F.supportPointer!==!1&&"PointerEvent"in window&&(!pt||Ca),emptyInsertThreshold:5};Ct.initializePlugins(this,e,n);for(var a in n)!(a in t)&&(t[a]=n[a]);kn(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:Qo,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?G(e,"pointerdown",this._onTapStart):(G(e,"mousedown",this._onTapStart),G(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(G(e,"dragover",this),G(e,"dragenter",this)),Gt.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Re(this,Xo())}F.prototype={constructor:F,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Je=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,k):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,a=this.el,i=this.options,s=i.preventOnFilter,d=t.type,m=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,v=(m||t).target,f=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||v,y=i.filter;if(rl(a),!k&&!(/mousedown|pointerdown/.test(d)&&t.button!==0||i.disabled)&&!f.isContentEditable&&!(!this.nativeDraggable&&pt&&v&&v.tagName.toUpperCase()==="SELECT")&&(v=ke(v,i.draggable,a,!1),!(v&&v.animated)&&Nt!==v)){if(et=_e(v),ht=_e(v,i.draggable),typeof y=="function"){if(y.call(this,t,v,this)){me({sortable:n,rootEl:f,name:"filter",targetEl:v,toEl:a,fromEl:a}),ge("filter",n,{evt:t}),s&&t.preventDefault();return}}else if(y&&(y=y.split(",").some(function(p){if(p=ke(f,p.trim(),a,!1),p)return me({sortable:n,rootEl:p,name:"filter",targetEl:v,fromEl:a,toEl:a}),ge("filter",n,{evt:t}),!0}),y)){s&&t.preventDefault();return}i.handle&&!ke(f,i.handle,a,!1)||this._prepareDragStart(t,m,v)}}},_prepareDragStart:function(t,n,a){var i=this,s=i.el,d=i.options,m=s.ownerDocument,v;if(a&&!k&&a.parentNode===s){var f=le(a);if(te=s,k=a,ne=k.parentNode,Le=k.nextSibling,Nt=a,It=d.group,F.dragged=k,Ue={target:k,clientX:(n||t).clientX,clientY:(n||t).clientY},Ua=Ue.clientX-f.left,ja=Ue.clientY-f.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,k.style["will-change"]="all",v=function(){if(ge("delayEnded",i,{evt:t}),F.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Va&&i.nativeDraggable&&(k.draggable=!0),i._triggerDragStart(t,n),me({sortable:i,name:"choose",originalEvent:t}),be(k,d.chosenClass,!0)},d.ignore.split(",").forEach(function(y){yn(k,y.trim(),da)}),G(m,"dragover",je),G(m,"mousemove",je),G(m,"touchmove",je),d.supportPointer?(G(m,"pointerup",i._onDrop),!this.nativeDraggable&&G(m,"pointercancel",i._onDrop)):(G(m,"mouseup",i._onDrop),G(m,"touchend",i._onDrop),G(m,"touchcancel",i._onDrop)),Va&&this.nativeDraggable&&(this.options.touchStartThreshold=4,k.draggable=!0),ge("delayStart",this,{evt:t}),d.delay&&(!d.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Et||Fe))){if(F.eventCanceled){this._onDrop();return}d.supportPointer?(G(m,"pointerup",i._disableDelayedDrag),G(m,"pointercancel",i._disableDelayedDrag)):(G(m,"mouseup",i._disableDelayedDrag),G(m,"touchend",i._disableDelayedDrag),G(m,"touchcancel",i._disableDelayedDrag)),G(m,"mousemove",i._delayedDragTouchMoveHandler),G(m,"touchmove",i._delayedDragTouchMoveHandler),d.supportPointer&&G(m,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(v,d.delay)}else v()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){k&&da(k),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;X(t,"mouseup",this._disableDelayedDrag),X(t,"touchend",this._disableDelayedDrag),X(t,"touchcancel",this._disableDelayedDrag),X(t,"pointerup",this._disableDelayedDrag),X(t,"pointercancel",this._disableDelayedDrag),X(t,"mousemove",this._delayedDragTouchMoveHandler),X(t,"touchmove",this._delayedDragTouchMoveHandler),X(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?G(document,"pointermove",this._onTouchMove):n?G(document,"touchmove",this._onTouchMove):G(document,"mousemove",this._onTouchMove):(G(k,"dragend",this),G(te,"dragstart",this._onDragStart));try{document.selection?Ft(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(Ze=!1,te&&k){ge("dragStarted",this,{evt:n}),this.nativeDraggable&&G(document,"dragover",el);var a=this.options;!t&&be(k,a.dragClass,!1),be(k,a.ghostClass,!0),F.active=this,t&&this._appendGhost(),me({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(De){this._lastX=De.clientX,this._lastY=De.clientY,Sn();for(var t=document.elementFromPoint(De.clientX,De.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(De.clientX,De.clientY),t!==n);)n=t;if(k.parentNode[pe]._isOutsideThisEl(t),n)do{if(n[pe]){var a=void 0;if(a=n[pe]._onDragOver({clientX:De.clientX,clientY:De.clientY,target:t,rootEl:n}),a&&!this.options.dragoverBubble)break}t=n}while(n=bn(n));$n()}},_onTouchMove:function(t){if(Ue){var n=this.options,a=n.fallbackTolerance,i=n.fallbackOffset,s=t.touches?t.touches[0]:t,d=U&&nt(U,!0),m=U&&d&&d.a,v=U&&d&&d.d,f=At&&ce&&Ha(ce),y=(s.clientX-Ue.clientX+i.x)/(m||1)+(f?f[0]-ra[0]:0)/(m||1),p=(s.clientY-Ue.clientY+i.y)/(v||1)+(f?f[1]-ra[1]:0)/(v||1);if(!F.active&&!Ze){if(a&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<a)return;this._onDragStart(t,!0)}if(U){d?(d.e+=y-(sa||0),d.f+=p-(ia||0)):d={a:1,b:0,c:0,d:1,e:y,f:p};var D="matrix(".concat(d.a,",").concat(d.b,",").concat(d.c,",").concat(d.d,",").concat(d.e,",").concat(d.f,")");R(U,"webkitTransform",D),R(U,"mozTransform",D),R(U,"msTransform",D),R(U,"transform",D),sa=y,ia=p,De=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!U){var t=this.options.fallbackOnBody?document.body:te,n=le(k,!0,At,!0,t),a=this.options;if(At){for(ce=t;R(ce,"position")==="static"&&R(ce,"transform")==="none"&&ce!==document;)ce=ce.parentNode;ce!==document.body&&ce!==document.documentElement?(ce===document&&(ce=Te()),n.top+=ce.scrollTop,n.left+=ce.scrollLeft):ce=Te(),ra=Ha(ce)}U=k.cloneNode(!0),be(U,a.ghostClass,!1),be(U,a.fallbackClass,!0),be(U,a.dragClass,!0),R(U,"transition",""),R(U,"transform",""),R(U,"box-sizing","border-box"),R(U,"margin",0),R(U,"top",n.top),R(U,"left",n.left),R(U,"width",n.width),R(U,"height",n.height),R(U,"opacity","0.8"),R(U,"position",At?"absolute":"fixed"),R(U,"zIndex","100000"),R(U,"pointerEvents","none"),F.ghost=U,t.appendChild(U),R(U,"transform-origin",Ua/parseInt(U.style.width)*100+"% "+ja/parseInt(U.style.height)*100+"%")}},_onDragStart:function(t,n){var a=this,i=t.dataTransfer,s=a.options;if(ge("dragStart",this,{evt:t}),F.eventCanceled){this._onDrop();return}ge("setupClone",this),F.eventCanceled||(ae=wn(k),ae.removeAttribute("id"),ae.draggable=!1,ae.style["will-change"]="",this._hideClone(),be(ae,this.options.chosenClass,!1),F.clone=ae),a.cloneId=Ft(function(){ge("clone",a),!F.eventCanceled&&(a.options.removeCloneOnHide||te.insertBefore(ae,k),a._hideClone(),me({sortable:a,name:"clone"}))}),!n&&be(k,s.dragClass,!0),n?(Xt=!0,a._loopId=setInterval(a._emulateDragOver,50)):(X(document,"mouseup",a._onDrop),X(document,"touchend",a._onDrop),X(document,"touchcancel",a._onDrop),i&&(i.effectAllowed="move",s.setData&&s.setData.call(a,i,k)),G(document,"drop",a),R(k,"transform","translateZ(0)")),Ze=!0,a._dragStartId=Ft(a._dragStarted.bind(a,n,t)),G(document,"selectstart",a),ct=!0,window.getSelection().removeAllRanges(),pt&&R(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,a=t.target,i,s,d,m=this.options,v=m.group,f=F.active,y=It===v,p=m.sort,D=de||f,b,g=this,h=!1;if(va)return;function I(ue,Ke){ge(ue,g,Ae({evt:t,isOwner:y,axis:b?"vertical":"horizontal",revert:d,dragRect:i,targetRect:s,canSort:p,fromSortable:D,target:a,completed:j,onMove:function(Dt,kt){return Pt(te,n,k,i,Dt,le(Dt),t,kt)},changed:Q},Ke))}function H(){I("dragOverAnimationCapture"),g.captureAnimationState(),g!==D&&D.captureAnimationState()}function j(ue){return I("dragOverCompleted",{insertion:ue}),ue&&(y?f._hideClone():f._showClone(g),g!==D&&(be(k,de?de.options.ghostClass:f.options.ghostClass,!1),be(k,m.ghostClass,!0)),de!==g&&g!==F.active?de=g:g===F.active&&de&&(de=null),D===g&&(g._ignoreWhileAnimating=a),g.animateAll(function(){I("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==D&&(D.animateAll(),D._ignoreWhileAnimating=null)),(a===k&&!k.animated||a===n&&!a.animated)&&(Je=null),!m.dragoverBubble&&!t.rootEl&&a!==document&&(k.parentNode[pe]._isOutsideThisEl(t.target),!ue&&je(t)),!m.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),h=!0}function Q(){ye=_e(k),Ve=_e(k,m.draggable),me({sortable:g,name:"change",toEl:n,newIndex:ye,newDraggableIndex:Ve,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),a=ke(a,m.draggable,n,!0),I("dragOver"),F.eventCanceled)return h;if(k.contains(t.target)||a.animated&&a.animatingX&&a.animatingY||g._ignoreWhileAnimating===a)return j(!1);if(Xt=!1,f&&!m.disabled&&(y?p||(d=ne!==te):de===this||(this.lastPutMode=It.checkPull(this,f,k,t))&&v.checkPut(this,f,k,t))){if(b=this._getDirection(t,a)==="vertical",i=le(k),I("dragOverValid"),F.eventCanceled)return h;if(d)return ne=te,H(),this._hideClone(),I("revert"),F.eventCanceled||(Le?te.insertBefore(k,Le):te.appendChild(k)),j(!0);var T=Da(n,m.draggable);if(!T||ol(t,b,this)&&!T.animated){if(T===k)return j(!1);if(T&&n===t.target&&(a=T),a&&(s=le(a)),Pt(te,n,k,i,a,s,t,!!a)!==!1)return H(),T&&T.nextSibling?n.insertBefore(k,T.nextSibling):n.appendChild(k),ne=n,Q(),j(!0)}else if(T&&nl(t,b,this)){var Y=it(n,0,m,!0);if(Y===k)return j(!1);if(a=Y,s=le(a),Pt(te,n,k,i,a,s,t,!1)!==!1)return H(),n.insertBefore(k,Y),ne=n,Q(),j(!0)}else if(a.parentNode===n){s=le(a);var B=0,S,V=k.parentNode!==n,M=!Jo(k.animated&&k.toRect||i,a.animated&&a.toRect||s,b),q=b?"top":"left",re=Ba(a,"top","top")||Ba(k,"top","top"),xe=re?re.scrollTop:void 0;Je!==a&&(S=s[q],yt=!1,Tt=!M&&m.invertSwap||V),B=ll(t,a,s,b,M?1:m.swapThreshold,m.invertedSwapThreshold==null?m.swapThreshold:m.invertedSwapThreshold,Tt,Je===a);var A;if(B!==0){var E=_e(k);do E-=B,A=ne.children[E];while(A&&(R(A,"display")==="none"||A===U))}if(B===0||A===a)return j(!1);Je=a,bt=B;var O=a.nextElementSibling,L=!1;L=B===1;var ve=Pt(te,n,k,i,a,s,t,L);if(ve!==!1)return(ve===1||ve===-1)&&(L=ve===1),va=!0,setTimeout(al,30),H(),L&&!O?n.appendChild(k):a.parentNode.insertBefore(k,L?O:a),re&&_n(re,0,xe-re.scrollTop),ne=k.parentNode,S!==void 0&&!Tt&&(Rt=Math.abs(S-le(a)[q])),Q(),j(!0)}if(n.contains(k))return j(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){X(document,"mousemove",this._onTouchMove),X(document,"touchmove",this._onTouchMove),X(document,"pointermove",this._onTouchMove),X(document,"dragover",je),X(document,"mousemove",je),X(document,"touchmove",je)},_offUpEvents:function(){var t=this.el.ownerDocument;X(t,"mouseup",this._onDrop),X(t,"touchend",this._onDrop),X(t,"pointerup",this._onDrop),X(t,"pointercancel",this._onDrop),X(t,"touchcancel",this._onDrop),X(document,"selectstart",this)},_onDrop:function(t){var n=this.el,a=this.options;if(ye=_e(k),Ve=_e(k,a.draggable),ge("drop",this,{evt:t}),ne=k&&k.parentNode,ye=_e(k),Ve=_e(k,a.draggable),F.eventCanceled){this._nulling();return}Ze=!1,Tt=!1,yt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ha(this.cloneId),ha(this._dragStartId),this.nativeDraggable&&(X(document,"drop",this),X(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),pt&&R(document.body,"user-select",""),R(k,"transform",""),t&&(ct&&(t.cancelable&&t.preventDefault(),!a.dropBubble&&t.stopPropagation()),U&&U.parentNode&&U.parentNode.removeChild(U),(te===ne||de&&de.lastPutMode!=="clone")&&ae&&ae.parentNode&&ae.parentNode.removeChild(ae),k&&(this.nativeDraggable&&X(k,"dragend",this),da(k),k.style["will-change"]="",ct&&!Ze&&be(k,de?de.options.ghostClass:this.options.ghostClass,!1),be(k,this.options.chosenClass,!1),me({sortable:this,name:"unchoose",toEl:ne,newIndex:null,newDraggableIndex:null,originalEvent:t}),te!==ne?(ye>=0&&(me({rootEl:ne,name:"add",toEl:ne,fromEl:te,originalEvent:t}),me({sortable:this,name:"remove",toEl:ne,originalEvent:t}),me({rootEl:ne,name:"sort",toEl:ne,fromEl:te,originalEvent:t}),me({sortable:this,name:"sort",toEl:ne,originalEvent:t})),de&&de.save()):ye!==et&&ye>=0&&(me({sortable:this,name:"update",toEl:ne,originalEvent:t}),me({sortable:this,name:"sort",toEl:ne,originalEvent:t})),F.active&&((ye==null||ye===-1)&&(ye=et,Ve=ht),me({sortable:this,name:"end",toEl:ne,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){ge("nulling",this),te=k=ne=U=Le=ae=Nt=ze=Ue=De=ct=ye=Ve=et=ht=Je=bt=de=It=F.dragged=F.ghost=F.clone=F.active=null,Wt.forEach(function(t){t.checked=!0}),Wt.length=sa=ia=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":k&&(this._onDragOver(t),tl(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,a=this.el.children,i=0,s=a.length,d=this.options;i<s;i++)n=a[i],ke(n,d.draggable,this.el,!1)&&t.push(n.getAttribute(d.dataIdAttr)||il(n));return t},sort:function(t,n){var a={},i=this.el;this.toArray().forEach(function(s,d){var m=i.children[d];ke(m,this.options.draggable,i,!1)&&(a[s]=m)},this),n&&this.captureAnimationState(),t.forEach(function(s){a[s]&&(i.removeChild(a[s]),i.appendChild(a[s]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return ke(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var a=this.options;if(n===void 0)return a[t];var i=Ct.modifyOption(this,t,n);typeof i<"u"?a[t]=i:a[t]=n,t==="group"&&kn(a)},destroy:function(){ge("destroy",this);var t=this.el;t[pe]=null,X(t,"mousedown",this._onTapStart),X(t,"touchstart",this._onTapStart),X(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(X(t,"dragover",this),X(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Gt.splice(Gt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ze){if(ge("hideClone",this),F.eventCanceled)return;R(ae,"display","none"),this.options.removeCloneOnHide&&ae.parentNode&&ae.parentNode.removeChild(ae),ze=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ze){if(ge("showClone",this),F.eventCanceled)return;k.parentNode==te&&!this.options.group.revertClone?te.insertBefore(ae,k):Le?te.insertBefore(ae,Le):te.appendChild(ae),this.options.group.revertClone&&this.animate(k,ae),R(ae,"display",""),ze=!1}}};function tl(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Pt(e,t,n,a,i,s,d,m){var v,f=e[pe],y=f.options.onMove,p;return window.CustomEvent&&!Fe&&!Et?v=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent("move",!0,!0)),v.to=t,v.from=e,v.dragged=n,v.draggedRect=a,v.related=i||t,v.relatedRect=s||le(t),v.willInsertAfter=m,v.originalEvent=d,e.dispatchEvent(v),y&&(p=y.call(f,v,d)),p}function da(e){e.draggable=!1}function al(){va=!1}function nl(e,t,n){var a=le(it(n.el,0,n.options,!0)),i=En(n.el,n.options,U),s=10;return t?e.clientX<i.left-s||e.clientY<a.top&&e.clientX<a.right:e.clientY<i.top-s||e.clientY<a.bottom&&e.clientX<a.left}function ol(e,t,n){var a=le(Da(n.el,n.options.draggable)),i=En(n.el,n.options,U),s=10;return t?e.clientX>i.right+s||e.clientY>a.bottom&&e.clientX>a.left:e.clientY>i.bottom+s||e.clientX>a.right&&e.clientY>a.top}function ll(e,t,n,a,i,s,d,m){var v=a?e.clientY:e.clientX,f=a?n.height:n.width,y=a?n.top:n.left,p=a?n.bottom:n.right,D=!1;if(!d){if(m&&Rt<f*i){if(!yt&&(bt===1?v>y+f*s/2:v<p-f*s/2)&&(yt=!0),yt)D=!0;else if(bt===1?v<y+Rt:v>p-Rt)return-bt}else if(v>y+f*(1-i)/2&&v<p-f*(1-i)/2)return sl(t)}return D=D||d,D&&(v<y+f*s/2||v>p-f*s/2)?v>y+f/2?1:-1:0}function sl(e){return _e(k)<_e(e)?1:-1}function il(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,a=0;n--;)a+=t.charCodeAt(n);return a.toString(36)}function rl(e){Wt.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var a=t[n];a.checked&&Wt.push(a)}}function Ft(e){return setTimeout(e,0)}function ha(e){return clearTimeout(e)}Qt&&G(document,"touchmove",function(e){(F.active||Ze)&&e.cancelable&&e.preventDefault()});F.utils={on:G,off:X,css:R,find:yn,is:function(t,n){return!!ke(t,n,t,!1)},extend:Lo,throttle:xn,closest:ke,toggleClass:be,clone:wn,index:_e,nextTick:Ft,cancelNextTick:ha,detectDirection:Dn,getChild:it,expando:pe};F.get=function(e){return e[pe]};F.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(F.utils=Ae(Ae({},F.utils),a.utils)),Ct.mount(a)})};F.create=function(e,t){return new F(e,t)};F.version=Uo;var oe=[],ft,ba,ya=!1,ua,ca,qt,mt;function dl(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var a=n.originalEvent;this.sortable.nativeDraggable?G(document,"dragover",this._handleAutoScroll):this.options.supportPointer?G(document,"pointermove",this._handleFallbackAutoScroll):a.touches?G(document,"touchmove",this._handleFallbackAutoScroll):G(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var a=n.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?X(document,"dragover",this._handleAutoScroll):(X(document,"pointermove",this._handleFallbackAutoScroll),X(document,"touchmove",this._handleFallbackAutoScroll),X(document,"mousemove",this._handleFallbackAutoScroll)),Ya(),Vt(),Yo()},nulling:function(){qt=ba=ft=ya=mt=ua=ca=null,oe.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,a){var i=this,s=(n.touches?n.touches[0]:n).clientX,d=(n.touches?n.touches[0]:n).clientY,m=document.elementFromPoint(s,d);if(qt=n,a||this.options.forceAutoScrollFallback||Et||Fe||pt){fa(n,this.options,m,a);var v=He(m,!0);ya&&(!mt||s!==ua||d!==ca)&&(mt&&Ya(),mt=setInterval(function(){var f=He(document.elementFromPoint(s,d),!0);f!==v&&(v=f,Vt()),fa(n,i.options,f,a)},10),ua=s,ca=d)}else{if(!this.options.bubbleScroll||He(m,!0)===Te()){Vt();return}fa(n,this.options,He(m,!1),!1)}}},Re(e,{pluginName:"scroll",initializeByDefault:!0})}function Vt(){oe.forEach(function(e){clearInterval(e.pid)}),oe=[]}function Ya(){clearInterval(mt)}var fa=xn(function(e,t,n,a){if(t.scroll){var i=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,d=t.scrollSensitivity,m=t.scrollSpeed,v=Te(),f=!1,y;ba!==n&&(ba=n,Vt(),ft=t.scroll,y=t.scrollFn,ft===!0&&(ft=He(n,!0)));var p=0,D=ft;do{var b=D,g=le(b),h=g.top,I=g.bottom,H=g.left,j=g.right,Q=g.width,T=g.height,Y=void 0,B=void 0,S=b.scrollWidth,V=b.scrollHeight,M=R(b),q=b.scrollLeft,re=b.scrollTop;b===v?(Y=Q<S&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),B=T<V&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):(Y=Q<S&&(M.overflowX==="auto"||M.overflowX==="scroll"),B=T<V&&(M.overflowY==="auto"||M.overflowY==="scroll"));var xe=Y&&(Math.abs(j-i)<=d&&q+Q<S)-(Math.abs(H-i)<=d&&!!q),A=B&&(Math.abs(I-s)<=d&&re+T<V)-(Math.abs(h-s)<=d&&!!re);if(!oe[p])for(var E=0;E<=p;E++)oe[E]||(oe[E]={});(oe[p].vx!=xe||oe[p].vy!=A||oe[p].el!==b)&&(oe[p].el=b,oe[p].vx=xe,oe[p].vy=A,clearInterval(oe[p].pid),(xe!=0||A!=0)&&(f=!0,oe[p].pid=setInterval((function(){a&&this.layer===0&&F.active._onTouchMove(qt);var O=oe[this.layer].vy?oe[this.layer].vy*m:0,L=oe[this.layer].vx?oe[this.layer].vx*m:0;typeof y=="function"&&y.call(F.dragged.parentNode[pe],L,O,e,qt,oe[this.layer].el)!=="continue"||_n(oe[this.layer].el,L,O)}).bind({layer:p}),24))),p++}while(t.bubbleScroll&&D!==v&&(D=He(D,!1)));ya=f}},30),In=function(t){var n=t.originalEvent,a=t.putSortable,i=t.dragEl,s=t.activeSortable,d=t.dispatchSortableEvent,m=t.hideGhostForTarget,v=t.unhideGhostForTarget;if(n){var f=a||s;m();var y=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,p=document.elementFromPoint(y.clientX,y.clientY);v(),f&&!f.el.contains(p)&&(d("spill"),this.onSpill({dragEl:i,putSortable:a}))}};function ka(){}ka.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,a=t.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var i=it(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),a&&a.animateAll()},drop:In};Re(ka,{pluginName:"revertOnSpill"});function Sa(){}Sa.prototype={onSpill:function(t){var n=t.dragEl,a=t.putSortable,i=a||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:In};Re(Sa,{pluginName:"removeOnSpill"});F.mount(new dl);F.mount(Sa,ka);const ul=["data-estado"],cl={class:"p-3 border-b bg-background/50 rounded-t-lg"},fl={class:"flex items-center gap-2"},ml={class:"font-medium text-sm"},gl=["data-estado"],pl={key:0,class:"h-20 border-2 border-dashed border-muted-foreground/20 rounded-lg flex items-center justify-center text-sm text-muted-foreground"},vl=Pe({__name:"HitosKanbanColumn",props:{estado:{},entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},isDragOver:{type:Boolean,default:!1}},emits:["view","edit","delete","complete","change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=J(()=>gt[n.estado]),s=J(()=>{switch(n.estado){case"completado":return st;case"en_progreso":return Ie;case"cancelado":return Kt;default:return lt}}),d=J(()=>{const m="flex flex-col rounded-lg border bg-muted/30 min-h-[300px] transition-colors duration-150",v=n.isDragOver?"border-primary border-dashed bg-primary/5":"border-border";return`${m} ${v}`});return(m,v)=>(u(),w("div",{class:ee(d.value),"data-estado":e.estado},[c("div",cl,[c("div",fl,[(u(),P(ot(s.value),{class:ee(["h-4 w-4 flex-shrink-0",i.value.color])},null,8,["class"])),c("span",ml,x(i.value.label),1),l(o(se),{variant:"secondary",class:"ml-auto text-xs"},{default:r(()=>[C(x(e.entregables.length),1)]),_:1})])]),l(o(xt),{class:"flex-1 p-2"},{default:r(()=>[c("div",{class:"kanban-column-cards space-y-2 min-h-[200px]","data-estado":e.estado},[(u(!0),w(Z,null,fe(e.entregables,f=>(u(),P(Ea,{key:f.id,entregable:f,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,draggable:e.canDrag,variant:"kanban",onView:y=>a("view",f),onEdit:y=>a("edit",f),onDelete:y=>a("delete",f),onComplete:y=>a("complete",f),onChangeStatus:y=>a("change-status",f,y),onShowComentarios:y=>a("show-comentarios",f),onShowActividad:y=>a("show-actividad",f)},null,8,["entregable","can-edit","can-delete","can-complete","draggable","onView","onEdit","onDelete","onComplete","onChangeStatus","onShowComentarios","onShowActividad"]))),128)),e.entregables.length===0?(u(),w("div",pl," Sin entregables ")):_("",!0)],8,gl)]),_:1})],10,ul))}}),hl={class:"kanban-container flex gap-4 overflow-x-auto snap-x snap-mandatory pb-4 px-1 min-w-0"},bl=Pe({__name:"HitosEntregablesKanban",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1},confirmOnDrag:{type:Boolean,default:!0}},emits:["view","edit","delete","complete","change-status","drag-change-status","show-comentarios","show-actividad"],setup(e,{emit:t}){const n=e,a=t,i=rt(n,"entregables"),{entregablesAgrupados:s}=wt(i),d=W(null),m=W([]),v={pendiente:"pendientes",en_progreso:"en_progreso",completado:"completados",cancelado:"cancelados"},f=D=>s.value[v[D]],y=()=>{p(),n.canDrag&&Ia(()=>{document.querySelectorAll(".kanban-column-cards").forEach(b=>{const g=F.create(b,{group:"entregables-kanban",animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",delay:100,delayOnTouchOnly:!0,touchStartThreshold:3,onStart:()=>{},onEnd:h=>{const I=parseInt(h.item.dataset.id||"0"),H=h.to.dataset.estado,j=h.from.dataset.estado;if(d.value=null,H===j)return;const Q=n.entregables.find(T=>T.id===I);Q&&a("drag-change-status",Q,H)},onChange:h=>{const I=h.to.dataset.estado;I&&(d.value=I)}});m.value.push(g)})})},p=()=>{m.value.forEach(D=>{D.destroy()}),m.value=[]};return qa(()=>{y()}),Tn(()=>{p()}),Ce(()=>n.entregables,()=>{Ia(()=>{y()})},{deep:!0}),(D,b)=>(u(),w("div",hl,[(u(!0),w(Z,null,fe(o(pa),g=>(u(),w("div",{key:g,class:"kanban-column flex-shrink-0 w-72 snap-center"},[l(vl,{estado:g,entregables:f(g),"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canDrag,"is-drag-over":d.value===g,onView:b[0]||(b[0]=h=>a("view",h)),onEdit:b[1]||(b[1]=h=>a("edit",h)),onDelete:b[2]||(b[2]=h=>a("delete",h)),onComplete:b[3]||(b[3]=h=>a("complete",h)),onChangeStatus:b[4]||(b[4]=(h,I)=>a("change-status",h,I)),onShowComentarios:b[5]||(b[5]=h=>a("show-comentarios",h)),onShowActividad:b[6]||(b[6]=h=>a("show-actividad",h))},null,8,["estado","entregables","can-edit","can-delete","can-complete","can-drag","is-drag-over"])]))),128))]))}}),yl={class:"space-y-4 min-w-0"},Xa="entregables-confirm-drag",xl=Pe({__name:"HitosEntregablesPanel",props:{entregables:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},initialModalEntregableId:{},initialModalTab:{}},emits:["view","edit","delete","complete","update-status","open-modal","modal-tab-change"],setup(e,{emit:t}){const n=e,a=t,i=rt(n,"entregables"),{viewMode:s}=wt(i),m=W((()=>{const M=localStorage.getItem(Xa);return M===null?!0:M==="true"})()),v=M=>{m.value=M,localStorage.setItem(Xa,String(M))},f=W(!1),y=W(null),p=W("pendiente"),D=W(!1),b=W(!1),g=W(null),h=M=>{a("open-modal",M,"comentarios")},I=M=>{a("open-modal",M,"actividad")};qa(()=>{if(n.initialModalEntregableId){const M=n.entregables.find(q=>q.id===n.initialModalEntregableId);M&&a("open-modal",M,n.initialModalTab||"detalles")}});const H=M=>{a("open-modal",M,"detalles")},j=M=>{a("edit",M)},Q=M=>{g.value=M,b.value=!0},T=()=>{g.value&&a("delete",g.value),b.value=!1,g.value=null},Y=M=>{y.value=M,p.value="completado",f.value=!0},B=(M,q)=>{y.value=M,p.value=q,f.value=!0},S=(M,q)=>{m.value?(y.value=M,p.value=q,f.value=!0):a("update-status",M,q,"",[])},V=(M,q)=>{y.value&&(p.value==="completado"?a("complete",y.value,M,q):a("update-status",y.value,p.value,M,q),f.value=!1,y.value=null)};return(M,q)=>{var re,xe;return u(),w("div",yl,[l(io,{modelValue:o(s),"onUpdate:modelValue":q[0]||(q[0]=A=>An(s)?s.value=A:null),"confirm-on-drag":m.value,"onUpdate:confirmOnDrag":v},null,8,["modelValue","confirm-on-drag"]),o(s)==="list"?(u(),P(Oo,{key:0,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onView:H,onEdit:j,onDelete:Q,onComplete:Y,onChangeStatus:B,onShowComentarios:h,onShowActividad:I},null,8,["entregables","can-edit","can-delete","can-complete"])):o(s)==="tabs"?(u(),P(Vo,{key:1,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,onView:H,onEdit:j,onDelete:Q,onComplete:Y,onChangeStatus:B,onShowComentarios:h,onShowActividad:I},null,8,["entregables","can-edit","can-delete","can-complete"])):o(s)==="kanban"?(u(),P(bl,{key:2,entregables:e.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"can-drag":e.canComplete,"confirm-on-drag":m.value,onView:H,onEdit:j,onDelete:Q,onComplete:Y,onChangeStatus:B,onDragChangeStatus:S,onShowComentarios:h,onShowActividad:I},null,8,["entregables","can-edit","can-delete","can-complete","can-drag","confirm-on-drag"])):_("",!0),l(Ln,{open:f.value,"onUpdate:open":q[1]||(q[1]=A=>f.value=A),"entregable-nombre":(re=y.value)==null?void 0:re.nombre,"estado-actual":(xe=y.value)==null?void 0:xe.estado,"nuevo-estado":p.value,loading:D.value,onConfirm:V},null,8,["open","entregable-nombre","estado-actual","nuevo-estado","loading"]),l(o(Mn),{open:b.value,"onUpdate:open":q[2]||(q[2]=A=>b.value=A)},{default:r(()=>[l(o(Nn),null,{default:r(()=>[l(o(Rn),null,{default:r(()=>[l(o(Fn),null,{default:r(()=>[...q[3]||(q[3]=[C("¿Estás seguro?",-1)])]),_:1}),l(o(Vn),null,{default:r(()=>{var A;return[C(' Esta acción no se puede deshacer. Se eliminará permanentemente el entregable "'+x((A=g.value)==null?void 0:A.nombre)+'". ',1)]}),_:1})]),_:1}),l(o(zn),null,{default:r(()=>[l(o(Bn),null,{default:r(()=>[...q[4]||(q[4]=[C("Cancelar",-1)])]),_:1}),l(o(Hn),{class:"bg-red-600 hover:bg-red-700",onClick:T},{default:r(()=>[...q[5]||(q[5]=[C(" Eliminar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ga={hito:null,estadisticas:null,actividades:[],usuariosActividades:[],usuariosEntregables:[],camposPersonalizados:[],valoresCamposPersonalizados:{},canEdit:!1,canDelete:!1,canManageEntregables:!1,canComplete:!1};function _l(e){const t=W({...Ga}),n=W(!1),a=W(null),i=async()=>{var d,m;if(!e.value){s();return}n.value=!0,a.value=null;try{const v=`/api/proyectos/hitos/${e.value}/detalles`,f=await Ka.get(v);t.value={hito:f.data.hito||null,estadisticas:f.data.estadisticas||null,actividades:f.data.actividades||[],usuariosActividades:f.data.usuariosActividades||[],usuariosEntregables:f.data.usuariosEntregables||[],camposPersonalizados:f.data.camposPersonalizados||[],valoresCamposPersonalizados:f.data.valoresCamposPersonalizados||{},canEdit:f.data.canEdit||!1,canDelete:f.data.canDelete||!1,canManageEntregables:f.data.canManageEntregables||!1,canComplete:f.data.canComplete||!1}}catch(v){console.error("Error al cargar detalles del hito:",v),a.value=((m=(d=v.response)==null?void 0:d.data)==null?void 0:m.message)||"Error al cargar detalles del hito",s()}finally{n.value=!1}},s=()=>{t.value={...Ga}};return{data:t,loading:n,error:a,cargar:i,reset:s}}const wl={class:"flex items-center gap-2 sm:gap-4"},El={class:"flex-1 min-w-0"},Cl={class:"truncate"},Dl={class:"relative"},kl={key:0,class:"absolute inset-0 bg-gradient-to-b from-transparent via-background/50 to-background pointer-events-none"},Sl={class:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full justify-center py-1"},$l={class:"flex flex-wrap gap-3 sm:gap-4 mt-2 sm:mt-3 text-xs sm:text-sm text-muted-foreground"},Il={class:"flex items-center gap-1.5"},Tl={key:0,class:"flex items-center gap-1"},Al={key:1,class:"flex items-center gap-1"},Pl={class:"flex-1 min-h-0 overflow-hidden flex flex-col"},Ol={class:"px-3 py-3 sm:px-6 sm:py-4"},Ml={key:0,class:"space-y-4"},Nl={key:0},Rl={class:"text-sm whitespace-pre-wrap"},Fl={class:"grid gap-4 md:grid-cols-2"},Vl={class:"flex items-center gap-1.5 text-sm"},zl={key:1},Bl={class:"grid grid-cols-2 sm:grid-cols-4 gap-2"},Hl={class:"bg-gray-50 rounded-lg p-2 text-center"},Ul={class:"text-lg font-semibold"},jl={class:"bg-blue-50 rounded-lg p-2 text-center"},Ll={class:"text-lg font-semibold text-blue-700"},Yl={class:"bg-green-50 rounded-lg p-2 text-center"},Xl={class:"text-lg font-semibold text-green-700"},Gl={class:"bg-red-50 rounded-lg p-2 text-center"},Wl={class:"text-lg font-semibold text-red-700"},ql={class:"flex items-center gap-2"},Kl={class:"flex flex-wrap gap-2"},Ql={key:0,class:"text-sm"},Jl={key:1,class:"mt-2"},Zl={class:"grid gap-3 md:grid-cols-2 text-sm"},es={class:"flex items-center justify-between w-full gap-2"},ts={class:"flex gap-1.5 sm:gap-2"},as=Pe({__name:"HitoDetallesModal",props:{open:{type:Boolean},hitoId:{},proyectoId:{},initialTab:{default:"detalles"},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1}},emits:["update:open","update:tab","edit-hito","refresh"],setup(e,{emit:t}){const n=e,a=t,i=rt(n,"hitoId"),{data:s,loading:d,error:m,cargar:v}=_l(i),f=["detalles","comentarios","actividad"],y=W(f.includes(n.initialTab)?n.initialTab:"detalles"),p=W(!1),D=W({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null});Ce(()=>n.open,async B=>{B&&n.hitoId&&(await v(),y.value=f.includes(n.initialTab)?n.initialTab:"detalles")},{immediate:!0}),Ce(()=>n.initialTab,B=>{n.open&&B&&f.includes(B)&&(y.value=B)}),Ce(y,B=>{a("update:tab",B)});const b=J(()=>s.value.hito),g=J(()=>s.value.estadisticas),h=J(()=>{let B=s.value.actividades||[];return D.value.usuario_id&&(B=B.filter(S=>{var V;return((V=S.causer)==null?void 0:V.id)===D.value.usuario_id})),D.value.tipo_entidad&&(B=B.filter(S=>S.subject_type===D.value.tipo_entidad)),D.value.tipo_accion&&(B=B.filter(S=>S.event===D.value.tipo_accion)),(D.value.fecha_inicio||D.value.fecha_fin)&&(B=B.filter(S=>{const V=new Date(S.created_at);if(D.value.fecha_inicio){const M=new Date(D.value.fecha_inicio);if(V<M)return!1}if(D.value.fecha_fin){const M=new Date(D.value.fecha_fin);if(M.setHours(23,59,59,999),V>M)return!1}return!0})),B}),I=B=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[B]||"bg-gray-100 text-gray-800",H=B=>B?Ye(Lt(B),"dd MMM yyyy",{locale:Xe}):"No definida",j=B=>B?Ye(Lt(B),"dd MMM yyyy 'a las' HH:mm",{locale:Xe}):"No definida",Q=J(()=>!n.proyectoId||!n.hitoId?null:`/admin/proyectos/${n.proyectoId}/hitos/${n.hitoId}`),T=()=>{a("update:open",!1)},Y=async()=>{await v(),a("refresh")};return(B,S)=>(u(),P(o(ln),{open:e.open,"onUpdate:open":S[4]||(S[4]=V=>a("update:open",V))},{default:r(()=>[l(o(sn),{class:"w-full sm:w-[95vw] max-w-full sm:!max-w-5xl h-[100dvh] sm:h-auto sm:max-h-[90vh] rounded-none sm:rounded-lg flex flex-col p-0 gap-0 overflow-hidden"},{default:r(()=>[l(o(rn),{class:"flex-shrink-0 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 sm:pb-4 border-b"},{default:r(()=>[o(d)&&!b.value?(u(),w(Z,{key:0},[l(o(Be),{class:"h-7 w-3/4 mb-2"}),l(o(Be),{class:"h-4 w-1/2"})],64)):o(m)?(u(),w(Z,{key:1},[l(o(Ht),{class:"text-destructive"},{default:r(()=>[...S[5]||(S[5]=[C("Error al cargar",-1)])]),_:1}),l(o(Ut),null,{default:r(()=>[C(x(o(m)),1)]),_:1})],64)):b.value?(u(),w(Z,{key:2},[c("div",wl,[c("div",El,[l(o(Ht),{class:"text-lg sm:text-xl flex items-center gap-2"},{default:r(()=>[l(o(ga),{class:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),c("span",Cl,x(b.value.nombre),1)]),_:1})]),l(o(se),{class:ee([I(b.value.estado),"flex-shrink-0 text-xs"])},{default:r(()=>[C(x(b.value.estado_label||b.value.estado),1)]),_:1},8,["class"]),l(o(K),{variant:"ghost",size:"sm",class:"flex-shrink-0 h-8 w-8 p-0",onClick:Y,disabled:o(d),title:"Actualizar"},{default:r(()=>[l(o(pn),{class:ee(["h-4 w-4",{"animate-spin":o(d)}])},null,8,["class"])]),_:1},8,["disabled"])]),l(o(Ut),{class:"mt-1 text-xs sm:text-sm"},{default:r(()=>{var V;return[C(" Proyecto: "+x((V=b.value.proyecto)==null?void 0:V.nombre),1)]}),_:1}),l(o(un),{open:p.value,"onUpdate:open":S[0]||(S[0]=V=>p.value=V),class:"sm:!block"},{default:r(()=>[l(o(Za),{class:"sm:hidden w-full mt-2"},{default:r(()=>[c("div",Dl,[p.value?_("",!0):(u(),w("div",kl)),c("button",Sl,[c("span",null,x(p.value?"Ocultar detalles":"Ver detalles"),1),l(o(xa),{class:ee(["h-3 w-3 transition-transform duration-200",{"rotate-180":p.value}])},null,8,["class"])])])]),_:1}),l(o(cn),{class:"sm:!block"},{default:r(()=>{var V;return[c("div",$l,[c("div",Il,[l(o(Bt),{"model-value":b.value.porcentaje_completado,class:"w-16 sm:w-20 h-2"},null,8,["model-value"]),c("span",null,x(b.value.porcentaje_completado)+"%",1)]),b.value.fecha_fin?(u(),w("div",Tl,[l(o(Ie),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),c("span",{class:ee({"text-red-600":(V=g.value)==null?void 0:V.esta_vencido})},x(H(b.value.fecha_fin)),3)])):_("",!0),b.value.responsable?(u(),w("div",Al,[l(o(tt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),c("span",null,x(b.value.responsable.name),1)])):_("",!0)])]}),_:1})]),_:1},8,["open"])],64)):_("",!0)]),_:1}),c("div",Pl,[l(o(_a),{modelValue:y.value,"onUpdate:modelValue":S[2]||(S[2]=V=>y.value=V),class:"flex-1 min-h-0 flex flex-col"},{default:r(()=>[l(o(wa),{class:"flex-shrink-0 mx-4 sm:mx-6 mt-3 sm:mt-4 justify-start"},{default:r(()=>{var V;return[l(o(Oe),{value:"detalles",label:"Detalles",icon:o(at)},{default:r(()=>[l(o(at),{class:"h-4 w-4 mr-1.5"}),S[6]||(S[6]=C(" Detalles ",-1))]),_:1},8,["icon"]),l(o(Oe),{value:"comentarios",label:"Comentarios",icon:o(We),badge:(V=b.value)==null?void 0:V.total_comentarios},{default:r(()=>{var M;return[l(o(We),{class:"h-4 w-4 mr-1.5"}),S[7]||(S[7]=C(" Comentarios ",-1)),(M=b.value)!=null&&M.total_comentarios?(u(),P(o(se),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[C(x(b.value.total_comentarios),1)]),_:1})):_("",!0)]}),_:1},8,["icon","badge"]),l(o(Oe),{value:"actividad",label:"Actividad",icon:o(qe)},{default:r(()=>[l(o(qe),{class:"h-4 w-4 mr-1.5"}),S[8]||(S[8]=C(" Actividad ",-1))]),_:1},8,["icon"])]}),_:1}),l(o(xt),{class:"flex-1 min-h-0 overflow-y-auto"},{default:r(()=>[c("div",Ol,[o(d)&&!b.value?(u(),w("div",Ml,[l(o(Be),{class:"h-32 w-full"}),l(o(Be),{class:"h-32 w-full"})])):_("",!0),l(o(Me),{value:"detalles",class:"mt-0 space-y-4"},{default:r(()=>[b.value?(u(),w(Z,{key:0},[l(o(we),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...S[9]||(S[9]=[C("Información General",-1)])]),_:1})]),_:1}),l(o(Ee),{class:"space-y-4"},{default:r(()=>{var V;return[b.value.descripcion?(u(),w("div",Nl,[S[10]||(S[10]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Descripción",-1)),c("p",Rl,x(b.value.descripcion),1)])):_("",!0),c("div",Fl,[c("div",null,[S[11]||(S[11]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Inicio",-1)),c("div",Vl,[l(o(Ge),{class:"h-4 w-4"}),C(" "+x(H(b.value.fecha_inicio)),1)])]),c("div",null,[S[12]||(S[12]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Fin",-1)),c("div",{class:ee(["flex items-center gap-1.5 text-sm",{"text-red-600":(V=g.value)==null?void 0:V.esta_vencido}])},[l(o(Ge),{class:"h-4 w-4"}),C(" "+x(H(b.value.fecha_fin)),1)],2)])]),g.value?(u(),w("div",zl,[S[17]||(S[17]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-2"},"Resumen de Entregables",-1)),c("div",Bl,[c("div",Hl,[c("div",Ul,x(g.value.entregables_pendientes),1),S[13]||(S[13]=c("div",{class:"text-xs text-muted-foreground"},"Pendientes",-1))]),c("div",jl,[c("div",Ll,x(g.value.entregables_en_progreso),1),S[14]||(S[14]=c("div",{class:"text-xs text-muted-foreground"},"En Progreso",-1))]),c("div",Yl,[c("div",Xl,x(g.value.entregables_completados),1),S[15]||(S[15]=c("div",{class:"text-xs text-muted-foreground"},"Completados",-1))]),c("div",Gl,[c("div",Wl,x(g.value.entregables_cancelados),1),S[16]||(S[16]=c("div",{class:"text-xs text-muted-foreground"},"Cancelados",-1))])])])):_("",!0)]}),_:1})]),_:1}),b.value.etiquetas&&b.value.etiquetas.length>0?(u(),P(o(we),{key:0},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[c("div",ql,[l(o(gn),{class:"h-4 w-4"}),l(o($e),{class:"text-base"},{default:r(()=>[...S[18]||(S[18]=[C("Etiquetas",-1)])]),_:1})])]),_:1}),l(o(Ee),null,{default:r(()=>[c("div",Kl,[(u(!0),w(Z,null,fe(b.value.etiquetas,V=>(u(),P(o(se),{key:V.id,variant:"outline",class:"px-2.5 py-1",style:Qa({borderColor:V.color||"#94a3b8",color:V.color||"#64748b",backgroundColor:`${V.color}15`||"#f1f5f9"})},{default:r(()=>[C(x(V.nombre),1)]),_:2},1032,["style"]))),128))])]),_:1})]),_:1})):_("",!0),o(s).camposPersonalizados&&o(s).camposPersonalizados.length>0?(u(),P(fn,{key:1,campos:o(s).camposPersonalizados,"valores-campos":o(s).valoresCamposPersonalizados,descripcion:"Información adicional del hito",columns:2},null,8,["campos","valores-campos"])):_("",!0),b.value.parent||b.value.ruta_completa?(u(),P(o(we),{key:2},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...S[19]||(S[19]=[C("Jerarquía",-1)])]),_:1})]),_:1}),l(o(Ee),null,{default:r(()=>[b.value.ruta_completa?(u(),w("div",Ql,[S[20]||(S[20]=c("span",{class:"text-muted-foreground"},"Ruta: ",-1)),C(" "+x(b.value.ruta_completa),1)])):_("",!0),b.value.nivel!==void 0?(u(),w("div",Jl,[l(o(se),{variant:"outline"},{default:r(()=>[C("Nivel "+x(b.value.nivel),1)]),_:1})])):_("",!0)]),_:1})]),_:1})):_("",!0),l(o(we),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...S[21]||(S[21]=[C("Información del Sistema",-1)])]),_:1})]),_:1}),l(o(Ee),null,{default:r(()=>[c("div",Zl,[c("div",null,[S[22]||(S[22]=c("span",{class:"text-muted-foreground"},"Creado: ",-1)),C(" "+x(j(b.value.created_at)),1)]),c("div",null,[S[23]||(S[23]=c("span",{class:"text-muted-foreground"},"Actualizado: ",-1)),C(" "+x(j(b.value.updated_at)),1)])])]),_:1})]),_:1})],64)):_("",!0)]),_:1}),l(o(Me),{value:"comentarios",class:"mt-0"},{default:r(()=>[e.hitoId?(u(),P(mn,{key:0,"commentable-type":"hitos","commentable-id":e.hitoId,"can-create":e.canEdit||o(s).canEdit,embedded:""},null,8,["commentable-id","can-create"])):_("",!0)]),_:1}),l(o(Me),{value:"actividad",class:"mt-0 space-y-4"},{default:r(()=>[o(s).actividades&&o(s).actividades.length>0?(u(),P(an,{key:0,modelValue:D.value,"onUpdate:modelValue":S[1]||(S[1]=V=>D.value=V),usuarios:o(s).usuariosActividades,"context-level":"hito"},null,8,["modelValue","usuarios"])):_("",!0),l(nn,{activities:h.value,title:"Historial de Actividad",description:"Registro de cambios del hito y sus entregables","empty-message":"No hay actividad registrada","show-card":!1},null,8,["activities"])]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),l(o(dn),{class:"flex-shrink-0 px-3 py-3 sm:px-6 sm:py-4 border-t bg-muted/30"},{default:r(()=>[c("div",es,[c("div",ts,[Q.value?(u(),P(o(zt),{key:0,href:Q.value},{default:r(()=>[l(o(K),{variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3"},{default:r(()=>[l(o(jt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),S[24]||(S[24]=c("span",{class:"hidden sm:inline"},"Abrir página completa",-1))]),_:1})]),_:1},8,["href"])):_("",!0),(e.canEdit||o(s).canEdit)&&b.value?(u(),P(o(K),{key:1,variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3",onClick:S[3]||(S[3]=V=>a("edit-hito"))},{default:r(()=>[l(o(_t),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),S[25]||(S[25]=c("span",{class:"hidden sm:inline"},"Editar",-1))]),_:1})):_("",!0)]),l(o(K),{variant:"ghost",size:"sm",class:"text-xs sm:text-sm",onClick:T},{default:r(()=>[...S[26]||(S[26]=[C(" Cerrar ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["open"]))}}),Wa={entregable:null,proyecto:null,hito:null,usuariosAsignados:[],actividades:[],usuariosActividades:[],camposPersonalizados:[],valoresCamposPersonalizados:{},contratosRelacionados:[],canEdit:!1,canDelete:!1,canComplete:!1};function ns(e){const t=W({...Wa}),n=W(!1),a=W(null),i=async()=>{var d,m;if(!e.value){s();return}n.value=!0,a.value=null;try{const v=`/api/proyectos/entregables/${e.value}/detalles`,f=await Ka.get(v);t.value={entregable:f.data.entregable||null,proyecto:f.data.proyecto||null,hito:f.data.hito||null,usuariosAsignados:f.data.usuariosAsignados||[],actividades:f.data.actividades||[],usuariosActividades:f.data.usuariosActividades||[],camposPersonalizados:f.data.camposPersonalizados||[],valoresCamposPersonalizados:f.data.valoresCamposPersonalizados||{},contratosRelacionados:f.data.contratosRelacionados||[],canEdit:f.data.canEdit||!1,canDelete:f.data.canDelete||!1,canComplete:f.data.canComplete||!1}}catch(v){console.error("Error al cargar detalles del entregable:",v),a.value=((m=(d=v.response)==null?void 0:d.data)==null?void 0:m.message)||"Error al cargar detalles del entregable",s()}finally{n.value=!1}},s=()=>{t.value={...Wa}};return{data:t,loading:n,error:a,cargar:i,reset:s}}const os={class:"flex items-center gap-2 sm:gap-4"},ls={class:"flex-1 min-w-0"},ss={class:"truncate"},is={class:"relative"},rs={key:0,class:"absolute inset-0 bg-gradient-to-b from-transparent via-background/50 to-background pointer-events-none"},ds={class:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full justify-center py-1"},us={class:"flex flex-wrap gap-3 sm:gap-4 mt-2 sm:mt-3 text-xs sm:text-sm text-muted-foreground"},cs={class:"flex items-center gap-1.5"},fs={class:"capitalize"},ms={class:"flex items-center gap-1.5"},gs={key:1,class:"flex items-center gap-1"},ps={class:"flex-1 min-h-0 overflow-hidden flex flex-col"},vs={class:"px-3 py-3 sm:px-6 sm:py-4"},hs={key:0,class:"space-y-4"},bs={key:0},ys={class:"text-sm whitespace-pre-wrap"},xs={class:"grid gap-4 md:grid-cols-2"},_s={class:"flex items-center gap-1.5 text-sm"},ws={key:1},Es={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-3"},Cs={class:"flex items-center gap-2 text-green-700 mb-2"},Ds={class:"text-sm text-green-600 space-y-1"},ks={key:0},Ss={key:1},$s={key:2,class:"italic mt-2"},Is={class:"flex items-center gap-2"},Ts={class:"flex flex-wrap gap-2"},As={class:"grid gap-3 md:grid-cols-2 text-sm"},Ps={key:0,class:"flex items-center gap-3"},Os={class:"font-medium"},Ms={class:"text-sm text-muted-foreground"},Ns={key:1,class:"text-muted-foreground"},Rs={key:0,class:"space-y-2"},Fs={class:"flex items-center gap-3"},Vs={class:"font-medium text-sm"},zs={class:"text-xs text-muted-foreground"},Bs={key:1,class:"text-muted-foreground"},Hs={class:"flex items-center justify-between w-full gap-2"},Us={class:"flex gap-1.5 sm:gap-2"},js=Pe({__name:"EntregableDetallesModal",props:{open:{type:Boolean},entregableId:{},proyectoId:{},hitoId:{},initialTab:{default:"detalles"},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1}},emits:["update:open","update:tab","edit-entregable","refresh"],setup(e,{emit:t}){const n=e,a=t,i=rt(n,"entregableId"),{data:s,loading:d,error:m,cargar:v}=ns(i),f=["detalles","equipo","evidencias","comentarios","actividad"],y=W(f.includes(n.initialTab)?n.initialTab:"detalles"),p=W(!1),D=W({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null}),b=W({usuario_id:null,tipo_entidad:null,tipo_accion:null,fecha_inicio:null,fecha_fin:null});Ce(()=>n.open,async A=>{A&&n.entregableId&&(await v(),y.value=f.includes(n.initialTab)?n.initialTab:"detalles")},{immediate:!0}),Ce(()=>n.initialTab,A=>{n.open&&A&&f.includes(A)&&(y.value=A)}),Ce(y,A=>{a("update:tab",A)});const g=J(()=>s.value.entregable),h=J(()=>s.value.proyecto),I=J(()=>s.value.hito),H=J(()=>{var A;return(A=g.value)!=null&&A.fecha_fin?ao(new Date(g.value.fecha_fin),new Date):null}),j=J(()=>!g.value||g.value.estado==="completado"||g.value.estado==="cancelado"?!1:H.value!==null&&H.value<0),Q=J(()=>{var E;let A=((E=g.value)==null?void 0:E.evidencias)||[];return D.value.contrato_id&&(A=A.filter(O=>{var L;return((L=O.obligacion)==null?void 0:L.contrato_id)===D.value.contrato_id})),D.value.tipo&&(A=A.filter(O=>O.tipo_evidencia===D.value.tipo)),D.value.estado&&(A=A.filter(O=>O.estado===D.value.estado)),D.value.usuario_id&&(A=A.filter(O=>{var L;return((L=O.usuario)==null?void 0:L.id)===D.value.usuario_id})),A}),T=J(()=>{const A={};return Q.value.forEach(E=>{var O;if((O=E.obligacion)!=null&&O.contrato){const L=E.obligacion.contrato.id;A[L]||(A[L]={contrato:E.obligacion.contrato,evidencias:[]}),A[L].evidencias.push({...E,obligacion_titulo:E.obligacion.titulo})}}),Object.values(A)}),Y=J(()=>{let A=s.value.actividades||[];return b.value.usuario_id&&(A=A.filter(E=>{var O;return((O=E.causer)==null?void 0:O.id)===b.value.usuario_id})),b.value.tipo_accion&&(A=A.filter(E=>E.event===b.value.tipo_accion)),(b.value.fecha_inicio||b.value.fecha_fin)&&(A=A.filter(E=>{const O=new Date(E.created_at);if(b.value.fecha_inicio){const L=new Date(b.value.fecha_inicio);if(O<L)return!1}if(b.value.fecha_fin){const L=new Date(b.value.fecha_fin);if(L.setHours(23,59,59,999),O>L)return!1}return!0})),A}),B=A=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[A]||"bg-gray-100 text-gray-800",S=A=>({baja:"text-gray-500",media:"text-yellow-500",alta:"text-red-500"})[A]||"",V=A=>A?Ye(Lt(A),"dd MMM yyyy",{locale:Xe}):"No definida",M=A=>A?Ye(Lt(A),"dd MMM yyyy 'a las' HH:mm",{locale:Xe}):"No definida",q=J(()=>{var O,L;const A=n.proyectoId||((O=h.value)==null?void 0:O.id),E=n.hitoId||((L=I.value)==null?void 0:L.id);return!A||!E||!n.entregableId?null:`/admin/proyectos/${A}/hitos/${E}/entregables/${n.entregableId}`}),re=()=>{a("update:open",!1)},xe=async()=>{await v(),a("refresh")};return(A,E)=>(u(),P(o(ln),{open:e.open,"onUpdate:open":E[5]||(E[5]=O=>a("update:open",O))},{default:r(()=>[l(o(sn),{class:"w-full sm:w-[95vw] max-w-full sm:!max-w-5xl h-[100dvh] sm:h-auto sm:max-h-[90vh] rounded-none sm:rounded-lg flex flex-col p-0 gap-0 overflow-hidden"},{default:r(()=>[l(o(rn),{class:"flex-shrink-0 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 sm:pb-4 border-b"},{default:r(()=>[o(d)&&!g.value?(u(),w(Z,{key:0},[l(o(Be),{class:"h-7 w-3/4 mb-2"}),l(o(Be),{class:"h-4 w-1/2"})],64)):o(m)?(u(),w(Z,{key:1},[l(o(Ht),{class:"text-destructive"},{default:r(()=>[...E[6]||(E[6]=[C("Error al cargar",-1)])]),_:1}),l(o(Ut),null,{default:r(()=>[C(x(o(m)),1)]),_:1})],64)):g.value?(u(),w(Z,{key:2},[c("div",os,[c("div",ls,[l(o(Ht),{class:"text-lg sm:text-xl flex items-center gap-2"},{default:r(()=>[l(o(at),{class:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),c("span",ss,x(g.value.nombre),1)]),_:1})]),l(o(se),{class:ee([B(g.value.estado),"flex-shrink-0 text-xs"])},{default:r(()=>[C(x(g.value.estado_label||g.value.estado),1)]),_:1},8,["class"]),l(o(K),{variant:"ghost",size:"sm",class:"flex-shrink-0 h-8 w-8 p-0",onClick:xe,disabled:o(d),title:"Actualizar"},{default:r(()=>[l(o(pn),{class:ee(["h-4 w-4",{"animate-spin":o(d)}])},null,8,["class"])]),_:1},8,["disabled"])]),l(o(Ut),{class:"mt-1 text-xs sm:text-sm"},{default:r(()=>{var O,L;return[C(" Hito: "+x((O=I.value)==null?void 0:O.nombre)+" · Proyecto: "+x((L=h.value)==null?void 0:L.nombre),1)]}),_:1}),l(o(un),{open:p.value,"onUpdate:open":E[0]||(E[0]=O=>p.value=O),class:"sm:!block"},{default:r(()=>[l(o(Za),{class:"sm:hidden w-full mt-2"},{default:r(()=>[c("div",is,[p.value?_("",!0):(u(),w("div",rs)),c("button",ds,[c("span",null,x(p.value?"Ocultar detalles":"Ver detalles"),1),l(o(xa),{class:ee(["h-3 w-3 transition-transform duration-200",{"rotate-180":p.value}])},null,8,["class"])])])]),_:1}),l(o(cn),{class:"sm:!block"},{default:r(()=>[c("div",us,[c("div",cs,[l(o(tn),{class:ee(["h-3.5 w-3.5 sm:h-4 sm:w-4",S(g.value.prioridad)])},null,8,["class"]),c("span",fs,x(g.value.prioridad),1)]),c("div",ms,[l(o(Bt),{"model-value":g.value.porcentaje_completado||0,class:"w-14 sm:w-16 h-2"},null,8,["model-value"]),c("span",null,x(g.value.porcentaje_completado||0)+"%",1)]),H.value!==null?(u(),w("div",{key:0,class:ee(["flex items-center gap-1",{"text-red-600":j.value}])},[l(o(Ie),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),c("span",null,x(j.value?`Vencido hace ${Math.abs(H.value)} días`:H.value===0?"Vence hoy":`${H.value} días`),1)],2)):_("",!0),g.value.responsable?(u(),w("div",gs,[l(o(tt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),c("span",null,x(g.value.responsable.name),1)])):_("",!0)])]),_:1})]),_:1},8,["open"])],64)):_("",!0)]),_:1}),c("div",ps,[l(o(_a),{modelValue:y.value,"onUpdate:modelValue":E[3]||(E[3]=O=>y.value=O),class:"flex-1 min-h-0 flex flex-col"},{default:r(()=>[l(o(wa),{class:"flex-shrink-0 mx-4 sm:mx-6 mt-3 sm:mt-4 justify-start"},{default:r(()=>{var O,L,ve;return[l(o(Oe),{value:"detalles",label:"Detalles",icon:o(at)},{default:r(()=>[l(o(at),{class:"h-4 w-4 mr-1.5"}),E[7]||(E[7]=C(" Detalles ",-1))]),_:1},8,["icon"]),l(o(Oe),{value:"equipo",label:"Equipo",icon:o(ma)},{default:r(()=>[l(o(ma),{class:"h-4 w-4 mr-1.5"}),E[8]||(E[8]=C(" Equipo ",-1))]),_:1},8,["icon"]),l(o(Oe),{value:"evidencias",label:"Evidencias",icon:o(aa),badge:(L=(O=g.value)==null?void 0:O.evidencias)==null?void 0:L.length},{default:r(()=>{var ue,Ke;return[l(o(aa),{class:"h-4 w-4 mr-1.5"}),E[9]||(E[9]=C(" Evidencias ",-1)),(Ke=(ue=g.value)==null?void 0:ue.evidencias)!=null&&Ke.length?(u(),P(o(se),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[C(x(g.value.evidencias.length),1)]),_:1})):_("",!0)]}),_:1},8,["icon","badge"]),l(o(Oe),{value:"comentarios",label:"Comentarios",icon:o(We),badge:(ve=g.value)==null?void 0:ve.total_comentarios},{default:r(()=>{var ue;return[l(o(We),{class:"h-4 w-4 mr-1.5"}),E[10]||(E[10]=C(" Comentarios ",-1)),(ue=g.value)!=null&&ue.total_comentarios?(u(),P(o(se),{key:0,variant:"secondary",class:"ml-1.5 h-5 px-1.5 text-xs"},{default:r(()=>[C(x(g.value.total_comentarios),1)]),_:1})):_("",!0)]}),_:1},8,["icon","badge"]),l(o(Oe),{value:"actividad",label:"Actividad",icon:o(qe)},{default:r(()=>[l(o(qe),{class:"h-4 w-4 mr-1.5"}),E[11]||(E[11]=C(" Actividad ",-1))]),_:1},8,["icon"])]}),_:1}),l(o(xt),{class:"flex-1 min-h-0 overflow-y-auto"},{default:r(()=>[c("div",vs,[o(d)&&!g.value?(u(),w("div",hs,[l(o(Be),{class:"h-32 w-full"}),l(o(Be),{class:"h-32 w-full"})])):_("",!0),l(o(Me),{value:"detalles",class:"mt-0 space-y-4"},{default:r(()=>[g.value?(u(),w(Z,{key:0},[l(o(we),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...E[12]||(E[12]=[C("Información General",-1)])]),_:1})]),_:1}),l(o(Ee),{class:"space-y-4"},{default:r(()=>[g.value.descripcion?(u(),w("div",bs,[E[13]||(E[13]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Descripción",-1)),c("p",ys,x(g.value.descripcion),1)])):_("",!0),c("div",xs,[c("div",null,[E[14]||(E[14]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Inicio",-1)),c("div",_s,[l(o(Ge),{class:"h-4 w-4"}),C(" "+x(V(g.value.fecha_inicio)),1)])]),c("div",null,[E[15]||(E[15]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Fecha de Fin",-1)),c("div",{class:ee(["flex items-center gap-1.5 text-sm",{"text-red-600":j.value}])},[l(o(Ge),{class:"h-4 w-4"}),C(" "+x(V(g.value.fecha_fin)),1)],2)])]),g.value.notas?(u(),w("div",ws,[E[16]||(E[16]=c("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Notas",-1)),l(o(Jn),null,{default:r(()=>[l(o(lt),{class:"h-4 w-4"}),l(o(Zn),null,{default:r(()=>[C(x(g.value.notas),1)]),_:1})]),_:1})])):_("",!0),g.value.estado==="completado"?(u(),w("div",Es,[c("div",Cs,[l(o(st),{class:"h-5 w-5"}),E[17]||(E[17]=c("span",{class:"font-medium"},"Completado",-1))]),c("div",Ds,[g.value.completado_at?(u(),w("div",ks," Fecha: "+x(M(g.value.completado_at)),1)):_("",!0),g.value.completado_por_usuario?(u(),w("div",Ss," Por: "+x(g.value.completado_por_usuario.name),1)):_("",!0),g.value.observaciones_estado?(u(),w("div",$s,' "'+x(g.value.observaciones_estado)+'" ',1)):_("",!0)])])):_("",!0)]),_:1})]),_:1}),g.value.etiquetas&&g.value.etiquetas.length>0?(u(),P(o(we),{key:0},{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[c("div",Is,[l(o(gn),{class:"h-4 w-4"}),l(o($e),{class:"text-base"},{default:r(()=>[...E[18]||(E[18]=[C("Etiquetas",-1)])]),_:1})])]),_:1}),l(o(Ee),null,{default:r(()=>[c("div",Ts,[(u(!0),w(Z,null,fe(g.value.etiquetas,O=>(u(),P(o(se),{key:O.id,variant:"outline",class:"px-2.5 py-1",style:Qa({borderColor:O.color||"#94a3b8",color:O.color||"#64748b",backgroundColor:`${O.color}15`||"#f1f5f9"})},{default:r(()=>[C(x(O.nombre),1)]),_:2},1032,["style"]))),128))])]),_:1})]),_:1})):_("",!0),o(s).camposPersonalizados&&o(s).camposPersonalizados.length>0?(u(),P(fn,{key:1,campos:o(s).camposPersonalizados,"valores-campos":o(s).valoresCamposPersonalizados,descripcion:"Información adicional del entregable",columns:2},null,8,["campos","valores-campos"])):_("",!0),l(o(we),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...E[19]||(E[19]=[C("Información del Sistema",-1)])]),_:1})]),_:1}),l(o(Ee),null,{default:r(()=>[c("div",As,[c("div",null,[E[20]||(E[20]=c("span",{class:"text-muted-foreground"},"Creado: ",-1)),C(" "+x(M(g.value.created_at)),1)]),c("div",null,[E[21]||(E[21]=c("span",{class:"text-muted-foreground"},"Actualizado: ",-1)),C(" "+x(M(g.value.updated_at)),1)]),c("div",null,[E[22]||(E[22]=c("span",{class:"text-muted-foreground"},"Orden: ",-1)),C(" "+x(g.value.orden),1)])])]),_:1})]),_:1})],64)):_("",!0)]),_:1}),l(o(Me),{value:"equipo",class:"mt-0 space-y-4"},{default:r(()=>[g.value?(u(),w(Z,{key:0},[l(o(we),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...E[23]||(E[23]=[C("Responsable Principal",-1)])]),_:1})]),_:1}),l(o(Ee),null,{default:r(()=>[g.value.responsable?(u(),w("div",Ps,[l(o(Pa),{class:"h-10 w-10"},{default:r(()=>[g.value.responsable.avatar?(u(),P(o(Oa),{key:0,src:g.value.responsable.avatar},null,8,["src"])):_("",!0),l(o(Ma),null,{default:r(()=>[C(x(g.value.responsable.name.substring(0,2).toUpperCase()),1)]),_:1})]),_:1}),c("div",null,[c("p",Os,x(g.value.responsable.name),1),c("p",Ms,x(g.value.responsable.email),1)])])):(u(),w("p",Ns,"No hay responsable asignado"))]),_:1})]),_:1}),l(o(we),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[l(o($e),{class:"text-base"},{default:r(()=>[...E[24]||(E[24]=[C("Colaboradores",-1)])]),_:1}),l(o(Qn),null,{default:r(()=>{var O;return[C(x(((O=o(s).usuariosAsignados)==null?void 0:O.length)||0)+" usuarios asignados",1)]}),_:1})]),_:1}),l(o(Ee),null,{default:r(()=>[o(s).usuariosAsignados&&o(s).usuariosAsignados.length>0?(u(),w("div",Rs,[(u(!0),w(Z,null,fe(o(s).usuariosAsignados,O=>(u(),w("div",{key:O.user_id,class:"flex items-center justify-between p-3 bg-muted rounded-lg"},[c("div",Fs,[l(o(Pa),{class:"h-8 w-8"},{default:r(()=>[O.user.avatar?(u(),P(o(Oa),{key:0,src:O.user.avatar},null,8,["src"])):_("",!0),l(o(Ma),null,{default:r(()=>[C(x(O.user.name.substring(0,2).toUpperCase()),1)]),_:2},1024)]),_:2},1024),c("div",null,[c("p",Vs,x(O.user.name),1),c("p",zs,x(O.user.email),1)])]),l(o(se),{variant:"outline",class:"capitalize"},{default:r(()=>[C(x(O.rol),1)]),_:2},1024)]))),128))])):(u(),w("p",Bs,"No hay colaboradores asignados"))]),_:1})]),_:1})],64)):_("",!0)]),_:1}),l(o(Me),{value:"evidencias",class:"mt-0 space-y-4"},{default:r(()=>[g.value?(u(),w(Z,{key:0},[g.value.evidencias&&g.value.evidencias.length>0?(u(),P(qn,{key:0,modelValue:D.value,"onUpdate:modelValue":E[1]||(E[1]=O=>D.value=O),contratos:o(s).contratosRelacionados,evidencias:g.value.evidencias},null,8,["modelValue","contratos","evidencias"])):_("",!0),g.value.evidencias&&g.value.evidencias.length>0?(u(),P(Kn,{key:1,mode:"grouped","evidencias-agrupadas":T.value,"format-date":V},null,8,["evidencias-agrupadas"])):(u(),P(o(we),{key:2},{default:r(()=>[l(o(Ee),{class:"text-center py-8"},{default:r(()=>[l(o(aa),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),E[25]||(E[25]=c("p",{class:"text-muted-foreground"},"No hay evidencias asociadas a este entregable",-1))]),_:1})]),_:1}))],64)):_("",!0)]),_:1}),l(o(Me),{value:"comentarios",class:"mt-0"},{default:r(()=>[e.entregableId?(u(),P(mn,{key:0,"commentable-type":"entregables","commentable-id":e.entregableId,"can-create":e.canEdit||o(s).canEdit,embedded:""},null,8,["commentable-id","can-create"])):_("",!0)]),_:1}),l(o(Me),{value:"actividad",class:"mt-0 space-y-4"},{default:r(()=>[o(s).actividades&&o(s).actividades.length>0?(u(),P(an,{key:0,modelValue:b.value,"onUpdate:modelValue":E[2]||(E[2]=O=>b.value=O),usuarios:o(s).usuariosActividades,"context-level":"entregable"},null,8,["modelValue","usuarios"])):_("",!0),l(nn,{activities:Y.value,title:"Historial de Actividad",description:"Registro de cambios del entregable","empty-message":"No hay actividad registrada","show-card":!1},null,8,["activities"])]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),l(o(dn),{class:"flex-shrink-0 px-3 py-3 sm:px-6 sm:py-4 border-t bg-muted/30"},{default:r(()=>[c("div",Hs,[c("div",Us,[q.value?(u(),P(o(zt),{key:0,href:q.value},{default:r(()=>[l(o(K),{variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3"},{default:r(()=>[l(o(jt),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),E[26]||(E[26]=c("span",{class:"hidden sm:inline"},"Abrir página completa",-1))]),_:1})]),_:1},8,["href"])):_("",!0),(e.canEdit||o(s).canEdit)&&g.value?(u(),P(o(K),{key:1,variant:"outline",size:"sm",class:"text-xs sm:text-sm px-2 sm:px-3",onClick:E[4]||(E[4]=O=>a("edit-entregable"))},{default:r(()=>[l(o(_t),{class:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-1.5"}),E[27]||(E[27]=c("span",{class:"hidden sm:inline"},"Editar",-1))]),_:1})):_("",!0)]),l(o(K),{variant:"ghost",size:"sm",class:"text-xs sm:text-sm",onClick:re},{default:r(()=>[...E[28]||(E[28]=[C(" Cerrar ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["open"]))}}),Ls={class:"flex flex-col md:flex-row h-full min-h-[500px] overflow-hidden bg-background"},Ys={class:"hidden md:flex md:w-72 lg:w-80 flex-col border-r bg-muted/30"},Xs={class:"p-4 border-b bg-background"},Gs={class:"flex items-center justify-between"},Ws={class:"font-semibold text-sm text-muted-foreground uppercase tracking-wide flex items-center gap-2"},qs={key:0,class:"mt-3"},Ks={class:"p-2 space-y-1"},Qs={key:0,class:"p-4 text-center text-muted-foreground text-sm"},Js=["data-active","onClick"],Zs={class:"flex items-center gap-2"},ei={class:"font-medium truncate flex-1"},ti={key:0,class:"mt-1 ml-4 text-xs text-muted-foreground truncate"},ai={class:"flex items-center gap-2 mt-2 ml-4 text-xs text-muted-foreground"},ni={class:"mt-2 ml-4"},oi={class:"flex-1 flex flex-col min-h-0 min-w-0"},li={class:"md:hidden mb-2 border-b bg-background sticky top-0 z-10 space-y-2"},si={class:"flex items-center gap-2"},ii={class:"flex flex-col"},ri={key:0,class:"text-xs text-muted-foreground"},di={class:"text-muted-foreground"},ui={key:0,class:"flex items-center justify-center h-full min-h-[400px]"},ci={class:"text-center space-y-3 max-w-sm p-6"},fi={key:1,class:"p-0 md:p-6 space-y-6 overflow-x-hidden"},mi={class:"flex items-start justify-between gap-4"},gi={class:"flex-1 min-w-0"},pi={class:"flex items-center gap-2 mb-1"},vi={key:0,class:"flex items-center gap-1.5 text-sm text-muted-foreground mt-1"},hi={key:1,class:"text-sm text-muted-foreground mt-2"},bi={class:"space-y-2"},yi={class:"flex justify-between items-center text-sm"},xi={class:"font-medium"},_i={class:"flex flex-wrap gap-4 text-sm"},wi={key:0,class:"flex items-center gap-1.5 text-muted-foreground"},Ei={key:1,class:"flex items-center gap-1.5 text-muted-foreground"},Ci={key:2,class:"flex items-center gap-1.5 text-muted-foreground"},Di={class:"flex flex-wrap gap-2"},ki={class:"space-y-4 min-w-0"},Si={class:"flex items-center justify-between"},$i={class:"font-semibold flex items-center gap-2"},Ii={key:1,class:"text-center py-8 border rounded-lg bg-muted/30"},Er=Pe({__name:"HitosDashboard",props:{hitos:{},proyectoId:{},proyectos:{},selectedProyectoId:{},canEdit:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canManageDeliverables:{type:Boolean,default:!1},canComplete:{type:Boolean,default:!1},showViewDetail:{type:Boolean,default:!0},showProyectoInHito:{type:Boolean,default:!1},baseUrl:{default:"/admin/proyectos"}},emits:["select-hito","edit-hito","delete-hito","view-hito","add-entregable","view-entregable","complete-entregable","update-entregable-status","edit-entregable","delete-entregable","filter-proyecto"],setup(e,{emit:t}){var kt;const n=e,a=t,i=W(((kt=n.selectedProyectoId)==null?void 0:kt.toString())||"_all"),s=J(()=>{if(i.value==="_all")return n.hitos;const z=parseInt(i.value,10);return n.hitos.filter($=>$.proyecto_id===z)}),d=z=>{i.value=z,f.value=null;const $=z!=="_all"?parseInt(z,10):null;a("filter-proyecto",$)};Pn("(max-width: 768px)");const m=()=>{const $=new URLSearchParams(window.location.search).get("hito");return $?parseInt($,10):null},v=()=>{const z=new URLSearchParams(window.location.search),$=z.get("modal"),ie=z.get("modal_tab")||"detalles";return $==="hito"?{type:"hito",tab:ie}:$!=null&&$.startsWith("entregable_")?{type:"entregable",entregableId:parseInt($.replace("entregable_",""),10),tab:ie}:{type:null,tab:"detalles"}},f=W(m()),y=v(),p=J(()=>s.value.find(z=>z.id===f.value)??null),D=J(()=>n.proyectoId?n.proyectoId:p.value?p.value.proyecto_id:null),b=J(()=>D.value?`${n.baseUrl}/${D.value}/hitos`:null),g=J(()=>!p.value||!D.value?null:`${n.baseUrl}/${D.value}/hitos/${p.value.id}/entregables`);Ce(f,z=>{if(z){const $=window.location.pathname,ie=new URLSearchParams(window.location.search);ie.set("hito",String(z));const he=`${$}?${ie.toString()}`;Ta.get(he,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]}),a("select-hito",z)}});const h=z=>{f.value=z},I=z=>{const $=parseInt(z,10);isNaN($)||h($)},H=z=>z?Ye(new Date(z),"dd MMM yyyy",{locale:Xe}):"Sin fecha",j=z=>({pendiente:"bg-gray-100 text-gray-800",en_progreso:"bg-blue-100 text-blue-800",completado:"bg-green-100 text-green-800",cancelado:"bg-red-100 text-red-800"})[z]||"bg-gray-100 text-gray-800",Q=z=>({pendiente:"bg-gray-400",en_progreso:"bg-blue-500 animate-pulse",completado:"bg-green-500",cancelado:"bg-red-500"})[z]||"bg-gray-400",T=z=>{p.value&&a("view-entregable",z,p.value)},Y=(z,$,ie)=>{a("complete-entregable",z,$,ie)},B=(z,$,ie,he)=>{a("update-entregable-status",z,$,ie,he)},S=z=>{p.value&&a("edit-entregable",z,p.value)},V=z=>{p.value&&a("delete-entregable",z,p.value)},M=()=>{p.value&&a("edit-hito",p.value)},q=()=>{p.value&&a("delete-hito",p.value)},re=()=>{p.value&&a("add-entregable",p.value)},xe=()=>{p.value&&(E.value="detalles",A.value=!0)},A=W(y.type==="hito"),E=W(y.type==="hito"?y.tab:"detalles"),O=W(y.type==="entregable"),L=W(y.entregableId||null),ve=W(y.type==="entregable"?y.tab:"detalles"),ue=(z,$,ie)=>{const he=window.location.pathname,N=new URLSearchParams(window.location.search);z==="hito"?(N.set("modal","hito"),ie&&N.set("modal_tab",ie)):z==="entregable"&&$?(N.set("modal",`entregable_${$}`),ie&&N.set("modal_tab",ie)):(N.delete("modal"),N.delete("modal_tab"),N.delete("pagina"));const St=`${he}?${N.toString()}`;Ta.get(St,{},{preserveState:!0,preserveScroll:!0,replace:!0,only:[]})};Ce([A,E],([z,$])=>{z?ue("hito",void 0,$):new URLSearchParams(window.location.search).get("modal")==="hito"&&ue(null)}),Ce([O,ve],([z,$])=>{if(z&&L.value)ue("entregable",L.value,$);else{const he=new URLSearchParams(window.location.search).get("modal");he!=null&&he.startsWith("entregable_")&&ue(null)}});const Ke=(z,$="detalles")=>{L.value=z.id,ve.value=$,O.value=!0},$a=()=>{E.value="comentarios",A.value=!0},Dt=()=>{E.value="actividad",A.value=!0};return(z,$)=>{var ie,he;return u(),w("div",Ls,[c("aside",Ys,[c("div",Xs,[c("div",Gs,[c("h2",Ws,[l(o(ga),{class:"h-4 w-4"}),C(" Hitos ("+x(s.value.length)+") ",1)]),e.showViewDetail&&b.value?(u(),P(o(zt),{key:0,href:b.value},{default:r(()=>[l(o(K),{variant:"outline",size:"sm"},{default:r(()=>[l(o(jt),{class:"h-3.5 w-3.5 mr-1"}),$[7]||($[7]=C(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):_("",!0)]),e.proyectos&&e.proyectos.length>0?(u(),w("div",qs,[l(o(Jt),{"model-value":i.value,"onUpdate:modelValue":d},{default:r(()=>[l(o(Zt),{class:"w-full h-9 text-sm"},{default:r(()=>[l(o(ea),{placeholder:"Todos los proyectos"})]),_:1}),l(o(ta),null,{default:r(()=>[l(o(dt),{value:"_all"},{default:r(()=>[...$[8]||($[8]=[C("Todos los proyectos",-1)])]),_:1}),(u(!0),w(Z,null,fe(e.proyectos,N=>(u(),P(o(dt),{key:N.id,value:N.id.toString()},{default:r(()=>[C(x(N.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])])):_("",!0)]),l(o(xt),{class:"flex-1"},{default:r(()=>[c("div",Ks,[s.value.length===0?(u(),w("div",Qs," No hay hitos definidos ")):_("",!0),(u(!0),w(Z,null,fe(s.value,N=>(u(),w("button",{key:N.id,"data-active":f.value===N.id,class:"w-full text-left p-3 rounded-lg transition-colors duration-150 hover:bg-accent hover:text-accent-foreground data-[active=true]:bg-primary/10 data-[active=true]:text-primary data-[active=true]:border-l-2 data-[active=true]:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",onClick:St=>h(N.id)},[c("div",Zs,[c("div",{class:ee([Q(N.estado),"w-2 h-2 rounded-full flex-shrink-0"])},null,2),c("span",ei,x(N.nombre),1),f.value===N.id?(u(),P(o(en),{key:0,class:"h-4 w-4 flex-shrink-0 text-primary"})):_("",!0)]),e.showProyectoInHito&&N.proyecto?(u(),w("div",ti,x(N.proyecto.nombre),1)):_("",!0),c("div",ai,[l(o(se),{class:ee([j(N.estado),"text-[10px] px-1.5 py-0"])},{default:r(()=>[C(x(N.estado_label||N.estado),1)]),_:2},1032,["class"]),c("span",null,x(N.porcentaje_completado)+"%",1)]),c("div",ni,[l(o(Bt),{"model-value":N.porcentaje_completado,class:"h-1"},null,8,["model-value"])])],8,Js))),128))])]),_:1})]),c("main",oi,[c("div",li,[e.proyectos&&e.proyectos.length>0?(u(),P(o(Jt),{key:0,"model-value":i.value,"onUpdate:modelValue":d},{default:r(()=>[l(o(Zt),{class:"w-full h-9 text-sm"},{default:r(()=>[l(o(ea),{placeholder:"Todos los proyectos"})]),_:1}),l(o(ta),null,{default:r(()=>[l(o(dt),{value:"_all"},{default:r(()=>[...$[9]||($[9]=[C("Todos los proyectos",-1)])]),_:1}),(u(!0),w(Z,null,fe(e.proyectos,N=>(u(),P(o(dt),{key:N.id,value:N.id.toString()},{default:r(()=>[C(x(N.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])):_("",!0),l(o(Jt),{"model-value":((ie=f.value)==null?void 0:ie.toString())||"","onUpdate:modelValue":I},{default:r(()=>[l(o(Zt),{class:"w-full"},{default:r(()=>[l(o(ea),{placeholder:"Selecciona un hito"})]),_:1}),l(o(ta),null,{default:r(()=>[(u(!0),w(Z,null,fe(s.value,N=>(u(),P(o(dt),{key:N.id,value:N.id.toString()},{default:r(()=>[c("div",si,[c("div",{class:ee([Q(N.estado),"w-2 h-2 rounded-full"])},null,2),c("div",ii,[c("span",null,x(N.nombre),1),e.showProyectoInHito&&N.proyecto?(u(),w("span",ri,x(N.proyecto.nombre),1)):_("",!0)]),c("span",di,"("+x(N.porcentaje_completado)+"%)",1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),l(o(xt),{class:"flex-1"},{default:r(()=>[p.value?(u(),w("div",fi,[l(o(we),null,{default:r(()=>[l(o(Se),{class:"pb-3"},{default:r(()=>[c("div",mi,[c("div",gi,[c("div",pi,[c("div",{class:ee([Q(p.value.estado),"w-2.5 h-2.5 rounded-full"])},null,2),l(o($e),{class:"text-xl truncate"},{default:r(()=>[C(x(p.value.nombre),1)]),_:1})]),e.showProyectoInHito&&p.value.proyecto?(u(),w("div",vi,[l(o(eo),{class:"h-4 w-4"}),c("span",null,x(p.value.proyecto.nombre),1)])):_("",!0),p.value.descripcion?(u(),w("p",hi,x(p.value.descripcion),1)):_("",!0)]),l(o(se),{class:ee(j(p.value.estado))},{default:r(()=>[C(x(p.value.estado_label||p.value.estado),1)]),_:1},8,["class"])])]),_:1}),l(o(Ee),{class:"space-y-4"},{default:r(()=>[c("div",bi,[c("div",yi,[$[12]||($[12]=c("span",{class:"text-muted-foreground"},"Progreso",-1)),c("span",xi,x(p.value.porcentaje_completado)+"%",1)]),l(o(Bt),{"model-value":p.value.porcentaje_completado,class:"h-2"},null,8,["model-value"])]),c("div",_i,[p.value.fecha_inicio?(u(),w("div",wi,[l(o(Ge),{class:"h-4 w-4"}),c("span",null,"Inicio: "+x(H(p.value.fecha_inicio)),1)])):_("",!0),p.value.fecha_fin?(u(),w("div",Ei,[l(o(Ie),{class:"h-4 w-4"}),c("span",null,"Fin: "+x(H(p.value.fecha_fin)),1)])):_("",!0),p.value.responsable?(u(),w("div",Ci,[l(o(tt),{class:"h-4 w-4"}),c("span",null,x(p.value.responsable.name),1)])):_("",!0)]),l(o(On)),c("div",Di,[e.canEdit?(u(),P(o(K),{key:0,variant:"outline",size:"sm",onClick:M},{default:r(()=>[l(o(_t),{class:"h-4 w-4 mr-1.5"}),$[13]||($[13]=C(" Editar Hito ",-1))]),_:1})):_("",!0),e.canManageDeliverables?(u(),P(o(K),{key:1,variant:"outline",size:"sm",onClick:re},{default:r(()=>[l(o(Na),{class:"h-4 w-4 mr-1.5"}),$[14]||($[14]=C(" Añadir Entregable ",-1))]),_:1})):_("",!0),e.showViewDetail?(u(),P(o(K),{key:2,variant:"ghost",size:"sm",onClick:xe},{default:r(()=>[l(o(na),{class:"h-4 w-4 mr-1.5"}),$[15]||($[15]=C(" Ver detalles ",-1))]),_:1})):_("",!0),l(o(K),{variant:"ghost",size:"sm",onClick:$a},{default:r(()=>[l(o(We),{class:"h-4 w-4 mr-1.5"}),$[16]||($[16]=C(" Comentarios ",-1)),p.value.comentarios_count&&p.value.comentarios_count>0?(u(),P(o(se),{key:0,variant:"secondary",class:"ml-1.5 text-xs"},{default:r(()=>[C(x(p.value.comentarios_count),1)]),_:1})):_("",!0)]),_:1}),l(o(K),{variant:"ghost",size:"sm",onClick:Dt},{default:r(()=>[l(o(qe),{class:"h-4 w-4 mr-1.5"}),$[17]||($[17]=C(" Actividad ",-1))]),_:1}),e.canDelete?(u(),P(o(K),{key:3,variant:"ghost",size:"sm",class:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:q},{default:r(()=>[l(o(on),{class:"h-4 w-4 mr-1.5"}),$[18]||($[18]=C(" Eliminar ",-1))]),_:1})):_("",!0)])]),_:1})]),_:1}),c("div",ki,[c("div",Si,[c("h3",$i,[l(o(na),{class:"h-5 w-5"}),$[19]||($[19]=C(" Entregables ",-1)),l(o(se),{variant:"secondary",class:"ml-1"},{default:r(()=>{var N;return[C(x(((N=p.value.entregables)==null?void 0:N.length)||0),1)]}),_:1})]),e.showViewDetail&&g.value?(u(),P(o(zt),{key:0,href:g.value},{default:r(()=>[l(o(K),{variant:"outline",size:"sm"},{default:r(()=>[l(o(jt),{class:"h-3.5 w-3.5 mr-1"}),$[20]||($[20]=C(" Ver todos ",-1))]),_:1})]),_:1},8,["href"])):_("",!0)]),p.value.entregables&&p.value.entregables.length>0?(u(),P(o(xl),{key:0,entregables:p.value.entregables,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-complete":e.canComplete,"initial-modal-entregable-id":o(y).type==="entregable"?o(y).entregableId:void 0,"initial-modal-tab":o(y).type==="entregable"?o(y).tab:void 0,onView:T,onComplete:Y,onUpdateStatus:B,onEdit:S,onDelete:V,onOpenModal:Ke,onModalTabChange:$[0]||($[0]=(N,St)=>{L.value=N,ve.value=St})},null,8,["entregables","can-edit","can-delete","can-complete","initial-modal-entregable-id","initial-modal-tab"])):(u(),w("div",Ii,[l(o(na),{class:"h-10 w-10 mx-auto text-muted-foreground/50 mb-3"}),$[22]||($[22]=c("p",{class:"text-muted-foreground text-sm"},"No hay entregables en este hito",-1)),e.canManageDeliverables?(u(),P(o(K),{key:0,variant:"outline",size:"sm",class:"mt-4",onClick:re},{default:r(()=>[l(o(Na),{class:"h-4 w-4 mr-1.5"}),$[21]||($[21]=C(" Crear primer entregable ",-1))]),_:1})):_("",!0)]))])])):(u(),w("div",ui,[c("div",ci,[l(o(ga),{class:"h-16 w-16 mx-auto text-muted-foreground/50"}),$[10]||($[10]=c("h3",{class:"font-medium text-lg"},"Selecciona un hito",-1)),$[11]||($[11]=c("p",{class:"text-sm text-muted-foreground"}," Elige un hito de la lista para ver sus detalles y entregables ",-1))])]))]),_:1})]),p.value?(u(),P(as,{key:0,open:A.value,"onUpdate:open":$[1]||($[1]=N=>A.value=N),"hito-id":p.value.id,"proyecto-id":D.value||0,"initial-tab":E.value,"can-edit":e.canEdit,"can-delete":e.canDelete,"can-manage-entregables":e.canManageDeliverables,"onUpdate:tab":$[2]||($[2]=N=>E.value=N),onEditHito:M,onViewEntregable:T,onEditEntregable:S,onAddEntregable:re},null,8,["open","hito-id","proyecto-id","initial-tab","can-edit","can-delete","can-manage-entregables"])):_("",!0),L.value?(u(),P(js,{key:1,open:O.value,"onUpdate:open":[$[3]||($[3]=N=>O.value=N),$[6]||($[6]=N=>{N||(L.value=null)})],"entregable-id":L.value,"proyecto-id":D.value,"hito-id":(he=p.value)==null?void 0:he.id,"initial-tab":ve.value,"can-edit":e.canEdit,"can-delete":e.canDelete,"onUpdate:tab":$[4]||($[4]=N=>ve.value=N),onEditEntregable:$[5]||($[5]=()=>p.value&&S({id:L.value}))},null,8,["open","entregable-id","proyecto-id","hito-id","initial-tab","can-edit","can-delete"])):_("",!0)])}}});export{Er as _};
