import{_ as ie,a as te,b as oe,c as se}from"./CardTitle.vue_vue_type_script_setup_true_lang-DYxclH40.js";import{_ as M}from"./Label.vue_vue_type_script_setup_true_lang-C0Y6AGVd.js";import{a as T,b as U,c as E,_ as A,d as P}from"./SelectValue.vue_vue_type_script_setup_true_lang-WmfZ5qRR.js";import{d as de,k,c as v,y as re,w as ue,p as ne,j as h,o as u,l as X,u as t,n as ce,e as s,i as _,b as d,f as Y,g as f,t as c,a as p,r as F,F as G,H as w}from"./app-uqgoC9P3.js";const me={class:"text-sm text-muted-foreground"},pe={class:"w-full"},fe={key:0,class:"text-xs text-muted-foreground mt-1"},ve={key:0,class:"w-full"},_e={key:0,class:"text-xs text-muted-foreground mt-1"},he={key:1,class:"w-full"},ge={key:0,class:"text-xs text-muted-foreground mt-1"},we={key:2,class:"w-full"},ye={key:0,class:"text-xs text-muted-foreground mt-1"},ke=de({__name:"GeographicSelector",props:{modelValue:{default:()=>({territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[]})},disabled:{type:Boolean,default:!1},title:{default:"Ubicación Geográfica"},description:{default:"Selecciona la ubicación"},mode:{default:"multiple"},showCard:{type:Boolean,default:!0},municipioLabel:{default:"Municipio"},showLocalidad:{type:Boolean,default:!0},showDepartamento:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(Z,{emit:I}){const n=Z,ee=I,q=k([]),L=k([]),C=k([]),B=k([]),m=k(!1),o=v(()=>n.mode==="multiple"),y=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.territorios_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.territorio_id;return l?[l]:[]}}),g=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.departamentos_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.departamento_id;return l?[l]:[]}}),b=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.municipios_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.municipio_id;return l?[l]:[]}}),z=v(()=>{var e,a;if(o.value)return((e=n.modelValue)==null?void 0:e.localidades_ids)||[];{const l=(a=n.modelValue)==null?void 0:a.localidad_id;return l?[l]:[]}}),J=re();v(()=>{var e;return((e=J.props.auth)==null?void 0:e.isAdmin)||!1});const ae=v(()=>{var e;return!!((e=J.props.auth)!=null&&e.user)}),j=v(()=>ae.value?window.location.pathname.startsWith("/admin")?"/admin/geographic":"/api/geographic":"/api/public/geographic");ue(g,e=>{e.length>0&&N(e)},{immediate:!1});const le=async()=>{try{m.value=!0;const e=await fetch(`${j.value}/territorios`);q.value=await e.json()}catch(e){console.error("Error loading territorios:",e)}finally{m.value=!1}},H=async e=>{if(!e.length){L.value=[];return}try{m.value=!0;const a=await fetch(`${j.value}/departamentos?territorio_ids=${e.join(",")}`);L.value=await a.json()}catch(a){console.error("Error loading departamentos:",a)}finally{m.value=!1}},N=async e=>{if(!e.length){C.value=[];return}try{m.value=!0;const a=await fetch(`${j.value}/municipios?departamento_ids=${e.join(",")}`);C.value=await a.json()}catch(a){console.error("Error loading municipios:",a)}finally{m.value=!1}},W=async e=>{if(!e.length){B.value=[];return}try{m.value=!0;const a=await fetch(`${j.value}/localidades?municipio_ids=${e.join(",")}`);B.value=await a.json()}catch(a){console.error("Error loading localidades:",a)}finally{m.value=!1}},x=(e,a)=>{var V,$,S,i,K,O,Q,R;let l;if(o.value){const r=Array.isArray(e)?e.map(Number).filter(Boolean):e?[Number(e)].filter(Boolean):[];l={territorios_ids:((V=n.modelValue)==null?void 0:V.territorios_ids)||[],departamentos_ids:(($=n.modelValue)==null?void 0:$.departamentos_ids)||[],municipios_ids:((S=n.modelValue)==null?void 0:S.municipios_ids)||[],localidades_ids:((i=n.modelValue)==null?void 0:i.localidades_ids)||[]},a==="territorio"?(l.territorios_ids=r,l.departamentos_ids=[],l.municipios_ids=[],l.localidades_ids=[],w(()=>H(r))):a==="departamento"?(l.departamentos_ids=r,l.municipios_ids=[],l.localidades_ids=[],w(()=>N(r))):a==="municipio"?(l.municipios_ids=r,l.localidades_ids=[],w(()=>W(r))):a==="localidad"&&(l.localidades_ids=r)}else{const r=e?Number(e):void 0;l={territorio_id:(K=n.modelValue)==null?void 0:K.territorio_id,departamento_id:(O=n.modelValue)==null?void 0:O.departamento_id,municipio_id:(Q=n.modelValue)==null?void 0:Q.municipio_id,localidad_id:(R=n.modelValue)==null?void 0:R.localidad_id},a==="territorio"?(l.territorio_id=r,l.departamento_id=void 0,l.municipio_id=void 0,l.localidad_id=void 0,w(()=>H(r?[r]:[]))):a==="departamento"?(l.departamento_id=r,l.municipio_id=void 0,l.localidad_id=void 0,w(()=>N(r?[r]:[]))):a==="municipio"?(l.municipio_id=r,l.localidad_id=void 0,w(()=>W(r?[r]:[]))):a==="localidad"&&(l.localidad_id=r)}ee("update:modelValue",l)};ne(async()=>{await le(),y.value.length&&await H(y.value),g.value.length&&await N(g.value),b.value.length&&await W(b.value)});const D=(e,a,l)=>o.value?`${e} ${e===1?a:l} seleccionado${e===1?"":"s"}`:"";return(e,a)=>(u(),h(X(e.showCard?t(ie):"div"),{class:ce(e.showCard?"border-dashed":"")},{default:s(()=>[e.showCard?(u(),h(t(te),{key:0},{default:s(()=>[d(t(oe),{class:"text-base"},{default:s(()=>[f(c(e.title),1)]),_:1}),Y("p",me,c(e.description),1)]),_:1})):_("",!0),(u(),h(X(e.showCard?t(se):"div"),{class:"space-y-4"},{default:s(()=>{var l,V,$,S;return[Y("div",pe,[d(t(M),null,{default:s(()=>[f("Territorio"+c(o.value?"s":""),1)]),_:1}),d(t(A),{"model-value":o.value?y.value.map(i=>i.toString()):((l=y.value[0])==null?void 0:l.toString())||"","onUpdate:modelValue":a[0]||(a[0]=i=>x(i,"territorio")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(t(T),{class:"w-full"},{default:s(()=>[d(t(U),{placeholder:`Seleccionar territorio${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),d(t(E),null,{default:s(()=>[(u(!0),p(G,null,F(q.value,i=>(u(),h(t(P),{key:i.id,value:i.id.toString()},{default:s(()=>[f(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",fe,c(D(y.value.length,"territorio","territorios")),1)):_("",!0)]),e.showDepartamento&&L.value.length>0?(u(),p("div",ve,[d(t(M),null,{default:s(()=>[f("Departamento"+c(o.value?"s":""),1)]),_:1}),d(t(A),{"model-value":o.value?g.value.map(i=>i.toString()):((V=g.value[0])==null?void 0:V.toString())||"","onUpdate:modelValue":a[1]||(a[1]=i=>x(i,"departamento")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(t(T),{class:"w-full"},{default:s(()=>[d(t(U),{placeholder:`Seleccionar departamento${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),d(t(E),null,{default:s(()=>[(u(!0),p(G,null,F(L.value,i=>(u(),h(t(P),{key:i.id,value:i.id.toString()},{default:s(()=>[f(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",_e,c(D(g.value.length,"departamento","departamentos")),1)):_("",!0)])):_("",!0),C.value.length>0?(u(),p("div",he,[d(t(M),null,{default:s(()=>[f(c(e.municipioLabel)+c(o.value?"s":""),1)]),_:1}),d(t(A),{"model-value":o.value?b.value.map(i=>i.toString()):(($=b.value[0])==null?void 0:$.toString())||"","onUpdate:modelValue":a[2]||(a[2]=i=>x(i,"municipio")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(t(T),{class:"w-full"},{default:s(()=>[d(t(U),{placeholder:`Seleccionar ${e.municipioLabel.toLowerCase()}${o.value?"s":""}...`},null,8,["placeholder"])]),_:1}),d(t(E),null,{default:s(()=>[(u(!0),p(G,null,F(C.value,i=>(u(),h(t(P),{key:i.id,value:i.id.toString()},{default:s(()=>[f(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",ge,c(D(b.value.length,e.municipioLabel.toLowerCase(),e.municipioLabel.toLowerCase()+"s")),1)):_("",!0)])):_("",!0),e.showLocalidad&&B.value.length>0?(u(),p("div",we,[d(t(M),null,{default:s(()=>[f("Localidad"+c(o.value?"es":""),1)]),_:1}),d(t(A),{"model-value":o.value?z.value.map(i=>i.toString()):((S=z.value[0])==null?void 0:S.toString())||"","onUpdate:modelValue":a[3]||(a[3]=i=>x(i,"localidad")),multiple:o.value,disabled:e.disabled||m.value},{default:s(()=>[d(t(T),{class:"w-full"},{default:s(()=>[d(t(U),{placeholder:`Seleccionar localidad${o.value?"es":""}...`},null,8,["placeholder"])]),_:1}),d(t(E),null,{default:s(()=>[(u(!0),p(G,null,F(B.value,i=>(u(),h(t(P),{key:i.id,value:i.id.toString()},{default:s(()=>[f(c(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","multiple","disabled"]),o.value?(u(),p("p",ye,c(D(z.value.length,"localidad","localidades")),1)):_("",!0)])):_("",!0)]}),_:1}))]),_:1},8,["class"]))}});export{ke as _};
