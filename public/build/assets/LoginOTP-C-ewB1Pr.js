import{d as F,B as ne,c as B,k as $,w as Z,j as S,o as p,e as w,y as j,b,u as e,z,s as ee,v as te,A as O,x as se,C as L,a as k,i as D,f as m,m as re,g as C,t as M,h as Q,n as ie,F as ue,r as de}from"./app-aD7ckayy.js";import{_ as W}from"./InputError.vue_vue_type_script_setup_true_lang-BwxaPNGs.js";import{P as U,a as H,_ as T}from"./AppLogo.vue_vue_type_script_setup_true_lang-Cspnvc-F.js";import{u as ce,b as pe,r as G,_ as Y,a as me}from"./Label.vue_vue_type_script_setup_true_lang-C-ININDd.js";import{u as fe,c as ve,a as ge,g as _e,d as ye,b as ae}from"./VisuallyHidden-B5wuTxRJ.js";import{V as he}from"./VisuallyHiddenInput-BXHUz2Wf.js";import{L as K,_ as be}from"./AuthLayout.vue_vue_type_script_setup_true_lang-DJtEtDbb.js";import{M as xe}from"./mail-hqdHwair.js";const we=["INPUT","TEXTAREA"];function Ve(u,n,a,i={}){if(!n||i.enableIgnoredElement&&we.includes(n.nodeName))return null;const{arrowKeyOptions:r="both",attributeName:c="[data-reka-collection-item]",itemsArray:d=[],loop:f=!0,dir:v="ltr",preventScroll:h=!0,focus:_=!1}=i,[E,x,I,P,N,A]=[u.key==="ArrowRight",u.key==="ArrowLeft",u.key==="ArrowUp",u.key==="ArrowDown",u.key==="Home",u.key==="End"],V=I||P,s=E||x;if(!N&&!A&&(!V&&!s||r==="vertical"&&s||r==="horizontal"&&V))return null;const l=d;if(!l.length)return null;h&&u.preventDefault();let g=null;return s||V?g=le(l,n,{goForward:V?P:v==="ltr"?E:x,loop:f}):N?g=l.at(0)||null:A&&(g=l.at(-1)||null),_&&(g==null||g.focus()),g}function le(u,n,a,i=u.length){if(--i===0)return null;const r=u.indexOf(n),c=a.goForward?r+1:r-1;if(!a.loop&&(c<0||c>=u.length))return null;const d=(c+u.length)%u.length,f=u[d];return f?f.hasAttribute("disabled")&&f.getAttribute("disabled")!=="false"?le(u,f,a,i):f:null}const[ke,Ce]=ve("PinInputRoot");var Ee=F({inheritAttrs:!1,__name:"PinInputRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:Array,required:!1},placeholder:{type:String,required:!1,default:""},mask:{type:Boolean,required:!1},otp:{type:Boolean,required:!1},type:{type:null,required:!1,default:"text"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","complete"],setup(u,{emit:n}){const a=u,i=n,{mask:r,otp:c,placeholder:d,type:f,disabled:v,dir:h}=ne(a),{forwardRef:_}=ce(),E=fe(h),x=pe(a,"modelValue",i,{defaultValue:a.defaultValue??[],passive:a.modelValue===void 0}),I=B(()=>Array.isArray(x.value)?[...x.value]:[]),P=$(new Set);function N(s){P.value.add(s)}const A=B(()=>a.type==="number"),V=B(()=>I.value.filter(l=>!!l||A.value&&l===0).length===P.value.size);return Z(x,()=>{V.value&&i("complete",x.value)},{deep:!0}),Ce({modelValue:x,currentModelValue:I,mask:r,otp:c,placeholder:d,type:f,dir:E,disabled:v,isCompleted:V,inputElements:P,onInputElementChange:N,isNumericMode:A}),(s,l)=>(p(),S(e(U),z(s.$attrs,{ref:e(_),dir:e(E),"data-complete":V.value?"":void 0,"data-disabled":e(v)?"":void 0}),{default:w(()=>[j(s.$slots,"default",{modelValue:e(x)}),b(he,{id:s.id,as:"input",feature:"focusable",tabindex:"-1",value:I.value.join(""),name:s.name??"",disabled:e(v),required:s.required,onFocus:l[0]||(l[0]=g=>{var t,o;return(o=(t=Array.from(P.value))==null?void 0:t[0])==null?void 0:o.focus()})},null,8,["id","value","name","disabled","required"])]),_:3},16,["dir","data-complete","data-disabled"]))}}),Ie=Ee,Pe=F({__name:"PinInputInput",props:{index:{type:Number,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},setup(u){const n=u,a=ke(),i=B(()=>Array.from(a.inputElements.value)),r=B(()=>a.currentModelValue.value[n.index]),c=B(()=>n.disabled||a.disabled.value),d=B(()=>a.otp.value),f=B(()=>a.mask.value),{primitiveElement:v,currentElement:h}=ge();function _(t){var q;const o=t.target;if((((q=t.data)==null?void 0:q.length)??0)>1){s(o.value);return}if(a.isNumericMode.value&&!/^\d*$/.test(o.value)){o.value=o.value.replace(/\D/g,"");return}o.value=t.data??"",g(n.index,o.value);const y=i.value[n.index+1];y&&y.focus()}function E(){const t=h.value;se(()=>{t&&!t.value&&(t.placeholder=a.placeholder.value)})}function x(t){Ve(t,_e(),void 0,{itemsArray:i.value,focus:!0,loop:!1,arrowKeyOptions:"horizontal",dir:a.dir.value})}function I(t){if(t.preventDefault(),t.target.value)g(n.index,"");else{const q=i.value[n.index-1];q&&(q.focus(),g(n.index-1,""))}}function P(t){t.key==="Delete"&&(t.preventDefault(),g(n.index,""))}function N(t){const o=t.target;o.setSelectionRange(1,1),o.value||(o.placeholder="")}function A(t){E()}function V(t){t.preventDefault();const o=t.clipboardData;if(!o)return;const y=o.getData("text");s(y)}function s(t){var X;const o=[...a.currentModelValue.value],y=t.length>=i.value.length?0:n.index,q=Math.min(y+t.length,i.value.length);for(let R=y;R<q;R++){const oe=i.value[R],J=t[R-y];a.isNumericMode.value&&!/^\d*$/.test(J)||(o[R]=J,oe.focus())}a.modelValue.value=o,(X=i.value[q])==null||X.focus()}function l(t){let o=t.length-1;for(;o>=0&&t[o]==="";)t.pop(),o--;return t}function g(t,o){const y=[...a.currentModelValue.value];if(a.isNumericMode.value){const q=+o;o===""||isNaN(q)?delete y[t]:y[t]=q}else y[t]=o;a.modelValue.value=l(y)}return Z(r,()=>{r.value||E()}),ee(()=>{a.onInputElementChange(h.value)}),te(()=>{var t;(t=a.inputElements)==null||t.value.delete(h.value)}),(t,o)=>(p(),S(e(U),{ref_key:"primitiveElement",ref:v,autocapitalize:"none",as:t.as,"as-child":t.asChild,autocomplete:d.value?"one-time-code":"false",type:f.value?"password":"text",inputmode:e(a).isNumericMode.value?"numeric":"text",pattern:e(a).isNumericMode.value?"[0-9]*":void 0,placeholder:e(a).placeholder.value,value:r.value,disabled:c.value,"data-disabled":c.value?"":void 0,"data-complete":e(a).isCompleted.value?"":void 0,"aria-label":`pin input ${t.index+1} of ${i.value.length}`,onInput:o[0]||(o[0]=y=>_(y)),onKeydown:[O(x,["left","right","up","down","home","end"]),O(I,["backspace"]),O(P,["delete"])],onFocus:N,onBlur:A,onPaste:V},{default:w(()=>[j(t.$slots,"default")]),_:3},8,["as","as-child","autocomplete","type","inputmode","pattern","placeholder","value","disabled","data-disabled","data-complete","aria-label"]))}}),qe=Pe;const Be=F({__name:"PinInput",props:{modelValue:{default:()=>[]},defaultValue:{},placeholder:{},mask:{type:Boolean},otp:{type:Boolean},type:{},dir:{},disabled:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue","complete"],setup(u,{emit:n}){const a=u,i=n,r=G(a,"class"),c=ye(r,i);return(d,f)=>(p(),S(e(Ie),z({"data-slot":"pin-input"},e(c),{class:e(H)("flex items-center gap-2 has-disabled:opacity-50 disabled:cursor-not-allowed",a.class)}),{default:w(()=>[j(d.$slots,"default")]),_:3},16,["class"]))}}),Me=F({__name:"PinInputGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const n=u,a=G(n,"class"),i=ae(a);return(r,c)=>(p(),S(e(U),z({"data-slot":"pin-input-group"},e(i),{class:e(H)("flex items-center",n.class)}),{default:w(()=>[j(r.$slots,"default")]),_:3},16,["class"]))}}),Se=F({__name:"PinInputSlot",props:{index:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(u){const n=u,a=G(n,"class"),i=ae(a);return(r,c)=>(p(),S(e(qe),z({"data-slot":"pin-input-slot"},e(i),{class:e(H)("border-input focus:border-ring focus:ring-ring/50 focus:aria-invalid:ring-destructive/20 dark:bg-input/30 dark:focus:aria-invalid:ring-destructive/40 aria-invalid:border-destructive focus:aria-invalid:border-destructive relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none text-center first:rounded-l-md first:border-l last:rounded-r-md focus:z-10 focus:ring-[3px]",n.class)}),null,16,["class"]))}}),Ae={key:0,class:"mb-4 text-center text-muted-foreground"},Ne={key:0},$e={key:1},Fe={key:1,class:"mb-4 text-center text-muted-foreground"},Re={key:2,class:"mb-4 text-center text-sm font-medium text-green-600"},De={class:"grid gap-6"},Te={class:"grid gap-2"},je={class:"relative"},ze={class:"grid gap-6"},Oe={class:"text-center"},Le={class:"text-sm text-muted-foreground"},Ke={key:0},Ue={class:"font-medium"},He={key:1},Ge={class:"font-medium"},Xe={class:"font-medium"},Je={class:"grid gap-2"},Qe={class:"flex justify-center"},We={class:"flex flex-col gap-3"},Ye={class:"flex flex-col gap-2 text-center"},Ze={class:"mt-6 text-center text-xs text-muted-foreground"},et={key:0},tt={key:1},dt=F({__name:"LoginOTP",props:{status:{},authConfig:{},censoredEmail:{},otpCredential:{}},setup(u){const n=u,a=$(n.censoredEmail?"otp":"credential"),i=$(n.censoredEmail||""),r=B(()=>n.authConfig||{login_type:"email",input_type:"email",placeholder:"correo@ejemplo.com",pattern:null,label:"Correo Electrónico"}),c=L({credential:""}),d=L({credential:n.otpCredential||"",otp_code:[]}),f=L({credential:"",otp_code:""}),v=$(!1),h=$(0),_=$(null),E=B(()=>h.value===0),x=B(()=>h.value>0?`Reenviar en ${h.value}s`:"Reenviar código"),I=(s=60)=>{h.value=s,_.value&&clearInterval(_.value),_.value=window.setInterval(()=>{h.value--,h.value<=0&&(clearInterval(_.value),_.value=null)},1e3)},P=()=>{v.value=!0,c.post(route("auth.request-otp"),{onSuccess:s=>{s.props&&s.props.censoredEmail&&(i.value=s.props.censoredEmail),a.value="otp",d.credential=c.credential,d.clearErrors(),I(60)},onError:()=>{},onFinish:()=>{v.value=!1}})},N=()=>{const s=d.otp_code.join("");f.credential=d.credential,f.otp_code=s,f.post(route("auth.verify-otp"),{onSuccess:()=>{},onError:()=>{d.otp_code=[]}})},A=()=>{E.value&&(v.value=!0,d.post(route("auth.resend-otp"),{onSuccess:s=>{s.props&&s.props.censoredEmail&&(i.value=s.props.censoredEmail),I(60)},onFinish:()=>{v.value=!1}}))},V=()=>{a.value="credential",d.reset(),_.value&&(clearInterval(_.value),_.value=null),h.value=0};return ee(()=>{a.value==="otp"&&I(60)}),te(()=>{_.value&&clearInterval(_.value)}),(s,l)=>(p(),S(be,{title:a.value==="credential"?"Iniciar Sesión":"Verificar Código"},{default:w(()=>[b(e(re),{title:"Iniciar Sesión"}),a.value==="credential"?(p(),k("div",Ae,[r.value.login_type==="documento"?(p(),k("p",Ne,l[2]||(l[2]=[C(" Ingresa tu documento de identidad para recibir el código de verificación "),m("strong",null,"vía correo electrónico",-1)]))):(p(),k("p",$e," Ingresa tu "+M(r.value.label.toLowerCase())+" para recibir el código de verificación ",1))])):(p(),k("div",Fe,l[3]||(l[3]=[m("p",null,"Ingresa el código de 6 dígitos enviado a tu correo",-1)]))),s.status?(p(),k("div",Re,M(s.status),1)):D("",!0),a.value==="credential"?(p(),k("form",{key:3,onSubmit:Q(P,["prevent"]),class:"flex flex-col gap-6"},[m("div",De,[m("div",Te,[b(e(Y),{for:"credential"},{default:w(()=>[C(M(r.value.label),1)]),_:1}),m("div",je,[r.value.login_type==="email"?(p(),S(e(xe),{key:0,class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"})):D("",!0),b(e(me),{id:"credential",type:r.value.input_type,required:"",autofocus:"",tabindex:"1",autocomplete:r.value.login_type==="email"?"email":"off",inputmode:r.value.login_type==="documento"?"numeric":void 0,modelValue:e(c).credential,"onUpdate:modelValue":l[0]||(l[0]=g=>e(c).credential=g),placeholder:r.value.placeholder,pattern:r.value.pattern,class:ie({"pl-10":r.value.login_type==="email"})},null,8,["type","autocomplete","inputmode","modelValue","placeholder","pattern","class"])]),b(W,{message:e(c).errors.credential},null,8,["message"])]),b(e(T),{type:"submit",class:"mt-4 w-full",tabindex:"2",disabled:e(c).processing||v.value},{default:w(()=>[e(c).processing||v.value?(p(),S(e(K),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):D("",!0),C(" "+M(e(c).processing||v.value?"Enviando...":"Enviar Código"),1)]),_:1},8,["disabled"])])],32)):(p(),k("form",{key:4,onSubmit:Q(N,["prevent"]),class:"flex flex-col gap-6"},[m("div",ze,[m("div",Oe,[m("p",Le,[r.value.login_type==="email"?(p(),k("span",Ke,[l[4]||(l[4]=C(" Código enviado al email ")),m("span",Ue,M(i.value||e(d).credential),1)])):(p(),k("span",He,[l[5]||(l[5]=C(" Código enviado al email ")),m("span",Ge,M(i.value),1),l[6]||(l[6]=C(" asociado al documento ")),m("span",Xe,M(e(d).credential),1)]))])]),m("div",Je,[b(e(Y),{class:"text-center"},{default:w(()=>l[7]||(l[7]=[C("Código de Verificación")])),_:1}),m("div",Qe,[b(e(Be),{modelValue:e(d).otp_code,"onUpdate:modelValue":l[1]||(l[1]=g=>e(d).otp_code=g),length:6,type:"text",placeholder:"0",class:"gap-2"},{default:w(()=>[b(e(Me),null,{default:w(()=>[(p(),k(ue,null,de(6,(g,t)=>b(e(Se),{key:g,index:t,class:"h-12 w-12 text-lg font-medium",inputmode:"numeric"},null,8,["index"])),64))]),_:1})]),_:1},8,["modelValue"])]),b(W,{message:e(d).errors.otp_code},null,8,["message"])]),m("div",We,[b(e(T),{type:"submit",class:"w-full",disabled:e(f).processing||e(d).otp_code.join("").length!==6},{default:w(()=>[e(f).processing?(p(),S(e(K),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):D("",!0),C(" "+M(e(f).processing?"Verificando...":"Verificar Código"),1)]),_:1},8,["disabled"]),m("div",Ye,[b(e(T),{type:"button",variant:"ghost",size:"sm",onClick:A,disabled:!E.value||v.value},{default:w(()=>[v.value?(p(),S(e(K),{key:0,class:"mr-2 h-3 w-3 animate-spin"})):D("",!0),C(" "+M(v.value?"Enviando...":x.value),1)]),_:1},8,["disabled"]),b(e(T),{type:"button",variant:"ghost",size:"sm",onClick:V},{default:w(()=>[C(M(r.value.login_type==="email"?"Cambiar correo electrónico":"Cambiar documento"),1)]),_:1})])])])],32)),m("div",Ze,[a.value==="credential"?(p(),k("p",et," Solo personas registradas como militantes pueden acceder al sistema. ")):(p(),k("p",tt," El código expira en 10 minutos. Si no lo recibes, verifica tu bandeja de spam. ")),l[8]||(l[8]=m("br",null,null,-1)),l[9]||(l[9]=m("p",null,[C(" Si necesitas ayuda escribe a "),m("b",null,"soporte@colombiahumana.co"),C(" para soporte sobre la plataforma. Para inquietudes jurídicas a "),m("b",null,"juridicoelectoral@colombiahumana.co")],-1))])]),_:1},8,["title"]))}});export{dt as default};
