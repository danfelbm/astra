import{d as A,r as h,C as M,i as m,e as d,f as s,u as e,p as T,w as r,g as l,b as y,j as u,P as k,h as n,l as L,t as p,F as V,k as S}from"./app-BFCRP-hu.js";import{_ as O}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DVhxtwsQ.js";import{_ as w,a as z,b as C,c as q}from"./CardTitle.vue_vue_type_script_setup_true_lang-C6Pf_Uif.js";import{_ as U}from"./CardDescription.vue_vue_type_script_setup_true_lang-C5iYxevR.js";import{_ as b}from"./createLucideIcon-B48W5HGR.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-BArk2Dro.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-BSsD_nCa.js";import{_ as X}from"./Textarea.vue_vue_type_script_setup_true_lang-BvpXtNVw.js";import{_ as P,a as H,b as D,c as E,d as $}from"./SelectValue.vue_vue_type_script_setup_true_lang-D4BkPhEO.js";import{_ as G}from"./CamposPersonalizadosForm.vue_vue_type_script_setup_true_lang-DV0xaFzQ.js";import{E as J}from"./EtiquetaSelector-DXljy2iI.js";import{_ as K}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-DthL8b9_.js";import{t as j}from"./index-D4Jmcyj5.js";import{A as Q}from"./arrow-left-BiabW1KV.js";import{X as W}from"./x-CO2t7227.js";import{U as Y}from"./user-plus-BFKQiVAB.js";import{S as Z}from"./save-BGOcn2DT.js";import{T as ee}from"./tag-BD_pJCyF.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-IDczqvjz.js";import"./index-BV8EXJV5.js";import"./floating-ui.vue-r1jh_cyr.js";import"./index-7Cc0L9l5.js";import"./shield-CJLgSpbM.js";import"./user-B1UdYhgU.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Bk1MyGsx.js";import"./chevron-right-jEjsThLi.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-it7-95jd.js";import"./VisuallyHidden-DtgZKa-V.js";import"./index-D4t36AHs.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-dTZ0TTmN.js";import"./circle-alert-Crqw8R8y.js";import"./map-pin-96AKVoID.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-Bn4JBZsL.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Dy-9tXTd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-B5X7TeC-.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C1tM4KQo.js";import"./users-D4nlGR3z.js";import"./target-BG-rBVrT.js";import"./vote-CRb2uBrD.js";import"./folder-open-CdHVd2oB.js";import"./send-B06MTMiq.js";import"./file-text-BNtX5jn7.js";import"./briefcase-DvfVQ7DM.js";import"./calendar-_r6_tYhJ.js";import"./megaphone-Dd-rvhjG.js";import"./user-check-CmuxQ_fm.js";import"./clipboard-list-BbsP5NSE.js";import"./mail-C7hV_ozf.js";import"./message-square-2Ae9CC_o.js";import"./external-link-DVqz8Mr1.js";import"./panel-left-BSTwYg9i.js";import"./index-C4A356_A.js";import"./check-50anzA7W.js";import"./index-BZv-jeFa.js";import"./nullish-CHIgUVhi.js";import"./CampoPersonalizadoInput.vue_vue_type_script_setup_true_lang-CVnM9dLg.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BPQOfPUO.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-OjjH6Oyn.js";import"./RovingFocusItem-DIFJgx_h.js";import"./utils-DHSP7tfB.js";import"./VisuallyHiddenInput-BsNXVvQm.js";import"./circle-Cc_4kpMQ.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-B4ApdS_d.js";import"./TabsTrigger.vue_vue_type_script_setup_true_lang-KlWRsGd7.js";import"./index-BkDoy_-v.js";import"./search-DzHipmqi.js";import"./useKbd-kRIii9yh.js";import"./useEtiquetaHierarchy-B_CuIAZi.js";import"./list-CQPYaV--.js";import"./tree-pine-DJFe6Cey.js";import"./plus-DUQ5nN3r.js";import"./zap-DWKEr6EP.js";import"./layers-DFj5lvvO.js";import"./trending-up-DtR6o0cj.js";import"./award-wiB2F5Sn.js";import"./flag-KNsaGE_a.js";import"./hash-C6CBAZk_.js";import"./loader-circle-BlBV89L7.js";import"./chevron-left-Bh0KDQsI.js";const oe={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},se={class:"flex items-center justify-between"},te={class:"space-y-2"},re={key:0,class:"text-sm text-red-500"},ie={class:"space-y-2"},ae={key:0,class:"text-sm text-red-500"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={class:"space-y-2"},de={key:0,class:"text-sm text-red-500"},pe={class:"space-y-2"},me={key:0,class:"text-sm text-red-500"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe={class:"space-y-2"},ce={key:0,class:"text-sm text-red-500"},_e={class:"space-y-2"},be={class:"space-y-2"},ve={key:0,class:"p-3 bg-muted rounded-lg flex items-center justify-between"},ye={class:"font-medium"},ge={class:"text-sm text-muted-foreground"},he={key:0,class:"text-sm text-red-500"},Ve={key:0,class:"space-y-2"},xe={key:0,class:"text-sm text-red-500"},$e={class:"flex justify-end gap-2 pt-4"},Wo=A({__name:"Create",props:{proyecto:{},responsables:{},hitosDisponibles:{},camposPersonalizados:{},categorias:{},estados:{},siguienteOrden:{}},setup(I){const _=I,R=[{title:"Admin",href:"/admin/dashboard"},{title:"Proyectos",href:"/admin/proyectos"},{title:_.proyecto.nombre,href:`/admin/proyectos/${_.proyecto.id}`},{title:"Hitos",href:`/admin/proyectos/${_.proyecto.id}/hitos`},{title:"Crear Hito",href:"#"}],g=h(!1),{route:N}=window,f=h(null),v=h(new Map);_.responsables.forEach(a=>v.value.set(a.id,a));const t=M({nombre:"",descripcion:"",fecha_inicio:"",fecha_fin:"",estado:"pendiente",responsable_id:null,parent_id:null,campos_personalizados:{},etiquetas:[],orden:_.siguienteOrden,crear_entregables_predefinidos:!1}),B=a=>{if(a.userIds.length>0){const o=a.userIds[0];t.responsable_id=o,v.value.has(o)?f.value=v.value.get(o)||null:(f.value={id:o,name:`Usuario seleccionado (ID: ${o})`,email:"Se actualizará al guardar"},v.value.set(o,f.value))}},F=()=>{t.post(`/admin/proyectos/${_.proyecto.id}/hitos`,{onSuccess:()=>{j.success("Hito creado exitosamente")},onError:()=>{j.error("Error al crear el hito")}})};return(a,o)=>(d(),m(V,null,[s(e(T),{title:`Crear Hito - ${a.proyecto.nombre}`},null,8,["title"]),s(O,{breadcrumbs:R},{default:r(()=>[l("div",oe,[l("div",se,[o[12]||(o[12]=l("h1",{class:"text-2xl font-bold"},"Crear Nuevo Hito",-1)),s(e(k),{href:`/admin/proyectos/${a.proyecto.id}/hitos`},{default:r(()=>[s(e(b),{variant:"outline",size:"sm"},{default:r(()=>[s(e(Q),{class:"h-4 w-4 mr-2"}),o[11]||(o[11]=n(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),s(e(w),null,{default:r(()=>[s(e(z),null,{default:r(()=>[s(e(C),null,{default:r(()=>[...o[13]||(o[13]=[n("Información del Hito",-1)])]),_:1}),s(e(U),null,{default:r(()=>[...o[14]||(o[14]=[n(" Define los detalles del nuevo hito para el proyecto ",-1)])]),_:1})]),_:1}),s(e(q),null,{default:r(()=>[l("form",{onSubmit:L(F,["prevent"]),class:"space-y-6"},[l("div",te,[s(e(c),{for:"nombre",required:""},{default:r(()=>[...o[15]||(o[15]=[n("Nombre del Hito",-1)])]),_:1}),s(e(x),{id:"nombre",modelValue:e(t).nombre,"onUpdate:modelValue":o[0]||(o[0]=i=>e(t).nombre=i),type:"text",placeholder:"Ej: Pre-producción",disabled:e(t).processing},null,8,["modelValue","disabled"]),e(t).errors.nombre?(d(),m("span",re,p(e(t).errors.nombre),1)):u("",!0)]),l("div",ie,[s(e(c),{for:"descripcion"},{default:r(()=>[...o[16]||(o[16]=[n("Descripción",-1)])]),_:1}),s(e(X),{id:"descripcion",modelValue:e(t).descripcion,"onUpdate:modelValue":o[1]||(o[1]=i=>e(t).descripcion=i),placeholder:"Describe el objetivo y alcance del hito...",disabled:e(t).processing,rows:"3"},null,8,["modelValue","disabled"]),e(t).errors.descripcion?(d(),m("span",ae,p(e(t).errors.descripcion),1)):u("",!0)]),l("div",le,[l("div",ne,[s(e(c),{for:"fecha_inicio"},{default:r(()=>[...o[17]||(o[17]=[n("Fecha de Inicio",-1)])]),_:1}),s(e(x),{id:"fecha_inicio",modelValue:e(t).fecha_inicio,"onUpdate:modelValue":o[2]||(o[2]=i=>e(t).fecha_inicio=i),type:"date",disabled:e(t).processing},null,8,["modelValue","disabled"]),e(t).errors.fecha_inicio?(d(),m("span",de,p(e(t).errors.fecha_inicio),1)):u("",!0)]),l("div",pe,[s(e(c),{for:"fecha_fin"},{default:r(()=>[...o[18]||(o[18]=[n("Fecha de Fin",-1)])]),_:1}),s(e(x),{id:"fecha_fin",modelValue:e(t).fecha_fin,"onUpdate:modelValue":o[3]||(o[3]=i=>e(t).fecha_fin=i),type:"date",disabled:e(t).processing},null,8,["modelValue","disabled"]),e(t).errors.fecha_fin?(d(),m("span",me,p(e(t).errors.fecha_fin),1)):u("",!0)])]),l("div",ue,[l("div",fe,[s(e(c),{for:"estado"},{default:r(()=>[...o[19]||(o[19]=[n("Estado Inicial",-1)])]),_:1}),s(e(P),{modelValue:e(t).estado,"onUpdate:modelValue":o[4]||(o[4]=i=>e(t).estado=i)},{default:r(()=>[s(e(H),null,{default:r(()=>[s(e(D),{placeholder:"Seleccionar estado"})]),_:1}),s(e(E),null,{default:r(()=>[(d(!0),m(V,null,S(a.estados,i=>(d(),y(e($),{key:i.value,value:i.value},{default:r(()=>[n(p(i.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(t).errors.estado?(d(),m("span",ce,p(e(t).errors.estado),1)):u("",!0)]),l("div",_e,[s(e(c),{for:"responsable_id"},{default:r(()=>[...o[20]||(o[20]=[n("Responsable",-1)])]),_:1}),l("div",be,[f.value?(d(),m("div",ve,[l("div",null,[l("p",ye,p(f.value.name),1),l("p",ge,p(f.value.email),1)]),s(e(b),{type:"button",variant:"ghost",size:"sm",onClick:o[5]||(o[5]=i=>{e(t).responsable_id=null,f.value=null})},{default:r(()=>[s(e(W),{class:"h-4 w-4"})]),_:1})])):u("",!0),s(e(b),{type:"button",variant:"outline",onClick:o[6]||(o[6]=i=>g.value=!0),class:"w-full"},{default:r(()=>[s(e(Y),{class:"h-4 w-4 mr-2"}),n(" "+p(f.value?"Cambiar Responsable":"Seleccionar Responsable"),1)]),_:1})]),e(t).errors.responsable_id?(d(),m("span",he,p(e(t).errors.responsable_id),1)):u("",!0)])]),a.hitosDisponibles&&a.hitosDisponibles.length>0?(d(),m("div",Ve,[s(e(c),{for:"parent_id"},{default:r(()=>[...o[21]||(o[21]=[n("Hito Padre (opcional)",-1)])]),_:1}),s(e(P),{modelValue:e(t).parent_id,"onUpdate:modelValue":o[7]||(o[7]=i=>e(t).parent_id=i)},{default:r(()=>[s(e(H),null,{default:r(()=>[s(e(D),{placeholder:"Sin padre (raíz)"})]),_:1}),s(e(E),null,{default:r(()=>[s(e($),{value:null},{default:r(()=>[...o[22]||(o[22]=[n("Sin padre (raíz)",-1)])]),_:1}),(d(!0),m(V,null,S(a.hitosDisponibles,i=>(d(),y(e($),{key:i.id,value:i.id},{default:r(()=>[n(p("—".repeat(i.nivel))+" "+p(i.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),o[23]||(o[23]=l("p",{class:"text-sm text-muted-foreground"},"Selecciona un hito padre para crear una jerarquía",-1)),e(t).errors.parent_id?(d(),m("span",xe,p(e(t).errors.parent_id),1)):u("",!0)])):u("",!0),l("div",$e,[s(e(k),{href:`/admin/proyectos/${a.proyecto.id}/hitos`},{default:r(()=>[s(e(b),{type:"button",variant:"outline"},{default:r(()=>[...o[24]||(o[24]=[n("Cancelar",-1)])]),_:1})]),_:1},8,["href"]),s(e(b),{type:"submit",disabled:e(t).processing},{default:r(()=>[s(e(Z),{class:"h-4 w-4 mr-2"}),o[25]||(o[25]=n(" Crear Hito ",-1))]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),a.camposPersonalizados&&a.camposPersonalizados.length>0?(d(),y(G,{key:0,campos:a.camposPersonalizados,valores:e(t).campos_personalizados,errors:e(t).errors,onUpdate:o[8]||(o[8]=i=>e(t).campos_personalizados=i)},null,8,["campos","valores","errors"])):u("",!0),a.categorias&&a.categorias.length>0?(d(),y(e(w),{key:1},{default:r(()=>[s(e(z),null,{default:r(()=>[s(e(C),{class:"flex items-center gap-2"},{default:r(()=>[s(e(ee),{class:"h-5 w-5"}),o[26]||(o[26]=n(" Etiquetas ",-1))]),_:1}),s(e(U),null,{default:r(()=>[...o[27]||(o[27]=[n(" Asigna etiquetas para categorizar y organizar este hito ",-1)])]),_:1})]),_:1}),s(e(q),null,{default:r(()=>[s(J,{modelValue:e(t).etiquetas,"onUpdate:modelValue":o[9]||(o[9]=i=>e(t).etiquetas=i),categorias:a.categorias,"max-etiquetas":10,placeholder:"Seleccionar etiquetas para el hito...",description:"Puedes asignar hasta 10 etiquetas"},null,8,["modelValue","categorias"])]),_:1})]),_:1})):u("",!0)]),s(K,{modelValue:g.value,"onUpdate:modelValue":o[10]||(o[10]=i=>g.value=i),title:"Seleccionar Responsable del Hito",description:"Selecciona el usuario que será responsable de este hito","search-endpoint":e(N)("admin.proyectos.search-users"),"excluded-ids":e(t).responsable_id?[e(t).responsable_id]:[],"max-selection":1,"submit-button-text":"Seleccionar Responsable","search-placeholder":"Buscar por nombre, email, documento o teléfono...",onSubmit:B},null,8,["modelValue","search-endpoint","excluded-ids"])]),_:1})],64))}});export{Wo as default};
