import{d as G,r as O,c as S,i as v,e as a,f as t,q as R,w as i,g as o,t as d,b as g,j as p,v as M,h as r,m as u,F as A,k as B,s as J}from"./app-CC6H0n1q.js";import{_ as K}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DdJPECtB.js";import{c as Q,_ as H}from"./createLucideIcon-dYX5Zc3c.js";import{_ as b,a as _,b as h,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-cEX4BYE9.js";import{_ as L}from"./CardDescription.vue_vue_type_script_setup_true_lang-oS66W6XP.js";import{_ as C}from"./index-BF-_iLjl.js";import{_ as W}from"./Label.vue_vue_type_script_setup_true_lang-CI7Ki7bk.js";import{_ as X,a as Y,b as j,c as I}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-CthgBOzu.js";import{_ as Z,a as tt,b as et}from"./index-Bsa4GyCh.js";import{_ as at}from"./AccordionContent.vue_vue_type_script_setup_true_lang-BQjL0aRr.js";import{_ as it}from"./EvidenciasTable.vue_vue_type_script_setup_true_lang-IrLZGoRC.js";import{O as lt}from"./ObligacionTree-CIPQrEYy.js";import{u as ot}from"./usePermissions-BnXjsJ1X.js";import{A as st}from"./arrow-left-2z5OHtyZ.js";import{P as nt}from"./pencil-20ZKZQwy.js";import{I as rt}from"./info-Br8a2ECS.js";import{I as dt}from"./image-_tj8U-VA.js";import{A as ut}from"./activity-CmyF9U0A.js";import{P as ct}from"./paperclip-Dzt3sLqz.js";import{f as P,e as N}from"./es-BDPlFIsO.js";import{p as T}from"./parseISO-DFjB8F03.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-C1PFtUZo.js";import"./index-B8bg8Nrt.js";import"./floating-ui.vue-DZrrCFxg.js";import"./x-Cqilunz3.js";import"./Input.vue_vue_type_script_setup_true_lang-S95rAL8g.js";import"./index-Dge68ev1.js";import"./shield-DRPmygLT.js";import"./user-BTw1JOop.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BQwV_Hph.js";import"./chevron-right-W6qPy3jE.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-mmg45jHQ.js";import"./VisuallyHidden-CyESNmVu.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-2Hoc4pax.js";import"./check-Bqnp2acg.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BrhKiRkX.js";import"./index-BEudbUTF.js";import"./circle-alert-CdXWy-z_.js";import"./map-pin-RkriYLtf.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-DFW1Td8_.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Cw57zajU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-aGUzHs0D.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DN1I8f-L.js";import"./tag-NWJc8qg8.js";import"./users-diRFbZaQ.js";import"./target-DrkLGRcQ.js";import"./vote-CarmRsxj.js";import"./folder-open-BYYpPfbm.js";import"./send-PI08Xgln.js";import"./file-text-m-9M3IAO.js";import"./briefcase-BEoSukY8.js";import"./calendar-Bem_9K7u.js";import"./megaphone-BJ_gUWIR.js";import"./user-check-Be6i_Nhu.js";import"./clipboard-list-o2S6DZJo.js";import"./mail-DAqRm0Xh.js";import"./message-square-B3HF2G6I.js";import"./external-link-D082l1yM.js";import"./panel-left-CLQkozqV.js";import"./index-g3trHRXx.js";import"./RovingFocusItem-YyKJZHMi.js";import"./utils-CPpBABdm.js";import"./useArrowNavigation-B5rxJs06.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-AkneQieB.js";import"./download-CG4jbtWH.js";import"./Separator.vue_vue_type_script_setup_true_lang-Tnu8Yz3q.js";import"./TooltipProvider.vue_vue_type_script_setup_true_lang-DVDjt7Tp.js";import"./circle-D1FLyBNA.js";import"./layers-DuOK-8z5.js";import"./plus-Ds3Ob7OJ.js";import"./trash-2-BoYCW7_4.js";import"./loader-circle-CTj9aK9-.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Q("ListTreeIcon",[["path",{d:"M21 12h-8",key:"1bmf0i"}],["path",{d:"M21 6H8",key:"1pqkrb"}],["path",{d:"M21 18h-8",key:"1tm79t"}],["path",{d:"M3 6v4c0 1.1.9 2 2 2h3",key:"1ywdgy"}],["path",{d:"M3 10v6c0 1.1.9 2 2 2h3",key:"2wc746"}]]),ft={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},pt={class:"flex items-center justify-between"},vt={class:"text-3xl font-bold"},gt={class:"text-muted-foreground mt-2"},bt={class:"flex gap-2"},_t={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ht={class:"md:col-span-2 space-y-6"},yt={class:"mt-1"},xt={class:"space-y-6"},kt={class:"font-medium"},$t={class:"text-sm text-gray-600 mt-1"},wt={class:"space-y-2"},jt=["href"],It={class:"text-xs text-gray-500"},Mt={key:0},At={class:"text-xs text-gray-500"},Ct={key:1},Vt={class:"text-xs text-gray-500"},Dt={key:0,class:"space-y-4"},Et={class:"flex-1"},Ot={class:"text-sm"},St={class:"font-medium"},Bt={class:"text-xs text-muted-foreground mt-1"},Ht={key:1,class:"text-sm text-muted-foreground text-center py-8"},aa=G({__name:"Show",props:{obligacion:{},contrato:{},canEdit:{type:Boolean},canDelete:{type:Boolean},canCreateChild:{type:Boolean},actividades:{}},setup(l){const V=l,{hasPermission:z}=ot(),D=O("general"),c=O({contrato_id:null,fecha_inicio:null,fecha_fin:null,tipo:null,estado:null,usuario_id:null,entregable_id:null}),F=[{title:"Admin",href:"/admin/dashboard"},{title:"Obligaciones",href:"/admin/obligaciones"},{title:V.obligacion.titulo}],x=S(()=>V.obligacion.evidencias||[]),U=S(()=>{let n=x.value;return c.value.tipo&&(n=n.filter(e=>e.tipo_evidencia===c.value.tipo)),c.value.estado&&(n=n.filter(e=>e.estado===c.value.estado)),c.value.usuario_id&&(n=n.filter(e=>{var f;return((f=e.usuario)==null?void 0:f.id)===c.value.usuario_id})),c.value.entregable_id&&(n=n.filter(e=>{var f;return(f=e.entregables)==null?void 0:f.some(s=>s.id===c.value.entregable_id)})),(c.value.fecha_inicio||c.value.fecha_fin)&&(n=n.filter(e=>{const f=new Date(e.created_at);if(c.value.fecha_inicio){const s=new Date(c.value.fecha_inicio);if(f<s)return!1}if(c.value.fecha_fin){const s=new Date(c.value.fecha_fin);if(s.setHours(23,59,59,999),f>s)return!1}return!0})),n}),w=n=>{if(!n)return"Sin fecha";try{return P(T(n),"dd MMM yyyy HH:mm",{locale:N})}catch{return n}},q=n=>{if(!n)return"-";try{return P(T(n),"d 'de' MMMM 'de' yyyy",{locale:N})}catch{return n}};return(n,e)=>(u(),v(A,null,[a(t(R),{title:`Obligación - ${l.obligacion.titulo}`},null,8,["title"]),a(K,{breadcrumbs:F},{default:i(()=>[o("div",ft,[o("div",pt,[o("div",null,[o("h1",vt,d(l.obligacion.titulo),1),o("p",gt," Contrato: "+d(l.contrato.nombre),1)]),o("div",bt,[a(t(M),{href:`/admin/contratos/${l.contrato.id}`},{default:i(()=>[a(t(H),{variant:"outline",size:"sm"},{default:i(()=>[a(t(st),{class:"h-4 w-4 mr-2"}),e[3]||(e[3]=r(" Ver Contrato ",-1))]),_:1})]),_:1},8,["href"]),l.canEdit?(u(),g(t(M),{key:0,href:n.route("admin.obligaciones.edit",l.obligacion.id)},{default:i(()=>[a(t(H),{variant:"outline",size:"sm"},{default:i(()=>[a(t(nt),{class:"h-4 w-4 mr-2"}),e[4]||(e[4]=r(" Editar ",-1))]),_:1})]),_:1},8,["href"])):p("",!0)])]),a(t(X),{modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=f=>D.value=f),class:"flex-1"},{default:i(()=>{var f;return[a(t(Y),null,{default:i(()=>{var s;return[a(t(j),{value:"general"},{default:i(()=>[a(t(rt),{class:"h-4 w-4 mr-2"}),e[5]||(e[5]=r(" General ",-1))]),_:1}),(s=l.obligacion.hijos)!=null&&s.length?(u(),g(t(j),{key:0,value:"hijos"},{default:i(()=>{var m;return[a(t(mt),{class:"h-4 w-4 mr-2"}),e[6]||(e[6]=r(" Obligaciones Hijas ",-1)),(m=l.obligacion.hijos)!=null&&m.length?(u(),g(t(C),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:i(()=>[r(d(l.obligacion.hijos.length),1)]),_:1})):p("",!0)]}),_:1})):p("",!0),a(t(j),{value:"evidencias"},{default:i(()=>[a(t(dt),{class:"h-4 w-4 mr-2"}),e[7]||(e[7]=r(" Evidencias ",-1)),x.value.length>0?(u(),g(t(C),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:i(()=>[r(d(x.value.length),1)]),_:1})):p("",!0)]),_:1}),a(t(j),{value:"actividad"},{default:i(()=>[a(t(ut),{class:"h-4 w-4 mr-2"}),e[8]||(e[8]=r(" Actividad ",-1)),l.actividades&&l.actividades.length>0?(u(),g(t(C),{key:0,class:"ml-2 h-5 px-1.5",variant:"secondary"},{default:i(()=>[r(d(l.actividades.length),1)]),_:1})):p("",!0)]),_:1})]}),_:1}),a(t(I),{value:"general",class:"space-y-4 mt-6"},{default:i(()=>{var s;return[o("div",_t,[o("div",ht,[a(t(b),null,{default:i(()=>[a(t(_),null,{default:i(()=>[a(t(h),null,{default:i(()=>[...e[9]||(e[9]=[r("Información General",-1)])]),_:1})]),_:1}),a(t(y),{class:"space-y-4"},{default:i(()=>[o("div",null,[a(t(W),null,{default:i(()=>[...e[10]||(e[10]=[r("Descripción",-1)])]),_:1}),o("p",yt,d(l.obligacion.descripcion||"Sin descripción"),1)])]),_:1})]),_:1})]),o("div",xt,[a(t(b),null,{default:i(()=>[a(t(_),null,{default:i(()=>[a(t(h),null,{default:i(()=>[...e[11]||(e[11]=[r("Detalles del Contrato",-1)])]),_:1})]),_:1}),a(t(y),null,{default:i(()=>{var m;return[a(t(M),{href:n.route("admin.contratos.show",l.contrato.id),class:"hover:underline"},{default:i(()=>[o("h3",kt,d(l.contrato.nombre),1)]),_:1},8,["href"]),o("p",$t,d((m=l.contrato.proyecto)==null?void 0:m.nombre),1)]}),_:1})]),_:1}),(s=l.obligacion.archivos_adjuntos)!=null&&s.length?(u(),g(t(b),{key:0},{default:i(()=>[a(t(_),null,{default:i(()=>[a(t(h),null,{default:i(()=>[...e[12]||(e[12]=[r("Archivos Adjuntos",-1)])]),_:1})]),_:1}),a(t(y),null,{default:i(()=>[o("div",wt,[(u(!0),v(A,null,B(l.obligacion.archivos_adjuntos,m=>(u(),v("div",{key:m.ruta,class:"flex items-center gap-2"},[a(t(ct),{class:"h-4 w-4"}),o("a",{href:m.ruta,target:"_blank",class:"hover:underline text-sm"},d(m.nombre_original),9,jt)]))),128))])]),_:1})]),_:1})):p("",!0),a(t(b),null,{default:i(()=>[a(t(_),null,{default:i(()=>[a(t(h),null,{default:i(()=>[...e[13]||(e[13]=[r("Auditoría",-1)])]),_:1})]),_:1}),a(t(y),{class:"text-sm space-y-2"},{default:i(()=>{var m,k,$;return[o("div",null,[e[14]||(e[14]=o("span",{class:"text-gray-600"},"Creado por:",-1)),o("p",null,d(((m=l.obligacion.creador)==null?void 0:m.name)||"Sistema"),1),o("p",It,d(w(l.obligacion.created_at)),1)]),l.obligacion.updated_at?(u(),v("div",Mt,[e[15]||(e[15]=o("span",{class:"text-gray-600"},"Última actualización:",-1)),o("p",null,d(((k=l.obligacion.actualizador)==null?void 0:k.name)||"Sistema"),1),o("p",At,d(w(l.obligacion.updated_at)),1)])):p("",!0),l.obligacion.cumplido_at?(u(),v("div",Ct,[e[16]||(e[16]=o("span",{class:"text-gray-600"},"Cumplido por:",-1)),o("p",null,d((($=l.obligacion.cumplido_por_usuario)==null?void 0:$.name)||"Sistema"),1),o("p",Vt,d(w(l.obligacion.cumplido_at)),1)])):p("",!0)]}),_:1})]),_:1})])])]}),_:1}),(f=l.obligacion.hijos)!=null&&f.length?(u(),g(t(I),{key:0,value:"hijos",class:"space-y-4 mt-6"},{default:i(()=>[a(t(b),null,{default:i(()=>[a(t(_),null,{default:i(()=>[a(t(h),null,{default:i(()=>[...e[17]||(e[17]=[r("Obligaciones Hijas",-1)])]),_:1}),a(t(L),null,{default:i(()=>[...e[18]||(e[18]=[r(" Sub-obligaciones derivadas de esta obligación principal ",-1)])]),_:1})]),_:1}),a(t(y),null,{default:i(()=>[a(lt,{obligaciones:l.obligacion.hijos,contratoId:l.obligacion.contrato_id,editable:t(z)("obligaciones.edit"),onEdit:e[0]||(e[0]=s=>t(J).visit(n.route("admin.obligaciones.edit",s.id)))},null,8,["obligaciones","contratoId","editable"])]),_:1})]),_:1})]),_:1})):p("",!0),a(t(I),{value:"evidencias",class:"space-y-4 mt-6"},{default:i(()=>[x.value.length>0?(u(),g(at,{key:0,modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=s=>c.value=s),contratos:[l.contrato],evidencias:x.value},null,8,["modelValue","contratos","evidencias"])):p("",!0),a(it,{mode:"simple",evidencias:U.value,contrato:l.contrato,"format-date":q,"card-title":"Evidencias Asociadas","card-description":"Evidencias cargadas para esta obligación"},null,8,["evidencias","contrato"])]),_:1}),a(t(I),{value:"actividad",class:"space-y-4 mt-6"},{default:i(()=>[a(t(b),null,{default:i(()=>[a(t(_),null,{default:i(()=>[a(t(h),null,{default:i(()=>[...e[19]||(e[19]=[r("Historial de Actividad",-1)])]),_:1}),a(t(L),null,{default:i(()=>[...e[20]||(e[20]=[r(" Registro de cambios y actividades relacionadas con esta obligación ",-1)])]),_:1})]),_:1}),a(t(y),null,{default:i(()=>[l.actividades&&l.actividades.length>0?(u(),v("div",Dt,[(u(!0),v(A,null,B(l.actividades,s=>{var m;return u(),v("div",{key:s.id,class:"flex gap-3 pb-4 border-b last:border-0"},[a(t(Z),{class:"h-8 w-8"},{default:i(()=>{var k;return[(k=s.causer)!=null&&k.avatar?(u(),g(t(tt),{key:0,src:s.causer.avatar},null,8,["src"])):p("",!0),a(t(et),null,{default:i(()=>{var $,E;return[r(d(((E=($=s.causer)==null?void 0:$.name)==null?void 0:E.substring(0,2).toUpperCase())||"SI"),1)]}),_:2},1024)]}),_:2},1024),o("div",Et,[o("p",Ot,[o("span",St,d(((m=s.causer)==null?void 0:m.name)||"Sistema"),1),r(" "+d(s.description),1)]),o("p",Bt,d(w(s.created_at)),1)])])}),128))])):(u(),v("p",Ht," No hay actividad registrada "))]),_:1})]),_:1})]),_:1})]}),_:1},8,["modelValue"])])]),_:1})],64))}});export{aa as default};
