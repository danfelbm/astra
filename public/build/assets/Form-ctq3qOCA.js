import{_ as ta}from"./AppLayout.vue_vue_type_script_setup_true_lang-CvzK4XT_.js";import{_ as z,C as S}from"./index--QcdRQwp.js";import{_ as N}from"./createLucideIcon-b-BO50eM.js";import{_ as k,c as h,a as w,b as $}from"./_plugin-vue_export-helper-B8fbgIu5.js";import{_ as I}from"./CardDescription.vue_vue_type_script_setup_true_lang-YWfQlRjy.js";import{_ as ra,a as da,b as L,c as O}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-BQlDKMe3.js";import{D as la}from"./DynamicFormRenderer-CsiJCrER.js";import{d as na,k as V,c as C,C as ia,a as u,o as l,b as t,u as e,m as ua,e as r,f as s,j as P,i as _,W as ca,g as c,t as n,n as b,l as W,F as G,r as pa}from"./app-CNYld6dA.js";import{A as ma}from"./arrow-left-C915YPGf.js";import{S as M}from"./save-DjkUdnA0.js";import{S as X}from"./send-DkutCx6H.js";import{C as fa}from"./clock-DdTy_TbQ.js";import{C as H}from"./circle-check-big-O4DvHLno.js";import{C as J}from"./circle-x-DzVz2TU7.js";import{F as ba}from"./index-RiWolONz.js";import{U as va}from"./user-MEcdD4G0.js";import{C as ga}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BCqdQW6-.js";import"./Label.vue_vue_type_script_setup_true_lang-DCYW77KH.js";import"./index-DLefAGKw.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-C74tjGUn.js";import"./RovingFocusItem-BNHquIBl.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BVJru1wm.js";import"./Textarea.vue_vue_type_script_setup_true_lang-DaFo8MlC.js";import"./plus-BcadkAGh.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-DccYG3Fh.js";import"./VisuallyHiddenInput-BibU5w6w.js";import"./useConditionalFields-DondpQis.js";import"./upload-oElU1jCy.js";import"./eye-BEkIbLwU.js";import"./download-1h6bboSg.js";import"./grip-vertical-C9dRMJBQ.js";import"./trash-2-ip9V4MwR.js";const _a={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ya={class:"space-y-6"},ka={class:"flex items-center justify-between"},ha={class:"space-y-1"},Ca={class:"flex items-center gap-2"},xa={class:"text-3xl font-bold tracking-tight"},wa={class:"text-muted-foreground"},$a={class:"flex items-start justify-between"},Pa={class:"flex items-start gap-3"},Aa={class:"space-y-1"},Ea={class:"flex items-center gap-2"},Fa={class:"text-sm text-muted-foreground"},ja={key:0},za={key:1},Sa={key:2},Na={key:3},Va={key:4},Ra={key:5},Ta={class:"flex items-start gap-2"},Ba={class:"flex-1"},qa={class:"text-xs mt-2 opacity-75"},Da={key:0},Ua={key:1},Ia={key:2},La={class:"grid grid-cols-2 gap-4 text-sm"},Oa={class:"font-medium"},Wa={class:"font-medium"},Ga={class:"font-medium text-xs"},Ma={class:"font-medium"},Xa={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Ha={class:"flex items-start gap-2"},Ja={class:"text-sm text-red-800"},Ka={key:1,class:"flex justify-end gap-3"},Qa={class:"flex items-center justify-between"},Ya={class:"flex items-center justify-between"},Za={class:"text-muted-foreground"},ao={class:"font-medium text-right max-w-xs"},oo={class:"grid grid-cols-2 gap-4 text-sm"},eo={class:"font-medium"},so={class:"font-medium"},to={class:"font-medium"},ro={class:"font-medium"},Do=na({__name:"Form",props:{convocatoria:{},postulacion:{},candidatura_aprobada:{}},setup(K){var T,B,q,D,U;const d=K,Q=[{title:"Postulaciones",href:"/postulaciones"},{title:d.convocatoria.nombre,href:`/convocatorias/${d.convocatoria.id}`}],A=V(),Y=C(()=>d.candidatura_aprobada?[{id:d.candidatura_aprobada.id,version:d.candidatura_aprobada.version,fecha_aprobacion:d.candidatura_aprobada.fecha_aprobacion,resumen:`Perfil v${d.candidatura_aprobada.version} - Aprobado ${d.candidatura_aprobada.fecha_aprobacion}`}]:[]),f=ia({formulario_data:((T=d.postulacion)==null?void 0:T.formulario_data)||{},candidatura_id:(B=d.postulacion)!=null&&B.candidatura_snapshot?(q=d.candidatura_aprobada)==null?void 0:q.id:null,enviar:!1}),x=V((D=d.postulacion)!=null&&D.candidatura_snapshot&&((U=d.candidatura_aprobada)==null?void 0:U.id)||null),E=C(()=>!!d.postulacion),R=C(()=>d.postulacion?d.postulacion.puede_editar:!0),j=C(()=>{var a;return!!((a=d.postulacion)!=null&&a.comentarios_admin)}),Z=a=>{switch(a){case"abierta":return H;case"futura":return ga;case"cerrada":return J;default:return S}},aa=()=>{f.enviar=!1,f.candidatura_id=x.value,f.post(`/convocatorias/${d.convocatoria.id}/postular`,{preserveScroll:!0})},v=V(null),oa=()=>{var a,o,i;if(v.value=null,!((a=A.value)!=null&&a.formularioCompleto)){const m=((o=A.value)==null?void 0:o.camposIncompletos)||[],p=(i=A.value)==null?void 0:i.perfilCandidaturaRequerido;m.length>0?v.value=`Formulario incompleto: Por favor completa todos los campos requeridos (${m.length} campos faltantes).`:p&&!x.value?v.value="Debes seleccionar tu perfil de candidatura aprobado para continuar.":v.value="Por favor completa todos los campos requeridos del formulario.";const g=document.querySelector('[role="tabpanel"]');g&&g.scrollIntoView({behavior:"smooth",block:"start"});return}f.enviar=!0,f.candidatura_id=x.value,f.post(`/convocatorias/${d.convocatoria.id}/postular`,{preserveScroll:!0,onError:m=>{const p=Object.values(m)[0];p?v.value=Array.isArray(p)?p[0]:p:v.value="Error al enviar la postulación. Por favor revisa los datos e intenta nuevamente."}})},ea=(a,o)=>{const i={};for(const[m,p]of Object.entries(a)){const g=o.find(F=>F.id===m);g&&(i[g.title]=Array.isArray(p)?p.join(", "):p)}return i},sa=C(()=>{var a;return(a=d.postulacion)!=null&&a.formulario_data?ea(d.postulacion.formulario_data,d.convocatoria.formulario_postulacion):{}}),y=C(()=>{var o,i,m,p,g,F;if(!((o=d.postulacion)!=null&&o.candidatura_snapshot))return null;const a=d.postulacion.candidatura_snapshot;return{usuario:((i=a.usuario)==null?void 0:i.name)||"N/A",version:((m=a.candidatura)==null?void 0:m.version_original)||"N/A",fecha_aprobacion:((p=a.candidatura)==null?void 0:p.fecha_aprobacion)||"N/A",aprobado_por:((F=(g=a.candidatura)==null?void 0:g.aprobado_por)==null?void 0:F.name)||"N/A"}});return(a,o)=>(l(),u(G,null,[t(e(ua),{title:`${E.value?"Editar":"Nueva"} Postulación - ${a.convocatoria.nombre}`},null,8,["title"]),t(ta,{breadcrumbs:Q},{default:r(()=>[s("div",_a,[s("div",ya,[s("div",ka,[s("div",ha,[s("div",Ca,[t(e(N),{variant:"ghost",size:"sm",onClick:o[0]||(o[0]=i=>e(ca).get("/postulaciones"))},{default:r(()=>[t(e(ma),{class:"h-4 w-4 mr-2"}),o[3]||(o[3]=c(" Volver "))]),_:1})]),s("h1",xa,n(E.value?"Editar Postulación":"Nueva Postulación"),1),s("p",wa,n(a.convocatoria.nombre),1)]),t(e(z),{class:b(a.convocatoria.estado_temporal==="abierta"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800")},{default:r(()=>[(l(),P(W(Z(a.convocatoria.estado_temporal)),{class:"mr-1 h-3 w-3"})),c(" "+n(a.convocatoria.estado_temporal_label),1)]),_:1},8,["class"])]),a.postulacion?(l(),P(e(k),{key:0,class:b({"border-yellow-500":a.postulacion.estado==="borrador","border-blue-500":a.postulacion.estado==="enviada","border-purple-500":a.postulacion.estado==="en_revision","border-green-500":a.postulacion.estado==="aceptada","border-red-500":a.postulacion.estado==="rechazada"})},{default:r(()=>[t(e(h),{class:"pt-6"},{default:r(()=>[s("div",$a,[s("div",Pa,[s("div",{class:b([{"bg-yellow-100 text-yellow-600":a.postulacion.estado==="borrador","bg-blue-100 text-blue-600":a.postulacion.estado==="enviada","bg-purple-100 text-purple-600":a.postulacion.estado==="en_revision","bg-green-100 text-green-600":a.postulacion.estado==="aceptada","bg-red-100 text-red-600":a.postulacion.estado==="rechazada"},"rounded-full p-2"])},[(l(),P(W(a.postulacion.estado==="borrador"?e(M):a.postulacion.estado==="enviada"?e(X):a.postulacion.estado==="en_revision"?e(fa):a.postulacion.estado==="aceptada"?e(H):e(J)),{class:"h-5 w-5"}))],2),s("div",Aa,[s("div",Ea,[o[4]||(o[4]=s("h3",{class:"font-semibold"},"Estado actual:",-1)),t(e(z),{class:b(a.postulacion.estado==="borrador"?"bg-yellow-100 text-yellow-800":a.postulacion.estado==="enviada"?"bg-blue-100 text-blue-800":a.postulacion.estado==="en_revision"?"bg-purple-100 text-purple-800":a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},{default:r(()=>[c(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),s("p",Fa,[a.postulacion.estado==="borrador"&&j.value?(l(),u("span",ja," Tu postulación fue devuelta a borrador. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):a.postulacion.estado==="borrador"?(l(),u("span",za," Puedes editar y enviar tu postulación cuando esté completa. ")):a.postulacion.estado==="enviada"?(l(),u("span",Sa," Tu postulación ha sido enviada y está pendiente de revisión. ")):a.postulacion.estado==="en_revision"?(l(),u("span",Na," Tu postulación está siendo revisada por el administrador. ")):a.postulacion.estado==="aceptada"?(l(),u("span",Va," ¡Felicidades! Tu postulación ha sido aceptada. ")):a.postulacion.estado==="rechazada"?(l(),u("span",Ra," Tu postulación fue rechazada. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):_("",!0)])])])]),j.value?(l(),u("div",{key:0,class:b([{"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800":a.postulacion.estado==="rechazada","bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800":a.postulacion.estado==="borrador","bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800":a.postulacion.estado==="aceptada"},"mt-4 p-4 rounded-lg"])},[s("div",Ta,[t(e(S),{class:b([{"text-red-600 dark:text-red-400":a.postulacion.estado==="rechazada","text-amber-600 dark:text-amber-400":a.postulacion.estado==="borrador","text-blue-600 dark:text-blue-400":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-600 dark:text-green-400":a.postulacion.estado==="aceptada"},"h-5 w-5 mt-0.5 flex-shrink-0"])},null,8,["class"]),s("div",Ba,[s("p",{class:b(["font-semibold mb-1",{"text-red-900 dark:text-red-100":a.postulacion.estado==="rechazada","text-amber-900 dark:text-amber-100":a.postulacion.estado==="borrador","text-blue-900 dark:text-blue-100":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-900 dark:text-green-100":a.postulacion.estado==="aceptada"}])}," Comentarios de la comisión: ",2),s("p",{class:b(["text-sm whitespace-pre-wrap",{"text-red-800 dark:text-red-200":a.postulacion.estado==="rechazada","text-amber-800 dark:text-amber-200":a.postulacion.estado==="borrador","text-blue-800 dark:text-blue-200":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-800 dark:text-green-200":a.postulacion.estado==="aceptada"}])},n(a.postulacion.comentarios_admin),3),s("p",qa,[a.postulacion.estado==="rechazada"||a.postulacion.estado==="borrador"&&j.value?(l(),u("span",Da," Por favor, atiende estos comentarios antes de reenviar tu postulación. ")):a.postulacion.estado==="aceptada"?(l(),u("span",Ua," Tu postulación fue aceptada con estos comentarios. ")):(l(),u("span",Ia," Estos comentarios fueron agregados durante la revisión. "))])])])],2)):_("",!0)]),_:1})]),_:1},8,["class"])):_("",!0),t(e(k),null,{default:r(()=>[t(e(w),null,{default:r(()=>[t(e($),{class:"flex items-center gap-2"},{default:r(()=>[t(e(ba),{class:"h-5 w-5"}),o[5]||(o[5]=c(" Información de la Convocatoria "))]),_:1}),t(e(I),null,{default:r(()=>[c(n(a.convocatoria.descripcion),1)]),_:1})]),_:1}),t(e(h),{class:"space-y-4"},{default:r(()=>[s("div",La,[s("div",null,[o[6]||(o[6]=s("span",{class:"text-muted-foreground"},"Cargo:",-1)),s("p",Oa,n(a.convocatoria.cargo),1)]),s("div",null,[o[7]||(o[7]=s("span",{class:"text-muted-foreground"},"Periodo:",-1)),s("p",Wa,n(a.convocatoria.periodo),1)]),s("div",null,[o[8]||(o[8]=s("span",{class:"text-muted-foreground"},"Fechas:",-1)),s("p",Ga,n(a.convocatoria.rango_fechas),1)]),s("div",null,[o[9]||(o[9]=s("span",{class:"text-muted-foreground"},"Ubicación:",-1)),s("p",Ma,n(a.convocatoria.ubicacion),1)])])]),_:1})]),_:1}),t(e(ra),{"default-value":"formulario",class:"space-y-4"},{default:r(()=>[t(e(da),{class:"grid w-full grid-cols-2"},{default:r(()=>[t(e(L),{value:"formulario"},{default:r(()=>o[10]||(o[10]=[c(" Formulario de Postulación ")])),_:1}),t(e(L),{value:"resumen",disabled:!E.value},{default:r(()=>o[11]||(o[11]=[c(" Resumen Actual ")])),_:1},8,["disabled"])]),_:1}),t(e(O),{value:"formulario",class:"space-y-6"},{default:r(()=>[t(e(k),null,{default:r(()=>[t(e(w),null,{default:r(()=>[t(e($),null,{default:r(()=>o[12]||(o[12]=[c("Completa tu Postulación")])),_:1}),t(e(I),null,{default:r(()=>o[13]||(o[13]=[c(" Completa todos los campos requeridos para enviar tu postulación. ")])),_:1})]),_:1}),t(e(h),null,{default:r(()=>[t(la,{ref_key:"formRenderer",ref:A,fields:a.convocatoria.formulario_postulacion,modelValue:e(f).formulario_data,"onUpdate:modelValue":o[1]||(o[1]=i=>e(f).formulario_data=i),"candidatura-seleccionada":x.value,"onUpdate:candidaturaSeleccionada":o[2]||(o[2]=i=>x.value=i),"candidaturas-aprobadas":Y.value,errors:e(f).errors,disabled:!R.value},null,8,["fields","modelValue","candidatura-seleccionada","candidaturas-aprobadas","errors","disabled"])]),_:1})]),_:1}),v.value?(l(),u("div",Xa,[s("div",Ha,[t(e(S),{class:"h-5 w-5 text-red-600 mt-0.5"}),s("p",Ja,n(v.value),1)])])):_("",!0),R.value?(l(),u("div",Ka,[t(e(N),{type:"button",variant:"outline",onClick:aa,disabled:e(f).processing},{default:r(()=>[t(e(M),{class:"mr-2 h-4 w-4"}),o[14]||(o[14]=c(" Guardar Borrador "))]),_:1},8,["disabled"]),t(e(N),{type:"button",onClick:oa,disabled:e(f).processing},{default:r(()=>[t(e(X),{class:"mr-2 h-4 w-4"}),o[15]||(o[15]=c(" Enviar Postulación "))]),_:1},8,["disabled"])])):_("",!0)]),_:1}),E.value?(l(),P(e(O),{key:0,value:"resumen",class:"space-y-4"},{default:r(()=>[t(e(k),null,{default:r(()=>[t(e(w),null,{default:r(()=>[t(e($),null,{default:r(()=>o[16]||(o[16]=[c("Estado de la Postulación")])),_:1})]),_:1}),t(e(h),{class:"space-y-4"},{default:r(()=>[s("div",Qa,[o[17]||(o[17]=s("span",{class:"text-muted-foreground"},"Estado:",-1)),t(e(z),{class:b(a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":a.postulacion.estado==="rechazada"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800")},{default:r(()=>[c(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),s("div",Ya,[o[18]||(o[18]=s("span",{class:"text-muted-foreground"},"Perfil vinculado:",-1)),s("span",null,n(y.value?"Sí":"No"),1)])]),_:1})]),_:1}),t(e(k),null,{default:r(()=>[t(e(w),null,{default:r(()=>[t(e($),null,{default:r(()=>o[19]||(o[19]=[c("Respuestas del Formulario")])),_:1})]),_:1}),t(e(h),{class:"space-y-3"},{default:r(()=>[(l(!0),u(G,null,pa(sa.value,(i,m)=>(l(),u("div",{key:m,class:"flex justify-between"},[s("span",Za,n(m)+":",1),s("span",ao,n(i),1)]))),128))]),_:1})]),_:1}),y.value?(l(),P(e(k),{key:0},{default:r(()=>[t(e(w),null,{default:r(()=>[t(e($),{class:"flex items-center gap-2"},{default:r(()=>[t(e(va),{class:"h-5 w-5"}),o[20]||(o[20]=c(" Perfil de Candidatura Vinculado "))]),_:1})]),_:1}),t(e(h),{class:"space-y-3"},{default:r(()=>[s("div",oo,[s("div",null,[o[21]||(o[21]=s("span",{class:"text-muted-foreground"},"Usuario:",-1)),s("p",eo,n(y.value.usuario),1)]),s("div",null,[o[22]||(o[22]=s("span",{class:"text-muted-foreground"},"Versión:",-1)),s("p",so,"v"+n(y.value.version),1)]),s("div",null,[o[23]||(o[23]=s("span",{class:"text-muted-foreground"},"Fecha aprobación:",-1)),s("p",to,n(y.value.fecha_aprobacion),1)]),s("div",null,[o[24]||(o[24]=s("span",{class:"text-muted-foreground"},"Aprobado por:",-1)),s("p",ro,n(y.value.aprobado_por),1)])])]),_:1})]),_:1})):_("",!0)]),_:1})):_("",!0)]),_:1})])])]),_:1})],64))}});export{Do as default};
