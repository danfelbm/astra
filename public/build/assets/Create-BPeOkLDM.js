import{d as ue,C as me,r as M,c as O,b as q,e as d,w as a,g as i,f as t,u as o,P as pe,h as s,l as fe,i as u,j as f,F as x,k as V,t as p,W as H}from"./app-CjO7v5GQ.js";import{_ as ce}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BYpIZ_fq.js";import{_ as C,a as U,b as k,c as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-Bxwe7tUF.js";import{_ as $}from"./CardDescription.vue_vue_type_script_setup_true_lang-BVAAswS5.js";import{_ as g}from"./createLucideIcon-D-pKcP9Q.js";import{_ as b}from"./Input.vue_vue_type_script_setup_true_lang-B_nvdHN5.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-BW8_6eap.js";import{_ as J}from"./Textarea.vue_vue_type_script_setup_true_lang-HWX8WFPC.js";import{_ as z,a as A,b as F,c as I,d as v}from"./SelectValue.vue_vue_type_script_setup_true_lang-BtUYWEab.js";import{_ as _e,a as ve}from"./index-BRaYMiZy.js";import{_ as be,a as ge,b as D,c as N}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-CMy3ejRe.js";import{u as ye}from"./useToast-jPqZr8jW.js";import{_ as T}from"./CampoPersonalizadoInput.vue_vue_type_script_setup_true_lang-DFbwpsGE.js";import{_ as K}from"./AddUsersModal.vue_vue_type_script_setup_true_lang-DfmiIFHc.js";import{A as xe}from"./arrow-left-BVrvljyo.js";import{X as Q}from"./x-BH92W00E.js";import{U as Ve}from"./user-plus-CoxmBSVT.js";import{C as Ce}from"./circle-alert-CCRajIhM.js";import{U as Y}from"./users-BKGB3LXs.js";import{U as Ue}from"./upload-X1YIQhEY.js";import{S as ke}from"./save-CEix0_Ke.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-BVMU7bwV.js";import"./index-DIHigTtG.js";import"./floating-ui.vue-DIPIQFyz.js";import"./index-VE8OALNU.js";import"./shield-BQEaDxqE.js";import"./user-Co3VyLMP.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-2xSyQjeV.js";import"./chevron-right-Cu7pv3nH.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CeaU-cJS.js";import"./VisuallyHidden-CTbTB84I.js";import"./index-Cqupi6zH.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-CBVCH0rS.js";import"./index-DtuMGbOf.js";import"./map-pin-DgRtAv6q.js";import"./CollapsibleContent.vue_vue_type_script_setup_true_lang-BGEkPemt.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-ArNvpFXc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chevrons-up-down-DYGIKuiv.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CfhopTWT.js";import"./tag-sxC7-sSh.js";import"./target-Ok6GTNsy.js";import"./vote-B3S3fO6K.js";import"./folder-open-thq0c_kP.js";import"./send-BCIIWnZp.js";import"./file-text-Bp8iI4wb.js";import"./briefcase-CJBZbF6d.js";import"./calendar-DDBvtQmm.js";import"./megaphone-CIaTHaNl.js";import"./user-check-DC7m7x8J.js";import"./clipboard-list-CqMWKead.js";import"./mail-DPbCVbB_.js";import"./message-square-CaRueYKC.js";import"./external-link-l4IeB4ym.js";import"./panel-left-CyQdjetZ.js";import"./index-B6TYaX6R.js";import"./check-DGuODqTO.js";import"./index-CaapDUxs.js";import"./nullish-CHIgUVhi.js";import"./RovingFocusItem-CbOTHXIy.js";import"./utils-Dx0mzWBR.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CWJT2xjP.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-BxxRi5dy.js";import"./VisuallyHiddenInput-DXLsyK88.js";import"./circle-CUwM1GRy.js";import"./search-Bh9Nvbzy.js";import"./loader-circle-fzSEXKwB.js";import"./chevron-left-48vlw3IX.js";const Se={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},$e={class:"flex items-center justify-between"},Pe={class:"flex items-center gap-4"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},we={key:0,class:"text-red-500 text-sm mt-1"},ze={key:0,class:"text-red-500 text-sm mt-1"},Ae={key:0,class:"text-red-500 text-sm mt-1"},Fe={key:0,class:"space-y-4 pt-4 border-t"},Ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},De={key:0,class:"text-red-500 text-sm mt-1"},Ne={key:0,class:"text-red-500 text-sm mt-1"},je={key:0,class:"text-red-500 text-sm mt-1"},Me={key:0,class:"text-red-500 text-sm mt-1"},Oe={key:0},qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Be={key:0,class:"text-red-500 text-sm mt-1"},Le={key:0,class:"text-red-500 text-sm mt-1"},Re={key:0,class:"space-y-4 pt-4 border-t"},Te={class:"space-y-6"},he={class:"space-y-4"},Ge={key:0,class:"p-3 bg-muted rounded-lg flex items-center justify-between"},Xe={class:"font-medium"},We={class:"text-sm text-muted-foreground"},He={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Je={class:"space-y-4"},Ke={key:0,class:"space-y-2"},Qe={class:"flex items-center justify-between"},Ye={class:"font-medium"},Ze={class:"text-sm text-muted-foreground"},eo={class:"flex items-center gap-2 mt-1"},oo={class:"text-xs bg-primary/10 text-primary px-2 py-1 rounded"},to={key:0,class:"text-xs text-muted-foreground"},ao={key:1,class:"text-center py-8 border-2 border-dashed rounded-lg"},lo={class:"flex items-center gap-4"},ro={key:0,class:"text-sm text-gray-600"},so={key:0,class:"text-red-500 text-sm mt-1"},io={key:0,class:"text-red-500 text-sm mt-1"},no={key:0,class:"space-y-4 pt-4 border-t"},uo={class:"flex justify-end gap-4"},$t=ue({__name:"Create",props:{proyecto:{},proyectos:{},camposPersonalizados:{},usuarios:{default:()=>[]}},setup(Z){var W;const y=Z,P=ye(),ee=[{title:"Admin",href:"/admin/dashboard"},{title:"Contratos",href:"/admin/contratos"},{title:"Crear Contrato",href:"/admin/contratos/create"}],l=me({proyecto_id:((W=y.proyecto)==null?void 0:W.id)||"",nombre:"",descripcion:"",fecha_inicio:"",fecha_fin:"",estado:"borrador",tipo:"servicio",monto_total:"",moneda:"USD",responsable_id:"none",contraparte_user_id:null,contraparte_nombre:"",contraparte_identificacion:"",contraparte_email:"",contraparte_telefono:"",participantes:[],archivo_pdf:null,observaciones:"",campos_personalizados:{}}),B=M(""),h=M("informacion"),L=M(!1),R=M(!1),{route:w}=window,j=O(()=>{var n;return l.contraparte_user_id?(n=y.usuarios)==null?void 0:n.find(e=>e.id===l.contraparte_user_id):null}),oe=O(()=>[{name:"rol",label:"Rol",type:"select",options:[{value:"testigo",label:"Testigo"},{value:"revisor",label:"Revisor"},{value:"aprobador",label:"Aprobador"},{value:"observador",label:"Observador"}],value:"testigo",required:!0},{name:"notas",label:"Notas (opcional)",type:"text",value:"",required:!1}]),te=O(()=>{const n=l.participantes.map(e=>e.user_id);return l.contraparte_user_id&&n.push(l.contraparte_user_id),n}),ae=[{value:"USD",label:"USD - Dólar Estadounidense"},{value:"EUR",label:"EUR - Euro"},{value:"MXN",label:"MXN - Peso Mexicano"},{value:"COP",label:"COP - Peso Colombiano"},{value:"ARS",label:"ARS - Peso Argentino"},{value:"CLP",label:"CLP - Peso Chileno"},{value:"PEN",label:"PEN - Sol Peruano"}],E=O(()=>{const n={informacion:[],financiero:[],otros:[]};return y.camposPersonalizados.forEach(e=>{e.slug.includes("financ")||e.slug.includes("monto")||e.slug.includes("precio")?n.financiero.push(e):e.slug.includes("info")||e.slug.includes("descrip")?n.informacion.push(e):n.otros.push(e)}),n}),G=n=>{const e=n.target;e.files&&e.files[0]&&(l.archivo_pdf=e.files[0],B.value=e.files[0].name)},le=()=>{const n=[];return l.proyecto_id||n.push("Debe seleccionar un proyecto"),l.nombre.trim()||n.push("El nombre del contrato es obligatorio"),l.fecha_inicio||n.push("La fecha de inicio es obligatoria"),l.fecha_fin&&l.fecha_fin<l.fecha_inicio&&n.push("La fecha de fin debe ser posterior a la fecha de inicio"),y.camposPersonalizados.forEach(e=>{e.es_requerido&&!l.campos_personalizados[e.id]&&n.push(`El campo "${e.nombre}" es obligatorio`)}),n},re=n=>{var e;if(n.userIds.length>0){l.contraparte_user_id=n.userIds[0];const r=(e=y.usuarios)==null?void 0:e.find(m=>m.id===n.userIds[0]);r&&(l.contraparte_nombre=r.name,l.contraparte_email=r.email||"")}},se=n=>{n.userIds.forEach(e=>{l.participantes.some(m=>m.user_id===e)||l.participantes.push({user_id:e,rol:n.extraData.rol||"testigo",notas:n.extraData.notas||""})})},ie=n=>{const e=l.participantes.findIndex(r=>r.user_id===n);e>-1&&l.participantes.splice(e,1)},X=n=>{var e;return(e=y.usuarios)==null?void 0:e.find(r=>r.id===n)},ne=()=>{const n=le();if(n.length>0){n.forEach(r=>P.error(r));return}const e=new FormData;Object.keys(l.data()).forEach(r=>{r==="campos_personalizados"?Object.keys(l.campos_personalizados).forEach(m=>{const _=l.campos_personalizados[m];_!=null&&_!==""&&e.append(`campos_personalizados[${m}]`,_)}):r==="participantes"?l.participantes.forEach((m,_)=>{e.append(`participantes[${_}][user_id]`,m.user_id.toString()),e.append(`participantes[${_}][rol]`,m.rol),m.notas&&e.append(`participantes[${_}][notas]`,m.notas)}):r==="archivo_pdf"&&l.archivo_pdf?e.append("archivo_pdf",l.archivo_pdf):r==="responsable_id"&&l[r]==="none"||l[r]!==null&&l[r]!==""&&e.append(r,l[r])}),H.post(w("admin.contratos.store"),e,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{P.success("Contrato creado exitosamente")},onError:r=>{typeof r=="object"&&r!==null?Object.values(r).forEach(m=>{Array.isArray(m)?m.forEach(_=>P.error(String(_))):typeof m=="string"?P.error(m):P.error("Error al crear el contrato")}):P.error("Error al crear el contrato")}})},de=()=>{confirm("¿Está seguro de cancelar? Los cambios no guardados se perderán.")&&H.get(w("admin.contratos.index"))};return(n,e)=>(d(),q(ce,{breadcrumbs:ee},{default:a(()=>[i("div",Se,[i("div",$e,[i("div",Pe,[t(o(pe),{href:o(w)("admin.contratos.index")},{default:a(()=>[t(o(g),{variant:"ghost",size:"sm"},{default:a(()=>[t(o(xe),{class:"h-4 w-4 mr-2"}),e[22]||(e[22]=s(" Volver ",-1))]),_:1})]),_:1},8,["href"]),e[23]||(e[23]=i("div",null,[i("h1",{class:"text-3xl font-bold"},"Crear Contrato"),i("p",{class:"text-gray-600 mt-1"},"Complete la información para crear un nuevo contrato")],-1))])]),i("form",{onSubmit:fe(ne,["prevent"]),class:"space-y-6"},[t(o(be),{modelValue:h.value,"onUpdate:modelValue":e[19]||(e[19]=r=>h.value=r)},{default:a(()=>[t(o(ge),{class:"grid w-full grid-cols-5"},{default:a(()=>[t(o(D),{value:"informacion"},{default:a(()=>[...e[24]||(e[24]=[s("Información General",-1)])]),_:1}),t(o(D),{value:"fechas"},{default:a(()=>[...e[25]||(e[25]=[s("Fechas y Estado",-1)])]),_:1}),t(o(D),{value:"financiero"},{default:a(()=>[...e[26]||(e[26]=[s("Información Financiera",-1)])]),_:1}),t(o(D),{value:"contraparte"},{default:a(()=>[...e[27]||(e[27]=[s("Contraparte",-1)])]),_:1}),t(o(D),{value:"adicional"},{default:a(()=>[...e[28]||(e[28]=[s("Información Adicional",-1)])]),_:1})]),_:1}),t(o(N),{value:"informacion"},{default:a(()=>[t(o(C),null,{default:a(()=>[t(o(U),null,{default:a(()=>[t(o(k),null,{default:a(()=>[...e[29]||(e[29]=[s("Información General",-1)])]),_:1}),t(o($),null,{default:a(()=>[...e[30]||(e[30]=[s("Datos principales del contrato",-1)])]),_:1})]),_:1}),t(o(S),{class:"space-y-4"},{default:a(()=>[i("div",Ee,[i("div",null,[t(o(c),{for:"proyecto_id"},{default:a(()=>[...e[31]||(e[31]=[s("Proyecto *",-1)])]),_:1}),t(o(z),{modelValue:o(l).proyecto_id,"onUpdate:modelValue":e[0]||(e[0]=r=>o(l).proyecto_id=r),disabled:!!y.proyecto},{default:a(()=>[t(o(A),null,{default:a(()=>[t(o(F),{placeholder:"Seleccione un proyecto"})]),_:1}),t(o(I),null,{default:a(()=>[(d(!0),u(x,null,V(n.proyectos,r=>(d(),q(o(v),{key:r.id,value:r.id.toString()},{default:a(()=>[s(p(r.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),o(l).errors.proyecto_id?(d(),u("div",we,p(o(l).errors.proyecto_id),1)):f("",!0)]),i("div",null,[t(o(c),{for:"nombre"},{default:a(()=>[...e[32]||(e[32]=[s("Nombre del Contrato *",-1)])]),_:1}),t(o(b),{id:"nombre",modelValue:o(l).nombre,"onUpdate:modelValue":e[1]||(e[1]=r=>o(l).nombre=r),placeholder:"Ej: Contrato de servicios de consultoría"},null,8,["modelValue"]),o(l).errors.nombre?(d(),u("div",ze,p(o(l).errors.nombre),1)):f("",!0)])]),i("div",null,[t(o(c),{for:"descripcion"},{default:a(()=>[...e[33]||(e[33]=[s("Descripción",-1)])]),_:1}),t(o(J),{id:"descripcion",modelValue:o(l).descripcion,"onUpdate:modelValue":e[2]||(e[2]=r=>o(l).descripcion=r),placeholder:"Descripción detallada del contrato...",rows:"4"},null,8,["modelValue"]),o(l).errors.descripcion?(d(),u("div",Ae,p(o(l).errors.descripcion),1)):f("",!0)]),E.value.informacion.length>0?(d(),u("div",Fe,[e[34]||(e[34]=i("h3",{class:"font-medium"},"Información Complementaria",-1)),(d(!0),u(x,null,V(E.value.informacion,r=>(d(),u("div",{key:r.id},[t(T,{campo:r,modelValue:o(l).campos_personalizados[r.id],"onUpdate:modelValue":m=>o(l).campos_personalizados[r.id]=m},null,8,["campo","modelValue","onUpdate:modelValue"])]))),128))])):f("",!0)]),_:1})]),_:1})]),_:1}),t(o(N),{value:"fechas"},{default:a(()=>[t(o(C),null,{default:a(()=>[t(o(U),null,{default:a(()=>[t(o(k),null,{default:a(()=>[...e[35]||(e[35]=[s("Fechas y Estado",-1)])]),_:1}),t(o($),null,{default:a(()=>[...e[36]||(e[36]=[s("Configure las fechas y el estado del contrato",-1)])]),_:1})]),_:1}),t(o(S),{class:"space-y-4"},{default:a(()=>[i("div",Ie,[i("div",null,[t(o(c),{for:"fecha_inicio"},{default:a(()=>[...e[37]||(e[37]=[s("Fecha de Inicio *",-1)])]),_:1}),t(o(b),{id:"fecha_inicio",type:"date",modelValue:o(l).fecha_inicio,"onUpdate:modelValue":e[3]||(e[3]=r=>o(l).fecha_inicio=r)},null,8,["modelValue"]),o(l).errors.fecha_inicio?(d(),u("div",De,p(o(l).errors.fecha_inicio),1)):f("",!0)]),i("div",null,[t(o(c),{for:"fecha_fin"},{default:a(()=>[...e[38]||(e[38]=[s("Fecha de Fin",-1)])]),_:1}),t(o(b),{id:"fecha_fin",type:"date",modelValue:o(l).fecha_fin,"onUpdate:modelValue":e[4]||(e[4]=r=>o(l).fecha_fin=r)},null,8,["modelValue"]),o(l).errors.fecha_fin?(d(),u("div",Ne,p(o(l).errors.fecha_fin),1)):f("",!0)]),i("div",null,[t(o(c),{for:"estado"},{default:a(()=>[...e[39]||(e[39]=[s("Estado",-1)])]),_:1}),t(o(z),{modelValue:o(l).estado,"onUpdate:modelValue":e[5]||(e[5]=r=>o(l).estado=r)},{default:a(()=>[t(o(A),null,{default:a(()=>[t(o(F))]),_:1}),t(o(I),null,{default:a(()=>[t(o(v),{value:"borrador"},{default:a(()=>[...e[40]||(e[40]=[s("Borrador",-1)])]),_:1}),t(o(v),{value:"activo"},{default:a(()=>[...e[41]||(e[41]=[s("Activo",-1)])]),_:1}),t(o(v),{value:"finalizado"},{default:a(()=>[...e[42]||(e[42]=[s("Finalizado",-1)])]),_:1}),t(o(v),{value:"cancelado"},{default:a(()=>[...e[43]||(e[43]=[s("Cancelado",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(l).errors.estado?(d(),u("div",je,p(o(l).errors.estado),1)):f("",!0)]),i("div",null,[t(o(c),{for:"tipo"},{default:a(()=>[...e[44]||(e[44]=[s("Tipo de Contrato *",-1)])]),_:1}),t(o(z),{modelValue:o(l).tipo,"onUpdate:modelValue":e[6]||(e[6]=r=>o(l).tipo=r)},{default:a(()=>[t(o(A),null,{default:a(()=>[t(o(F))]),_:1}),t(o(I),null,{default:a(()=>[t(o(v),{value:"servicio"},{default:a(()=>[...e[45]||(e[45]=[s("Servicio",-1)])]),_:1}),t(o(v),{value:"obra"},{default:a(()=>[...e[46]||(e[46]=[s("Obra",-1)])]),_:1}),t(o(v),{value:"suministro"},{default:a(()=>[...e[47]||(e[47]=[s("Suministro",-1)])]),_:1}),t(o(v),{value:"consultoria"},{default:a(()=>[...e[48]||(e[48]=[s("Consultoría",-1)])]),_:1}),t(o(v),{value:"otro"},{default:a(()=>[...e[49]||(e[49]=[s("Otro",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(l).errors.tipo?(d(),u("div",Me,p(o(l).errors.tipo),1)):f("",!0)])]),n.usuarios?(d(),u("div",Oe,[t(o(c),{for:"responsable_id"},{default:a(()=>[...e[50]||(e[50]=[s("Responsable",-1)])]),_:1}),t(o(z),{modelValue:o(l).responsable_id,"onUpdate:modelValue":e[7]||(e[7]=r=>o(l).responsable_id=r)},{default:a(()=>[t(o(A),null,{default:a(()=>[t(o(F),{placeholder:"Seleccione un responsable"})]),_:1}),t(o(I),null,{default:a(()=>[t(o(v),{value:"none"},{default:a(()=>[...e[51]||(e[51]=[s("Sin responsable",-1)])]),_:1}),(d(!0),u(x,null,V(n.usuarios,r=>(d(),q(o(v),{key:r.id,value:r.id.toString()},{default:a(()=>[s(p(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])):f("",!0)]),_:1})]),_:1})]),_:1}),t(o(N),{value:"financiero"},{default:a(()=>[t(o(C),null,{default:a(()=>[t(o(U),null,{default:a(()=>[t(o(k),null,{default:a(()=>[...e[52]||(e[52]=[s("Información Financiera",-1)])]),_:1}),t(o($),null,{default:a(()=>[...e[53]||(e[53]=[s("Montos y detalles financieros del contrato",-1)])]),_:1})]),_:1}),t(o(S),{class:"space-y-4"},{default:a(()=>[i("div",qe,[i("div",null,[t(o(c),{for:"monto_total"},{default:a(()=>[...e[54]||(e[54]=[s("Monto Total",-1)])]),_:1}),t(o(b),{id:"monto_total",type:"number",step:"0.01",modelValue:o(l).monto_total,"onUpdate:modelValue":e[8]||(e[8]=r=>o(l).monto_total=r),placeholder:"0.00"},null,8,["modelValue"]),o(l).errors.monto_total?(d(),u("div",Be,p(o(l).errors.monto_total),1)):f("",!0)]),i("div",null,[t(o(c),{for:"moneda"},{default:a(()=>[...e[55]||(e[55]=[s("Moneda",-1)])]),_:1}),t(o(z),{modelValue:o(l).moneda,"onUpdate:modelValue":e[9]||(e[9]=r=>o(l).moneda=r)},{default:a(()=>[t(o(A),null,{default:a(()=>[t(o(F))]),_:1}),t(o(I),null,{default:a(()=>[(d(),u(x,null,V(ae,r=>t(o(v),{key:r.value,value:r.value},{default:a(()=>[s(p(r.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"]),o(l).errors.moneda?(d(),u("div",Le,p(o(l).errors.moneda),1)):f("",!0)])]),E.value.financiero.length>0?(d(),u("div",Re,[e[56]||(e[56]=i("h3",{class:"font-medium"},"Campos Financieros Personalizados",-1)),(d(!0),u(x,null,V(E.value.financiero,r=>(d(),u("div",{key:r.id},[t(T,{campo:r,modelValue:o(l).campos_personalizados[r.id],"onUpdate:modelValue":m=>o(l).campos_personalizados[r.id]=m},null,8,["campo","modelValue","onUpdate:modelValue"])]))),128))])):f("",!0)]),_:1})]),_:1})]),_:1}),t(o(N),{value:"contraparte"},{default:a(()=>[i("div",Te,[t(o(C),null,{default:a(()=>[t(o(U),null,{default:a(()=>[t(o(k),null,{default:a(()=>[...e[57]||(e[57]=[s("Contraparte - Usuario del Sistema",-1)])]),_:1}),t(o($),null,{default:a(()=>[...e[58]||(e[58]=[s(" Seleccione un usuario del sistema como contraparte del contrato ",-1)])]),_:1})]),_:1}),t(o(S),null,{default:a(()=>[i("div",he,[i("div",null,[t(o(c),null,{default:a(()=>[...e[59]||(e[59]=[s("Usuario Contraparte",-1)])]),_:1}),e[60]||(e[60]=i("p",{class:"text-sm text-muted-foreground mb-2"}," Si la contraparte es un usuario registrado en el sistema, selecciónelo aquí ",-1))]),j.value?(d(),u("div",Ge,[i("div",null,[i("p",Xe,p(j.value.name),1),i("p",We,p(j.value.email),1)]),t(o(g),{type:"button",variant:"ghost",size:"sm",onClick:e[10]||(e[10]=r=>{o(l).contraparte_user_id=null,o(l).contraparte_nombre="",o(l).contraparte_email=""})},{default:a(()=>[t(o(Q),{class:"h-4 w-4"})]),_:1})])):f("",!0),t(o(g),{type:"button",variant:"outline",onClick:e[11]||(e[11]=r=>L.value=!0),class:"w-full"},{default:a(()=>[t(o(Ve),{class:"h-4 w-4 mr-2"}),s(" "+p(j.value?"Cambiar Contraparte":"Seleccionar Contraparte"),1)]),_:1})])]),_:1})]),_:1}),t(o(C),null,{default:a(()=>[t(o(U),null,{default:a(()=>[t(o(k),null,{default:a(()=>[...e[61]||(e[61]=[s("Contraparte - Información Externa",-1)])]),_:1}),t(o($),null,{default:a(()=>[...e[62]||(e[62]=[s(" Complete estos campos si la contraparte no es un usuario del sistema ",-1)])]),_:1})]),_:1}),t(o(S),{class:"space-y-4"},{default:a(()=>[o(l).contraparte_user_id?(d(),q(o(_e),{key:0,class:"mb-4"},{default:a(()=>[t(o(Ce),{class:"h-4 w-4"}),t(o(ve),null,{default:a(()=>[...e[63]||(e[63]=[s(" Los campos de contraparte externa están deshabilitados porque ya se seleccionó un usuario del sistema. ",-1)])]),_:1})]),_:1})):f("",!0),i("div",He,[i("div",null,[t(o(c),{for:"contraparte_nombre"},{default:a(()=>[...e[64]||(e[64]=[s("Nombre de la Contraparte",-1)])]),_:1}),t(o(b),{id:"contraparte_nombre",modelValue:o(l).contraparte_nombre,"onUpdate:modelValue":e[12]||(e[12]=r=>o(l).contraparte_nombre=r),placeholder:"Nombre de la empresa o persona",disabled:!!o(l).contraparte_user_id},null,8,["modelValue","disabled"])]),i("div",null,[t(o(c),{for:"contraparte_identificacion"},{default:a(()=>[...e[65]||(e[65]=[s("Identificación/RUC",-1)])]),_:1}),t(o(b),{id:"contraparte_identificacion",modelValue:o(l).contraparte_identificacion,"onUpdate:modelValue":e[13]||(e[13]=r=>o(l).contraparte_identificacion=r),placeholder:"Número de identificación",disabled:!!o(l).contraparte_user_id},null,8,["modelValue","disabled"])]),i("div",null,[t(o(c),{for:"contraparte_email"},{default:a(()=>[...e[66]||(e[66]=[s("Email de Contacto",-1)])]),_:1}),t(o(b),{id:"contraparte_email",type:"email",modelValue:o(l).contraparte_email,"onUpdate:modelValue":e[14]||(e[14]=r=>o(l).contraparte_email=r),placeholder:"email@ejemplo.com",disabled:!!o(l).contraparte_user_id},null,8,["modelValue","disabled"])]),i("div",null,[t(o(c),{for:"contraparte_telefono"},{default:a(()=>[...e[67]||(e[67]=[s("Teléfono de Contacto",-1)])]),_:1}),t(o(b),{id:"contraparte_telefono",modelValue:o(l).contraparte_telefono,"onUpdate:modelValue":e[15]||(e[15]=r=>o(l).contraparte_telefono=r),placeholder:"+1234567890",disabled:!!o(l).contraparte_user_id},null,8,["modelValue","disabled"])])])]),_:1})]),_:1}),t(o(C),null,{default:a(()=>[t(o(U),null,{default:a(()=>[t(o(k),null,{default:a(()=>[...e[68]||(e[68]=[s("Participantes del Contrato",-1)])]),_:1}),t(o($),null,{default:a(()=>[...e[69]||(e[69]=[s(" Agregue usuarios del sistema que participarán en este contrato con diferentes roles ",-1)])]),_:1})]),_:1}),t(o(S),null,{default:a(()=>[i("div",Je,[t(o(g),{type:"button",variant:"outline",onClick:e[16]||(e[16]=r=>R.value=!0),class:"w-full"},{default:a(()=>[t(o(Y),{class:"h-4 w-4 mr-2"}),e[70]||(e[70]=s(" Agregar Participantes ",-1))]),_:1}),o(l).participantes.length>0?(d(),u("div",Ke,[e[71]||(e[71]=i("p",{class:"text-sm font-medium text-muted-foreground"},"Participantes agregados:",-1)),(d(!0),u(x,null,V(o(l).participantes,r=>{var m,_;return d(),u("div",{key:r.user_id,class:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},[i("div",Qe,[i("div",null,[i("p",Ye,p((m=X(r.user_id))==null?void 0:m.name),1),i("p",Ze,p((_=X(r.user_id))==null?void 0:_.email),1),i("div",eo,[i("span",oo,p(r.rol),1),r.notas?(d(),u("span",to,p(r.notas),1)):f("",!0)])]),t(o(g),{type:"button",variant:"ghost",size:"sm",onClick:mo=>ie(r.user_id)},{default:a(()=>[t(o(Q),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])}),128))])):(d(),u("div",ao,[t(o(Y),{class:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),e[72]||(e[72]=i("p",{class:"text-sm text-muted-foreground"},"No hay participantes agregados",-1))]))])]),_:1})]),_:1})])]),_:1}),t(o(N),{value:"adicional"},{default:a(()=>[t(o(C),null,{default:a(()=>[t(o(U),null,{default:a(()=>[t(o(k),null,{default:a(()=>[...e[73]||(e[73]=[s("Información Adicional",-1)])]),_:1}),t(o($),null,{default:a(()=>[...e[74]||(e[74]=[s("Archivos y observaciones",-1)])]),_:1})]),_:1}),t(o(S),{class:"space-y-4"},{default:a(()=>[i("div",null,[t(o(c),{for:"archivo_pdf"},{default:a(()=>[...e[75]||(e[75]=[s("Archivo del Contrato (PDF)",-1)])]),_:1}),i("div",lo,[t(o(b),{id:"archivo_pdf",type:"file",accept:".pdf",onChange:G,class:"hidden"}),t(o(g),{type:"button",variant:"outline",onClick:e[17]||(e[17]=r=>n.$refs.fileInput.click())},{default:a(()=>[t(o(Ue),{class:"h-4 w-4 mr-2"}),e[76]||(e[76]=s(" Seleccionar PDF ",-1))]),_:1}),B.value?(d(),u("span",ro,p(B.value),1)):f("",!0)]),e[77]||(e[77]=i("p",{class:"text-xs text-gray-500 mt-1"},"Máximo 10MB",-1)),o(l).errors.archivo_pdf?(d(),u("div",so,p(o(l).errors.archivo_pdf),1)):f("",!0)]),i("div",null,[t(o(c),{for:"observaciones"},{default:a(()=>[...e[78]||(e[78]=[s("Observaciones",-1)])]),_:1}),t(o(J),{id:"observaciones",modelValue:o(l).observaciones,"onUpdate:modelValue":e[18]||(e[18]=r=>o(l).observaciones=r),placeholder:"Notas u observaciones adicionales...",rows:"4"},null,8,["modelValue"]),o(l).errors.observaciones?(d(),u("div",io,p(o(l).errors.observaciones),1)):f("",!0)]),E.value.otros.length>0?(d(),u("div",no,[e[79]||(e[79]=i("h3",{class:"font-medium"},"Campos Personalizados",-1)),(d(!0),u(x,null,V(E.value.otros,r=>(d(),u("div",{key:r.id},[t(T,{campo:r,modelValue:o(l).campos_personalizados[r.id],"onUpdate:modelValue":m=>o(l).campos_personalizados[r.id]=m},null,8,["campo","modelValue","onUpdate:modelValue"])]))),128))])):f("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i("div",uo,[t(o(g),{type:"button",variant:"outline",onClick:de,disabled:o(l).processing},{default:a(()=>[...e[80]||(e[80]=[s(" Cancelar ",-1)])]),_:1},8,["disabled"]),t(o(g),{type:"submit",disabled:o(l).processing},{default:a(()=>[t(o(ke),{class:"h-4 w-4 mr-2"}),s(" "+p(o(l).processing?"Guardando...":"Guardar Contrato"),1)]),_:1},8,["disabled"])])],32)]),i("input",{ref:"fileInput",type:"file",accept:".pdf",onChange:G,class:"hidden"},null,544),t(K,{modelValue:L.value,"onUpdate:modelValue":e[20]||(e[20]=r=>L.value=r),title:"Seleccionar Contraparte",description:"Selecciona el usuario que será la contraparte del contrato","search-endpoint":o(w)("admin.proyectos.search-users"),"excluded-ids":o(l).contraparte_user_id?[o(l).contraparte_user_id]:[],"max-selection":1,"submit-button-text":"Seleccionar Contraparte","search-placeholder":"Buscar por nombre, email, documento o teléfono...",onSubmit:re},null,8,["modelValue","search-endpoint","excluded-ids"]),t(K,{modelValue:R.value,"onUpdate:modelValue":e[21]||(e[21]=r=>R.value=r),title:"Agregar Participantes",description:"Selecciona los usuarios que participarán en este contrato y define su rol","search-endpoint":o(w)("admin.proyectos.search-users"),"excluded-ids":te.value,"extra-fields":oe.value,"submit-button-text":"Agregar Participantes","search-placeholder":"Buscar por nombre, email, documento o teléfono...",onSubmit:se},null,8,["modelValue","search-endpoint","excluded-ids","extra-fields"])]),_:1}))}});export{$t as default};
