import{_ as y,C as N}from"./index-IRTTYLy9.js";import{_ as h}from"./createLucideIcon-DN0KVddD.js";import{_ as Y,c as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-BGgSvmiB.js";import{_ as X}from"./Switch.vue_vue_type_script_setup_true_lang-Dtb_Glvl.js";import{_ as Z,a as ee,b as $,c as b,d as te,e as g}from"./TableHeader.vue_vue_type_script_setup_true_lang-CrlC7-vG.js";import{V as se,C as ae,_ as le}from"./AppLayout.vue_vue_type_script_setup_true_lang-CJoJfjaD.js";import{d as ie,k as z,c as B,a as C,o,b as a,u as t,m as re,e as l,f as i,i as v,g as n,n as x,j as c,t as _,F as S,r as L,l as oe,W as k}from"./app-BP0cvO6t.js";import{_ as ne}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-CTJ2YHuq.js";import{l as D,C as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-Wxm4vTXl.js";import{C as A}from"./clock-CjrSkZBt.js";import{C as T}from"./circle-check-big-Aw_YTsyI.js";import"./Input.vue_vue_type_script_setup_true_lang-_b-KefYx.js";import"./VisuallyHidden-DH9QYEuE.js";import"./VisuallyHiddenInput-pVmpfWF4.js";import"./index-DPFtgRKd.js";import"./check-Dw2nD4w7.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-C31h_kso.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-EbtR41RQ.js";import"./Label.vue_vue_type_script_setup_true_lang-CPKPM3Jk.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CYHRqWhQ.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-ByXQmMBA.js";import"./index-Bes9iSbW.js";import"./calendar-DFQbeeUt.js";import"./map-pin-Sz2po9BI.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-CGM9fbQ3.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-CV34_Trd.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DWmCblQ2.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-xyCLCeuh.js";import"./loader-circle-DSvq86dw.js";import"./trash-2-RYAqWBHg.js";import"./plus-D5-1g0lz.js";import"./search-BL6OsRpV.js";import"./history-Di75QaQZ.js";import"./save-CMF08kt7.js";const de={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ue={class:"flex items-center gap-4 mb-4"},ce={class:"flex items-center space-x-2"},fe={class:"relative min-h-[50vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},me={class:"rounded-md border"},_e={class:"flex items-center gap-1"},pe={class:"flex flex-col"},ve={class:"flex items-center gap-1"},xe={class:"flex flex-col"},ge={class:"flex items-center gap-1"},he={class:"flex flex-col"},be={class:"flex items-center gap-2 mb-1"},ye={class:"font-medium"},Ce={key:0,class:"text-sm text-muted-foreground"},ke={class:"text-sm"},we={class:"text-sm"},Ve={class:"flex items-center gap-2"},$e={class:"flex justify-end gap-2"},ze={key:0,class:"flex items-center justify-between mt-4"},Se={class:"text-sm text-muted-foreground"},De={class:"flex gap-2"},ft=ie({__name:"Index",props:{votaciones:{},categorias:{},filters:{},mostrar_pasadas:{type:Boolean},filterFieldsConfig:{}},setup(P){const d=P,j=[{title:"Dashboard",href:"/dashboard"},{title:"Mis Votaciones",href:"/votaciones"}],w=z(d.mostrar_pasadas||!1),{route:E}=window,q=B(()=>({quickSearch:d.filters.search||"",rootGroup:d.filters.advanced_filters?JSON.parse(d.filters.advanced_filters):void 0})),H={fields:d.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por título o descripción...",quickSearchFields:["titulo","descripcion"],maxNestingLevel:2,allowSaveFilters:!0,debounceTime:500,autoApply:!1},f=z("fecha_inicio"),m=z("asc"),V=r=>{f.value===r?m.value=m.value==="asc"?"desc":"asc":(f.value=r,m.value="asc")},I=B(()=>[...d.votaciones.data].sort((s,e)=>{let u,p;switch(f.value){case"fecha_inicio":u=new Date(s.fecha_inicio),p=new Date(e.fecha_inicio);break;case"fecha_fin":u=new Date(s.fecha_fin),p=new Date(e.fecha_fin);break;case"titulo":u=s.titulo.toLowerCase(),p=e.titulo.toLowerCase();break;default:u=s[f.value],p=e[f.value]}return u<p?m.value==="asc"?-1:1:u>p?m.value==="asc"?1:-1:0})),R=()=>{k.get("/votaciones",{...d.filters,mostrar_pasadas:w.value||void 0},{preserveState:!0,replace:!0})},U=r=>{k.get(`/votaciones/${r}/votar`)},W=r=>{k.get(`/votaciones/${r}/mi-voto`)},G=r=>{k.get(`/votaciones/${r}/resultados`)},J=r=>r.ya_voto?T:r.ha_finalizado?N:A,O=r=>r.ya_voto?"default":r.ha_finalizado?"destructive":"secondary",Q=r=>r.ya_voto?r.ha_finalizado?"Voté (Finalizada)":"Ya voté":r.ha_finalizado?"Expirada":"Disponible",M=r=>new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(r,s)=>(o(),C(S,null,[a(t(re),{title:"Mis Votaciones"}),a(le,{breadcrumbs:j},{default:l(()=>[i("div",de,[s[19]||(s[19]=i("div",{class:"flex items-center justify-between"},[i("div",null,[i("h1",{class:"text-3xl font-bold"},"Mis Votaciones"),i("p",{class:"text-muted-foreground"}," Votaciones disponibles para mi participación ")])],-1)),i("div",ue,[a(ne,{config:H,route:t(E)("votaciones.index"),"initial-filters":q.value,class:"flex-1"},null,8,["route","initial-filters"]),i("div",ce,[a(t(X),{id:"mostrar-pasadas",modelValue:w.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>w.value=e),R]},null,8,["modelValue"]),s[4]||(s[4]=i("label",{for:"mostrar-pasadas",class:"text-sm font-medium whitespace-nowrap"}," Ver historial ",-1))])]),i("div",fe,[a(t(Y),{class:"border-0 shadow-none h-full"},{default:l(()=>[a(t(K),{class:"pt-6"},{default:l(()=>[i("div",me,[a(t(Z),null,{default:l(()=>[a(t(ee),null,{default:l(()=>[a(t($),null,{default:l(()=>[a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[1]||(s[1]=e=>V("titulo"))},{default:l(()=>[i("div",_e,[s[5]||(s[5]=n(" Título ")),i("div",pe,[a(t(D),{class:x(["h-3 w-3",{"text-primary":f.value==="titulo"&&m.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="titulo"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:l(()=>s[6]||(s[6]=[n("Categoría")])),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[2]||(s[2]=e=>V("fecha_inicio"))},{default:l(()=>[i("div",ve,[s[7]||(s[7]=n(" Fecha de Apertura ")),i("div",xe,[a(t(D),{class:x(["h-3 w-3",{"text-primary":f.value==="fecha_inicio"&&m.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="fecha_inicio"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[3]||(s[3]=e=>V("fecha_fin"))},{default:l(()=>[i("div",ge,[s[8]||(s[8]=n(" Fecha Límite ")),i("div",he,[a(t(D),{class:x(["h-3 w-3",{"text-primary":f.value==="fecha_fin"&&m.value==="asc"}])},null,8,["class"]),a(t(F),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="fecha_fin"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:l(()=>s[9]||(s[9]=[n("Mi Estado")])),_:1}),a(t(b),{class:"text-right"},{default:l(()=>s[10]||(s[10]=[n("Acción")])),_:1})]),_:1})]),_:1}),a(t(te),null,{default:l(()=>[d.votaciones.data.length===0?(o(),c(t($),{key:0},{default:l(()=>[a(t(g),{colspan:6,class:"text-center py-8 text-muted-foreground"},{default:l(()=>[n(_(w.value?"No tienes historial de votaciones":"No tienes votaciones disponibles en este momento"),1)]),_:1})]),_:1})):v("",!0),(o(!0),C(S,null,L(I.value,e=>(o(),c(t($),{key:e.id,class:x({"opacity-75":e.ha_finalizado,"bg-green-50/50 dark:bg-green-950/10":e.ya_voto&&!e.ha_finalizado,"bg-blue-50/50 dark:bg-blue-950/10":e.puede_votar})},{default:l(()=>[a(t(g),null,{default:l(()=>{var u,p;return[i("div",null,[i("div",be,[i("p",ye,_(e.titulo),1),e.estado_visual==="finalizada"?(o(),c(t(y),{key:0,variant:"secondary",class:"text-xs"},{default:l(()=>s[11]||(s[11]=[n(" Finalizada ")])),_:1})):e.estado_visual==="activa"?(o(),c(t(y),{key:1,variant:"default",class:"text-xs"},{default:l(()=>s[12]||(s[12]=[n(" Activa ")])),_:1})):e.estado_visual==="pendiente"?(o(),c(t(y),{key:2,variant:"outline",class:"text-xs"},{default:l(()=>s[13]||(s[13]=[n(" Pendiente ")])),_:1})):v("",!0)]),e.descripcion?(o(),C("p",Ce,_((u=e.descripcion)==null?void 0:u.substring(0,80))+_(((p=e.descripcion)==null?void 0:p.length)>80?"...":""),1)):v("",!0)])]}),_:2},1024),a(t(g),null,{default:l(()=>[a(t(y),{variant:"outline"},{default:l(()=>[n(_(e.categoria.nombre),1)]),_:2},1024)]),_:2},1024),a(t(g),null,{default:l(()=>[i("div",ke,_(M(e.fecha_inicio)),1)]),_:2},1024),a(t(g),null,{default:l(()=>[i("div",we,_(M(e.fecha_fin)),1)]),_:2},1024),a(t(g),null,{default:l(()=>[i("div",Ve,[(o(),c(oe(J(e)),{class:x(["h-4 w-4",{"text-green-600":e.ya_voto,"text-orange-600":e.puede_votar,"text-red-600":!e.puede_votar&&!e.ya_voto}])},null,8,["class"])),a(t(y),{variant:O(e)},{default:l(()=>[n(_(Q(e)),1)]),_:2},1032,["variant"])])]),_:2},1024),a(t(g),{class:"text-right"},{default:l(()=>[i("div",$e,[e.puede_votar?(o(),c(t(h),{key:0,onClick:u=>U(e.id),size:"sm"},{default:l(()=>[a(t(se),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=n(" Votar "))]),_:2},1032,["onClick"])):v("",!0),e.estado_visual==="pendiente"?(o(),c(t(h),{key:1,variant:"outline",size:"sm",disabled:"",class:"cursor-not-allowed"},{default:l(()=>[a(t(A),{class:"mr-2 h-4 w-4"}),s[15]||(s[15]=n(" Próximamente "))]),_:1})):v("",!0),e.puede_ver_voto?(o(),c(t(h),{key:2,onClick:u=>W(e.id),variant:"outline",size:"sm"},{default:l(()=>[a(t(T),{class:"mr-2 h-4 w-4"}),s[16]||(s[16]=n(" Ver mi voto "))]),_:2},1032,["onClick"])):v("",!0),e.resultados_visibles?(o(),c(t(h),{key:3,onClick:u=>G(e.id),variant:"default",size:"sm",class:"bg-blue-600 hover:bg-blue-700 text-white"},{default:l(()=>[a(t(ae),{class:"mr-2 h-4 w-4"}),s[17]||(s[17]=n(" Ver Resultados "))]),_:2},1032,["onClick"])):v("",!0),e.ha_finalizado&&!e.ya_voto?(o(),c(t(h),{key:4,variant:"outline",size:"sm",disabled:""},{default:l(()=>[a(t(N),{class:"mr-2 h-4 w-4"}),s[18]||(s[18]=n(" No participé "))]),_:1})):v("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),d.votaciones.last_page>1?(o(),C("div",ze,[i("p",Se," Mostrando "+_((d.votaciones.current_page-1)*d.votaciones.per_page+1)+" a "+_(Math.min(d.votaciones.current_page*d.votaciones.per_page,d.votaciones.total))+" de "+_(d.votaciones.total)+" resultados ",1),i("div",De,[(o(!0),C(S,null,L(d.votaciones.links,e=>(o(),c(t(h),{key:e.label,variant:e.active?"default":"outline",disabled:!e.url,size:"sm",onClick:u=>e.url&&t(k).get(e.url),innerHTML:e.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):v("",!0)]),_:1})]),_:1})])])]),_:1})],64))}});export{ft as default};
