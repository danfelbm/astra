import{d as D,C as E,r as z,c as T,i as _,e as f,f as i,u as a,p as B,w as s,g as e,b as F,t as n,h as m,n as S,l as L,a1 as j,L as q,F as b,W as N}from"./app-CP1YmMoZ.js";import{_ as U}from"./index-GoXl7zHJ.js";import{_ as w}from"./createLucideIcon-B1k9xl0j.js";import{_ as $,c as A,a as P,b as R}from"./CardTitle.vue_vue_type_script_setup_true_lang-CNV2dJlR.js";import{_ as W,a as H,b as I,c as Z,d as J,e as K,f as O,g as Q}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CKxbJIJL.js";import{_ as X}from"./UserLayout.vue_vue_type_script_setup_true_lang-CfZxE0sV.js";import{D as Y}from"./DynamicFormRenderer-CVWf7A4D.js";import{A as oo}from"./arrow-left-BQpokHfr.js";import{C as x}from"./clock-oRJZVP6R.js";import{T as to}from"./triangle-alert-BxxUNsb8.js";import{V as eo}from"./vote-DL1APX8l.js";import{C as ao}from"./circle-check-big-B0hgvGN4.js";import"./index-BiWnI7cE.js";import"./VisuallyHidden-BdDHiRv9.js";import"./Input.vue_vue_type_script_setup_true_lang-CV2X9-dW.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BeE7juvx.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CcYNmYVt.js";import"./check-D8hxoy4M.js";import"./floating-ui.vue-nhGmn9M4.js";import"./nullish-CHIgUVhi.js";import"./x-C8LeRxX6.js";import"./UpdateLocationModal.vue_vue_type_script_setup_true_lang-xkKDDLMB.js";import"./index-D5ysKG8g.js";import"./index-BIZqS9oN.js";import"./shield-Cifvz0vu.js";import"./user-yW0LRUfd.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BQUhOSPN.js";import"./Label.vue_vue_type_script_setup_true_lang-DB2XL-fR.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-BUmLPkWv.js";import"./index-S3BBeh0J.js";import"./circle-alert-5uXwko6v.js";import"./map-pin-DITVkYmT.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-XogMyztG.js";import"./square-check-big-Dh7D0Dbq.js";import"./file-text-FY7E8fFz.js";import"./users-B5sI-BuP.js";import"./index-WNJArNv6.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-24Grk1LC.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-jS18uQiG.js";import"./Textarea.vue_vue_type_script_setup_true_lang-CMOtErJF.js";import"./plus-DuFIs0Ga.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-Bh3WeOQM.js";import"./RovingFocusItem-CnAi34uW.js";import"./utils-qIgYKbTI.js";import"./VisuallyHiddenInput-Ds72srhA.js";import"./useConditionalFields-BM62ZVJU.js";import"./upload-DMKloDLY.js";import"./eye-CP7Z8tS7.js";import"./download-C8u5gtpM.js";import"./calendar-CFQzeY2m.js";import"./grip-vertical-CFuiGnu0.js";import"./trash-2-P2SHUhel.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const io={class:"flex h-full flex-1 flex-col gap-3 sm:gap-6 rounded-xl p-2 sm:p-4"},so={class:"flex items-center justify-between"},ro={class:"text-3xl font-bold"},no={class:"text-muted-foreground"},lo={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},mo={class:"flex items-center gap-2"},co={class:"flex items-center gap-2 text-sm text-muted-foreground"},uo={class:"flex items-center gap-2 text-sm"},fo={class:"mt-4 pt-4 border-t"},po={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},vo={class:"text-muted-foreground"},_o={class:"mt-1"},go={class:"text-muted-foreground"},bo={class:"mt-1 font-semibold text-primary"},xo={class:"text-xs text-muted-foreground ml-1"},ho={key:0,class:"fixed bottom-0 left-0 right-0 z-50 px-2 sm:px-4 pb-2 sm:pb-4"},yo={class:"mx-auto max-w-7xl"},To={class:"backdrop-blur-lg bg-white/80 dark:bg-gray-900/80 border border-gray-200/50 dark:border-gray-700/50 rounded-xl sm:rounded-2xl shadow-2xl p-3 sm:p-4"},wo={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4"},$o={class:"hidden sm:flex items-center gap-4 text-sm text-muted-foreground"},Ao={class:"flex items-center gap-2"},Mo={class:"font-medium"},Co={class:"flex justify-center sm:justify-end"},Vo={class:"sm:hidden mt-3 text-center"},ko={class:"text-xs text-muted-foreground"},Gt=D({__name:"Votar",props:{votacion:{},candidatosElegibles:{}},setup(M){const r=M,C=[{title:"Dashboard",href:"/miembro/dashboard"},{title:"Mis Votaciones",href:"/miembro/votaciones"},{title:"Votar",href:"#"}],c=E((()=>{const t={};return r.votacion.formulario_config.forEach(o=>{o.type==="checkbox"?t[o.id]=[]:o.type==="convocatoria"?t[o.id]=void 0:t[o.id]=""}),{respuestas:t}})()),p=z(!1),V=()=>{c.post(route("user.votaciones.store",{votacion:r.votacion.id}),{preserveScroll:!0,preserveState:!1,onSuccess:()=>{},onError:t=>{console.error("Errores de validación:",t)}})},k=()=>{N.get(route("user.votaciones.index"))},h=t=>({"America/Bogota":"GMT-5","America/Mexico_City":"GMT-6","America/Lima":"GMT-5","America/Argentina/Buenos_Aires":"GMT-3","America/Santiago":"GMT-3","America/Caracas":"GMT-4","America/La_Paz":"GMT-4","America/Guayaquil":"GMT-5","America/Asuncion":"GMT-3","America/Montevideo":"GMT-3","America/Panama":"GMT-5","America/Costa_Rica":"GMT-6","America/Guatemala":"GMT-6","America/Havana":"GMT-5","America/Santo_Domingo":"GMT-4"})[t]||t,g=(t,o=!0)=>{const l=t.includes("local")?t:t===r.votacion.fecha_inicio&&r.votacion.fecha_inicio_local?r.votacion.fecha_inicio_local:t===r.votacion.fecha_fin&&r.votacion.fecha_fin_local?r.votacion.fecha_fin_local:t,d=new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(o&&r.votacion.timezone){const v=h(r.votacion.timezone);return`${d} (${v})`}return d},u=T(()=>{const t=new Date,l=new Date(r.votacion.fecha_fin_local||r.votacion.fecha_fin).getTime()-t.getTime();if(l<=0)return"Expirada";const d=Math.floor(l/(1e3*60*60)),v=Math.floor(l%(1e3*60*60)/(1e3*60));if(d>24){const y=Math.floor(d/24);return`${y} día${y>1?"s":""}`}else return d>0?`${d}h ${v}m`:`${v}m`}),G=T(()=>r.votacion.formulario_config.every(t=>{const o=c.respuestas[t.id];return t.type==="convocatoria"?o!==void 0:t.required?t.type==="checkbox"?Array.isArray(o)&&o.length>0:o&&o.toString().trim()!=="":!0}));return(t,o)=>(f(),_(b,null,[i(a(B),{title:`Votar: ${t.votacion.titulo}`},null,8,["title"]),i(X,{breadcrumbs:C},{default:s(()=>[e("div",io,[e("div",so,[e("div",null,[e("h1",ro,n(t.votacion.titulo),1),e("p",no,n(t.votacion.descripcion),1)]),i(a(w),{variant:"outline",onClick:k},{default:s(()=>[i(a(oo),{class:"mr-2 h-4 w-4"}),o[4]||(o[4]=m(" Volver ",-1))]),_:1})]),i(a($),null,{default:s(()=>[i(a(A),{class:"pt-6"},{default:s(()=>[e("div",lo,[e("div",mo,[i(a(U),{variant:"outline"},{default:s(()=>[m(n(t.votacion.categoria.nombre),1)]),_:1})]),e("div",co,[i(a(x),{class:"h-4 w-4"}),m(" Termina: "+n(g(t.votacion.fecha_fin)),1)]),e("div",uo,[i(a(to),{class:"h-4 w-4 text-orange-600"}),e("span",{class:S(u.value==="Expirada"?"text-red-600":"text-orange-600")},n(u.value==="Expirada"?"Votación expirada":`Tiempo restante: ${u.value}`),3)])]),e("div",fo,[e("div",po,[e("div",vo,[o[5]||(o[5]=e("span",{class:"font-medium"},"Periodo de votación:",-1)),e("div",_o," Inicio: "+n(g(t.votacion.fecha_inicio)),1),e("div",null," Fin: "+n(g(t.votacion.fecha_fin)),1)]),e("div",go,[o[6]||(o[6]=e("span",{class:"font-medium"},"Zona horaria:",-1)),e("div",bo,[m(n(h(t.votacion.timezone))+" ",1),e("span",xo,"("+n(t.votacion.timezone)+")",1)])])])])]),_:1})]),_:1}),i(a($),null,{default:s(()=>[i(a(P),null,{default:s(()=>[i(a(R),{class:"flex items-center gap-2"},{default:s(()=>[i(a(eo),{class:"h-5 w-5"}),o[7]||(o[7]=m(" Formulario de Votación ",-1))]),_:1})]),_:1}),i(a(A),null,{default:s(()=>[e("form",{onSubmit:o[1]||(o[1]=L(l=>p.value=!0,["prevent"])),class:"space-y-6"},[i(Y,{fields:t.votacion.formulario_config,modelValue:a(c).respuestas,"onUpdate:modelValue":o[0]||(o[0]=l=>a(c).respuestas=l),"candidatos-elegibles":t.candidatosElegibles||{},errors:a(c).errors,disabled:a(c).processing,title:"",description:"",context:"votacion"},null,8,["fields","modelValue","candidatos-elegibles","errors","disabled"]),o[8]||(o[8]=e("div",{class:"h-20"},null,-1))],32)]),_:1})]),_:1}),i(a(W),{open:p.value,"onUpdate:open":o[2]||(o[2]=l=>p.value=l)},{default:s(()=>[i(a(H),null,{default:s(()=>[i(a(I),null,{default:s(()=>[i(a(Z),null,{default:s(()=>[...o[9]||(o[9]=[m("¿Confirmar voto?",-1)])]),_:1}),i(a(J),null,{default:s(()=>[...o[10]||(o[10]=[m(" Una vez enviado tu voto, no podrás modificarlo. ¿Estás seguro de que quieres proceder? ",-1)])]),_:1})]),_:1}),i(a(K),null,{default:s(()=>[i(a(O),null,{default:s(()=>[...o[11]||(o[11]=[m("Cancelar",-1)])]),_:1}),i(a(Q),{onClick:V,class:"bg-primary"},{default:s(()=>[...o[12]||(o[12]=[m(" Confirmar Voto ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),(f(),F(j,{to:"body"},[i(q,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"translate-y-4 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-4 opacity-0"},{default:s(()=>[(f(),_("div",ho,[e("div",yo,[e("div",To,[e("div",wo,[e("div",$o,[e("div",Ao,[i(a(x),{class:"h-4 w-4"}),e("span",null,n(u.value),1)]),o[13]||(o[13]=e("div",{class:"h-4 w-px bg-gray-300 dark:bg-gray-600"},null,-1)),e("span",Mo,n(t.votacion.titulo),1)]),e("div",Co,[i(a(w),{onClick:o[3]||(o[3]=l=>p.value=!0),disabled:!G.value||a(c).processing,class:"bg-green-600 hover:bg-green-700 text-white border-green-600 hover:border-green-700 disabled:bg-gray-400 disabled:border-gray-400 min-w-[150px] sm:min-w-[180px]"},{default:s(()=>[a(c).processing?(f(),_(b,{key:0},[i(a(x),{class:"mr-2 h-4 w-4 animate-spin"}),o[14]||(o[14]=m(" Enviando... ",-1))],64)):(f(),_(b,{key:1},[i(a(ao),{class:"mr-2 h-4 w-4"}),o[15]||(o[15]=m(" Enviar Voto ",-1))],64))]),_:1},8,["disabled"])])]),e("div",Vo,[e("span",ko," Tiempo restante: "+n(u.value),1)])])])]))]),_:1})]))]),_:1})],64))}});export{Gt as default};
