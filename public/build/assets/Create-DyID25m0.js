import{d as G,u as T,r as A,i as u,e as t,f as e,q as Y,w as s,g as i,v as D,h as d,l as q,j as p,n as c,m as n,t as m,F as $,k as F,b as z}from"./app-KXtif7qq.js";import{_ as L}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DUay4fSq.js";import{_ as k}from"./createLucideIcon-BY2zdh_L.js";import{_ as x,a as g,b,c as V}from"./CardTitle.vue_vue_type_script_setup_true_lang-B7Mglf7h.js";import{_ as y}from"./CardDescription.vue_vue_type_script_setup_true_lang-DSfUmw7N.js";import{_ as v}from"./Input.vue_vue_type_script_setup_true_lang-BkaVdW_x.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-kqtySDWN.js";import{_ as H,a as J,b as O,c as I,d as B}from"./SelectValue.vue_vue_type_script_setup_true_lang-lIT9MUQE.js";import{_ as W}from"./Switch.vue_vue_type_script_setup_true_lang-DyvvAwg_.js";import{_ as K}from"./Checkbox.vue_vue_type_script_setup_true_lang-DyEj-ZBz.js";import{_ as Q}from"./GeographicSelector.vue_vue_type_script_setup_true_lang-hjOO1ket.js";import{_ as X}from"./AvatarUpload.vue_vue_type_script_setup_true_lang-BopktARK.js";import{t as N}from"./index-Dm0KPXQj.js";import{A as Z}from"./arrow-left-nC1PH91F.js";import{S as h}from"./save-J73N-xyk.js";import"./useFlashMessages-C0levHeu.js";import"./index-dxUqd-18.js";import"./floating-ui.vue-oBzjxj0U.js";import"./x-BG7w8fZB.js";import"./index-WC1PnT1j.js";import"./shield-DnGJw1Ro.js";import"./user-D9tKp3_0.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B_dxU_KJ.js";import"./chevron-right-qwsTIbSz.js";import"./house-D8k__HYI.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BtuZaRmw.js";import"./VisuallyHidden-CuGa-e_U.js";import"./index-DM1P4Ifz.js";import"./circle-alert-BxdHbCZ8.js";import"./map-pin-Bgv-opIp.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-D7Pmpm9D.js";import"./chevrons-up-down-DK_UD8ra.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CHh-gB3O.js";import"./target-Dm6ej6_p.js";import"./users-BWb5DPyh.js";import"./vote-BnmR_OQK.js";import"./folder-open-Cx58QfFB.js";import"./send-C8_ce2KL.js";import"./file-text-CE1uNbyL.js";import"./briefcase-CRBoyl6H.js";import"./calendar-Ce5ju53J.js";import"./megaphone-BVwAYYrZ.js";import"./user-check-BpAk48jb.js";import"./clipboard-list-DEDIgC_n.js";import"./mail-SA5Kz7Xj.js";import"./message-square-CUB5aJ5F.js";import"./external-link-hexnS8K7.js";import"./panel-left-DuOe-Xz_.js";import"./index-DMu57UMp.js";import"./check-BXO7M11A.js";import"./index-D_JV8DVQ.js";import"./VisuallyHiddenInput-BGtQfI-v.js";import"./loader-circle-DQozwruZ.js";import"./upload-B42i2FXz.js";const ee={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},oe={class:"flex items-center justify-between"},re={class:"grid gap-4 md:grid-cols-2"},te={key:0,class:"text-sm text-red-600 mt-1"},ae={key:0,class:"text-sm text-red-600 mt-1"},se={key:0,class:"text-sm text-red-600 mt-1"},le={key:0,class:"text-sm text-red-600 mt-1"},ie={key:0,class:"text-sm text-red-600 mt-1"},de={key:0,class:"text-sm text-red-600 mt-1"},ne={class:"grid gap-4 md:grid-cols-2"},ue={key:0,class:"text-sm text-red-600 mt-1"},me={key:0,class:"text-sm text-red-600 mt-1"},pe={class:"space-y-4"},fe={key:0},ce={class:"space-y-2 max-h-64 overflow-y-auto border rounded-lg p-4"},_e={class:"flex-1"},ve={key:0,class:"text-sm text-muted-foreground"},xe={key:1,class:"text-xs text-blue-600"},ge={key:0,class:"text-sm text-red-600 mt-1"},be={key:1},Ve={key:0,class:"text-sm text-red-600 mt-1"},ye={class:"flex items-center space-x-2"},we={key:0,class:"text-sm text-red-600 mt-2"},Ue={class:"flex items-center justify-end space-x-2"},ko=G({__name:"Create",props:{cargos:{},roles:{},canAssignRoles:{type:Boolean}},setup(w){const R=[{title:"Admin",href:"/admin/dashboard"},{title:"Usuarios",href:"/admin/usuarios"},{title:"Nuevo Usuario",href:"#"}],r=T({name:"",email:"",password:"",password_confirmation:"",role_ids:[],cargo_id:"none",documento_identidad:"",telefono:"",direccion:"",territorio_id:null,departamento_id:null,municipio_id:null,localidad_id:null,activo:!0,avatar:null,created_at:""}),U=A(null),S=A({territorio_id:void 0,departamento_id:void 0,municipio_id:void 0,localidad_id:void 0}),j=l=>{S.value=l,r.territorio_id=l.territorio_id||null,r.departamento_id=l.departamento_id||null,r.municipio_id=l.municipio_id||null,r.localidad_id=l.localidad_id||null},M=l=>{r.avatar=l;const o=new FileReader;o.onload=a=>{var _;U.value=(_=a.target)==null?void 0:_.result},o.readAsDataURL(l),N.success("Avatar seleccionado. Se cargará al crear el usuario.")},P=()=>{r.avatar=null,U.value=null,N.success("Avatar eliminado")},E=()=>{r.avatar?r.transform(l=>{const o=new FormData;return Object.keys(l).forEach(a=>{if(a==="avatar"&&l[a])o.append("avatar",l[a]);else if(a==="role_ids"&&Array.isArray(l[a]))l[a].forEach(_=>{o.append("role_ids[]",_.toString())});else if(a==="created_at"&&l[a]){const _=l[a].toString().replace("T"," ");o.append(a,_)}else l[a]!==null&&l[a]!==void 0&&o.append(a,l[a].toString())}),o}).post(route("admin.usuarios.store"),{forceFormData:!0}):r.transform(l=>(l.created_at&&(l.created_at=l.created_at.replace("T"," ")),l)).post(route("admin.usuarios.store"))};return(l,o)=>(n(),u($,null,[t(e(Y),{title:"Crear Usuario"}),t(L,{breadcrumbs:R},{default:s(()=>[i("div",ee,[i("div",oe,[o[11]||(o[11]=i("div",null,[i("h1",{class:"text-3xl font-bold tracking-tight"},"Crear Usuario"),i("p",{class:"text-muted-foreground"}," Registra un nuevo usuario en el sistema ")],-1)),t(e(D),{href:l.route("admin.usuarios.index")},{default:s(()=>[t(e(k),{variant:"outline"},{default:s(()=>[t(e(Z),{class:"mr-2 h-4 w-4"}),o[10]||(o[10]=d(" Volver ",-1))]),_:1})]),_:1},8,["href"])]),i("form",{onSubmit:q(E,["prevent"]),class:"space-y-6"},[t(e(x),null,{default:s(()=>[t(e(g),null,{default:s(()=>[t(e(b),null,{default:s(()=>[...o[12]||(o[12]=[d("Foto de Perfil",-1)])]),_:1}),t(e(y),null,{default:s(()=>[...o[13]||(o[13]=[d(" Avatar personalizado del usuario (opcional) ",-1)])]),_:1})]),_:1}),t(e(V),null,{default:s(()=>[t(X,{"model-value":U.value,"user-name":e(r).name||"Nuevo Usuario",label:"Avatar del usuario",description:"Sube una foto de perfil para el nuevo usuario. JPG, PNG o WEBP. Máximo 5MB.",onUpload:M,onDelete:P},null,8,["model-value","user-name"])]),_:1})]),_:1}),t(e(x),null,{default:s(()=>[t(e(g),null,{default:s(()=>[t(e(b),null,{default:s(()=>[...o[14]||(o[14]=[d("Información Básica",-1)])]),_:1}),t(e(y),null,{default:s(()=>[...o[15]||(o[15]=[d(" Datos principales del usuario ",-1)])]),_:1})]),_:1}),t(e(V),{class:"space-y-4"},{default:s(()=>[i("div",re,[i("div",null,[t(e(f),{for:"name"},{default:s(()=>[...o[16]||(o[16]=[d("Nombre completo *",-1)])]),_:1}),t(e(v),{id:"name",modelValue:e(r).name,"onUpdate:modelValue":o[0]||(o[0]=a=>e(r).name=a),type:"text",placeholder:"Juan Pérez",class:c({"border-red-500":e(r).errors.name})},null,8,["modelValue","class"]),e(r).errors.name?(n(),u("p",te,m(e(r).errors.name),1)):p("",!0)]),i("div",null,[t(e(f),{for:"email"},{default:s(()=>[...o[17]||(o[17]=[d("Correo electrónico *",-1)])]),_:1}),t(e(v),{id:"email",modelValue:e(r).email,"onUpdate:modelValue":o[1]||(o[1]=a=>e(r).email=a),type:"email",placeholder:"juan@ejemplo.com",class:c({"border-red-500":e(r).errors.email})},null,8,["modelValue","class"]),e(r).errors.email?(n(),u("p",ae,m(e(r).errors.email),1)):p("",!0)]),i("div",null,[t(e(f),{for:"documento_identidad"},{default:s(()=>[...o[18]||(o[18]=[d("Documento de identidad *",-1)])]),_:1}),t(e(v),{id:"documento_identidad",modelValue:e(r).documento_identidad,"onUpdate:modelValue":o[2]||(o[2]=a=>e(r).documento_identidad=a),type:"text",placeholder:"12345678",class:c({"border-red-500":e(r).errors.documento_identidad}),required:""},null,8,["modelValue","class"]),e(r).errors.documento_identidad?(n(),u("p",se,m(e(r).errors.documento_identidad),1)):p("",!0)]),i("div",null,[t(e(f),{for:"telefono"},{default:s(()=>[...o[19]||(o[19]=[d("Teléfono *",-1)])]),_:1}),t(e(v),{id:"telefono",modelValue:e(r).telefono,"onUpdate:modelValue":o[3]||(o[3]=a=>e(r).telefono=a),type:"tel",placeholder:"3001234567",class:c({"border-red-500":e(r).errors.telefono}),required:""},null,8,["modelValue","class"]),e(r).errors.telefono?(n(),u("p",le,m(e(r).errors.telefono),1)):p("",!0)])]),i("div",null,[t(e(f),{for:"direccion"},{default:s(()=>[...o[20]||(o[20]=[d("Dirección",-1)])]),_:1}),t(e(v),{id:"direccion",modelValue:e(r).direccion,"onUpdate:modelValue":o[4]||(o[4]=a=>e(r).direccion=a),type:"text",placeholder:"Calle 123 #45-67",class:c({"border-red-500":e(r).errors.direccion})},null,8,["modelValue","class"]),e(r).errors.direccion?(n(),u("p",ie,m(e(r).errors.direccion),1)):p("",!0)]),i("div",null,[t(e(f),{for:"created_at"},{default:s(()=>[...o[21]||(o[21]=[d("Fecha de creación (opcional)",-1)])]),_:1}),t(e(v),{id:"created_at",modelValue:e(r).created_at,"onUpdate:modelValue":o[5]||(o[5]=a=>e(r).created_at=a),type:"datetime-local",class:c({"border-red-500":e(r).errors.created_at}),step:"1"},null,8,["modelValue","class"]),o[22]||(o[22]=i("p",{class:"text-xs text-muted-foreground mt-1"}," Deja vacío para usar la fecha actual. Formato: YYYY-MM-DD HH:MM:SS ",-1)),e(r).errors.created_at?(n(),u("p",de,m(e(r).errors.created_at),1)):p("",!0)])]),_:1})]),_:1}),t(e(x),null,{default:s(()=>[t(e(g),null,{default:s(()=>[t(e(b),null,{default:s(()=>[...o[23]||(o[23]=[d("Seguridad",-1)])]),_:1}),t(e(y),null,{default:s(()=>[...o[24]||(o[24]=[d(" Configuración de acceso y contraseña ",-1)])]),_:1})]),_:1}),t(e(V),{class:"space-y-4"},{default:s(()=>[i("div",ne,[i("div",null,[t(e(f),{for:"password"},{default:s(()=>[...o[25]||(o[25]=[d("Contraseña *",-1)])]),_:1}),t(e(v),{id:"password",modelValue:e(r).password,"onUpdate:modelValue":o[6]||(o[6]=a=>e(r).password=a),type:"password",placeholder:"••••••••",class:c({"border-red-500":e(r).errors.password})},null,8,["modelValue","class"]),e(r).errors.password?(n(),u("p",ue,m(e(r).errors.password),1)):p("",!0)]),i("div",null,[t(e(f),{for:"password_confirmation"},{default:s(()=>[...o[26]||(o[26]=[d("Confirmar contraseña *",-1)])]),_:1}),t(e(v),{id:"password_confirmation",modelValue:e(r).password_confirmation,"onUpdate:modelValue":o[7]||(o[7]=a=>e(r).password_confirmation=a),type:"password",placeholder:"••••••••",class:c({"border-red-500":e(r).errors.password_confirmation})},null,8,["modelValue","class"]),e(r).errors.password_confirmation?(n(),u("p",me,m(e(r).errors.password_confirmation),1)):p("",!0)])]),i("div",pe,[w.canAssignRoles?(n(),u("div",fe,[t(e(f),null,{default:s(()=>[...o[27]||(o[27]=[d("Roles del usuario *",-1)])]),_:1}),o[28]||(o[28]=i("p",{class:"text-sm text-muted-foreground mb-3"}," Selecciona uno o más roles para este usuario ",-1)),i("div",ce,[(n(!0),u($,null,F(w.roles,a=>(n(),u("div",{key:a.value,class:"flex items-start space-x-3 py-2"},[t(e(K),{id:`role-${a.value}`,checked:e(r).role_ids.includes(a.value),"onUpdate:checked":_=>{if(_)e(r).role_ids.includes(a.value)||e(r).role_ids.push(a.value);else{const C=e(r).role_ids.indexOf(a.value);C>-1&&e(r).role_ids.splice(C,1)}}},null,8,["id","checked","onUpdate:checked"]),i("div",_e,[t(e(f),{for:`role-${a.value}`,class:"text-base font-medium cursor-pointer"},{default:s(()=>[d(m(a.label),1)]),_:2},1032,["for"]),a.description?(n(),u("p",ve,m(a.description),1)):p("",!0),a.is_system?(n(),u("span",xe," (Rol del Sistema) ")):p("",!0)])]))),128))]),e(r).errors.role_ids?(n(),u("p",ge,m(e(r).errors.role_ids),1)):p("",!0)])):(n(),u("div",be,[t(e(f),null,{default:s(()=>[...o[29]||(o[29]=[d("Rol",-1)])]),_:1}),o[30]||(o[30]=i("div",{class:"p-3 bg-muted rounded-md"},[i("p",{class:"text-sm text-muted-foreground"}," Se asignará el rol por defecto al usuario ")],-1))])),i("div",null,[t(e(f),{for:"cargo_id"},{default:s(()=>[...o[31]||(o[31]=[d("Cargo",-1)])]),_:1}),t(e(H),{modelValue:e(r).cargo_id,"onUpdate:modelValue":o[8]||(o[8]=a=>e(r).cargo_id=a)},{default:s(()=>[t(e(J),{class:c({"border-red-500":e(r).errors.cargo_id})},{default:s(()=>[t(e(O),{placeholder:"Selecciona un cargo"})]),_:1},8,["class"]),t(e(I),null,{default:s(()=>[t(e(B),{value:"none"},{default:s(()=>[...o[32]||(o[32]=[d("Sin cargo",-1)])]),_:1}),(n(!0),u($,null,F(w.cargos,a=>(n(),z(e(B),{key:a.id,value:a.id.toString()},{default:s(()=>[d(m(a.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(r).errors.cargo_id?(n(),u("p",Ve,m(e(r).errors.cargo_id),1)):p("",!0)])]),i("div",ye,[t(e(W),{id:"activo",checked:e(r).activo,"onUpdate:checked":o[9]||(o[9]=a=>e(r).activo=a)},null,8,["checked"]),t(e(f),{for:"activo"},{default:s(()=>[...o[33]||(o[33]=[d("Usuario activo",-1)])]),_:1})])]),_:1})]),_:1}),t(e(x),null,{default:s(()=>[t(e(g),null,{default:s(()=>[t(e(b),null,{default:s(()=>[...o[34]||(o[34]=[d("Ubicación Geográfica",-1)])]),_:1}),t(e(y),null,{default:s(()=>[...o[35]||(o[35]=[d(" Define la ubicación del usuario (opcional) ",-1)])]),_:1})]),_:1}),t(e(V),null,{default:s(()=>[t(Q,{"model-value":S.value,"onUpdate:modelValue":j,mode:"single","show-card":!1,title:"",description:""},null,8,["model-value"]),e(r).errors.territorio_id||e(r).errors.departamento_id||e(r).errors.municipio_id||e(r).errors.localidad_id?(n(),u("div",we,m(e(r).errors.territorio_id||e(r).errors.departamento_id||e(r).errors.municipio_id||e(r).errors.localidad_id),1)):p("",!0)]),_:1})]),_:1}),i("div",Ue,[t(e(D),{href:l.route("admin.usuarios.index")},{default:s(()=>[t(e(k),{variant:"outline",type:"button"},{default:s(()=>[...o[36]||(o[36]=[d(" Cancelar ",-1)])]),_:1})]),_:1},8,["href"]),t(e(k),{type:"submit",disabled:e(r).processing},{default:s(()=>[t(e(h),{class:"mr-2 h-4 w-4"}),o[37]||(o[37]=d(" Crear Usuario ",-1))]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{ko as default};
