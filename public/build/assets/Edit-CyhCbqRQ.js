import{_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-C7XcGlX4.js";import{d as Q,C as X,k as F,p as Y,c as Z,w as h,a as p,o as m,b as e,u as l,m as ll,e as i,f as s,j,i as U,g as r,t as v,F as w,r as D,n as ol,W as el}from"./app-DDSU5uN7.js";import{_ as E}from"./createLucideIcon-BfVy0SFr.js";import{_ as V,a as g,b,c as y}from"./CardTitle.vue_vue_type_script_setup_true_lang-CfXCxct6.js";import{_ as $}from"./CardDescription.vue_vue_type_script_setup_true_lang-R8khDAHy.js";import{_}from"./Input.vue_vue_type_script_setup_true_lang-DloUOX4w.js";import{_ as n}from"./Label.vue_vue_type_script_setup_true_lang-B6qLE2NP.js";import{_ as M}from"./Textarea.vue_vue_type_script_setup_true_lang-CNVqZXHh.js";import{_ as k,a as A,b as S,c as P,d as f}from"./SelectValue.vue_vue_type_script_setup_true_lang-DhdtXOhv.js";import{_ as q}from"./Switch.vue_vue_type_script_setup_true_lang-BX7DVyVl.js";import{_ as il,a as al,b as N,c as T}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-CnGQ_xel.js";import{_ as L,a as O}from"./index-BaCJCCFv.js";import{_ as tl}from"./DynamicFormBuilder.vue_vue_type_script_setup_true_lang-CPgA5YD7.js";import{A as rl}from"./arrow-left-BDJyv-QG.js";import{E as sl}from"./eye-BaRoqJ35.js";import{S as ul}from"./save-D7KdBMYf.js";import"./index-APndk64q.js";import"./check-Cnad2drU.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BUWx5DM7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GeographicSelector.vue_vue_type_script_setup_true_lang-B-HIcCfq.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CtnWlOEt.js";import"./VisuallyHidden-bGJF1x_r.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-D_RAhnKd.js";import"./index-DlY_kZJS.js";import"./calendar-BerL1z25.js";import"./index-BTN_CKnm.js";import"./map-pin-4Kefx8iA.js";import"./VisuallyHiddenInput-BpmWuG2w.js";import"./RovingFocusItem-BFrOkdA9.js";import"./utils-DesyTqqv.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-B1pi0cAi.js";import"./plus-C2GsDtN_.js";import"./grip-vertical-DdB8gJFT.js";import"./trash-2-D_0HhvER.js";import"./git-branch-BTI-jgEr.js";const nl={class:"p-6"},dl={class:"mb-6 flex items-center justify-between"},ml={class:"flex gap-2"},fl={class:"list-disc list-inside"},pl={key:0,class:"text-sm text-destructive mt-1"},_l={class:"flex items-center justify-between"},cl={class:"space-y-0.5"},vl={key:0,class:"flex items-center justify-between"},Vl={class:"space-y-0.5"},gl={class:"grid grid-cols-2 gap-4"},bl={class:"grid grid-cols-2 gap-4"},yl={class:"flex items-center justify-between"},$l={class:"space-y-0.5"},ao=Q({__name:"Edit",props:{formulario:{},categorias:{}},setup(R){const u=R,z=[{title:"Dashboard",href:"/dashboard"},{title:"Admin",href:"/admin/dashboard"},{title:"Formularios",href:"/admin/formularios"},{title:"Editar",href:"#"}],a=X({titulo:u.formulario.titulo,descripcion:u.formulario.descripcion||"",categoria_id:u.formulario.categoria_id||null,configuracion_campos:u.formulario.configuracion_campos||[],configuracion_general:u.formulario.configuracion_general||{},tipo_acceso:u.formulario.tipo_acceso,permite_visitantes:u.formulario.permite_visitantes,requiere_captcha:u.formulario.requiere_captcha,fecha_inicio:u.formulario.fecha_inicio||null,fecha_fin:u.formulario.fecha_fin||null,limite_respuestas:u.formulario.limite_respuestas||null,limite_por_usuario:u.formulario.limite_por_usuario,emails_notificacion:u.formulario.emails_notificacion||[],mensaje_confirmacion:u.formulario.mensaje_confirmacion||"",estado:u.formulario.estado,activo:u.formulario.activo,_method:"PUT"}),B=F("informacion"),c=F(""),x=F(!1),C=F("");Y(()=>{u.formulario.emails_notificacion&&u.formulario.emails_notificacion.length>0&&(c.value=u.formulario.emails_notificacion.join(", ")),C.value=`${window.location.origin}/formularios/${u.formulario.slug}`});const I=Z(()=>a.titulo&&a.configuracion_campos.length>0&&a.limite_por_usuario>=1),G=()=>{c.value?a.emails_notificacion=c.value.split(",").map(d=>d.trim()).filter(d=>d.length>0):a.emails_notificacion=[],a.post(route("admin.formularios.update",u.formulario.id),{preserveScroll:!0,onError:()=>{}})},W=()=>{el.get(route("admin.formularios.index"))},H=d=>{a.configuracion_campos=d};return h(()=>a.fecha_inicio,d=>{d&&a.fecha_fin&&d>a.fecha_fin&&(a.fecha_fin=null)}),(d,o)=>(m(),p(w,null,[e(l(ll),{title:"Editar Formulario"}),e(K,{breadcrumbs:z},{default:i(()=>[s("div",nl,[s("div",dl,[o[19]||(o[19]=s("div",null,[s("h1",{class:"text-3xl font-bold"},"Editar Formulario"),s("p",{class:"text-muted-foreground"}," Modifica la configuración del formulario ")],-1)),s("div",ml,[e(l(E),{variant:"outline",onClick:W},{default:i(()=>[e(l(rl),{class:"mr-2 h-4 w-4"}),o[17]||(o[17]=r(" Cancelar "))]),_:1}),e(l(E),{onClick:o[0]||(o[0]=t=>x.value=!x.value),variant:"outline"},{default:i(()=>[e(l(sl),{class:"mr-2 h-4 w-4"}),r(" "+v(x.value?"Ocultar":"Ver")+" Vista Previa ",1)]),_:1}),e(l(E),{onClick:G,disabled:l(a).processing||!I.value},{default:i(()=>[e(l(ul),{class:"mr-2 h-4 w-4"}),o[18]||(o[18]=r(" Guardar Cambios "))]),_:1},8,["disabled"])])]),C.value?(m(),j(l(L),{key:0,class:"mb-6"},{default:i(()=>[e(l(O),null,{default:i(()=>[o[20]||(o[20]=s("strong",null,"URL pública:",-1)),r(" "+v(C.value),1)]),_:1})]),_:1})):U("",!0),l(a).errors&&Object.keys(l(a).errors).length>0?(m(),j(l(L),{key:1,class:"mb-6",variant:"destructive"},{default:i(()=>[e(l(O),null,{default:i(()=>[s("ul",fl,[(m(!0),p(w,null,D(l(a).errors,(t,J)=>(m(),p("li",{key:J},v(t),1))),128))])]),_:1})]),_:1})):U("",!0),e(l(il),{modelValue:B.value,"onUpdate:modelValue":o[16]||(o[16]=t=>B.value=t),class:"space-y-6"},{default:i(()=>[e(l(al),{class:"grid w-full grid-cols-2"},{default:i(()=>[e(l(N),{value:"informacion"},{default:i(()=>o[21]||(o[21]=[r("Información General")])),_:1}),e(l(N),{value:"formulario"},{default:i(()=>o[22]||(o[22]=[r("Constructor de Formulario")])),_:1})]),_:1}),e(l(T),{value:"informacion",class:"space-y-6"},{default:i(()=>[e(l(V),null,{default:i(()=>[e(l(g),null,{default:i(()=>[e(l(b),null,{default:i(()=>o[23]||(o[23]=[r("Información Básica")])),_:1}),e(l($),null,{default:i(()=>o[24]||(o[24]=[r(" Define los datos principales del formulario ")])),_:1})]),_:1}),e(l(y),{class:"space-y-4"},{default:i(()=>[s("div",null,[e(l(n),{htmlFor:"titulo"},{default:i(()=>o[25]||(o[25]=[r("Título *")])),_:1}),e(l(_),{id:"titulo",modelValue:l(a).titulo,"onUpdate:modelValue":o[1]||(o[1]=t=>l(a).titulo=t),placeholder:"Ej: Encuesta de Satisfacción",class:ol({"border-destructive":l(a).errors.titulo})},null,8,["modelValue","class"]),l(a).errors.titulo?(m(),p("p",pl,v(l(a).errors.titulo),1)):U("",!0)]),s("div",null,[e(l(n),{htmlFor:"descripcion"},{default:i(()=>o[26]||(o[26]=[r("Descripción")])),_:1}),e(l(M),{id:"descripcion",modelValue:l(a).descripcion,"onUpdate:modelValue":o[2]||(o[2]=t=>l(a).descripcion=t),placeholder:"Describe el propósito del formulario",rows:"3"},null,8,["modelValue"])]),s("div",null,[e(l(n),{htmlFor:"categoria"},{default:i(()=>o[27]||(o[27]=[r("Categoría")])),_:1}),e(l(k),{modelValue:l(a).categoria_id,"onUpdate:modelValue":o[3]||(o[3]=t=>l(a).categoria_id=t)},{default:i(()=>[e(l(A),{id:"categoria"},{default:i(()=>[e(l(S),{placeholder:"Selecciona una categoría"})]),_:1}),e(l(P),null,{default:i(()=>[(m(!0),p(w,null,D(d.categorias,t=>(m(),j(l(f),{key:t.id,value:t.id.toString()},{default:i(()=>[r(v(t.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),e(l(V),null,{default:i(()=>[e(l(g),null,{default:i(()=>[e(l(b),null,{default:i(()=>o[28]||(o[28]=[r("Control de Acceso")])),_:1}),e(l($),null,{default:i(()=>o[29]||(o[29]=[r(" Define quién puede llenar el formulario ")])),_:1})]),_:1}),e(l(y),{class:"space-y-4"},{default:i(()=>[s("div",null,[e(l(n),{htmlFor:"tipo_acceso"},{default:i(()=>o[30]||(o[30]=[r("Tipo de Acceso")])),_:1}),e(l(k),{modelValue:l(a).tipo_acceso,"onUpdate:modelValue":o[4]||(o[4]=t=>l(a).tipo_acceso=t)},{default:i(()=>[e(l(A),{id:"tipo_acceso"},{default:i(()=>[e(l(S))]),_:1}),e(l(P),null,{default:i(()=>[e(l(f),{value:"publico"},{default:i(()=>o[31]||(o[31]=[r("Público")])),_:1}),e(l(f),{value:"autenticado"},{default:i(()=>o[32]||(o[32]=[r("Usuarios Autenticados")])),_:1}),e(l(f),{value:"con_permiso"},{default:i(()=>o[33]||(o[33]=[r("Con Permiso Específico")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),s("div",_l,[s("div",cl,[e(l(n),null,{default:i(()=>o[34]||(o[34]=[r("Permitir Visitantes")])),_:1}),o[35]||(o[35]=s("p",{class:"text-sm text-muted-foreground"}," Usuarios no autenticados pueden llenar el formulario ",-1))]),e(l(q),{modelValue:l(a).permite_visitantes,"onUpdate:modelValue":o[5]||(o[5]=t=>l(a).permite_visitantes=t)},null,8,["modelValue"])]),l(a).permite_visitantes?(m(),p("div",vl,[s("div",Vl,[e(l(n),null,{default:i(()=>o[36]||(o[36]=[r("Requiere Captcha")])),_:1}),o[37]||(o[37]=s("p",{class:"text-sm text-muted-foreground"}," Protección contra bots para visitantes ",-1))]),e(l(q),{modelValue:l(a).requiere_captcha,"onUpdate:modelValue":o[6]||(o[6]=t=>l(a).requiere_captcha=t)},null,8,["modelValue"])])):U("",!0)]),_:1})]),_:1}),e(l(V),null,{default:i(()=>[e(l(g),null,{default:i(()=>[e(l(b),null,{default:i(()=>o[38]||(o[38]=[r("Vigencia y Límites")])),_:1}),e(l($),null,{default:i(()=>o[39]||(o[39]=[r(" Controla la disponibilidad del formulario ")])),_:1})]),_:1}),e(l(y),{class:"space-y-4"},{default:i(()=>[s("div",gl,[s("div",null,[e(l(n),{htmlFor:"fecha_inicio"},{default:i(()=>o[40]||(o[40]=[r("Fecha de Inicio")])),_:1}),e(l(_),{id:"fecha_inicio",type:"datetime-local",modelValue:l(a).fecha_inicio,"onUpdate:modelValue":o[7]||(o[7]=t=>l(a).fecha_inicio=t)},null,8,["modelValue"])]),s("div",null,[e(l(n),{htmlFor:"fecha_fin"},{default:i(()=>o[41]||(o[41]=[r("Fecha de Fin")])),_:1}),e(l(_),{id:"fecha_fin",type:"datetime-local",modelValue:l(a).fecha_fin,"onUpdate:modelValue":o[8]||(o[8]=t=>l(a).fecha_fin=t),min:l(a).fecha_inicio},null,8,["modelValue","min"])])]),s("div",bl,[s("div",null,[e(l(n),{htmlFor:"limite_respuestas"},{default:i(()=>o[42]||(o[42]=[r("Límite Total de Respuestas")])),_:1}),e(l(_),{id:"limite_respuestas",type:"number",modelValue:l(a).limite_respuestas,"onUpdate:modelValue":o[9]||(o[9]=t=>l(a).limite_respuestas=t),modelModifiers:{number:!0},placeholder:"Sin límite",min:"1"},null,8,["modelValue"])]),s("div",null,[e(l(n),{htmlFor:"limite_por_usuario"},{default:i(()=>o[43]||(o[43]=[r("Respuestas por Usuario *")])),_:1}),e(l(_),{id:"limite_por_usuario",type:"number",modelValue:l(a).limite_por_usuario,"onUpdate:modelValue":o[10]||(o[10]=t=>l(a).limite_por_usuario=t),modelModifiers:{number:!0},min:"1"},null,8,["modelValue"])])])]),_:1})]),_:1}),e(l(V),null,{default:i(()=>[e(l(g),null,{default:i(()=>[e(l(b),null,{default:i(()=>o[44]||(o[44]=[r("Configuración Adicional")])),_:1}),e(l($),null,{default:i(()=>o[45]||(o[45]=[r(" Opciones avanzadas del formulario ")])),_:1})]),_:1}),e(l(y),{class:"space-y-4"},{default:i(()=>[s("div",null,[e(l(n),{htmlFor:"estado"},{default:i(()=>o[46]||(o[46]=[r("Estado")])),_:1}),e(l(k),{modelValue:l(a).estado,"onUpdate:modelValue":o[11]||(o[11]=t=>l(a).estado=t)},{default:i(()=>[e(l(A),{id:"estado"},{default:i(()=>[e(l(S))]),_:1}),e(l(P),null,{default:i(()=>[e(l(f),{value:"borrador"},{default:i(()=>o[47]||(o[47]=[r("Borrador")])),_:1}),e(l(f),{value:"publicado"},{default:i(()=>o[48]||(o[48]=[r("Publicado")])),_:1}),e(l(f),{value:"archivado"},{default:i(()=>o[49]||(o[49]=[r("Archivado")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),s("div",null,[e(l(n),{htmlFor:"emails"},{default:i(()=>o[50]||(o[50]=[r("Emails de Notificación")])),_:1}),e(l(_),{id:"emails",modelValue:c.value,"onUpdate:modelValue":o[12]||(o[12]=t=>c.value=t),placeholder:"email1@ejemplo.com, email2@ejemplo.com"},null,8,["modelValue"]),o[51]||(o[51]=s("p",{class:"text-sm text-muted-foreground mt-1"}," Separa múltiples emails con comas ",-1))]),s("div",null,[e(l(n),{htmlFor:"mensaje"},{default:i(()=>o[52]||(o[52]=[r("Mensaje de Confirmación")])),_:1}),e(l(M),{id:"mensaje",modelValue:l(a).mensaje_confirmacion,"onUpdate:modelValue":o[13]||(o[13]=t=>l(a).mensaje_confirmacion=t),placeholder:"Mensaje personalizado al completar el formulario",rows:"3"},null,8,["modelValue"])]),s("div",yl,[s("div",$l,[e(l(n),null,{default:i(()=>o[53]||(o[53]=[r("Formulario Activo")])),_:1}),o[54]||(o[54]=s("p",{class:"text-sm text-muted-foreground"}," El formulario estará disponible ",-1))]),e(l(q),{modelValue:l(a).activo,"onUpdate:modelValue":o[14]||(o[14]=t=>l(a).activo=t)},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1}),e(l(T),{value:"formulario",class:"space-y-6"},{default:i(()=>[e(l(V),null,{default:i(()=>[e(l(g),null,{default:i(()=>[e(l(b),null,{default:i(()=>o[55]||(o[55]=[r("Constructor de Formulario")])),_:1}),e(l($),null,{default:i(()=>o[56]||(o[56]=[r(" Arrastra y suelta campos para construir tu formulario ")])),_:1})]),_:1}),e(l(y),null,{default:i(()=>[e(tl,{modelValue:l(a).configuracion_campos,"onUpdate:modelValue":[o[15]||(o[15]=t=>l(a).configuracion_campos=t),H],disabled:!1,showEditableOption:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})],64))}});export{ao as default};
